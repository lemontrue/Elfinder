/*! jQuery v1.7.1 jquery.com | jquery.org/license */
(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!ck[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cl||(cl=c.createElement("iframe"),cl.frameBorder=cl.width=cl.height=0),b.appendChild(cl);if(!cm||!cl.createElement)cm=(cl.contentWindow||cl.contentDocument).document,cm.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cm.close();d=cm.createElement(a),cm.body.appendChild(d),e=f.css(d,"display"),b.removeChild(cl)}ck[a]=e}return ck[a]}function cu(a,b){var c={};f.each(cq.concat.apply([],cq.slice(0,b)),function(){c[this]=a});return c}function ct(){cr=b}function cs(){setTimeout(ct,0);return cr=f.now()}function cj(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ci(){try{return new a.XMLHttpRequest}catch(b){}}function cc(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function cb(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function ca(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bE.test(a)?d(a,e):ca(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)ca(a+"["+e+"]",b[e],c,d);else d(a,b)}function b_(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bT,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bP),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bC(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bx:by,g=0,h=e.length;if(d>0){if(c!=="border")for(;g<h;g++)c||(d-=parseFloat(f.css(a,"padding"+e[g]))||0),c==="margin"?d+=parseFloat(f.css(a,c+e[g]))||0:d-=parseFloat(f.css(a,"border"+e[g]+"Width"))||0;return d+"px"}d=bz(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0;if(c)for(;g<h;g++)d+=parseFloat(f.css(a,"padding"+e[g]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+e[g]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+e[g]))||0);return d+"px"}function bp(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++)if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}i=!1,c&&(a.once?e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p,q=c.createElement("div"),r=c.documentElement;q.setAttribute("className","t"),q.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=q.getElementsByTagName("*"),e=q.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=q.getElementsByTagName("input")[0],b={leadingWhitespace:q.firstChild.nodeType===3,tbody:!q.getElementsByTagName("tbody").length,htmlSerialize:!!q.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:q.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete q.test}catch(s){b.deleteExpando=!1}!q.addEventListener&&q.attachEvent&&q.fireEvent&&(q.attachEvent("onclick",function(){b.noCloneEvent=!1}),q.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),q.appendChild(i),k=c.createDocumentFragment(),k.appendChild(q.lastChild),b.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,k.removeChild(i),k.appendChild(q),q.innerHTML="",a.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",q.style.width="2px",q.appendChild(j),b.reliableMarginRight=(parseInt((a.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(q.attachEvent)for(o in{submit:1,change:1,focusin:1})n="on"+o,p=n in q,p||(q.setAttribute(n,"return;"),p=typeof q[n]=="function"),b[o+"Bubbles"]=p;k.removeChild(q),k=g=h=j=q=i=null,f(function(){var a,d,e,g,h,i,j,k,m,n,o,r=c.getElementsByTagName("body")[0];!r||(j=1,k="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",m="visibility:hidden;border:0;",n="style='"+k+"border:5px solid #000;padding:0;'",o="<div "+n+"><div></div></div>"+"<table "+n+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",a=c.createElement("div"),a.style.cssText=m+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(a,r.firstChild),q=c.createElement("div"),a.appendChild(q),q.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",l=q.getElementsByTagName("td"),p=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",b.reliableHiddenOffsets=p&&l[0].offsetHeight===0,q.innerHTML="",q.style.width=q.style.paddingLeft="1px",f.boxModel=b.boxModel=q.offsetWidth===2,typeof q.style.zoom!="undefined"&&(q.style.display="inline",q.style.zoom=1,b.inlineBlockNeedsLayout=q.offsetWidth===2,q.style.display="",q.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=q.offsetWidth!==2),q.style.cssText=k+m,q.innerHTML=o,d=q.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,i={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:h.offsetTop===5},e.style.position="fixed",e.style.top="20px",i.fixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",i.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,i.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,r.removeChild(a),q=a=null,f.extend(b,i))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++)g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]));f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;h<g;h++)e=d[h],e&&(c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/\bhover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};
f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=[],j,k,l,m,n,o,p,q,r,s,t;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){m=f(this),m.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this){o={},q=[],m[0]=l;for(j=0;j<e;j++)r=d[j],s=r.selector,o[s]===b&&(o[s]=r.quick?H(l,r.quick):m.is(s)),o[s]&&q.push(r);q.length&&i.push({elem:l,matches:q})}}d.length>e&&i.push({elem:this,matches:d.slice(e)});for(j=0;j<i.length&&!c.isPropagationStopped();j++){p=i[j],c.currentTarget=p.elem;for(k=0;k<p.matches.length&&!c.isImmediatePropagationStopped();k++){r=p.matches[k];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace))c.data=r.data,c.handleObj=r,n=((f.event.special[r.origType]||{}).handle||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.POS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function()
{for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bp)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||!bc.test("<"+a.nodeName)?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");b===c?bh.appendChild(o):U(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof (r=k.length)=="number")for(i=0;i<r;i++)bn(k[i]);else bn(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bq=/alpha\([^)]*\)/i,br=/opacity=([^)]*)/,bs=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,bu=/^-?\d/,bv=/^([\-+])=([\-+.\de]+)/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bv.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return bC(a,b,d);f.swap(a,bw,function(){e=bC(a,b,d)});return e}},set:function(a,b){if(!bt.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return br.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bq,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bq.test(g)?g.replace(bq,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,b){var c,d,e;b=b.replace(bs,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b)));return c}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bt.test(f)&&bu.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bD=/%20/g,bE=/\[\]$/,bF=/\r?\n/g,bG=/#.*$/,bH=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bI=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bJ=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bK=/^(?:GET|HEAD)$/,bL=/^\/\//,bM=/\?/,bN=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bO=/^(?:select|textarea)/i,bP=/\s+/,bQ=/([?&])_=[^&]*/,bR=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bS=f.fn.load,bT={},bU={},bV,bW,bX=["*/"]+["*"];try{bV=e.href}catch(bY){bV=c.createElement("a"),bV.href="",bV=bV.href}bW=bR.exec(bV.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bS)return bS.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bN,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bO.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bF,"\r\n")}}):{name:b.name,value:c.replace(bF,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b_(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b_(a,b);return a},ajaxSettings:{url:bV,isLocal:bJ.test(bW[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bX},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bZ(bT),ajaxTransport:bZ(bU),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cb(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cc(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bG,"").replace(bL,bW[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bP),d.crossDomain==null&&(r=bR.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bW[1]&&r[2]==bW[2]&&(r[3]||(r[1]==="http:"?80:443))==(bW[3]||(bW[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bT,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bK.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bM.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bQ,"$1_="+x);d.url=y+(y===d.url?(bM.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bX+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bU,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)ca(g,a[g],c,e);return d.join("&").replace(bD,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cd=f.now(),ce=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cd++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ce.test(b.url)||e&&ce.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ce,l),b.url===j&&(e&&(k=k.replace(ce,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cf=a.ActiveXObject?function(){for(var a in ch)ch[a](0,1)}:!1,cg=0,ch;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ci()||cj()}:ci,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cf&&delete ch[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cg,cf&&(ch||(ch={},f(a).unload(cf)),ch[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var ck={},cl,cm,cn=/^(?:toggle|show|hide)$/,co=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp,cq=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cr;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cv(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cn.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=co.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cr||cs(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cp&&(cp=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cr||cs(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cp),cp=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);
/*!
* Note: While Microsoft is not the author of this file, Microsoft is
* offering you a license subject to the terms of the Microsoft Software
* License Terms for Microsoft ASP.NET Model View Controller 3.
* Microsoft reserves all other rights. The notices below are provided
* for informational purposes only and are not the license terms under
* which Microsoft distributed this file.
*
* jQuery UI 1.8.11
*
* Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
*
* http://docs.jquery.com/UI
*/
(function(c,j){function k(a){return!c(a).parents().andSelf().filter(function(){return c.curCSS(this,"visibility")==="hidden"||c.expr.filters.hidden(this)}).length}c.ui=c.ui||{};if(!c.ui.version){c.extend(c.ui,{version:"1.8.11",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,
NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});c.fn.extend({_focus:c.fn.focus,focus:function(a,b){return typeof a==="number"?this.each(function(){var d=this;setTimeout(function(){c(d).focus();b&&b.call(d)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=c.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(c.curCSS(this,
"position",1))&&/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?c(document):a},zIndex:function(a){if(a!==j)return this.css("zIndex",a);if(this.length){a=c(this[0]);for(var b;a.length&&a[0]!==document;){b=a.css("position");
if(b==="absolute"||b==="relative"||b==="fixed"){b=parseInt(a.css("zIndex"),10);if(!isNaN(b)&&b!==0)return b}a=a.parent()}}return 0},disableSelection:function(){return this.bind((c.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});c.each(["Width","Height"],function(a,b){function d(f,g,l,m){c.each(e,function(){g-=parseFloat(c.curCSS(f,"padding"+this,true))||0;if(l)g-=parseFloat(c.curCSS(f,
"border"+this+"Width",true))||0;if(m)g-=parseFloat(c.curCSS(f,"margin"+this,true))||0});return g}var e=b==="Width"?["Left","Right"]:["Top","Bottom"],h=b.toLowerCase(),i={innerWidth:c.fn.innerWidth,innerHeight:c.fn.innerHeight,outerWidth:c.fn.outerWidth,outerHeight:c.fn.outerHeight};c.fn["inner"+b]=function(f){if(f===j)return i["inner"+b].call(this);return this.each(function(){c(this).css(h,d(this,f)+"px")})};c.fn["outer"+b]=function(f,g){if(typeof f!=="number")return i["outer"+b].call(this,f);return this.each(function(){c(this).css(h,
d(this,f,true,g)+"px")})}});c.extend(c.expr[":"],{data:function(a,b,d){return!!c.data(a,d[3])},focusable:function(a){var b=a.nodeName.toLowerCase(),d=c.attr(a,"tabindex");if("area"===b){b=a.parentNode;d=b.name;if(!a.href||!d||b.nodeName.toLowerCase()!=="map")return false;a=c("img[usemap=#"+d+"]")[0];return!!a&&k(a)}return(/input|select|textarea|button|object/.test(b)?!a.disabled:"a"==b?a.href||!isNaN(d):!isNaN(d))&&k(a)},tabbable:function(a){var b=c.attr(a,"tabindex");return(isNaN(b)||b>=0)&&c(a).is(":focusable")}});
c(function(){var a=document.body,b=a.appendChild(b=document.createElement("div"));c.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});c.support.minHeight=b.offsetHeight===100;c.support.selectstart="onselectstart"in b;a.removeChild(b).style.display="none"});c.extend(c.ui,{plugin:{add:function(a,b,d){a=c.ui[a].prototype;for(var e in d){a.plugins[e]=a.plugins[e]||[];a.plugins[e].push([b,d[e]])}},call:function(a,b,d){if((b=a.plugins[b])&&a.element[0].parentNode)for(var e=0;e<b.length;e++)a.options[b[e][0]]&&
b[e][1].apply(a.element,d)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(a,b){if(c(a).css("overflow")==="hidden")return false;b=b&&b==="left"?"scrollLeft":"scrollTop";var d=false;if(a[b]>0)return true;a[b]=1;d=a[b]>0;a[b]=0;return d},isOverAxis:function(a,b,d){return a>b&&a<b+d},isOver:function(a,b,d,e,h,i){return c.ui.isOverAxis(a,d,h)&&c.ui.isOverAxis(b,e,i)}})}})(jQuery);
; /*!
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Widget 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)\
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(b,j){if(b.cleanData){var k=b.cleanData;b.cleanData=function(a){for(var c=0,d;(d=a[c])!=null;c++)b(d).triggerHandler("remove");k(a)}}else{var l=b.fn.remove;b.fn.remove=function(a,c){return this.each(function(){if(!c)if(!a||b.filter(a,[this]).length)b("*",this).add([this]).each(function(){b(this).triggerHandler("remove")});return l.call(b(this),a,c)})}}b.widget=function(a,c,d){var e=a.split(".")[0],f;a=a.split(".")[1];f=e+"-"+a;if(!d){d=c;c=b.Widget}b.expr[":"][f]=function(h){return!!b.data(h,
a)};b[e]=b[e]||{};b[e][a]=function(h,g){arguments.length&&this._createWidget(h,g)};c=new c;c.options=b.extend(true,{},c.options);b[e][a].prototype=b.extend(true,c,{namespace:e,widgetName:a,widgetEventPrefix:b[e][a].prototype.widgetEventPrefix||a,widgetBaseClass:f},d);b.widget.bridge(a,b[e][a])};b.widget.bridge=function(a,c){b.fn[a]=function(d){var e=typeof d==="string",f=Array.prototype.slice.call(arguments,1),h=this;d=!e&&f.length?b.extend.apply(null,[true,d].concat(f)):d;if(e&&d.charAt(0)==="_")return h;
e?this.each(function(){var g=b.data(this,a),i=g&&b.isFunction(g[d])?g[d].apply(g,f):g;if(i!==g&&i!==j){h=i;return false}}):this.each(function(){var g=b.data(this,a);g?g.option(d||{})._init():b.data(this,a,new c(d,this))});return h}};b.Widget=function(a,c){arguments.length&&this._createWidget(a,c)};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(a,c){b.data(c,this.widgetName,this);this.element=b(c);this.options=b.extend(true,{},this.options,
this._getCreateOptions(),a);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},
widget:function(){return this.element},option:function(a,c){var d=a;if(arguments.length===0)return b.extend({},this.options);if(typeof a==="string"){if(c===j)return this.options[a];d={};d[a]=c}this._setOptions(d);return this},_setOptions:function(a){var c=this;b.each(a,function(d,e){c._setOption(d,e)});return this},_setOption:function(a,c){this.options[a]=c;if(a==="disabled")this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",c);return this},
enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(a,c,d){var e=this.options[a];c=b.Event(c);c.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();d=d||{};if(c.originalEvent){a=b.event.props.length;for(var f;a;){f=b.event.props[--a];c[f]=c.originalEvent[f]}}this.element.trigger(c,d);return!(b.isFunction(e)&&e.call(this.element[0],c,d)===false||c.isDefaultPrevented())}}})(jQuery);
; /*!
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Mouse 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)\
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(b){b.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(c){return a._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(true===b.data(c.target,a.widgetName+".preventClickEvent")){b.removeData(c.target,a.widgetName+".preventClickEvent");c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(a){a.originalEvent=
a.originalEvent||{};if(!a.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(a);this._mouseDownEvent=a;var c=this,e=a.which==1,f=typeof this.options.cancel=="string"?b(a.target).parents().add(a.target).filter(this.options.cancel).length:false;if(!e||f||!this._mouseCapture(a))return true;this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet)this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay);if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=
this._mouseStart(a)!==false;if(!this._mouseStarted){a.preventDefault();return true}}true===b.data(a.target,this.widgetName+".preventClickEvent")&&b.removeData(a.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(d){return c._mouseMove(d)};this._mouseUpDelegate=function(d){return c._mouseUp(d)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);a.preventDefault();return a.originalEvent.mouseHandled=
true}},_mouseMove:function(a){if(b.browser.msie&&!(document.documentMode>=9)&&!a.button)return this._mouseUp(a);if(this._mouseStarted){this._mouseDrag(a);return a.preventDefault()}if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a))(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==false)?this._mouseDrag(a):this._mouseUp(a);return!this._mouseStarted},_mouseUp:function(a){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);
if(this._mouseStarted){this._mouseStarted=false;a.target==this._mouseDownEvent.target&&b.data(a.target,this.widgetName+".preventClickEvent",true);this._mouseStop(a)}return false},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Position 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Position
 */
(function(c){c.ui=c.ui||{};var n=/left|center|right/,o=/top|center|bottom/,t=c.fn.position,u=c.fn.offset;c.fn.position=function(b){if(!b||!b.of)return t.apply(this,arguments);b=c.extend({},b);var a=c(b.of),d=a[0],g=(b.collision||"flip").split(" "),e=b.offset?b.offset.split(" "):[0,0],h,k,j;if(d.nodeType===9){h=a.width();k=a.height();j={top:0,left:0}}else if(d.setTimeout){h=a.width();k=a.height();j={top:a.scrollTop(),left:a.scrollLeft()}}else if(d.preventDefault){b.at="left top";h=k=0;j={top:b.of.pageY,
left:b.of.pageX}}else{h=a.outerWidth();k=a.outerHeight();j=a.offset()}c.each(["my","at"],function(){var f=(b[this]||"").split(" ");if(f.length===1)f=n.test(f[0])?f.concat(["center"]):o.test(f[0])?["center"].concat(f):["center","center"];f[0]=n.test(f[0])?f[0]:"center";f[1]=o.test(f[1])?f[1]:"center";b[this]=f});if(g.length===1)g[1]=g[0];e[0]=parseInt(e[0],10)||0;if(e.length===1)e[1]=e[0];e[1]=parseInt(e[1],10)||0;if(b.at[0]==="right")j.left+=h;else if(b.at[0]==="center")j.left+=h/2;if(b.at[1]==="bottom")j.top+=
k;else if(b.at[1]==="center")j.top+=k/2;j.left+=e[0];j.top+=e[1];return this.each(function(){var f=c(this),l=f.outerWidth(),m=f.outerHeight(),p=parseInt(c.curCSS(this,"marginLeft",true))||0,q=parseInt(c.curCSS(this,"marginTop",true))||0,v=l+p+(parseInt(c.curCSS(this,"marginRight",true))||0),w=m+q+(parseInt(c.curCSS(this,"marginBottom",true))||0),i=c.extend({},j),r;if(b.my[0]==="right")i.left-=l;else if(b.my[0]==="center")i.left-=l/2;if(b.my[1]==="bottom")i.top-=m;else if(b.my[1]==="center")i.top-=
m/2;i.left=Math.round(i.left);i.top=Math.round(i.top);r={left:i.left-p,top:i.top-q};c.each(["left","top"],function(s,x){c.ui.position[g[s]]&&c.ui.position[g[s]][x](i,{targetWidth:h,targetHeight:k,elemWidth:l,elemHeight:m,collisionPosition:r,collisionWidth:v,collisionHeight:w,offset:e,my:b.my,at:b.at})});c.fn.bgiframe&&f.bgiframe();f.offset(c.extend(i,{using:b.using}))})};c.ui.position={fit:{left:function(b,a){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();b.left=
d>0?b.left-d:Math.max(b.left-a.collisionPosition.left,b.left)},top:function(b,a){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();b.top=d>0?b.top-d:Math.max(b.top-a.collisionPosition.top,b.top)}},flip:{left:function(b,a){if(a.at[0]!=="center"){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();var g=a.my[0]==="left"?-a.elemWidth:a.my[0]==="right"?a.elemWidth:0,e=a.at[0]==="left"?a.targetWidth:-a.targetWidth,h=-2*a.offset[0];b.left+=
a.collisionPosition.left<0?g+e+h:d>0?g+e+h:0}},top:function(b,a){if(a.at[1]!=="center"){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();var g=a.my[1]==="top"?-a.elemHeight:a.my[1]==="bottom"?a.elemHeight:0,e=a.at[1]==="top"?a.targetHeight:-a.targetHeight,h=-2*a.offset[1];b.top+=a.collisionPosition.top<0?g+e+h:d>0?g+e+h:0}}}};if(!c.offset.setOffset){c.offset.setOffset=function(b,a){if(/static/.test(c.curCSS(b,"position")))b.style.position="relative";var d=c(b),
g=d.offset(),e=parseInt(c.curCSS(b,"top",true),10)||0,h=parseInt(c.curCSS(b,"left",true),10)||0;g={top:a.top-g.top+e,left:a.left-g.left+h};"using"in a?a.using.call(b,g):d.css(g)};c.fn.offset=function(b){var a=this[0];if(!a||!a.ownerDocument)return null;if(b)return this.each(function(){c.offset.setOffset(this,b)});return u.call(this)}}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Draggable 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Draggables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(d){d.widget("ui.draggable",d.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper==
"original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(a){var b=
this.options;if(this.helper||b.disabled||d(a.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(a);if(!this.handle)return false;return true},_mouseStart:function(a){var b=this.options;this.helper=this._createHelper(a);this._cacheHelperProportions();if(d.ui.ddmanager)d.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-
this.margins.top,left:this.offset.left-this.margins.left};d.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt);b.containment&&this._setContainment();if(this._trigger("start",a)===false){this._clear();return false}this._cacheHelperProportions();
d.ui.ddmanager&&!b.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,a);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(a,true);return true},_mouseDrag:function(a,b){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!b){b=this._uiHash();if(this._trigger("drag",a,b)===false){this._mouseUp({});return false}this.position=b.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||
this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";d.ui.ddmanager&&d.ui.ddmanager.drag(this,a);return false},_mouseStop:function(a){var b=false;if(d.ui.ddmanager&&!this.options.dropBehaviour)b=d.ui.ddmanager.drop(this,a);if(this.dropped){b=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!b||this.options.revert=="valid"&&b||this.options.revert===true||d.isFunction(this.options.revert)&&
this.options.revert.call(this.element,b)){var c=this;d(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",a)!==false&&c._clear()})}else this._trigger("stop",a)!==false&&this._clear();return false},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(a){var b=!this.options.handle||!d(this.options.handle,this.element).length?true:false;d(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==
a.target)b=true});return b},_createHelper:function(a){var b=this.options;a=d.isFunction(b.helper)?d(b.helper.apply(this.element[0],[a])):b.helper=="clone"?this.element.clone():this.element;a.parents("body").length||a.appendTo(b.appendTo=="parent"?this.element[0].parentNode:b.appendTo);a[0]!=this.element[0]&&!/(fixed|absolute)/.test(a.css("position"))&&a.css("position","absolute");return a},_adjustOffsetFromHelper:function(a){if(typeof a=="string")a=a.split(" ");if(d.isArray(a))a={left:+a[0],top:+a[1]||
0};if("left"in a)this.offset.click.left=a.left+this.margins.left;if("right"in a)this.offset.click.left=this.helperProportions.width-a.right+this.margins.left;if("top"in a)this.offset.click.top=a.top+this.margins.top;if("bottom"in a)this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],
this.offsetParent[0])){a.left+=this.scrollParent.scrollLeft();a.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&d.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;if(a.containment=="parent")a.containment=this.helper[0].parentNode;if(a.containment=="document"||a.containment=="window")this.containment=[(a.containment=="document"?0:d(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(a.containment=="document"?0:d(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(a.containment=="document"?0:d(window).scrollLeft())+d(a.containment=="document"?
document:window).width()-this.helperProportions.width-this.margins.left,(a.containment=="document"?0:d(window).scrollTop())+(d(a.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&a.containment.constructor!=Array){var b=d(a.containment)[0];if(b){a=d(a.containment).offset();var c=d(b).css("overflow")!="hidden";this.containment=[a.left+(parseInt(d(b).css("borderLeftWidth"),
10)||0)+(parseInt(d(b).css("paddingLeft"),10)||0),a.top+(parseInt(d(b).css("borderTopWidth"),10)||0)+(parseInt(d(b).css("paddingTop"),10)||0),a.left+(c?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(d(b).css("borderLeftWidth"),10)||0)-(parseInt(d(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,a.top+(c?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(d(b).css("borderTopWidth"),10)||0)-(parseInt(d(b).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom]}}else if(a.containment.constructor==Array)this.containment=a.containment},_convertPositionTo:function(a,b){if(!b)b=this.position;a=a=="absolute"?1:-1;var c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(c[0].tagName);return{top:b.top+this.offset.relative.top*a+this.offset.parent.top*a-(d.browser.safari&&
d.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:c.scrollTop())*a),left:b.left+this.offset.relative.left*a+this.offset.parent.left*a-(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:c.scrollLeft())*a)}},_generatePosition:function(a){var b=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],
this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(c[0].tagName),e=a.pageX,g=a.pageY;if(this.originalPosition){if(this.containment){if(a.pageX-this.offset.click.left<this.containment[0])e=this.containment[0]+this.offset.click.left;if(a.pageY-this.offset.click.top<this.containment[1])g=this.containment[1]+this.offset.click.top;if(a.pageX-this.offset.click.left>this.containment[2])e=this.containment[2]+this.offset.click.left;if(a.pageY-this.offset.click.top>this.containment[3])g=
this.containment[3]+this.offset.click.top}if(b.grid){g=this.originalPageY+Math.round((g-this.originalPageY)/b.grid[1])*b.grid[1];g=this.containment?!(g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3])?g:!(g-this.offset.click.top<this.containment[1])?g-b.grid[1]:g+b.grid[1]:g;e=this.originalPageX+Math.round((e-this.originalPageX)/b.grid[0])*b.grid[0];e=this.containment?!(e-this.offset.click.left<this.containment[0]||e-this.offset.click.left>this.containment[2])?
e:!(e-this.offset.click.left<this.containment[0])?e-b.grid[0]:e+b.grid[0]:e}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:c.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():
f?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(a,b,c){c=c||this._uiHash();d.ui.plugin.call(this,a,[b,c]);if(a=="drag")this.positionAbs=this._convertPositionTo("absolute");return d.Widget.prototype._trigger.call(this,a,b,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,
offset:this.positionAbs}}});d.extend(d.ui.draggable,{version:"1.8.11"});d.ui.plugin.add("draggable","connectToSortable",{start:function(a,b){var c=d(this).data("draggable"),f=c.options,e=d.extend({},b,{item:c.element});c.sortables=[];d(f.connectToSortable).each(function(){var g=d.data(this,"sortable");if(g&&!g.options.disabled){c.sortables.push({instance:g,shouldRevert:g.options.revert});g.refreshPositions();g._trigger("activate",a,e)}})},stop:function(a,b){var c=d(this).data("draggable"),f=d.extend({},
b,{item:c.element});d.each(c.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;c.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert)this.instance.options.revert=true;this.instance._mouseStop(a);this.instance.options.helper=this.instance.options._helper;c.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",a,f)}})},drag:function(a,b){var c=
d(this).data("draggable"),f=this;d.each(c.sortables,function(){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=d(f).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return b.helper[0]};
a.target=this.instance.currentItem[0];this.instance._mouseCapture(a,true);this.instance._mouseStart(a,true,true);this.instance.offset.click.top=c.offset.click.top;this.instance.offset.click.left=c.offset.click.left;this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top;c._trigger("toSortable",a);c.dropped=this.instance.element;c.currentItem=c.element;this.instance.fromOutside=c}this.instance.currentItem&&
this.instance._mouseDrag(a)}else if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",a,this.instance._uiHash(this.instance));this.instance._mouseStop(a,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&this.instance.placeholder.remove();c._trigger("fromSortable",a);c.dropped=false}})}});d.ui.plugin.add("draggable","cursor",
{start:function(){var a=d("body"),b=d(this).data("draggable").options;if(a.css("cursor"))b._cursor=a.css("cursor");a.css("cursor",b.cursor)},stop:function(){var a=d(this).data("draggable").options;a._cursor&&d("body").css("cursor",a._cursor)}});d.ui.plugin.add("draggable","iframeFix",{start:function(){var a=d(this).data("draggable").options;d(a.iframeFix===true?"iframe":a.iframeFix).each(function(){d('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+
"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(d(this).offset()).appendTo("body")})},stop:function(){d("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});d.ui.plugin.add("draggable","opacity",{start:function(a,b){a=d(b.helper);b=d(this).data("draggable").options;if(a.css("opacity"))b._opacity=a.css("opacity");a.css("opacity",b.opacity)},stop:function(a,b){a=d(this).data("draggable").options;a._opacity&&d(b.helper).css("opacity",
a._opacity)}});d.ui.plugin.add("draggable","scroll",{start:function(){var a=d(this).data("draggable");if(a.scrollParent[0]!=document&&a.scrollParent[0].tagName!="HTML")a.overflowOffset=a.scrollParent.offset()},drag:function(a){var b=d(this).data("draggable"),c=b.options,f=false;if(b.scrollParent[0]!=document&&b.scrollParent[0].tagName!="HTML"){if(!c.axis||c.axis!="x")if(b.overflowOffset.top+b.scrollParent[0].offsetHeight-a.pageY<c.scrollSensitivity)b.scrollParent[0].scrollTop=f=b.scrollParent[0].scrollTop+
c.scrollSpeed;else if(a.pageY-b.overflowOffset.top<c.scrollSensitivity)b.scrollParent[0].scrollTop=f=b.scrollParent[0].scrollTop-c.scrollSpeed;if(!c.axis||c.axis!="y")if(b.overflowOffset.left+b.scrollParent[0].offsetWidth-a.pageX<c.scrollSensitivity)b.scrollParent[0].scrollLeft=f=b.scrollParent[0].scrollLeft+c.scrollSpeed;else if(a.pageX-b.overflowOffset.left<c.scrollSensitivity)b.scrollParent[0].scrollLeft=f=b.scrollParent[0].scrollLeft-c.scrollSpeed}else{if(!c.axis||c.axis!="x")if(a.pageY-d(document).scrollTop()<
c.scrollSensitivity)f=d(document).scrollTop(d(document).scrollTop()-c.scrollSpeed);else if(d(window).height()-(a.pageY-d(document).scrollTop())<c.scrollSensitivity)f=d(document).scrollTop(d(document).scrollTop()+c.scrollSpeed);if(!c.axis||c.axis!="y")if(a.pageX-d(document).scrollLeft()<c.scrollSensitivity)f=d(document).scrollLeft(d(document).scrollLeft()-c.scrollSpeed);else if(d(window).width()-(a.pageX-d(document).scrollLeft())<c.scrollSensitivity)f=d(document).scrollLeft(d(document).scrollLeft()+
c.scrollSpeed)}f!==false&&d.ui.ddmanager&&!c.dropBehaviour&&d.ui.ddmanager.prepareOffsets(b,a)}});d.ui.plugin.add("draggable","snap",{start:function(){var a=d(this).data("draggable"),b=a.options;a.snapElements=[];d(b.snap.constructor!=String?b.snap.items||":data(draggable)":b.snap).each(function(){var c=d(this),f=c.offset();this!=a.element[0]&&a.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:f.top,left:f.left})})},drag:function(a,b){for(var c=d(this).data("draggable"),
f=c.options,e=f.snapTolerance,g=b.offset.left,n=g+c.helperProportions.width,m=b.offset.top,o=m+c.helperProportions.height,h=c.snapElements.length-1;h>=0;h--){var i=c.snapElements[h].left,k=i+c.snapElements[h].width,j=c.snapElements[h].top,l=j+c.snapElements[h].height;if(i-e<g&&g<k+e&&j-e<m&&m<l+e||i-e<g&&g<k+e&&j-e<o&&o<l+e||i-e<n&&n<k+e&&j-e<m&&m<l+e||i-e<n&&n<k+e&&j-e<o&&o<l+e){if(f.snapMode!="inner"){var p=Math.abs(j-o)<=e,q=Math.abs(l-m)<=e,r=Math.abs(i-n)<=e,s=Math.abs(k-g)<=e;if(p)b.position.top=
c._convertPositionTo("relative",{top:j-c.helperProportions.height,left:0}).top-c.margins.top;if(q)b.position.top=c._convertPositionTo("relative",{top:l,left:0}).top-c.margins.top;if(r)b.position.left=c._convertPositionTo("relative",{top:0,left:i-c.helperProportions.width}).left-c.margins.left;if(s)b.position.left=c._convertPositionTo("relative",{top:0,left:k}).left-c.margins.left}var t=p||q||r||s;if(f.snapMode!="outer"){p=Math.abs(j-m)<=e;q=Math.abs(l-o)<=e;r=Math.abs(i-g)<=e;s=Math.abs(k-n)<=e;if(p)b.position.top=
c._convertPositionTo("relative",{top:j,left:0}).top-c.margins.top;if(q)b.position.top=c._convertPositionTo("relative",{top:l-c.helperProportions.height,left:0}).top-c.margins.top;if(r)b.position.left=c._convertPositionTo("relative",{top:0,left:i}).left-c.margins.left;if(s)b.position.left=c._convertPositionTo("relative",{top:0,left:k-c.helperProportions.width}).left-c.margins.left}if(!c.snapElements[h].snapping&&(p||q||r||s||t))c.options.snap.snap&&c.options.snap.snap.call(c.element,a,d.extend(c._uiHash(),
{snapItem:c.snapElements[h].item}));c.snapElements[h].snapping=p||q||r||s||t}else{c.snapElements[h].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,a,d.extend(c._uiHash(),{snapItem:c.snapElements[h].item}));c.snapElements[h].snapping=false}}}});d.ui.plugin.add("draggable","stack",{start:function(){var a=d(this).data("draggable").options;a=d.makeArray(d(a.stack)).sort(function(c,f){return(parseInt(d(c).css("zIndex"),10)||0)-(parseInt(d(f).css("zIndex"),10)||0)});if(a.length){var b=
parseInt(a[0].style.zIndex)||0;d(a).each(function(c){this.style.zIndex=b+c});this[0].style.zIndex=b+a.length}}});d.ui.plugin.add("draggable","zIndex",{start:function(a,b){a=d(b.helper);b=d(this).data("draggable").options;if(a.css("zIndex"))b._zIndex=a.css("zIndex");a.css("zIndex",b.zIndex)},stop:function(a,b){a=d(this).data("draggable").options;a._zIndex&&d(b.helper).css("zIndex",a._zIndex)}})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Droppable 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Droppables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */
(function(d){d.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var a=this.options,b=a.accept;this.isover=0;this.isout=1;this.accept=d.isFunction(b)?b:function(c){return c.is(b)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};d.ui.ddmanager.droppables[a.scope]=d.ui.ddmanager.droppables[a.scope]||[];d.ui.ddmanager.droppables[a.scope].push(this);
a.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var a=d.ui.ddmanager.droppables[this.options.scope],b=0;b<a.length;b++)a[b]==this&&a.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(a,b){if(a=="accept")this.accept=d.isFunction(b)?b:function(c){return c.is(b)};d.Widget.prototype._setOption.apply(this,arguments)},_activate:function(a){var b=d.ui.ddmanager.current;this.options.activeClass&&
this.element.addClass(this.options.activeClass);b&&this._trigger("activate",a,this.ui(b))},_deactivate:function(a){var b=d.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);b&&this._trigger("deactivate",a,this.ui(b))},_over:function(a){var b=d.ui.ddmanager.current;if(!(!b||(b.currentItem||b.element)[0]==this.element[0]))if(this.accept.call(this.element[0],b.currentItem||b.element)){this.options.hoverClass&&this.element.addClass(this.options.hoverClass);
this._trigger("over",a,this.ui(b))}},_out:function(a){var b=d.ui.ddmanager.current;if(!(!b||(b.currentItem||b.element)[0]==this.element[0]))if(this.accept.call(this.element[0],b.currentItem||b.element)){this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("out",a,this.ui(b))}},_drop:function(a,b){var c=b||d.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return false;var e=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var g=
d.data(this,"droppable");if(g.options.greedy&&!g.options.disabled&&g.options.scope==c.options.scope&&g.accept.call(g.element[0],c.currentItem||c.element)&&d.ui.intersect(c,d.extend(g,{offset:g.element.offset()}),g.options.tolerance)){e=true;return false}});if(e)return false;if(this.accept.call(this.element[0],c.currentItem||c.element)){this.options.activeClass&&this.element.removeClass(this.options.activeClass);this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("drop",
a,this.ui(c));return this.element}return false},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});d.extend(d.ui.droppable,{version:"1.8.11"});d.ui.intersect=function(a,b,c){if(!b.offset)return false;var e=(a.positionAbs||a.position.absolute).left,g=e+a.helperProportions.width,f=(a.positionAbs||a.position.absolute).top,h=f+a.helperProportions.height,i=b.offset.left,k=i+b.proportions.width,j=b.offset.top,l=j+b.proportions.height;
switch(c){case "fit":return i<=e&&g<=k&&j<=f&&h<=l;case "intersect":return i<e+a.helperProportions.width/2&&g-a.helperProportions.width/2<k&&j<f+a.helperProportions.height/2&&h-a.helperProportions.height/2<l;case "pointer":return d.ui.isOver((a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,j,i,b.proportions.height,b.proportions.width);case "touch":return(f>=j&&f<=l||h>=j&&h<=l||f<j&&h>l)&&(e>=
i&&e<=k||g>=i&&g<=k||e<i&&g>k);default:return false}};d.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(a,b){var c=d.ui.ddmanager.droppables[a.options.scope]||[],e=b?b.type:null,g=(a.currentItem||a.element).find(":data(droppable)").andSelf(),f=0;a:for(;f<c.length;f++)if(!(c[f].options.disabled||a&&!c[f].accept.call(c[f].element[0],a.currentItem||a.element))){for(var h=0;h<g.length;h++)if(g[h]==c[f].element[0]){c[f].proportions.height=0;continue a}c[f].visible=c[f].element.css("display")!=
"none";if(c[f].visible){e=="mousedown"&&c[f]._activate.call(c[f],b);c[f].offset=c[f].element.offset();c[f].proportions={width:c[f].element[0].offsetWidth,height:c[f].element[0].offsetHeight}}}},drop:function(a,b){var c=false;d.each(d.ui.ddmanager.droppables[a.options.scope]||[],function(){if(this.options){if(!this.options.disabled&&this.visible&&d.ui.intersect(a,this,this.options.tolerance))c=c||this._drop.call(this,b);if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],a.currentItem||
a.element)){this.isout=1;this.isover=0;this._deactivate.call(this,b)}}});return c},drag:function(a,b){a.options.refreshPositions&&d.ui.ddmanager.prepareOffsets(a,b);d.each(d.ui.ddmanager.droppables[a.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var c=d.ui.intersect(a,this,this.options.tolerance);if(c=!c&&this.isover==1?"isout":c&&this.isover==0?"isover":null){var e;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");if(g.length){e=
d.data(g[0],"droppable");e.greedyChild=c=="isover"?1:0}}if(e&&c=="isover"){e.isover=0;e.isout=1;e._out.call(e,b)}this[c]=1;this[c=="isout"?"isover":"isout"]=0;this[c=="isover"?"_over":"_out"].call(this,b);if(e&&c=="isout"){e.isout=0;e.isover=1;e._over.call(e,b)}}}})}}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Resizable 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Resizables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(e){e.widget("ui.resizable",e.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var b=this,a=this.options;this.element.addClass("ui-resizable");e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,
_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){/relative/.test(this.element.css("position"))&&e.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"});this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),
top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=
this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=a.handles||(!e(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",
nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all")this.handles="n,e,s,w,se,sw,ne,nw";var c=this.handles.split(",");this.handles={};for(var d=0;d<c.length;d++){var f=e.trim(c[d]),g=e('<div class="ui-resizable-handle '+("ui-resizable-"+f)+'"></div>');/sw|se|ne|nw/.test(f)&&g.css({zIndex:++a.zIndex});"se"==f&&g.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[f]=".ui-resizable-"+f;this.element.append(g)}}this._renderAxis=function(h){h=h||this.element;for(var i in this.handles){if(this.handles[i].constructor==
String)this.handles[i]=e(this.handles[i],this.element).show();if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var j=e(this.handles[i],this.element),k=0;k=/sw|ne|nw|se|n|s/.test(i)?j.outerHeight():j.outerWidth();j=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");h.css(j,k);this._proportionallyResize()}e(this.handles[i])}};this._renderAxis(this.element);this._handles=e(".ui-resizable-handle",this.element).disableSelection();
this._handles.mouseover(function(){if(!b.resizing){if(this.className)var h=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=h&&h[1]?h[1]:"se"}});if(a.autoHide){this._handles.hide();e(this.element).addClass("ui-resizable-autohide").hover(function(){e(this).removeClass("ui-resizable-autohide");b._handles.show()},function(){if(!b.resizing){e(this).addClass("ui-resizable-autohide");b._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(c){e(c).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};
if(this.elementIsWrapper){b(this.element);var a=this.element;a.after(this.originalElement.css({position:a.css("position"),width:a.outerWidth(),height:a.outerHeight(),top:a.css("top"),left:a.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);b(this.originalElement);return this},_mouseCapture:function(b){var a=false;for(var c in this.handles)if(e(this.handles[c])[0]==b.target)a=true;return!this.options.disabled&&a},_mouseStart:function(b){var a=this.options,c=this.element.position(),
d=this.element;this.resizing=true;this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()};if(d.is(".ui-draggable")||/absolute/.test(d.css("position")))d.css({position:"absolute",top:c.top,left:c.left});e.browser.opera&&/relative/.test(d.css("position"))&&d.css({position:"relative",top:"auto",left:"auto"});this._renderProxy();c=m(this.helper.css("left"));var f=m(this.helper.css("top"));if(a.containment){c+=e(a.containment).scrollLeft()||0;f+=e(a.containment).scrollTop()||0}this.offset=
this.helper.offset();this.position={left:c,top:f};this.size=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalSize=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalPosition={left:c,top:f};this.sizeDiff={width:d.outerWidth()-d.width(),height:d.outerHeight()-d.height()};this.originalMousePosition={left:b.pageX,top:b.pageY};this.aspectRatio=typeof a.aspectRatio=="number"?a.aspectRatio:
this.originalSize.width/this.originalSize.height||1;a=e(".ui-resizable-"+this.axis).css("cursor");e("body").css("cursor",a=="auto"?this.axis+"-resize":a);d.addClass("ui-resizable-resizing");this._propagate("start",b);return true},_mouseDrag:function(b){var a=this.helper,c=this.originalMousePosition,d=this._change[this.axis];if(!d)return false;c=d.apply(this,[b,b.pageX-c.left||0,b.pageY-c.top||0]);if(this._aspectRatio||b.shiftKey)c=this._updateRatio(c,b);c=this._respectSize(c,b);this._propagate("resize",
b);a.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(c);this._trigger("resize",b,this.ui());return false},_mouseStop:function(b){this.resizing=false;var a=this.options,c=this;if(this._helper){var d=this._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName);d=f&&e.ui.hasScroll(d[0],"left")?0:c.sizeDiff.height;
f=f?0:c.sizeDiff.width;f={width:c.helper.width()-f,height:c.helper.height()-d};d=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null;var g=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;a.animate||this.element.css(e.extend(f,{top:g,left:d}));c.helper.height(c.size.height);c.helper.width(c.size.width);this._helper&&!a.animate&&this._proportionallyResize()}e("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");
this._propagate("stop",b);this._helper&&this.helper.remove();return false},_updateCache:function(b){this.offset=this.helper.offset();if(l(b.left))this.position.left=b.left;if(l(b.top))this.position.top=b.top;if(l(b.height))this.size.height=b.height;if(l(b.width))this.size.width=b.width},_updateRatio:function(b){var a=this.position,c=this.size,d=this.axis;if(b.height)b.width=c.height*this.aspectRatio;else if(b.width)b.height=c.width/this.aspectRatio;if(d=="sw"){b.left=a.left+(c.width-b.width);b.top=
null}if(d=="nw"){b.top=a.top+(c.height-b.height);b.left=a.left+(c.width-b.width)}return b},_respectSize:function(b){var a=this.options,c=this.axis,d=l(b.width)&&a.maxWidth&&a.maxWidth<b.width,f=l(b.height)&&a.maxHeight&&a.maxHeight<b.height,g=l(b.width)&&a.minWidth&&a.minWidth>b.width,h=l(b.height)&&a.minHeight&&a.minHeight>b.height;if(g)b.width=a.minWidth;if(h)b.height=a.minHeight;if(d)b.width=a.maxWidth;if(f)b.height=a.maxHeight;var i=this.originalPosition.left+this.originalSize.width,j=this.position.top+
this.size.height,k=/sw|nw|w/.test(c);c=/nw|ne|n/.test(c);if(g&&k)b.left=i-a.minWidth;if(d&&k)b.left=i-a.maxWidth;if(h&&c)b.top=j-a.minHeight;if(f&&c)b.top=j-a.maxHeight;if((a=!b.width&&!b.height)&&!b.left&&b.top)b.top=null;else if(a&&!b.top&&b.left)b.left=null;return b},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=this.helper||this.element,a=0;a<this._proportionallyResizeElements.length;a++){var c=this._proportionallyResizeElements[a];if(!this.borderDif){var d=
[c.css("borderTopWidth"),c.css("borderRightWidth"),c.css("borderBottomWidth"),c.css("borderLeftWidth")],f=[c.css("paddingTop"),c.css("paddingRight"),c.css("paddingBottom"),c.css("paddingLeft")];this.borderDif=e.map(d,function(g,h){g=parseInt(g,10)||0;h=parseInt(f[h],10)||0;return g+h})}e.browser.msie&&(e(b).is(":hidden")||e(b).parents(":hidden").length)||c.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=
this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var a=e.browser.msie&&e.browser.version<7,c=a?1:0;a=a?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+a,height:this.element.outerHeight()+a,position:"absolute",left:this.elementOffset.left-c+"px",top:this.elementOffset.top-c+"px",zIndex:++b.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(b,
a){return{width:this.originalSize.width+a}},w:function(b,a){return{left:this.originalPosition.left+a,width:this.originalSize.width-a}},n:function(b,a,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(b,a,c){return{height:this.originalSize.height+c}},se:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},sw:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,a,
c]))},ne:function(b,a,c){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},nw:function(b,a,c){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,a,c]))}},_propagate:function(b,a){e.ui.plugin.call(this,b,[a,this.ui()]);b!="resize"&&this._trigger(b,a,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,
originalPosition:this.originalPosition}}});e.extend(e.ui.resizable,{version:"1.8.11"});e.ui.plugin.add("resizable","alsoResize",{start:function(){var b=e(this).data("resizable").options,a=function(c){e(c).each(function(){var d=e(this);d.data("resizable-alsoresize",{width:parseInt(d.width(),10),height:parseInt(d.height(),10),left:parseInt(d.css("left"),10),top:parseInt(d.css("top"),10),position:d.css("position")})})};if(typeof b.alsoResize=="object"&&!b.alsoResize.parentNode)if(b.alsoResize.length){b.alsoResize=
b.alsoResize[0];a(b.alsoResize)}else e.each(b.alsoResize,function(c){a(c)});else a(b.alsoResize)},resize:function(b,a){var c=e(this).data("resizable");b=c.options;var d=c.originalSize,f=c.originalPosition,g={height:c.size.height-d.height||0,width:c.size.width-d.width||0,top:c.position.top-f.top||0,left:c.position.left-f.left||0},h=function(i,j){e(i).each(function(){var k=e(this),q=e(this).data("resizable-alsoresize"),p={},r=j&&j.length?j:k.parents(a.originalElement[0]).length?["width","height"]:["width",
"height","top","left"];e.each(r,function(n,o){if((n=(q[o]||0)+(g[o]||0))&&n>=0)p[o]=n||null});if(e.browser.opera&&/relative/.test(k.css("position"))){c._revertToRelativePosition=true;k.css({position:"absolute",top:"auto",left:"auto"})}k.css(p)})};typeof b.alsoResize=="object"&&!b.alsoResize.nodeType?e.each(b.alsoResize,function(i,j){h(i,j)}):h(b.alsoResize)},stop:function(){var b=e(this).data("resizable"),a=b.options,c=function(d){e(d).each(function(){var f=e(this);f.css({position:f.data("resizable-alsoresize").position})})};
if(b._revertToRelativePosition){b._revertToRelativePosition=false;typeof a.alsoResize=="object"&&!a.alsoResize.nodeType?e.each(a.alsoResize,function(d){c(d)}):c(a.alsoResize)}e(this).removeData("resizable-alsoresize")}});e.ui.plugin.add("resizable","animate",{stop:function(b){var a=e(this).data("resizable"),c=a.options,d=a._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName),g=f&&e.ui.hasScroll(d[0],"left")?0:a.sizeDiff.height;f={width:a.size.width-(f?0:a.sizeDiff.width),height:a.size.height-
g};g=parseInt(a.element.css("left"),10)+(a.position.left-a.originalPosition.left)||null;var h=parseInt(a.element.css("top"),10)+(a.position.top-a.originalPosition.top)||null;a.element.animate(e.extend(f,h&&g?{top:h,left:g}:{}),{duration:c.animateDuration,easing:c.animateEasing,step:function(){var i={width:parseInt(a.element.css("width"),10),height:parseInt(a.element.css("height"),10),top:parseInt(a.element.css("top"),10),left:parseInt(a.element.css("left"),10)};d&&d.length&&e(d[0]).css({width:i.width,
height:i.height});a._updateCache(i);a._propagate("resize",b)}})}});e.ui.plugin.add("resizable","containment",{start:function(){var b=e(this).data("resizable"),a=b.element,c=b.options.containment;if(a=c instanceof e?c.get(0):/parent/.test(c)?a.parent().get(0):c){b.containerElement=e(a);if(/document/.test(c)||c==document){b.containerOffset={left:0,top:0};b.containerPosition={left:0,top:0};b.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}}else{var d=
e(a),f=[];e(["Top","Right","Left","Bottom"]).each(function(i,j){f[i]=m(d.css("padding"+j))});b.containerOffset=d.offset();b.containerPosition=d.position();b.containerSize={height:d.innerHeight()-f[3],width:d.innerWidth()-f[1]};c=b.containerOffset;var g=b.containerSize.height,h=b.containerSize.width;h=e.ui.hasScroll(a,"left")?a.scrollWidth:h;g=e.ui.hasScroll(a)?a.scrollHeight:g;b.parentData={element:a,left:c.left,top:c.top,width:h,height:g}}}},resize:function(b){var a=e(this).data("resizable"),c=a.options,
d=a.containerOffset,f=a.position;b=a._aspectRatio||b.shiftKey;var g={top:0,left:0},h=a.containerElement;if(h[0]!=document&&/static/.test(h.css("position")))g=d;if(f.left<(a._helper?d.left:0)){a.size.width+=a._helper?a.position.left-d.left:a.position.left-g.left;if(b)a.size.height=a.size.width/c.aspectRatio;a.position.left=c.helper?d.left:0}if(f.top<(a._helper?d.top:0)){a.size.height+=a._helper?a.position.top-d.top:a.position.top;if(b)a.size.width=a.size.height*c.aspectRatio;a.position.top=a._helper?
d.top:0}a.offset.left=a.parentData.left+a.position.left;a.offset.top=a.parentData.top+a.position.top;c=Math.abs((a._helper?a.offset.left-g.left:a.offset.left-g.left)+a.sizeDiff.width);d=Math.abs((a._helper?a.offset.top-g.top:a.offset.top-d.top)+a.sizeDiff.height);f=a.containerElement.get(0)==a.element.parent().get(0);g=/relative|absolute/.test(a.containerElement.css("position"));if(f&&g)c-=a.parentData.left;if(c+a.size.width>=a.parentData.width){a.size.width=a.parentData.width-c;if(b)a.size.height=
a.size.width/a.aspectRatio}if(d+a.size.height>=a.parentData.height){a.size.height=a.parentData.height-d;if(b)a.size.width=a.size.height*a.aspectRatio}},stop:function(){var b=e(this).data("resizable"),a=b.options,c=b.containerOffset,d=b.containerPosition,f=b.containerElement,g=e(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width;g=g.outerHeight()-b.sizeDiff.height;b._helper&&!a.animate&&/relative/.test(f.css("position"))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g});b._helper&&!a.animate&&
/static/.test(f.css("position"))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g})}});e.ui.plugin.add("resizable","ghost",{start:function(){var b=e(this).data("resizable"),a=b.options,c=b.size;b.ghost=b.originalElement.clone();b.ghost.css({opacity:0.25,display:"block",position:"relative",height:c.height,width:c.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof a.ghost=="string"?a.ghost:"");b.ghost.appendTo(b.helper)},resize:function(){var b=e(this).data("resizable");
b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=e(this).data("resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}});e.ui.plugin.add("resizable","grid",{resize:function(){var b=e(this).data("resizable"),a=b.options,c=b.size,d=b.originalSize,f=b.originalPosition,g=b.axis;a.grid=typeof a.grid=="number"?[a.grid,a.grid]:a.grid;var h=Math.round((c.width-d.width)/(a.grid[0]||1))*(a.grid[0]||1);a=Math.round((c.height-d.height)/
(a.grid[1]||1))*(a.grid[1]||1);if(/^(se|s|e)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a}else if(/^(ne)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a;b.position.top=f.top-a}else{if(/^(sw)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a}else{b.size.width=d.width+h;b.size.height=d.height+a;b.position.top=f.top-a}b.position.left=f.left-h}}});var m=function(b){return parseInt(b,10)||0},l=function(b){return!isNaN(parseInt(b,10))}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Selectable 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Selectables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(e){e.widget("ui.selectable",e.ui.mouse,{options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var c=this;this.element.addClass("ui-selectable");this.dragged=false;var f;this.refresh=function(){f=e(c.options.filter,c.element[0]);f.each(function(){var d=e(this),b=d.offset();e.data(this,"selectable-item",{element:this,$element:d,left:b.left,top:b.top,right:b.left+d.outerWidth(),bottom:b.top+d.outerHeight(),startselected:false,selected:d.hasClass("ui-selected"),
selecting:d.hasClass("ui-selecting"),unselecting:d.hasClass("ui-unselecting")})})};this.refresh();this.selectees=f.addClass("ui-selectee");this._mouseInit();this.helper=e("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(c){var f=this;this.opos=[c.pageX,
c.pageY];if(!this.options.disabled){var d=this.options;this.selectees=e(d.filter,this.element[0]);this._trigger("start",c);e(d.appendTo).append(this.helper);this.helper.css({left:c.clientX,top:c.clientY,width:0,height:0});d.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var b=e.data(this,"selectable-item");b.startselected=true;if(!c.metaKey){b.$element.removeClass("ui-selected");b.selected=false;b.$element.addClass("ui-unselecting");b.unselecting=true;f._trigger("unselecting",
c,{unselecting:b.element})}});e(c.target).parents().andSelf().each(function(){var b=e.data(this,"selectable-item");if(b){var g=!c.metaKey||!b.$element.hasClass("ui-selected");b.$element.removeClass(g?"ui-unselecting":"ui-selected").addClass(g?"ui-selecting":"ui-unselecting");b.unselecting=!g;b.selecting=g;(b.selected=g)?f._trigger("selecting",c,{selecting:b.element}):f._trigger("unselecting",c,{unselecting:b.element});return false}})}},_mouseDrag:function(c){var f=this;this.dragged=true;if(!this.options.disabled){var d=
this.options,b=this.opos[0],g=this.opos[1],h=c.pageX,i=c.pageY;if(b>h){var j=h;h=b;b=j}if(g>i){j=i;i=g;g=j}this.helper.css({left:b,top:g,width:h-b,height:i-g});this.selectees.each(function(){var a=e.data(this,"selectable-item");if(!(!a||a.element==f.element[0])){var k=false;if(d.tolerance=="touch")k=!(a.left>h||a.right<b||a.top>i||a.bottom<g);else if(d.tolerance=="fit")k=a.left>b&&a.right<h&&a.top>g&&a.bottom<i;if(k){if(a.selected){a.$element.removeClass("ui-selected");a.selected=false}if(a.unselecting){a.$element.removeClass("ui-unselecting");
a.unselecting=false}if(!a.selecting){a.$element.addClass("ui-selecting");a.selecting=true;f._trigger("selecting",c,{selecting:a.element})}}else{if(a.selecting)if(c.metaKey&&a.startselected){a.$element.removeClass("ui-selecting");a.selecting=false;a.$element.addClass("ui-selected");a.selected=true}else{a.$element.removeClass("ui-selecting");a.selecting=false;if(a.startselected){a.$element.addClass("ui-unselecting");a.unselecting=true}f._trigger("unselecting",c,{unselecting:a.element})}if(a.selected)if(!c.metaKey&&
!a.startselected){a.$element.removeClass("ui-selected");a.selected=false;a.$element.addClass("ui-unselecting");a.unselecting=true;f._trigger("unselecting",c,{unselecting:a.element})}}}});return false}},_mouseStop:function(c){var f=this;this.dragged=false;e(".ui-unselecting",this.element[0]).each(function(){var d=e.data(this,"selectable-item");d.$element.removeClass("ui-unselecting");d.unselecting=false;d.startselected=false;f._trigger("unselected",c,{unselected:d.element})});e(".ui-selecting",this.element[0]).each(function(){var d=
e.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected");d.selecting=false;d.selected=true;d.startselected=true;f._trigger("selected",c,{selected:d.element})});this._trigger("stop",c);this.helper.remove();return false}});e.extend(e.ui.selectable,{version:"1.8.11"})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Sortable 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Sortables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(d){d.widget("ui.sortable",d.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){this.containerCache={};this.element.addClass("ui-sortable");
this.refresh();this.floating=this.items.length?/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):false;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData("sortable-item");return this},_setOption:function(a,b){if(a==="disabled"){this.options[a]=
b;this.widget()[b?"addClass":"removeClass"]("ui-sortable-disabled")}else d.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(a,b){if(this.reverting)return false;if(this.options.disabled||this.options.type=="static")return false;this._refreshItems(a);var c=null,e=this;d(a.target).parents().each(function(){if(d.data(this,"sortable-item")==e){c=d(this);return false}});if(d.data(a.target,"sortable-item")==e)c=d(a.target);if(!c)return false;if(this.options.handle&&!b){var f=false;
d(this.options.handle,c).find("*").andSelf().each(function(){if(this==a.target)f=true});if(!f)return false}this.currentItem=c;this._removeCurrentsFromItems();return true},_mouseStart:function(a,b,c){b=this.options;var e=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(a);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-
this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");d.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};
this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();b.containment&&this._setContainment();if(b.cursor){if(d("body").css("cursor"))this._storedCursor=d("body").css("cursor");d("body").css("cursor",b.cursor)}if(b.opacity){if(this.helper.css("opacity"))this._storedOpacity=this.helper.css("opacity");this.helper.css("opacity",b.opacity)}if(b.zIndex){if(this.helper.css("zIndex"))this._storedZIndex=this.helper.css("zIndex");this.helper.css("zIndex",b.zIndex)}if(this.scrollParent[0]!=
document&&this.scrollParent[0].tagName!="HTML")this.overflowOffset=this.scrollParent.offset();this._trigger("start",a,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!c)for(c=this.containers.length-1;c>=0;c--)this.containers[c]._trigger("activate",a,e._uiHash(this));if(d.ui.ddmanager)d.ui.ddmanager.current=this;d.ui.ddmanager&&!b.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,a);this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(a);
return true},_mouseDrag:function(a){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs)this.lastPositionAbs=this.positionAbs;if(this.options.scroll){var b=this.options,c=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<b.scrollSensitivity)this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop+b.scrollSpeed;else if(a.pageY-this.overflowOffset.top<
b.scrollSensitivity)this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop-b.scrollSpeed;if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-a.pageX<b.scrollSensitivity)this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft+b.scrollSpeed;else if(a.pageX-this.overflowOffset.left<b.scrollSensitivity)this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft-b.scrollSpeed}else{if(a.pageY-d(document).scrollTop()<b.scrollSensitivity)c=d(document).scrollTop(d(document).scrollTop()-
b.scrollSpeed);else if(d(window).height()-(a.pageY-d(document).scrollTop())<b.scrollSensitivity)c=d(document).scrollTop(d(document).scrollTop()+b.scrollSpeed);if(a.pageX-d(document).scrollLeft()<b.scrollSensitivity)c=d(document).scrollLeft(d(document).scrollLeft()-b.scrollSpeed);else if(d(window).width()-(a.pageX-d(document).scrollLeft())<b.scrollSensitivity)c=d(document).scrollLeft(d(document).scrollLeft()+b.scrollSpeed)}c!==false&&d.ui.ddmanager&&!b.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,
a)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(b=this.items.length-1;b>=0;b--){c=this.items[b];var e=c.item[0],f=this._intersectsWithPointer(c);if(f)if(e!=this.currentItem[0]&&this.placeholder[f==1?"next":"prev"]()[0]!=e&&!d.ui.contains(this.placeholder[0],e)&&(this.options.type=="semi-dynamic"?!d.ui.contains(this.element[0],
e):true)){this.direction=f==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(c))this._rearrange(a,c);else break;this._trigger("change",a,this._uiHash());break}}this._contactContainers(a);d.ui.ddmanager&&d.ui.ddmanager.drag(this,a);this._trigger("sort",a,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(a,b){if(a){d.ui.ddmanager&&!this.options.dropBehaviour&&d.ui.ddmanager.drop(this,a);if(this.options.revert){var c=this;b=c.placeholder.offset();
c.reverting=true;d(this.helper).animate({left:b.left-this.offset.parent.left-c.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:b.top-this.offset.parent.top-c.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){c._clear(a)})}else this._clear(a,b);return false}},cancel:function(){var a=this;if(this.dragging){this._mouseUp({target:null});this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):
this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--){this.containers[b]._trigger("deactivate",null,a._uiHash(this));if(this.containers[b].containerCache.over){this.containers[b]._trigger("out",null,a._uiHash(this));this.containers[b].containerCache.over=0}}}if(this.placeholder){this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove();d.extend(this,{helper:null,
dragging:false,reverting:false,_noFinalSort:null});this.domPosition.prev?d(this.domPosition.prev).after(this.currentItem):d(this.domPosition.parent).prepend(this.currentItem)}return this},serialize:function(a){var b=this._getItemsAsjQuery(a&&a.connected),c=[];a=a||{};d(b).each(function(){var e=(d(a.item||this).attr(a.attribute||"id")||"").match(a.expression||/(.+)[-=_](.+)/);if(e)c.push((a.key||e[1]+"[]")+"="+(a.key&&a.expression?e[1]:e[2]))});!c.length&&a.key&&c.push(a.key+"=");return c.join("&")},
toArray:function(a){var b=this._getItemsAsjQuery(a&&a.connected),c=[];a=a||{};b.each(function(){c.push(d(a.item||this).attr(a.attribute||"id")||"")});return c},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,e=this.positionAbs.top,f=e+this.helperProportions.height,g=a.left,h=g+a.width,i=a.top,k=i+a.height,j=this.offset.click.top,l=this.offset.click.left;j=e+j>i&&e+j<k&&b+l>g&&b+l<h;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||
this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?j:g<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<h&&i<e+this.helperProportions.height/2&&f-this.helperProportions.height/2<k},_intersectsWithPointer:function(a){var b=d.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height);a=d.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width);b=b&&a;a=this._getDragVerticalDirection();
var c=this._getDragHorizontalDirection();if(!b)return false;return this.floating?c&&c=="right"||a=="down"?2:1:a&&(a=="down"?2:1)},_intersectsWithSides:function(a){var b=d.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height);a=d.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width);var c=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?e=="right"&&a||e=="left"&&!a:c&&(c=="down"&&b||c=="up"&&!b)},
_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},refresh:function(a){this._refreshItems(a);this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(a){var b=[],c=[],e=this._connectWith();
if(e&&a)for(a=e.length-1;a>=0;a--)for(var f=d(e[a]),g=f.length-1;g>=0;g--){var h=d.data(f[g],"sortable");if(h&&h!=this&&!h.options.disabled)c.push([d.isFunction(h.options.items)?h.options.items.call(h.element):d(h.options.items,h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),h])}c.push([d.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):d(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),
this]);for(a=c.length-1;a>=0;a--)c[a][0].each(function(){b.push(this)});return d(b)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data(sortable-item)"),b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,1)},_refreshItems:function(a){this.items=[];this.containers=[this];var b=this.items,c=[[d.isFunction(this.options.items)?this.options.items.call(this.element[0],a,{item:this.currentItem}):d(this.options.items,this.element),
this]],e=this._connectWith();if(e)for(var f=e.length-1;f>=0;f--)for(var g=d(e[f]),h=g.length-1;h>=0;h--){var i=d.data(g[h],"sortable");if(i&&i!=this&&!i.options.disabled){c.push([d.isFunction(i.options.items)?i.options.items.call(i.element[0],a,{item:this.currentItem}):d(i.options.items,i.element),i]);this.containers.push(i)}}for(f=c.length-1;f>=0;f--){a=c[f][1];e=c[f][0];h=0;for(g=e.length;h<g;h++){i=d(e[h]);i.data("sortable-item",a);b.push({item:i,instance:a,width:0,height:0,left:0,top:0})}}},refreshPositions:function(a){if(this.offsetParent&&
this.helper)this.offset.parent=this._getParentOffset();for(var b=this.items.length-1;b>=0;b--){var c=this.items[b],e=this.options.toleranceElement?d(this.options.toleranceElement,c.item):c.item;if(!a){c.width=e.outerWidth();c.height=e.outerHeight()}e=e.offset();c.left=e.left;c.top=e.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(b=this.containers.length-1;b>=0;b--){e=this.containers[b].element.offset();this.containers[b].containerCache.left=
e.left;this.containers[b].containerCache.top=e.top;this.containers[b].containerCache.width=this.containers[b].element.outerWidth();this.containers[b].containerCache.height=this.containers[b].element.outerHeight()}return this},_createPlaceholder:function(a){var b=a||this,c=b.options;if(!c.placeholder||c.placeholder.constructor==String){var e=c.placeholder;c.placeholder={element:function(){var f=d(document.createElement(b.currentItem[0].nodeName)).addClass(e||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
if(!e)f.style.visibility="hidden";return f},update:function(f,g){if(!(e&&!c.forcePlaceholderSize)){g.height()||g.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10));g.width()||g.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}}}}b.placeholder=d(c.placeholder.element.call(b.element,b.currentItem));b.currentItem.after(b.placeholder);
c.placeholder.update(b,b.placeholder)},_contactContainers:function(a){for(var b=null,c=null,e=this.containers.length-1;e>=0;e--)if(!d.ui.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(!(b&&d.ui.contains(this.containers[e].element[0],b.element[0]))){b=this.containers[e];c=e}}else if(this.containers[e].containerCache.over){this.containers[e]._trigger("out",a,this._uiHash(this));this.containers[e].containerCache.over=0}if(b)if(this.containers.length===
1){this.containers[c]._trigger("over",a,this._uiHash(this));this.containers[c].containerCache.over=1}else if(this.currentContainer!=this.containers[c]){b=1E4;e=null;for(var f=this.positionAbs[this.containers[c].floating?"left":"top"],g=this.items.length-1;g>=0;g--)if(d.ui.contains(this.containers[c].element[0],this.items[g].item[0])){var h=this.items[g][this.containers[c].floating?"left":"top"];if(Math.abs(h-f)<b){b=Math.abs(h-f);e=this.items[g]}}if(e||this.options.dropOnEmpty){this.currentContainer=
this.containers[c];e?this._rearrange(a,e,null,true):this._rearrange(a,null,this.containers[c].element,true);this._trigger("change",a,this._uiHash());this.containers[c]._trigger("change",a,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[c]._trigger("over",a,this._uiHash(this));this.containers[c].containerCache.over=1}}},_createHelper:function(a){var b=this.options;a=d.isFunction(b.helper)?d(b.helper.apply(this.element[0],[a,this.currentItem])):
b.helper=="clone"?this.currentItem.clone():this.currentItem;a.parents("body").length||d(b.appendTo!="parent"?b.appendTo:this.currentItem[0].parentNode)[0].appendChild(a[0]);if(a[0]==this.currentItem[0])this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};if(a[0].style.width==""||b.forceHelperSize)a.width(this.currentItem.width());if(a[0].style.height==
""||b.forceHelperSize)a.height(this.currentItem.height());return a},_adjustOffsetFromHelper:function(a){if(typeof a=="string")a=a.split(" ");if(d.isArray(a))a={left:+a[0],top:+a[1]||0};if("left"in a)this.offset.click.left=a.left+this.margins.left;if("right"in a)this.offset.click.left=this.helperProportions.width-a.right+this.margins.left;if("top"in a)this.offset.click.top=a.top+this.margins.top;if("bottom"in a)this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=
this.helper.offsetParent();var a=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0])){a.left+=this.scrollParent.scrollLeft();a.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&d.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions=
{width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;if(a.containment=="parent")a.containment=this.helper[0].parentNode;if(a.containment=="document"||a.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,d(a.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(d(a.containment=="document"?document:window).height()||
document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)){var b=d(a.containment)[0];a=d(a.containment).offset();var c=d(b).css("overflow")!="hidden";this.containment=[a.left+(parseInt(d(b).css("borderLeftWidth"),10)||0)+(parseInt(d(b).css("paddingLeft"),10)||0)-this.margins.left,a.top+(parseInt(d(b).css("borderTopWidth"),10)||0)+(parseInt(d(b).css("paddingTop"),10)||0)-this.margins.top,a.left+(c?Math.max(b.scrollWidth,
b.offsetWidth):b.offsetWidth)-(parseInt(d(b).css("borderLeftWidth"),10)||0)-(parseInt(d(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,a.top+(c?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(d(b).css("borderTopWidth"),10)||0)-(parseInt(d(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(a,b){if(!b)b=this.position;a=a=="absolute"?1:-1;var c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=
document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(c[0].tagName);return{top:b.top+this.offset.relative.top*a+this.offset.parent.top*a-(d.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:c.scrollTop())*a),left:b.left+this.offset.relative.left*a+this.offset.parent.left*a-(d.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():
e?0:c.scrollLeft())*a)}},_generatePosition:function(a){var b=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(c[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]))this.offset.relative=this._getRelativeOffset();var f=a.pageX,g=a.pageY;if(this.originalPosition){if(this.containment){if(a.pageX-
this.offset.click.left<this.containment[0])f=this.containment[0]+this.offset.click.left;if(a.pageY-this.offset.click.top<this.containment[1])g=this.containment[1]+this.offset.click.top;if(a.pageX-this.offset.click.left>this.containment[2])f=this.containment[2]+this.offset.click.left;if(a.pageY-this.offset.click.top>this.containment[3])g=this.containment[3]+this.offset.click.top}if(b.grid){g=this.originalPageY+Math.round((g-this.originalPageY)/b.grid[1])*b.grid[1];g=this.containment?!(g-this.offset.click.top<
this.containment[1]||g-this.offset.click.top>this.containment[3])?g:!(g-this.offset.click.top<this.containment[1])?g-b.grid[1]:g+b.grid[1]:g;f=this.originalPageX+Math.round((f-this.originalPageX)/b.grid[0])*b.grid[0];f=this.containment?!(f-this.offset.click.left<this.containment[0]||f-this.offset.click.left>this.containment[2])?f:!(f-this.offset.click.left<this.containment[0])?f-b.grid[0]:f+b.grid[0]:f}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(d.browser.safari&&
this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:c.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(d.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:c.scrollLeft())}},_rearrange:function(a,b,c,e){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?b.item[0]:b.item[0].nextSibling);this.counter=
this.counter?++this.counter:1;var f=this,g=this.counter;window.setTimeout(function(){g==f.counter&&f.refreshPositions(!e)},0)},_clear:function(a,b){this.reverting=false;var c=[];!this._noFinalSort&&this.currentItem[0].parentNode&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var e in this._storedCSS)if(this._storedCSS[e]=="auto"||this._storedCSS[e]=="static")this._storedCSS[e]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();
this.fromOutside&&!b&&c.push(function(f){this._trigger("receive",f,this._uiHash(this.fromOutside))});if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!b)c.push(function(f){this._trigger("update",f,this._uiHash())});if(!d.ui.contains(this.element[0],this.currentItem[0])){b||c.push(function(f){this._trigger("remove",f,this._uiHash())});for(e=this.containers.length-1;e>=0;e--)if(d.ui.contains(this.containers[e].element[0],
this.currentItem[0])&&!b){c.push(function(f){return function(g){f._trigger("receive",g,this._uiHash(this))}}.call(this,this.containers[e]));c.push(function(f){return function(g){f._trigger("update",g,this._uiHash(this))}}.call(this,this.containers[e]))}}for(e=this.containers.length-1;e>=0;e--){b||c.push(function(f){return function(g){f._trigger("deactivate",g,this._uiHash(this))}}.call(this,this.containers[e]));if(this.containers[e].containerCache.over){c.push(function(f){return function(g){f._trigger("out",
g,this._uiHash(this))}}.call(this,this.containers[e]));this.containers[e].containerCache.over=0}}this._storedCursor&&d("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);if(this._storedZIndex)this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex);this.dragging=false;if(this.cancelHelperRemoval){if(!b){this._trigger("beforeStop",a,this._uiHash());for(e=0;e<c.length;e++)c[e].call(this,a);this._trigger("stop",a,this._uiHash())}return false}b||
this._trigger("beforeStop",a,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!b){for(e=0;e<c.length;e++)c[e].call(this,a);this._trigger("stop",a,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){d.Widget.prototype._trigger.apply(this,arguments)===false&&this.cancel()},_uiHash:function(a){var b=a||this;return{helper:b.helper,placeholder:b.placeholder||d([]),position:b.position,
originalPosition:b.originalPosition,offset:b.positionAbs,item:b.currentItem,sender:a?a.element:null}}});d.extend(d.ui.sortable,{version:"1.8.11"})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Accordion 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Accordion
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(c){c.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var a=this,b=a.options;a.running=0;a.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix");
a.headers=a.element.find(b.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){b.disabled||c(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){b.disabled||c(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){b.disabled||c(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){b.disabled||c(this).removeClass("ui-state-focus")});a.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");
if(b.navigation){var d=a.element.find("a").filter(b.navigationFilter).eq(0);if(d.length){var h=d.closest(".ui-accordion-header");a.active=h.length?h:d.closest(".ui-accordion-content").prev()}}a.active=a._findActive(a.active||b.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");a.active.next().addClass("ui-accordion-content-active");a._createIcons();a.resize();a.element.attr("role","tablist");a.headers.attr("role","tab").bind("keydown.accordion",
function(f){return a._keydown(f)}).next().attr("role","tabpanel");a.headers.not(a.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();a.active.length?a.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):a.headers.eq(0).attr("tabIndex",0);c.browser.safari||a.headers.find("a").attr("tabIndex",-1);b.event&&a.headers.bind(b.event.split(" ").join(".accordion ")+".accordion",function(f){a._clickHandler.call(a,f,this);f.preventDefault()})},_createIcons:function(){var a=
this.options;if(a.icons){c("<span></span>").addClass("ui-icon "+a.icons.header).prependTo(this.headers);this.active.children(".ui-icon").toggleClass(a.icons.header).toggleClass(a.icons.headerSelected);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var a=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex");
this.headers.find("a").removeAttr("tabIndex");this._destroyIcons();var b=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");if(a.autoHeight||a.fillHeight)b.css("height","");return c.Widget.prototype.destroy.call(this)},_setOption:function(a,b){c.Widget.prototype._setOption.apply(this,arguments);a=="active"&&this.activate(b);if(a=="icons"){this._destroyIcons();
b&&this._createIcons()}if(a=="disabled")this.headers.add(this.headers.next())[b?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")},_keydown:function(a){if(!(this.options.disabled||a.altKey||a.ctrlKey)){var b=c.ui.keyCode,d=this.headers.length,h=this.headers.index(a.target),f=false;switch(a.keyCode){case b.RIGHT:case b.DOWN:f=this.headers[(h+1)%d];break;case b.LEFT:case b.UP:f=this.headers[(h-1+d)%d];break;case b.SPACE:case b.ENTER:this._clickHandler({target:a.target},a.target);
a.preventDefault()}if(f){c(a.target).attr("tabIndex",-1);c(f).attr("tabIndex",0);f.focus();return false}return true}},resize:function(){var a=this.options,b;if(a.fillSpace){if(c.browser.msie){var d=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}b=this.element.parent().height();c.browser.msie&&this.element.parent().css("overflow",d);this.headers.each(function(){b-=c(this).outerHeight(true)});this.headers.next().each(function(){c(this).height(Math.max(0,b-c(this).innerHeight()+
c(this).height()))}).css("overflow","auto")}else if(a.autoHeight){b=0;this.headers.next().each(function(){b=Math.max(b,c(this).height("").height())}).height(b)}return this},activate:function(a){this.options.active=a;a=this._findActive(a)[0];this._clickHandler({target:a},a);return this},_findActive:function(a){return a?typeof a==="number"?this.headers.filter(":eq("+a+")"):this.headers.not(this.headers.not(a)):a===false?c([]):this.headers.filter(":eq(0)")},_clickHandler:function(a,b){var d=this.options;
if(!d.disabled)if(a.target){a=c(a.currentTarget||b);b=a[0]===this.active[0];d.active=d.collapsible&&b?false:this.headers.index(a);if(!(this.running||!d.collapsible&&b)){var h=this.active;j=a.next();g=this.active.next();e={options:d,newHeader:b&&d.collapsible?c([]):a,oldHeader:this.active,newContent:b&&d.collapsible?c([]):j,oldContent:g};var f=this.headers.index(this.active[0])>this.headers.index(a[0]);this.active=b?c([]):a;this._toggle(j,g,e,b,f);h.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header);
if(!b){a.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(d.icons.header).addClass(d.icons.headerSelected);a.next().addClass("ui-accordion-content-active")}}}else if(d.collapsible){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header);this.active.next().addClass("ui-accordion-content-active");var g=this.active.next(),
e={options:d,newHeader:c([]),oldHeader:d.active,newContent:c([]),oldContent:g},j=this.active=c([]);this._toggle(j,g,e)}},_toggle:function(a,b,d,h,f){var g=this,e=g.options;g.toShow=a;g.toHide=b;g.data=d;var j=function(){if(g)return g._completed.apply(g,arguments)};g._trigger("changestart",null,g.data);g.running=b.size()===0?a.size():b.size();if(e.animated){d={};d=e.collapsible&&h?{toShow:c([]),toHide:b,complete:j,down:f,autoHeight:e.autoHeight||e.fillSpace}:{toShow:a,toHide:b,complete:j,down:f,autoHeight:e.autoHeight||
e.fillSpace};if(!e.proxied)e.proxied=e.animated;if(!e.proxiedDuration)e.proxiedDuration=e.duration;e.animated=c.isFunction(e.proxied)?e.proxied(d):e.proxied;e.duration=c.isFunction(e.proxiedDuration)?e.proxiedDuration(d):e.proxiedDuration;h=c.ui.accordion.animations;var i=e.duration,k=e.animated;if(k&&!h[k]&&!c.easing[k])k="slide";h[k]||(h[k]=function(l){this.slide(l,{easing:k,duration:i||700})});h[k](d)}else{if(e.collapsible&&h)a.toggle();else{b.hide();a.show()}j(true)}b.prev().attr({"aria-expanded":"false",
"aria-selected":"false",tabIndex:-1}).blur();a.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(a){this.running=a?0:--this.running;if(!this.running){this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""});this.toHide.removeClass("ui-accordion-content-active");if(this.toHide.length)this.toHide.parent()[0].className=this.toHide.parent()[0].className;this._trigger("change",null,this.data)}}});c.extend(c.ui.accordion,{version:"1.8.11",
animations:{slide:function(a,b){a=c.extend({easing:"swing",duration:300},a,b);if(a.toHide.size())if(a.toShow.size()){var d=a.toShow.css("overflow"),h=0,f={},g={},e;b=a.toShow;e=b[0].style.width;b.width(parseInt(b.parent().width(),10)-parseInt(b.css("paddingLeft"),10)-parseInt(b.css("paddingRight"),10)-(parseInt(b.css("borderLeftWidth"),10)||0)-(parseInt(b.css("borderRightWidth"),10)||0));c.each(["height","paddingTop","paddingBottom"],function(j,i){g[i]="hide";j=(""+c.css(a.toShow[0],i)).match(/^([\d+-.]+)(.*)$/);
f[i]={value:j[1],unit:j[2]||"px"}});a.toShow.css({height:0,overflow:"hidden"}).show();a.toHide.filter(":hidden").each(a.complete).end().filter(":visible").animate(g,{step:function(j,i){if(i.prop=="height")h=i.end-i.start===0?0:(i.now-i.start)/(i.end-i.start);a.toShow[0].style[i.prop]=h*f[i.prop].value+f[i.prop].unit},duration:a.duration,easing:a.easing,complete:function(){a.autoHeight||a.toShow.css("height","");a.toShow.css({width:e,overflow:d});a.complete()}})}else a.toHide.animate({height:"hide",
paddingTop:"hide",paddingBottom:"hide"},a);else a.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},a)},bounceslide:function(a){this.slide(a,{easing:a.down?"easeOutBounce":"swing",duration:a.down?1E3:200})}}})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Autocomplete 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Autocomplete
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 */
(function(d){var e=0;d.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var a=this,b=this.element[0].ownerDocument,g;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(!(a.options.disabled||a.element.attr("readonly"))){g=
false;var f=d.ui.keyCode;switch(c.keyCode){case f.PAGE_UP:a._move("previousPage",c);break;case f.PAGE_DOWN:a._move("nextPage",c);break;case f.UP:a._move("previous",c);c.preventDefault();break;case f.DOWN:a._move("next",c);c.preventDefault();break;case f.ENTER:case f.NUMPAD_ENTER:if(a.menu.active){g=true;c.preventDefault()}case f.TAB:if(!a.menu.active)return;a.menu.select(c);break;case f.ESCAPE:a.element.val(a.term);a.close(c);break;default:clearTimeout(a.searching);a.searching=setTimeout(function(){if(a.term!=
a.element.val()){a.selectedItem=null;a.search(null,c)}},a.options.delay);break}}}).bind("keypress.autocomplete",function(c){if(g){g=false;c.preventDefault()}}).bind("focus.autocomplete",function(){if(!a.options.disabled){a.selectedItem=null;a.previous=a.element.val()}}).bind("blur.autocomplete",function(c){if(!a.options.disabled){clearTimeout(a.searching);a.closing=setTimeout(function(){a.close(c);a._change(c)},150)}});this._initSource();this.response=function(){return a._response.apply(a,arguments)};
this.menu=d("<ul></ul>").addClass("ui-autocomplete").appendTo(d(this.options.appendTo||"body",b)[0]).mousedown(function(c){var f=a.menu.element[0];d(c.target).closest(".ui-menu-item").length||setTimeout(function(){d(document).one("mousedown",function(h){h.target!==a.element[0]&&h.target!==f&&!d.ui.contains(f,h.target)&&a.close()})},1);setTimeout(function(){clearTimeout(a.closing)},13)}).menu({focus:function(c,f){f=f.item.data("item.autocomplete");false!==a._trigger("focus",c,{item:f})&&/^key/.test(c.originalEvent.type)&&
a.element.val(f.value)},selected:function(c,f){var h=f.item.data("item.autocomplete"),i=a.previous;if(a.element[0]!==b.activeElement){a.element.focus();a.previous=i;setTimeout(function(){a.previous=i;a.selectedItem=h},1)}false!==a._trigger("select",c,{item:h})&&a.element.val(h.value);a.term=a.element.val();a.close(c);a.selectedItem=h},blur:function(){a.menu.element.is(":visible")&&a.element.val()!==a.term&&a.element.val(a.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");
d.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();d.Widget.prototype.destroy.call(this)},_setOption:function(a,b){d.Widget.prototype._setOption.apply(this,arguments);a==="source"&&this._initSource();if(a==="appendTo")this.menu.element.appendTo(d(b||"body",this.element[0].ownerDocument)[0]);a==="disabled"&&
b&&this.xhr&&this.xhr.abort()},_initSource:function(){var a=this,b,g;if(d.isArray(this.options.source)){b=this.options.source;this.source=function(c,f){f(d.ui.autocomplete.filter(b,c.term))}}else if(typeof this.options.source==="string"){g=this.options.source;this.source=function(c,f){a.xhr&&a.xhr.abort();a.xhr=d.ajax({url:g,data:c,dataType:"json",autocompleteRequest:++e,success:function(h){this.autocompleteRequest===e&&f(h)},error:function(){this.autocompleteRequest===e&&f([])}})}}else this.source=
this.options.source},search:function(a,b){a=a!=null?a:this.element.val();this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);if(this._trigger("search",b)!==false)return this._search(a)},_search:function(a){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:a},this.response)},_response:function(a){if(!this.options.disabled&&a&&a.length){a=this._normalize(a);this._suggest(a);this._trigger("open")}else this.close();
this.pending--;this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",a)}},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(a){if(a.length&&a[0].label&&a[0].value)return a;return d.map(a,function(b){if(typeof b==="string")return{label:b,value:b};return d.extend({label:b.label||
b.value,value:b.value||b.label},b)})},_suggest:function(a){var b=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(b,a);this.menu.deactivate();this.menu.refresh();b.show();this._resizeMenu();b.position(d.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next(new d.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(a,b){var g=this;
d.each(b,function(c,f){g._renderItem(a,f)})},_renderItem:function(a,b){return d("<li></li>").data("item.autocomplete",b).append(d("<a></a>").text(b.label)).appendTo(a)},_move:function(a,b){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this.element.val(this.term);this.menu.deactivate()}else this.menu[a](b);else this.search(null,b)},widget:function(){return this.menu.element}});d.extend(d.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,
"\\$&")},filter:function(a,b){var g=new RegExp(d.ui.autocomplete.escapeRegex(b),"i");return d.grep(a,function(c){return g.test(c.label||c.value||c)})}})})(jQuery);
(function(d){d.widget("ui.menu",{_create:function(){var e=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(a){if(d(a.target).closest(".ui-menu-item a").length){a.preventDefault();e.select(a)}});this.refresh()},refresh:function(){var e=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
-1).mouseenter(function(a){e.activate(a,d(this).parent())}).mouseleave(function(){e.deactivate()})},activate:function(e,a){this.deactivate();if(this.hasScroll()){var b=a.offset().top-this.element.offset().top,g=this.element.attr("scrollTop"),c=this.element.height();if(b<0)this.element.attr("scrollTop",g+b);else b>=c&&this.element.attr("scrollTop",g+b-c+a.height())}this.active=a.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",e,{item:a})},
deactivate:function(){if(this.active){this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null}},next:function(e){this.move("next",".ui-menu-item:first",e)},previous:function(e){this.move("prev",".ui-menu-item:last",e)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(e,a,b){if(this.active){e=this.active[e+"All"](".ui-menu-item").eq(0);
e.length?this.activate(b,e):this.activate(b,this.element.children(a))}else this.activate(b,this.element.children(a))},nextPage:function(e){if(this.hasScroll())if(!this.active||this.last())this.activate(e,this.element.children(".ui-menu-item:first"));else{var a=this.active.offset().top,b=this.element.height(),g=this.element.children(".ui-menu-item").filter(function(){var c=d(this).offset().top-a-b+d(this).height();return c<10&&c>-10});g.length||(g=this.element.children(".ui-menu-item:last"));this.activate(e,
g)}else this.activate(e,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(e){if(this.hasScroll())if(!this.active||this.first())this.activate(e,this.element.children(".ui-menu-item:last"));else{var a=this.active.offset().top,b=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var g=d(this).offset().top-a+b-d(this).height();return g<10&&g>-10});result.length||(result=this.element.children(".ui-menu-item:first"));
this.activate(e,result)}else this.activate(e,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(e){this._trigger("selected",e,{item:this.active})}})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Button 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Button
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(a){var g,i=function(b){a(":ui-button",b.target.form).each(function(){var c=a(this).data("button");setTimeout(function(){c.refresh()},1)})},h=function(b){var c=b.name,d=b.form,f=a([]);if(c)f=d?a(d).find("[name='"+c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form});return f};a.widget("ui.button",{options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",
i);if(typeof this.options.disabled!=="boolean")this.options.disabled=this.element.attr("disabled");this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var b=this,c=this.options,d=this.type==="checkbox"||this.type==="radio",f="ui-state-hover"+(!d?" ui-state-active":"");if(c.label===null)c.label=this.buttonElement.html();if(this.element.is(":disabled"))c.disabled=true;this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",
function(){if(!c.disabled){a(this).addClass("ui-state-hover");this===g&&a(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){c.disabled||a(this).removeClass(f)}).bind("focus.button",function(){a(this).addClass("ui-state-focus")}).bind("blur.button",function(){a(this).removeClass("ui-state-focus")});d&&this.element.bind("change.button",function(){b.refresh()});if(this.type==="checkbox")this.buttonElement.bind("click.button",function(){if(c.disabled)return false;a(this).toggleClass("ui-state-active");
b.buttonElement.attr("aria-pressed",b.element[0].checked)});else if(this.type==="radio")this.buttonElement.bind("click.button",function(){if(c.disabled)return false;a(this).addClass("ui-state-active");b.buttonElement.attr("aria-pressed",true);var e=b.element[0];h(e).not(e).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",false)});else{this.buttonElement.bind("mousedown.button",function(){if(c.disabled)return false;a(this).addClass("ui-state-active");
g=this;a(document).one("mouseup",function(){g=null})}).bind("mouseup.button",function(){if(c.disabled)return false;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(e){if(c.disabled)return false;if(e.keyCode==a.ui.keyCode.SPACE||e.keyCode==a.ui.keyCode.ENTER)a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")});this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===a.ui.keyCode.SPACE&&a(this).click()})}this._setOption("disabled",
c.disabled)},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if(this.type==="checkbox"||this.type==="radio"){var b=this.element.parents().filter(":last"),c="label[for="+this.element.attr("id")+"]";this.buttonElement=b.find(c);if(!this.buttonElement.length){b=b.length?b.siblings():this.element.siblings();this.buttonElement=b.filter(c);if(!this.buttonElement.length)this.buttonElement=b.find(c)}this.element.addClass("ui-helper-hidden-accessible");
(b=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active");this.buttonElement.attr("aria-pressed",b)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title");a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments);if(b==="disabled")c?this.element.attr("disabled",true):this.element.removeAttr("disabled");this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b);if(this.type==="radio")h(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
true):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false)});else if(this.type==="checkbox")this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false)},_resetButton:function(){if(this.type==="input")this.options.label&&this.element.val(this.options.label);else{var b=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
c=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,f=d.primary&&d.secondary,e=[];if(d.primary||d.secondary){if(this.options.text)e.push("ui-button-text-icon"+(f?"s":d.primary?"-primary":"-secondary"));d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>");d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>");if(!this.options.text){e.push(f?"ui-button-icons-only":
"ui-button-icon-only");this.hasTitle||b.attr("title",c)}}else e.push("ui-button-text-only");b.addClass(e.join(" "))}}});a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(b,c){b==="disabled"&&this.buttons.button("option",b,c);a.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass("ui-corner-left").end().filter(":last").addClass("ui-corner-right").end().end()},
destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");a.Widget.prototype.destroy.call(this)}})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Dialog 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Dialog
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *  jquery.ui.button.js
 *	jquery.ui.draggable.js
 *	jquery.ui.mouse.js
 *	jquery.ui.position.js
 *	jquery.ui.resizable.js
 */
(function(c,j){var k={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},l={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};c.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",collision:"fit",using:function(a){var b=c(this).css(a).offset().top;b<0&&
c(this).css("top",a.top-b)}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string")this.originalTitle="";this.options.title=this.options.title||this.originalTitle;var a=this,b=a.options,d=b.title||"&#160;",e=c.ui.dialog.getTitleId(a.element),g=(a.uiDialog=c("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b.dialogClass).css({zIndex:b.zIndex}).attr("tabIndex",
-1).css("outline",0).keydown(function(i){if(b.closeOnEscape&&i.keyCode&&i.keyCode===c.ui.keyCode.ESCAPE){a.close(i);i.preventDefault()}}).attr({role:"dialog","aria-labelledby":e}).mousedown(function(i){a.moveToTop(false,i)});a.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(g);var f=(a.uiDialogTitlebar=c("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(g),h=c('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role",
"button").hover(function(){h.addClass("ui-state-hover")},function(){h.removeClass("ui-state-hover")}).focus(function(){h.addClass("ui-state-focus")}).blur(function(){h.removeClass("ui-state-focus")}).click(function(i){a.close(i);return false}).appendTo(f);(a.uiDialogTitlebarCloseText=c("<span></span>")).addClass("ui-icon ui-icon-closethick").text(b.closeText).appendTo(h);c("<span></span>").addClass("ui-dialog-title").attr("id",e).html(d).prependTo(f);if(c.isFunction(b.beforeclose)&&!c.isFunction(b.beforeClose))b.beforeClose=
b.beforeclose;f.find("*").add(f).disableSelection();b.draggable&&c.fn.draggable&&a._makeDraggable();b.resizable&&c.fn.resizable&&a._makeResizable();a._createButtons(b.buttons);a._isOpen=false;c.fn.bgiframe&&g.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var a=this;a.overlay&&a.overlay.destroy();a.uiDialog.hide();a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");a.uiDialog.remove();a.originalTitle&&
a.element.attr("title",a.originalTitle);return a},widget:function(){return this.uiDialog},close:function(a){var b=this,d,e;if(false!==b._trigger("beforeClose",a)){b.overlay&&b.overlay.destroy();b.uiDialog.unbind("keypress.ui-dialog");b._isOpen=false;if(b.options.hide)b.uiDialog.hide(b.options.hide,function(){b._trigger("close",a)});else{b.uiDialog.hide();b._trigger("close",a)}c.ui.dialog.overlay.resize();if(b.options.modal){d=0;c(".ui-dialog").each(function(){if(this!==b.uiDialog[0]){e=c(this).css("z-index");
isNaN(e)||(d=Math.max(d,e))}});c.ui.dialog.maxZ=d}return b}},isOpen:function(){return this._isOpen},moveToTop:function(a,b){var d=this,e=d.options;if(e.modal&&!a||!e.stack&&!e.modal)return d._trigger("focus",b);if(e.zIndex>c.ui.dialog.maxZ)c.ui.dialog.maxZ=e.zIndex;if(d.overlay){c.ui.dialog.maxZ+=1;d.overlay.$el.css("z-index",c.ui.dialog.overlay.maxZ=c.ui.dialog.maxZ)}a={scrollTop:d.element.attr("scrollTop"),scrollLeft:d.element.attr("scrollLeft")};c.ui.dialog.maxZ+=1;d.uiDialog.css("z-index",c.ui.dialog.maxZ);
d.element.attr(a);d._trigger("focus",b);return d},open:function(){if(!this._isOpen){var a=this,b=a.options,d=a.uiDialog;a.overlay=b.modal?new c.ui.dialog.overlay(a):null;a._size();a._position(b.position);d.show(b.show);a.moveToTop(true);b.modal&&d.bind("keypress.ui-dialog",function(e){if(e.keyCode===c.ui.keyCode.TAB){var g=c(":tabbable",this),f=g.filter(":first");g=g.filter(":last");if(e.target===g[0]&&!e.shiftKey){f.focus(1);return false}else if(e.target===f[0]&&e.shiftKey){g.focus(1);return false}}});
c(a.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus();a._isOpen=true;a._trigger("open");return a}},_createButtons:function(a){var b=this,d=false,e=c("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),g=c("<div></div>").addClass("ui-dialog-buttonset").appendTo(e);b.uiDialog.find(".ui-dialog-buttonpane").remove();typeof a==="object"&&a!==null&&c.each(a,function(){return!(d=true)});if(d){c.each(a,function(f,
h){h=c.isFunction(h)?{click:h,text:f}:h;f=c('<button type="button"></button>').attr(h,true).unbind("click").click(function(){h.click.apply(b.element[0],arguments)}).appendTo(g);c.fn.button&&f.button()});e.appendTo(b.uiDialog)}},_makeDraggable:function(){function a(f){return{position:f.position,offset:f.offset}}var b=this,d=b.options,e=c(document),g;b.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(f,h){g=
d.height==="auto"?"auto":c(this).height();c(this).height(c(this).height()).addClass("ui-dialog-dragging");b._trigger("dragStart",f,a(h))},drag:function(f,h){b._trigger("drag",f,a(h))},stop:function(f,h){d.position=[h.position.left-e.scrollLeft(),h.position.top-e.scrollTop()];c(this).removeClass("ui-dialog-dragging").height(g);b._trigger("dragStop",f,a(h));c.ui.dialog.overlay.resize()}})},_makeResizable:function(a){function b(f){return{originalPosition:f.originalPosition,originalSize:f.originalSize,
position:f.position,size:f.size}}a=a===j?this.options.resizable:a;var d=this,e=d.options,g=d.uiDialog.css("position");a=typeof a==="string"?a:"n,e,s,w,se,sw,ne,nw";d.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:d.element,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:d._minHeight(),handles:a,start:function(f,h){c(this).addClass("ui-dialog-resizing");d._trigger("resizeStart",f,b(h))},resize:function(f,h){d._trigger("resize",f,b(h))},stop:function(f,
h){c(this).removeClass("ui-dialog-resizing");e.height=c(this).height();e.width=c(this).width();d._trigger("resizeStop",f,b(h));c.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(a){var b=[],d=[0,0],e;if(a){if(typeof a==="string"||typeof a==="object"&&"0"in a){b=a.split?a.split(" "):[a[0],a[1]];if(b.length===
1)b[1]=b[0];c.each(["left","top"],function(g,f){if(+b[g]===b[g]){d[g]=b[g];b[g]=f}});a={my:b.join(" "),at:b.join(" "),offset:d.join(" ")}}a=c.extend({},c.ui.dialog.prototype.options.position,a)}else a=c.ui.dialog.prototype.options.position;(e=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(c.extend({of:window},a));e||this.uiDialog.hide()},_setOptions:function(a){var b=this,d={},e=false;c.each(a,function(g,f){b._setOption(g,f);if(g in k)e=true;if(g in
l)d[g]=f});e&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",d)},_setOption:function(a,b){var d=this,e=d.uiDialog;switch(a){case "beforeclose":a="beforeClose";break;case "buttons":d._createButtons(b);break;case "closeText":d.uiDialogTitlebarCloseText.text(""+b);break;case "dialogClass":e.removeClass(d.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b);break;case "disabled":b?e.addClass("ui-dialog-disabled"):e.removeClass("ui-dialog-disabled");
break;case "draggable":var g=e.is(":data(draggable)");g&&!b&&e.draggable("destroy");!g&&b&&d._makeDraggable();break;case "position":d._position(b);break;case "resizable":(g=e.is(":data(resizable)"))&&!b&&e.resizable("destroy");g&&typeof b==="string"&&e.resizable("option","handles",b);!g&&b!==false&&d._makeResizable(b);break;case "title":c(".ui-dialog-title",d.uiDialogTitlebar).html(""+(b||"&#160;"));break}c.Widget.prototype._setOption.apply(d,arguments)},_size:function(){var a=this.options,b,d,e=
this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(a.minWidth>a.width)a.width=a.minWidth;b=this.uiDialog.css({height:"auto",width:a.width}).height();d=Math.max(0,a.minHeight-b);if(a.height==="auto")if(c.support.minHeight)this.element.css({minHeight:d,height:"auto"});else{this.uiDialog.show();a=this.element.css("height","auto").height();e||this.uiDialog.hide();this.element.height(Math.max(a,d))}else this.element.height(Math.max(a.height-b,0));this.uiDialog.is(":data(resizable)")&&
this.uiDialog.resizable("option","minHeight",this._minHeight())}});c.extend(c.ui.dialog,{version:"1.8.11",uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");if(!a){this.uuid+=1;a=this.uuid}return"ui-dialog-title-"+a},overlay:function(a){this.$el=c.ui.dialog.overlay.create(a)}});c.extend(c.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:c.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(a){if(this.instances.length===
0){setTimeout(function(){c.ui.dialog.overlay.instances.length&&c(document).bind(c.ui.dialog.overlay.events,function(d){if(c(d.target).zIndex()<c.ui.dialog.overlay.maxZ)return false})},1);c(document).bind("keydown.dialog-overlay",function(d){if(a.options.closeOnEscape&&d.keyCode&&d.keyCode===c.ui.keyCode.ESCAPE){a.close(d);d.preventDefault()}});c(window).bind("resize.dialog-overlay",c.ui.dialog.overlay.resize)}var b=(this.oldInstances.pop()||c("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),
height:this.height()});c.fn.bgiframe&&b.bgiframe();this.instances.push(b);return b},destroy:function(a){var b=c.inArray(a,this.instances);b!=-1&&this.oldInstances.push(this.instances.splice(b,1)[0]);this.instances.length===0&&c([document,window]).unbind(".dialog-overlay");a.remove();var d=0;c.each(this.instances,function(){d=Math.max(d,this.css("z-index"))});this.maxZ=d},height:function(){var a,b;if(c.browser.msie&&c.browser.version<7){a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);
b=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return a<b?c(window).height()+"px":a+"px"}else return c(document).height()+"px"},width:function(){var a,b;if(c.browser.msie&&c.browser.version<7){a=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);b=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);return a<b?c(window).width()+"px":a+"px"}else return c(document).width()+"px"},resize:function(){var a=c([]);c.each(c.ui.dialog.overlay.instances,
function(){a=a.add(this)});a.css({width:0,height:0}).css({width:c.ui.dialog.overlay.width(),height:c.ui.dialog.overlay.height()})}});c.extend(c.ui.dialog.overlay.prototype,{destroy:function(){c.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Slider 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Slider
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(d){d.widget("ui.slider",d.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var b=this,a=this.options;this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");a.disabled&&this.element.addClass("ui-slider-disabled ui-disabled");
this.range=d([]);if(a.range){if(a.range===true){this.range=d("<div></div>");if(!a.values)a.values=[this._valueMin(),this._valueMin()];if(a.values.length&&a.values.length!==2)a.values=[a.values[0],a.values[0]]}else this.range=d("<div></div>");this.range.appendTo(this.element).addClass("ui-slider-range");if(a.range==="min"||a.range==="max")this.range.addClass("ui-slider-range-"+a.range);this.range.addClass("ui-widget-header")}d(".ui-slider-handle",this.element).length===0&&d("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");
if(a.values&&a.values.length)for(;d(".ui-slider-handle",this.element).length<a.values.length;)d("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");this.handles=d(".ui-slider-handle",this.element).addClass("ui-state-default ui-corner-all");this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(c){c.preventDefault()}).hover(function(){a.disabled||d(this).addClass("ui-state-hover")},function(){d(this).removeClass("ui-state-hover")}).focus(function(){if(a.disabled)d(this).blur();
else{d(".ui-slider .ui-state-focus").removeClass("ui-state-focus");d(this).addClass("ui-state-focus")}}).blur(function(){d(this).removeClass("ui-state-focus")});this.handles.each(function(c){d(this).data("index.ui-slider-handle",c)});this.handles.keydown(function(c){var e=true,f=d(this).data("index.ui-slider-handle"),h,g,i;if(!b.options.disabled){switch(c.keyCode){case d.ui.keyCode.HOME:case d.ui.keyCode.END:case d.ui.keyCode.PAGE_UP:case d.ui.keyCode.PAGE_DOWN:case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:e=
false;if(!b._keySliding){b._keySliding=true;d(this).addClass("ui-state-active");h=b._start(c,f);if(h===false)return}break}i=b.options.step;h=b.options.values&&b.options.values.length?(g=b.values(f)):(g=b.value());switch(c.keyCode){case d.ui.keyCode.HOME:g=b._valueMin();break;case d.ui.keyCode.END:g=b._valueMax();break;case d.ui.keyCode.PAGE_UP:g=b._trimAlignValue(h+(b._valueMax()-b._valueMin())/5);break;case d.ui.keyCode.PAGE_DOWN:g=b._trimAlignValue(h-(b._valueMax()-b._valueMin())/5);break;case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:if(h===
b._valueMax())return;g=b._trimAlignValue(h+i);break;case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(h===b._valueMin())return;g=b._trimAlignValue(h-i);break}b._slide(c,f,g);return e}}).keyup(function(c){var e=d(this).data("index.ui-slider-handle");if(b._keySliding){b._keySliding=false;b._stop(c,e);b._change(c,e);d(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");
this._mouseDestroy();return this},_mouseCapture:function(b){var a=this.options,c,e,f,h,g;if(a.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:b.pageX,y:b.pageY});e=this._valueMax()-this._valueMin()+1;h=this;this.handles.each(function(i){var j=Math.abs(c-h.values(i));if(e>j){e=j;f=d(this);g=i}});if(a.range===true&&this.values(1)===a.min){g+=1;f=d(this.handles[g])}if(this._start(b,
g)===false)return false;this._mouseSliding=true;h._handleIndex=g;f.addClass("ui-state-active").focus();a=f.offset();this._clickOffset=!d(b.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:b.pageX-a.left-f.width()/2,top:b.pageY-a.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(b,g,c);return this._animateOff=true},_mouseStart:function(){return true},
_mouseDrag:function(b){var a=this._normValueFromMouse({x:b.pageX,y:b.pageY});this._slide(b,this._handleIndex,a);return false},_mouseStop:function(b){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(b,this._handleIndex);this._change(b,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(b){var a;
if(this.orientation==="horizontal"){a=this.elementSize.width;b=b.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{a=this.elementSize.height;b=b.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}a=b/a;if(a>1)a=1;if(a<0)a=0;if(this.orientation==="vertical")a=1-a;b=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+a*b)},_start:function(b,a){var c={handle:this.handles[a],value:this.value()};if(this.options.values&&this.options.values.length){c.value=
this.values(a);c.values=this.values()}return this._trigger("start",b,c)},_slide:function(b,a,c){var e;if(this.options.values&&this.options.values.length){e=this.values(a?0:1);if(this.options.values.length===2&&this.options.range===true&&(a===0&&c>e||a===1&&c<e))c=e;if(c!==this.values(a)){e=this.values();e[a]=c;b=this._trigger("slide",b,{handle:this.handles[a],value:c,values:e});this.values(a?0:1);b!==false&&this.values(a,c,true)}}else if(c!==this.value()){b=this._trigger("slide",b,{handle:this.handles[a],
value:c});b!==false&&this.value(c)}},_stop:function(b,a){var c={handle:this.handles[a],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(a);c.values=this.values()}this._trigger("stop",b,c)},_change:function(b,a){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[a],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(a);c.values=this.values()}this._trigger("change",b,c)}},value:function(b){if(arguments.length){this.options.value=
this._trimAlignValue(b);this._refreshValue();this._change(null,0)}return this._value()},values:function(b,a){var c,e,f;if(arguments.length>1){this.options.values[b]=this._trimAlignValue(a);this._refreshValue();this._change(null,b)}if(arguments.length)if(d.isArray(arguments[0])){c=this.options.values;e=arguments[0];for(f=0;f<c.length;f+=1){c[f]=this._trimAlignValue(e[f]);this._change(null,f)}this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(b):this.value();
else return this._values()},_setOption:function(b,a){var c,e=0;if(d.isArray(this.options.values))e=this.options.values.length;d.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":if(a){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.attr("disabled","disabled");this.element.addClass("ui-disabled")}else{this.handles.removeAttr("disabled");this.element.removeClass("ui-disabled")}break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(c=0;c<e;c+=1)this._change(null,c);this._animateOff=false;break}},_value:function(){var b=this.options.value;return b=this._trimAlignValue(b)},_values:function(b){var a,c;if(arguments.length){a=this.options.values[b];
return a=this._trimAlignValue(a)}else{a=this.options.values.slice();for(c=0;c<a.length;c+=1)a[c]=this._trimAlignValue(a[c]);return a}},_trimAlignValue:function(b){if(b<=this._valueMin())return this._valueMin();if(b>=this._valueMax())return this._valueMax();var a=this.options.step>0?this.options.step:1,c=(b-this._valueMin())%a;alignValue=b-c;if(Math.abs(c)*2>=a)alignValue+=c>0?a:-a;return parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},
_refreshValue:function(){var b=this.options.range,a=this.options,c=this,e=!this._animateOff?a.animate:false,f,h={},g,i,j,l;if(this.options.values&&this.options.values.length)this.handles.each(function(k){f=(c.values(k)-c._valueMin())/(c._valueMax()-c._valueMin())*100;h[c.orientation==="horizontal"?"left":"bottom"]=f+"%";d(this).stop(1,1)[e?"animate":"css"](h,a.animate);if(c.options.range===true)if(c.orientation==="horizontal"){if(k===0)c.range.stop(1,1)[e?"animate":"css"]({left:f+"%"},a.animate);
if(k===1)c.range[e?"animate":"css"]({width:f-g+"%"},{queue:false,duration:a.animate})}else{if(k===0)c.range.stop(1,1)[e?"animate":"css"]({bottom:f+"%"},a.animate);if(k===1)c.range[e?"animate":"css"]({height:f-g+"%"},{queue:false,duration:a.animate})}g=f});else{i=this.value();j=this._valueMin();l=this._valueMax();f=l!==j?(i-j)/(l-j)*100:0;h[c.orientation==="horizontal"?"left":"bottom"]=f+"%";this.handle.stop(1,1)[e?"animate":"css"](h,a.animate);if(b==="min"&&this.orientation==="horizontal")this.range.stop(1,
1)[e?"animate":"css"]({width:f+"%"},a.animate);if(b==="max"&&this.orientation==="horizontal")this.range[e?"animate":"css"]({width:100-f+"%"},{queue:false,duration:a.animate});if(b==="min"&&this.orientation==="vertical")this.range.stop(1,1)[e?"animate":"css"]({height:f+"%"},a.animate);if(b==="max"&&this.orientation==="vertical")this.range[e?"animate":"css"]({height:100-f+"%"},{queue:false,duration:a.animate})}}});d.extend(d.ui.slider,{version:"1.8.11"})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Tabs 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Tabs
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(d,p){function u(){return++v}function w(){return++x}var v=0,x=0;d.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(true)},_setOption:function(b,e){if(b=="selected")this.options.collapsible&&
e==this.options.selected||this.select(e);else{this.options[b]=e;this._tabify()}},_tabId:function(b){return b.title&&b.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+u()},_sanitizeSelector:function(b){return b.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+w());return d.cookie.apply(null,[b].concat(d.makeArray(arguments)))},_ui:function(b,e){return{tab:b,panel:e,index:this.anchors.index(b)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=
d(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(b){function e(g,f){g.css("display","");!d.support.opacity&&f.opacity&&g[0].style.removeAttribute("filter")}var a=this,c=this.options,h=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=d(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return d("a",this)[0]});this.panels=d([]);this.anchors.each(function(g,f){var i=d(f).attr("href"),l=i.split("#")[0],q;if(l&&(l===location.toString().split("#")[0]||
(q=d("base")[0])&&l===q.href)){i=f.hash;f.href=i}if(h.test(i))a.panels=a.panels.add(a.element.find(a._sanitizeSelector(i)));else if(i&&i!=="#"){d.data(f,"href.tabs",i);d.data(f,"load.tabs",i.replace(/#.*$/,""));i=a._tabId(f);f.href="#"+i;f=a.element.find("#"+i);if(!f.length){f=d(c.panelTemplate).attr("id",i).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(a.panels[g-1]||a.list);f.data("destroy.tabs",true)}a.panels=a.panels.add(f)}else c.disabled.push(g)});if(b){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");
this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(c.selected===p){location.hash&&this.anchors.each(function(g,f){if(f.hash==location.hash){c.selected=g;return false}});if(typeof c.selected!=="number"&&c.cookie)c.selected=parseInt(a._cookie(),10);if(typeof c.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length)c.selected=
this.lis.index(this.lis.filter(".ui-tabs-selected"));c.selected=c.selected||(this.lis.length?0:-1)}else if(c.selected===null)c.selected=-1;c.selected=c.selected>=0&&this.anchors[c.selected]||c.selected<0?c.selected:0;c.disabled=d.unique(c.disabled.concat(d.map(this.lis.filter(".ui-state-disabled"),function(g){return a.lis.index(g)}))).sort();d.inArray(c.selected,c.disabled)!=-1&&c.disabled.splice(d.inArray(c.selected,c.disabled),1);this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");
if(c.selected>=0&&this.anchors.length){a.element.find(a._sanitizeSelector(a.anchors[c.selected].hash)).removeClass("ui-tabs-hide");this.lis.eq(c.selected).addClass("ui-tabs-selected ui-state-active");a.element.queue("tabs",function(){a._trigger("show",null,a._ui(a.anchors[c.selected],a.element.find(a._sanitizeSelector(a.anchors[c.selected].hash))[0]))});this.load(c.selected)}d(window).bind("unload",function(){a.lis.add(a.anchors).unbind(".tabs");a.lis=a.anchors=a.panels=null})}else c.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));
this.element[c.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");c.cookie&&this._cookie(c.selected,c.cookie);b=0;for(var j;j=this.lis[b];b++)d(j)[d.inArray(b,c.disabled)!=-1&&!d(j).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");c.cache===false&&this.anchors.removeData("cache.tabs");this.lis.add(this.anchors).unbind(".tabs");if(c.event!=="mouseover"){var k=function(g,f){f.is(":not(.ui-state-disabled)")&&f.addClass("ui-state-"+g)},n=function(g,f){f.removeClass("ui-state-"+
g)};this.lis.bind("mouseover.tabs",function(){k("hover",d(this))});this.lis.bind("mouseout.tabs",function(){n("hover",d(this))});this.anchors.bind("focus.tabs",function(){k("focus",d(this).closest("li"))});this.anchors.bind("blur.tabs",function(){n("focus",d(this).closest("li"))})}var m,o;if(c.fx)if(d.isArray(c.fx)){m=c.fx[0];o=c.fx[1]}else m=o=c.fx;var r=o?function(g,f){d(g).closest("li").addClass("ui-tabs-selected ui-state-active");f.hide().removeClass("ui-tabs-hide").animate(o,o.duration||"normal",
function(){e(f,o);a._trigger("show",null,a._ui(g,f[0]))})}:function(g,f){d(g).closest("li").addClass("ui-tabs-selected ui-state-active");f.removeClass("ui-tabs-hide");a._trigger("show",null,a._ui(g,f[0]))},s=m?function(g,f){f.animate(m,m.duration||"normal",function(){a.lis.removeClass("ui-tabs-selected ui-state-active");f.addClass("ui-tabs-hide");e(f,m);a.element.dequeue("tabs")})}:function(g,f){a.lis.removeClass("ui-tabs-selected ui-state-active");f.addClass("ui-tabs-hide");a.element.dequeue("tabs")};
this.anchors.bind(c.event+".tabs",function(){var g=this,f=d(g).closest("li"),i=a.panels.filter(":not(.ui-tabs-hide)"),l=a.element.find(a._sanitizeSelector(g.hash));if(f.hasClass("ui-tabs-selected")&&!c.collapsible||f.hasClass("ui-state-disabled")||f.hasClass("ui-state-processing")||a.panels.filter(":animated").length||a._trigger("select",null,a._ui(this,l[0]))===false){this.blur();return false}c.selected=a.anchors.index(this);a.abort();if(c.collapsible)if(f.hasClass("ui-tabs-selected")){c.selected=
-1;c.cookie&&a._cookie(c.selected,c.cookie);a.element.queue("tabs",function(){s(g,i)}).dequeue("tabs");this.blur();return false}else if(!i.length){c.cookie&&a._cookie(c.selected,c.cookie);a.element.queue("tabs",function(){r(g,l)});a.load(a.anchors.index(this));this.blur();return false}c.cookie&&a._cookie(c.selected,c.cookie);if(l.length){i.length&&a.element.queue("tabs",function(){s(g,i)});a.element.queue("tabs",function(){r(g,l)});a.load(a.anchors.index(this))}else throw"jQuery UI Tabs: Mismatching fragment identifier.";
d.browser.msie&&this.blur()});this.anchors.bind("click.tabs",function(){return false})},_getIndex:function(b){if(typeof b=="string")b=this.anchors.index(this.anchors.filter("[href$="+b+"]"));return b},destroy:function(){var b=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var e=
d.data(this,"href.tabs");if(e)this.href=e;var a=d(this).unbind(".tabs");d.each(["href","load","cache"],function(c,h){a.removeData(h+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){d.data(this,"destroy.tabs")?d(this).remove():d(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")});b.cookie&&this._cookie(null,b.cookie);return this},add:function(b,
e,a){if(a===p)a=this.anchors.length;var c=this,h=this.options;e=d(h.tabTemplate.replace(/#\{href\}/g,b).replace(/#\{label\}/g,e));b=!b.indexOf("#")?b.replace("#",""):this._tabId(d("a",e)[0]);e.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var j=c.element.find("#"+b);j.length||(j=d(h.panelTemplate).attr("id",b).data("destroy.tabs",true));j.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(a>=this.lis.length){e.appendTo(this.list);j.appendTo(this.list[0].parentNode)}else{e.insertBefore(this.lis[a]);
j.insertBefore(this.panels[a])}h.disabled=d.map(h.disabled,function(k){return k>=a?++k:k});this._tabify();if(this.anchors.length==1){h.selected=0;e.addClass("ui-tabs-selected ui-state-active");j.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){c._trigger("show",null,c._ui(c.anchors[0],c.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.anchors[a],this.panels[a]));return this},remove:function(b){b=this._getIndex(b);var e=this.options,a=this.lis.eq(b).remove(),c=this.panels.eq(b).remove();
if(a.hasClass("ui-tabs-selected")&&this.anchors.length>1)this.select(b+(b+1<this.anchors.length?1:-1));e.disabled=d.map(d.grep(e.disabled,function(h){return h!=b}),function(h){return h>=b?--h:h});this._tabify();this._trigger("remove",null,this._ui(a.find("a")[0],c[0]));return this},enable:function(b){b=this._getIndex(b);var e=this.options;if(d.inArray(b,e.disabled)!=-1){this.lis.eq(b).removeClass("ui-state-disabled");e.disabled=d.grep(e.disabled,function(a){return a!=b});this._trigger("enable",null,
this._ui(this.anchors[b],this.panels[b]));return this}},disable:function(b){b=this._getIndex(b);var e=this.options;if(b!=e.selected){this.lis.eq(b).addClass("ui-state-disabled");e.disabled.push(b);e.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[b],this.panels[b]))}return this},select:function(b){b=this._getIndex(b);if(b==-1)if(this.options.collapsible&&this.options.selected!=-1)b=this.options.selected;else return this;this.anchors.eq(b).trigger(this.options.event+".tabs");return this},
load:function(b){b=this._getIndex(b);var e=this,a=this.options,c=this.anchors.eq(b)[0],h=d.data(c,"load.tabs");this.abort();if(!h||this.element.queue("tabs").length!==0&&d.data(c,"cache.tabs"))this.element.dequeue("tabs");else{this.lis.eq(b).addClass("ui-state-processing");if(a.spinner){var j=d("span",c);j.data("label.tabs",j.html()).html(a.spinner)}this.xhr=d.ajax(d.extend({},a.ajaxOptions,{url:h,success:function(k,n){e.element.find(e._sanitizeSelector(c.hash)).html(k);e._cleanup();a.cache&&d.data(c,
"cache.tabs",true);e._trigger("load",null,e._ui(e.anchors[b],e.panels[b]));try{a.ajaxOptions.success(k,n)}catch(m){}},error:function(k,n){e._cleanup();e._trigger("load",null,e._ui(e.anchors[b],e.panels[b]));try{a.ajaxOptions.error(k,n,b,c)}catch(m){}}}));e.element.dequeue("tabs");return this}},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._cleanup();return this},
url:function(b,e){this.anchors.eq(b).removeData("cache.tabs").data("load.tabs",e);return this},length:function(){return this.anchors.length}});d.extend(d.ui.tabs,{version:"1.8.11"});d.extend(d.ui.tabs.prototype,{rotation:null,rotate:function(b,e){var a=this,c=this.options,h=a._rotate||(a._rotate=function(j){clearTimeout(a.rotation);a.rotation=setTimeout(function(){var k=c.selected;a.select(++k<a.anchors.length?k:0)},b);j&&j.stopPropagation()});e=a._unrotate||(a._unrotate=!e?function(j){j.clientX&&
a.rotate(null)}:function(){t=c.selected;h()});if(b){this.element.bind("tabsshow",h);this.anchors.bind(c.event+".tabs",e);h()}else{clearTimeout(a.rotation);this.element.unbind("tabsshow",h);this.anchors.unbind(c.event+".tabs",e);delete this._rotate;delete this._unrotate}return this}})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Datepicker 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Datepicker
 *
 * Depends:
 *	jquery.ui.core.js
 */
(function(d,A){function K(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._inDialog=this._datepickerShowing=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su",
"Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",
minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false};d.extend(this._defaults,this.regional[""]);this.dpDiv=d('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')}function F(a,b){d.extend(a,b);for(var c in b)if(b[c]==
null||b[c]==A)a[c]=b[c];return a}d.extend(d.ui,{datepicker:{version:"1.8.11"}});var y=(new Date).getTime();d.extend(K.prototype,{markerClassName:"hasDatepicker",log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){F(this._defaults,a||{});return this},_attachDatepicker:function(a,b){var c=null;for(var e in this._defaults){var f=a.getAttribute("date:"+e);if(f){c=c||{};try{c[e]=eval(f)}catch(h){c[e]=f}}}e=a.nodeName.toLowerCase();
f=e=="div"||e=="span";if(!a.id){this.uuid+=1;a.id="dp"+this.uuid}var i=this._newInst(d(a),f);i.settings=d.extend({},b||{},c||{});if(e=="input")this._connectDatepicker(a,i);else f&&this._inlineDatepicker(a,i)},_newInst:function(a,b){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:!b?this.dpDiv:d('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')}},
_connectDatepicker:function(a,b){var c=d(a);b.append=d([]);b.trigger=d([]);if(!c.hasClass(this.markerClassName)){this._attachments(c,b);c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,f,h){b.settings[f]=h}).bind("getData.datepicker",function(e,f){return this._get(b,f)});this._autoSize(b);d.data(a,"datepicker",b)}},_attachments:function(a,b){var c=this._get(b,"appendText"),e=this._get(b,"isRTL");b.append&&
b.append.remove();if(c){b.append=d('<span class="'+this._appendClass+'">'+c+"</span>");a[e?"before":"after"](b.append)}a.unbind("focus",this._showDatepicker);b.trigger&&b.trigger.remove();c=this._get(b,"showOn");if(c=="focus"||c=="both")a.focus(this._showDatepicker);if(c=="button"||c=="both"){c=this._get(b,"buttonText");var f=this._get(b,"buttonImage");b.trigger=d(this._get(b,"buttonImageOnly")?d("<img/>").addClass(this._triggerClass).attr({src:f,alt:c,title:c}):d('<button type="button"></button>').addClass(this._triggerClass).html(f==
""?c:d("<img/>").attr({src:f,alt:c,title:c})));a[e?"before":"after"](b.trigger);b.trigger.click(function(){d.datepicker._datepickerShowing&&d.datepicker._lastInput==a[0]?d.datepicker._hideDatepicker():d.datepicker._showDatepicker(a[0]);return false})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var e=function(f){for(var h=0,i=0,g=0;g<f.length;g++)if(f[g].length>h){h=f[g].length;i=g}return i};b.setMonth(e(this._get(a,
c.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(e(this._get(a,c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=d(a);if(!c.hasClass(this.markerClassName)){c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(e,f,h){b.settings[f]=h}).bind("getData.datepicker",function(e,f){return this._get(b,f)});d.data(a,"datepicker",b);this._setDate(b,this._getDefaultDate(b),
true);this._updateDatepicker(b);this._updateAlternate(b);b.dpDiv.show()}},_dialogDatepicker:function(a,b,c,e,f){a=this._dialogInst;if(!a){this.uuid+=1;this._dialogInput=d('<input type="text" id="'+("dp"+this.uuid)+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');this._dialogInput.keydown(this._doKeyDown);d("body").append(this._dialogInput);a=this._dialogInst=this._newInst(this._dialogInput,false);a.settings={};d.data(this._dialogInput[0],"datepicker",a)}F(a.settings,e||{});
b=b&&b.constructor==Date?this._formatDate(a,b):b;this._dialogInput.val(b);this._pos=f?f.length?f:[f.pageX,f.pageY]:null;if(!this._pos)this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)];this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");a.settings.onSelect=c;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);
this._showDatepicker(this._dialogInput[0]);d.blockUI&&d.blockUI(this.dpDiv);d.data(this._dialogInput[0],"datepicker",a);return this},_destroyDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();d.removeData(a,"datepicker");if(e=="input"){c.append.remove();c.trigger.remove();b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",
this._doKeyUp)}else if(e=="div"||e=="span")b.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if(e=="input"){a.disabled=false;c.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else if(e=="div"||e=="span")b.children("."+this._inlineClass).children().removeClass("ui-state-disabled");this._disabledInputs=d.map(this._disabledInputs,
function(f){return f==a?null:f})}},_disableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if(e=="input"){a.disabled=true;c.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if(e=="div"||e=="span")b.children("."+this._inlineClass).children().addClass("ui-state-disabled");this._disabledInputs=d.map(this._disabledInputs,function(f){return f==a?null:
f});this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a)return false;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return true;return false},_getInst:function(a){try{return d.data(a,"datepicker")}catch(b){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(a,b,c){var e=this._getInst(a);if(arguments.length==2&&typeof b=="string")return b=="defaults"?d.extend({},d.datepicker._defaults):e?b=="all"?d.extend({},
e.settings):this._get(e,b):null;var f=b||{};if(typeof b=="string"){f={};f[b]=c}if(e){this._curInst==e&&this._hideDatepicker();var h=this._getDateDatepicker(a,true),i=this._getMinMaxDate(e,"min"),g=this._getMinMaxDate(e,"max");F(e.settings,f);if(i!==null&&f.dateFormat!==A&&f.minDate===A)e.settings.minDate=this._formatDate(e,i);if(g!==null&&f.dateFormat!==A&&f.maxDate===A)e.settings.maxDate=this._formatDate(e,g);this._attachments(d(a),e);this._autoSize(e);this._setDateDatepicker(a,h);this._updateDatepicker(e)}},
_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){if(a=this._getInst(a)){this._setDate(a,b);this._updateDatepicker(a);this._updateAlternate(a)}},_getDateDatepicker:function(a,b){(a=this._getInst(a))&&!a.inline&&this._setDateFromField(a,b);return a?this._getDate(a):null},_doKeyDown:function(a){var b=d.datepicker._getInst(a.target),c=true,e=b.dpDiv.is(".ui-datepicker-rtl");
b._keyEvent=true;if(d.datepicker._datepickerShowing)switch(a.keyCode){case 9:d.datepicker._hideDatepicker();c=false;break;case 13:c=d("td."+d.datepicker._dayOverClass+":not(."+d.datepicker._currentClass+")",b.dpDiv);c[0]?d.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,c[0]):d.datepicker._hideDatepicker();return false;case 27:d.datepicker._hideDatepicker();break;case 33:d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),
"M");break;case 34:d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 35:if(a.ctrlKey||a.metaKey)d.datepicker._clearDate(a.target);c=a.ctrlKey||a.metaKey;break;case 36:if(a.ctrlKey||a.metaKey)d.datepicker._gotoToday(a.target);c=a.ctrlKey||a.metaKey;break;case 37:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,e?+1:-1,"D");c=a.ctrlKey||a.metaKey;if(a.originalEvent.altKey)d.datepicker._adjustDate(a.target,a.ctrlKey?
-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 38:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,-7,"D");c=a.ctrlKey||a.metaKey;break;case 39:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,e?-1:+1,"D");c=a.ctrlKey||a.metaKey;if(a.originalEvent.altKey)d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 40:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,
+7,"D");c=a.ctrlKey||a.metaKey;break;default:c=false}else if(a.keyCode==36&&a.ctrlKey)d.datepicker._showDatepicker(this);else c=false;if(c){a.preventDefault();a.stopPropagation()}},_doKeyPress:function(a){var b=d.datepicker._getInst(a.target);if(d.datepicker._get(b,"constrainInput")){b=d.datepicker._possibleChars(d.datepicker._get(b,"dateFormat"));var c=String.fromCharCode(a.charCode==A?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||c<" "||!b||b.indexOf(c)>-1}},_doKeyUp:function(a){a=d.datepicker._getInst(a.target);
if(a.input.val()!=a.lastVal)try{if(d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,d.datepicker._getFormatConfig(a))){d.datepicker._setDateFromField(a);d.datepicker._updateAlternate(a);d.datepicker._updateDatepicker(a)}}catch(b){d.datepicker.log(b)}return true},_showDatepicker:function(a){a=a.target||a;if(a.nodeName.toLowerCase()!="input")a=d("input",a.parentNode)[0];if(!(d.datepicker._isDisabledDatepicker(a)||d.datepicker._lastInput==a)){var b=d.datepicker._getInst(a);
d.datepicker._curInst&&d.datepicker._curInst!=b&&d.datepicker._curInst.dpDiv.stop(true,true);var c=d.datepicker._get(b,"beforeShow");F(b.settings,c?c.apply(a,[a,b]):{});b.lastVal=null;d.datepicker._lastInput=a;d.datepicker._setDateFromField(b);if(d.datepicker._inDialog)a.value="";if(!d.datepicker._pos){d.datepicker._pos=d.datepicker._findPos(a);d.datepicker._pos[1]+=a.offsetHeight}var e=false;d(a).parents().each(function(){e|=d(this).css("position")=="fixed";return!e});if(e&&d.browser.opera){d.datepicker._pos[0]-=
document.documentElement.scrollLeft;d.datepicker._pos[1]-=document.documentElement.scrollTop}c={left:d.datepicker._pos[0],top:d.datepicker._pos[1]};d.datepicker._pos=null;b.dpDiv.empty();b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});d.datepicker._updateDatepicker(b);c=d.datepicker._checkOffset(b,c,e);b.dpDiv.css({position:d.datepicker._inDialog&&d.blockUI?"static":e?"fixed":"absolute",display:"none",left:c.left+"px",top:c.top+"px"});if(!b.inline){c=d.datepicker._get(b,"showAnim");
var f=d.datepicker._get(b,"duration"),h=function(){d.datepicker._datepickerShowing=true;var i=b.dpDiv.find("iframe.ui-datepicker-cover");if(i.length){var g=d.datepicker._getBorders(b.dpDiv);i.css({left:-g[0],top:-g[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex(d(a).zIndex()+1);d.effects&&d.effects[c]?b.dpDiv.show(c,d.datepicker._get(b,"showOptions"),f,h):b.dpDiv[c||"show"](c?f:null,h);if(!c||!f)h();b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus();d.datepicker._curInst=
b}}},_updateDatepicker:function(a){var b=this,c=d.datepicker._getBorders(a.dpDiv);a.dpDiv.empty().append(this._generateHTML(a));var e=a.dpDiv.find("iframe.ui-datepicker-cover");e.length&&e.css({left:-c[0],top:-c[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()});a.dpDiv.find("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a").bind("mouseout",function(){d(this).removeClass("ui-state-hover");this.className.indexOf("ui-datepicker-prev")!=-1&&d(this).removeClass("ui-datepicker-prev-hover");
this.className.indexOf("ui-datepicker-next")!=-1&&d(this).removeClass("ui-datepicker-next-hover")}).bind("mouseover",function(){if(!b._isDisabledDatepicker(a.inline?a.dpDiv.parent()[0]:a.input[0])){d(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");d(this).addClass("ui-state-hover");this.className.indexOf("ui-datepicker-prev")!=-1&&d(this).addClass("ui-datepicker-prev-hover");this.className.indexOf("ui-datepicker-next")!=-1&&d(this).addClass("ui-datepicker-next-hover")}}).end().find("."+
this._dayOverClass+" a").trigger("mouseover").end();c=this._getNumberOfMonths(a);e=c[1];e>1?a.dpDiv.addClass("ui-datepicker-multi-"+e).css("width",17*e+"em"):a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");a.dpDiv[(c[0]!=1||c[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");a==d.datepicker._curInst&&d.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&
a.input[0]!=document.activeElement&&a.input.focus();if(a.yearshtml){var f=a.yearshtml;setTimeout(function(){f===a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml);f=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(c){return{thin:1,medium:2,thick:3}[c]||c};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var e=a.dpDiv.outerWidth(),f=a.dpDiv.outerHeight(),h=a.input?a.input.outerWidth():
0,i=a.input?a.input.outerHeight():0,g=document.documentElement.clientWidth+d(document).scrollLeft(),j=document.documentElement.clientHeight+d(document).scrollTop();b.left-=this._get(a,"isRTL")?e-h:0;b.left-=c&&b.left==a.input.offset().left?d(document).scrollLeft():0;b.top-=c&&b.top==a.input.offset().top+i?d(document).scrollTop():0;b.left-=Math.min(b.left,b.left+e>g&&g>e?Math.abs(b.left+e-g):0);b.top-=Math.min(b.top,b.top+f>j&&j>f?Math.abs(f+i):0);return b},_findPos:function(a){for(var b=this._get(this._getInst(a),
"isRTL");a&&(a.type=="hidden"||a.nodeType!=1||d.expr.filters.hidden(a));)a=a[b?"previousSibling":"nextSibling"];a=d(a).offset();return[a.left,a.top]},_hideDatepicker:function(a){var b=this._curInst;if(!(!b||a&&b!=d.data(a,"datepicker")))if(this._datepickerShowing){a=this._get(b,"showAnim");var c=this._get(b,"duration"),e=function(){d.datepicker._tidyDialog(b);this._curInst=null};d.effects&&d.effects[a]?b.dpDiv.hide(a,d.datepicker._get(b,"showOptions"),c,e):b.dpDiv[a=="slideDown"?"slideUp":a=="fadeIn"?
"fadeOut":"hide"](a?c:null,e);a||e();if(a=this._get(b,"onClose"))a.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]);this._datepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(d.blockUI){d.unblockUI();d("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){if(d.datepicker._curInst){a=
d(a.target);a[0].id!=d.datepicker._mainDivId&&a.parents("#"+d.datepicker._mainDivId).length==0&&!a.hasClass(d.datepicker.markerClassName)&&!a.hasClass(d.datepicker._triggerClass)&&d.datepicker._datepickerShowing&&!(d.datepicker._inDialog&&d.blockUI)&&d.datepicker._hideDatepicker()}},_adjustDate:function(a,b,c){a=d(a);var e=this._getInst(a[0]);if(!this._isDisabledDatepicker(a[0])){this._adjustInstDate(e,b+(c=="M"?this._get(e,"showCurrentAtPos"):0),c);this._updateDatepicker(e)}},_gotoToday:function(a){a=
d(a);var b=this._getInst(a[0]);if(this._get(b,"gotoCurrent")&&b.currentDay){b.selectedDay=b.currentDay;b.drawMonth=b.selectedMonth=b.currentMonth;b.drawYear=b.selectedYear=b.currentYear}else{var c=new Date;b.selectedDay=c.getDate();b.drawMonth=b.selectedMonth=c.getMonth();b.drawYear=b.selectedYear=c.getFullYear()}this._notifyChange(b);this._adjustDate(a)},_selectMonthYear:function(a,b,c){a=d(a);var e=this._getInst(a[0]);e._selectingMonthYear=false;e["selected"+(c=="M"?"Month":"Year")]=e["draw"+(c==
"M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10);this._notifyChange(e);this._adjustDate(a)},_clickMonthYear:function(a){var b=this._getInst(d(a)[0]);b.input&&b._selectingMonthYear&&setTimeout(function(){b.input.focus()},0);b._selectingMonthYear=!b._selectingMonthYear},_selectDay:function(a,b,c,e){var f=d(a);if(!(d(e).hasClass(this._unselectableClass)||this._isDisabledDatepicker(f[0]))){f=this._getInst(f[0]);f.selectedDay=f.currentDay=d("a",e).html();f.selectedMonth=f.currentMonth=
b;f.selectedYear=f.currentYear=c;this._selectDate(a,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear))}},_clearDate:function(a){a=d(a);this._getInst(a[0]);this._selectDate(a,"")},_selectDate:function(a,b){a=this._getInst(d(a)[0]);b=b!=null?b:this._formatDate(a);a.input&&a.input.val(b);this._updateAlternate(a);var c=this._get(a,"onSelect");if(c)c.apply(a.input?a.input[0]:null,[b,a]);else a.input&&a.input.trigger("change");if(a.inline)this._updateDatepicker(a);else{this._hideDatepicker();
this._lastInput=a.input[0];typeof a.input[0]!="object"&&a.input.focus();this._lastInput=null}},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),e=this._getDate(a),f=this.formatDate(c,e,this._getFormatConfig(a));d(b).each(function(){d(this).val(f)})}},noWeekends:function(a){a=a.getDay();return[a>0&&a<6,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();a.setMonth(0);
a.setDate(1);return Math.floor(Math.round((b-a)/864E5)/7)+1},parseDate:function(a,b,c){if(a==null||b==null)throw"Invalid arguments";b=typeof b=="object"?b.toString():b+"";if(b=="")return null;var e=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff;e=typeof e!="string"?e:(new Date).getFullYear()%100+parseInt(e,10);for(var f=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,h=(c?c.dayNames:null)||this._defaults.dayNames,i=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,g=(c?
c.monthNames:null)||this._defaults.monthNames,j=c=-1,l=-1,u=-1,k=false,o=function(p){(p=z+1<a.length&&a.charAt(z+1)==p)&&z++;return p},m=function(p){var v=o(p);p=new RegExp("^\\d{1,"+(p=="@"?14:p=="!"?20:p=="y"&&v?4:p=="o"?3:2)+"}");p=b.substring(s).match(p);if(!p)throw"Missing number at position "+s;s+=p[0].length;return parseInt(p[0],10)},n=function(p,v,H){p=o(p)?H:v;for(v=0;v<p.length;v++)if(b.substr(s,p[v].length).toLowerCase()==p[v].toLowerCase()){s+=p[v].length;return v+1}throw"Unknown name at position "+
s;},r=function(){if(b.charAt(s)!=a.charAt(z))throw"Unexpected literal at position "+s;s++},s=0,z=0;z<a.length;z++)if(k)if(a.charAt(z)=="'"&&!o("'"))k=false;else r();else switch(a.charAt(z)){case "d":l=m("d");break;case "D":n("D",f,h);break;case "o":u=m("o");break;case "m":j=m("m");break;case "M":j=n("M",i,g);break;case "y":c=m("y");break;case "@":var w=new Date(m("@"));c=w.getFullYear();j=w.getMonth()+1;l=w.getDate();break;case "!":w=new Date((m("!")-this._ticksTo1970)/1E4);c=w.getFullYear();j=w.getMonth()+
1;l=w.getDate();break;case "'":if(o("'"))r();else k=true;break;default:r()}if(c==-1)c=(new Date).getFullYear();else if(c<100)c+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c<=e?0:-100);if(u>-1){j=1;l=u;do{e=this._getDaysInMonth(c,j-1);if(l<=e)break;j++;l-=e}while(1)}w=this._daylightSavingAdjust(new Date(c,j-1,l));if(w.getFullYear()!=c||w.getMonth()+1!=j||w.getDate()!=l)throw"Invalid date";return w},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",
RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1E7,formatDate:function(a,b,c){if(!b)return"";var e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,h=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort;c=(c?c.monthNames:null)||this._defaults.monthNames;var i=function(o){(o=k+1<a.length&&
a.charAt(k+1)==o)&&k++;return o},g=function(o,m,n){m=""+m;if(i(o))for(;m.length<n;)m="0"+m;return m},j=function(o,m,n,r){return i(o)?r[m]:n[m]},l="",u=false;if(b)for(var k=0;k<a.length;k++)if(u)if(a.charAt(k)=="'"&&!i("'"))u=false;else l+=a.charAt(k);else switch(a.charAt(k)){case "d":l+=g("d",b.getDate(),2);break;case "D":l+=j("D",b.getDay(),e,f);break;case "o":l+=g("o",(b.getTime()-(new Date(b.getFullYear(),0,0)).getTime())/864E5,3);break;case "m":l+=g("m",b.getMonth()+1,2);break;case "M":l+=j("M",
b.getMonth(),h,c);break;case "y":l+=i("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case "@":l+=b.getTime();break;case "!":l+=b.getTime()*1E4+this._ticksTo1970;break;case "'":if(i("'"))l+="'";else u=true;break;default:l+=a.charAt(k)}return l},_possibleChars:function(a){for(var b="",c=false,e=function(h){(h=f+1<a.length&&a.charAt(f+1)==h)&&f++;return h},f=0;f<a.length;f++)if(c)if(a.charAt(f)=="'"&&!e("'"))c=false;else b+=a.charAt(f);else switch(a.charAt(f)){case "d":case "m":case "y":case "@":b+=
"0123456789";break;case "D":case "M":return null;case "'":if(e("'"))b+="'";else c=true;break;default:b+=a.charAt(f)}return b},_get:function(a,b){return a.settings[b]!==A?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),e=a.lastVal=a.input?a.input.val():null,f,h;f=h=this._getDefaultDate(a);var i=this._getFormatConfig(a);try{f=this.parseDate(c,e,i)||h}catch(g){this.log(g);e=b?"":e}a.selectedDay=f.getDate();a.drawMonth=a.selectedMonth=
f.getMonth();a.drawYear=a.selectedYear=f.getFullYear();a.currentDay=e?f.getDate():0;a.currentMonth=e?f.getMonth():0;a.currentYear=e?f.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){var e=function(h){var i=new Date;i.setDate(i.getDate()+h);return i},f=function(h){try{return d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),h,d.datepicker._getFormatConfig(a))}catch(i){}var g=
(h.toLowerCase().match(/^c/)?d.datepicker._getDate(a):null)||new Date,j=g.getFullYear(),l=g.getMonth();g=g.getDate();for(var u=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,k=u.exec(h);k;){switch(k[2]||"d"){case "d":case "D":g+=parseInt(k[1],10);break;case "w":case "W":g+=parseInt(k[1],10)*7;break;case "m":case "M":l+=parseInt(k[1],10);g=Math.min(g,d.datepicker._getDaysInMonth(j,l));break;case "y":case "Y":j+=parseInt(k[1],10);g=Math.min(g,d.datepicker._getDaysInMonth(j,l));break}k=u.exec(h)}return new Date(j,
l,g)};if(b=(b=b==null||b===""?c:typeof b=="string"?f(b):typeof b=="number"?isNaN(b)?c:e(b):new Date(b.getTime()))&&b.toString()=="Invalid Date"?c:b){b.setHours(0);b.setMinutes(0);b.setSeconds(0);b.setMilliseconds(0)}return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(a.getHours()>12?a.getHours()+2:0);return a},_setDate:function(a,b,c){var e=!b,f=a.selectedMonth,h=a.selectedYear;b=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=
a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();if((f!=a.selectedMonth||h!=a.selectedYear)&&!c)this._notifyChange(a);this._adjustInstDate(a);if(a.input)a.input.val(e?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&a.input.val()==""?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_generateHTML:function(a){var b=new Date;b=this._daylightSavingAdjust(new Date(b.getFullYear(),
b.getMonth(),b.getDate()));var c=this._get(a,"isRTL"),e=this._get(a,"showButtonPanel"),f=this._get(a,"hideIfNoPrevNext"),h=this._get(a,"navigationAsDateFormat"),i=this._getNumberOfMonths(a),g=this._get(a,"showCurrentAtPos"),j=this._get(a,"stepMonths"),l=i[0]!=1||i[1]!=1,u=this._daylightSavingAdjust(!a.currentDay?new Date(9999,9,9):new Date(a.currentYear,a.currentMonth,a.currentDay)),k=this._getMinMaxDate(a,"min"),o=this._getMinMaxDate(a,"max");g=a.drawMonth-g;var m=a.drawYear;if(g<0){g+=12;m--}if(o){var n=
this._daylightSavingAdjust(new Date(o.getFullYear(),o.getMonth()-i[0]*i[1]+1,o.getDate()));for(n=k&&n<k?k:n;this._daylightSavingAdjust(new Date(m,g,1))>n;){g--;if(g<0){g=11;m--}}}a.drawMonth=g;a.drawYear=m;n=this._get(a,"prevText");n=!h?n:this.formatDate(n,this._daylightSavingAdjust(new Date(m,g-j,1)),this._getFormatConfig(a));n=this._canAdjustMonth(a,-1,m,g)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+y+".datepicker._adjustDate('#"+a.id+"', -"+j+", 'M');\" title=\""+n+'"><span class="ui-icon ui-icon-circle-triangle-'+
(c?"e":"w")+'">'+n+"</span></a>":f?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+n+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+n+"</span></a>";var r=this._get(a,"nextText");r=!h?r:this.formatDate(r,this._daylightSavingAdjust(new Date(m,g+j,1)),this._getFormatConfig(a));f=this._canAdjustMonth(a,+1,m,g)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+y+".datepicker._adjustDate('#"+a.id+"', +"+j+", 'M');\" title=\""+r+'"><span class="ui-icon ui-icon-circle-triangle-'+
(c?"w":"e")+'">'+r+"</span></a>":f?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+r+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+r+"</span></a>";j=this._get(a,"currentText");r=this._get(a,"gotoCurrent")&&a.currentDay?u:b;j=!h?j:this.formatDate(j,r,this._getFormatConfig(a));h=!a.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+y+'.datepicker._hideDatepicker();">'+this._get(a,
"closeText")+"</button>":"";e=e?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?h:"")+(this._isInRange(a,r)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+y+".datepicker._gotoToday('#"+a.id+"');\">"+j+"</button>":"")+(c?"":h)+"</div>":"";h=parseInt(this._get(a,"firstDay"),10);h=isNaN(h)?0:h;j=this._get(a,"showWeek");r=this._get(a,"dayNames");this._get(a,"dayNamesShort");var s=this._get(a,"dayNamesMin"),z=
this._get(a,"monthNames"),w=this._get(a,"monthNamesShort"),p=this._get(a,"beforeShowDay"),v=this._get(a,"showOtherMonths"),H=this._get(a,"selectOtherMonths");this._get(a,"calculateWeek");for(var L=this._getDefaultDate(a),I="",D=0;D<i[0];D++){for(var M="",E=0;E<i[1];E++){var N=this._daylightSavingAdjust(new Date(m,g,a.selectedDay)),t=" ui-corner-all",x="";if(l){x+='<div class="ui-datepicker-group';if(i[1]>1)switch(E){case 0:x+=" ui-datepicker-group-first";t=" ui-corner-"+(c?"right":"left");break;case i[1]-
1:x+=" ui-datepicker-group-last";t=" ui-corner-"+(c?"left":"right");break;default:x+=" ui-datepicker-group-middle";t="";break}x+='">'}x+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+t+'">'+(/all|left/.test(t)&&D==0?c?f:n:"")+(/all|right/.test(t)&&D==0?c?n:f:"")+this._generateMonthYearHeader(a,g,m,k,o,D>0||E>0,z,w)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var B=j?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"";for(t=0;t<7;t++){var q=
(t+h)%7;B+="<th"+((t+h+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+r[q]+'">'+s[q]+"</span></th>"}x+=B+"</tr></thead><tbody>";B=this._getDaysInMonth(m,g);if(m==a.selectedYear&&g==a.selectedMonth)a.selectedDay=Math.min(a.selectedDay,B);t=(this._getFirstDayOfMonth(m,g)-h+7)%7;B=l?6:Math.ceil((t+B)/7);q=this._daylightSavingAdjust(new Date(m,g,1-t));for(var O=0;O<B;O++){x+="<tr>";var P=!j?"":'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(q)+"</td>";for(t=0;t<7;t++){var G=
p?p.apply(a.input?a.input[0]:null,[q]):[true,""],C=q.getMonth()!=g,J=C&&!H||!G[0]||k&&q<k||o&&q>o;P+='<td class="'+((t+h+6)%7>=5?" ui-datepicker-week-end":"")+(C?" ui-datepicker-other-month":"")+(q.getTime()==N.getTime()&&g==a.selectedMonth&&a._keyEvent||L.getTime()==q.getTime()&&L.getTime()==N.getTime()?" "+this._dayOverClass:"")+(J?" "+this._unselectableClass+" ui-state-disabled":"")+(C&&!v?"":" "+G[1]+(q.getTime()==u.getTime()?" "+this._currentClass:"")+(q.getTime()==b.getTime()?" ui-datepicker-today":
""))+'"'+((!C||v)&&G[2]?' title="'+G[2]+'"':"")+(J?"":' onclick="DP_jQuery_'+y+".datepicker._selectDay('#"+a.id+"',"+q.getMonth()+","+q.getFullYear()+', this);return false;"')+">"+(C&&!v?"&#xa0;":J?'<span class="ui-state-default">'+q.getDate()+"</span>":'<a class="ui-state-default'+(q.getTime()==b.getTime()?" ui-state-highlight":"")+(q.getTime()==u.getTime()?" ui-state-active":"")+(C?" ui-priority-secondary":"")+'" href="#">'+q.getDate()+"</a>")+"</td>";q.setDate(q.getDate()+1);q=this._daylightSavingAdjust(q)}x+=
P+"</tr>"}g++;if(g>11){g=0;m++}x+="</tbody></table>"+(l?"</div>"+(i[0]>0&&E==i[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");M+=x}I+=M}I+=e+(d.browser.msie&&parseInt(d.browser.version,10)<7&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");a._keyEvent=false;return I},_generateMonthYearHeader:function(a,b,c,e,f,h,i,g){var j=this._get(a,"changeMonth"),l=this._get(a,"changeYear"),u=this._get(a,"showMonthAfterYear"),k='<div class="ui-datepicker-title">',
o="";if(h||!j)o+='<span class="ui-datepicker-month">'+i[b]+"</span>";else{i=e&&e.getFullYear()==c;var m=f&&f.getFullYear()==c;o+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+y+".datepicker._selectMonthYear('#"+a.id+"', this, 'M');\" onclick=\"DP_jQuery_"+y+".datepicker._clickMonthYear('#"+a.id+"');\">";for(var n=0;n<12;n++)if((!i||n>=e.getMonth())&&(!m||n<=f.getMonth()))o+='<option value="'+n+'"'+(n==b?' selected="selected"':"")+">"+g[n]+"</option>";o+="</select>"}u||(k+=o+(h||!(j&&
l)?"&#xa0;":""));a.yearshtml="";if(h||!l)k+='<span class="ui-datepicker-year">'+c+"</span>";else{g=this._get(a,"yearRange").split(":");var r=(new Date).getFullYear();i=function(s){s=s.match(/c[+-].*/)?c+parseInt(s.substring(1),10):s.match(/[+-].*/)?r+parseInt(s,10):parseInt(s,10);return isNaN(s)?r:s};b=i(g[0]);g=Math.max(b,i(g[1]||""));b=e?Math.max(b,e.getFullYear()):b;g=f?Math.min(g,f.getFullYear()):g;for(a.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+y+".datepicker._selectMonthYear('#"+
a.id+"', this, 'Y');\" onclick=\"DP_jQuery_"+y+".datepicker._clickMonthYear('#"+a.id+"');\">";b<=g;b++)a.yearshtml+='<option value="'+b+'"'+(b==c?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>";if(d.browser.mozilla)k+='<select class="ui-datepicker-year"><option value="'+c+'" selected="selected">'+c+"</option></select>";else{k+=a.yearshtml;a.yearshtml=null}}k+=this._get(a,"yearSuffix");if(u)k+=(h||!(j&&l)?"&#xa0;":"")+o;k+="</div>";return k},_adjustInstDate:function(a,b,c){var e=
a.drawYear+(c=="Y"?b:0),f=a.drawMonth+(c=="M"?b:0);b=Math.min(a.selectedDay,this._getDaysInMonth(e,f))+(c=="D"?b:0);e=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(e,f,b)));a.selectedDay=e.getDate();a.drawMonth=a.selectedMonth=e.getMonth();a.drawYear=a.selectedYear=e.getFullYear();if(c=="M"||c=="Y")this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min");a=this._getMinMaxDate(a,"max");b=c&&b<c?c:b;return b=a&&b>a?a:b},_notifyChange:function(a){var b=this._get(a,
"onChangeMonthYear");if(b)b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,"numberOfMonths");return a==null?[1,1]:typeof a=="number"?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,e){var f=this._getNumberOfMonths(a);
c=this._daylightSavingAdjust(new Date(c,e+(b<0?b:f[0]*f[1]),1));b<0&&c.setDate(this._getDaysInMonth(c.getFullYear(),c.getMonth()));return this._isInRange(a,c)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min");a=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!a||b.getTime()<=a.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");b=typeof b!="string"?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,
"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,e){if(!b){a.currentDay=a.selectedDay;a.currentMonth=a.selectedMonth;a.currentYear=a.selectedYear}b=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(e,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});d.fn.datepicker=
function(a){if(!this.length)return this;if(!d.datepicker.initialized){d(document).mousedown(d.datepicker._checkExternalClick).find("body").append(d.datepicker.dpDiv);d.datepicker.initialized=true}var b=Array.prototype.slice.call(arguments,1);if(typeof a=="string"&&(a=="isDisabled"||a=="getDate"||a=="widget"))return d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b));if(a=="option"&&arguments.length==2&&typeof arguments[1]=="string")return d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,
[this[0]].concat(b));return this.each(function(){typeof a=="string"?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this].concat(b)):d.datepicker._attachDatepicker(this,a)})};d.datepicker=new K;d.datepicker.initialized=false;d.datepicker.uuid=(new Date).getTime();d.datepicker.version="1.8.11";window["DP_jQuery_"+y]=d})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Progressbar 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Progressbar
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 */
(function(b,d){b.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=b("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove();b.Widget.prototype.destroy.apply(this,arguments)},value:function(a){if(a===d)return this._value();this._setOption("value",a);return this},_setOption:function(a,c){if(a==="value"){this.options.value=c;this._refreshValue();this._value()===this.options.max&&this._trigger("complete")}b.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var a=this.options.value;if(typeof a!=="number")a=0;return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*
this._value()/this.options.max},_refreshValue:function(){var a=this.value(),c=this._percentage();if(this.oldValue!==a){this.oldValue=a;this._trigger("change")}this.valueDiv.toggleClass("ui-corner-right",a===this.options.max).width(c.toFixed(0)+"%");this.element.attr("aria-valuenow",a)}});b.extend(b.ui.progressbar,{version:"1.8.11"})})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/
 */
jQuery.effects||function(f,j){function n(c){var a;if(c&&c.constructor==Array&&c.length==3)return c;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)];if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return[parseFloat(a[1])*2.55,parseFloat(a[2])*2.55,parseFloat(a[3])*2.55];if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return[parseInt(a[1],
16),parseInt(a[2],16),parseInt(a[3],16)];if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)];if(/rgba\(0, 0, 0, 0\)/.exec(c))return o.transparent;return o[f.trim(c).toLowerCase()]}function s(c,a){var b;do{b=f.curCSS(c,a);if(b!=""&&b!="transparent"||f.nodeName(c,"body"))break;a="backgroundColor"}while(c=c.parentNode);return n(b)}function p(){var c=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,
a={},b,d;if(c&&c.length&&c[0]&&c[c[0]])for(var e=c.length;e--;){b=c[e];if(typeof c[b]=="string"){d=b.replace(/\-(\w)/g,function(g,h){return h.toUpperCase()});a[d]=c[b]}}else for(b in c)if(typeof c[b]==="string")a[b]=c[b];return a}function q(c){var a,b;for(a in c){b=c[a];if(b==null||f.isFunction(b)||a in t||/scrollbar/.test(a)||!/color/i.test(a)&&isNaN(parseFloat(b)))delete c[a]}return c}function u(c,a){var b={_:0},d;for(d in a)if(c[d]!=a[d])b[d]=a[d];return b}function k(c,a,b,d){if(typeof c=="object"){d=
a;b=null;a=c;c=a.effect}if(f.isFunction(a)){d=a;b=null;a={}}if(typeof a=="number"||f.fx.speeds[a]){d=b;b=a;a={}}if(f.isFunction(b)){d=b;b=null}a=a||{};b=b||a.duration;b=f.fx.off?0:typeof b=="number"?b:b in f.fx.speeds?f.fx.speeds[b]:f.fx.speeds._default;d=d||a.complete;return[c,a,b,d]}function m(c){if(!c||typeof c==="number"||f.fx.speeds[c])return true;if(typeof c==="string"&&!f.effects[c])return true;return false}f.effects={};f.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor",
"borderTopColor","borderColor","color","outlineColor"],function(c,a){f.fx.step[a]=function(b){if(!b.colorInit){b.start=s(b.elem,a);b.end=n(b.end);b.colorInit=true}b.elem.style[a]="rgb("+Math.max(Math.min(parseInt(b.pos*(b.end[0]-b.start[0])+b.start[0],10),255),0)+","+Math.max(Math.min(parseInt(b.pos*(b.end[1]-b.start[1])+b.start[1],10),255),0)+","+Math.max(Math.min(parseInt(b.pos*(b.end[2]-b.start[2])+b.start[2],10),255),0)+")"}});var o={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,
0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,
211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},r=["add","remove","toggle"],t={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};f.effects.animateClass=function(c,a,b,
d){if(f.isFunction(b)){d=b;b=null}return this.queue("fx",function(){var e=f(this),g=e.attr("style")||" ",h=q(p.call(this)),l,v=e.attr("className");f.each(r,function(w,i){c[i]&&e[i+"Class"](c[i])});l=q(p.call(this));e.attr("className",v);e.animate(u(h,l),a,b,function(){f.each(r,function(w,i){c[i]&&e[i+"Class"](c[i])});if(typeof e.attr("style")=="object"){e.attr("style").cssText="";e.attr("style").cssText=g}else e.attr("style",g);d&&d.apply(this,arguments)});h=f.queue(this);l=h.splice(h.length-1,1)[0];
h.splice(1,0,l);f.dequeue(this)})};f.fn.extend({_addClass:f.fn.addClass,addClass:function(c,a,b,d){return a?f.effects.animateClass.apply(this,[{add:c},a,b,d]):this._addClass(c)},_removeClass:f.fn.removeClass,removeClass:function(c,a,b,d){return a?f.effects.animateClass.apply(this,[{remove:c},a,b,d]):this._removeClass(c)},_toggleClass:f.fn.toggleClass,toggleClass:function(c,a,b,d,e){return typeof a=="boolean"||a===j?b?f.effects.animateClass.apply(this,[a?{add:c}:{remove:c},b,d,e]):this._toggleClass(c,
a):f.effects.animateClass.apply(this,[{toggle:c},a,b,d])},switchClass:function(c,a,b,d,e){return f.effects.animateClass.apply(this,[{add:a,remove:c},b,d,e])}});f.extend(f.effects,{version:"1.8.11",save:function(c,a){for(var b=0;b<a.length;b++)a[b]!==null&&c.data("ec.storage."+a[b],c[0].style[a[b]])},restore:function(c,a){for(var b=0;b<a.length;b++)a[b]!==null&&c.css(a[b],c.data("ec.storage."+a[b]))},setMode:function(c,a){if(a=="toggle")a=c.is(":hidden")?"show":"hide";return a},getBaseline:function(c,
a){var b;switch(c[0]){case "top":b=0;break;case "middle":b=0.5;break;case "bottom":b=1;break;default:b=c[0]/a.height}switch(c[1]){case "left":c=0;break;case "center":c=0.5;break;case "right":c=1;break;default:c=c[1]/a.width}return{x:c,y:b}},createWrapper:function(c){if(c.parent().is(".ui-effects-wrapper"))return c.parent();var a={width:c.outerWidth(true),height:c.outerHeight(true),"float":c.css("float")},b=f("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",
border:"none",margin:0,padding:0});c.wrap(b);b=c.parent();if(c.css("position")=="static"){b.css({position:"relative"});c.css({position:"relative"})}else{f.extend(a,{position:c.css("position"),zIndex:c.css("z-index")});f.each(["top","left","bottom","right"],function(d,e){a[e]=c.css(e);if(isNaN(parseInt(a[e],10)))a[e]="auto"});c.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return b.css(a).show()},removeWrapper:function(c){if(c.parent().is(".ui-effects-wrapper"))return c.parent().replaceWith(c);
return c},setTransition:function(c,a,b,d){d=d||{};f.each(a,function(e,g){unit=c.cssUnit(g);if(unit[0]>0)d[g]=unit[0]*b+unit[1]});return d}});f.fn.extend({effect:function(c){var a=k.apply(this,arguments),b={options:a[1],duration:a[2],callback:a[3]};a=b.options.mode;var d=f.effects[c];if(f.fx.off||!d)return a?this[a](b.duration,b.callback):this.each(function(){b.callback&&b.callback.call(this)});return d.call(this,b)},_show:f.fn.show,show:function(c){if(m(c))return this._show.apply(this,arguments);
else{var a=k.apply(this,arguments);a[1].mode="show";return this.effect.apply(this,a)}},_hide:f.fn.hide,hide:function(c){if(m(c))return this._hide.apply(this,arguments);else{var a=k.apply(this,arguments);a[1].mode="hide";return this.effect.apply(this,a)}},__toggle:f.fn.toggle,toggle:function(c){if(m(c)||typeof c==="boolean"||f.isFunction(c))return this.__toggle.apply(this,arguments);else{var a=k.apply(this,arguments);a[1].mode="toggle";return this.effect.apply(this,a)}},cssUnit:function(c){var a=this.css(c),
b=[];f.each(["em","px","%","pt"],function(d,e){if(a.indexOf(e)>0)b=[parseFloat(a),e]});return b}});f.easing.jswing=f.easing.swing;f.extend(f.easing,{def:"easeOutQuad",swing:function(c,a,b,d,e){return f.easing[f.easing.def](c,a,b,d,e)},easeInQuad:function(c,a,b,d,e){return d*(a/=e)*a+b},easeOutQuad:function(c,a,b,d,e){return-d*(a/=e)*(a-2)+b},easeInOutQuad:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a+b;return-d/2*(--a*(a-2)-1)+b},easeInCubic:function(c,a,b,d,e){return d*(a/=e)*a*a+b},easeOutCubic:function(c,
a,b,d,e){return d*((a=a/e-1)*a*a+1)+b},easeInOutCubic:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a+b;return d/2*((a-=2)*a*a+2)+b},easeInQuart:function(c,a,b,d,e){return d*(a/=e)*a*a*a+b},easeOutQuart:function(c,a,b,d,e){return-d*((a=a/e-1)*a*a*a-1)+b},easeInOutQuart:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a*a+b;return-d/2*((a-=2)*a*a*a-2)+b},easeInQuint:function(c,a,b,d,e){return d*(a/=e)*a*a*a*a+b},easeOutQuint:function(c,a,b,d,e){return d*((a=a/e-1)*a*a*a*a+1)+b},easeInOutQuint:function(c,
a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a*a*a+b;return d/2*((a-=2)*a*a*a*a+2)+b},easeInSine:function(c,a,b,d,e){return-d*Math.cos(a/e*(Math.PI/2))+d+b},easeOutSine:function(c,a,b,d,e){return d*Math.sin(a/e*(Math.PI/2))+b},easeInOutSine:function(c,a,b,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+b},easeInExpo:function(c,a,b,d,e){return a==0?b:d*Math.pow(2,10*(a/e-1))+b},easeOutExpo:function(c,a,b,d,e){return a==e?b+d:d*(-Math.pow(2,-10*a/e)+1)+b},easeInOutExpo:function(c,a,b,d,e){if(a==0)return b;if(a==
e)return b+d;if((a/=e/2)<1)return d/2*Math.pow(2,10*(a-1))+b;return d/2*(-Math.pow(2,-10*--a)+2)+b},easeInCirc:function(c,a,b,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+b},easeOutCirc:function(c,a,b,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+b},easeInOutCirc:function(c,a,b,d,e){if((a/=e/2)<1)return-d/2*(Math.sqrt(1-a*a)-1)+b;return d/2*(Math.sqrt(1-(a-=2)*a)+1)+b},easeInElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e)==1)return b+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;c=g/4}else c=
g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g))+b},easeOutElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e)==1)return b+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;c=g/4}else c=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*a)*Math.sin((a*e-c)*2*Math.PI/g)+d+b},easeInOutElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e/2)==2)return b+d;g||(g=e*0.3*1.5);if(h<Math.abs(d)){h=d;c=g/4}else c=g/(2*Math.PI)*Math.asin(d/
h);if(a<1)return-0.5*h*Math.pow(2,10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g)+b;return h*Math.pow(2,-10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g)*0.5+d+b},easeInBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;return d*(a/=e)*a*((g+1)*a-g)+b},easeOutBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;return d*((a=a/e-1)*a*((g+1)*a+g)+1)+b},easeInOutBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;if((a/=e/2)<1)return d/2*a*a*(((g*=1.525)+1)*a-g)+b;return d/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+b},easeInBounce:function(c,
a,b,d,e){return d-f.easing.easeOutBounce(c,e-a,0,d,e)+b},easeOutBounce:function(c,a,b,d,e){return(a/=e)<1/2.75?d*7.5625*a*a+b:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+0.75)+b:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+0.9375)+b:d*(7.5625*(a-=2.625/2.75)*a+0.984375)+b},easeInOutBounce:function(c,a,b,d,e){if(a<e/2)return f.easing.easeInBounce(c,a*2,0,d,e)*0.5+b;return f.easing.easeOutBounce(c,a*2-e,0,d,e)*0.5+d*0.5+b}})}(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Blind 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Blind
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(b){b.effects.blind=function(c){return this.queue(function(){var a=b(this),g=["position","top","bottom","left","right"],f=b.effects.setMode(a,c.options.mode||"hide"),d=c.options.direction||"vertical";b.effects.save(a,g);a.show();var e=b.effects.createWrapper(a).css({overflow:"hidden"}),h=d=="vertical"?"height":"width";d=d=="vertical"?e.height():e.width();f=="show"&&e.css(h,0);var i={};i[h]=f=="show"?d:0;e.animate(i,c.duration,c.options.easing,function(){f=="hide"&&a.hide();b.effects.restore(a,
g);b.effects.removeWrapper(a);c.callback&&c.callback.apply(a[0],arguments);a.dequeue()})})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Bounce 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Bounce
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(e){e.effects.bounce=function(b){return this.queue(function(){var a=e(this),l=["position","top","bottom","left","right"],h=e.effects.setMode(a,b.options.mode||"effect"),d=b.options.direction||"up",c=b.options.distance||20,m=b.options.times||5,i=b.duration||250;/show|hide/.test(h)&&l.push("opacity");e.effects.save(a,l);a.show();e.effects.createWrapper(a);var f=d=="up"||d=="down"?"top":"left";d=d=="up"||d=="left"?"pos":"neg";c=b.options.distance||(f=="top"?a.outerHeight({margin:true})/3:a.outerWidth({margin:true})/
3);if(h=="show")a.css("opacity",0).css(f,d=="pos"?-c:c);if(h=="hide")c/=m*2;h!="hide"&&m--;if(h=="show"){var g={opacity:1};g[f]=(d=="pos"?"+=":"-=")+c;a.animate(g,i/2,b.options.easing);c/=2;m--}for(g=0;g<m;g++){var j={},k={};j[f]=(d=="pos"?"-=":"+=")+c;k[f]=(d=="pos"?"+=":"-=")+c;a.animate(j,i/2,b.options.easing).animate(k,i/2,b.options.easing);c=h=="hide"?c*2:c/2}if(h=="hide"){g={opacity:0};g[f]=(d=="pos"?"-=":"+=")+c;a.animate(g,i/2,b.options.easing,function(){a.hide();e.effects.restore(a,l);e.effects.removeWrapper(a);
b.callback&&b.callback.apply(this,arguments)})}else{j={};k={};j[f]=(d=="pos"?"-=":"+=")+c;k[f]=(d=="pos"?"+=":"-=")+c;a.animate(j,i/2,b.options.easing).animate(k,i/2,b.options.easing,function(){e.effects.restore(a,l);e.effects.removeWrapper(a);b.callback&&b.callback.apply(this,arguments)})}a.queue("fx",function(){a.dequeue()});a.dequeue()})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Clip 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Clip
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(b){b.effects.clip=function(e){return this.queue(function(){var a=b(this),i=["position","top","bottom","left","right","height","width"],f=b.effects.setMode(a,e.options.mode||"hide"),c=e.options.direction||"vertical";b.effects.save(a,i);a.show();var d=b.effects.createWrapper(a).css({overflow:"hidden"});d=a[0].tagName=="IMG"?d:a;var g={size:c=="vertical"?"height":"width",position:c=="vertical"?"top":"left"};c=c=="vertical"?d.height():d.width();if(f=="show"){d.css(g.size,0);d.css(g.position,
c/2)}var h={};h[g.size]=f=="show"?c:0;h[g.position]=f=="show"?0:c/2;d.animate(h,{queue:false,duration:e.duration,easing:e.options.easing,complete:function(){f=="hide"&&a.hide();b.effects.restore(a,i);b.effects.removeWrapper(a);e.callback&&e.callback.apply(a[0],arguments);a.dequeue()}})})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Drop 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Drop
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(c){c.effects.drop=function(d){return this.queue(function(){var a=c(this),h=["position","top","bottom","left","right","opacity"],e=c.effects.setMode(a,d.options.mode||"hide"),b=d.options.direction||"left";c.effects.save(a,h);a.show();c.effects.createWrapper(a);var f=b=="up"||b=="down"?"top":"left";b=b=="up"||b=="left"?"pos":"neg";var g=d.options.distance||(f=="top"?a.outerHeight({margin:true})/2:a.outerWidth({margin:true})/2);if(e=="show")a.css("opacity",0).css(f,b=="pos"?-g:g);var i={opacity:e==
"show"?1:0};i[f]=(e=="show"?b=="pos"?"+=":"-=":b=="pos"?"-=":"+=")+g;a.animate(i,{queue:false,duration:d.duration,easing:d.options.easing,complete:function(){e=="hide"&&a.hide();c.effects.restore(a,h);c.effects.removeWrapper(a);d.callback&&d.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Explode 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Explode
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(j){j.effects.explode=function(a){return this.queue(function(){var c=a.options.pieces?Math.round(Math.sqrt(a.options.pieces)):3,d=a.options.pieces?Math.round(Math.sqrt(a.options.pieces)):3;a.options.mode=a.options.mode=="toggle"?j(this).is(":visible")?"hide":"show":a.options.mode;var b=j(this).show().css("visibility","hidden"),g=b.offset();g.top-=parseInt(b.css("marginTop"),10)||0;g.left-=parseInt(b.css("marginLeft"),10)||0;for(var h=b.outerWidth(true),i=b.outerHeight(true),e=0;e<c;e++)for(var f=
0;f<d;f++)b.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-f*(h/d),top:-e*(i/c)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:h/d,height:i/c,left:g.left+f*(h/d)+(a.options.mode=="show"?(f-Math.floor(d/2))*(h/d):0),top:g.top+e*(i/c)+(a.options.mode=="show"?(e-Math.floor(c/2))*(i/c):0),opacity:a.options.mode=="show"?0:1}).animate({left:g.left+f*(h/d)+(a.options.mode=="show"?0:(f-Math.floor(d/2))*(h/d)),top:g.top+
e*(i/c)+(a.options.mode=="show"?0:(e-Math.floor(c/2))*(i/c)),opacity:a.options.mode=="show"?1:0},a.duration||500);setTimeout(function(){a.options.mode=="show"?b.css({visibility:"visible"}):b.css({visibility:"visible"}).hide();a.callback&&a.callback.apply(b[0]);b.dequeue();j("div.ui-effects-explode").remove()},a.duration||500)})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Fade 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Fade
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(b){b.effects.fade=function(a){return this.queue(function(){var c=b(this),d=b.effects.setMode(c,a.options.mode||"hide");c.animate({opacity:d},{queue:false,duration:a.duration,easing:a.options.easing,complete:function(){a.callback&&a.callback.apply(this,arguments);c.dequeue()}})})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Fold 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Fold
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(c){c.effects.fold=function(a){return this.queue(function(){var b=c(this),j=["position","top","bottom","left","right"],d=c.effects.setMode(b,a.options.mode||"hide"),g=a.options.size||15,h=!!a.options.horizFirst,k=a.duration?a.duration/2:c.fx.speeds._default/2;c.effects.save(b,j);b.show();var e=c.effects.createWrapper(b).css({overflow:"hidden"}),f=d=="show"!=h,l=f?["width","height"]:["height","width"];f=f?[e.width(),e.height()]:[e.height(),e.width()];var i=/([0-9]+)%/.exec(g);if(i)g=parseInt(i[1],
10)/100*f[d=="hide"?0:1];if(d=="show")e.css(h?{height:0,width:g}:{height:g,width:0});h={};i={};h[l[0]]=d=="show"?f[0]:g;i[l[1]]=d=="show"?f[1]:0;e.animate(h,k,a.options.easing).animate(i,k,a.options.easing,function(){d=="hide"&&b.hide();c.effects.restore(b,j);c.effects.removeWrapper(b);a.callback&&a.callback.apply(b[0],arguments);b.dequeue()})})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Highlight 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Highlight
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(b){b.effects.highlight=function(c){return this.queue(function(){var a=b(this),e=["backgroundImage","backgroundColor","opacity"],d=b.effects.setMode(a,c.options.mode||"show"),f={backgroundColor:a.css("backgroundColor")};if(d=="hide")f.opacity=0;b.effects.save(a,e);a.show().css({backgroundImage:"none",backgroundColor:c.options.color||"#ffff99"}).animate(f,{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){d=="hide"&&a.hide();b.effects.restore(a,e);d=="show"&&!b.support.opacity&&
this.style.removeAttribute("filter");c.callback&&c.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Pulsate 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Pulsate
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(d){d.effects.pulsate=function(a){return this.queue(function(){var b=d(this),c=d.effects.setMode(b,a.options.mode||"show");times=(a.options.times||5)*2-1;duration=a.duration?a.duration/2:d.fx.speeds._default/2;isVisible=b.is(":visible");animateTo=0;if(!isVisible){b.css("opacity",0).show();animateTo=1}if(c=="hide"&&isVisible||c=="show"&&!isVisible)times--;for(c=0;c<times;c++){b.animate({opacity:animateTo},duration,a.options.easing);animateTo=(animateTo+1)%2}b.animate({opacity:animateTo},duration,
a.options.easing,function(){animateTo==0&&b.hide();a.callback&&a.callback.apply(this,arguments)});b.queue("fx",function(){b.dequeue()}).dequeue()})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Scale 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Scale
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(c){c.effects.puff=function(b){return this.queue(function(){var a=c(this),e=c.effects.setMode(a,b.options.mode||"hide"),g=parseInt(b.options.percent,10)||150,h=g/100,i={height:a.height(),width:a.width()};c.extend(b.options,{fade:true,mode:e,percent:e=="hide"?g:100,from:e=="hide"?i:{height:i.height*h,width:i.width*h}});a.effect("scale",b.options,b.duration,b.callback);a.dequeue()})};c.effects.scale=function(b){return this.queue(function(){var a=c(this),e=c.extend(true,{},b.options),g=c.effects.setMode(a,
b.options.mode||"effect"),h=parseInt(b.options.percent,10)||(parseInt(b.options.percent,10)==0?0:g=="hide"?0:100),i=b.options.direction||"both",f=b.options.origin;if(g!="effect"){e.origin=f||["middle","center"];e.restore=true}f={height:a.height(),width:a.width()};a.from=b.options.from||(g=="show"?{height:0,width:0}:f);h={y:i!="horizontal"?h/100:1,x:i!="vertical"?h/100:1};a.to={height:f.height*h.y,width:f.width*h.x};if(b.options.fade){if(g=="show"){a.from.opacity=0;a.to.opacity=1}if(g=="hide"){a.from.opacity=
1;a.to.opacity=0}}e.from=a.from;e.to=a.to;e.mode=g;a.effect("size",e,b.duration,b.callback);a.dequeue()})};c.effects.size=function(b){return this.queue(function(){var a=c(this),e=["position","top","bottom","left","right","width","height","overflow","opacity"],g=["position","top","bottom","left","right","overflow","opacity"],h=["width","height","overflow"],i=["fontSize"],f=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],k=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],
p=c.effects.setMode(a,b.options.mode||"effect"),n=b.options.restore||false,m=b.options.scale||"both",l=b.options.origin,j={height:a.height(),width:a.width()};a.from=b.options.from||j;a.to=b.options.to||j;if(l){l=c.effects.getBaseline(l,j);a.from.top=(j.height-a.from.height)*l.y;a.from.left=(j.width-a.from.width)*l.x;a.to.top=(j.height-a.to.height)*l.y;a.to.left=(j.width-a.to.width)*l.x}var d={from:{y:a.from.height/j.height,x:a.from.width/j.width},to:{y:a.to.height/j.height,x:a.to.width/j.width}};
if(m=="box"||m=="both"){if(d.from.y!=d.to.y){e=e.concat(f);a.from=c.effects.setTransition(a,f,d.from.y,a.from);a.to=c.effects.setTransition(a,f,d.to.y,a.to)}if(d.from.x!=d.to.x){e=e.concat(k);a.from=c.effects.setTransition(a,k,d.from.x,a.from);a.to=c.effects.setTransition(a,k,d.to.x,a.to)}}if(m=="content"||m=="both")if(d.from.y!=d.to.y){e=e.concat(i);a.from=c.effects.setTransition(a,i,d.from.y,a.from);a.to=c.effects.setTransition(a,i,d.to.y,a.to)}c.effects.save(a,n?e:g);a.show();c.effects.createWrapper(a);
a.css("overflow","hidden").css(a.from);if(m=="content"||m=="both"){f=f.concat(["marginTop","marginBottom"]).concat(i);k=k.concat(["marginLeft","marginRight"]);h=e.concat(f).concat(k);a.find("*[width]").each(function(){child=c(this);n&&c.effects.save(child,h);var o={height:child.height(),width:child.width()};child.from={height:o.height*d.from.y,width:o.width*d.from.x};child.to={height:o.height*d.to.y,width:o.width*d.to.x};if(d.from.y!=d.to.y){child.from=c.effects.setTransition(child,f,d.from.y,child.from);
child.to=c.effects.setTransition(child,f,d.to.y,child.to)}if(d.from.x!=d.to.x){child.from=c.effects.setTransition(child,k,d.from.x,child.from);child.to=c.effects.setTransition(child,k,d.to.x,child.to)}child.css(child.from);child.animate(child.to,b.duration,b.options.easing,function(){n&&c.effects.restore(child,h)})})}a.animate(a.to,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){a.to.opacity===0&&a.css("opacity",a.from.opacity);p=="hide"&&a.hide();c.effects.restore(a,
n?e:g);c.effects.removeWrapper(a);b.callback&&b.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Shake 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Shake
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(d){d.effects.shake=function(a){return this.queue(function(){var b=d(this),j=["position","top","bottom","left","right"];d.effects.setMode(b,a.options.mode||"effect");var c=a.options.direction||"left",e=a.options.distance||20,l=a.options.times||3,f=a.duration||a.options.duration||140;d.effects.save(b,j);b.show();d.effects.createWrapper(b);var g=c=="up"||c=="down"?"top":"left",h=c=="up"||c=="left"?"pos":"neg";c={};var i={},k={};c[g]=(h=="pos"?"-=":"+=")+e;i[g]=(h=="pos"?"+=":"-=")+e*2;k[g]=
(h=="pos"?"-=":"+=")+e*2;b.animate(c,f,a.options.easing);for(e=1;e<l;e++)b.animate(i,f,a.options.easing).animate(k,f,a.options.easing);b.animate(i,f,a.options.easing).animate(c,f/2,a.options.easing,function(){d.effects.restore(b,j);d.effects.removeWrapper(b);a.callback&&a.callback.apply(this,arguments)});b.queue("fx",function(){b.dequeue()});b.dequeue()})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Slide 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Slide
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(c){c.effects.slide=function(d){return this.queue(function(){var a=c(this),h=["position","top","bottom","left","right"],f=c.effects.setMode(a,d.options.mode||"show"),b=d.options.direction||"left";c.effects.save(a,h);a.show();c.effects.createWrapper(a).css({overflow:"hidden"});var g=b=="up"||b=="down"?"top":"left";b=b=="up"||b=="left"?"pos":"neg";var e=d.options.distance||(g=="top"?a.outerHeight({margin:true}):a.outerWidth({margin:true}));if(f=="show")a.css(g,b=="pos"?isNaN(e)?"-"+e:-e:e);
var i={};i[g]=(f=="show"?b=="pos"?"+=":"-=":b=="pos"?"-=":"+=")+e;a.animate(i,{queue:false,duration:d.duration,easing:d.options.easing,complete:function(){f=="hide"&&a.hide();c.effects.restore(a,h);c.effects.removeWrapper(a);d.callback&&d.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
;/*
 * Note: While Microsoft is not the author of this file, Microsoft is
 * offering you a license subject to the terms of the Microsoft Software
 * License Terms for Microsoft ASP.NET Model View Controller 3.
 * Microsoft reserves all other rights. The notices below are provided
 * for informational purposes only and are not the license terms under
 * which Microsoft distributed this file.
 *
 * jQuery UI Effects Transfer 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 *
 * http://docs.jquery.com/UI/Effects/Transfer
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(e){e.effects.transfer=function(a){return this.queue(function(){var b=e(this),c=e(a.options.to),d=c.offset();c={top:d.top,left:d.left,height:c.innerHeight(),width:c.innerWidth()};d=b.offset();var f=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(a.options.className).css({top:d.top,left:d.left,height:b.innerHeight(),width:b.innerWidth(),position:"absolute"}).animate(c,a.duration,a.options.easing,function(){f.remove();a.callback&&a.callback.apply(b[0],arguments);
b.dequeue()})})}})(jQuery);
;
"use strict";
/**
 * @class elFinder - file manager for web
 *
 * @author Dmitry (dio) Levashov
 **/
window.elFinder = function(node, opts) {
    this.time('load');

    var self = this,

        /**
		 * Node on which elfinder creating
		 *
		 * @type jQuery
		 **/
        node = $(node),

        /**
		 * Store node contents.
		 *
		 * @see this.destroy
		 * @type jQuery
		 **/
        prevContent = $('<div/>').append(node.contents()),

        /**
		 * Store node inline styles
		 *
		 * @see this.destroy
		 * @type String
		 **/
        prevStyle = node.attr('style'),

        /**
		 * Instance ID. Required to get/set cookie
		 *
		 * @type String
		 **/
        id = node.attr('id') || '',

        /**
		 * Events namespace
		 *
		 * @type String
		 **/
        namespace = 'elfinder-' + (id || Math.random().toString().substr(2, 7)),

        /**
		 * Mousedown event
		 *
		 * @type String
		 **/
        mousedown = 'mousedown.' + namespace,

        /**
		 * Keydown event
		 *
		 * @type String
		 **/
        keydown = 'keydown.' + namespace,

        /**
		 * Keypress event
		 *
		 * @type String
		 **/
        keypress = 'keypress.' + namespace,

        /**
		 * Is shortcuts/commands enabled
		 *
		 * @type Boolean
		 **/
        enabled = true,

        /**
		 * Store enabled value before ajax requiest
		 *
		 * @type Boolean
		 **/
        prevEnabled = true,

        /**
		 * List of build-in events which mapped into methods with same names
		 *
		 * @type Array
		 **/
        events = ['enable', 'disable', 'load', 'open', 'reload', 'select', 'add', 'remove', 'change', 'dblclick', 'getfile', 'lockfiles', 'unlockfiles', 'dragstart', 'dragstop'],

        /**
		 * Rules to validate data from backend
		 *
		 * @type Object
		 **/
        rules = {},

        /**
		 * Current working directory hash
		 *
		 * @type String
		 **/
        cwd = '',

        /**
		 * Current working directory options
		 *
		 * @type Object
		 **/
        cwdOptions = {
            path: '',
            url: '',
            tmbUrl: '',
            disabled: [],
            separator: '/',
            archives: [],
            extract: [],
            copyOverwrite: true,
            tmb: false // old API
        },

        /**
		 * Files/dirs cache
		 *
		 * @type Object
		 **/
        files = {},

        /**
		 * Selected files hashes
		 *
		 * @type Array
		 **/
        selected = [],

        /**
		 * Events listeners
		 *
		 * @type Object
		 **/
        listeners = {},

        /**
		 * Shortcuts
		 *
		 * @type Object
		 **/
        shortcuts = {},

        /**
		 * Buffer for copied files
		 *
		 * @type Array
		 **/
        clipboard = [],

        /**
		 * Copied/cuted files hashes
		 * Prevent from remove its from cache.
		 * Required for dispaly correct files names in error messages
		 *
		 * @type Array
		 **/
        remember = [],

        /**
		 * Queue for 'open' requests
		 *
		 * @type Array
		 **/
        queue = [],

        /**
		 * Net drivers names
		 *
		 * @type Array
		 **/
        netDrivers = [],

        /**
		 * Commands prototype
		 *
		 * @type Object
		 **/
        base = new self.command(self),

        /**
		 * elFinder node width
		 *
		 * @type String
		 * @default "auto"
		 **/
        width = 'auto',

        /**
		 * elFinder node height
		 *
		 * @type Number
		 * @default 400
		 **/
        height = 400,

        beeper = $(document.createElement('audio')).hide().appendTo('body')[0],

        syncInterval,

        open = function(data) {
            if (data.init) {
                // init - reset cache
                files = {};
            } else {
                // remove only files from prev cwd
                for (var i in files) {
                    if (files.hasOwnProperty(i)
                        && files[i].mime != 'directory'
                        && files[i].phash == cwd
                        && $.inArray(i, remember) === -1) {
                        delete files[i];
                    }
                }
            }

            cwd = data.cwd.hash;
            cache(data.files);
            if (!files[cwd]) {
                cache([data.cwd]);
            }
            self.lastDir(cwd);
        },

        /**
		 * Store info about files/dirs in "files" object.
		 *
		 * @param  Array  files
		 * @return void
		 **/
        cache = function(data) {
            var l = data.length, f;

            while (l--) {
                f = data[l];
                if (f.name && f.hash && f.mime) {
                    if (!f.phash) {
                        var name = 'volume_' + f.name,
                            i18 = self.i18n(name);

                        if (name != i18) {
                            f.i18 = i18;
                        }
                    }
                    files[f.hash] = f;
                }
            }
        },

        /**
		 * Exec shortcut
		 *
		 * @param  jQuery.Event  keydown/keypress event
		 * @return void
		 */
        execShortcut = function(e) {
            var code = e.keyCode,
                ctrlKey = !!(e.ctrlKey || e.metaKey);

            if (enabled) {

                $.each(shortcuts, function(i, shortcut) {
                    if (shortcut.type == e.type
                        && shortcut.keyCode == code
                        && shortcut.shiftKey == e.shiftKey
                        && shortcut.ctrlKey == ctrlKey
                        && shortcut.altKey == e.altKey) {
                        e.preventDefault();
                        e.stopPropagation();
                        shortcut.callback(e, self);
                        self.debug('shortcut-exec', i + ' : ' + shortcut.description);
                    }
                });

                // prevent tab out of elfinder
                if (code == 9 && !$(e.target).is(':input')) {
                    e.preventDefault();
                }

            }
        },
        date = new Date(),
        utc,
        i18n;


    /**
	 * Protocol version
	 *
	 * @type String
	 **/
    this.api = null;

    /**
	 * elFinder use new api
	 *
	 * @type Boolean
	 **/
    this.newAPI = false;

    /**
	 * elFinder use old api
	 *
	 * @type Boolean
	 **/
    this.oldAPI = false;

    /**
	 * User os. Required to bind native shortcuts for open/rename
	 *
	 * @type String
	 **/
    this.OS = navigator.userAgent.indexOf('Mac') !== -1 ? 'mac' : navigator.userAgent.indexOf('Win') !== -1 ? 'win' : 'other';

    /**
	 * User browser UA.
	 * jQuery.browser: version deprecated: 1.3, removed: 1.9
	 *
	 * @type Object
	 **/
    this.UA = (function() {
        var webkit;
        try {
            webkit = !document.uniqueID && !window.opera && !window.sidebar && window.localStorage && typeof window.orientation == "undefined";
        } catch (ex) {
            webkit = false;
            window.console && window.console.log && window.console.log(ex);
        }
        return {
            // Browser IE <= IE 6
            ltIE6: typeof window.addEventListener == "undefined" && typeof document.documentElement.style.maxHeight == "undefined",
            // Browser IE <= IE 7
            ltIE7: typeof window.addEventListener == "undefined" && typeof document.querySelectorAll == "undefined",
            // Browser IE <= IE 8
            ltIE8: typeof window.addEventListener == "undefined" && typeof document.getElementsByClassName == "undefined",
            IE: document.uniqueID,
            Firefox: window.sidebar,
            Opera: window.opera,
            Webkit: webkit,
            Chrome: webkit && window.chrome,
            Safari: webkit && !window.chrome,
            Mobile: typeof window.orientation != "undefined"
        };
    })();

    /**
	 * Configuration options
	 *
	 * @type Object
	 **/
    this.options = $.extend(true, {}, this._options, opts || {});

    if (opts.ui) {
        this.options.ui = opts.ui;
    }

    if (opts.commands) {
        this.options.commands = opts.commands;
    }

    if (opts.uiOptions && opts.uiOptions.toolbar) {
        this.options.uiOptions.toolbar = opts.uiOptions.toolbar;
    }

    //For columns
    if (opts.uiOptions && opts.uiOptions.cwd && opts.uiOptions.cwd.listView && opts.uiOptions.cwd.listView.columns) {
        this.options.uiOptions.cwd.listView.columns = opts.uiOptions.cwd.listView.columns;
    }
    if (opts.uiOptions && opts.uiOptions.cwd && opts.uiOptions.cwd.listView && opts.uiOptions.cwd.listView.columnsCustomName) {
        this.options.uiOptions.cwd.listView.columnsCustomName = opts.uiOptions.cwd.listView.columnsCustomName;
    }

    $.extend(this.options.contextmenu, opts.contextmenu);


    /**
	 * Ajax request type
	 *
	 * @type String
	 * @default "get"
	 **/
    this.requestType = /^(get|post)$/i.test(this.options.requestType) ? this.options.requestType.toLowerCase() : 'get',

        /**
	 * Any data to send across every ajax request
	 *
	 * @type Object
	 * @default {}
	 **/
        this.customData = $.isPlainObject(this.options.customData) ? this.options.customData : {};

    /**
	 * ID. Required to create unique cookie name
	 *
	 * @type String
	 **/
    this.id = id;

    /**
	 * URL to upload files
	 *
	 * @type String
	 **/
    this.uploadURL = opts.urlUpload || opts.url;

    /**
	 * Events namespace
	 *
	 * @type String
	 **/
    this.namespace = namespace;

    /**
	 * Interface language
	 *
	 * @type String
	 * @default "en"
	 **/
    this.lang = this.i18[this.options.lang] && this.i18[this.options.lang].messages ? this.options.lang : 'en';

    i18n = this.lang == 'en'
        ? this.i18['en']
        : $.extend(true, {}, this.i18['en'], this.i18[this.lang]);

    /**
	 * Interface direction
	 *
	 * @type String
	 * @default "ltr"
	 **/
    this.direction = i18n.direction;

    /**
	 * i18 messages
	 *
	 * @type Object
	 **/
    this.messages = i18n.messages;

    /**
	 * Date/time format
	 *
	 * @type String
	 * @default "m.d.Y"
	 **/
    this.dateFormat = this.options.dateFormat || i18n.dateFormat;

    /**
	 * Date format like "Yesterday 10:20:12"
	 *
	 * @type String
	 * @default "{day} {time}"
	 **/
    this.fancyFormat = this.options.fancyDateFormat || i18n.fancyDateFormat;

    /**
	 * Today timestamp
	 *
	 * @type Number
	 **/
    this.today = (new Date(date.getFullYear(), date.getMonth(), date.getDate())).getTime() / 1000;

    /**
	 * Yesterday timestamp
	 *
	 * @type Number
	 **/
    this.yesterday = this.today - 86400;

    utc = this.options.UTCDate ? 'UTC' : '';

    this.getHours = 'get' + utc + 'Hours';
    this.getMinutes = 'get' + utc + 'Minutes';
    this.getSeconds = 'get' + utc + 'Seconds';
    this.getDate = 'get' + utc + 'Date';
    this.getDay = 'get' + utc + 'Day';
    this.getMonth = 'get' + utc + 'Month';
    this.getFullYear = 'get' + utc + 'FullYear';

    /**
	 * Css classes 
	 *
	 * @type String
	 **/
    this.cssClass = 'ui-helper-reset ui-helper-clearfix ui-widget ui-widget-content ui-corner-all elfinder elfinder-' + (this.direction == 'rtl' ? 'rtl' : 'ltr') + ' ' + this.options.cssClass;

    /**
	 * Method to store/fetch data
	 *
	 * @type Function
	 **/
    this.storage = (function() {
        try {
            return 'localStorage' in window && window['localStorage'] !== null ? self.localStorage : self.cookie;
        } catch (e) {
            return self.cookie;
        }
    })();

    this.viewType = this.storage('view') || this.options.defaultView || 'icons';

    this.sortType = this.storage('sortType') || this.options.sortType || 'name';

    this.sortOrder = this.storage('sortOrder') || this.options.sortOrder || 'asc';

    this.sortStickFolders = this.storage('sortStickFolders');

    if (this.sortStickFolders === null) {
        this.sortStickFolders = !!this.options.sortStickFolders;
    } else {
        this.sortStickFolders = !!this.sortStickFolders;
    }

    this.sortRules = $.extend(true, {}, this._sortRules, this.options.sortsRules);

    $.each(this.sortRules, function(name, method) {
        if (typeof method != 'function') {
            delete self.sortRules[name];
        }
    });

    this.compare = $.proxy(this.compare, this);

    /**
	 * Delay in ms before open notification dialog
	 *
	 * @type Number
	 * @default 500
	 **/
    this.notifyDelay = this.options.notifyDelay > 0 ? parseInt(this.options.notifyDelay) : 500;

    /**
	 * Base draggable options
	 *
	 * @type Object
	 **/
    this.draggable = {
        appendTo: 'body',
        addClasses: true,
        delay: 30,
        distance: 8,
        revert: true,
        refreshPositions: true,
        cursor: 'move',
        cursorAt: { left: 50, top: 47 },
        drag: function(e, ui) {
            if (!ui.helper.data('locked')) {
                ui.helper.toggleClass('elfinder-drag-helper-plus', e.shiftKey || e.ctrlKey || e.metaKey);
            }
        },
        start: function(e, ui) {
            var targets = $.map(ui.helper.data('files') || [], function(h) { return h || null; }),
                cnt,
                h;
            cnt = targets.length;
            while (cnt--) {
                h = targets[cnt];
                if (files[h].locked) {
                    ui.helper.addClass('elfinder-drag-helper-plus').data('locked', true);
                    break;
                }
            }
        },
        stop: function() { self.trigger('focus').trigger('dragstop'); },
        helper: function(e, ui) {
            var element = this.id ? $(this) : $(this).parents('[id]:first'),
                helper = $('<div class="elfinder-drag-helper"><span class="elfinder-drag-helper-icon-plus"/></div>'),
                icon = function(mime) { return '<div class="elfinder-cwd-icon ' + self.mime2class(mime) + ' ui-corner-all"/>'; },
                hashes,
                l;

            self.trigger('dragstart', { target: element[0], originalEvent: e });

            hashes = element.is('.' + self.res('class', 'cwdfile'))
                ? self.selected()
                : [self.navId2Hash(element.attr('id'))];

            helper.append(icon(files[hashes[0]].mime)).data('files', hashes).data('locked', false);

            if ((l = hashes.length) > 1) {
                helper.append(icon(files[hashes[l - 1]].mime) + '<span class="elfinder-drag-num">' + l + '</span>');
            }

            return helper;
        }
    };

    /**
	 * Base droppable options
	 *
	 * @type Object
	 **/
    this.droppable = {
        // greedy     : true,
        tolerance: 'pointer',
        accept: '.elfinder-cwd-file-wrapper,.elfinder-navbar-dir,.elfinder-cwd-file',
        hoverClass: this.res('class', 'adroppable'),
        drop: function(e, ui) {
            var dst = $(this),
                targets = $.map(ui.helper.data('files') || [], function(h) { return h || null; }),
                result = [],
                c = 'class',
                cnt,
                hash,
                i,
                h;

            if (dst.is('.' + self.res(c, 'cwd'))) {
                hash = cwd;
            } else if (dst.is('.' + self.res(c, 'cwdfile'))) {
                hash = dst.attr('id');
            } else if (dst.is('.' + self.res(c, 'navdir'))) {
                hash = self.navId2Hash(dst.attr('id'));
            }

            cnt = targets.length;

            while (cnt--) {
                h = targets[cnt];
                // ignore drop into itself or in own location
                h != hash && files[h].phash != hash && result.push(h);
            }

            if (result.length) {
                ui.helper.hide();
                self.clipboard(result, !(e.ctrlKey || e.shiftKey || e.metaKey || ui.helper.data('locked')));
                self.exec('paste', hash);
                self.trigger('drop', { files: targets });

            }
        }
    };

    /**
	 * Return true if filemanager is active
	 *
	 * @return Boolean
	 **/
    this.enabled = function() {
        return node.is(':visible') && enabled;
    }; /**
	 * Return true if filemanager is visible
	 *
	 * @return Boolean
	 **/
    this.visible = function() {
        return node.is(':visible');
    }; /**
	 * Return root dir hash for current working directory
	 * 
	 * @return String
	 */
    this.root = function(hash) {
        var dir = files[hash || cwd], i;

        while (dir && dir.phash) {
            dir = files[dir.phash];
        }
        if (dir) {
            return dir.hash;
        }

        while (i in files && files.hasOwnProperty(i)) {
            dir = files[i];
            if (!dir.phash && !dir.mime == 'directory' && dir.read) {
                return dir.hash;
            }
        }

        return '';
    }; /**
	 * Return current working directory info
	 * 
	 * @return Object
	 */
    this.cwd = function() {
        return files[cwd] || {};
    }; /**
	 * Return required cwd option
	 * 
	 * @param  String  option name
	 * @return mixed
	 */
    this.option = function(name) {
        return cwdOptions[name] || '';
    }; /**
	 * Return file data from current dir or tree by it's hash
	 * 
	 * @param  String  file hash
	 * @return Object
	 */
    this.file = function(hash) {
        return files[hash];
    };

    /**
	 * Return all cached files
	 * 
	 * @return Array
	 */
    this.files = function() {
        return $.extend(true, {}, files);
    }; /**
	 * Return list of file parents hashes include file hash
	 * 
	 * @param  String  file hash
	 * @return Array
	 */
    this.parents = function(hash) {
        var parents = [],
            dir;

        while ((dir = this.file(hash))) {
            parents.unshift(dir.hash);
            hash = dir.phash;
        }
        return parents;
    };
    this.path2array = function(hash, i18) {
        var file,
            path = [];

        while (hash && (file = files[hash]) && file.hash) {
            path.unshift(i18 && file.i18 ? file.i18 : file.name);
            hash = file.phash;
        }

        return path;
    }; /**
	 * Return file path
	 * 
	 * @param  Object  file
	 * @return String
	 */
    this.path = function(hash, i18) {
        return files[hash] && files[hash].path
            ? files[hash].path
            : this.path2array(hash, i18).join(cwdOptions.separator);
    }; /**
	 * Return file url if set
	 * 
	 * @param  Object  file
	 * @return String
	 */
    this.url = function(hash) {
        var file = files[hash];

        if (!file || !file.read) {
            return '';
        }

        if (file.url) {
            return file.url;
        }

        if (cwdOptions.url) {
            return cwdOptions.url + $.map(this.path2array(hash), function(n) { return encodeURIComponent(n); }).slice(1).join('/');
        }

        var params = $.extend({}, this.customData, {
            cmd: 'file',
            target: file.hash
        });
        if (this.oldAPI) {
            params.cmd = 'open';
            params.current = file.phash;
        }
        return this.options.url + (this.options.url.indexOf('?') === -1 ? '?' : '&') + $.param(params, true);
    }; /**
	 * Return thumbnail url
	 * 
	 * @param  String  file hash
	 * @return String
	 */
    this.tmb = function(hash) {
        var file = files[hash],
            url = file && file.tmb && file.tmb != 1 ? cwdOptions['tmbUrl'] + file.tmb : '';

        if (url && (this.UA.Opera || this.UA.IE)) {
            url += '?_=' + new Date().getTime();
        }
        return url;
    }; /**
	 * Return selected files hashes
	 *
	 * @return Array
	 **/
    this.selected = function() {
        return selected.slice(0);
    }; /**
	 * Return selected files info
	 * 
	 * @return Array
	 */
    this.selectedFiles = function() {
        return $.map(selected, function(hash) { return files[hash] ? $.extend({}, files[hash]) : null; });
    };

    /**
	 * Return true if file with required name existsin required folder
	 * 
	 * @param  String  file name
	 * @param  String  parent folder hash
	 * @return Boolean
	 */
    this.fileByName = function(name, phash) {
        var hash;

        for (hash in files) {
            if (files.hasOwnProperty(hash) && files[hash].phash == phash && files[hash].name == name) {
                return files[hash];
            }
        }
    };

    /**
	 * Valid data for required command based on rules
	 * 
	 * @param  String  command name
	 * @param  Object  cammand's data
	 * @return Boolean
	 */
    this.validResponse = function(cmd, data) {
        return data.error || this.rules[this.rules[cmd] ? cmd : 'defaults'](data);
    }; /**
	 * Proccess ajax request.
	 * Fired events :
	 * @example
	 * @return $.Deferred
	 */
    this.request = function(options) {
        var self = this,
            o = this.options,
            dfrd = $.Deferred(),
            // request data
            data = $.extend({}, o.customData, { mimes: o.onlyMimes }, options.data || options),
            // command name
            cmd = data.cmd,
            // call default fail callback (display error dialog) ?
            deffail = !(options.preventDefault || options.preventFail),
            // call default success callback ?
            defdone = !(options.preventDefault || options.preventDone),
            // options for notify dialog
            notify = $.extend({}, options.notify),
            // do not normalize data - return as is
            raw = !!options.raw,
            // sync files on request fail
            syncOnFail = options.syncOnFail,
            // open notify dialog timeout		
            timeout,
            // request options
            options = $.extend({
                url: o.url,
                async: true,
                type: this.requestType,
                dataType: 'json',
                cache: false,
                // timeout  : 100,
                data: data
            }, options.options || {}),
            /**
			 * Default success handler. 
			 * Call default data handlers and fire event with command name.
			 *
			 * @param Object  normalized response data
			 * @return void
			 **/
            done = function(data) {

                data.warning && self.error(data.warning);

                cmd == 'open' && open($.extend(true, {}, data));

                // fire some event to update cache/ui
                data.removed && data.removed.length && self.remove(data);
                data.added && data.added.length && self.add(data);
                data.changed && data.changed.length && self.change(data);

                // fire event with command name
                self.trigger(cmd, data);

                // force update content
                data.sync && self.sync();
            },
            /**
			 * Request error handler. Reject dfrd with correct error message.
			 *
			 * @param jqxhr  request object
			 * @param String request status
			 * @return void
			 **/
            error = function(xhr, status) {
                var error;

                switch (status) {
                case 'abort':
                    error = xhr.quiet ? '' : ['errConnect', 'errAbort'];
                    break;
                case 'timeout':
                    error = ['errConnect', 'errTimeout'];
                    break;
                case 'parsererror':
                    error = ['errResponse', 'errDataNotJSON'];
                    break;
                default:
                    if (xhr.status == 403) {
                        error = ['errConnect', 'errAccess'];
                    } else if (xhr.status == 404) {
                        error = ['errConnect', 'errNotFound'];
                    } else {
                        error = 'errConnect';
                    }
                }

                dfrd.reject(error, xhr, status);
            },
            /**
			 * Request success handler. Valid response data and reject/resolve dfrd.
			 *
			 * @param Object  response data
			 * @param String request status
			 * @return void
			 **/
            success = function(response) {
                if (raw) {
                    return dfrd.resolve(response);
                }

                if (!response) {
                    return dfrd.reject(['errResponse', 'errDataEmpty'], xhr);
                } else if (!$.isPlainObject(response)) {
                    return dfrd.reject(['errResponse', 'errDataNotJSON'], xhr);
                } else if (response.error) {
                    if (response.redurl) {
                        if (self.isModal) {
                            if (parent.Master && parent.Master.goUrl) {
                                parent.Master.goUrl(response.redurl);
                            }
                        } else {
                            window.location.href = response.redurl;
                        }
                        return dfrd.reject();
                    }
                    if (response.log) {
                        window.console && window.console.log && window.console.log(response.log);
                        return dfrd.reject(response.error);
                    }
                    return dfrd.reject(response.error);
                } else if (!self.validResponse(cmd, response)) {
                    return dfrd.reject('errResponse', xhr);
                }

                response = self.normalize(response);

                if (!self.api) {
                    self.api = response.api || 1;
                    self.newAPI = self.api >= 2;
                    self.oldAPI = !self.newAPI;
                }

                if (response.options) {
                    cwdOptions = $.extend({}, cwdOptions, response.options);
                }

                if (response.netDrivers) {
                    self.netDrivers = response.netDrivers;
                }

                dfrd.resolve(response);
                response.debug && self.debug('backend-debug', response.debug);
            },
            xhr,
            _xhr;

        defdone && dfrd.done(done);
        dfrd.fail(function(error) {
            if (error) {
                deffail ? self.error(error) : self.debug('error', self.i18n(error));
            }
        });
        if (!cmd) {
            return dfrd.reject('errCmdReq');
        }

        if (syncOnFail) {
            dfrd.fail(function(error) {
                error && self.sync();
            });
        }

        if (notify.type && notify.cnt) {
            timeout = setTimeout(function() {
                self.notify(notify);
                dfrd.always(function() {
                    notify.cnt = -(parseInt(notify.cnt) || 0);
                    self.notify(notify);
                });
            }, self.notifyDelay);
            dfrd.always(function() {
                clearTimeout(timeout);
            });
        }

        // quiet abort not completed "open" requests
        if (cmd == 'open') {
            while ((_xhr = queue.pop())) {
                if (_xhr.state() == 'pending') {
                    _xhr.quiet = true;
                    _xhr.abort();
                }
            }
        }

        delete options.preventFail;
        xhr = this.transport.send(options).fail(error).done(success);

        // this.transport.send(options)

        // add "open" xhr into queue
        if (cmd == 'open') {
            queue.unshift(xhr);
            dfrd.always(function() {
                var ndx = $.inArray(xhr, queue);

                ndx !== -1 && queue.splice(ndx, 1);
            });
        }

        return dfrd;
    };

    /**
	 * Compare current files cache with new files and return diff
	 * 
	 * @param  Array  new files
	 * @return Object
	 */
    this.diff = function(incoming) {
        var raw = {},
            added = [],
            removed = [],
            changed = [],
            isChanged = function(hash) {
                var l = changed.length;

                while (l--) {
                    if (changed[l].hash == hash) {
                        return true;
                    }
                }
            };

        $.each(incoming, function(i, f) {
            raw[f.hash] = f;
        });

        // find removed
        $.each(files, function(hash, f) {
            !raw[hash] && removed.push(hash);
        });

        // compare files
        $.each(raw, function(hash, file) {
            var origin = files[hash];

            if (!origin) {
                added.push(file);
            } else {
                $.each(file, function(prop) {
                    if (file[prop] != origin[prop]) {
                        changed.push(file);
                        return false;
                    }
                });
            }
        });

        // parents of removed dirs mark as changed (required for tree correct work)
        $.each(removed, function(i, hash) {
            var file = files[hash],
                phash = file.phash;

            if (phash
                && file.mime == 'directory'
                && $.inArray(phash, removed) === -1
                && raw[phash]
                && !isChanged(phash)) {
                changed.push(raw[phash]);
            }
        });

        return {
            added: added,
            removed: removed,
            changed: changed
        };
    }; /**
	 * Sync content
	 * 
	 * @return jQuery.Deferred
	 */
    this.sync = function() {
        var self = this,
            dfrd = $.Deferred().done(function() { self.trigger('sync'); }),
            opts1 = {
                data: { cmd: 'open', init: 1, target: cwd, tree: this.ui.tree ? 1 : 0 },
                preventDefault: true
            },
            opts2 = {
                data: { cmd: 'tree', target: (cwd == this.root()) ? cwd : this.file(cwd).phash },
                preventDefault: true
            };

        $.when(
                this.request(opts1),
                this.request(opts2)
            )
            .fail(function(error) {
                dfrd.reject(error);
                error && self.request({
                    data: { cmd: 'open', target: self.lastDir(''), tree: 1, init: 1 },
                    notify: { type: 'open', cnt: 1, hideCnt: true },
                    preventDefault: true
                });
            })
            .done(function(odata, pdata) {
                var diff = self.diff(odata.files.concat(pdata && pdata.tree ? pdata.tree : []));

                diff.added.push(odata.cwd);
                diff.removed.length && self.remove(diff);
                diff.added.length && self.add(diff);
                diff.changed.length && self.change(diff);
                return dfrd.resolve(diff);
            });

        return dfrd;
    };
    this.upload = function(files, notUpload, dublicateIndexes) {
        return this.transport.upload(files, this, notUpload, dublicateIndexes);
    }; /**
	 * Attach listener to events
	 * To bind to multiply events at once, separate events names by space
	 * 
	 * @param  String  event(s) name(s)
	 * @param  Object  event handler
	 * @return elFinder
	 */
    this.bind = function(event, callback) {
        var i;

        if (typeof (callback) == 'function') {
            event = ('' + event).toLowerCase().split(/\s+/);

            for (i = 0; i < event.length; i++) {
                if (listeners[event[i]] === void (0)) {
                    listeners[event[i]] = [];
                }
                listeners[event[i]].push(callback);
            }
        }
        return this;
    };

    /**
	 * Remove event listener if exists
	 *
	 * @param  String    event name
	 * @param  Function  callback
	 * @return elFinder
	 */
    this.unbind = function(event, callback) {
        var l = listeners[('' + event).toLowerCase()] || [],
            i = l.indexOf(callback);

        i > -1 && l.splice(i, 1);
        //delete callback; // need this?
        callback = null;
        return this;
    };

    /**
	 * Fire event - send notification to all event listeners
	 *
	 * @param  String   event type
	 * @param  Object   data to send across event
	 * @return elFinder
	 */
    this.trigger = function(event, data) {
        var event = event.toLowerCase(),
            handlers = listeners[event] || [],
            i,
            j;

        this.debug('event-' + event, data);
        if (handlers.length) {
            event = $.Event(event);

            for (i = 0; i < handlers.length; i++) {
                // to avoid data modifications. remember about "sharing" passing arguments in js :) 
                event.data = $.extend(true, {}, data);

                try {
                    if (handlers[i](event, this) === false
                        || event.isDefaultPrevented()) {
                        this.debug('event-stoped', event.type);
                        break;
                    }
                } catch (ex) {
                    window.console && window.console.log && window.console.log(ex);
                }

            }
        }
        return this;
    }; /**
	 * Bind keybord shortcut to keydown event
	 *
	 * @example
	 *    elfinder.shortcut({ 
	 *       pattern : 'ctrl+a', 
	 *       description : 'Select all files', 
	 *       callback : function(e) { ... }, 
	 *       keypress : true|false (bind to keypress instead of keydown) 
	 *    })
	 *
	 * @param  Object  shortcut config
	 * @return elFinder
	 */
    this.shortcut = function(s) {
        var patterns, pattern, code, i, parts;

        if (this.options.allowShortcuts && s.pattern && $.isFunction(s.callback)) {
            patterns = s.pattern.toUpperCase().split(/\s+/);

            for (i = 0; i < patterns.length; i++) {
                pattern = patterns[i];
                parts = pattern.split('+');
                code = (code = parts.pop()).length == 1
                    ? code > 0 ? code : code.charCodeAt(0)
                    : $.ui.keyCode[code];

                if (code && !shortcuts[pattern]) {
                    shortcuts[pattern] = {
                        keyCode: code,
                        altKey: $.inArray('ALT', parts) != -1,
                        ctrlKey: $.inArray('CTRL', parts) != -1,
                        shiftKey: $.inArray('SHIFT', parts) != -1,
                        type: s.type || 'keydown',
                        callback: s.callback,
                        description: s.description,
                        pattern: pattern
                    };
                }
            }
        }
        return this;
    }; /**
	 * Registered shortcuts
	 *
	 * @type Object
	 **/
    this.shortcuts = function() {
        var ret = [];

        $.each(shortcuts, function(i, s) {
            ret.push([s.pattern, self.i18n(s.description)]);
        });
        return ret;
    };

    /**
	 * Get/set clipboard content.
	 * Return new clipboard content.
	 *
	 * @example
	 *   this.clipboard([]) - clean clipboard
	 *   this.clipboard([{...}, {...}], true) - put 2 files in clipboard and mark it as cutted
	 * 
	 * @param  Array    new files hashes
	 * @param  Boolean  cut files?
	 * @return Array
	 */
    this.clipboard = function(hashes, cut) {
        var map = function() { return $.map(clipboard, function(f) { return f.hash; }); };
        if (hashes !== void (0)) {
            clipboard.length && this.trigger('unlockfiles', { files: map() });
            remember = [];

            clipboard = $.map(hashes || [], function(hash) {
                var file = files[hash];
                if (file) {

                    remember.push(hash);

                    return {
                        hash: hash,
                        phash: file.phash,
                        name: file.name,
                        mime: file.mime,
                        read: file.read,
                        locked: file.locked,
                        cut: !!cut
                    };
                }
                return null;
            });
            this.trigger('changeclipboard', { clipboard: clipboard.slice(0, clipboard.length) });
            cut && this.trigger('lockfiles', { files: map() });
        }

        // return copy of clipboard instead of refrence
        return clipboard.slice(0, clipboard.length);
    }; /**
	 * Return true if command enabled
	 * 
	 * @param  String  command name
	 * @return Boolean
	 */
    this.isCommandEnabled = function(name) {
        return this._commands[name] ? $.inArray(name, cwdOptions.disabled) === -1 : false;
    }; /**
	 * Exec command and return result;
	 *
	 * @param  String         command name
	 * @param  String|Array   usualy files hashes
	 * @param  String|Array   command options
	 * @return $.Deferred
	 */
    this.exec = function(cmd, files, opts) {
        return this._commands[cmd] && this.isCommandEnabled(cmd)
            ? this._commands[cmd].exec(files, opts)
            : $.Deferred().reject('No such command');
    }; /**
	 * Create and return dialog.
	 *
	 * @param  String|DOMElement  dialog content
	 * @param  Object             dialog options
	 * @return jQuery
	 */
    this.dialog = function(content, options) {
        return $('<div/>').append(content).appendTo(node).elfindercryptxdialog(options);
        //return $('<div/>').append(content).appendTo(node).elfinderdialog(options);
    }; /**
	 * Return UI widget or node
	 *
	 * @param  String  ui name
	 * @return jQuery
	 */
    this.getUI = function(ui) {
        return this.ui[ui] || node;
    };
    this.command = function(name) {
        return name === void (0) ? this._commands : this._commands[name];
    }; /**
	 * Resize elfinder node
	 * 
	 * @param  String|Number  width
	 * @param  Number         height
	 * @return void
	 */
    this.resize = function(w, h) {
        node.css('width', w).height(h).trigger('resize');
        this.trigger('resize', {
            width: node.width(),
            height: node.height()
        });
    }; /**
	 * Restore elfinder node size
	 * 
	 * @return elFinder
	 */
    this.restoreSize = function() {
        this.resize(width, height);
    };
    this.show = function() {
        node.show();
        this.enable().trigger('show');
    };
    this.hide = function() {
        this.disable().trigger('hide');
        node.hide();
    }; /**
	 * Destroy this elFinder instance
	 *
	 * @return void
	 **/
    this.destroy = function() {
        if (node && node[0].elfinder) {
            this.trigger('destroy').disable();
            listeners = {};
            shortcuts = {};
            $(document).add(node).unbind('.' + this.namespace);
            self.trigger = function() {};
            node.children().remove();
            node.append(prevContent.contents()).removeClass(this.cssClass).attr('style', prevStyle);
            node[0].elfinder = null;
            if (syncInterval) {
                clearInterval(syncInterval);
            }
        }
    }; /*************  init stuffs  ****************/

    // check jquery ui
    if (!($.fn.selectable && $.fn.draggable && $.fn.droppable)) {
        return alert(this.i18n('errJqui'));
    }

    // check node
    if (!node.length) {
        return alert(this.i18n('errNode'));
    }
    // check connector url
    if (!this.options.url) {
        return alert(this.i18n('errURL'));
    }

    $.extend($.ui.keyCode, {
        'F1': 112,
        'F2': 113,
        'F3': 114,
        'F4': 115,
        'F5': 116,
        'F6': 117,
        'F7': 118,
        'F8': 119,
        'F9': 120
    });

    this.dragUpload = false;
    this.xhrUpload = (typeof XMLHttpRequestUpload != 'undefined' || typeof XMLHttpRequestEventTarget != 'undefined') && typeof File != 'undefined' && typeof FormData != 'undefined';

    // configure transport object
    this.transport = {};
    if (typeof (this.options.transport) == 'object') {
        this.transport = this.options.transport;
        if (typeof (this.transport.init) == 'function') {
            this.transport.init(this);
        }
    }

    if (typeof (this.transport.send) != 'function') {
        this.transport.send = function(opts) { return $.ajax(opts); };
    }

    if (this.transport.upload == 'iframe') {
        this.transport.upload = $.proxy(this.uploads.iframe, this);
    } else if (typeof (this.transport.upload) == 'function') {
        this.dragUpload = !!this.options.dragUploadAllow;
    } else if (this.xhrUpload && !!this.options.dragUploadAllow) {
        this.transport.upload = $.proxy(this.uploads.xhr, this);
        this.dragUpload = true;
    } else {
        this.transport.upload = $.proxy(this.uploads.iframe, this);
    }

    /**
	 * Alias for this.trigger('error', {error : 'message'})
	 *
	 * @param  String  error message
	 * @return elFinder
	 **/
    this.error = function() {
        var arg = arguments[0];
        return arguments.length == 1 && typeof (arg) == 'function'
            ? self.bind('error', arg)
            : self.trigger('error', { error: arg });
    }; // create bind/trigger aliases for build-in events
    $.each(['enable', 'disable', 'load', 'open', 'reload', 'select', 'add', 'remove', 'change', 'dblclick', 'getfile', 'lockfiles', 'unlockfiles', 'dragstart', 'dragstop', 'search', 'searchend', 'viewchange'], function(i, name) {
        self[name] = function() {
            var arg = arguments[0];
            return arguments.length == 1 && typeof (arg) == 'function'
                ? self.bind(name, arg)
                : self.trigger(name, $.isPlainObject(arg) ? arg : {});
        };
    });

    // bind core event handlers
    this
        .enable(function() {
            if (!enabled && self.visible() && self.ui.overlay.is(':hidden')) {
                enabled = true;
                $('texarea:focus, input:focus, button').blur();
                node.removeClass('elfinder-disabled');
            }
        })
        .disable(function() {
            prevEnabled = enabled;
            enabled = false;
            node.addClass('elfinder-disabled');
        })
        .open(function() {
            selected = [];
        })
        .select(function(e) {
            selected = $.map(e.data.selected || e.data.value || [], function(hash) { return files[hash] ? hash : null; });
        })
        .error(function(e) {
            var opts = {
                cssClass: 'elfinder-dialog-error',
                title: self.i18n(self.i18n('error')),
                resizable: false,
                destroyOnClose: true,
                buttons: {}
            };

            opts.buttons[self.i18n(self.i18n('btnClose'))] = function() {
                //$(this).elfinderdialog('close');
                $(this).elfindercryptxdialog('close');
            };

            self.dialog('<div class="error"><span>' + self.i18n(e.data.error) + '</span></div></div>', opts);
            //self.dialog('<span class="elfinder-dialog-icon elfinder-dialog-icon-error"/>'+self.i18n(e.data.error), opts);
        })
        .bind('tree parents', function(e) {
            cache(e.data.tree || []);
        })
        .bind('tmb', function(e) {
            $.each(e.data.images || [], function(hash, tmb) {
                if (files[hash]) {
                    files[hash].tmb = tmb;
                }
            });
        })
        .add(function(e) {
            cache(e.data.added || []);
        })
        .change(function(e) {
            $.each(e.data.changed || [], function(i, file) {
                var hash = file.hash;
                if ((files[hash].width && !file.width) || (files[hash].height && !file.height)) {
                    files[hash].width = undefined;
                    files[hash].height = undefined;
                }
                files[hash] = files[hash] ? $.extend(files[hash], file) : file;
            });
        })
        .remove(function(e) {
            var removed = e.data.removed || [],
                l = removed.length,
                rm = function(hash) {
                    var file = files[hash];
                    if (file) {
                        if (file.mime == 'directory' && file.dirs) {
                            $.each(files, function(h, f) {
                                f.phash == hash && rm(h);
                            });
                        }
                        delete files[hash];
                    }
                };

            while (l--) {
                rm(removed[l]);
            }

        })
        .bind('search', function(e) {
            cache(e.data.files);
        })
        .bind('rm', function(e) {
            var play = beeper.canPlayType && beeper.canPlayType('audio/wav; codecs="1"');

            play && play != '' && play != 'no' && $(beeper).html('<source src="./sounds/rm.wav" type="audio/wav">')[0].play();
        });

    // bind external event handlers
    $.each(this.options.handlers, function(event, callback) {
        self.bind(event, callback);
    });

    /**
	 * History object. Store visited folders
	 *
	 * @type Object
	 **/
    this.history = new this.history(this);

    // in getFileCallback set - change default actions on double click/enter/ctrl+enter
    if (typeof (this.options.getFileCallback) == 'function' && this.commands.getfile) {
        this.bind('dblclick', function(e) {
            e.preventDefault();
            self.exec('getfile').fail(function() {
                self.exec('open');
            });
        });
        this.shortcut({
                pattern: 'enter',
                description: this.i18n('cmdgetfile'),
                callback: function() { self.exec('getfile').fail(function() { self.exec(self.OS == 'mac' ? 'rename' : 'open'); }); }
            })
            .shortcut({
                pattern: 'ctrl+enter',
                description: this.i18n(this.OS == 'mac' ? 'cmdrename' : 'cmdopen'),
                callback: function() { self.exec(self.OS == 'mac' ? 'rename' : 'open'); }
            });

    }

    /**
	 * Loaded commands
	 *
	 * @type Object
	 **/
    this._commands = {};

    if (!$.isArray(this.options.commands)) {
        this.options.commands = [];
    }
    // check required commands
    $.each(['open', 'reload', 'back', 'forward', 'up', 'home', 'info', 'quicklook', 'getfile', 'help'], function(i, cmd) {
        $.inArray(cmd, self.options.commands) === -1 && self.options.commands.push(cmd);
    });

    // load commands
    $.each(this.options.commands, function(i, name) {
        var cmd = self.commands[name];
        if ($.isFunction(cmd) && !self._commands[name]) {
            cmd.prototype = base;
            self._commands[name] = new cmd();
            self._commands[name].setup(name, self.options.commandsOptions[name] || {});
        }
    });

    // prepare node
    node.addClass(this.cssClass)
        .bind(mousedown, function() {
            !enabled && self.enable();
        });

    /**
	 * UI nodes
	 *
	 * @type Object
	 **/
    this.ui = {
        // container for nav panel and current folder container
        workzone: $('<div/>').appendTo(node).elfinderworkzone(this),
        // container for folders tree / places
        navbar: $('<div/>').appendTo(node).elfindernavbar(this, this.options.uiOptions.navbar || {}),
        // contextmenu
        contextmenu: $('<div/>').appendTo(node).elfindercontextmenu(this),
        // overlay
        overlay: $('<div/>').appendTo(node).elfinderoverlay({
            show: function() { self.disable(); },
            hide: function() { prevEnabled && self.enable(); }
        }),
        // current folder container
        cwd: $('<div/>').appendTo(node).elfindercwd(this, this.options.uiOptions.cwd || {}),
        // notification dialog window
        notify: this.dialog('', {
            cssClass: 'elfinder-dialog-notify',
            position: { top: '12px', right: '12px' },
            resizable: false,
            autoOpen: false,
            title: '&nbsp;',
            width: 280
        }),
        statusbar: $('<div class="ui-widget-header ui-helper-clearfix ui-corner-bottom elfinder-statusbar"/>').hide().appendTo(node)
    }; // load required ui
    $.each(this.options.ui || [], function(i, ui) {
        var name = 'elfinder' + ui,
            opts = self.options.uiOptions[ui] || {};

        if (!self.ui[ui] && $.fn[name]) {
            self.ui[ui] = $('<' + (opts.tag || 'div') + '/>').appendTo(node)[name](self, opts);
        }
    });


// store instance in node
    node[0].elfinder = this;

    // make node resizable
    this.options.resizable
        && $.fn.resizable
        && node.resizable({
            handles: 'se',
            minWidth: 300,
            minHeight: 200
        });

    if (this.options.width) {
        width = this.options.width;
    }

    if (this.options.height) {
        height = parseInt(this.options.height);
    }

    // update size	
    self.resize(width, height);

    // attach events to document
    $(document)
        // disable elfinder on click outside elfinder
        .bind('click.' + this.namespace, function(e) {
            //enabled && !$(e.target).closest(node).length && self.disable();
        })
        // exec shortcuts
        .bind(keydown + ' ' + keypress, execShortcut);

    // attach events to window
    self.options.useBrowserHistory && $(window)
        .on('popstate', function(ev) {
            var target = ev.originalEvent.state && ev.originalEvent.state.thash;
            target && !$.isEmptyObject(self.files()) && self.request({
                data: { cmd: 'open', target: target, onhistory: 1 },
                notify: { type: 'open', cnt: 1, hideCnt: true },
                syncOnFail: true
            });
        });

    var openData = { cmd: 'open', target: self.startDir(), init: 1, tree: this.ui.tree ? 1 : 0, isReceivedMail: 0, isModal: self.GetModalStatus() };
    if (self.GetReceivedMailId()) {
        openData.isReceivedMail = 1;
    }

    // send initial request and start to pray >_<
    this.trigger('init')
        .request({
            data: openData,
            preventDone: true,
            notify: { type: 'open', cnt: 1, hideCnt: true },
            freeze: true
        })
        .fail(function() {
            self.trigger('fail').disable().lastDir('');
            listeners = {};
            shortcuts = {};
            $(document).add(node).unbind('.' + this.namespace);
            self.trigger = function() {};
        })
        .done(function(data) {
            self.load().debug('api', self.api);
            data = $.extend(true, {}, data);
            open(data);
            self.trigger('open', data);
            if (self.GetReceivedMailId()) {
                self.trigger('received');
            }
        });

    // update ui's size after init
    this.one('load', function() {
        node.trigger('resize');
        if (self.options.sync > 1000) {
            syncInterval = setInterval(function() {
                self.sync();
            }, self.options.sync);
        }

    });

    this.one('filter', function(e) {
        files = {};
        cwd = e.data.cwd.hash;
        cache(e.data.files);
        if (!files[cwd]) {
            cache([e.data.cwd]);
        }
        self.lastDir(cwd);
    });

    // self.timeEnd('load'); 
};

function qs(key) {
    key = key.replace(/[*+?^$.\[\]{}()|\\\/]/g, "\\$&"); // escape RegEx meta chars
    var match = location.search.match(new RegExp("[?&]" + key + "=([^&]+)(&|$)"));
    return match && decodeURIComponent(match[1].replace(/\+/g, " "));
}

/**
 * Prototype
 * 
 * @type  Object
 */
elFinder.prototype = {
    getExtension: function(filename) {
        return (/[.]/.exec(filename)) ? /[^.]+$/.exec(filename) : undefined;
    },

    isModal: false,

    blockMultiSelection: false,

    MasterUrl: '/master/index',

    res: function(type, id) {
        return this.resources[type] && this.resources[type][id];
    },

    /**
	 * Internationalization object
	 * 
	 * @type  Object
	 */
    i18: {
        en: {
            translator: '',
            language: 'English',
            direction: 'ltr',
            dateFormat: 'd.m.Y H:i',
            fancyDateFormat: '$1 H:i',
            messages: {}
        },
        months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
        monthsShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],

        days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
        daysShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']
    },

    /**
	 * File mimetype to kind mapping
	 * 
	 * @type  Object
	 */
    kinds: {
        'unknown': 'Unknown',
        'directory': 'Folder',
        'symlink': 'Alias',
        'symlink-broken': 'AliasBroken',
        'application/x-empty': 'TextPlain',
        'application/postscript': 'Postscript',
        'application/vnd.ms-office': 'MsOffice',
        'application/vnd.ms-word': 'MsWord',
        'application/msword': 'MsWord',
        'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'MsWord',
        'application/vnd.ms-word.document.macroEnabled.12': 'MsWord',
        'application/vnd.openxmlformats-officedocument.wordprocessingml.template': 'MsWord',
        'application/vnd.ms-word.template.macroEnabled.12': 'MsWord',
        'application/x-docx': 'MsWord',
        'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': 'MsExcel',
        'application/vnd.ms-excel': 'MsExcel',
        'application/vnd.ms-excel.sheet.macroEnabled.12': 'MsExcel',
        'application/vnd.openxmlformats-officedocument.spreadsheetml.template': 'MsExcel',
        'application/vnd.ms-excel.template.macroEnabled.12': 'MsExcel',
        'application/vnd.ms-excel.sheet.binary.macroEnabled.12': 'MsExcel',
        'application/vnd.ms-excel.addin.macroEnabled.12': 'MsExcel',
        'application/vnd.ms-powerpoint': 'MsPP',
        'application/vnd.openxmlformats-officedocument.presentationml.presentation': 'MsPP',
        'application/vnd.ms-powerpoint.presentation.macroEnabled.12': 'MsPP',
        'application/vnd.openxmlformats-officedocument.presentationml.slideshow': 'MsPP',
        'application/vnd.ms-powerpoint.slideshow.macroEnabled.12': 'MsPP',
        'application/vnd.openxmlformats-officedocument.presentationml.template': 'MsPP',
        'application/vnd.ms-powerpoint.template.macroEnabled.12': 'MsPP',
        'application/vnd.ms-powerpoint.addin.macroEnabled.12': 'MsPP',
        'application/vnd.openxmlformats-officedocument.presentationml.slide': 'MsPP',
        'application/vnd.ms-powerpoint.slide.macroEnabled.12': 'MsPP',
        'application/pdf': 'PDF',
        'application/xml': 'XML',
        'application/vnd.oasis.opendocument.text': 'OO',
        'application/vnd.oasis.opendocument.text-template': 'OO',
        'application/vnd.oasis.opendocument.text-web': 'OO',
        'application/vnd.oasis.opendocument.text-master': 'OO',
        'application/vnd.oasis.opendocument.graphics': 'OO',
        'application/vnd.oasis.opendocument.graphics-template': 'OO',
        'application/vnd.oasis.opendocument.presentation': 'OO',
        'application/vnd.oasis.opendocument.presentation-template': 'OO',
        'application/vnd.oasis.opendocument.spreadsheet': 'OO',
        'application/vnd.oasis.opendocument.spreadsheet-template': 'OO',
        'application/vnd.oasis.opendocument.chart': 'OO',
        'application/vnd.oasis.opendocument.formula': 'OO',
        'application/vnd.oasis.opendocument.database': 'OO',
        'application/vnd.oasis.opendocument.image': 'OO',
        'application/vnd.openofficeorg.extension': 'OO',
        'application/x-shockwave-flash': 'AppFlash',
        'application/flash-video': 'FlashVideo',
        'application/x-bittorrent': 'Torrent',
        'application/javascript': 'JS',
        'application/rtf': 'RTF',
        'application/rtfd': 'RTF',
        'application/x-font-ttf': 'TTF',
        'application/x-font-otf': 'OTF',
        'application/x-rpm': 'RPM',
        'application/x-web-config': 'TextPlain',
        'application/xhtml+xml': 'HTML',
        'application/docbook+xml': 'DOCBOOK',
        'application/x-awk': 'AWK',
        'application/x-gzip': 'GZIP',
        'application/x-bzip2': 'BZIP',
        'application/zip': 'ZIP',
        'application/x-zip': 'ZIP',
        'application/x-rar': 'RAR',
        'application/x-tar': 'TAR',
        'application/x-7z-compressed': '7z',
        'application/x-compressed-tar': 'archive',
        'application/x-archive': 'archive',
        'application/x-jar': 'JAR',
        'application/vnd.sun.xml.writer.template': 'STW',
        'text/plain': 'TextPlain',
        'text/x-php': 'PHP',
        'text/html': 'HTML',
        'text/javascript': 'JS',
        'text/css': 'CSS',
        'text/rtf': 'RTF',
        'text/rtfd': 'RTF',
        'text/x-c': 'C',
        'text/x-csrc': 'C',
        'text/x-chdr': 'CHeader',
        'text/x-c++': 'CPP',
        'text/x-c++src': 'CPP',
        'text/x-c++hdr': 'CPPHeader',
        'text/x-shellscript': 'Shell',
        'application/x-csh': 'Shell',
        'text/x-python': 'Python',
        'text/x-java': 'Java',
        'text/x-java-source': 'Java',
        'text/x-ruby': 'Ruby',
        'text/x-perl': 'Perl',
        'text/x-sql': 'SQL',
        'text/xml': 'XML',
        'text/x-comma-separated-values': 'CSV',
        'image/x-ms-bmp': 'BMP',
        'image/jpeg': 'JPEG',
        'image/gif': 'GIF',
        'image/png': 'PNG',
        'image/tiff': 'TIFF',
        'image/x-targa': 'TGA',
        'image/vnd.adobe.photoshop': 'PSD',
        'image/xbm': 'XBITMAP',
        'image/pxm': 'PXM',
        'image/x-icn': 'ICON',
        'image/x-icon': 'ICON',
        'image/x-cr2': 'CR2',
        'image/bmp': 'BMP',
        'image/x-pic': 'PIC',
        'image/x-cdr': 'CDR',
        'audio/mpeg': 'AudioMPEG',
        'audio/midi': 'AudioMIDI',
        'audio/ogg': 'AudioOGG',
        'audio/mp4': 'AudioMPEG4',
        'audio/x-m4a': 'AudioMPEG4',
        'audio/wav': 'AudioWAV',
        'audio/x-wave': 'WAVE',
        'audio/x-m4r': 'M4R',
        'audio/x-aac': 'AAC',
        'audio/x-wma': 'WMA',
        'audio/x-mp2': 'MP2',
        'audio/x-dls': 'DLS',
        'audio/x-m4b': 'M4B',
        'audio/x-wav': 'WAV',
        'audio/x-mp1': 'MP1',
        'audio/x-mp3-playlist': 'AudioPlaylist',
        'video/x-dv': 'VideoDV',
        'video/mp4': 'VideoMPEG4',
        'video/mpeg': 'VideoMPEG',
        'video/x-msvideo': 'VideoAVI',
        'video/quicktime': 'VideoMOV',
        'video/x-ms-wmv': 'VideoWM',
        'video/x-flv': 'VideoFlash',
        'video/x-matroska': 'VideoMKV',
        'video/ogg': 'VideoOGG',
        'video/3gpp': '3GP',
        'video/x-mp4': 'MP4',
        'video/x-ms-asf': 'ASF',
        'video/x-amv': 'AMV',
        'video/x-aaf': 'AAF',
        'video/x-mpeg4': 'MPEG4',
        'video/x-xvid': 'XVID',
        'application/pgp-signature': 'Sign',
        'application/crypt': 'Crypt',
        'application/signcrypt': 'SignCrypt',
        'application/x-x509-ca-cert': 'Cert'
    },

    /**
	 * Ajax request data validation rules
	 * 
	 * @type  Object
	 */
    rules: {
        defaults: function(data) {
            if (!data
                || (data.added && !$.isArray(data.added))
                || (data.removed && !$.isArray(data.removed))
                || (data.changed && !$.isArray(data.changed))) {
                return false;
            }
            return true;
        },
        open: function(data) { return data && data.cwd && data.files && $.isPlainObject(data.cwd) && $.isArray(data.files); },
        tree: function(data) { return data && data.tree && $.isArray(data.tree); },
        parents: function(data) { return data && data.tree && $.isArray(data.tree); },
        tmb: function(data) { return data && data.images && ($.isPlainObject(data.images) || $.isArray(data.images)); },
        upload: function(data) { return data && ($.isPlainObject(data.added) || $.isArray(data.added)); },
        search: function(data) { return data && data.files && $.isArray(data.files); }
    },


/**
	 * Commands costructors
	 *
	 * @type Object
	 */
    commands: {},

    parseUploadData: function(text) {
        var data;

        if (!$.trim(text)) {
            return { error: ['errResponse', 'errDataEmpty'] };
        }

        try {
            data = $.parseJSON(text);
        } catch (e) {
            return { error: ['errResponse', 'errDataNotJSON'] };
        }

        if (!this.validResponse('upload', data)) {
            return { error: ['errResponse'] };
        }
        data = this.normalize(data);
        data.removed = $.map(data.added || [], function(f) { return f.hash; });
        return data;

    },

    iframeCnt: 0,

    uploads: {
        // upload transport using iframe
        iframe: function(data, fm) {
            var self = fm ? fm : this,
                input = data.input,
                dfrd = $.Deferred()
                    .fail(function(error) {
                        error && self.error(error);
                    })
                    .done(function(data) {
                        data.warning && self.error(data.warning);
                        data.removed && self.remove(data);
                        data.added && self.add(data);
                        data.changed && self.change(data);
                        self.trigger('upload', data);
                        data.sync && self.sync();
                    }),
                name = 'iframe-' + self.namespace + (++self.iframeCnt),
                form = $('<form action="' + self.uploadURL + '" method="post" enctype="multipart/form-data" encoding="multipart/form-data" target="' + name + '" style="display:none"><input type="hidden" name="cmd" value="upload" /></form>'),
                msie = this.UA.IE,
                // clear timeouts, close notification dialog, remove form/iframe
                onload = function() {
                    abortto && clearTimeout(abortto);
                    notifyto && clearTimeout(notifyto);
                    notify && self.notify({ type: 'upload', cnt: -cnt });

                    setTimeout(function() {
                        msie && $('<iframe src="javascript:false;"/>').appendTo(form);
                        form.remove();
                        iframe.remove();
                    }, 100);
                },
                iframe = $('<iframe src="' + (msie ? 'javascript:false;' : 'about:blank') + '" name="' + name + '" style="position:absolute;left:-1000px;top:-1000px" />')
                    .bind('load', function() {
                        iframe.unbind('load')
                            .bind('load', function() {
                                var data = self.parseUploadData(iframe.contents().text());

                                onload();
                                data.error ? dfrd.reject(data.error) : dfrd.resolve(data);
                            });

                        // notify dialog
                        notifyto = setTimeout(function() {
                            notify = true;
                            self.notify({ type: 'upload', cnt: cnt });
                        }, self.options.notifyDelay);

                        // emulate abort on timeout
                        if (self.options.iframeTimeout > 0) {
                            abortto = setTimeout(function() {
                                onload();
                                dfrd.reject([errors.connect, errors.timeout]);
                            }, self.options.iframeTimeout);
                        }

                        form.submit();
                    }),
                cnt,
                notify,
                notifyto,
                abortto;

            if (input && $(input).is(':file') && $(input).val()) {
                form.append(input);
            } else {
                return dfrd.reject();
            }

            cnt = input.files ? input.files.length : 1;

            form.append('<input type="hidden" name="' + (self.newAPI ? 'target' : 'current') + '" value="' + self.cwd().hash + '"/>')
                .append('<input type="hidden" name="html" value="1"/>')
                .append($(input).attr('name', 'upload[]'));

            $.each(self.options.onlyMimes || [], function(i, mime) {
                form.append('<input type="hidden" name="mimes[]" value="' + mime + '"/>');
            });

            $.each(self.options.customData, function(key, val) {
                form.append('<input type="hidden" name="' + key + '" value="' + val + '"/>');
            });

            form.appendTo('body');
            iframe.appendTo('body');

            return dfrd;
        },
        // upload transport using XMLHttpRequest
        //	xhr : function(data, fm,notUploadFilesIndex) { 
        //		var self   = fm ? fm : this,
        //			dfrd   = $.Deferred()
        //				.fail(function(error) {
        //					error && self.error(error);
        //				})
        //				.done(function(data) {
        //					data.warning && self.error(data.warning);
        //					data.removed && self.remove(data);
        //					data.added   && self.add(data);
        //					data.changed && self.change(data);
        // 					self.trigger('upload', data);
        //					data.sync && self.sync();
        //				})
        //				.always(function() {
        //					notifyto && clearTimeout(notifyto);
        //					notify && self.notify({type : 'upload', cnt : -cnt, progress : 100*cnt});
        //				}),
        //			xhr         = new XMLHttpRequest(),
        //			formData    = new FormData(),
        //			files       = data.input ? data.input.files : data.files, 
        //			cnt         = files.length,
        //			loaded      = 5,
        //			notify      = false,
        //			startNotify = function() {
        //				return setTimeout(function() {
        //					notify = true;
        //					self.notify({type : 'upload', cnt : cnt, progress : loaded*cnt});
        //				}, self.options.notifyDelay);
        //			},
        //			notifyto;

        //		if (!cnt) {
        //			return dfrd.reject();
        //		}

        //		xhr.addEventListener('error', function() {
        //			dfrd.reject('errConnect');
        //		}, false);

        //		xhr.addEventListener('abort', function() {
        //			dfrd.reject(['errConnect', 'errAbort']);
        //		}, false);

        //		xhr.addEventListener('load', function() {
        //			var status = xhr.status, data;

        //			if (status > 500) {
        //				return dfrd.reject('errResponse');
        //			}
        //			if (status != 200) {
        //				return dfrd.reject('errConnect');
        //			}
        //			if (xhr.readyState != 4) {
        //				return dfrd.reject(['errConnect', 'errTimeout']); // am i right?
        //			}
        //			if (!xhr.responseText) {
        //				return dfrd.reject(['errResponse', 'errDataEmpty']);
        //			}

        //			data = self.parseUploadData(xhr.responseText);
        //			if (data.redurl) {
        //			    if (self.isModal) {
        //			        if (parent.Master && parent.Master.goUrl) {
        //			            parent.Master.goUrl(data.redurl);
        //			        }
        //			    } else {
        //			        window.location.href = data.redurl;
        //			    }
        //			    dfrd.reject();
        //			}else data.error ? dfrd.reject(data.error) : dfrd.resolve(data);
        //		}, false);

        //		xhr.upload.addEventListener('progress', function(e) {
        //			var prev = loaded, curr;

        //			if (e.lengthComputable) {

        //				curr = parseInt(e.loaded*100 / e.total);

        //				// to avoid strange bug in safari (not in chrome) with drag&drop.
        //				// bug: macos finder opened in any folder,
        //				// reset safari cache (option+command+e), reload elfinder page,
        //				// drop file from finder
        //				// on first attempt request starts (progress callback called ones) but never ends.
        //				// any next drop - successfull.
        //				if (curr > 0 && !notifyto) {
        //					notifyto = startNotify();
        //				}

        //				if (curr - prev > 4) {
        //					loaded = curr;
        //					notify && self.notify({type : 'upload', cnt : 0, progress : (loaded - prev)*cnt});
        //				}
        //			}
        //		}, false);


        //		xhr.open('POST', self.uploadURL, true);
        //		formData.append('cmd', 'upload');
        //		//formData.append('notUploadFilesIndex', notUploadFilesIndex);
        //		formData.append(self.newAPI ? 'target' : 'current', self.cwd().hash);
        //		$.each(self.options.customData, function(key, val) {
        //			formData.append(key, val);
        //		});
        //		$.each(self.options.onlyMimes, function(i, mime) {
        //			formData.append('mimes['+i+']', mime);
        //		});

        //		$.each(files, function(i, file) {
        //			formData.append('upload[]', file);
        //		});

        //		xhr.onreadystatechange = function() {
        //			if (xhr.readyState == 4 && xhr.status == 0) {
        //				// ff bug while send zero sized file
        //				// for safari - send directory
        //				dfrd.reject(['errConnect', 'errAbort']);
        //			}
        //		}

        //		xhr.send(formData);

        //		if (!this.UA.Safari || !data.files) {
        //			notifyto = startNotify();
        //		}

        //		return dfrd;
        //	}
        //},
        xhr: function(data, fm, notUploadFilesIndex, dublicateIndexes) {
            var self = fm ? fm : this,
                files = data.input ? data.input.files : data.files,
                cnt = files.length,
                notify = false,
                addWithNewIndex = false,
                startNotify = function() {
                    return setTimeout(function() {
                        notify = true;
                        self.notify({ type: 'upload', cnt: 1 });
                    }, self.options.notifyDelay);
                },
                notifyto;

            if (!cnt) {
                return dfrd.reject();
            }

            for (var i = 0; i < cnt; i++) {
                var dfrd = $.Deferred()
                    .fail(function(error) {
                        error && self.error(error);
                    })
                    .done(function(data) {
                        data.warning && self.error(data.warning);
                        data.removed && self.remove(data);
                        data.added && self.add(data);
                        data.changed && self.change(data);
                        self.trigger('upload', data);
                        data.sync && self.sync();
                    })
                    .always(function() {
                        notifyto && clearTimeout(notifyto);
                        notify && self.notify({ type: 'upload', cnt: -1 });
                    });
                if (dublicateIndexes && $.inArray(i, dublicateIndexes) != -1)
                    addWithNewIndex = true;
                else
                    addWithNewIndex = false;
                if (notUploadFilesIndex && notUploadFilesIndex.length > 0) {
                    if ($.inArray(i.toString(), notUploadFilesIndex) == -1) {
                        this.loadstart(files[i], fm, dfrd, addWithNewIndex);
                        if (!this.UA.Safari || !data.files) {
                            notifyto = startNotify();
                        }
                    }
                } else {
                    this.loadstart(files[i], fm, dfrd, addWithNewIndex);
                    if (!this.UA.Safari || !data.files) {
                        notifyto = startNotify();
                    }
                }
            }
        }
    },

    loadstart: function(file, fm, dfrd, addWithNewIndex) {
        var self = fm ? fm : this,
            xhr = new XMLHttpRequest(),
            formData = new FormData();

        xhr.addEventListener('error', function() {
            dfrd.reject('errConnect');
        }, false);

        xhr.addEventListener('abort', function() {
            dfrd.reject(['errConnect', 'errAbort']);
        }, false);

        xhr.addEventListener('load', function() {
            var status = xhr.status, data;

            if (status > 500) {
                return dfrd.reject('errResponse');
            }
            if (status != 200) {
                return dfrd.reject('errConnect');
            }
            if (xhr.readyState != 4) {
                return dfrd.reject(['errConnect', 'errTimeout']); // am i right?
            }
            if (!xhr.responseText) {
                return dfrd.reject(['errResponse', 'errDataEmpty']);
            }

            data = self.parseUploadData(xhr.responseText);
            if (data.redurl) {
                if (self.isModal) {
                    if (parent.Master && parent.Master.goUrl) {
                        parent.Master.goUrl(data.redurl);
                    }
                } else {
                    window.location.href = data.redurl;
                }
                dfrd.reject();
            } else data.error ? dfrd.reject(data.error) : dfrd.resolve(data);
        }, false);

        xhr.open('POST', self.uploadURL, true);
        formData.append('cmd', 'upload');

        formData.append(self.newAPI ? 'target' : 'current', self.cwd().hash);
        $.each(self.options.customData, function(key, val) {
            formData.append(key, val);
        });
        $.each(self.options.onlyMimes, function(i, mime) {
            formData.append('mimes[' + i + ']', mime);
        });
        formData.append('addWithNewIndex', addWithNewIndex ? addWithNewIndex : false);
        formData.append('upload[]', file);

        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4 && xhr.status == 0) {
                // ff bug while send zero sized file
                // for safari - send directory
                dfrd.reject(['errConnect', 'errAbort']);
            }
        };

        xhr.send(formData);
    },

    /**
	 * Bind callback to event(s) The callback is executed at most once per event.
	 * To bind to multiply events at once, separate events names by space
	 *
	 * @param  String    event name
	 * @param  Function  callback
	 * @return elFinder
	 */
    one: function(event, callback) {
        var self = this,
            h = $.proxy(callback, function(event) {
                setTimeout(function() { self.unbind(event.type, h); }, 3);
                return callback.apply(this, arguments);
            });
        return this.bind(event, h);
    },

    /**
	 * Set/get data into/from localStorage
	 *
	 * @param  String       key
	 * @param  String|void  value
	 * @return String
	 */
    localStorage: function(key, val) {
        var s = window.localStorage;

        key = 'elfinder-' + key + this.id;

        if (val === null) {
            console.log('remove', key);
            return s.removeItem(key);
        }

        if (val !== void (0)) {
            try {
                s.setItem(key, val);
            } catch (e) {
                s.clear();
                s.setItem(key, val);
            }
        }

        return s.getItem(key);
    },

    /**
	 * Get/set cookie
	 *
	 * @param  String       cookie name
	 * @param  String|void  cookie value
	 * @return String
	 */
    cookie: function(name, value) {
        var d, o, c, i;

        name = 'elfinder-' + name + this.id;

        if (value === void (0)) {
            if (document.cookie && document.cookie != '') {
                c = document.cookie.split(';');
                name += '=';
                for (i = 0; i < c.length; i++) {
                    c[i] = $.trim(c[i]);
                    if (c[i].substring(0, name.length) == name) {
                        return decodeURIComponent(c[i].substring(name.length));
                    }
                }
            }
            return '';
        }

        o = $.extend({}, this.options.cookie);
        if (value === null) {
            value = '';
            o.expires = -1;
        }
        if (typeof (o.expires) == 'number') {
            d = new Date();
            d.setTime(d.getTime() + (o.expires * 86400000));
            o.expires = d;
        }
        document.cookie = name + '=' + encodeURIComponent(value) + '; expires=' + o.expires.toUTCString() + (o.path ? '; path=' + o.path : '') + (o.domain ? '; domain=' + o.domain : '') + (o.secure ? '; secure' : '');
        return value;
    },

    /**
	 * Get start directory (by location.hash or last opened directory)
	 * 
	 * @return String
	 */
    startDir: function() {
        var locHash = window.location.hash;
        if (locHash && locHash.match(/^#elf_/)) {
            return locHash.replace(/^#elf_/, '');
        } else {
            return this.lastDir();
        }
    },

    GetReceivedMailId: function() {
        var href = window.location.href;
        var m = href.match('fileGroupSendId=([A-Fa-f0-9-]*)');
        if (m && m.length > 0) {
            return m[1];
        } else return undefined;
    },
    GetModalStatus: function() {
        var href = window.location.href;
        var m = href.match('ismodal');
        if (m && m.length > 0) {
            return 1;
        } else return 0;
    },

    /**
	 * Get/set last opened directory
	 * 
	 * @param  String|undefined  dir hash
	 * @return String
	 */
    lastDir: function(hash) {
        return this.options.rememberLastDir ? this.storage('lastdir', hash) : '';
    },

    /**
	 * Node for escape html entities in texts
	 * 
	 * @type jQuery
	 */
    _node: $('<span/>'),

    /**
	 * Replace not html-safe symbols to html entities
	 * 
	 * @param  String  text to escape
	 * @return String
	 */
    escape: function(name) {
        return this._node.text(name).html();
    },

    /**
	 * Cleanup ajax data.
	 * For old api convert data into new api format
	 * 
	 * @param  String  command name
	 * @param  Object  data from backend
	 * @return Object
	 */
    normalize: function(data) {
        var filter = function(file) {

            if (file && file.hash && file.name && file.mime) {
                if (file.mime == 'application/x-empty') {
                    file.mime = 'text/plain';
                }
                return file;
            }
            return null;
            return file && file.hash && file.name && file.mime ? file : null;
        };


        if (data.files) {
            data.files = $.map(data.files, filter);
        }
        if (data.tree) {
            data.tree = $.map(data.tree, filter);
        }
        if (data.added) {
            data.added = $.map(data.added, filter);
        }
        if (data.changed) {
            data.changed = $.map(data.changed, filter);
        }
        if (data.api) {
            data.init = true;
        }
        return data;
    },

    /**
	 * Update sort options
	 *
	 * @param {String} sort type
	 * @param {String} sort order
	 * @param {Boolean} show folder first
	 */
    setSort: function(type, order, stickFolders) {
        this.storage('sortType', (this.sortType = this.sortRules[type] ? type : 'name'));
        this.storage('sortOrder', (this.sortOrder = /asc|desc/.test(order) ? order : 'asc'));
        this.storage('sortStickFolders', (this.sortStickFolders = !!stickFolders) ? 1 : '');
        this.trigger('sortchange');
    },

    _sortRules: {
        name: function(file1, file2) { return file1.name.toLowerCase().localeCompare(file2.name.toLowerCase()); },
        size: function(file1, file2) {
            var size1 = parseInt(file1.size) || 0,
                size2 = parseInt(file2.size) || 0;

            return size1 == size2 ? 0 : size1 > size2 ? 1 : -1;
            return (parseInt(file1.size) || 0) > (parseInt(file2.size) || 0) ? 1 : -1;
        },
        kind: function(file1, file2) { return file1.mime.localeCompare(file2.mime); },
        date: function(file1, file2) {
            var date1 = file1.ts || file1.date,
                date2 = file2.ts || file2.date;

            return date1 == date2 ? 0 : date1 > date2 ? 1 : -1;
        }
    },

    /**
	 * Compare files based on elFinder.sort
	 *
	 * @param  Object  file
	 * @param  Object  file
	 * @return Number
	 */
    compare: function(file1, file2) {
        var self = this,
            type = self.sortType,
            asc = self.sortOrder == 'asc',
            stick = self.sortStickFolders,
            rules = self.sortRules,
            sort = rules[type],
            d1 = file1.mime == 'directory',
            d2 = file2.mime == 'directory',
            res;

        if (stick) {
            if (d1 && !d2) {
                return -1;
            } else if (!d1 && d2) {
                return 1;
            }
        }

        res = asc ? sort(file1, file2) : sort(file2, file1);

        return type != 'name' && res == 0
            ? res = asc ? rules.name(file1, file2) : rules.name(file2, file1)
            : res;
    },

    /**
	 * Sort files based on config
	 *
	 * @param  Array  files
	 * @return Array
	 */
    sortFiles: function(files) {
        return files.sort(this.compare);
    },

    /**
	 * Open notification dialog 
	 * and append/update message for required notification type.
	 *
	 * @param  Object  options
	 * @example  
	 * this.notify({
	 *    type : 'copy',
	 *    msg : 'Copy files', // not required for known types @see this.notifyType
	 *    cnt : 3,
	 *    hideCnt : false, // true for not show count
	 *    progress : 10 // progress bar percents (use cnt : 0 to update progress bar)
	 * })
	 * @return elFinder
	 */
    notify: function(opts) {

        var type = opts.type,
            msg = this.messages['ntf' + type] ? this.i18n('ntf' + type) : this.i18n('ntfsmth'),
            ndialog = this.ui.notify,
            notify = ndialog.children('.elfinder-notify-' + type),
            ntpl = '<div class="elfinder-notify elfinder-notify-{type}"><span class="elfinder-dialog-icon elfinder-dialog-icon-{type}"/> <div class="elfinder-notify-progressbar"><div class="elfinder-notify-progress"/></div><span class="elfinder-notify-msg">{msg}</span> <span class="elfinder-notify-cnt"/></div>',
            delta = opts.cnt,
            progress = opts.progress >= 0 && opts.progress <= 100 ? opts.progress : 0,
            cnt,
            total,
            prc;

        if (!type || type == 'add') {
            return this;
        }


        if (!notify.length) {
            notify = $(ntpl.replace(/\{type\}/g, type).replace(/\{msg\}/g, msg))
                .appendTo(ndialog)
                .data('cnt', 0);

            if (progress) {
                notify.data({ progress: 0, total: 0 });
            }
        }

        cnt = delta + parseInt(notify.data('cnt'));

        if (cnt > 0) {
            !opts.hideCnt && notify.children('.elfinder-notify-cnt').text('(' + cnt + ')');
            ndialog.is(':hidden') && ndialog.elfindercryptxdialog('open'); // ndialog.elfinderdialog('open');
            notify.data('cnt', cnt);

            if (progress < 100
                && (total = notify.data('total')) >= 0
                && (prc = notify.data('progress')) >= 0) {

                total = delta + parseInt(notify.data('total'));
                prc = progress + prc;
                progress = parseInt(prc / total);
                notify.data({ progress: prc, total: total });

                ndialog.find('.elfinder-notify-progress')
                    .animate({
                        width: (progress < 100 ? progress : 100) + '%'
                    }, 20);
            }

        } else {
            notify.remove();
            !ndialog.children().length && ndialog.elfindercryptxdialog('close'); //ndialog.elfinderdialog('close');
        }

        return this;
    },

    /**
	 * Open confirmation dialog 
	 *
	 * @param  Object  options
	 * @example  
	 * this.confirm({
	 *    title : 'Remove files',
	 *    text  : 'Here is question text',
	 *    accept : {  // accept callback - required
	 *      label : 'Continue',
	 *      callback : function(applyToAll) { fm.log('Ok') }
	 *    },
	 *    cancel : { // cancel callback - required
	 *      label : 'Cancel',
	 *      callback : function() { fm.log('Cancel')}
	 *    },
	 *    reject : { // reject callback - optionally
	 *      label : 'No',
	 *      callback : function(applyToAll) { fm.log('No')}
	 *   },
	 *   all : true  // display checkbox "Apply to all"
	 * })
	 * @return elFinder
	 */
    confirm: function(opts) {
        var complete = false,
            options = {
                cssClass: 'elfinder-dialog-confirm',
                modal: true,
                resizable: false,
                title: this.i18n(opts.title || 'confirmReq'),
                buttons: {},
                close: function() {
                    !complete && opts.cancel.callback();
                    //$(this).elfinderdialog('destroy');
                    $(this).elfindercryptxdialog('destroy');
                }
            },
            apply = this.i18n('apllyAll'),
            label,
            checkbox;


        if (opts.reject) {
            options.buttons[this.i18n(opts.reject.label)] = function() {
                var chb = $(this).find('input[type=checkbox]');
                var all = false;
                if (chb && chb.prop('checked')) all = true;
                opts.reject.callback(!!(all));
                complete = true;
                //$(this).elfinderdialog('close');
                $(this).elfindercryptxdialog('close');
            };
        }

        options.buttons[this.i18n(opts.accept.label)] = function() {
            var chb = $(this).find('input[type=checkbox]');
            var all = false;
            if (chb && chb.prop('checked')) all = true;
            opts.accept.callback(!!(all));
            complete = true;
            //$(this).elfinderdialog('close')
            $(this).elfindercryptxdialog('close');
        };

        options.buttons[this.i18n(opts.cancel.label)] = function() {
            //$(this).elfinderdialog('close')
            $(this).elfindercryptxdialog('close');
        };

        if (opts.all) {
            if (opts.reject) {
                options.width = 370;
            }
            options.create = function() {
                //checkbox = $('<input type="checkbox" />');
                //$(this).next().children().before($('<label>'+apply+'</label>').prepend(checkbox));
                var checkboxforblock = $('<span class="button-checkbox bootstrap-checkbox">' +
                    '<input type="checkbox" autocomplete="off" style="display: none;">' +
                    '<span class="icon cb-icon-check square" style="display: none;"></span>' +
                    '<span class="icon cb-icon-check-empty square"></span>' +
                    '</span>').bind('hover', function() { $(this).toggleClass('ui-state-hover'); });;

                checkboxforblock.find('input[type=checkbox]')
                    .bind('change', function() {
                        var pr = $(this).parent();
                        var chbox = $(this);
                        if (chbox.is(':checked')) {
                            pr.find('.cb-icon-check').hide();
                            pr.find('.cb-icon-check-empty').show();
                            chbox.prop("checked", false);
                        } else {
                            pr.find('.cb-icon-check').show();
                            pr.find('.cb-icon-check-empty').hide();
                            chbox.prop("checked", true);
                        }
                    });
                var div = $('<div style="cursor:pointer; margin: -13px 0 15px 75px">' + apply + '</div>').click(function() {
                    var chb = $(this).find('input[type=checkbox]');
                    chb.change();
                }).prepend(checkboxforblock);

                $(this).after($('<div/>').append(div));
            }; //options.open = function() {
            //	var pane = $(this).next(),
            //		width = parseInt(pane.children(':first').outerWidth() + pane.children(':last').outerWidth());

            //	if (width > parseInt(pane.width())) {
            //		$(this).closest('.elfinder-dialog').width(width+30);
            //	}
            //}
        }

        //return this.dialog('<span class="elfinder-dialog-icon elfinder-dialog-icon-confirm"/>' + this.i18n(opts.text), options);
        return this.dialog('<div class="warning"><span>' + this.i18n(opts.text) + '</span></div></div>', options);
    },

    /**
	 * Create unique file name in required dir
	 * 
	 * @param  String  file name
	 * @param  String  parent dir hash
	 * @return String
	 */
    uniqueName: function(prefix, phash) {
        var i = 0, ext = '', p, name;

        prefix = this.i18n(prefix);
        phash = phash || this.cwd().hash;

        if ((p = prefix.indexOf('.txt')) != -1) {
            ext = '.txt';
            prefix = prefix.substr(0, p);
        }

        name = prefix + ext;

        if (!this.fileByName(name, phash)) {
            return name;
        }
        while (i < 10000) {
            name = prefix + ' ' + (++i) + ext;
            if (!this.fileByName(name, phash)) {
                return name;
            }
        }
        return prefix + Math.random() + ext;
    },

    /**
	 * Return message translated onto current language
	 *
	 * @param  String|Array  message[s]
	 * @return String
	 **/
    i18n: function() {
        var self = this,
            messages = this.messages,
            input = [],
            ignore = [],
            message = function(m) {
                var file;
                if (m.indexOf('#') === 0) {
                    if ((file = self.file(m.substr(1)))) {
                        return file.name;
                    }
                }
                return m;
            },
            i,
            j,
            m;

        for (i = 0; i < arguments.length; i++) {
            m = arguments[i];

            if (typeof m == 'string') {
                input.push(message(m));
            } else if ($.isArray(m)) {
                for (j = 0; j < m.length; j++) {
                    if (typeof m[j] == 'string') {
                        input.push(message(m[j]));
                    }
                }
            }
        }

        for (i = 0; i < input.length; i++) {
            // dont translate placeholders
            if ($.inArray(i, ignore) !== -1) {
                continue;
            }
            m = input[i];
            // translate message
            m = messages[m] || m;
            // replace placeholders in message
            m = m.replace(/\$(\d+)/g, function(match, placeholder) {
                placeholder = i + parseInt(placeholder);
                if (placeholder > 0 && input[placeholder]) {
                    ignore.push(placeholder);
                }
                return input[placeholder] || '';
            });

            input[i] = m;
        }

        return $.map(input, function(m, i) { return $.inArray(i, ignore) === -1 ? m : null; }).join('<br>');
    },

    /**
	 * Convert mimetype into css classes
	 * 
	 * @param  String  file mimetype
	 * @return String
	 */
    mime2class: function(mime) {
        var prefix = 'elfinder-cwd-icon-';

        mime = mime.split('/');

        return prefix + mime[0] + (mime[0] != 'image' && mime[1] ? ' ' + prefix + mime[1].replace(/(\.|\+)/g, '-') : '');
    },

    /**
	 * Return localized kind of file
	 * 
	 * @param  Object|String  file or file mimetype
	 * @return String
	 */
    mime2kind: function(f) {
        var mime = typeof (f) == 'object' ? f.mime : f, kind;

        if (f.alias) {
            kind = 'Alias';
        } else if (this.kinds[mime]) {
            kind = this.kinds[mime];
        } else {
            if (mime.indexOf('text') === 0) {
                kind = 'Text';
            } else if (mime.indexOf('image') === 0) {
                kind = 'Image';
            } else if (mime.indexOf('audio') === 0) {
                kind = 'Audio';
            } else if (mime.indexOf('video') === 0) {
                kind = 'Video';
            } else if (mime.indexOf('application') === 0) {
                kind = 'App';
            } else {
                kind = mime;
            }
        }

        return this.messages['kind' + kind] ? this.i18n('kind' + kind) : mime;
    },

    /**
	 * Return localized date
	 * 
	 * @param  Object  file object
	 * @return String
	 */
    formatDate: function(file, ts) {
        var self = this,
            ts = ts || file.ts,
            i18 = self.i18,
            date,
            format,
            output,
            d,
            dw,
            m,
            y,
            h,
            g,
            i,
            s;

        if (self.options.clientFormatDate && ts > 0) {

            date = new Date(ts * 1000);

            h = date[self.getHours]();
            g = h > 12 ? h - 12 : h;
            i = date[self.getMinutes]();
            s = date[self.getSeconds]();
            d = date[self.getDate]();
            dw = date[self.getDay]();
            m = date[self.getMonth]() + 1;
            y = date[self.getFullYear]();

            //format = ts >= this.yesterday 
            //	? this.fancyFormat 
            //	: this.dateFormat;
            format = this.dateFormat;

            output = format.replace(/[a-z]/gi, function(val) {
                switch (val) {
                case 'd':
                    return d > 9 ? d : '0' + d;
                case 'j':
                    return d;
                case 'D':
                    return self.i18n(i18.daysShort[dw]);
                case 'l':
                    return self.i18n(i18.days[dw]);
                case 'm':
                    return m > 9 ? m : '0' + m;
                case 'n':
                    return m;
                case 'M':
                    return self.i18n(i18.monthsShort[m - 1]);
                case 'F':
                    return self.i18n(i18.months[m - 1]);
                case 'Y':
                    return y;
                case 'y':
                    return ('' + y).substr(2);
                case 'H':
                    return h > 9 ? h : '0' + h;
                case 'G':
                    return h;
                case 'g':
                    return g;
                case 'h':
                    return g > 9 ? g : '0' + g;
                case 'a':
                    return h > 12 ? 'pm' : 'am';
                case 'A':
                    return h > 12 ? 'PM' : 'AM';
                case 'i':
                    return i > 9 ? i : '0' + i;
                case 's':
                    return s > 9 ? s : '0' + s;
                }
                return val;
            });

            //return ts >= this.yesterday
            //	? output.replace('$1', this.i18n(ts >= this.today ? 'Today' : 'Yesterday'))
            //	: output;
            return output;

        } else if (file.date) {
            return file.date.replace(/([a-z]+)\s/i, function(a1, a2) { return self.i18n(a2) + ' '; });
        }

        return self.i18n('dateUnknown');
    },

    /**
	 * Return css class marks file permissions
	 * 
	 * @param  Object  file 
	 * @return String
	 */
    perms2class: function(o) {
        var c = '';

        if (!o.read && !o.write) {
            c = 'elfinder-na';
        } else if (!o.read) {
            c = 'elfinder-wo';
        } else if (!o.write) {
            c = 'elfinder-ro';
        }
        return c;
    },

    /**
	 * Return localized string with file permissions
	 * 
	 * @param  Object  file
	 * @return String
	 */
    formatPermissions: function(f) {
        var p = [];

        f.read && p.push(this.i18n('read'));
        f.write && p.push(this.i18n('write'));

        return p.length ? p.join(' ' + this.i18n('and') + ' ') : this.i18n('noaccess');
    },

    /**
	 * Return formated file size
	 * 
	 * @param  Number  file size
	 * @return String
	 */
    formatSize: function(s) {
        var n = 1, u = 'byte';

        if (s == 'unknown') {
            return this.i18n('unknown');
        }

        if (s > 1073741824) {
            n = 1073741824;
            u = 'GB';
        } else if (s > 1048576) {
            n = 1048576;
            u = 'MB';
        } else if (s > 1024) {
            n = 1024;
            u = 'KB';
        }
        s = s / n;
        return (s > 0 ? n >= 1048576 ? s.toFixed(2) : Math.round(s) : 0) + ' ' + u;
    },


    navHash2Id: function(hash) {
        return 'nav-' + hash;
    },

    navId2Hash: function(id) {
        return typeof (id) == 'string' ? id.substr(4) : false;
    },

    log: function(m) {
        window.console && window.console.log && window.console.log(m);
        return this;
    },

    debug: function(type, m) {
        var d = this.options.debug;

        if (d == 'all' || d === true || ($.isArray(d) && $.inArray(type, d) != -1)) {
            window.console && window.console.log && window.console.log('elfinder debug: [' + type + '] [' + this.id + ']', m);
        }
        return this;
    },
    time: function(l) { window.console && window.console.time && window.console.time(l); },
    timeEnd: function(l) { window.console && window.console.timeEnd && window.console.timeEnd(l); }


};
/**
 * Application version
 *
 * @type String
 **/
elFinder.prototype.version = '2.0.2';
$.fn.elfinder = function(o) {

    if (o == 'instance') {
        return this.getElFinder();
    }

    return this.each(function() {

        var cmd = typeof(o) == 'string' ? o : '';
        if (!this.elfinder) {
            new elFinder(this, typeof(o) == 'object' ? o : {});
        }

        switch (cmd) {
        case 'close':
        case 'hide':
            this.elfinder.hide();
            break;

        case 'open':
        case 'show':
            this.elfinder.show();
            break;

        case'destroy':
            this.elfinder.destroy();
            break;
        }

    });
};
$.fn.getElFinder = function() {
    var instance;

    this.each(function() {
        if (this.elfinder) {
            instance = this.elfinder;
            return false;
        }
    });

    return instance;
};
"use strict"; /**
 * elFinder resources registry.
 * Store shared data
 *
 * @type Object
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.resources = {
    'class': {
        hover: 'ui-state-hover',
        active: 'ui-state-active',
        disabled: 'ui-state-disabled',
        draggable: 'ui-draggable',
        droppable: 'ui-droppable',
        adroppable: 'elfinder-droppable-active',
        cwdfile: 'elfinder-cwd-file',
        cwd: 'elfinder-cwd',
        tree: 'elfinder-tree',
        treeroot: 'elfinder-navbar-root',
        navdir: 'elfinder-navbar-dir',
        navdirwrap: 'elfinder-navbar-dir-wrapper',
        navarrow: 'elfinder-navbar-arrow',
        navsubtree: 'elfinder-navbar-subtree',
        navcollapse: 'elfinder-navbar-collapsed',
        navexpand: 'elfinder-navbar-expanded',
        treedir: 'elfinder-tree-dir',
        placedir: 'elfinder-place-dir',
        searchbtn: 'elfinder-button-search'
    },
    tpl: {
        perms: '<span class="elfinder-perms"/>',
        symlink: '<span class="elfinder-symlink"/>',
        navicon: '<span class="elfinder-nav-icon"/>',
        navspinner: '<span class="elfinder-navbar-spinner"/>',
        navdir: '<div class="elfinder-navbar-wrapper"><span id="{id}" title="{name}" class="ui-corner-all elfinder-navbar-dir {cssclass}"><span class="elfinder-navbar-arrow"/><span class="elfinder-navbar-icon"/>{symlink}{permissions}{name}</span><div class="elfinder-navbar-subtree"/></div>'

    },

    mimes: {
        text: [
            'application/x-empty',
            'application/javascript',
            'application/xhtml+xml',
            'audio/x-mp3-playlist',
            'application/x-web-config',
            'application/docbook+xml',
            'application/x-php',
            'application/x-perl',
            'application/x-awk',
            'application/x-config',
            'application/x-csh',
            'application/xml'
        ]
    },

    mixin: {
        make: function() {
            var fm = this.fm,
                cmd = this.name,
                cwd = fm.getUI('cwd'),
                dfrd = $.Deferred()
                    .fail(function(error) {
                        cwd.trigger('unselectall');
                        error && fm.error(error);
                    })
                    .always(function() {
                        input.remove();
                        node.remove();
                        fm.enable();
                    }),
                id = 'tmp_' + parseInt(Math.random() * 100000),
                phash = fm.cwd().hash,
                date = new Date(),
                file = {
                    hash: id,
                    name: fm.uniqueName(this.prefix),
                    mime: this.mime,
                    read: true,
                    write: true,
                    date: 'Today ' + date.getHours() + ':' + date.getMinutes()
                },
                node = cwd.trigger('create.' + fm.namespace, file).find('#' + id),
                input = $('<input type="text"/>')
                    .keydown(function(e) {
                        e.stopImmediatePropagation();

                        if (e.keyCode == $.ui.keyCode.ESCAPE) {
                            dfrd.reject();
                        } else if (e.keyCode == $.ui.keyCode.ENTER) {
                            input.blur();
                        }
                    })
                    .mousedown(function(e) {
                        e.stopPropagation();
                    })
                    .blur(function() {
                        var name = $.trim(input.val()),
                            parent = input.parent();

                        if (parent.length) {

                            if (!name) {
                                return dfrd.reject('errInvNameCr' + (file.mime == "directory" ? 'Dir' : ''));
                            }
                            if (name.match("[\/|\\|\:|\*|\"|\<|\>|\#|\|\$]")) {
                                return dfrd.reject('errInvSym' + (file.mime == "directory" ? 'Dir' : ''));
                            }
                            if (name.length > 100) {
                                return dfrd.reject('errInvNameSize' + (file.mime == "directory" ? 'Dir' : ''));
                            }

                            if (fm.fileByName(name, phash)) {
                                return dfrd.reject(['errExists', name]);
                            }
                            if (file.mime != "directory") {
                                var extNew = fm.getExtension(name);
                                var extOld = fm.getExtension(file.name);
                                if (!extNew) {
                                    return dfrd.reject('errInvNameCr');
                                }
                                var nameWitoutext = name.split('.')[0];
                                if (nameWitoutext == "") {
                                    return dfrd.reject('errInvNameCr');
                                }
                            }

                            parent.html(fm.escape(name));

                            fm.lockfiles({ files: [id] });

                            fm.request({
                                    data: { cmd: cmd, name: name, target: phash },
                                    notify: { type: cmd, cnt: 1 },
                                    preventFail: true,
                                    syncOnFail: true
                                })
                                .fail(function(error) {
                                    dfrd.reject(error);
                                })
                                .done(function(data) {
                                    dfrd.resolve(data);
                                });
                        }
                    });


            if (this.disabled() || !node.length) {
                return dfrd.reject();
            }

            fm.disable();
            node.find('.elfinder-cwd-filename').empty('').append(input.val(file.name));
            input.select().focus();
            input[0].setSelectionRange && input[0].setSelectionRange(0, file.name.replace(/\..+$/, '').length);

            return dfrd;


        }

    }
};
/**
 * Default elFinder config
 *
 * @type  Object
 * @autor Dmitry (dio) Levashov
 */
elFinder.prototype._options = {
    /**
	 * Connector url. Required!
	 *
	 * @type String
	 */
    url: '',

    /**
	 * Ajax request type.
	 *
	 * @type String
	 * @default "get"
	 */
    requestType: 'get',

    /**
	 * Transport to send request to backend.
	 * Required for future extensions using websockets/webdav etc.
	 * Must be an object with "send" method.
	 * transport.send must return $.Deferred() object
	 *
	 * @type Object
	 * @default null
	 * @example
	 *  transport : {
	 *    init : function(elfinderInstance) { },
	 *    send : function(options) {
	 *      var dfrd = $.Deferred();
	 *      // connect to backend ...
	 *      return dfrd;
	 *    },
	 *    upload : function(data) {
	 *      var dfrd = $.Deferred();
	 *      // upload ...
	 *      return dfrd;
	 *    }
	 *    
	 *  }
	 **/
    transport: {},

    /**
	 * URL to upload file to.
	 * If not set - connector URL will be used
	 *
	 * @type String
	 * @default  ''
	 */
    urlUpload: '',

    /**
	 * Allow to drag and drop to upload files
	 *
	 * @type Boolean|String
	 * @default  'auto'
	 */
    dragUploadAllow: 'auto',

    /**
	 * Timeout for upload using iframe
	 *
	 * @type Number
	 * @default  0 - no timeout
	 */
    iframeTimeout: 0,

    /**
	 * Data to append to all requests and to upload files
	 *
	 * @type Object
	 * @default  {}
	 */
    customData: {},

    /**
	 * Event listeners to bind on elFinder init
	 *
	 * @type Object
	 * @default  {}
	 */
    handlers: {},

    /**
	 * Interface language
	 *
	 * @type String
	 * @default "en"
	 */
    lang: 'en',

    /**
	 * Additional css class for filemanager node.
	 *
	 * @type String
	 */
    cssClass: '',

    /**
	 * Active commands list
	 * If some required commands will be missed here, elFinder will add its
	 *
	 * @type Array
	 */
    commands: [
        'open', 'reload', 'home', 'up', 'back', 'forward', 'getfile', 'quicklook',
        'download', 'rm', 'duplicate', 'rename', 'mkdir', 'mkfile', 'upload', 'copy',
        'cut', 'paste', 'edit', 'extract', 'archive', 'search', 'info', 'view', 'help', 'resize', 'sort', 'netmount'
    ],

    /**
	 * Commands options.
	 *
	 * @type Object
	 **/
    commandsOptions: {
        // "getfile" command options.
        getfile: {
            onlyURL: false,
            // allow to return multiple files info
            multiple: false,
            // allow to return filers info
            folders: false,
            // action after callback (""/"close"/"destroy")
            oncomplete: ''
        },
        // "upload" command options.
        upload: {
            ui: 'uploadbutton'
        },
        // "quicklook" command options.
        quicklook: {
            autoplay: true,
            jplayer: 'extensions/jplayer'
        },
        // "quicklook" command options.
        edit: {
            // list of allowed mimetypes to edit
            // if empty - any text files can be edited
            mimes: [],
            // edit files in wysisyg's
            editors: [
                // {
                // 	/**
                // 	 * files mimetypes allowed to edit in current wysisyg
                // 	 * @type  Array
                // 	 */
                // 	mimes : ['text/html'], 
                // 	/**
                // 	 * Called when "edit" dialog loaded.
                // 	 * Place to init wysisyg.
                // 	 * Can return wysisyg instance
                // 	 *
                // 	 * @param  DOMElement  textarea node
                // 	 * @return Object
                // 	 */
                // 	load : function(textarea) { },
                // 	/**
                // 	 * Called before "edit" dialog closed.
                // 	 * Place to destroy wysisyg instance.
                // 	 *
                // 	 * @param  DOMElement  textarea node
                // 	 * @param  Object      wysisyg instance (if was returned by "load" callback)
                // 	 * @return void
                // 	 */
                // 	close : function(textarea, instance) { },
                // 	/**
                // 	 * Called before file content send to backend.
                // 	 * Place to update textarea content if needed.
                // 	 *
                // 	 * @param  DOMElement  textarea node
                // 	 * @param  Object      wysisyg instance (if was returned by "load" callback)
                // 	 * @return void
                // 	 */
                // 	save : function(textarea, editor) {}
                // 
                // }
            ]
        },
        // "info" command options.
        info: { nullUrlDirLinkSelf: true },


        help: { view: ['about', 'shortcuts', 'help'] }
    },

    /**
	 * Callback for "getfile" commands.
	 * Required to use elFinder with WYSIWYG editors etc..
	 *
	 * @type Function
	 * @default null (command not active)
	 */
    getFileCallback: null,

    /**
	 * Default directory view. icons/list
	 *
	 * @type String
	 * @default "icons"
	 */
    defaultView: 'icons',

    /**
	 * UI plugins to load.
	 * Current dir ui and dialogs loads always.
	 * Here set not required plugins as folders tree/toolbar/statusbar etc.
	 *
	 * @type Array
	 * @default ['toolbar', 'tree', 'path', 'stat']
	 * @full ['toolbar', 'places', 'tree', 'path', 'stat']
	 */
    ui: ['toolbar', 'tree', 'path', 'stat'],

    /**
	 * Some UI plugins options.
	 * @type Object
	 */
    uiOptions: {
        // toolbar configuration
        toolbar: [
            ['back', 'forward'],
            ['netmount'],
            // ['reload'],
            // ['home', 'up'],
            ['mkdir', 'mkfile', 'upload'],
            ['open', 'download', 'getfile'],
            ['info'],
            ['quicklook'],
            ['copy', 'cut', 'paste'],
            ['rm'],
            ['duplicate', 'rename', 'edit', 'resize'],
            ['extract', 'archive'],
            ['search'],
            ['view', 'sort'],
            ['help']
        ],
        // directories tree options
        tree: {
            // expand current root on init
            openRootOnLoad: true,
            // auto load current dir parents
            syncTree: true
        },
        // navbar options
        navbar: {
            minWidth: 150,
            maxWidth: 500
        },
        cwd: {
            // display parent folder with ".." name :)
            oldSchool: false
        }
    },

    /**
	 * Display only required files by types
	 *
	 * @type Array
	 * @default []
	 * @example
	 *  onlyMimes : ["image"] - display all images
	 *  onlyMimes : ["image/png", "application/x-shockwave-flash"] - display png and flash
	 */
    onlyMimes: [],

    /**
	 * Custom files sort rules.
	 * All default rules (name/size/kind/date) set in elFinder._sortRules
	 *
	 * @type {Object}
	 * @example
	 * sortRules : {
	 *   name : function(file1, file2) { return file1.name.toLowerCase().localeCompare(file2.name.toLowerCase()); }
	 * }
	 */
    sortRules: {},

    /**
	 * Default sort type.
	 *
	 * @type {String}
	 */
    sortType: 'name',

    /**
	 * Default sort order.
	 *
	 * @type {String}
	 * @default "asc"
	 */
    sortOrder: 'asc',

    /**
	 * Display folders first?
	 *
	 * @type {Boolean}
	 * @default true
	 */
    sortStickFolders: true,

    /**
	 * If true - elFinder will formating dates itself, 
	 * otherwise - backend date will be used.
	 *
	 * @type Boolean
	 */
    clientFormatDate: true,

    /**
	 * Show UTC dates.
	 * Required set clientFormatDate to true
	 *
	 * @type Boolean
	 */
    UTCDate: false,

    /**
	 * File modification datetime format.
	 * Value from selected language data  is used by default.
	 * Set format here to overwrite it.
	 *
	 * @type String
	 * @default  ""
	 */
    dateFormat: '',

    /**
	 * File modification datetime format in form "Yesterday 12:23:01".
	 * Value from selected language data is used by default.
	 * Set format here to overwrite it.
	 * Use $1 for "Today"/"Yesterday" placeholder
	 *
	 * @type String
	 * @default  ""
	 * @example "$1 H:m:i"
	 */
    fancyDateFormat: '',

    /**
	 * elFinder width
	 *
	 * @type String|Number
	 * @default  "auto"
	 */
    width: 'auto',

    /**
	 * elFinder height
	 *
	 * @type Number
	 * @default  "auto"
	 */
    height: 400,

    /**
	 * Make elFinder resizable if jquery ui resizable available
	 *
	 * @type Boolean
	 * @default  true
	 */
    resizable: true,

    /**
	 * Timeout before open notifications dialogs
	 *
	 * @type Number
	 * @default  500 (.5 sec)
	 */
    notifyDelay: 500,

    /**
	 * Allow shortcuts
	 *
	 * @type Boolean
	 * @default  true
	 */
    allowShortcuts: true,

    /**
	 * Remeber last opened dir to open it after reload or in next session
	 *
	 * @type Boolean
	 * @default  true
	 */
    rememberLastDir: true,

    /**
	 * Use browser native history with supported browsers
	 *
	 * @type Boolean
	 * @default  true
	 */
    useBrowserHistory: true,

    /**
	 * Lazy load config.
	 * How many files display at once?
	 *
	 * @type Number
	 * @default  50
	 */
    showFiles: 30,

    /**
	 * Lazy load config.
	 * Distance in px to cwd bottom edge to start display files
	 *
	 * @type Number
	 * @default  50
	 */
    showThreshold: 50,

    /**
	 * Additional rule to valid new file name.
	 * By default not allowed empty names or '..'
	 *
	 * @type false|RegExp|function
	 * @default  false
	 * @example
	 *  disable names with spaces:
	 *  validName : /^[^\s]$/
	 */
    validName: false,

    /**
	 * Sync content interval
	 * @type Number
	 * @default  0 (do not sync)
	 */
    sync: 0,

    /**
	 * How many thumbnails create in one request
	 *
	 * @type Number
	 * @default  5
	 */
    loadTmbs: 5,

    /**
	 * Cookie option for browsersdoes not suppot localStorage
	 *
	 * @type Object
	 */
    cookie: {
        expires: 30,
        domain: '',
        path: '/',
        secure: false
    },

    /**
	 * Contextmenu config
	 *
	 * @type Object
	 */
    contextmenu: {
        // navbarfolder menu
        navbar: ['open', '|', 'copy', 'cut', 'paste', 'duplicate', '|', 'rm', '|', 'info'],
        // current directory menu
        cwd: ['reload', 'back', '|', 'upload', 'mkdir', 'mkfile', 'paste', '|', 'sort', '|', 'info'],
        // current directory file menu
        files: ['getfile', '|', 'open', 'quicklook', '|', 'download', '|', 'copy', 'cut', 'paste', 'duplicate', '|', 'rm', '|', 'edit', 'rename', 'resize', '|', 'archive', 'extract', '|', 'info']
    },

    /**
	 * Debug config
	 *
	 * @type Array|Boolean
	 */
    // debug : true
    debug: ['error', 'warning', 'event-destroy']
}
/**
 * @class elFinder.history
 * Store visited folders
 * and provide "back" and "forward" methods
 *
 * @author Dmitry (dio) Levashov
 */
elFinder.prototype.history = function(fm) {
    var self = this,
        /**
		 * Update history on "open" event?
		 *
		 * @type Boolean
		 */
        update = true,
        /**
		 * Directories hashes storage
		 *
		 * @type Array
		 */
        history = [],
        /**
		 * Current directory index in history
		 *
		 * @type Number
		 */
        current,
        /**
		 * Clear history
		 *
		 * @return void
		 */
        reset = function() {
            history = [fm.cwd().hash];
            current = 0;
            update = true;
        },
        /**
		 * Browser native history object
		 */
        nativeHistory = (fm.options.useBrowserHistory && window.history && window.history.pushState) ? window.history : null,
        /**
		 * Open prev/next folder
		 *
		 * @Boolen  open next folder?
		 * @return jQuery.Deferred
		 */
        go = function(fwd) {
            if ((fwd && self.canForward()) || (!fwd && self.canBack())) {
                update = false;
                return fm.exec('open', history[fwd ? ++current : --current]).fail(reset);
            }
            return $.Deferred().reject();
        };

    /**
	 * Return true if there is previous visited directories
	 *
	 * @return Boolen
	 */
    this.canBack = function() {
        return current > 0;
    }; /**
	 * Return true if can go forward
	 *
	 * @return Boolen
	 */
    this.canForward = function() {
        return current < history.length - 1;
    }; /**
	 * Go back
	 *
	 * @return void
	 */
    this.back = go;

    /**
	 * Go forward
	 *
	 * @return void
	 */
    this.forward = function() {
        return go(true);
    }; // bind to elfinder events
    fm.open(function(e) {
            var l = history.length,
                cwd = fm.cwd().hash;

            if (update) {
                current >= 0 && l > current + 1 && history.splice(current + 1);
                history[history.length - 1] != cwd && history.push(cwd);
                current = history.length - 1;
            }
            update = true;

            if (nativeHistory) {
                if (! nativeHistory.state) {
                    nativeHistory.replaceState({ thash: cwd }, null, location.pathname + location.search + '#elf_' + cwd);
                } else {
                    nativeHistory.state.thash != cwd && nativeHistory.pushState({ thash: cwd }, null, location.pathname + location.search + '#elf_' + cwd);
                }
            }
        })
        .reload(reset);

}
/**
 * elFinder command prototype
 *
 * @type  elFinder.command
 * @author  Dmitry (dio) Levashov
 */
elFinder.prototype.command = function(fm) {

    /**
	 * elFinder instance
	 *
	 * @type  elFinder
	 */
    this.fm = fm;

    /**
	 * Command name, same as class name
	 *
	 * @type  String
	 */
    this.name = '';

    /**
	 * Short command description
	 *
	 * @type  String
	 */
    this.title = '';

    /**
	 * Current command state
	 *
	 * @example
	 * this.state = -1; // command disabled
	 * this.state = 0;  // command enabled
	 * this.state = 1;  // command active (for example "fullscreen" command while elfinder in fullscreen mode)
	 * @default -1
	 * @type  Number
	 */
    this.state = -1;

    /**
	 * If true, command can not be disabled by connector.
	 * @see this.update()
	 *
	 * @type  Boolen
	 */
    this.alwaysEnabled = false;

    /**
	 * If true, this means command was disabled by connector.
	 * @see this.update()
	 *
	 * @type  Boolen
	 */
    this._disabled = false;

    this.disableOnSearch = false;

    this.updateOnSelect = true;

    /**
	 * elFinder events defaults handlers.
	 * Inside handlers "this" is current command object
	 *
	 * @type  Object
	 */
    this._handlers = {
        enable: function() { this.update(void(0), this.value); },
        disable: function() { this.update(-1, this.value); },
        'open reload load': function(e) {
            this._disabled = !(this.alwaysEnabled || this.fm.isCommandEnabled(this.name));
            this.update(void(0), this.value);
            this.change();
        }
    };

    /**
	 * elFinder events handlers.
	 * Inside handlers "this" is current command object
	 *
	 * @type  Object
	 */
    this.handlers = {}; /**
	 * Shortcuts
	 *
	 * @type  Array
	 */
    this.shortcuts = [];

    /**
	 * Command options
	 *
	 * @type  Object
	 */
    this.options = { ui: 'button' };

    /**
	 * Prepare object -
	 * bind events and shortcuts
	 *
	 * @return void
	 */
    this.setup = function(name, opts) {
        var self = this,
            fm = this.fm,
            i,
            s;

        this.name = name;
        this.title = fm.messages['cmd' + name] ? fm.i18n('cmd' + name) : name,
            this.options = $.extend({}, this.options, opts);
        this.listeners = [];

        if (this.updateOnSelect) {
            this._handlers.select = function() { this.update(void(0), this.value); };
        }

        $.each($.extend({}, self._handlers, self.handlers), function(cmd, handler) {
            fm.bind(cmd, $.proxy(handler, self));
        });

        for (i = 0; i < this.shortcuts.length; i++) {
            s = this.shortcuts[i];
            s.callback = $.proxy(s.callback || function() { this.exec(); }, this);
            !s.description && (s.description = this.title);
            fm.shortcut(s);
        }

        if (this.disableOnSearch) {
            fm.bind('search searchend', function(e) {
                self._disabled = e.type == 'search';
                self.update(void(0), self.value);
            });
        }

        this.init();
    }; /**
	 * Command specific init stuffs
	 *
	 * @return void
	 */
    this.init = function() {}; /**
	 * Exec command
	 *
	 * @param  Array         target files hashes
	 * @param  Array|Object  command value
	 * @return $.Deferred
	 */
    this.exec = function(files, opts) {
        return $.Deferred().reject();
    }; /**
	 * Return true if command disabled.
	 *
	 * @return Boolen
	 */
    this.disabled = function() {
        return this.state < 0;
    }; /**
	 * Return true if command enabled.
	 *
	 * @return Boolen
	 */
    this.enabled = function() {
        return this.state > -1;
    }; /**
	 * Return true if command active.
	 *
	 * @return Boolen
	 */
    this.active = function() {
        return this.state > 0;
    }; /**
	 * Return current command state.
	 * Must be overloaded in most commands
	 *
	 * @return Number
	 */
    this.getstate = function() {
        return -1;
    }; /**
	 * Update command state/value
	 * and rize 'change' event if smth changed
	 *
	 * @param  Number  new state or undefined to auto update state
	 * @param  mixed   new value
	 * @return void
	 */
    this.update = function(s, v) {
        var state = this.state,
            value = this.value;

        if (this._disabled) {
            this.state = -1;
        } else {
            this.state = s !== void(0) ? s : this.getstate();
        }

        this.value = v;

        if (state != this.state || value != this.value) {
            this.change();
        }
    }; /**
	 * Bind handler / fire 'change' event.
	 *
	 * @param  Function|undefined  event callback
	 * @return void
	 */
    this.change = function(c) {
        var cmd, i;

        if (typeof(c) === 'function') {
            this.listeners.push(c);
        } else {
            for (i = 0; i < this.listeners.length; i++) {
                cmd = this.listeners[i];
                try {
                    cmd(this.state, this.value);
                } catch (e) {
                    this.fm.debug('error', e);
                }
            }
        }
        return this;
    }; /**
	 * With argument check given files hashes and return list of existed files hashes.
	 * Without argument return selected files hashes.
	 *
	 * @param  Array|String|void  hashes
	 * @return Array
	 */
    this.hashes = function(hashes) {
        return hashes
            ? $.map($.isArray(hashes) ? hashes : [hashes], function(hash) { return fm.file(hash) ? hash : null; })
            : fm.selected();
    }; /**
	 * Return only existed files from given fils hashes | selected files
	 *
	 * @param  Array|String|void  hashes
	 * @return Array
	 */
    this.files = function(hashes) {
        var fm = this.fm;

        return hashes
            ? $.map($.isArray(hashes) ? hashes : [hashes], function(hash) { return fm.file(hash) || null; })
            : fm.selectedFiles();
    };
}
/**
 * Russian translation
 * @author Dmitry "dio" Levashov <dio@std42.ru>
 * @version 2011-07-15
 */
if (elFinder && elFinder.prototype && typeof (elFinder.prototype.i18) == 'object') {
    elFinder.prototype.i18.ru = {
        translator: 'Dmitry "dio" Levashov &lt;dio@std42.ru&gt;',
        language: 'Русский язык',
        direction: 'ltr',
        dateFormat: 'd M Y H:i',
        fancyDateFormat: '$1 H:i',
        messages: {

            /********************************** errors **********************************/
            'error': 'Внимание!',
            'errorDropDir': 'Невозможно загрузить папку.',
            'errNotUplTitle': 'Невозможно загрузить некоторые файлы по следующим причинам: ',
            'errUploadMinSize': 'Невозможно загрузить пустой файл (размер 0 байт), попробуйте добавить другой файл',
            'errUploadMax': 'Превышено максимально допустимое число загружаемых файлов, повторите попытку. Максимально допустимое число одновременно загружаемых файлов равно 10ти',
            'errUploadMaxSize': 'Не удалось загрузить файл! Превышен максимально допустимый размер загружаемого файла, повторите попытку. Максимально допустимый размер файла равен 20 мегабайтам',
            'errInvNameCr': 'Внимание! Минимальная длина имени должна быть равна одному символу, не учитывая длину расширения, попробуйте еще раз',
            'errInvNameCrDir': 'Внимание! Минимальная длина имени должна быть равна одному символу, попробуйте еще раз',
            'errInvSym': 'Внимание! Файл содержит недопустимые символы в названии. Для ввода запрещены символы: "$ / \ : * ? " + # < > |"',
            'errInvSymDir': 'Внимание! Папка содержит недопустимые символы в названии. Для ввода запрещены символы: "$ / \ : * ? " + # < > |"',
            'errInvExtDifferent': 'Нельзя изменять расширение',
            'errInvNameSize': 'Внимание! Превышена максимальная длина имени файла. В настоящий момент максимальная длина имени файла ограничена 100 символами',
            'errInvNameSizeDir': 'Внимание! Превышена максимальная длина имени папки. В настоящий момент максимальная длина имени папки ограничена 100 символами',
            //'errNameNull': 'Имя файла не может состоять только из расширения',
            'errreceivedmail': 'Ошибка при получении сообщений',
            'errUnknown': 'Неизвестная ошибка.',
            'errUnknownCmd': 'Неизвестная комманда.',
            'errJqui': 'Отсутствуют необходимые компоненты jQuery UI - selectable, draggable и droppable.',
            'errNode': 'Отсутствует DOM элемент для инициализации elFinder.',
            'errURL': 'Некорректная настройка. Необходимо указать URL сервера.',
            'errAccess': 'Доступ запрещен.',
            'errConnect': 'Не удалось соединиться с сервером.',
            'errAbort': 'Соединение прервано.',
            'errTimeout': 'Таймаут соединения.',
            'errNotFound': 'Сервер не найден.',
            'errResponse': 'Некорректный ответ сервера.',
            'errConf': 'Некорректная настройка сервера.',
            'errJSON': 'Модуль PHP JSON не установлен.',
            'errNoVolumes': 'Отсутствуют корневые директории достуные для чтения.',
            'errCmdParams': 'Некорректные параметры комманды "$1".',
            'errDataNotJSON': 'Данные не формате JSON.',
            'errDataEmpty': 'Данные отсутствуют.',
            'errCmdReq': 'Для запроса к серверу необходимо указать имя комманды.',
            'errOpen': 'Не удалось открыть "$1".',
            'errNotFolder': 'Объект не является папкой.',
            'errNotFile': 'Объект не является файлом.',
            'errRead': 'Ошибка чтения "$1".',
            'errWrite': 'Ошибка записи "$1".',
            'errPerm': 'Доступ запрещен.',
            'errLocked': '"$1" защищен и не может быть переименован, перемещен или удален.',
            'errExists': 'В папке уже существует объект с именем <b>"$1".</b>',
            'errInvName': 'Недопустимое имя файла.',
            'errFolderNotFound': 'Папка не найдена.',
            'errFileNotFound': 'Файл не найден.',
            'errTrgFolderNotFound': 'Целевая папка "$1" не найдена.',
            'errPopup': 'Браузер заблокировал открытие нового окна. Чтобы окрыть файл, измените настройки браузера.',
            'errMkdir': 'Ошибка создания папки "$1".',
            'errMkfile': 'Ошибка создания файла "$1".',
            'errRename': 'Ошибка переименования "$1".',
            'errCopyFrom': 'Копирование из корневой директории "$1" запрещено.',
            'errCopyTo': 'Копирование в корневую директорию "$1" запрещено.',
            'errUploadCommon': 'Ошибка загрузки файлов.',
            'errUpload': 'Ошибка загрузки "$1".',
            'errUploadNoFiles': 'Отсутствуют загруженые файлы.',
            'errMaxSize': 'Превышен допустимый размер загружаемых файлов.',
            'errFileMaxSize': 'Размер файла превышает допустимый.',
            'errUploadMime': 'Недопустимый тип файла.',
            'errUploadTransfer': 'Ошибка передачи файла "$1".',
            'errSave': 'Ошибка сохранения "$1".',
            'errCopy': 'Ошибка копирования "$1".',
            'errMove': 'Ошибка перемещения "$1".',
            'errCopyInItself': 'Невозможно скопировать папку "$1" в саму себя.',
            'errRm': 'Ошибка удаления "$1".',
            'errExtract': 'Ошибка извлечения файлов из архива "$1".',
            'errArchive': 'Ошибка создания архива.',
            'errArcType': 'Неподдерживаемый тип архива.',
            'errNoArchive': 'Файл не является архивом допустимого типа.',
            'errCmdNoSupport': 'Сервер не поддерживает эту комманду.',
            'errReplByChild': 'Невозможно заменить папку "$1" содержащимся в ней объектом.',
            'errArcSymlinks': 'По соображениям безопасности запрещена распаковка архивов, содержащих ссылки (symlinks) или файлы с недопустимыми именами.', // edited 24.06.2012
            'errArcMaxSize': 'Размер файлов в архиве превышает максимально разрешенный.',
            'errResize': 'Не удалось изменить размер "$1".',
            'errUsupportType': 'Неподдерживаемый тип файла.',
            'errNotUTF8Content': 'Файл "$1" содержит текст в кодировке отличной от UTF-8 и не может быть отредактирован.', // added 9.11.2011
            'errNetMount': 'Не удалось подключить "$1".', // added 17.04.2012
            'errNetMountNoDriver': 'Неподдерживаемый протокол.', // added 17.04.2012
            'errNetMountFailed': 'Ошибка монтирования.', // added 17.04.2012
            'errNetMountHostReq': 'Host required.', // added 18.04.2012
            /******************************* commands names ********************************/
            'cmdarchive': 'Создать архив',
            'cmdback': 'Назад',
            'cmdcopy': 'Копировать',
            'cmdcut': 'Вырезать',
            'cmddownload': 'Скачать',
            'cmdduplicate': 'Сделать копию',
            'cmdedit': 'Редактировать',
            'cmdextract': 'Распаковать архив',
            'cmdforward': 'Вперед',
            'cmdgetfile': 'Выбрать',
            'cmdhelp': 'О программе',
            'cmdhome': 'Домой',
            'cmdinfo': 'Свойства',
            'cmdmkdir': 'Новая папка',
            'cmdmkfile': 'Новый файл',
            'cmdopen': 'Открыть',
            'cmdpaste': 'Вставить',
            'cmdquicklook': 'Быстрый просмотр',
            'cmdreload': 'Обновить',
            'cmdrename': 'Переименовать',
            'cmdrm': 'Удалить',
            'cmdsearch': 'Поиск',
            'cmdup': 'Наверх',
            'cmdupload': 'Добавить файл',
            'cmdview': 'Вид',
            'cmdresize': 'Размер изображения',
            'cmdsort': 'Сортировать',
            'cmdencrypt': 'Зашифровать',
            'cmddecrypt': 'Расшифровать',
            'cmdsign': 'Подписать',
            'cmdchecksign': 'Проверить подпись',
            'cmdsend': 'Отправить',
            'cmdopensendpopup': 'Отправить',
            'cmddecryptandchecksign': 'Расшифровать и проверить подпись',
            'cmdsignandencrypt': 'Подписать и зашифровать',
            'cmdmore': 'Еще',
            'cmdcryptinfo': 'Подробнее',
            'cmdadd': 'Добавить',
            'cmdcancel': 'отменить',
            'cmdcancel2': 'Отмена',
            'cmdfilter': 'Выводить: ',
            'cmdmultiplyadd': '+ Добавить',
            'addupload': 'Файл',
            'addmkdir': 'Папку',
            'addpaste': 'Вставить из буфера',
            /*********************************** buttons ***********************************/
            'btnClose': 'Закрыть',
            'btnSave': 'Сохранить',
            'btnRm': 'Да',
            'btnCancel': 'Отмена',
            'btnApply': 'Применить',
            'btnNo': 'Нет',
            'btnYes': 'Да',
            'btnMount': 'Подключить', // added 18.04.2012
            /******************************** notifications ********************************/
            'ntfopen': 'Открытие папки',
            'ntffile': 'Открытие файла',
            'ntfreload': 'Обновление текущей папки',
            'ntfmkdir': 'Создание папки',
            'ntfmkfile': 'Создание файла',
            'ntfrm': 'Удаление файлов',
            'ntfcopy': 'Копирование файлов',
            'ntfmove': 'Перемещение файлов',
            'ntfprepare': 'Подготовка к копированию',
            'ntfrename': 'Переименование файлов',
            'ntfupload': 'Загрузка файлов',
            'ntfdownload': 'Скачивание файлов',
            'ntfsave': 'Сохранение файлов',
            'ntfarchive': 'Создание архива',
            'ntfextract': 'Распаковка архива',
            'ntfsearch': 'Поиск файлов',
            'ntfsmth': 'Обработка запроса.',
            'ntfnetmount': 'Монтирую сетевой диск', // added 18.04.2012

            /************************************ dates **********************************/
            'dateUnknown': 'Незвестно',
            'Today': 'Сегодня',
            'Yesterday': 'Вчера',
            'Jan': 'Янв',
            'Feb': 'Фев',
            'Mar': 'Мар',
            'Apr': 'Апр',
            'May': 'Май',
            'Jun': 'Июнь',
            'Jul': 'Июль',
            'Aug': 'Авг',
            'Sep': 'Сен',
            'Oct': 'Окт',
            'Nov': 'Ноя',
            'Dec': 'Дек',
            'January': 'Январь',
            'February': 'Февраль',
            'March': 'Март',
            'April': 'Апрель',
            'May': 'Май',
            'June': 'Июнь',
            'July': 'Июль',
            'August': 'Август',
            'September': 'Сентябрь',
            'October': 'Октябрь',
            'November': 'Ноябрь',
            'December': 'Декабрь',
            'Sunday': 'Воскресенье',
            'Monday': 'Понедельник',
            'Tuesday': 'Вторник',
            'Wednesday': 'Среда',
            'Thursday': 'Четверг',
            'Friday': 'Пятница',
            'Saturday': 'Суббота',
            'Sun': 'Вск',
            'Mon': 'Пнд',
            'Tue': 'Втр',
            'Wed': 'Срд',
            'Thu': 'Чтв',
            'Fri': 'Птн',
            'Sat': 'Сбт',

            /******************************** sort variants ********************************/
            'sortnameDirsFirst': 'по имени (папки в начале)',
            'sortkindDirsFirst': 'по типу (папки в начале)',
            'sortsizeDirsFirst': 'по размеру (папки в начале)',
            'sortdateDirsFirst': 'по дате (папки в начале)',
            'sortname': 'по имени',
            'sortkind': 'по типу',
            'sortsize': 'по размеру',
            'sortdate': 'по дате',
            'sortFoldersFirst': 'Папки в начале',

            /********************************** messages **********************************/
            'attention': 'Внимание!',
            'receiveddirname': 'Полученные',
            'gomaster': 'Перейти к мастеру',
            'receivedmailheader': 'Были получены следующие файлы: ',
            'sendotheremail': 'Отправить файлы на другой E-mail',
            'sendemailsuccess': 'Файлы успешно отправлены',
            'sendemailerror': 'Ошибка при отправке файлов',
            'addressbook': 'Адресная книга',
            'addressbookempty': 'Адресная книга пуста.',
            'select': 'Выбрать',
            'notemail': 'Невалидный E-mail',
            'sendemailmessage': 'Введите E-mail, на который вы планируете отправить файл:',
            'sendfile': 'Отправка файлов',
            'times': 'раз',
            'notfilesforfilter': 'Ни один файл не соответствует выбранной фильтрации',
            'filterAll': 'Все',
            'filterSign': 'Подписанные',
            'filterCrypt': 'Зашифрованные',
            'filterNotCryptSign': 'Не зашифрованные и не подписанные',
            'cwdemptyhelp': 'Вы можете загрузить файлы, перетащив их в данное окно ',
            'or': 'или',
            'cwdselectfile': 'выбрать файлы в проводнике',
            'lastchange': 'Дата последнего изменения: ',
            'sizeinfo': 'Размер: ',
            'emptycryptinfo': 'Документ не подписан и не зашифрован',
            'cryptinfonocert': 'Документ не содержит информацию о подписях',
            'infosel': 'Выбрано элементов: ',
            'signed': 'Подписан ',
            'encrypted': 'Зашифрован',
            'cwdempty': 'Эта папка пуста.',
            'confirmReq': 'Необходимо подтверждение.',
            'confirmRm': 'Выбранные файлы будут удалены. Продолжить?',
            'confirmRepl': 'Заменить старый файл новым?',
            'apllyAll': 'для всех',
            'name': 'Имя файла',
            'size': 'Размер',
            'perms': 'Доступ',
            'modify': 'Изменен',
            'kind': 'Тип',
            'date': 'Дата изменения',
            'read': 'чтение',
            'write': 'запись',
            'noaccess': 'нет доступа',
            'and': 'и',
            'unknown': 'неизвестно',
            'selectall': 'Выбрать все',
            'selectfiles': 'Выбрать файл(ы)',
            'selectffile': 'Выбрать первый файл',
            'selectlfile': 'Выбрать последний файл',
            'viewlist': 'В виде списка',
            'viewicons': 'В виде иконок',
            'places': 'Избранное',
            'calc': 'вычисляю',
            'path': 'Путь',
            'aliasfor': 'Указывает на',
            'locked': 'Защита',
            'dim': 'Разрешение',
            'files': 'Файлы',
            'folders': 'Папки',
            'items': 'Объекты',
            'yes': 'да',
            'no': 'нет',
            'link': 'Ссылка',
            'searcresult': 'Результаты поиска',
            'selected': 'выбрано',
            'about': 'О программе',
            'shortcuts': 'Горячие клавиши',
            'help': 'Помощь',
            'webfm': 'Файловый менеджер для web',
            'ver': 'Версия',
            'protocolver': 'версия протокола',
            'homepage': 'Сайт проекта',
            'docs': 'Документация',
            'github': 'Fork us on Github',
            'twitter': 'Follow us in twitter',
            'facebook': 'Join us on facebook',
            'team': 'Авторы',
            'chiefdev': 'ведущий разработчик',
            'developer': 'разработчик',
            'contributor': 'участник',
            'maintainer': 'сопровождение проекта',
            'translator': 'переводчик',
            'icons': 'Иконки',
            'dontforget': 'и не забудьте взять своё полотенце',
            'shortcutsof': 'Горячие клавиши отключены',
            'dropFiles': 'Бросить файлы',
            'or': 'или',
            'selectForUpload': 'Выбрать файлы для загрузки',
            'moveFiles': 'Внимание!',
            'copyFiles': 'Внимание!',
            'rmFromPlaces': 'Удалить из избранного',
            'untitled folder': 'новая папка',
            'untitled file.txt': 'новый файл.txt',
            'aspectRatio': 'Сохранять пропорции',
            'scale': 'Масштаб',
            'width': 'Ширина',
            'height': 'Высота',
            'resize': 'Размер',
            'crop': 'Кадрировать',
            'rotate': 'Поворот',
            'rotate-cw': 'Поворот на 90 градусов по часовой стрелке',
            'rotate-ccw': 'Поворот на 90 градусов против часовой стрелке',
            'degree': '°',
            'netMountDialogTitle': 'Подключить сетевой диск', // added 18.04.2012
            'protocol': 'Протокол', // added 18.04.2012
            'host': 'Хост', // added 18.04.2012
            'port': 'Порт', // added 18.04.2012
            'user': 'Пользователь', // added 18.04.2012
            'pass': 'Пароль', // added 18.04.2012
            'attentionTheRestriction': 'Внимание!', // added 28.10.2014
            'noMoreThirtyFiles': 'Одновременно может быть отправлено не более 30ти файлов', // added 28.10.2014

            /********************************** mimetypes **********************************/
            'kindUnknown': 'Неизвестный',
            'kindFolder': 'Папка',
            'kindAlias': 'Ссылка',
            'kindAliasBroken': 'Битая ссылка',
            // applications
            'kindSign': 'Подписанный документ',
            'kindCrypt': 'Зашифрованный документ',
            'kindSignCrypt': 'Зашифрованный и подписанный документ',
            'kindCert': 'Файл сертификата',
            'kindApp': 'Приложение',
            'kindPostscript': 'Документ Postscript',
            'kindMsOffice': 'Документ Microsoft Office',
            'kindMsWord': 'Документ Microsoft Word',
            //'kindMsExcel'     : 'Документ Microsoft Excel',
            'kindMsExcel': 'Офисный документ',
            //'kindMsPP'        : 'Презентация Microsoft Powerpoint',
            'kindMsPP': 'Офисный документ',
            //'kindOO'          : 'Документ Open Office',
            'kindOO': 'Офисный документ',
            'kindAppFlash': 'Приложение Flash',
            'kindPDF': 'Документ PDF',
            'kindTorrent': 'Файл Bittorrent',
            'kind7z': 'Архив 7z',
            'kindTAR': 'Архив TAR',
            'kindGZIP': 'Архив GZIP',
            'kindBZIP': 'Архив BZIP',
            'kindZIP': 'Архив ZIP',
            'kindRAR': 'Архив RAR',
            'kindJAR': 'Файл Java JAR',
            'kindTTF': 'Шрифт True Type',
            'kindOTF': 'Шрифт Open Type',
            'kindRPM': 'Пакет RPM',
            'kindarchive': 'Архив',
            //'kindSTW'         : 'Текстовый документ',
            'kindSTW': 'Офисный документ',
            // texts
            'kindText': 'Текстовый документ',
            'kindTextPlain': 'Простой текст',
            'kindPHP': 'Исходник PHP',
            'kindCSS': 'Таблицы стилей CSS',
            'kindHTML': 'Документ HTML',
            'kindJS': 'Исходник Javascript',
            //'kindRTF'         : 'Rich Text Format',
            'kindRTF': 'Офисный документ',
            'kindC': 'Исходник C',
            'kindCHeader': 'Заголовочный файл C',
            'kindCPP': 'Исходник C++',
            'kindCPPHeader': 'Заголовочный файл C++',
            'kindShell': 'Unix shell script',
            'kindPython': 'Исходник Python',
            'kindJava': 'Исходник Java',
            'kindRuby': 'Исходник Ruby',
            'kindPerl': 'Исходник Perl',
            'kindSQL': 'Исходник SQL',
            'kindXML': 'Документ XML',
            'kindAWK': 'Исходник AWK',
            'kindCSV': 'Текст с разделителями',
            'kindDOCBOOK': 'Документ Docbook XML',
            // images
            'kindImage': 'Изображение',
            'kindBMP': 'Изображение BMP',
            'kindJPEG': 'Изображение JPEG',
            'kindGIF': 'Изображение GIF',
            'kindPNG': 'Изображение PNG',
            'kindTIFF': 'Изображение TIFF',
            'kindTGA': 'Изображение TGA',
            'kindPSD': 'Изображение Adobe Photoshop',
            'kindXBITMAP': 'Изображение X bitmap',
            'kindPXM': 'Изображение Pixelmator',
            'kindICON': 'Изображение ICON',
            'kindCR2': 'Изображение CR2',
            'kindPIC': 'Изображение PIC',
            'kindCDR': 'Изображение CDR',
            // media
            'kindAudio': 'Аудио файл',
            'kindAudioMPEG': 'Аудио MPEG',
            'kindAudioMPEG4': 'Аудио MPEG-4',
            'kindAudioMIDI': 'Аудио MIDI',
            'kindAudioOGG': 'Аудио Ogg Vorbis',
            'kindAudioWAV': 'Аудио WAV',
            'kindWAVE': 'Аудио WAVE',
            'kindM4R': 'Аудио M4R',
            'kindAAC': 'Аудио AAC',
            'kindWMA': 'Аудио WMA',
            'kindMP2': 'Аудио MP2',
            'kindDLS': 'Аудио DLS',
            'kindM4B': 'Аудио M4B',
            'kindWAV': 'Аудио WAV',
            'kindMP1': 'Аудио MP1',
            'AudioPlaylist': 'Плейлист MP3',
            'kindVideo': 'Видео файл',
            'kindFlashVideo': 'Видео FLV',
            'kind3GP': 'Видео 3GP',
            'kindMP4': 'Видео MP4',
            'kindASF': 'Видео ASF',
            'kindAMV': 'Видео AMV',
            'kindAAF': 'Видео AAF',
            'kindMPEG4': 'Видео MPEG4',
            'kindXVID': 'Видео XVID',
            'kindVideoDV': 'Видео DV',
            'kindVideoMPEG': 'Видео MPEG',
            'kindVideoMPEG4': 'Видео MPEG-4',
            'kindVideoAVI': 'Видео AVI',
            'kindVideoMOV': 'Видео Quick Time',
            'kindVideoWM': 'Видео Windows Media',
            'kindVideoFlash': 'Видео Flash',
            'kindVideoMKV': 'Видео Matroska',
            'kindVideoOGG': 'Видео Ogg',
            'volume_files': 'Файлы '
        }
    };
}
"use strict";
/**
 * elFinder transport to support old protocol.
 *
 * @example
 * $('selector').elfinder({
 *   .... 
 *   transport : new elFinderSupportVer1()
 * })
 *
 * @author Dmitry (dio) Levashov
 **/
window.elFinderSupportVer1 = function(upload) {
    var self = this;

    this.upload = upload || 'auto';

    this.init = function(fm) {
        this.fm = fm;
        this.fm.parseUploadData = function(text) {
            var data;

            if (!$.trim(text)) {
                return { error: ['errResponse', 'errDataEmpty'] };
            }

            try {
                data = $.parseJSON(text);
            } catch (e) {
                return { error: ['errResponse', 'errDataNotJSON'] };
            }

            return self.normalize('upload', data);
        };
    };
    this.send = function(opts) {
        var self = this,
            fm = this.fm,
            dfrd = $.Deferred(),
            cmd = opts.data.cmd,
            args = [],
            _opts = {},
            data,
            xhr;

        dfrd.abort = function() {
            xhr.state() == 'pending' && xhr.abort();
        };
        switch (cmd) {
        case 'open':
            opts.data.tree = 1;
            break;
        case 'parents':
        case 'tree':
            return dfrd.resolve({ tree: [] });
            break;
        case 'get':
            opts.data.cmd = 'read';
            opts.data.current = fm.file(opts.data.target).phash;
            break;
        case 'put':
            opts.data.cmd = 'edit';
            opts.data.current = fm.file(opts.data.target).phash;
            break;
        case 'archive':
        case 'rm':
            opts.data.current = fm.file(opts.data.targets[0]).phash;
            break;
        case 'extract':
        case 'rename':
        case 'resize':
            opts.data.current = fm.file(opts.data.target).phash;
            break;
        case 'duplicate':
            _opts = $.extend(true, {}, opts);

            $.each(opts.data.targets, function(i, hash) {
                $.ajax($.extend(_opts, { data: { cmd: 'duplicate', target: hash, current: fm.file(hash).phash } }))
                    .error(function(error) {
                        fm.error(fm.res('error', 'connect'));
                    })
                    .done(function(data) {
                        data = self.normalize('duplicate', data);
                        if (data.error) {
                            fm.error(data.error);
                        } else if (data.added) {
                            fm.trigger('add', { added: data.added });
                        }
                    });
            });
            return dfrd.resolve({});
            break;

        case 'mkdir':
        case 'mkfile':
            opts.data.current = opts.data.target;
            break;
        case 'paste':
            opts.data.current = opts.data.dst;
            break;

        case 'size':
            return dfrd.resolve({ error: fm.res('error', 'cmdsupport') });
            break;
        case 'search':
            return dfrd.resolve({ error: fm.res('error', 'cmdsupport') });
            break;

        }
        // cmd = opts.data.cmd

        xhr = $.ajax(opts)
            .fail(function(error) {
                dfrd.reject(error);
            })
            .done(function(raw) {
                data = self.normalize(cmd, raw);

                // cmd != 'open' && self.fm.log(data);

                if (cmd == 'paste' && !data.error) {
                    fm.sync();
                    dfrd.resolve({});
                } else {
                    dfrd.resolve(data);
                }
            });
        return dfrd;

        return $.ajax(opts);
    }; // fix old connectors errors messages as possible
    // this.errors = {
    // 	'Unknown command'                                  : 'Unknown command.',
    // 	'Invalid backend configuration'                    : 'Invalid backend configuration.',
    // 	'Access denied'                                    : 'Access denied.',
    // 	'PHP JSON module not installed'                    : 'PHP JSON module not installed.',
    // 	'File not found'                                   : 'File not found.',
    // 	'Invalid name'                                     : 'Invalid file name.',
    // 	'File or folder with the same name already exists' : 'File named "$1" already exists in this location.',
    // 	'Not allowed file type'                            : 'Not allowed file type.',
    // 	'File exceeds the maximum allowed filesize'        : 'File exceeds maximum allowed size.',
    // 	'Unable to copy into itself'                       : 'Unable to copy "$1" into itself.',
    // 	'Unable to create archive'                         : 'Unable to create archive.',
    // 	'Unable to extract files from archive'             : 'Unable to extract files from "$1".'
    // }

    this.normalize = function(cmd, data) {
        var self = this,
            files = {},
            filter = function(file) { return file && file.hash && file.name && file.mime ? file : null; },
            phash;

        if ((cmd == 'tmb' || cmd == 'get')) {
            return data;
        }

        // if (data.error) {
        // 	$.each(data.error, function(i, msg) {
        // 		if (self.errors[msg]) {
        // 			data.error[i] = self.errors[msg];
        // 		}
        // 	});
        // }

        if (cmd == 'upload' && data.error && data.cwd) {
            data.warning = $.extend({}, data.error);
            data.error = false;
        }


        if (data.error) {
            return data;
        }

        if (cmd == 'put') {

            phash = this.fm.file(data.target.hash).phash;
            return { changed: [this.normalizeFile(data.target, phash)] };
        }

        phash = data.cwd.hash;

        if (data.tree) {
            $.each(this.normalizeTree(data.tree), function(i, file) {
                files[file.hash] = file;
            });
        }

        $.each(data.cdc || [], function(i, file) {
            var hash = file.hash;

            if (files[hash]) {
                files[hash].date = file.date;
                files[hash].locked = file.hash == phash ? true : file.rm === void(0) ? false : !file.rm;
            } else {
                files[hash] = self.normalizeFile(file, phash, data.tmb);
            }
        });

        if (!data.tree) {
            $.each(this.fm.files(), function(hash, file) {
                if (!files[hash] && file.phash != phash && file.mime == 'directory') {
                    files[hash] = file;
                }
            });
        }

        if (cmd == 'open') {
            return {
                cwd: files[phash] || this.normalizeFile(data.cwd),
                files: $.map(files, function(f) { return f; }),
                options: self.normalizeOptions(data),
                init: !!data.params,
                debug: data.debug
            };
        }


        return $.extend({
            current: data.cwd.hash,
            error: data.error,
            warning: data.warning,
            options: { tmb: !!data.tmb }
        }, this.fm.diff($.map(files, filter)));

    }; /**
	 * Convert old api tree into plain array of dirs
	 *
	 * @param  Object  root dir
	 * @return Array
	 */
    this.normalizeTree = function(root) {
        var self = this,
            result = [],
            traverse = function(dirs, phash) {
                var i, dir;

                for (i = 0; i < dirs.length; i++) {
                    dir = dirs[i];
                    result.push(self.normalizeFile(dir, phash));
                    dir.dirs.length && traverse(dir.dirs, dir.hash);
                }
            };

        traverse([root]);

        return result;
    }; /**
	 * Convert file info from old api format into new one
	 *
	 * @param  Object  file
	 * @param  String  parent dir hash
	 * @return Object
	 */
    this.normalizeFile = function(file, phash, tmb) {
        var mime = file.mime || 'directory',
            size = mime == 'directory' && !file.linkTo ? 0 : file.size,
            info = {
                url: file.url,
                hash: file.hash,
                phash: phash,
                name: file.name,
                mime: mime,
                date: file.date || 'unknown',
                size: size,
                read: file.read,
                write: file.write,
                locked: !phash ? true : file.rm === void(0) ? false : !file.rm
            };

        if (file.mime == 'application/x-empty') {
            info.mime = 'text/plain';
        }
        if (file.linkTo) {
            info.alias = file.linkTo;
        }

        if (file.linkTo) {
            info.linkTo = file.linkTo;
        }

        if (file.tmb) {
            info.tmb = file.tmb;
        } else if (info.mime.indexOf('image/') === 0 && tmb) {
            info.tmb = 1;

        }

        if (file.dirs && file.dirs.length) {
            info.dirs = true;
        }
        if (file.dim) {
            info.dim = file.dim;
        }
        if (file.resize) {
            info.resize = file.resize;
        }
        return info;
    };
    this.normalizeOptions = function(data) {
        var opts = {
            path: data.cwd.rel,
            disabled: data.disabled || [],
            tmb: !!data.tmb,
            copyOverwrite: true
        };

        if (data.params) {
            opts.api = 1;
            opts.url = data.params.url;
            opts.archivers = {
                create: data.params.archives || [],
                extract: data.params.extract || []
            };
        }

        if (opts.path.indexOf('/') !== -1) {
            opts.separator = '/';
        } else if (opts.path.indexOf('\\') !== -1) {
            opts.separator = '\\';
        }
        return opts;
    };
};
"use strict";
/**
 * @class dialogelfinder - open elFinder in dialog window
 *
 * @param  Object  elFinder options with dialog options
 * @example
 * $(selector).dialogelfinder({
 *     // some elfinder options
 *     title          : 'My files', // dialog title, default = "Files"
 *     width          : 850,        // dialog width, default 840
 *     autoOpen       : false,      // if false - dialog will not be opened after init, default = true
 *     destroyOnClose : true        // destroy elFinder on close dialog, default = false
 * })
 * @author Dmitry (dio) Levashov
 **/
$.fn.dialogelfinder = function(opts) {
    var position = 'elfinderPosition',
        destroy = 'elfinderDestroyOnClose';

    this.not('.elfinder').each(function() {


        var doc = $(document),
            toolbar = $('<div class="ui-widget-header dialogelfinder-drag ui-corner-top">' + (opts.title || 'Files') + '</div>'),
            button = $('<a href="#" class="dialogelfinder-drag-close ui-corner-all"><span class="ui-icon ui-icon-closethick"/></a>')
                .appendTo(toolbar)
                .click(function(e) {
                    e.preventDefault();

                    node.dialogelfinder('close');
                }),
            node = $(this).addClass('dialogelfinder')
                .css('position', 'absolute')
                .hide()
                .appendTo('body')
                .draggable({
                    handle: '.dialogelfinder-drag',
                    containment: 'window'
                })
                .elfinder(opts)
                .prepend(toolbar),
            elfinder = node.elfinder('instance');


        node.width(parseInt(node.width()) || 840) // fix width if set to "auto"
            .data(destroy, !!opts.destroyOnClose)
            .find('.elfinder-toolbar').removeClass('ui-corner-top');

        opts.position && node.data(position, opts.position);

        opts.autoOpen !== false && $(this).dialogelfinder('open');

    });

    if (opts == 'open') {
        var node = $(this),
            pos = node.data(position) || {
                top: parseInt($(document).scrollTop() + ($(window).height() < node.height() ? 2 : ($(window).height() - node.height()) / 2)),
                left: parseInt($(document).scrollLeft() + ($(window).width() < node.width() ? 2 : ($(window).width() - node.width()) / 2))
            },
            zindex = 100;

        if (node.is(':hidden')) {

            $('body').find(':visible').each(function() {
                var $this = $(this), z;

                if (this !== node[0] && $this.css('position') == 'absolute' && (z = parseInt($this.zIndex())) > zindex) {
                    zindex = z + 1;
                }
            });

            node.zIndex(zindex).css(pos).show().trigger('resize');
            setTimeout(function() {
                // fix resize icon position and make elfinder active
                node.trigger('resize').mousedown();
            }, 200);
        }
    } else if (opts == 'close') {
        var node = $(this);

        if (node.is(':visible')) {
            !!node.data(destroy)
                ? node.elfinder('destroy').remove()
                : node.elfinder('close');
        }
    } else if (opts == 'instance') {
        return $(this).getElFinder();
    }

    return this;
};

$.fn.elfinderoverlay = function(opts) {

    this.filter(':not(.elfinder-overlay)').each(function() {
        opts = $.extend({}, opts);
        $(this).addClass('ui-widget-overlay elfinder-overlay')
            .hide()
            .mousedown(function(e) {
                e.preventDefault();
                e.stopPropagation();
            })
            .data({
                cnt: 0,
                show: typeof(opts.show) == 'function' ? opts.show : function() {},
                hide: typeof(opts.hide) == 'function' ? opts.hide : function() {}
            });
    });

    if (opts == 'show') {
        var o = this.eq(0),
            cnt = o.data('cnt') + 1,
            show = o.data('show');

        o.data('cnt', cnt);

        if (o.is(':hidden')) {
            o.zIndex(o.parent().zIndex() + 1);
            o.show();
            show();
        }
    }

    if (opts == 'hide') {
        var o = this.eq(0),
            cnt = o.data('cnt') - 1,
            hide = o.data('hide');

        o.data('cnt', cnt);

        if (cnt == 0 && o.is(':visible')) {
            o.hide();
            hide();
        }
    }

    return this;
}
"use strict";
/**
 * @class elfinderworkzone - elFinder container for nav and current directory
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfinderworkzone = function(fm) {
    var cl = 'elfinder-workzone';

    this.not('.' + cl).each(function() {
        var wz = $(this).addClass(cl),
            wdelta = wz.outerHeight(true) - wz.height(),
            parent = wz.parent();

        parent.add(window).bind('resize', function() {
            var height = parent.height() + 20; // +20px show bottom scrollbar arrow [rail-s]

            parent.children(':visible:not(.' + cl + ')').each(function() {
                var ch = $(this);

                if (ch.css('position') != 'absolute') {
                    height -= ch.outerHeight(true);
                }
            });

            wz.height(height - wdelta);
        });
    });
    return this;
};
/**
 * @class elfindernav - elFinder container for diretories tree and places
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfindernavbar = function(fm, opts) {

    this.not('.elfinder-navbar').each(function() {
        var nav = $(this).addClass('ui-state-default elfinder-navbar'),
            parent = nav.parent()
                .resize(function() {
                    nav.height(wz.height() - delta);
                }),
            wz = parent.children('.elfinder-workzone').append(nav),
            delta = nav.outerHeight() - nav.height(),
            ltr = fm.direction == 'ltr',
            handle;


        if ($.fn.resizable && opts.resizable) {
            handle = nav.resizable({
                    handles: ltr ? 'e' : 'w',
                    minWidth: opts.minWidth || 150,
                    maxWidth: opts.maxWidth || 500
                })
                .bind('resize scroll', function() {
                    var offset = (fm.UA.Opera && nav.scrollLeft()) ? 20 : 2;
                    handle.css({
                        top: parseInt(nav.scrollTop()) + 'px',
                        left: ltr ? 'auto' : parseInt(nav.scrollLeft() + offset),
                        right: ltr ? parseInt(nav.scrollLeft() - offset) * -1 : 'auto'
                    });
                })
                .find('.ui-resizable-handle').zIndex(nav.zIndex() + 10);

            if (!ltr) {
                nav.resize(function() {
                    nav.css('left', null).css('right', 0);
                });
            }

            fm.one('open', function() {
                setTimeout(function() {
                    nav.trigger('resize');
                }, 150);
            });
        }
    });

    return this;
};
"use strict";
/**
 * @class  elFinder dialog
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfinderdialog = function(opts) {
    var dialog;

    if (typeof(opts) == 'string' && (dialog = this.closest('.ui-dialog')).length) {
        if (opts == 'open') {
            dialog.css('display') == 'none' && dialog.fadeIn(120, function() {
                dialog.trigger('open');
            });
        } else if (opts == 'close') {
            dialog.css('display') != 'none' && dialog.hide().trigger('close');
        } else if (opts == 'destroy') {
            dialog.hide().remove();
        } else if (opts == 'toTop') {
            dialog.trigger('totop');
        }
    }

    opts = $.extend({}, $.fn.elfinderdialog.defaults, opts);

    this.filter(':not(.ui-dialog-content)').each(function() {
        var self = $(this).addClass('ui-dialog-content ui-widget-content'),
            parent = self.parent(),
            clactive = 'elfinder-dialog-active',
            cldialog = 'elfinder-dialog',
            clnotify = 'elfinder-dialog-notify',
            clhover = 'ui-state-hover',
            id = parseInt(Math.random() * 1000000),
            overlay = parent.children('.elfinder-overlay'),
            buttonset = $('<div class="ui-dialog-buttonset"/>'),
            buttonpane = $('<div class=" ui-helper-clearfix ui-dialog-buttonpane ui-widget-content"/>')
                .append(buttonset),

            dialog = $('<div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable std42-dialog  ' + cldialog + ' ' + opts.cssClass + '"/>')
                .hide()
                .append(self)
                .appendTo(parent)
                .draggable({
                    handle: '.ui-dialog-titlebar',
                    containment: 'document'
                })
                .css({
                    width: opts.width,
                    height: opts.height
                })
                .mousedown(function(e) {
                    e.stopPropagation();

                    $(document).mousedown();

                    if (!dialog.is('.' + clactive)) {
                        parent.find('.' + cldialog + ':visible').removeClass(clactive);
                        dialog.addClass(clactive).zIndex(maxZIndex() + 1);
                    }
                })
                .bind('open', function() {
                    dialog.trigger('totop');
                    typeof(opts.open) == 'function' && $.proxy(opts.open, self[0])();

                    if (!dialog.is('.' + clnotify)) {

                        parent.find('.' + cldialog + ':visible').not('.' + clnotify).each(function() {
                            var d = $(this),
                                top = parseInt(d.css('top')),
                                left = parseInt(d.css('left')),
                                _top = parseInt(dialog.css('top')),
                                _left = parseInt(dialog.css('left'));

                            if (d[0] != dialog[0] && (top == _top || left == _left)) {
                                dialog.css({
                                    top: (top + 10) + 'px',
                                    left: (left + 10) + 'px'
                                });
                            }
                        });
                    }
                })
                .bind('close', function() {
                    var dialogs = parent.find('.elfinder-dialog:visible'),
                        z = maxZIndex();

                    $(this).data('modal') && overlay.elfinderoverlay('hide');

                    // get focus to next dialog
                    if (dialogs.length) {
                        dialogs.each(function() {
                            var d = $(this);
                            if (d.zIndex() >= z) {
                                d.trigger('totop');
                                return false;
                            }
                        });
                    } else {
                        // return focus to parent
                        setTimeout(function() {
                            parent.mousedown().click();
                        }, 10);

                    }

                    if (typeof(opts.close) == 'function') {
                        $.proxy(opts.close, self[0])();
                    } else if (opts.destroyOnClose) {
                        dialog.hide().remove();
                    }
                })
                .bind('totop', function() {
                    $(this).mousedown().find('.ui-button:first').focus().end().find(':text:first').focus();
                    $(this).data('modal') && overlay.elfinderoverlay('show');
                    overlay.zIndex($(this).zIndex());
                })
                .data({ modal: opts.modal }),
            maxZIndex = function() {
                var z = parent.zIndex() + 10;
                parent.find('.' + cldialog + ':visible').each(function() {
                    var _z;
                    if (this != dialog[0]) {
                        _z = $(this).zIndex();
                        if (_z > z) {
                            z = _z;
                        }
                    }
                });
                return z;
            },
            top;

        if (!opts.position) {
            top = parseInt((parent.height() - dialog.outerHeight()) / 2 - 42);
            opts.position = {
                top: (top > 0 ? top : 0) + 'px',
                left: parseInt((parent.width() - dialog.outerWidth()) / 2) + 'px'
            };
        }

        dialog.css(opts.position);

        if (opts.closeOnEscape) {
            $(document).bind('keyup.' + id, function(e) {
                if (e.keyCode == $.ui.keyCode.ESCAPE && dialog.is('.' + clactive)) {
                    self.elfinderdialog('close');
                    $(document).unbind('keyup.' + id);
                }
            });
        }
        dialog.prepend(
            $('<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">' + opts.title + '</div>')
            .prepend($('<a href="#" class="ui-dialog-titlebar-close ui-corner-all"><span class="ui-icon ui-icon-closethick"/></a>')
                .mousedown(function(e) {
                    e.preventDefault();
                    self.elfinderdialog('close');
                }))
        );


        $.each(opts.buttons, function(name, cb) {
            var button = $('<button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text">' + name + '</span></button>')
                .click($.proxy(cb, self[0]))
                .hover(function(e) { $(this)[e.type == 'mouseenter' ? 'focus' : 'blur'](); })
                .focus(function() { $(this).addClass(clhover); })
                .blur(function() { $(this).removeClass(clhover); })
                .keydown(function(e) {
                    var next;

                    if (e.keyCode == $.ui.keyCode.ENTER) {
                        $(this).click();
                    } else if (e.keyCode == $.ui.keyCode.TAB) {
                        next = $(this).next('.ui-button');
                        next.length ? next.focus() : $(this).parent().children('.ui-button:first').focus();
                    }
                });
            buttonset.append(button);
        });
        buttonset.children().length && dialog.append(buttonpane);
        if (opts.resizable && $.fn.resizable) {
            dialog.resizable({
                minWidth: opts.minWidth,
                minHeight: opts.minHeight,
                alsoResize: this
            });
        }

        typeof(opts.create) == 'function' && $.proxy(opts.create, this)();

        opts.autoOpen && self.elfinderdialog('open');

    });

    return this;
};
$.fn.elfinderdialog.defaults = {
    cssClass: '',
    title: '',
    modal: false,
    resizable: true,
    autoOpen: true,
    closeOnEscape: true,
    destroyOnClose: false,
    buttons: {},
    position: null,
    width: 320,
    height: 'auto',
    minWidth: 200,
    minHeight: 110
};
"use strict";
/**
 * @class  elFinder folders tree
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfindertree = function(fm, opts) {
    var treeclass = fm.res('class', 'tree');

    this.not('.' + treeclass).each(function() {

        var c = 'class',

            /**
			 * Root directory class name
			 *
			 * @type String
			 */
            root = fm.res(c, 'treeroot'),

            /**
			 * Open root dir if not opened yet
			 *
			 * @type Boolean
			 */
            openRoot = opts.openRootOnLoad,

            /**
			 * Subtree class name
			 *
			 * @type String
			 */
            subtree = fm.res(c, 'navsubtree'),

            /**
			 * Directory class name
			 *
			 * @type String
			 */
            navdir = fm.res(c, 'treedir'),

            /**
			 * Collapsed arrow class name
			 *
			 * @type String
			 */
            collapsed = fm.res(c, 'navcollapse'),

            /**
			 * Expanded arrow class name
			 *
			 * @type String
			 */
            expanded = fm.res(c, 'navexpand'),

            /**
			 * Class name to mark arrow for directory with already loaded children
			 *
			 * @type String
			 */
            loaded = 'elfinder-subtree-loaded',

            /**
			 * Arraw class name
			 *
			 * @type String
			 */
            arrow = fm.res(c, 'navarrow'),

            /**
			 * Current directory class name
			 *
			 * @type String
			 */
            active = fm.res(c, 'active'),

            /**
			 * Droppable dirs dropover class
			 *
			 * @type String
			 */
            dropover = fm.res(c, 'adroppable'),

            /**
			 * Hover class name
			 *
			 * @type String
			 */
            hover = fm.res(c, 'hover'),

            /**
			 * Disabled dir class name
			 *
			 * @type String
			 */
            disabled = fm.res(c, 'disabled'),

            /**
			 * Draggable dir class name
			 *
			 * @type String
			 */
            draggable = fm.res(c, 'draggable'),

            /**
			 * Droppable dir  class name
			 *
			 * @type String
			 */
            droppable = fm.res(c, 'droppable'),

            insideNavbar = function(x) {
                var left = navbar.offset().left;

                return left <= x && x <= left + navbar.width();
            },

            drop = fm.droppable.drop,

            /**
			 * Droppable options
			 *
			 * @type Object
			 */
            droppableopts = $.extend(true, {}, fm.droppable, {
                // show subfolders on dropover
                over: function(e) {
                    var link = $(this),
                        cl = hover + ' ' + dropover;

                    if (insideNavbar(e.clientX)) {
                        link.addClass(cl);
                        if (link.is('.' + collapsed + ':not(.' + expanded + ')')) {
                            setTimeout(function() {
                                link.is('.' + dropover) && link.children('.' + arrow).click();
                            }, 500);
                        }
                    } else {
                        link.removeClass(cl);
                    }
                },
                out: function() { $(this).removeClass(hover + ' ' + dropover); },
                drop: function(e, ui) { insideNavbar(e.clientX) && drop.call(this, e, ui); }
            }),

            spinner = $(fm.res('tpl', 'navspinner')),

            /**
			 * Directory html template
			 *
			 * @type String
			 */
            tpl = fm.res('tpl', 'navdir'),

            /**
			 * Permissions marker html template
			 *
			 * @type String
			 */
            ptpl = fm.res('tpl', 'perms'),

            /**
			 * Symlink marker html template
			 *
			 * @type String
			 */
            stpl = fm.res('tpl', 'symlink'),

            /**
			 * Html template replacement methods
			 *
			 * @type Object
			 */
            replace = {
                id: function(dir) { return fm.navHash2Id(dir.hash); },
                cssclass: function(dir) { return (dir.phash ? '' : root) + ' ' + navdir + ' ' + fm.perms2class(dir) + ' ' + (dir.dirs && !dir.link ? collapsed : ''); },
                permissions: function(dir) { return !dir.read || !dir.write ? ptpl : ''; },
                symlink: function(dir) { return dir.alias ? stpl : ''; }
            },

            /**
			 * Return html for given dir
			 *
			 * @param  Object  directory
			 * @return String
			 */
            itemhtml = function(dir) {
                dir.name = fm.escape(dir.i18 || dir.name);

                return tpl.replace(/(?:\{([a-z]+)\})/ig, function(m, key) {
                    return dir[key] || (replace[key] ? replace[key](dir) : '');
                });
            },

            /**
			 * Return only dirs from files list
			 *
			 * @param  Array  files list
			 * @return Array
			 */
            filter = function(files) {
                return $.map(files || [], function(f) { return f.mime == 'directory' ? f : null; });
            },

            /**
			 * Find parent subtree for required directory
			 *
			 * @param  String  dir hash
			 * @return jQuery
			 */
            findSubtree = function(hash) {
                return hash ? tree.find('#' + fm.navHash2Id(hash)).next('.' + subtree) : tree;
            },

            /**
			 * Find directory (wrapper) in required node
			 * before which we can insert new directory
			 *
			 * @param  jQuery  parent directory
			 * @param  Object  new directory
			 * @return jQuery
			 */
            findSibling = function(subtree, dir) {
                var node = subtree.children(':first'),
                    info;

                while (node.length) {
                    info = fm.file(fm.navId2Hash(node.children('[id]').attr('id')));

                    if ((info = fm.file(fm.navId2Hash(node.children('[id]').attr('id'))))
                        && dir.name.toLowerCase().localeCompare(info.name.toLowerCase()) < 0) {
                        return node;
                    }
                    node = node.next();
                }
                return $('');
            },

            /**
			 * Add new dirs in tree
			 *
			 * @param  Array  dirs list
			 * @return void
			 */
            updateTree = function(dirs) {
                var length = dirs.length,
                    orphans = [],
                    i = dirs.length,
                    dir,
                    html,
                    parent,
                    sibling;
                var firstVol = true; // check for netmount volume
                while (i--) {
                    dir = dirs[i];

                    if (tree.find('#' + fm.navHash2Id(dir.hash)).length) {
                        continue;
                    }

                    if ((parent = findSubtree(dir.phash)).length) {
                        html = itemhtml(dir);
                        if (dir.phash && (sibling = findSibling(parent, dir)).length) {
                            sibling.before(html);
                        } else {
                            parent[firstVol || dir.phash ? 'append' : 'prepend'](html);
                            firstVol = false;
                        }
                    } else {
                        orphans.push(dir);
                    }
                }

                if (orphans.length && orphans.length < length) {
                    return updateTree(orphans);
                }
                $('.elfinder-cwd').click();
                setTimeout(function() {
                    updateDroppable();
                }, 10);

            },

            /**
			 * Mark current directory as active
			 * If current directory is not in tree - load it and its parents
			 *
			 * @param {Boolean} do not recursive call
			 * @return void
			 */
            sync = function(stopRec) {
                var cwd = fm.cwd().hash,
                    current = tree.find('#' + fm.navHash2Id(cwd)),
                    rootNode,
                    dir;

                if (openRoot) {
                    rootNode = tree.find('#' + fm.navHash2Id(fm.root()));
                    rootNode.is('.' + loaded) && rootNode.addClass(expanded).next('.' + subtree).show();
                    openRoot = false;
                }

                if (!current.is('.' + active)) {
                    tree.find('.' + navdir + '.' + active).removeClass(active);
                    current.addClass(active);
                }

                if (opts.syncTree) {
                    if (current.length) {
                        return current.parentsUntil('.' + root).filter('.' + subtree).show().prev('.' + navdir).addClass(expanded);
                    }
                    if (fm.newAPI) {
                        dir = fm.file(cwd);
                        if (dir && dir.phash && tree.find('#' + fm.navHash2Id(dir.phash)).length) {
                            updateTree([dir]);
                            return sync();
                        }
                        fm.request({
                                data: { cmd: 'parents', target: cwd },
                                preventFail: true
                            })
                            .done(function(data) {
                                var dirs = filter(data.tree);
                                updateTree(dirs);
                                updateArrows(dirs, loaded);
                                cwd == fm.cwd().hash && sync(true);
                            });
                    }

                }
            },

            /**
			 * Make writable and not root dirs droppable
			 *
			 * @return void
			 */
            updateDroppable = function() {
                tree.find('.' + navdir + ':not(.' + droppable + ',.elfinder-ro,.elfinder-na)').droppable(droppableopts);
            },

            /**
			 * Check required folders for subfolders and update arrow classes
			 *
			 * @param  Array  folders to check
			 * @param  String css class 
			 * @return void
			 */
            updateArrows = function(dirs, cls) {
                var sel = cls == loaded
                    ? '.' + collapsed + ':not(.' + loaded + ')'
                    : ':not(.' + collapsed + ')';


                //tree.find('.'+subtree+':has(*)').prev(':not(.'+collapsed+')').addClass(collapsed)

                $.each(dirs, function(i, dir) {
                    tree.find('#' + fm.navHash2Id(dir.phash) + sel)
                        .filter(function() { return $(this).next('.' + subtree).children().length > 0; })
                        .addClass(cls);
                });
            },


/**
			 * Navigation tree
			 *
			 * @type JQuery
			 */
            tree = $(this).addClass(treeclass)
                // make dirs draggable and toggle hover class
                .delegate('.' + navdir, 'hover', function(e) {
                    var link = $(this),
                        enter = e.type == 'mouseenter';

                    if (!link.is('.' + dropover + ' ,.' + disabled)) {
                        enter && !link.is('.' + root + ',.' + draggable + ',.elfinder-na,.elfinder-wo') && link.draggable(fm.draggable);
                        link.toggleClass(hover, enter);
                    }
                })
                // add/remove dropover css class
                .delegate('.' + navdir, 'dropover dropout drop', function(e) {
                    $(this)[e.type == 'dropover' ? 'addClass' : 'removeClass'](dropover + ' ' + hover);
                })
                // open dir or open subfolders in tree
                .delegate('.' + navdir, 'click', function(e) {
                    var link = $(this),
                        hash = fm.navId2Hash(link.attr('id')),
                        file = fm.file(hash);

                    fm.trigger('searchend');

                    if (hash != fm.cwd().hash && !link.is('.' + disabled)) {
                        fm.exec('open', file.thash || hash);
                    } else if (link.is('.' + collapsed)) {
                        link.children('.' + arrow).click();
                    }
                })
                // toggle subfolders in tree
                .delegate('.' + navdir + '.' + collapsed + ' .' + arrow, 'click', function(e) {
                    var arrow = $(this),
                        link = arrow.parent('.' + navdir),
                        stree = link.next('.' + subtree);

                    e.stopPropagation();

                    if (link.is('.' + loaded)) {
                        link.toggleClass(expanded);
                        stree.slideToggle();
                    } else {
                        spinner.insertBefore(arrow);
                        link.removeClass(collapsed);

                        fm.request({ cmd: 'tree', target: fm.navId2Hash(link.attr('id')) })
                            .done(function(data) {
                                updateTree(filter(data.tree));

                                if (stree.children().length) {
                                    link.addClass(collapsed + ' ' + expanded);
                                    stree.slideDown();
                                }
                                sync();
                            })
                            .always(function(data) {
                                spinner.remove();
                                link.addClass(loaded);
                            });
                    }
                })
                .delegate('.' + navdir, 'contextmenu', function(e) {
                    e.preventDefault();

                    fm.trigger('contextmenu', {
                        'type': 'navbar',
                        'targets': [fm.navId2Hash($(this).attr('id'))],
                        'x': e.clientX,
                        'y': e.clientY
                    });
                }),
            // move tree into navbar
            navbar = fm.getUI('navbar').append(tree).show();

        fm.open(function(e) {
                var data = e.data,
                    dirs = filter(data.files);

                data.init && tree.empty();

                if (dirs.length) {
                    updateTree(dirs);
                    updateArrows(dirs, loaded);
                }
                sync();
            })
            // add new dirs
            .add(function(e) {
                var dirs = filter(e.data.added);

                if (dirs.length) {
                    updateTree(dirs);
                    updateArrows(dirs, collapsed);
                }
            })
            // update changed dirs
            .change(function(e) {
                var dirs = filter(e.data.changed),
                    l = dirs.length,
                    dir,
                    node,
                    tmp,
                    realParent,
                    reqParent,
                    realSibling,
                    reqSibling,
                    isExpanded,
                    isLoaded;

                while (l--) {
                    dir = dirs[l];
                    if ((node = tree.find('#' + fm.navHash2Id(dir.hash))).length) {
                        if (dir.phash) {
                            realParent = node.closest('.' + subtree);
                            reqParent = findSubtree(dir.phash);
                            realSibling = node.parent().next();
                            reqSibling = findSibling(reqParent, dir);

                            if (!reqParent.length) {
                                continue;
                            }

                            if (reqParent[0] !== realParent[0] || realSibling.get(0) !== reqSibling.get(0)) {
                                reqSibling.length ? reqSibling.before(node) : reqParent.append(node);
                            }
                        }
                        isExpanded = node.is('.' + expanded);
                        isLoaded = node.is('.' + loaded);
                        tmp = $(itemhtml(dir));
                        node.replaceWith(tmp.children('.' + navdir));

                        if (dir.dirs
                            && (isExpanded || isLoaded)
                            && (node = tree.find('#' + fm.navHash2Id(dir.hash)))
                            && node.next('.' + subtree).children().length) {
                            isExpanded && node.addClass(expanded);
                            isLoaded && node.addClass(loaded);
                        }
                    }
                }

                sync();
                updateDroppable();
            })
            // remove dirs
            .remove(function(e) {
                var dirs = e.data.removed,
                    l = dirs.length,
                    node,
                    stree;

                while (l--) {
                    if ((node = tree.find('#' + fm.navHash2Id(dirs[l]))).length) {
                        stree = node.closest('.' + subtree);
                        node.parent().detach();
                        if (!stree.children().length) {
                            stree.hide().prev('.' + navdir).removeClass(collapsed + ' ' + expanded + ' ' + loaded);
                        }
                    }
                }
            })
            // add/remove active class for current dir
            .bind('search searchend', function(e) {
                tree.find('#' + fm.navHash2Id(fm.cwd().hash))[e.type == 'search' ? 'removeClass' : 'addClass'](active);
            })
            // lock/unlock dirs while moving
            .bind('lockfiles unlockfiles', function(e) {
                var lock = e.type == 'lockfiles',
                    act = lock ? 'disable' : 'enable',
                    dirs = $.map(e.data.files || [], function(h) {
                        var dir = fm.file(h);
                        return dir && dir.mime == 'directory' ? h : null;
                    });
                $.each(dirs, function(i, hash) {
                    var dir = tree.find('#' + fm.navHash2Id(hash));

                    if (dir.length) {
                        dir.is('.' + draggable) && dir.draggable(act);
                        dir.is('.' + droppable) && dir.droppable(active);
                        dir[lock ? 'addClass' : 'removeClass'](disabled);
                    }
                });
            });
    });

    return this;
};
"use strict";
/**
 * elFinder current working directory ui.
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfindercwd = function(fm, options) {

    this.not('.elfinder-cwd').each(function() {
        // fm.time('cwdLoad');

        var
            list = fm.viewType == 'list',

            blockMultiSelection = location.href.indexOf('multi_selection=false') != -1,

            undef = 'undefined',
            /**
			 * Select event full name
			 *
			 * @type String
			 **/
            evtSelect = 'select.' + fm.namespace,

            /**
			 * Unselect event full name
			 *
			 * @type String
			 **/
            evtUnselect = 'unselect.' + fm.namespace,

            /**
			 * Disable event full name
			 *
			 * @type String
			 **/
            evtDisable = 'disable.' + fm.namespace,

            /**
			 * Disable event full name
			 *
			 * @type String
			 **/
            evtEnable = 'enable.' + fm.namespace,

            c = 'class',
            /**
			 * File css class
			 *
			 * @type String
			 **/
            clFile = fm.res(c, 'cwdfile'),

            /**
			 * Selected css class
			 *
			 * @type String
			 **/
            fileSelector = '.' + clFile,

            /**
			 * Selected css class
			 *
			 * @type String
			 **/
            clSelected = 'ui-selected',

            /**
			 * Disabled css class
			 *
			 * @type String
			 **/
            clDisabled = fm.res(c, 'disabled'),

            /**
			 * Draggable css class
			 *
			 * @type String
			 **/
            clDraggable = fm.res(c, 'draggable'),

            /**
			 * Droppable css class
			 *
			 * @type String
			 **/
            clDroppable = fm.res(c, 'droppable'),

            /**
			 * Hover css class
			 *
			 * @type String
			 **/
            clHover = fm.res(c, 'hover'),

            /**
			 * Hover css class
			 *
			 * @type String
			 **/
            clDropActive = fm.res(c, 'adroppable'),

            /**
			 * Css class for temporary nodes (for mkdir/mkfile) commands
			 *
			 * @type String
			 **/
            clTmp = clFile + '-tmp',

            /**
			 * Number of thumbnails to load in one request (new api only)
			 *
			 * @type Number
			 **/
            tmbNum = fm.options.loadTmbs > 0 ? fm.options.loadTmbs : 5,

            /**
			 * Current search query.
			 *
			 * @type String
			 */
            query = '',

            lastSearch = [],

            lastFilter = [],

            customColsBuild = function() {
                var customCols = '';
                var columns = fm.options.uiOptions.cwd.listView.columns;
                for (var i = 0; i < columns.length; i++) {
                    customCols += '<td class="' + columns[i] + '" title="{' + columns[i] + '}">{' + columns[i] + '}</td>';
                }
                return customCols;
            },

            checkboxforblock = '<span class="button-checkbox bootstrap-checkbox" style="{chbstyle}">' +
                '<input type="checkbox" class="{class}" autocomplete="off" style="display: none;">' +
                '<span class="icon cb-icon-check square" style="display: none;"></span>' +
                '<span class="icon cb-icon-check-empty square"></span>' +
                '</span>',
            checkbox = '<span class="button-checkbox bootstrap-checkbox" style="{chbstyle}">' +
                '<input type="checkbox" class="{class}" autocomplete="off" style="display: none;">' +
                '<span class="icon cb-icon-check square" style="display: none;"></span>' +
                '<span class="icon cb-icon-check-empty square"></span>' +
                '</span>',
            CBbody = checkbox.replace('{class}', ''),
            CBhead = blockMultiSelection ? checkbox.replace('{class}', 'selectAllChB').replace('{chbstyle}', 'display: none;') : checkbox.replace('{class}', 'selectAllChB').replace('{chbstyle}', ''),

            CBSquareBody = checkboxforblock.replace('{class}', ''),
            CBSquareHead = blockMultiSelection ? checkboxforblock.replace('{class}', 'selectAllChB').replace('{chbstyle}', 'display: none;') : checkboxforblock.replace('{class}', 'selectAllChB').replace('{chbstyle}', 'display: block;'),
            selectAllBlock = '<table class="icons-table thead"><thead><tr class="ui-state-default"><td>' + CBSquareHead + ' <span class="selectalltext">' + fm.i18n('selectall') + '</span></td></tr></thead></table>',

            change = function(checkbox) {
                if ($(checkbox).is('input[type="checkbox"]')) {
                    var check = $(checkbox).parent().find(".cb-icon-check");
                    var empty = $(checkbox).parent().find(".cb-icon-check-empty");
                    if (!checkbox.is(':checked')) {
                        check.hide();
                        empty.show();
                    } else {
                        check.show();
                        empty.hide();
                    }
                }
            },

            getTarget = function(obj) {
                var targ;
                var e = obj;
                if (e.target) targ = e.target;
                else if (e.srcElement) targ = e.srcElement;
                if (targ.nodeType == 3) // defeat Safari bug
                    targ = targ.parentNode;
                return targ;
            },

            /**
			 * File templates
			 *
			 * @type Object
			 **/
            templates = {
                icon: '<div id="{hash}" class="' + clFile + ' {permsclass} {dirclass} ui-corner-all" title="{tooltip}">' + CBSquareBody + '<div class="elfinder-cwd-file-wrapper ui-corner-all"><div class="elfinder-cwd-icon {mime} ui-corner-all" unselectable="on" {style}/>{marker}</div><div class="elfinder-cwd-filename" title="{name}">{name}</div></div>',
                //row: '<tr id="{hash}" class="' + clFile + ' {permsclass} {dirclass}" title="{tooltip}"><td><div class="elfinder-cwd-file-wrapper"><span class="elfinder-cwd-icon {mime}"/>{marker}<span class="elfinder-cwd-filename">{name}</span></div></td><td>{perms}</td><td>{date}</td><td>{size}</td><td>{kind}</td></tr>'
                row: '<tr id="{hash}" class="' + clFile + ' {permsclass} {dirclass}" ><td class="chb" >' + CBbody + '</td><td class="name" title="{tooltip}"><div class="elfinder-cwd-file-wrapper"><span class="elfinder-cwd-icon {mime}"/>{marker}<span class="elfinder-cwd-filename">{name}</span></div></td>' + customColsBuild() + '</tr>'
            },

            permsTpl = fm.res('tpl', 'perms'),

            symlinkTpl = fm.res('tpl', 'symlink'),

            /**
			 * Template placeholders replacement rules
			 *
			 * @type Object
			 **/
            replacement = {
                permsclass: function(f) {
                    return fm.perms2class(f);
                },
                perms: function(f) {
                    return fm.formatPermissions(f);
                },
                dirclass: function(f) {
                    return f.mime == 'directory' ? 'directory' : '';
                },
                mime: function(f) {
                    return fm.mime2class(f.mime);
                },
                size: function(f) {
                    return fm.formatSize(f.size);
                },
                date: function(f) {
                    return fm.formatDate(f);
                },
                kind: function(f) {
                    return fm.mime2kind(f);
                },
                marker: function(f) {
                    return (f.alias || f.mime == 'symlink-broken' ? symlinkTpl : '') + (!f.read || !f.write ? permsTpl : '');
                },
                tooltip: function(f) {
                    //var title = fm.formatDate(f) + (f.size > 0 ? ' ('+fm.formatSize(f.size)+')' : '');
                    var title = f.name + (f.size > 0 ? ' (' + fm.formatSize(f.size) + ')' : '');
                    return f.tooltip ? fm.escape(f.tooltip).replace(/"/g, '&quot;').replace(/\r/g, '&#13;') + '&#13;' + title : title;
                },
                styleforfolder: function(f) {
                    return f.mime == 'directory' ? 'display:none;' : '';
                },
                chbstyle: function(f) {
                    return fm.isModal && f.mime == 'directory' ? 'display:none;' : '';
                },
            },

            /**
			 * Return file html
			 *
			 * @param  Object  file info
			 * @return String
			 **/
            itemhtml = function(f) {
                f.name = fm.escape(f.name);
                return templates[list ? 'row' : 'icon']
                    .replace(/\{([a-z]+)\}/g, function(s, e) {
                        return replacement[e] ? replacement[e](f) : (f[e] ? f[e] : '');
                    });
            },

            /**
			 * Flag. Required for msie to avoid unselect files on dragstart
			 *
			 * @type Boolean
			 **/
            selectLock = false,

            /**
			 * Move selection to prev/next file
			 *
			 * @param String  move direction
			 * @param Boolean append to current selection
			 * @return void
			 * @rise select			
			 */
            select = function(keyCode, append) {
                var code = $.ui.keyCode,
                    prev = keyCode == code.LEFT || keyCode == code.UP,
                    sel = cwd.find('[id].' + clSelected),
                    selector = prev ? 'first:' : 'last',
                    s,
                    n,
                    sib,
                    top,
                    left;

                function sibling(n, direction) {
                    return n[direction + 'All']('[id]:not(.' + clDisabled + '):not(.elfinder-cwd-parent):first');
                }

                if (sel.length) {
                    s = sel.filter(prev ? ':first' : ':last');
                    sib = sibling(s, prev ? 'prev' : 'next');

                    if (!sib.length) {
                        // there is no sibling on required side - do not move selection
                        n = s;
                    } else if (list || keyCode == code.LEFT || keyCode == code.RIGHT) {
                        // find real prevoius file
                        n = sib;
                    } else {
                        // find up/down side file in icons view
                        top = s.position().top;
                        left = s.position().left;

                        n = s;
                        if (prev) {
                            do {
                                n = n.prev('[id]');
                            } while (n.length && !(n.position().top < top && n.position().left <= left));

                            if (n.is('.' + clDisabled)) {
                                n = sibling(n, 'next');
                            }
                        } else {
                            do {
                                n = n.next('[id]');
                            } while (n.length && !(n.position().top > top && n.position().left >= left));

                            if (n.is('.' + clDisabled)) {
                                n = sibling(n, 'prev');
                            }
                            // there is row before last one - select last file
                            if (!n.length) {
                                sib = cwd.find('[id]:not(.' + clDisabled + '):last');
                                if (sib.position().top > top) {
                                    n = sib;
                                }
                            }
                        }
                    }
                    // !append && unselectAll();
                } else {
                    // there are no selected file - select first/last one
                    n = cwd.find('[id]:not(.' + clDisabled + '):not(.elfinder-cwd-parent):' + (prev ? 'last' : 'first'));
                }

                if (n && n.length && !n.is('.elfinder-cwd-parent')) {
                    if (append) {
                        // append new files to selected
                        n = s.add(s[prev ? 'prevUntil' : 'nextUntil']('#' + n.attr('id'))).add(n);
                    } else {
                        // unselect selected files
                        sel.trigger(evtUnselect);
                    }
                    // select file(s)
                    n.trigger(evtSelect);
                    // set its visible
                    scrollToView(n.filter(prev ? ':first' : ':last'));
                    // update cache/view
                    trigger();
                }
            },

            selectedFiles = [],

            selectFile = function(hash) {
                cwd.find('#' + hash).trigger(evtSelect);
            },

            selectAll = function() {
                if (blockMultiSelection) return;
                var phash = fm.cwd().hash;
                cwd.parent().find('input[type="checkbox"].selectAllChB').prop("checked", true);
                change(cwd.parent().find('input[type="checkbox"].selectAllChB'));
                cwd.find('[id]:not(.' + clSelected + '):not(.elfinder-cwd-parent)').trigger(evtSelect);
                selectedFiles = $.map(fm.files(), function(f) {
                    return fm.isModal && f.mime == 'directory' ? null : f.phash == phash ? f.hash : null;
                });
                trigger();
            },

            /**
			 * Unselect all files
			 *
			 * @return void
			 */
            unselectAll = function() {
                selectedFiles = [];
                cwd.parent().find('input[type="checkbox"].selectAllChB').prop("checked", false);
                change(cwd.parent().find('input[type="checkbox"].selectAllChB'));
                cwd.find('[id].' + clSelected).trigger(evtUnselect);
                trigger();
            },

            /**
			 * Return selected files hashes list
			 *
			 * @return Array
			 */
            selected = function() {
                return selectedFiles;
            },

            /**
			 * Fire elfinder "select" event and pass selected files to it
			 *
			 * @return void
			 */
            trigger = function() {
                fm.trigger('select', { selected: selectedFiles });
            },

            /**
			 * Scroll file to set it visible
			 *
			 * @param DOMElement  file/dir node
			 * @return void
			 */
            scrollToView = function(o) {
                var ftop = o.position().top,
                    fheight = o.outerHeight(true),
                    wtop = wrapper.scrollTop(),
                    wheight = wrapper.innerHeight();

                if (ftop + fheight > wtop + wheight) {
                    wrapper.scrollTop(parseInt(ftop + fheight - wheight));
                } else if (ftop < wtop) {
                    wrapper.scrollTop(ftop);
                }
            },

            /**
			 * Files we get from server but not show yet
			 *
			 * @type Array
			 **/
            buffer = [],

            /**
			 * Return index of elements with required hash in buffer 
			 *
			 * @param String  file hash
			 * @return Number
			 */
            index = function(hash) {
                var l = buffer.length;

                while (l--) {
                    if (buffer[l].hash == hash) {
                        return l;
                    }
                }
                return -1;
            },

            /**
			 * Scroll event name
			 *
			 * @type String
			 **/
            scrollEvent = 'scroll.' + fm.namespace,

            /**
			 * Cwd scroll event handler.
			 * Lazy load - append to cwd not shown files
			 *
			 * @return void
			 */
            render = function() {
                var html = [],
                    dirs = false,
                    ltmb = [],
                    atmb = {},
                    last = cwd.find('[id]:last'),
                    top = !last.length,
                    place = list ? cwd.children('table').children('tbody') : cwd,
                    files;

                if (!buffer.length) {
                    return wrapper.unbind(scrollEvent);
                }

                while ((!last.length || last.position().top <= wrapper.height() + wrapper.scrollTop() + fm.options.showThreshold)
                    && (files = buffer.splice(0, fm.options.showFiles)).length) {

                    html = $.map(files, function(f) {
                        if (f.hash && f.name) {
                            if (f.mime == 'directory') {
                                dirs = true;
                            }
                            if (f.tmb) {
                                f.tmb === 1 ? ltmb.push(f.hash) : (atmb[f.hash] = f.tmb);
                            }
                            return itemhtml(f);
                        }
                        return null;
                    });

                    place.append(html.join(''));
                    last = cwd.find('[id]:last');
                    // scroll top on dir load to avoid scroll after page reload
                    top && cwd.scrollTop(0);

                }

                // load/attach thumbnails
                attachThumbnails(atmb);
                ltmb.length && loadThumbnails(ltmb);

                // make directory droppable
                dirs && makeDroppable();

                if (selectedFiles.length) {
                    place.find('[id]:not(.' + clSelected + '):not(.elfinder-cwd-parent)').each(function() {
                        var id = this.id;

                        $.inArray(id, selectedFiles) !== -1 && $(this).trigger(evtSelect);
                    });
                }

            },

            /**
			 * Droppable options for cwd.
			 * Do not add class on childs file over
			 *
			 * @type Object
			 */
            droppable = $.extend({}, fm.droppable, {
                over: function(e, ui) {
                    var hash = fm.cwd().hash;
                    $.each(ui.helper.data('files'), function(i, h) {
                        if (fm.file(h).phash == hash) {
                            cwd.removeClass(clDropActive);
                            return false;
                        }
                    });
                }
            }),

            /**
			 * Make directory droppable
			 *
			 * @return void
			 */
            makeDroppable = function() {
                setTimeout(function() {
                    cwd.find('.directory:not(.' + clDroppable + ',.elfinder-na,.elfinder-ro)').droppable(fm.droppable);
                }, 20);
            },

            /**
			 * Preload required thumbnails and on load add css to files.
			 * Return false if required file is not visible yet (in buffer) -
			 * required for old api to stop loading thumbnails.
			 *
			 * @param  Object  file hash -> thumbnail map
			 * @return Boolean
			 */
            attachThumbnails = function(images) {
                var url = fm.option('tmbUrl'),
                    ret = true,
                    ndx;

                $.each(images, function(hash, tmb) {
                    var node = cwd.find('#' + hash);

                    if (node.length) {

                        (function(node, tmb) {
                            $('<img/>')
                                .load(function() { node.find('.elfinder-cwd-icon').css('background', "url('" + tmb + "') center center no-repeat"); })
                                .attr('src', tmb);
                        })(node, url + tmb);
                    } else {
                        ret = false;
                        if ((ndx = index(hash)) != -1) {
                            buffer[ndx].tmb = tmb;
                        }
                    }
                });
                return ret;
            },

            /**
			 * Load thumbnails from backend.
			 *
			 * @param  Array|Boolean  files hashes list for new api | true for old api
			 * @return void
			 */
            loadThumbnails = function(files) {
                var tmbs = [];

                if (fm.oldAPI) {
                    fm.request({
                            data: { cmd: 'tmb', current: fm.cwd().hash },
                            preventFail: true
                        })
                        .done(function(data) {
                            if (attachThumbnails(data.images || []) && data.tmb) {
                                loadThumbnails();
                            }
                        });
                    return;
                }

                tmbs = tmbs = files.splice(0, tmbNum);
                if (tmbs.length) {
                    fm.request({
                            data: { cmd: 'tmb', targets: tmbs },
                            preventFail: true
                        })
                        .done(function(data) {
                            if (attachThumbnails(data.images || [])) {
                                loadThumbnails(files);
                            }
                        });
                }
            },

            /**
			 * Add new files to cwd/buffer
			 *
			 * @param  Array  new files
			 * @return void
			 */
            add = function(files) {
                var place = list ? cwd.find('tbody') : cwd,
                    l = files.length,
                    ltmb = [],
                    atmb = {},
                    dirs = false,
                    findNode = function(file) {
                        var pointer = cwd.find('[id]:first'), file2;

                        while (pointer.length) {
                            file2 = fm.file(pointer.attr('id'));
                            if (!pointer.is('.elfinder-cwd-parent') && file2 && fm.compare(file, file2) < 0) {
                                return pointer;
                            }
                            pointer = pointer.next('[id]');
                        }
                    },
                    findIndex = function(file) {
                        var l = buffer.length, i;

                        for (i = 0; i < l; i++) {
                            if (fm.compare(file, buffer[i]) < 0) {
                                return i;
                            }
                        }
                        return l || -1;
                    },
                    file,
                    hash,
                    node,
                    ndx;


                while (l--) {
                    file = files[l];
                    hash = file.hash;

                    if (cwd.find('#' + hash).length) {
                        continue;
                    }

                    if ((node = findNode(file)) && node.length) {
                        node.before(itemhtml(file));
                    } else if ((ndx = findIndex(file)) >= 0) {
                        buffer.splice(ndx, 0, file);
                    } else {
                        place.append(itemhtml(file));
                    }

                    if (cwd.find('#' + hash).length) {
                        if (file.mime == 'directory') {
                            dirs = true;
                        } else if (file.tmb) {
                            file.tmb === 1 ? ltmb.push(hash) : (atmb[hash] = file.tmb);
                        }
                    }
                }

                checkCwdEmpty();

                attachThumbnails(atmb);
                ltmb.length && loadThumbnails(ltmb);
                dirs && makeDroppable();
            },

            /**
			 * Remove files from cwd/buffer
			 *
			 * @param  Array  files hashes
			 * @return void
			 */
            remove = function(files) {
                var l = files.length, hash, n, ndx;

                while (l--) {
                    hash = files[l];
                    if ((n = cwd.find('#' + hash)).length) {
                        try {
                            n.detach();
                        } catch (e) {
                            fm.debug('error', e);
                        }
                    } else if ((ndx = index(hash)) != -1) {
                        buffer.splice(ndx, 1);
                    }
                }

                checkCwdEmpty();
            },

            msg = {
                name: fm.i18n('name'),
                perm: fm.i18n('perms'),
                mod: fm.i18n('modify'),
                size: fm.i18n('size'),
                kind: fm.i18n('kind'),
                date: fm.i18n('date')
            },

            getSpanForSort = function(name) {
                var span = '<span class="' + name + ' caret up"></span>';
                if (fm.sortType == name) {
                    if (fm.sortOrder == "asc") {
                        span = span.replace(' up', '');
                    }
                } else {
                    span = span.replace(' caret', '').replace(' up', '');
                }
                return span;
            },

            customColsNameBuild = function() {
                var customColsName = '';
                var columns = fm.options.uiOptions.cwd.listView.columns;
                for (var i = 0; i < columns.length; i++) {

                    var span = getSpanForSort(columns[i]);
                    var td = '<td class="' + columns[i] + '">';
                    if (fm.options.uiOptions.cwd.listView.columnsCustomName[columns[i]] != null) {
                        customColsName += td + fm.options.uiOptions.cwd.listView.columnsCustomName[columns[i]] + span + '</td>';
                    } else {
                        customColsName += td + msg[columns[i]] + span + '</td>';
                    }
                }
                return customColsName;
            },

            checkCwdEmpty = function() {
                var com,
                    button,
                    link,
                    place = list ? cwd.children('table').children('tbody') : cwd;
                cwd.find(".emptyfolder").remove();
                cwd.find(".nofiles").remove();

                if ((com = fm._commands['filter'])) {
                    if (place.is(':empty') && com.filterState != 'All') {
                        var filterdiv = '<div class="nofiles aligncenter"><img src="../Content/elfinder/img/nofiles.png">' +
                            '<p>' + fm.i18n('notfilesforfilter') + '</p>' +
                            '</div>';
                        cwd.append(filterdiv);
                        return;
                    }
                }

                if (place.is(':empty')) {
                    var div = $('<div class="emptyfolder aligncenter">' +
                        '<img src="../Content/elfinder/img/emptyfolder.png">' +
                        '<h6>' + fm.i18n('cwdempty') + '</h6>' +
                        '<p>' + fm.i18n('cwdemptyhelp') + fm.i18n('or') + '</p>' +
                        '</div>');

                    if ((com = fm._commands['upload'])) {
                        button = 'elfinder' + com.options.ui;
                        if ($.fn[button]) link = $('<div/>')[button](com, true, fm.i18n('cwdselectfile'));
                        div.find("p").append(link);
                    }
                    var dir = fm.cwd();
                    if (dir.volumeId == "v0_" && dir.name == fm.i18n('receiveddirname')) div.find("p").remove();
                    cwd.append(div);
                    cwd.parent().children('table.thead').remove();
                } else {
                    if (!cwd.parent().children('table.thead').length) {
                        var thead = '<table class="thead"><thead><tr class="ui-state-default"><td class="chb">' + CBhead + '</td><td class="name">' + fm.i18n('name') + getSpanForSort('name') + '</td>' + customColsNameBuild() + '</tr></thead></table>';
                        if (list) {
                            cwd.parent().prepend(thead);
                        } else {
                            cwd.parent().prepend(selectAllBlock);
                            $(".selectalltext").bind('click', function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                                var cb = $(getTarget(e)).parent().find('input[type="checkbox"].selectAllChB');
                                if (cb && cb.is(':checked')) {
                                    unselectAll();
                                } else {
                                    selectAll();
                                }
                            });
                        }
                    }
                }
            },

            /**
			 * Update directory content
			 *
			 * @param  Array  files
			 * @return void
			 */
            content = function(files, any) {
                var phash = fm.cwd().hash;
                unselectAll();
                try {
                    // to avoid problem with draggable
                    cwd.children('table,' + fileSelector).remove();
                    cwd.parent().children('table.thead').remove();
                    cwd.parent().children('table.thead').remove();
                } catch (e) {
                    cwd.html('');
                }

                cwd.removeClass('elfinder-cwd-view-icons elfinder-cwd-view-list')
                    .addClass('elfinder-cwd-view-' + (list ? 'list' : 'icons'));

                wrapper[list ? 'addClass' : 'removeClass']('elfinder-cwd-wrapper-list');

                //list && cwd.html('<table><thead><tr class="ui-state-default"><td >'+msg.name+'</td><td>'+msg.perm+'</td><td>'+msg.mod+'</td><td>'+msg.size+'</td><td>'+msg.kind+'</td></tr></thead><tbody/></table>');

                var thead = '<table class="thead"><thead><tr class="ui-state-default"><td class="chb">' + CBhead + '</td><td class="name">' + fm.i18n('name') + getSpanForSort('name') + '</td>' + customColsNameBuild() + '</tr></thead></table>';
                list && cwd.html('<table><tbody/></table>');
                list && cwd.parent().prepend(thead);

                buffer = $.map(files, function(f) { return any || f.phash == phash ? f : null; });
                if (!list && buffer.length > 0) {
                    cwd.parent().prepend(selectAllBlock);
                    $(".selectalltext").bind('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        var cb = $(getTarget(e)).parent().find('input[type="checkbox"].selectAllChB');
                        if (cb && cb.is(':checked')) {
                            unselectAll();
                        } else {
                            selectAll();
                        }
                    });
                }

                buffer = fm.sortFiles(buffer);

                //wrapper.bind(scrollEvent, render).trigger(scrollEvent);
                cwd.bind(scrollEvent, render).trigger(scrollEvent);

                checkCwdEmpty();

                phash = fm.cwd().phash;

                if (options.oldSchool && phash && !query) {
                    var parent = $.extend(true, {}, fm.file(phash), { name: '..', mime: 'directory' });
                    parent = $(itemhtml(parent))
                        .addClass('elfinder-cwd-parent')
                        .bind('mousedown click mouseup touchstart touchmove touchend dblclick mouseenter', function(e) {
                            //.bind('mousedown click mouseup dblclick mouseenter', function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                        })
                        .dblclick(function() {
                            fm.exec('open', this.id);
                        });

                    (list ? cwd.find('tbody') : cwd).prepend(parent);
                }

            },

            /**
			 * CWD node itself
			 *
			 * @type JQuery
			 **/
            cwd = $(this)
                .addClass('ui-helper-clearfix elfinder-cwd')
                .attr('unselectable', 'on')
                // fix ui.selectable bugs and add shift+click support 
                .delegate(fileSelector, 'click.' + fm.namespace, function(e) {
                    var p = this.id ? $(this) : $(this).parents('[id]:first'),
                        prev = p.prevAll('.' + clSelected + ':first'),
                        next = p.nextAll('.' + clSelected + ':first'),
                        pl = prev.length,
                        nl = next.length,
                        target = getTarget(e),
                        sib;

                    e.stopImmediatePropagation();
                    if (blockMultiSelection) unselectAll();
                    if (!blockMultiSelection && e.shiftKey && (pl || nl)) {
                        sib = pl ? p.prevUntil('#' + prev.attr('id')) : p.nextUntil('#' + next.attr('id'));
                        sib.add(p).trigger(evtSelect);
                    } else if (e.ctrlKey || e.metaKey) {
                        //$(p).find('input[type="checkbox"]').prop("checked", !p.is('.' + clSelected));
                        //change($(p).find('input[type="checkbox"]'));
                        p.trigger(p.is('.' + clSelected) ? evtUnselect : evtSelect);
                    } else {
                        if ($(target).children().is('input[type="checkbox"]') ||
                            //$(e.srcElement).is('.bootstrap-checkbox') || $(e.srcElement).is('.btn-link') ||
                            $(target).is('.cb-icon-check-empty')
                            || $(target).is('.cb-icon-check')) {
                            p.trigger(p.is('.' + clSelected) ? evtUnselect : evtSelect);
                        } else if (!$(target).is('input[type="text"]')) {
                            if ($(this).data('touching') && p.is('.' + clSelected)) {
                                $(this).data('touching', null);
                                fm.dblclick({ file: this.id });
                                unselectAll();
                            } else {
                                unselectAll();
                                p.trigger(p.is('.' + clSelected) ? evtUnselect : evtSelect);
                            }
                        }
                    }

                    trigger();
                })
                // call fm.open()
                .delegate(fileSelector, 'dblclick.' + fm.namespace, function(e) {
                    fm.dblclick({ file: this.id });
                })
                // for touch device
                .delegate(fileSelector, 'touchstart.' + fm.namespace, function(e) {
                    $(this).data('touching', true);
                    var p = this.id ? $(this) : $(this).parents('[id]:first'),
                        sel = p.prevAll('.' + clSelected + ':first').length +
                            p.nextAll('.' + clSelected + ':first').length;
                    $(this).data('longtap', setTimeout(function() {
                        // long tap
                        p.trigger(p.is('.' + clSelected) ? evtUnselect : evtSelect);
                        trigger();
                        if (sel == 0 && p.is('.' + clSelected)) {
                            p.trigger('click');
                            trigger();
                        }
                    }, 500));
                })
                .delegate(fileSelector, 'touchmove.' + fm.namespace + ' touchend.' + fm.namespace, function(e) {
                    clearTimeout($(this).data('longtap'));
                })
                // attach draggable
                //.delegate(fileSelector, 'mouseenter.'+fm.namespace, function(e) {
                //	var $this = $(this),
                //		target = list ? $this : $this.children();

                //	if (!$this.is('.'+clTmp) && !target.is('.'+clDraggable+',.'+clDisabled)) {
                //		target.draggable(fm.draggable);
                //	}
                //})
                // add hover class to selected file
                .delegate(fileSelector, evtSelect, function(e) {
                    var $this = $(this),
                        id = $this.attr('id'),
                        file = fm.file(id);
                    if (!file || !(file.mime == "directory" && fm.isModal)) {
                        if (!selectLock && !$this.is('.' + clDisabled)) {
                            $(this).find('input[type="checkbox"]').prop("checked", true);
                            change($(this).find('input[type="checkbox"]'));
                            $this.addClass(clSelected).children().addClass(clHover);
                            if ($.inArray(id, selectedFiles) === -1) {
                                selectedFiles.push(id);
                            }
                        }
                    }
                })
                // remove hover class from unselected file
                .delegate(fileSelector, evtUnselect, function(e) {
                    var $this = $(this),
                        id = $this.attr('id'),
                        ndx;

                    if (!selectLock) {
                        $(this).removeClass(clSelected).children().removeClass(clHover);
                        $(this).find('input[type="checkbox"]').prop("checked", false);
                        change($(this).find('input[type="checkbox"]'));
                        ndx = $.inArray(id, selectedFiles);
                        if (ndx !== -1) {
                            selectedFiles.splice(ndx, 1);
                        }
                    }

                })
                // disable files wich removing or moving
                .delegate(fileSelector, evtDisable, function() {
                    var $this = $(this).removeClass(clSelected).addClass(clDisabled),
                        target = (list ? $this : $this.children()).removeClass(clHover);

                    $(target).find('input[type="checkbox"]').prop("checked", false);
                    change($(target).find('input[type="checkbox"]'));

                    $this.is('.' + clDroppable) && $this.droppable('disable');
                    target.is('.' + clDraggable) && target.draggable('disable');
                    !list && target.removeClass(clDisabled);
                })
                // if any files was not removed/moved - unlock its
                .delegate(fileSelector, evtEnable, function() {
                    var $this = $(this).removeClass(clDisabled),
                        target = list ? $this : $this.children();

                    $this.is('.' + clDroppable) && $this.droppable('enable');
                    target.is('.' + clDraggable) && target.draggable('enable');
                })
                .delegate(fileSelector, 'scrolltoview', function() {
                    scrollToView($(this));
                })
                .delegate(fileSelector, 'mouseenter.' + fm.namespace + ' mouseleave.' + fm.namespace, function(e) {
                    fm.trigger('hover', { hash: $(this).attr('id'), type: e.type });
                    $(this).toggleClass('ui-state-hover');
                })
                .bind('contextmenu.' + fm.namespace, function(e) {
                    var file = $(e.target).closest('.' + clFile);

                    if (file.length) {
                        e.stopPropagation();
                        e.preventDefault();
                        if (!file.is('.' + clDisabled)) {
                            if (!file.is('.' + clSelected)) {
                                // cwd.trigger('unselectall');
                                unselectAll();
                                file.trigger(evtSelect);
                                trigger();
                            }
                            fm.trigger('contextmenu', {
                                'type': 'files',
                                'targets': fm.selected(),
                                'x': e.clientX,
                                'y': e.clientY
                            });

                        }

                    }
                    // e.preventDefault();
                })
                // unselect all on cwd click
                .bind('click.' + fm.namespace, function(e) {
                    !e.shiftKey && !e.ctrlKey && !e.metaKey && unselectAll();
                })

                // make files selectable
                .selectable({
                    filter: fileSelector,
                    stop: trigger,
                    delay: 250,
                    selected: function(e, ui) { $(ui.selected).trigger(evtSelect); },
                    unselected: function(e, ui) { $(ui.unselected).trigger(evtUnselect); }
                })
                // make cwd itself droppable for folders from nav panel
                .droppable(droppable)
                // prepend fake file/dir
                .bind('create.' + fm.namespace, function(e, file) {
                    var parent = list ? cwd.find('tbody') : cwd,
                        p = parent.find('.elfinder-cwd-parent'),
                        file = $(itemhtml(file)).addClass(clTmp);

                    unselectAll();

                    if (p.length) {
                        p.after(file);
                    } else {
                        parent.prepend(file);
                    }

                    cwd.scrollTop(0);
                })
                // unselect all selected files
                .bind('unselectall', unselectAll)
                .bind('selectfile', function(e, id) {
                    cwd.find('#' + id).trigger(evtSelect);
                    trigger();
                }),

            wrapper = $('<div class="elfinder-cwd-wrapper"/>')
                .bind('click', function(e) {
                    var td, sort, target = getTarget(e);
                    if ($(target).children().is('input[type="checkbox"].selectAllChB')) {
                        if (!$(target).is(':checked')) unselectAll();
                        else selectAll();
                    } else if ($(target).is('.bootstrap-checkbox')) {
                        td = $(target).parent();
                    } else if ($(target).is('.cb-icon-check-empty')
                        || $(target).is('.cb-icon-check')) {
                        td = $(target).parent().parent();
                    } else if ($(target).is('td.chb')) {
                        td = $(target);
                    } else if ($(target).is('td')) {
                        sort = { order: "desc", stick: true, type: "name" };
                        var span = $(target).find('span');
                        var isNeedSortAsc = $(span).is(".caret") ? $(span).is('.up') : true;
                        $(target).parent().find('span.caret').removeClass('up').removeClass('caret');

                        sort.order = isNeedSortAsc ? "asc" : "desc";
                        sort.type = $(span).is('.date') ? "date" : $(span).is('.kind') ? "kind" : "name";

                        if (isNeedSortAsc) $(span).addClass('caret').removeClass('up');
                        else $(span).addClass('caret').addClass('up');

                        fm.setSort(sort.type, sort.order, sort.stick);
                    } else {
                        !e.shiftKey && !e.ctrlKey && !e.metaKey && unselectAll();
                    }

                    if (td) {
                        var ch = td.find('input[type="checkbox"].selectAllChB');
                        if ($(ch).is(':checked')) unselectAll();
                        else selectAll();
                    }
                })
                .bind('contextmenu', function(e) {
                    e.preventDefault();
                    fm.trigger('contextmenu', {
                        'type': 'cwd',
                        'targets': [fm.cwd().hash],
                        'x': e.clientX,
                        'y': e.clientY
                    });
                }),

            resize = function() {
                var h = 0;

                wrapper.siblings('.elfinder-panel:visible').each(function() {
                    h += $(this).outerHeight(true);
                });

                wrapper.height(wz.height() - h);
            },

            // elfinder node
            parent = $(this).parent().resize(resize),
            // workzone node
            wz = parent.children('.elfinder-workzone').append(wrapper.append(this));


        if (fm.dragUpload) {
            wrapper[0].addEventListener('dragenter', function(e) {
                e.preventDefault();
                e.stopPropagation();

                wrapper.addClass(clDropActive);
            }, false);

            wrapper[0].addEventListener('dragleave', function(e) {
                e.preventDefault();
                e.stopPropagation();
                e.target == cwd[0] && wrapper.removeClass(clDropActive);
            }, false);

            wrapper[0].addEventListener('dragover', function(e) {
                e.preventDefault();
                e.stopPropagation();
            }, false);

            wrapper[0].addEventListener('drop', function(e) {
                e.preventDefault();
                wrapper.removeClass(clDropActive);

                var items = e.dataTransfer.items;
                for (var i = 0; i < items.length; i++) {
                    var item = items[i].webkitGetAsEntry();
                    if (item && item.isDirectory) {
                        fm.error('errorDropDir');
                        return;
                    }
                }

                e.dataTransfer && e.dataTransfer.files && e.dataTransfer.files.length && fm.exec('upload', { files: e.dataTransfer.files }); //fm.upload({files : e.dataTransfer.files});
            }, false);
        }

        fm
            .bind('open', function(e) {
                fm.trigger('filterend');
                content(e.data.files);
            })
            .bind('search', function(e) {
                lastSearch = e.data.files;
                content(lastSearch, true);
            })
            .bind('searchend', function() {
                lastSearch = [];
                if (query) {
                    query = '';
                    content(fm.files());
                }
            })
            .bind('searchstart', function(e) {
                query = e.data.query;
            })
            .bind('filter', function(e) {
                lastFilter = e.data.files;
                content(lastFilter, true);
            })
            .bind('filterend', function() {
                lastFilter = [];
                //if (query) {
                //query = '';
                content(fm.files());
                //}
            })
            .bind('filterstart', function(e) {
                //query = e.data.query;
            })
            .bind('sortchange', function() {
                content(query ? lastSearch : lastFilter.length > 0 ? lastFilter : fm.files(), !!query);
            })
            .bind('viewchange', function() {
                var sel = fm.selected(),
                    l = fm.storage('view') == 'list';

                if (l != list) {
                    list = l;
                    content(lastFilter.length > 0 ? lastFilter : fm.files());

                    $.each(sel, function(i, h) {
                        selectFile(h);
                    });
                    trigger();
                }
                resize();
            })
            .add(function(e) {
                var phash = fm.cwd().hash,
                    files = query
                        ? $.map(e.data.added || [], function(f) {
                            return f.name.indexOf(query) === -1 ? null : f;
                        })
                        : $.map(e.data.added || [], function(f) {
                            return f.phash == phash ? f : null;
                        });
                add(files);
            })
            .change(function(e) {
                var phash = fm.cwd().hash,
                    sel = fm.selected(),
                    files;

                if (query) {
                    $.each(e.data.changed || [], function(i, file) {
                        remove([file.hash]);
                        if (file.name.indexOf(query) !== -1) {
                            add([file]);
                            $.inArray(file.hash, sel) !== -1 && selectFile(file.hash);
                        }
                    });
                } else {
                    $.each($.map(e.data.changed || [], function(f) { return f.phash == phash ? f : null; }), function(i, file) {
                        remove([file.hash]);
                        add([file]);
                        $.inArray(file.hash, sel) !== -1 && selectFile(file.hash);
                    });
                }

                trigger();
            })
            .remove(function(e) {
                remove(e.data.removed || []);
                trigger();
            })
            // fix cwd height if it less then wrapper
            .bind('open add search searchend', function() {
                cwd.css('height', 'auto');

                if (cwd.outerHeight(true) < wrapper.height()) {
                    cwd.height(wrapper.height() - (cwd.outerHeight(true) - cwd.height()) - 2);
                }
            })
            // select dragged file if no selected, disable selectable
            .dragstart(function(e) {
                var target = $(e.data.target),
                    oe = e.data.originalEvent;

                if (target.is(fileSelector)) {

                    if (!target.is('.' + clSelected)) {
                        !(oe.ctrlKey || oe.metaKey || oe.shiftKey) && unselectAll();
                        target.trigger(evtSelect);
                        trigger();
                    }
                    cwd.droppable('disable');
                }

                cwd.selectable('disable').removeClass(clDisabled);
                selectLock = true;
            })
            // enable selectable
            .dragstop(function() {
                cwd.selectable('enable').droppable('enable');
                selectLock = false;
            })
            .bind('lockfiles unlockfiles', function(e) {
                var event = e.type == 'lockfiles' ? evtDisable : evtEnable,
                    files = e.data.files || [],
                    l = files.length;

                while (l--) {
                    cwd.find('#' + files[l]).trigger(event);
                }
                //trigger();
            })
            // select new files after some actions
            .bind('mkdir mkfile duplicate upload rename archive extract', function(e) {
                var phash = fm.cwd().hash, files;

                unselectAll();

                $.each(e.data.added || [], function(i, file) {
                    file && file.phash == phash && selectFile(file.hash);
                });
                trigger();
            })
            .shortcut({
                pattern: 'ctrl+a',
                description: 'selectall',
                callback: selectAll
            })
            //.shortcut({
            //	pattern     : 'left right up down shift+left shift+right shift+up shift+down',
            //	description : 'selectfiles',
            //	type        : 'keydown' , //fm.UA.Firefox || fm.UA.Opera ? 'keypress' : 'keydown',
            //	callback    : function(e) { select(e.keyCode, e.shiftKey); }
            //})
            .shortcut({
                pattern: 'home',
                description: 'selectffile',
                callback: function(e) {
                    unselectAll();
                    scrollToView(cwd.find('[id]:first').trigger(evtSelect));
                    trigger();
                }
            })
            .shortcut({
                pattern: 'end',
                description: 'selectlfile',
                callback: function(e) {
                    unselectAll();
                    scrollToView(cwd.find('[id]:last').trigger(evtSelect));
                    trigger();
                }
            });

    });

    // fm.timeEnd('cwdLoad')

    return this;
};
"use strict";
/**
 * @class  elFinder toolbar
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfindertoolbar = function(fm, opts) {
    this.each(function() {
        var commands = fm._commands,
            self,
            panels = opts || [],
            l = panels.length,
            i,
            cmd,
            panel,
            button,
            firstB = "ui-elfinder-button-first";

        $(this).css('height', '50px');

        if (!$(this).is('.elfinder-toolbar')) {
            self = $(this).addClass('ui-helper-clearfix ui-widget-header ui-corner-top elfinder-toolbar');
            self.prev().length && self.parent().prepend(this);
        } else {
            self = $(this);
        }

        self.empty();
        while (l--) {
            if (panels[l]) {
                panel = $('<div class="ui-widget-content ui-corner-all elfinder-buttonset"/>');
                i = panels[l].length;
                while (i--) {
                    if ((cmd = commands[panels[l][i]])) {
                        button = 'elfinder' + cmd.options.ui;
                        if (panels[l - 1] == 'multiplyadd') button = 'elfinder' + 'bluebutton';
                        $.fn[button] && panel.prepend($('<div/>')[button](cmd));
                    }
                }
                if (panels[l] != 'more') $(panel).find(".elfinder-button-icon").css('padding-left', '5px');
                if (panels[l] == 'multiplyadd') panel.addClass(firstB);
                if (panels[l] == 'decryptandchecksign') panel.find('div:first').css('width', '155px');
                panel.children().length && self.prepend(panel);
                panel.children(':gt(0)').before('<span class="ui-widget-content elfinder-toolbar-button-separator"/>');
            }
        }

        self.children().length && self.show();
    });

    this.selectFile = function() {
        var showingButtons = [['multiplyadd'], ['paste'], ['copy'], ['paste'], ['rm'], ['rename']];
        var dir = false;
        for (var i = 0; i < fm.selectedFiles().length; i++) {
            var file = fm.selectedFiles()[i];
            if (file.mime == "directory") {
                dir = true;
                break;
            }
        }
        if (dir) {
            $(this)['elfindertoolbar'](fm, showingButtons);
        } else {
            $(this)['elfindertoolbar'](fm, fm.options.uiOptions.toolbar);
        }
    };
    this.openFolder = function() {
        var hover = fm.res('class', 'hover'),
            item = 'elfinder-button-menu-item',
            menu = $('<div class="ui-widget ui-widget-content elfinder-button-menu ui-corner-all"/>')
                .hide()
                .delegate('.' + item, 'hover', function() { $(this).toggleClass(hover); })
                .delegate('.' + item, 'click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    hide();
                }),
            dot = $('<a>...</a>')
                .click(function(e) {
                    e.stopPropagation();
                    menu.slideToggle(100);
                }),

            hide = function() { menu.hide(); },

            addItem = function(a) {
                var href = $(a).attr('href').substr(1);
                var text = $(a).text();
                menu.append(
                    $('<div class="' + item + '" rel="' + href + '">' +
                        '<span class="elfinder-button-icon elfinder-button-icon-directory"/>' + text + '</div>')
                    .click(function(e) {
                        if ($(this).attr('rel')) {
                            var hash = $(this).attr('rel');

                            e.preventDefault();
                            hash != fm.cwd().hash && fm.exec('open', hash);
                        }
                    })
                );

            };

        if (fm.selectedFiles().length != 0) {
            this.selectFile();
        } else {

            var path = $('<div class="ui-elfinder-toolbar-path"/>').html('&nbsp;')
                .delegate('a', 'click', function(e) {
                    if ($(this).attr('href')) {
                        var hash = $(this).attr('href').substr(1);

                        e.preventDefault();
                        hash != fm.cwd().hash && fm.exec('open', hash);
                    }
                });

            var dirs = [];
            //console.log(fm.cwd().hash)
            $.each(fm.parents(fm.cwd().hash), function(i, hash) {

                var name = fm.file(hash).name;
                if (name && name.length > 20) name = name.substring(0, 19) + "...";

                dirs.push('<a href="#' + hash + '">' + name + '</a>');
            });

            if (dirs.length >= 4) {
                menu.empty();
                menu.zIndex(12 + path.zIndex());
                path.prepend(menu);
                //for (var i = dirs.length - 2; i >= 1; i--) {
                //    var dir = dirs[i];
                //    addItem(dir);
                //}
                for (var i = 1; i <= dirs.length - 2; i++) {
                    var dir = dirs[i];
                    addItem(dir);
                }
                path.prepend($(dirs[dirs.length - 1]).addClass('last'));
                path.prepend('>');
                path.prepend(dot);
                path.prepend('>');
                path.prepend(dirs[0]);

                fm.bind('disable select', hide).getUI().click(hide);
            } else {
                path.html(dirs.join(' > '));
                path.find('a:last').addClass('last');
            }

            $(this).empty();
            var showingButtons = [['multiplyadd'], ['paste'], ['filter']];
            $(this)['elfindertoolbar'](fm, showingButtons);

            $(this).append(path);
        }
    };

    return this;
};
"use strict"; /**
 * @class  elFinder toolbar button widget.
 * If command has variants - create menu
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfinderbutton = function(cmd) {
    return this.each(function() {

        var c = 'class',
            fm = cmd.fm,
            disabled = fm.res(c, 'disabled'),
            active = fm.res(c, 'active'),
            hover = fm.res(c, 'hover'),
            item = 'elfinder-button-menu-item',
            selected = 'elfinder-button-menu-item-selected',
            menu,
            table = $("<table><tr><td></td><td></td></tr></table>").css('height', '100%'),
            button = $(this).addClass('ui-state-default elfinder-button') //.append(table)
                .attr('title', cmd.title)
                .append('<span class="elfinder-button-icon elfinder-button-icon-' + cmd.name + '"></span>')
                .hover(function(e) {
                    !button.is('.' + disabled) && button[e.type == 'mouseleave' ? 'removeClass' : 'addClass'](hover); /**button.toggleClass(hover);*/
                })
                .click(function(e) {
                    if (!button.is('.' + disabled)) {
                        $(this).removeClass(hover);
                        if (menu && cmd.variants.length > 1) {
                            // close other menus
                            menu.is(':hidden') && cmd.fm.getUI().click();
                            e.stopPropagation();
                            menu.slideToggle(100);
                        } else {
                            cmd.exec();
                        }

                    } else {
                        if (cmd.name == 'opensendpopup') {
                            var messageWindow = '<div id="modal" style="display: none;" class="message-window"><div class="window alert elfinder-dialog "><div class="header"><div class="close"></div><h2>' + cmd.fm.i18.ru.messages.attentionTheRestriction + '</h2></div><div class="content">' +
                                '<div id="message-panel"><div class="content-group mess-box"><div class="info"><span>' + cmd.fm.i18.ru.messages.noMoreThirtyFiles + '</span></div></div><div class="btn-group"><div class="btn btn-green btn-close">' + cmd.fm.i18.ru.messages.btnClose + '</div></div></div>' +
                                '</div></div></div></div>';
                            $('#elfinder').after(messageWindow);
                            $('#modal.message-window').show();
                            $('#modal.message-window .window .header .close, #modal.message-window .window .content #message-panel .btn-close').click(function() {
                                close();
                            });
                            $(document).keydown(function(e) {
                                if (e.keyCode == 27) {
                                    close();
                                }
                            });

                            var close = function() {
                                $('#modal.message-window').hide().remove();
                            };
                        }
                    }
                }),
            text = $(this).append('<span class="elfinder-button-text">' + cmd.title + '</span>'),
            hideMenu = function() {
                menu.hide();
            };
        //table.find("td:first").append('<span class="elfinder-button-icon elfinder-button-icon-' + cmd.name + '"></span>');
        //table.find("td:last").append('<span class="elfinder-button-text">' + cmd.title + '</span>');
        // if command has variants create menu
        if ($.isArray(cmd.variants)) {
            button.addClass('elfinder-menubutton');

            menu = $('<div class="ui-widget ui-widget-content elfinder-button-menu ui-corner-all"/>')
                .hide()
                .appendTo(button)
                .zIndex(12 + button.zIndex())
                .delegate('.' + item, 'hover', function() { $(this).toggleClass(hover); })
                .delegate('.' + item, 'click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    button.removeClass(hover);
                    cmd.exec(cmd.fm.selected(), $(this).data('value'));
                });

            cmd.fm.bind('disable select', hideMenu).getUI().click(hideMenu);

            cmd.change(function() {
                menu.html('');
                $.each(cmd.variants, function(i, variant) {
                    menu.append($('<div class="' + item + '">' + variant[1] + '</div>').data('value', variant[0]).addClass(variant[0] == cmd.value ? selected : ''));
                });
            });
        }

        cmd.change(function() {
                if (cmd.disabled()) {
                    button.removeClass(active + ' ' + hover).addClass(disabled);
                } else {
                    button.removeClass(disabled);
                    button[cmd.active() ? 'addClass' : 'removeClass'](active);
                }
            })
            .change();
    });
};
"use strict";
$.fn.elfinderbluebutton = function(cmd) {
    return this.each(function() {

        var c = 'class',
            fm = cmd.fm,
            disabled = fm.res(c, 'disabled'),
            active = fm.res(c, 'active'),
            hover = fm.res(c, 'hover'),
            item = 'elfinder-button-menu-item',
            selected = 'elfinder-button-menu-item-selected',
            menu,
            button = $(this).addClass('ui-state-default elfinder-button btn btn-blue')
                .attr('title', cmd.title)
                .append('<span class="elfinder-button-icon elfinder-button-icon-' + cmd.name + '"></span>')
                .hover(function(e) {
                    !button.is('.' + disabled) && button[e.type == 'mouseleave' ? 'removeClass' : 'addClass'](hover);
                })
                .click(function(e) {
                    if (!button.is('.' + disabled)) {
                        cmd.exec();
                    }
                });

        cmd.change(function() {
                if (cmd.disabled()) {
                    button.removeClass(active + ' ' + hover).addClass(disabled);
                } else {
                    button.removeClass(disabled);
                    button[cmd.active() ? 'addClass' : 'removeClass'](active);
                }
            })
            .change();
    });
};
"use strict";
/**
 * @class  elFinder toolbar's button tor upload file
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfinderuploadbutton = function(cmd, islink,text) {
    return this.each(function () {
        var button;
        console.log(1);
        if (islink) button = $(this).elfinderlinkbutton(cmd,null,text).unbind('click');
        else button = $(this).elfinderbutton(cmd).unbind('click');

        var form = $('<form/>').appendTo(button),
			input = $('<input type="file" multiple="true"/>')
				.change(function() {
					var _input = $(this);
					if (_input.val()) {
						cmd.exec({input : _input.remove()[0]});
						input.clone(true).appendTo(form);
					}
				});

		form.append(input.clone(true));

		cmd.change(function() {
			form[cmd.disabled() ? 'hide' : 'show']();
		})
		.change();
	});
}

"use strict"; /**
 * @class  elFinder toolbar button to switch current directory view.
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfinderviewbutton = function(cmd) {
    return this.each(function() {
        var button = $(this).elfinderbutton(cmd),
            icon = button.children('.elfinder-button-icon');

        cmd.change(function() {
            var icons = cmd.value == 'icons';

            icon.toggleClass('elfinder-button-icon-view-list', icons);
            button.attr('title', cmd.fm.i18n(icons ? 'viewlist' : 'viewicons'));
        });
    });
};
"use strict"; /**
 * @class  elFinder toolbar search button widget.
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfindersearchbutton = function(cmd) {
    return this.each(function() {
        var result = false,
            button = $(this).hide().addClass('ui-widget-content elfinder-button ' + cmd.fm.res('class', 'searchbtn') + ''),
            search = function() {
                var val = $.trim(input.val());
                if (val) {
                    cmd.exec(val).done(function() {
                        result = true;
                        input.focus();
                    });

                } else {
                    cmd.fm.trigger('searchend');
                }
            },
            abort = function() {
                input.val('');
                if (result) {
                    result = false;
                    cmd.fm.trigger('searchend');
                }
            },
            input = $('<input type="text" size="42"/>')
                .appendTo(button)
                // to avoid fm shortcuts on arrows
                .keypress(function(e) {
                    e.stopPropagation();
                })
                .keydown(function(e) {
                    e.stopPropagation();

                    e.keyCode == 13 && search();

                    if (e.keyCode == 27) {
                        e.preventDefault();
                        abort();
                    }
                });

        $('<span class="ui-icon ui-icon-search" title="' + cmd.title + '"/>')
            .appendTo(button)
            .click(search);

        $('<span class="ui-icon ui-icon-close"/>')
            .appendTo(button)
            .click(abort); // wait when button will be added to DOM
        setTimeout(function() {
            button.parent().detach();
            cmd.fm.getUI('toolbar').prepend(button.show());
            // position icons for ie7
            if (cmd.fm.UA.ltIE7) {
                var icon = button.children(cmd.fm.direction == 'ltr' ? '.ui-icon-close' : '.ui-icon-search');
                icon.css({
                    right: '',
                    left: parseInt(button.width()) - icon.outerWidth(true)
                });
            }
        }, 200);

        cmd.fm
            .error(function() {
                input.unbind('keydown');
            })
            .select(function() {
                input.blur();
            })
            .bind('searchend', function() {
                input.val('');
            })
            .viewchange(abort)
            .shortcut({
                pattern: 'ctrl+f f3',
                description: cmd.title,
                callback: function() { input.select().focus(); }
            });

    });
};
"use strict"; /**
 * @class  elFinder toolbar button menu with sort variants.
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfindersortbutton = function(cmd) {

    return this.each(function() {
        var fm = cmd.fm,
            name = cmd.name,
            c = 'class',
            disabled = fm.res(c, 'disabled'),
            hover = fm.res(c, 'hover'),
            item = 'elfinder-button-menu-item',
            selected = item + '-selected',
            asc = selected + '-asc',
            desc = selected + '-desc',
            button = $(this).addClass('ui-state-default elfinder-button elfinder-menubutton elfiner-button-' + name)
                .attr('title', cmd.title)
                .append('<span class="elfinder-button-icon elfinder-button-icon-' + name + '"/>')
                .hover(function(e) { !button.is('.' + disabled) && button.toggleClass(hover); })
                .click(function(e) {
                    if (!button.is('.' + disabled)) {
                        e.stopPropagation();
                        menu.is(':hidden') && cmd.fm.getUI().click();
                        menu.slideToggle(100);
                    }
                }),
            menu = $('<div class="ui-widget ui-widget-content elfinder-button-menu ui-corner-all"/>')
                .hide()
                .appendTo(button)
                .zIndex(12 + button.zIndex())
                .delegate('.' + item, 'hover', function() { $(this).toggleClass(hover); })
                .delegate('.' + item, 'click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    hide();
                }),
            update = function() {
                menu.children(':not(:last)').removeClass(selected + ' ' + asc + ' ' + desc)
                    .filter('[rel="' + fm.sortType + '"]')
                    .addClass(selected + ' ' + (fm.sortOrder == 'asc' ? asc : desc));

                menu.children(':last').toggleClass(selected, fm.sortStickFolders);
            },
            hide = function() { menu.hide(); };


        $.each(fm.sortRules, function(name, value) {
            menu.append($('<div class="' + item + '" rel="' + name + '"><span class="ui-icon ui-icon-arrowthick-1-n"/><span class="ui-icon ui-icon-arrowthick-1-s"/>' + fm.i18n('sort' + name) + '</div>').data('type', name));
        });

        menu.children().click(function(e) {
            var type = $(this).attr('rel');

            cmd.exec([], {
                type: type,
                order: type == fm.sortType ? fm.sortOrder == 'asc' ? 'desc' : 'asc' : fm.sortOrder,
                stick: fm.sortStickFolders
            });
        });
        $('<div class="' + item + ' ' + item + '-separated"><span class="ui-icon ui-icon-check"/>' + fm.i18n('sortFoldersFirst') + '</div>')
            .appendTo(menu)
            .click(function() {
                cmd.exec([], { type: fm.sortType, order: fm.sortOrder, stick: !fm.sortStickFolders });
            });

        fm.bind('disable select', hide).getUI().click(hide);

        fm.bind('sortchange', update);

        if (menu.children().length > 1) {
            cmd.change(function() {
                    button.toggleClass(disabled, cmd.disabled());
                    update();
                })
                .change();

        } else {
            button.addClass(disabled);
        }

    });

};
"use strict";
$.fn.elfindermorebutton = function(cmd) {

    return this.each(function() {
        var fm = cmd.fm,
            commands = fm._commands,
            name = cmd.name,
            c = 'class',
            disabled = fm.res(c, 'disabled'),
            hover = fm.res(c, 'hover'),
            item = 'elfinder-button-menu-item',
            includedCommands = ['copy', 'paste', 'rm', 'rename', 'download', 'opensendpopup'],

            button = $(this).addClass('ui-state-default elfinder-button elfinder-menubutton elfiner-button-' + name + ' ui-elfinder-button-last')
                .attr('title', cmd.title)
                .hover(function(e) {
                    !button.is('.' + disabled) && button.toggleClass(hover);
                })
                .click(function(e) {
                    if (!button.is('.' + disabled)) {
                        e.stopPropagation();
                        $.each(menu.children(), function() {
                            var t = $(this).attr('rel');
                            $(this).removeClass(disabled);
                            var com;
                            if (!(com = commands[t]) || com.getstate() != 0) {
                                $(this).addClass(disabled);
                            }
                        });
                        menu.is(':hidden') && cmd.fm.getUI().click();
                        menu.slideToggle(100);
                    }
                }),
            text = $(this).append('<span class="elfinder-button-text">' + cmd.title + '</span>'),
            icon = $(this).append('<span class="caret"></span>'),
            menu = $('<div class="ui-widget ui-widget-content elfinder-button-menu ui-corner-all"/>')
                .hide()
                .appendTo(button)
                .zIndex(12 + button.zIndex())
                .delegate('.' + item, 'hover', function() { !$(this).is('.' + disabled) && $(this).toggleClass(hover); })
                .delegate('.' + item, 'click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    hide();
                }),

            hide = function() { menu.hide(); },

            clearMenu = function() {
                menu.text("");
            },

            initMenu = function() {
                $.each(includedCommands, function(name, value) {
                    menu.append($('<div class="' + item + '" rel="' + value + '"><span class="elfinder-button-icon elfinder-button-icon-' + value + '"/><span class="ui-icon ui-icon-arrowthick-1-s"/>'
                            + fm.i18n('cmd' + value) + '</div>')
                        .click(function(e) {
                            var t = $(this).attr('rel');
                            !$(this).is('.' + disabled) && cmd.exec(t);
                        }));
                });
            },

            addCommand = function(comName) {
                includedCommands.push(comName);
                clearMenu();
                initMenu();
            };

        initMenu();
        fm.bind('disable select', hide).getUI().click(hide);

        if (menu.children().length > 1) {
            cmd.change(function() {
                button.toggleClass(disabled, cmd.disabled());
            }).change();

        } else {
            button.addClass(disabled);
        }
    });

};
$.fn.elfinderpanel = function(fm) {

    return this.each(function() {
        var panel = $(this).addClass('elfinder-panel ui-state-default ui-corner-all'),
            margin = 'margin-' + (fm.direction == 'ltr' ? 'left' : 'right');

        fm.one('load', function(e) {
            var navbar = fm.getUI('navbar');

            panel.css(margin, parseInt(navbar.outerWidth(true)));
            navbar.bind('resize', function() {
                panel.is(':visible') && panel.css(margin, parseInt(navbar.outerWidth(true)));
            });
        });
    });
}
"use strict";
/**
 * @class  elFinder contextmenu
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfindercontextmenu = function(fm) {

    return this.each(function() {
        var menu = $(this).addClass('ui-helper-reset ui-widget ui-state-default ui-corner-all elfinder-contextmenu elfinder-contextmenu-' + fm.direction)
                .hide()
                .appendTo('body')
                .delegate('.elfinder-contextmenu-item', 'mouseenter mouseleave', function() {
                    $(this).toggleClass('ui-state-hover');
                }),
            subpos = fm.direction == 'ltr' ? 'left' : 'right',
            types = $.extend({}, fm.options.contextmenu),
            tpl = '<div class="elfinder-contextmenu-item"><span class="elfinder-button-icon {icon} elfinder-contextmenu-icon"/><span>{label}</span></div>',
            item = function(label, icon, callback) {
                return $(tpl.replace('{icon}', icon ? 'elfinder-button-icon-' + icon : '').replace('{label}', label))
                    .click(function(e) {
                        e.stopPropagation();
                        e.stopPropagation();
                        callback();
                    });
            },

            open = function(x, y) {
                var win = $(window),
                    width = menu.outerWidth(),
                    height = menu.outerHeight(),
                    wwidth = win.width(),
                    wheight = win.height(),
                    scrolltop = win.scrollTop(),
                    scrollleft = win.scrollLeft(),
                    css = {
                        top: (y + height < wheight ? y : y - height > 0 ? y - height : y) + scrolltop,
                        left: (x + width < wwidth ? x : x - width) + scrollleft,
                        'z-index': 100 + fm.getUI('workzone').zIndex()
                    };

                menu.css(css)
                    .show();

                css = { 'z-index': css['z-index'] + 10 };
                css[subpos] = parseInt(menu.width());
                menu.find('.elfinder-contextmenu-sub').css(css);
            },

            close = function() {
                menu.hide().empty();
            },

            create = function(type, targets) {
                var sep = false;


                $.each(types[type] || [], function(i, name) {
                    var cmd, node, submenu;

                    if (name == '|' && sep) {
                        menu.append('<div class="elfinder-contextmenu-separator"/>');
                        sep = false;
                        return;
                    }

                    cmd = fm.command(name);

                    if (cmd && cmd.getstate(targets) != -1) {
                        if (cmd.variants) {
                            if (!cmd.variants.length) {
                                return;
                            }
                            node = item(cmd.title, cmd.name, function() {});

                            submenu = $('<div class="ui-corner-all elfinder-contextmenu-sub"/>')
                                .appendTo(node.append('<span class="elfinder-contextmenu-arrow"/>'));

                            node.addClass('elfinder-contextmenu-group')
                                .hover(function() {
                                    submenu.toggle();
                                });
                            $.each(cmd.variants, function(i, variant) {
                                submenu.append(
                                    $('<div class="elfinder-contextmenu-item"><span>' + variant[1] + '</span></div>')
                                    .click(function(e) {
                                        e.stopPropagation();
                                        close();
                                        cmd.exec(targets, variant[0]);
                                    })
                                );
                            });

                        } else {
                            node = item(cmd.title, cmd.name, function() {
                                close();
                                cmd.exec(targets);
                            });
                        }

                        menu.append(node);
                        sep = true;
                    }
                });
            },

            createFromRaw = function(raw) {
                $.each(raw, function(i, data) {
                    var node;

                    if (data.label && typeof data.callback == 'function') {
                        node = item(data.label, data.icon, function() {
                            close();
                            data.callback();
                        });
                        menu.append(node);
                    }
                });
            };
        $(document).bind('click.' + this.namespace, function(e) { close(); });
        fm.one('load', function() {
            fm.bind('contextmenu', function(e) {
                    var data = e.data;

                    close();

                    if (data.type && data.targets) {
                        create(data.type, data.targets);
                    } else if (data.raw) {
                        createFromRaw(data.raw);
                    }

                    menu.children().length && open(data.x, data.y);
                })
                .one('destroy', function() { menu.remove(); })
                .bind('disable select', close)
                .getUI().click(close);
        });

    });

};
"use strict";
/**
 * @class elFinder ui
 * Display current folder path in statusbar.
 * Click on folder name in path - open folder
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfinderpath = function(fm) {
    return this.each(function() {
        var path = $(this).addClass('elfinder-path').html('&nbsp;')
            .delegate('a', 'click', function(e) {
                var hash = $(this).attr('href').substr(1);

                e.preventDefault();
                hash != fm.cwd().hash && fm.exec('open', hash);
            })
            .prependTo(fm.getUI('statusbar').show());
        fm.bind('open searchend', function() {
                var dirs = [];

                $.each(fm.parents(fm.cwd().hash), function(i, hash) {
                    dirs.push('<a href="#' + hash + '">' + fm.escape(fm.file(hash).name) + '</a>');
                });

                path.html(dirs.join(fm.option('separator')));
            })
            .bind('search', function() {
                path.html(fm.i18n('searcresult'));
            });
    });
};
"use strict";
/**
 * @class elFinder ui
 * Display number of files/selected files and its size in statusbar
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfinderstat = function(fm) {
    return this.each(function() {
        var size = $(this).addClass('elfinder-stat-size'),
            sel = $('<div class="elfinder-stat-selected"/>'),
            titlesize = fm.i18n('size').toLowerCase(),
            titleitems = fm.i18n('items').toLowerCase(),
            titlesel = fm.i18n('selected'),
            setstat = function(files, cwd) {
                var c = 0,
                    s = 0;

                $.each(files, function(i, file) {
                    if (!cwd || file.phash == cwd) {
                        c++;
                        s += parseInt(file.size) || 0;
                    }
                });
                size.html(titleitems + ': ' + c + ', ' + titlesize + ': ' + fm.formatSize(s));
            };

        fm.getUI('statusbar').prepend(size).append(sel).show();

        fm
            .bind('open reload add remove change searchend', function() {
                setstat(fm.files(), fm.cwd().hash);
            })
            .search(function(e) {
                setstat(e.data.files);
            })
            .select(function() {
                var s = 0,
                    c = 0,
                    files = fm.selectedFiles();

                if (files.length == 1) {
                    s = files[0].size;
                    sel.html(fm.escape(files[0].name) + (s > 0 ? ', ' + fm.formatSize(s) : ''));

                    return;
                }

                $.each(files, function(i, file) {
                    c++;
                    s += parseInt(file.size) || 0;
                });

                sel.html(c ? titlesel + ': ' + c + ', ' + titlesize + ': ' + fm.formatSize(s) : '&nbsp;');
            });
    });
};
"use strict";
$.fn.elfinderinfobar = function(fm, opts) {
    this.not('.elfinder-infobar').each(function() {
        var includedCommands = ['rm', 'download', 'opensendpopup'],
            commands = fm._commands,
            com,
            button,
            icon = $('<div class="selectico"><span></span></div>'),
            name = $('<div class="titleblock"><div class="title"></div><div class="rename"></div></div>'),
            lastChange = $('<div class="dateblock">' + fm.i18n('lastchange') + '<span class="datespan"></span><br> '
                + fm.i18n('sizeinfo') + '<span class="sizespan"></span><div class="link"></div></div>'),
            buttons = $('<div class="selectfunc"><div class="visual-btn-box"><a class="visual-btn js-visaulize"></a></div><div class="view left"></div><div class="funcbuttons right"></div></div>'),
            cryptInfo = $('<div class="signature"/>'),

            infoblock = $('<div class="selectinfo"/>').append(name).append(lastChange).append(buttons),
            selblock = $('<div class="selectblock"/>').append(icon).append(infoblock).append(cryptInfo).hide(),
            self = $(this).addClass('ui-widget-header ui-helper-clearfix ui-corner-bottom elfinder-infobar')
                .css('height', '173px')
                .css('font-size', '12px')
                .prepend(selblock);

        $.each(includedCommands, function(i, value) {
            if ((com = commands[value])) {
                button = 'elfinder' + com.options.ui;
                $.fn[button] && buttons.find(".funcbuttons").append($('<div/>')[button](com));
            }
        });

        if ((com = commands['cryptinfo'])) {
            button = 'elfinder' + com.options.ui;
            $.fn[button] && lastChange.find(".link").prepend($('<div/>')[button](com));
        }

        if ((com = commands['rename'])) {
            button = 'elfinderlinkbutton';
            $.fn[button] && name.find(".rename").prepend($('<div/>')[button](com));
        }

        self.prev().length && self.parent().append(this);

    });

    return this;
};
"use strict";
/**
 * @class elFinder places/favorites ui
 *
 * @author Dmitry (dio) Levashov
 **/
$.fn.elfinderplaces = function(fm, opts) {
    return this.each(function() {
        var dirs = [],
            c = 'class',
            navdir = fm.res(c, 'navdir'),
            collapsed = fm.res(c, 'navcollapse'),
            expanded = fm.res(c, 'navexpand'),
            hover = fm.res(c, 'hover'),
            clroot = fm.res(c, 'treeroot'),
            tpl = fm.res('tpl', 'navdir'),
            ptpl = fm.res('tpl', 'perms'),
            spinner = $(fm.res('tpl', 'navspinner')),
            /**
			 * Convert places dir node into dir hash
			 *
			 * @param  String  directory id
			 * @return String
			 **/
            id2hash = function(id) { return id.substr(6); },
            /**
			 * Convert places dir node into dir hash
			 *
			 * @param  String  directory id
			 * @return String
			 **/
            hash2id = function(hash) { return 'place-' + hash; },

            /**
			 * Save current places state
			 *
			 * @return void
			 **/
            save = function() { fm.storage('places', dirs.join(',')); },
            /**
			 * Return node for given dir object
			 *
			 * @param  Object  directory object
			 * @return jQuery
			 **/
            create = function(dir) {
                return $(tpl.replace(/\{id\}/, hash2id(dir.hash))
                    .replace(/\{name\}/, fm.escape(dir.name))
                    .replace(/\{cssclass\}/, fm.perms2class(dir))
                    .replace(/\{permissions\}/, !dir.read || !dir.write ? ptpl : '')
                    .replace(/\{symlink\}/, ''));
            },
            /**
			 * Add new node into places
			 *
			 * @param  Object  directory object
			 * @return void
			 **/
            add = function(dir) {
                var node = create(dir);

                if (subtree.children().length) {
                    $.each(subtree.children(), function() {
                        var current = $(this);

                        if (dir.name.localeCompare(current.children('.' + navdir).text()) < 0) {
                            return !node.insertBefore(current);
                        }
                    });
                }

                dirs.push(dir.hash);
                !node.parent().length && subtree.append(node);
                root.addClass(collapsed);
                node.draggable({
                    appendTo: 'body',
                    revert: false,
                    helper: function() {
                        var dir = $(this);

                        dir.children().removeClass('ui-state-hover');

                        return $('<div class="elfinder-place-drag elfinder-' + fm.direction + '"/>')
                            .append(dir.clone())
                            .data('hash', id2hash(dir.children(':first').attr('id')));

                    },
                    start: function() { $(this).hide(); },
                    stop: function(e, ui) {
                        var top = places.offset().top,
                            left = places.offset().left,
                            width = places.width(),
                            height = places.height(),
                            x = e.clientX,
                            y = e.clientY;

                        if (x > left && x < left + width && y > top && y < y + height) {
                            $(this).show();
                        } else {
                            remove(ui.helper.data('hash'));
                            save();
                        }
                    }
                });
            },
            /**
			 * Remove dir from places
			 *
			 * @param  String  directory id
			 * @return void
			 **/
            remove = function(hash) {
                var ndx = $.inArray(hash, dirs);

                if (ndx !== -1) {
                    dirs.splice(ndx, 1);
                    subtree.find('#' + hash2id(hash)).parent().remove();
                    !subtree.children().length && root.removeClass(collapsed + ' ' + expanded);
                }
            },
            /**
			 * Remove all dir from places
			 *
			 * @return void
			 **/
            clear = function() {
                subtree.empty();
                root.removeClass(collapsed + ' ' + expanded);
            },
            /**
			 * Node - wrapper for places root
			 *
			 * @type jQuery
			 **/
            wrapper = create({
                hash: 'root-' + fm.namespace,
                name: fm.i18n(opts.name, 'places'),
                read: true,
                write: true
            }),
            /**
			 * Places root node
			 *
			 * @type jQuery
			 **/
            root = wrapper.children('.' + navdir)
                .addClass(clroot)
                .click(function() {
                    if (root.is('.' + collapsed)) {
                        places.toggleClass(expanded);
                        subtree.slideToggle();
                        fm.storage('placesState', places.is('.' + expanded) ? 1 : 0);
                    }
                }),
            /**
			 * Container for dirs
			 *
			 * @type jQuery
			 **/
            subtree = wrapper.children('.' + fm.res(c, 'navsubtree')),
            /**
			 * Main places container
			 *
			 * @type jQuery
			 **/
            places = $(this).addClass(fm.res(c, 'tree') + ' elfinder-places ui-corner-all')
                .hide()
                .append(wrapper)
                .appendTo(fm.getUI('navbar'))
                .delegate('.' + navdir, 'hover', function() {
                    $(this).toggleClass('ui-state-hover');
                })
                .delegate('.' + navdir, 'click', function(e) {
                    fm.exec('open', $(this).attr('id').substr(6));
                })
                .delegate('.' + navdir + ':not(.' + clroot + ')', 'contextmenu', function(e) {
                    var hash = $(this).attr('id').substr(6);

                    e.preventDefault();

                    fm.trigger('contextmenu', {
                        raw: [
                            {
                                label: fm.i18n('rmFromPlaces'),
                                icon: 'rm',
                                callback: function() {
                                    remove(hash);
                                    save();
                                }
                            }
                        ],
                        'x': e.clientX,
                        'y': e.clientY
                    });
                })
                .droppable({
                    tolerance: 'pointer',
                    accept: '.elfinder-cwd-file-wrapper,.elfinder-tree-dir,.elfinder-cwd-file',
                    hoverClass: fm.res('class', 'adroppable'),
                    drop: function(e, ui) {
                        var resolve = true;

                        $.each(ui.helper.data('files'), function(i, hash) {
                            var dir = fm.file(hash);

                            if (dir && dir.mime == 'directory' && $.inArray(dir.hash, dirs) === -1) {
                                add(dir);
                            } else {
                                resolve = false;
                            }
                        });
                        save();
                        resolve && ui.helper.hide();
                    }
                });


        // on fm load - show places and load files from backend
        fm.one('load', function() {
            if (fm.oldAPI) {
                return;
            }

            places.show().parent().show();

            dirs = $.map(fm.storage('places').split(','), function(hash) { return hash || null; });

            if (dirs.length) {
                root.prepend(spinner);

                fm.request({
                        data: { cmd: 'info', targets: dirs },
                        preventDefault: true
                    })
                    .done(function(data) {
                        dirs = [];
                        $.each(data.files, function(i, file) {
                            file.mime == 'directory' && add(file);
                        });
                        save();
                        if (fm.storage('placesState') > 0) {
                            root.click();
                        }
                    })
                    .always(function() {
                        spinner.remove();
                    });
            }


            fm.remove(function(e) {
                    $.each(e.data.removed, function(i, hash) {
                        remove(hash);
                    });
                    save();
                })
                .change(function(e) {
                    $.each(e.data.changed, function(i, file) {
                        if ($.inArray(file.hash, dirs) !== -1) {
                            remove(file.hash);
                            file.mime == 'directory' && add(file);
                        }
                    });
                    save();
                })
                .bind('sync', function() {
                    if (dirs.length) {
                        root.prepend(spinner);

                        fm.request({
                                data: { cmd: 'info', targets: dirs },
                                preventDefault: true
                            })
                            .done(function(data) {
                                $.each(data.files || [], function(i, file) {
                                    if ($.inArray(file.hash, dirs) === -1) {
                                        remove(file.hash);
                                    }
                                });
                                save();
                            })
                            .always(function() {
                                spinner.remove();
                            });
                    }
                });
        });
    });
};
"use strict";
$.fn.elfinderlinkbutton = function(cmd, thumb, buttontext) {
    return this.each(function() {
        var c = 'class',
            fm = cmd.fm,
            disabled = fm.res(c, 'disabled'),
            active = fm.res(c, 'active'),
            hover = fm.res(c, 'hover'),
            button = $(this).addClass('ui-state-default elfinder-button elfinder-link-button')
                .attr('title', buttontext ? buttontext.replace(/<\/?[^>]+>/gi, '') : cmd.title)
                .hover(function(e) {
                    !button.is('.' + disabled) && button[e.type == 'mouseleave' ? 'removeClass' : 'addClass'](hover);
                })
                .click(function(e) {
                    var t = $(this).attr('rel');
                    if (!button.is('.' + disabled)) {
                        if (t) cmd.exec(t);
                        else cmd.exec();
                    }
                }),
            linktext = '<a class="elfinder-button-text">{text}</a>';
        linktext = linktext.replace('{text}', buttontext ? buttontext : cmd.title);
        $(this).append(linktext);
        if (thumb)button.attr('rel', thumb);

        cmd.change(function() {
                if (cmd.disabled()) {
                    button.removeClass(active + ' ' + hover).addClass(disabled);
                } else {
                    button.removeClass(disabled);
                    button[cmd.active() ? 'addClass' : 'removeClass'](active);
                }
            })
            .change();
    });
};
"use strict";
$.fn.elfinderfilterbutton = function(cmd) {
    return this.each(function() {
        //if (cmd.filterFolder != '') {
        //    cmd.filterState = cmd.filterFolder == cmd.fm.cwd().hash ? cmd.filterState : 'All';
        //} else {
        //    cmd.filterState = 'All';
        //}

        var fm = cmd.fm,
            result = false,
            c = 'class',
            name = cmd.name,
            disabled = fm.res(c, 'disabled'),
            hover = fm.res(c, 'hover'),
            item = 'elfinder-button-menu-item',
            filter = function(val) {
                if (val) {
                    cmd.exec(val).done(function() {
                        result = true;
                    });
                } else {
                    cmd.fm.trigger('filterend');
                }
            },
            filters = ['All', 'Crypt', 'Sign', 'NotCryptSign'],
            abort = function() {
                if (result) {
                    result = false;
                    cmd.fm.trigger('filterend');
                }
            },
            button = $(this).addClass('ui-state-default elfinder-button elfinder-menubutton elfiner-button-' + name + ' ui-elfinder-button-last')
                .attr('title', cmd.title),
            text = $('<div class="btn-group open elfinder-link-button"><a class="filter">' + fm.i18n('filter' + cmd.filterState) + '</a></div>')
                .click(function(e) {
                    if (!button.is('.' + disabled)) {
                        e.stopPropagation();
                        menu.is(':hidden') && cmd.fm.getUI().click();
                        menu.slideToggle(100);
                    }
                })
                .appendTo(button)
                .hover(function(e) {
                    !button.is('.' + disabled) && button.toggleClass(hover);
                }),
            mtext = $('<label class="left">' + cmd.title + '</label>').appendTo(button),

            menu = $('<div class="ui-widget ui-widget-content elfinder-button-menu ui-corner-all"/>')
                .hide()
                .appendTo(button)
                .zIndex(12 + button.zIndex())
                .delegate('.' + item, 'hover', function() { $(this).toggleClass(hover); })
                .delegate('.' + item, 'click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    hide();
                }),
            hide = function() { menu.hide(); },
            clearMenu = function() {
                menu.text("");
            },
            initMenu = function() {
                $.each(filters, function(i, value) {
                    menu.append($('<div class="' + item + '" rel="' + value + '">'
                            + fm.i18n('filter' + value) + '</div>')
                        .click(function(e) {
                            var t = $(this).attr('rel');
                            cmd.filterState = t;

                            cmd.filterFolder = fm.cwd().hash;
                            $($.find('.btn-group a.filter')).text(fm.i18n('filter' + t));
                            filter(t);
                        }));
                });
            };

        initMenu();
        fm.bind('disable select', hide).getUI().click(hide);

        if (menu.children().length > 1) {
            cmd.change(function() {
                button.toggleClass(disabled, cmd.disabled());
            }).change();

        } else {
            button.addClass(disabled);
        }

        cmd.fm
            .error(function() {
                //input.unbind('keydown');
            })
            .select(function() {
                //input.blur();
            })
            .bind('filterend', function() {
                cmd.filterState = 'NotCryptSign';
                $('.btn-group.open.elfinder-link-button a.filter').text(fm.i18n('filter' + 'NotCryptSign'));
            });
        //.viewchange(abort);
    });
};
"use strict";
$.fn.elfindercryptxdialog = function(opts) {
    var dialog, modal;

    if (typeof (opts) == 'string' && (dialog = this.closest('.window.alert')).length && (modal = dialog.parent('#modal')).length) {
        if (opts == 'open') {
            modal.css('display') == 'none' && modal.fadeIn(120, function() {
                dialog.trigger('open');
            });
        } else if (opts == 'close') {
            modal.css('display') != 'none' && modal.hide() && dialog.trigger('close');
        } else if (opts == 'destroy') {
            modal.hide().remove();
        } else if (opts == 'toTop') {
            //modal.trigger('totop');
        }
    }

    opts = $.extend({}, $.fn.elfindercryptxdialog.defaults, opts);

    this.filter(':not(.content, .content-group)').each(function() {
        var parent = $(this).parent(),
            self = $('<div/>').addClass('content'),
            messagepan = $('<div id="message-panel"/>').appendTo(self),
            contgr = $(this).addClass("content-group mess-box").appendTo(messagepan),
            modal = $('<div/>').attr('id', 'modal').hide().appendTo(parent),
            clactive = 'elfinder-dialog-active',
            cldialog = 'elfinder-dialog',
            clnotify = 'elfinder-dialog-notify',
            clhover = 'ui-state-hover',
            id = parseInt(Math.random() * 1000000),
            buttonset = $('<div class="btn-group"/>'),

            dialog = $('<div class="window alert ' + cldialog + ' ' + opts.cssClass + '"/>') //ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable std42-dialog 
                .append(self)
                .appendTo(modal)
                .bind('open', function() {
                    typeof (opts.open) == 'function' && $.proxy(opts.open, self[0])();
                })
                .bind('close', function() {
                    setTimeout(function() {
                        parent.mousedown().click();
                    }, 10);

                    if (typeof (opts.close) == 'function') {
                        $.proxy(opts.close, self[0])();
                    } else if (opts.destroyOnClose) {
                        modal.hide().remove();
                    }
                })
                .data({ modal: opts.modal });


        if (opts.closeOnEscape) {
            $(document).bind('keyup.' + id, function(e) {
                if (e.keyCode == $.ui.keyCode.ESCAPE && dialog.is('.' + clactive)) {
                    self.elfindercryptxdialog('close');
                    $(document).unbind('keyup.' + id);
                }
            });
        }
        dialog.prepend(
            $('<div class="header"><h2>' + opts.title + '</h2></div>')
            .prepend($('<div class="close"></div>')
                .mousedown(function(e) {
                    e.preventDefault();
                    self.elfindercryptxdialog('close');
                }))
        );

        $.each(opts.buttons, function(name, cb) {
            var button;
            if (name.indexOf("Отмена") == -1) button = $('<div class="btn btn-green">' + name + '</div>');
            else button = $('<div class="btn">' + name + '</div>');
            //var button = $('<button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text">' + name + '</span></button>')
            button
                .click($.proxy(cb, self[0]))
                .hover(function(e) { $(this)[e.type == 'mouseenter' ? 'focus' : 'blur'](); })
                .focus(function() { $(this).addClass(clhover); })
                .blur(function() { $(this).removeClass(clhover); })
                .keydown(function(e) {
                    var next;

                    if (e.keyCode == $.ui.keyCode.ENTER) {
                        $(this).click();
                    } else if (e.keyCode == $.ui.keyCode.TAB) {
                        next = $(this).next('.ui-button');
                        next.length ? next.focus() : $(this).parent().children('.ui-button:first').focus();
                    }
                });
            buttonset.prepend(button);
        });

        buttonset.children().length && messagepan.append(buttonset);

        typeof (opts.create) == 'function' && $.proxy(opts.create, this)();

        opts.autoOpen && self.elfindercryptxdialog('open');

    });

    return this;
};
$.fn.elfindercryptxdialog.defaults = {
    cssClass: '',
    title: '',
    modal: false,
    resizable: true,
    autoOpen: true,
    closeOnEscape: true,
    destroyOnClose: false,
    buttons: {},
    position: null,
    width: 320,
    height: 'auto',
    minWidth: 200,
    minHeight: 110
};
"use strict";
$.fn.elfinderbottomaddpanel = function(fm, opts) {
    this.not('.elfinder-bottomaddpanel').each(function() {
        var c = 'class',
            green = 'ui-elfinder-button-green',
            mainclass = 'ui-widget-content ui-corner-all elfinder-buttonset',
            disabled = fm.res(c, 'disabled'),
            hover = fm.res(c, 'hover'),
            commands = fm._commands,
            cmd = commands['add'],
            buttons = $('<div class="buttons"/>'),
            cancelB = $('<div class="elfinder-buttonset">' +
                    '<div class="ui-state-default elfinder-button elfinder-link-button" title="' + fm.i18n('cmdcancel') + '">' +
                    '<a class="elfinder-button-text">' + fm.i18n('cmdcancel2') + '</a></div>' +
                    '</div>')
                .click(function() {
                    if (parent.Master && parent.Master.OpenFilesEventHandler) {
                        parent.Master.OpenFilesEventHandler('close');
                    }
                }),
            addBut = $('<div class="elfinder-buttonset btn btn-big btn-green">' + fm.i18n('cmdadd') + '</div>')
                .click(function() {
                    if (!addBut.is('.' + disabled) && cmd) {
                        cmd.exec();
                    }
                }),
            self = $(this).addClass('ui-widget-header ui-helper-clearfix ui-corner-bottom elfinder-bottomaddpanel')
                .css('height', '38px')
                .css('font-size', '12px')
                .prepend(buttons);


        cmd.change(function() {
                if (cmd.disabled()) {
                    addBut.removeClass(hover).addClass(disabled);
                } else {
                    addBut.removeClass(disabled);
                }
            })
            .change();

        buttons.prepend(cancelB);
        buttons.append(addBut);
        //$.each(includedCommands, function (name, value) {
        //    var cmd, button, div=$("<div/>");
        //    if ((cmd = commands[value])) {
        //        div.addClass(mainclass);
        //        if (value == 'add') div.addClass(green);
        //        button = 'elfinder' + cmd.options.ui;
        //        $.fn[button] && div.prepend($('<div/>')[button](cmd)) && buttons.append(div);
        //    }
        //});

        self.prev().length && self.parent().append(this) && self.show();
    });

    return this;
};

$.fn.elfindermultiplyaddbutton = function (cmd) {
	
	return this.each(function() {
	    var fm = cmd.fm,
	        commands = fm._commands,
	        name = cmd.name,
	        c = 'class',
	        disabled = fm.res(c, 'disabled'),
	        hover = fm.res(c, 'hover'),
	        item = 'elfinder-button-menu-item',
	        includedCommands = ['upload', 'mkdir', 'paste'],

            button = $(this).addClass('elfinder-buttonset btn btn-big btn-green')
	            .attr('title', cmd.title)
	            .hover(function(e) {
	                !button.is('.' + disabled) && button.toggleClass(hover);
	            })
	            .click(function(e) {
	                if (!button.is('.' + disabled)) {
	                    e.stopPropagation();
	                    $.each(menu.children(), function() {
	                        var t = $(this).attr('rel');
	                        $(this).removeClass(disabled);
	                        $(this).removeClass(hover);
	                        var com;
	                        if (!(com = commands[t]) || com.getstate() != 0) {
	                            $(this).addClass(disabled);
	                        }
	                    });
	                    menu.is(':hidden') && cmd.fm.getUI().click();
	                    menu.slideToggle(100);
	                }
	            }),
            text = $(this).append('<span class="elfinder-button-text">' + cmd.title + '</span>'),
            //icon = $(this).append('<span class="caret"></span>'),
	        menu = $('<div class="ui-widget ui-widget-content elfinder-button-menu ui-corner-all"/>')
	            .hide()
	            .appendTo(button)
	            .zIndex(12 + button.zIndex())
	            .delegate('.' + item, 'hover', function() {
	                !$(this).is('.' + disabled) && $(this).toggleClass(hover);
	            })
	            .delegate('.' + item, 'click', function(e) {
	                var t = $(this).attr('rel');
	                if (t!='upload') {
	                    e.preventDefault();
	                    e.stopPropagation();

	                } else {
                        e.preventDefault();
                        e.stopPropagation();
                        $('.js-upload').click();
                    }
                    hide();
                    return false;
	            }),
	        
	        hide = function() { menu.hide(); },

            clearMenu = function () {
                menu.text("");
            },

            initMenu = function () {
                $.each(includedCommands, function (name, value) {
                    if (value == 'upload') {
                        var com;
                        if ((com = commands[value])) {
                            var form = $('<form style="overflow: hidden"/>'),
                                input = $('<input type="file" multiple="true" style="" class="js-upload" />')
				                    .change(function () {
				                        var _input = $(this);
				                        if (_input.val()) {
				                            com.exec({ input: _input.remove()[0] });
				                            input.clone(true).appendTo(form);
				                        }
				                    }).click(function(){menu.hide();}),
                                but = $('<div class="' + item + '" rel="' + value + '"><span class="elfinder-button-icon elfinder-button-icon-'
                                + value + '"/><span class="ui-icon ui-icon-arrowthick-1-s"/>' + fm.i18n('add' + value) + '</div>');
                            form.append(input.clone(true));
                            menu.append(but).parent().append(form);
                            com.change(function () {
                                form[com.disabled() ? 'hide' : 'show']();
                            })
		                    .change();

                        }
                    } else {
                        menu.append($('<div class="' + item + '" rel="' + value + '"><span class="elfinder-button-icon elfinder-button-icon-'
                            + value + '"/><span class="ui-icon ui-icon-arrowthick-1-s"/>' + fm.i18n('add' + value) + '</div>')
                            .click(function(e) {
                                var t = $(this).attr('rel');
                                !$(this).is('.' + disabled) && cmd.exec(t);
                            }));
                    }
                });
            },

            addCommand = function (comName) {
                includedCommands.push(comName);
                clearMenu();
                initMenu();
            };

	    initMenu();
	    fm.bind('disable select', hide).getUI().click(hide);

	    if (menu.children().length > 1) {
	        cmd.change(function () {
	            button.toggleClass(disabled, cmd.disabled());
	        }).change();

	    } else {
	        button.addClass(disabled);
	    }
	});
	
}



"use strict";
/**
 * @class  elFinder command "back"
 * Open last visited folder
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.back = function() {
    this.alwaysEnabled = true;
    this.updateOnSelect = false;
    this.shortcuts = [
        {
            pattern: 'ctrl+left backspace'
        }
    ];

    this.getstate = function() {
        return this.fm.history.canBack() ? 0 : -1;
    };
    this.exec = function() {
        return this.fm.history.back();
    };
};
/**
 * @class  elFinder command "forward"
 * Open next visited folder
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.forward = function() {
    this.alwaysEnabled = true;
    this.updateOnSelect = true;
    this.shortcuts = [
        {
            pattern: 'ctrl+right'
        }
    ];

    this.getstate = function() {
        return this.fm.history.canForward() ? 0 : -1;
    };
    this.exec = function() {
        return this.fm.history.forward();
    };
}
/**
 * @class  elFinder command "reload"
 * Sync files and folders
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.reload = function() {

    this.alwaysEnabled = true;
    this.updateOnSelect = true;

    //this.shortcuts = [{
    //	pattern     : 'ctrl+shift+r f5'
    //}];

    this.getstate = function() {
        return 0;
    };
    this.exec = function() {
        var fm = this.fm,
            dfrd = fm.sync(),
            timeout = setTimeout(function() {
                fm.notify({ type: 'reload', cnt: 1, hideCnt: true });
                dfrd.always(function() { fm.notify({ type: 'reload', cnt: -1 }); });
            }, fm.notifyDelay);

        return dfrd.always(function() {
            clearTimeout(timeout);
            fm.trigger('reload');
        });
    };
}
"use strict";
/**
 * @class  elFinder command "up"
 * Go into parent directory
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.up = function() {
    this.alwaysEnabled = true;
    this.updateOnSelect = false;

    this.shortcuts = [
        {
            pattern: 'ctrl+up'
        }
    ];

    this.getstate = function() {
        return this.fm.cwd().phash ? 0 : -1;
    };
    this.exec = function() {
        return this.fm.cwd().phash ? this.fm.exec('open', this.fm.cwd().phash) : $.Deferred().reject();
    };
};

elFinder.prototype.commands.home = function() {
    this.title = 'Home';
    this.alwaysEnabled = true;
    this.updateOnSelect = false;
    this.shortcuts = [
        {
            pattern: 'ctrl+home ctrl+shift+up',
            description: 'Home'
        }
    ];

    this.getstate = function() {
        var root = this.fm.root(),
            cwd = this.fm.cwd().hash;

        return root && cwd && root != cwd ? 0 : -1;
    };
    this.exec = function() {
        return this.fm.exec('open', this.fm.root());
    };
}
"use strict";
/**
 * @class elFinder command "copy".
 * Put files in filemanager clipboard.
 *
 * @type  elFinder.command
 * @author  Dmitry (dio) Levashov
 */
elFinder.prototype.commands.copy = function() {

    this.shortcuts = [
        {
            pattern: 'ctrl+c ctrl+insert'
        }
    ];

    this.getstate = function(sel) {
        var sel = this.files(sel),
            cnt = sel.length;

        return cnt && $.map(sel, function(f) { return f.phash && f.read ? f : null; }).length == cnt ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            dfrd = $.Deferred()
                .fail(function(error) {
                    fm.error(error);
                });

        $.each(this.files(hashes), function(i, file) {
            if (!(file.read && file.phash)) {
                return !dfrd.reject(['errCopy', file.name, 'errPerm']);
            }
        });

        return dfrd.state() == 'rejected' ? dfrd : dfrd.resolve(fm.clipboard(this.hashes(hashes)));
    };
};
"use strict";
/**
 * @class  elFinder command "paste"
 * Paste filesfrom clipboard into directory.
 * If files pasted in its parent directory - files duplicates will created
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.paste = function() {
    this.updateOnSelect = false;

    this.handlers = {
        changeclipboard: function() { this.update(); }
    };
    this.shortcuts = [
        {
            pattern: 'ctrl+v shift+insert'
        }
    ];

    this.getstate = function(dst) {
        if (this._disabled) {
            return -1;
        }
        if (dst) {
            if ($.isArray(dst)) {
                if (dst.length != 1) {
                    return -1;
                }
                dst = this.fm.file(dst[0]);
            }
        } else {
            dst = this.fm.cwd();
        }

        return this.fm.clipboard().length && dst.mime == 'directory' && dst.write ? 0 : -1;
    };
    this.exec = function(dst) {
        var self = this,
            fm = self.fm,
            dst = dst ? this.files(dst)[0] : fm.cwd(),
            files = fm.clipboard(),
            cnt = files.length,
            cut = cnt ? files[0].cut : false,
            error = cut ? 'errMove' : 'errCopy',
            fpaste = [],
            fcopy = [],
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                }),
            copy = function(files) {
                return files.length && fm._commands.duplicate
                    ? fm.exec('duplicate', files)
                    : $.Deferred().resolve();
            },
            paste = function(files) {
                var dfrd = $.Deferred(),
                    existed = [],
                    intersect = function(files, names) {
                        var ret = [],
                            i = files.length;

                        while (i--) {
                            $.inArray(files[i].name, names) !== -1 && ret.unshift(i);
                        }
                        return ret;
                    },
                    confirm = function(ndx) {
                        var i = existed[ndx],
                            file = files[i],
                            last = ndx == existed.length - 1;

                        if (!file) {
                            return;
                        }

                        fm.confirm({
                            title: fm.i18n(cut ? 'moveFiles' : 'copyFiles'),
                            text: fm.i18n(['errExists', file.name, 'confirmRepl']),
                            all: !last,
                            accept: {
                                label: 'btnYes',
                                callback: function(all) {
                                    !last && !all
                                        ? confirm(++ndx)
                                        : paste(files);
                                }
                            },
                            reject: {
                                label: 'btnNo',
                                callback: function(all) {
                                    var i;

                                    if (all) {
                                        i = existed.length;
                                        while (ndx < i--) {
                                            files[existed[i]].dublicate = true;
                                        }
                                    } else {
                                        files[existed[ndx]].dublicate = true;
                                    }

                                    !last && !all
                                        ? confirm(++ndx)
                                        : paste(files);
                                }
                            },
                            cancel: {
                                label: 'btnCancel',
                                callback: function() {
                                    dfrd.resolve();
                                }
                            }
                        });
                    },
                    valid = function(names) {
                        existed = intersect(files, names);
                        existed.length ? confirm(0) : paste(files);
                    },
                    paste = function(files) {
                        var //files  = $.map(files, function(file) { return !file.remove ? file : null } ),
                            cnt = files.length,
                            groups = {},
                            args = [],
                            dublicateIndexes = [],
                            src;

                        if (!cnt) {
                            return dfrd.resolve();
                        }

                        src = files[0].phash;
                        dublicateIndexes = $.map(files, function(f, i) { return f.dublicate ? i : null; });
                        files = $.map(files, function(f) { return f.hash; });

                        fm.request({
                                data: { cmd: 'paste', dst: dst.hash, targets: files, cut: cut ? 1 : 0, src: src, dublindexes: dublicateIndexes },
                                notify: { type: cut ? 'move' : 'copy', cnt: cnt }
                            })
                            .always(function() {
                                dfrd.resolve();
                                fm.unlockfiles({ files: files });
                            });
                    };

                if (self._disabled || !files.length) {
                    return dfrd.resolve();
                }


                if (fm.oldAPI) {
                    paste(files);
                } else {

                    if (!fm.option('copyOverwrite')) {
                        paste(files);
                    } else {

                        dst.hash == fm.cwd().hash
                            ? valid($.map(fm.files(), function(file) { return file.phash == dst.hash ? file.name : null; }))
                            : fm.request({
                                data: { cmd: 'ls', target: dst.hash },
                                notify: { type: 'prepare', cnt: 1, hideCnt: true },
                                preventFail: true
                            })
                            .always(function(data) {
                                valid(data.list || []);
                            });
                    }
                }

                return dfrd;
            },
            parents,
            fparents;


        if (!cnt || !dst || dst.mime != 'directory') {
            return dfrd.reject();
        }

        if (!dst.write) {
            return dfrd.reject([error, files[0].name, 'errPerm']);
        }

        parents = fm.parents(dst.hash);

        $.each(files, function(i, file) {
            if (!file.read) {
                return !dfrd.reject([error, files[0].name, 'errPerm']);
            }

            if (cut && file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }

            if ($.inArray(file.hash, parents) !== -1) {
                return !dfrd.reject(['errCopyInItself', file.name]);
            }

            fparents = fm.parents(file.hash);
            fparents.pop();
            if ($.inArray(dst.hash, fparents) !== -1) {

                if ($.map(fparents, function(h) {
                    var d = fm.file(h);
                    return d.phash == dst.hash && d.name == file.name ? d : null;
                }).length) {
                    return !dfrd.reject(['errReplByChild', file.name]);
                }
            }

            if (file.phash == dst.hash) {
                fcopy.push(file.hash);
            } else {
                fpaste.push({
                    hash: file.hash,
                    phash: file.phash,
                    name: file.name
                });
            }
        });

        if (dfrd.state() == 'rejected') {
            return dfrd;
        }

        return $.when(
            copy(fcopy),
            paste(fpaste)
        ).always(function() {
            cut && fm.clipboard([]);
        });
    };
};
"use strict"; /**
 * @class  elFinder command "open"
 * Enter folder or open files in new windows
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.open = function() {
    this.alwaysEnabled = true;

    this._handlers = {
        dblclick: function(e) {
            e.preventDefault();
            if (e.data && e.data.file && e.data.file != "") this.exec(e.data.file);
            else this.exec();
        },
        'select enable disable reload': function(e) { this.update(e.type == 'disable' ? -1 : void(0)); }
    };
    this.shortcuts = [
        {
            pattern: 'ctrl+down numpad_enter' + (this.fm.OS != 'mac' && ' enter')
        }
    ];

    this.getstate = function(sel) {
        var sel = this.files(sel),
            cnt = sel.length;

        return cnt == 1
            ? 0
            : cnt ? ($.map(sel, function(file) { return file.mime == 'directory' ? null : file; }).length == cnt ? 0 : -1) : -1;
    };
    this.exec = function(hashes) {

        var fm = this.fm,
            dfrd = $.Deferred().fail(function(error) { error && fm.error(error); }),
            files = this.files(hashes),
            cnt = files.length,
            file,
            url,
            s,
            w;

        if (!cnt) {
            return dfrd.reject();
        }

        // open folder
        if (cnt == 1 && (file = files[0]) && file.mime == 'directory') {
            return file && !file.read
                ? dfrd.reject(['errOpen', file.name, 'errPerm'])
                : fm.request({
                    data: { cmd: 'open', target: file.thash || file.hash },
                    notify: { type: 'open', cnt: 1, hideCnt: true },
                    syncOnFail: true
                });
        }

        //if (fm.isModal) {
        return dfrd.reject();
        //}

        files = $.map(files, function(file) { return file.mime != 'directory' ? file : null; });

        // nothing to open or files and folders selected - do nothing
        if (cnt != files.length) {
            return dfrd.reject();
        }

        // open files
        cnt = files.length;
        while (cnt--) {
            file = files[cnt];

            if (!file.read) {
                return dfrd.reject(['errOpen', file.name, 'errPerm']);
            }

            if (!(url = fm.url( /*file.thash || */file.hash))) {
                url = fm.options.url;
                url = url + (url.indexOf('?') === -1 ? '?' : '&')
                    + (fm.oldAPI ? 'cmd=open&current=' + file.phash : 'cmd=file')
                    + '&target=' + file.hash;
            }

            // set window size for image if set
            if (file.dim) {
                s = file.dim.split('x');
                w = 'width=' + (parseInt(s[0]) + 20) + ',height=' + (parseInt(s[1]) + 20);
            } else {
                w = 'width=' + parseInt(2 * $(window).width() / 3) + ',height=' + parseInt(2 * $(window).height() / 3);
            }

            var wnd = window.open('', 'new_window', w + ',top=50,left=50,scrollbars=yes,resizable=yes');
            if (!wnd) {
                return dfrd.reject('errPopup');
            }

            var form = document.createElement("form");
            form.action = fm.options.url;
            form.method = 'POST';
            form.target = 'new_window';
            form.style.display = 'none';
            var params = $.extend({}, fm.options.customData, {
                cmd: 'file',
                target: file.hash
            });
            $.each(params, function(key, val) {
                var input = document.createElement("input");
                input.name = key;
                input.value = val;
                form.appendChild(input);
            });

            document.body.appendChild(form);
            form.submit();
        }
        return dfrd.resolve(hashes);
    };
};
"use strict"; /**
 * @class  elFinder command "rm"
 * Delete files
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.rm = function() {

    this.shortcuts = [
        {
            pattern: 'delete ctrl+backspace'
        }
    ];

    this.getstate = function(sel) {
        var fm = this.fm;
        sel = sel || fm.selected();
        return !this._disabled && sel.length && $.map(sel, function(h) {
                var f = fm.file(h);
                return f && f.phash && !f.locked ? h : null;
            }).length == sel.length
            ? 0 : -1;
    };
    this.exec = function(hashes) {
        var self = this,
            fm = this.fm,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                }),
            files = this.files(hashes),
            cnt = files.length,
            cwd = fm.cwd().hash,
            goroot = false;

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.phash) {
                return !dfrd.reject(['errRm', file.name, 'errPerm']);
            }
            if (file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }
            if (file.hash == cwd) {
                goroot = fm.root(file.hash);
            }
        });

        if (dfrd.state() == 'pending') {
            files = this.hashes(hashes);

            fm.confirm({
                title: 'Внимание!',
                text: 'confirmRm',
                accept: {
                    label: 'btnRm',
                    callback: function() {
                        fm.lockfiles({ files: files });
                        fm.request({
                                data: { cmd: 'rm', targets: files },
                                notify: { type: 'rm', cnt: cnt },
                                preventFail: true
                            })
                            .fail(function(error) {
                                dfrd.reject(error);
                            })
                            .done(function(data) {
                                    dfrd.done(data);
                                    goroot && fm.exec('open', goroot);
                                }
                            ).always(function() {
                                fm.unlockfiles({ files: files });
                            });
                    }
                },
                cancel: {
                    label: 'btnCancel',
                    callback: function() { dfrd.reject(); }
                }
            });
        }

        return dfrd;
    };
};
"use strict";
/**
 * @class elFinder command "info". 
 * Display dialog with file properties.
 *
 * @author Dmitry (dio) Levashov, dio@std42.ru
 **/
elFinder.prototype.commands.info = function() {
    var m = 'msg',
        fm = this.fm,
        spclass = 'elfinder-info-spinner',
        msg = {
            calc: fm.i18n('calc'),
            size: fm.i18n('size'),
            unknown: fm.i18n('unknown'),
            path: fm.i18n('path'),
            aliasfor: fm.i18n('aliasfor'),
            modify: fm.i18n('modify'),
            perms: fm.i18n('perms'),
            locked: fm.i18n('locked'),
            dim: fm.i18n('dim'),
            kind: fm.i18n('kind'),
            files: fm.i18n('files'),
            folders: fm.i18n('folders'),
            items: fm.i18n('items'),
            yes: fm.i18n('yes'),
            no: fm.i18n('no'),
            link: fm.i18n('link')
        };

    this.tpl = {
        main: '<div class="ui-helper-clearfix elfinder-info-title"><span class="elfinder-cwd-icon {class} ui-corner-all"/>{title}</div><table class="elfinder-info-tb">{content}</table>',
        itemTitle: '<strong>{name}</strong><span class="elfinder-info-kind">{kind}</span>',
        groupTitle: '<strong>{items}: {num}</strong>',
        row: '<tr><td>{label} : </td><td>{value}</td></tr>',
        spinner: '<span>{text}</span> <span class="' + spclass + '"/>'
    };
    this.alwaysEnabled = true;
    this.updateOnSelect = false;
    this.shortcuts = [
        {
            pattern: 'ctrl+i'
        }
    ];

    this.init = function() {
        $.each(msg, function(k, v) {
            msg[k] = fm.i18n(v);
        });
    };
    this.getstate = function() {
        return 0;
    };
    this.exec = function(hashes) {
        var files = this.files(hashes);
        if (! files.length) {
            files = this.files([this.fm.cwd().hash]);
        }
        var self = this,
            fm = this.fm,
            o = this.options,
            tpl = this.tpl,
            row = tpl.row,
            cnt = files.length,
            content = [],
            view = tpl.main,
            l = '{label}',
            v = '{value}',
            opts = {
                title: this.title,
                width: 'auto',
                close: function() { $(this).elfinderdialog('destroy'); }
            },
            count = [],
            replSpinner = function(msg) { dialog.find('.' + spclass).parent().text(msg); },
            id = fm.namespace + '-info-' + $.map(files, function(f) { return f.hash; }).join('-'),
            dialog = fm.getUI().find('#' + id),
            size,
            tmb,
            file,
            title,
            dcnt;

        if (!cnt) {
            return $.Deferred().reject();
        }

        if (dialog.length) {
            dialog.elfinderdialog('toTop');
            return $.Deferred().resolve();
        }


        if (cnt == 1) {
            file = files[0];

            view = view.replace('{class}', fm.mime2class(file.mime));
            title = tpl.itemTitle.replace('{name}', fm.escape(file.i18 || file.name)).replace('{kind}', fm.mime2kind(file));

            if (file.tmb) {
                tmb = fm.option('tmbUrl') + file.tmb;
            }

            if (!file.read) {
                size = msg.unknown;
            } else if (file.mime != 'directory' || file.alias) {
                size = fm.formatSize(file.size);
            } else {
                size = tpl.spinner.replace('{text}', msg.calc);
                count.push(file.hash);
            }

            content.push(row.replace(l, msg.size).replace(v, size));
            file.alias && content.push(row.replace(l, msg.aliasfor).replace(v, file.alias));
            content.push(row.replace(l, msg.path).replace(v, fm.escape(fm.path(file.hash, true))));
            if (file.read) {
                var href;
                if (o.nullUrlDirLinkSelf && file.mime == 'directory' && file.url === null) {
                    var loc = window.location;
                    href = loc.pathname + loc.search + '#elf_' + file.hash;
                } else {
                    href = fm.url(file.hash);
                }
                content.push(row.replace(l, msg.link).replace(v, '<a href="' + href + '" target="_blank">' + file.name + '</a>'));
            }

            if (file.dim) { // old api
                content.push(row.replace(l, msg.dim).replace(v, file.dim));
            } else if (file.mime.indexOf('image') !== -1) {
                if (file.width && file.height) {
                    content.push(row.replace(l, msg.dim).replace(v, file.width + 'x' + file.height));
                } else {
                    content.push(row.replace(l, msg.dim).replace(v, tpl.spinner.replace('{text}', msg.calc)));
                    fm.request({
                            data: { cmd: 'dim', target: file.hash },
                            preventDefault: true
                        })
                        .fail(function() {
                            replSpinner(msg.unknown);
                        })
                        .done(function(data) {
                            replSpinner(data.dim || msg.unknown);
                            if (data.dim) {
                                var dim = data.dim.split('x');
                                var rfile = fm.file(file.hash);
                                rfile.width = dim[0];
                                rfile.height = dim[1];
                            }
                        });
                }
            }


            content.push(row.replace(l, msg.modify).replace(v, fm.formatDate(file)));
            content.push(row.replace(l, msg.perms).replace(v, fm.formatPermissions(file)));
            content.push(row.replace(l, msg.locked).replace(v, file.locked ? msg.yes : msg.no));
        } else {
            view = view.replace('{class}', 'elfinder-cwd-icon-group');
            title = tpl.groupTitle.replace('{items}', msg.items).replace('{num}', cnt);
            dcnt = $.map(files, function(f) { return f.mime == 'directory' ? 1 : null; }).length;
            if (!dcnt) {
                size = 0;
                $.each(files, function(h, f) {
                    var s = parseInt(f.size);

                    if (s >= 0 && size >= 0) {
                        size += s;
                    } else {
                        size = 'unknown';
                    }
                });
                content.push(row.replace(l, msg.kind).replace(v, msg.files));
                content.push(row.replace(l, msg.size).replace(v, fm.formatSize(size)));
            } else {
                content.push(row.replace(l, msg.kind).replace(v, dcnt == cnt ? msg.folders : msg.folders + ' ' + dcnt + ', ' + msg.files + ' ' + (cnt - dcnt)));
                content.push(row.replace(l, msg.size).replace(v, tpl.spinner.replace('{text}', msg.calc)));
                count = $.map(files, function(f) { return f.hash; });

            }
        }

        view = view.replace('{title}', title).replace('{content}', content.join(''));

        dialog = fm.dialog(view, opts);
        dialog.attr('id', id); // load thumbnail
        if (tmb) {
            $('<img/>')
                .load(function() { dialog.find('.elfinder-cwd-icon').css('background', 'url("' + tmb + '") center center no-repeat'); })
                .attr('src', tmb);
        }

        // send request to count total size
        if (count.length) {
            fm.request({
                    data: { cmd: 'size', targets: count },
                    preventDefault: true
                })
                .fail(function() {
                    replSpinner(msg.unknown);
                })
                .done(function(data) {
                    var size = parseInt(data.size);
                    replSpinner(size >= 0 ? fm.formatSize(size) : msg.unknown);
                });
        }

    };
};
"use strict";
/**
 * @class elFinder command "duplicate"
 * Create file/folder copy with suffix "copy Number"
 *
 * @type  elFinder.command
 * @author  Dmitry (dio) Levashov
 */
elFinder.prototype.commands.duplicate = function() {
    var fm = this.fm;

    this.getstate = function(sel) {
        var sel = this.files(sel),
            cnt = sel.length;

        return !this._disabled && cnt && fm.cwd().write && $.map(sel, function(f) { return f.phash && f.read ? f : null; }).length == cnt ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            files = this.files(hashes),
            cnt = files.length,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                }),
            args = [];

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.read || !fm.file(file.phash).write) {
                return !dfrd.reject(['errCopy', file.name, 'errPerm']);
            }
        });

        if (dfrd.state() == 'rejected') {
            return dfrd;
        }

        return fm.request({
            data: { cmd: 'duplicate', targets: this.hashes(hashes) },
            notify: { type: 'copy', cnt: cnt }
        });

    };
};
"use strict";
/**
 * @class elFinder command "rename". 
 * Rename selected file.
 *
 * @author Dmitry (dio) Levashov, dio@std42.ru
 **/
elFinder.prototype.commands.rename = function() {

    this.shortcuts = [
        {
            pattern: 'f2' + (this.fm.OS == 'mac' ? ' enter' : '')
        }
    ];

    this.getstate = function() {
        var sel = this.fm.selectedFiles();

        return !this._disabled && sel.length == 1 && sel[0].phash && !sel[0].locked ? 0 : -1;
    };
    this.exec = function() {
        var fm = this.fm,
            cwd = fm.getUI('cwd'),
            sel = fm.selected(),
            cnt = sel.length,
            file = fm.file(sel.shift()),
            filename = '.elfinder-cwd-filename',
            dfrd = $.Deferred()
                .fail(function(error) {
                    var parent = input.parent(),
                        name = fm.escape(file.name);


                    if (parent.length) {
                        input.remove();
                        parent.html(name);
                    } else {
                        cwd.find('#' + file.hash).find(filename).html(name);
                        setTimeout(function() {
                            cwd.find('#' + file.hash).click();
                        }, 50);
                    }

                    error && fm.error(error);
                })
                .always(function() {
                    fm.enable();
                }),
            input = $('<input type="text"/>')
                .keydown(function(e) {
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    if (e.keyCode == $.ui.keyCode.ESCAPE) {
                        dfrd.reject();
                    } else if (e.keyCode == $.ui.keyCode.ENTER) {
                        input.blur();
                    }
                })
                .mousedown(function(e) {
                    e.stopPropagation();
                })
                .dblclick(function(e) {
                    e.stopPropagation();
                    e.preventDefault();
                })
                .blur(function() {
                    var name = $.trim(input.val()),
                        parent = input.parent();

                    if (parent.length) {
                        if (input[0].setSelectionRange) {
                            input[0].setSelectionRange(0, 0);
                        }
                        if (name == file.name) {
                            return dfrd.reject();
                        }
                        if (!name) {
                            return dfrd.reject('errInvNameCr' + (file.mime == "directory" ? 'Dir' : ''));
                        }
                        if (name.match("[\/|\\|\:|\*|\"|\<|\>|\#|\|\$]")) {
                            return dfrd.reject('errInvSym' + (file.mime == "directory" ? 'Dir' : ''));
                        }
                        if (name.length > 100) {
                            return dfrd.reject('errInvNameSize' + (file.mime == "directory" ? 'Dir' : ''));
                        }

                        if (fm.fileByName(name, file.phash)) {
                            return dfrd.reject(['errExists', name]);
                        }
                        if (file.mime != "directory") {
                            var extNew = fm.getExtension(name);
                            var extOld = fm.getExtension(file.name);
                            if (!extNew) {
                                return dfrd.reject('errInvNameCr');
                            }
                            if (extOld[0] && extNew[0] && extNew[0] != extOld[0]) {
                                return dfrd.reject('errInvExtDifferent');
                            }
                            var nameWitoutext = name.split('.')[0];
                            if (nameWitoutext == "") {
                                return dfrd.reject('errInvNameCr');
                            }
                        }
                        parent.html(fm.escape(name));
                        fm.lockfiles({ files: [file.hash] });
                        fm.request({
                                data: { cmd: 'rename', target: file.hash, name: name },
                                notify: { type: 'rename', cnt: 1 }
                            })
                            .fail(function(error) {
                                dfrd.reject();
                                fm.sync();
                            })
                            .done(function(data) {
                                dfrd.resolve(data);
                            })
                            .always(function() {
                                fm.unlockfiles({ files: [file.hash] });
                            });

                    }
                }),
            node = cwd.find('#' + file.hash).find(filename).empty().append(input.val(file.name)),
            name = input.val().replace(/\.((tar\.(gz|bz|bz2|z|lzo))|cpio\.gz|ps\.gz|xcf\.(gz|bz2)|[a-z0-9]{1,4})$/ig, '');

        if (this.disabled()) {
            return dfrd.reject();
        }

        if (!file || cnt > 1 || !node.length) {
            return dfrd.reject('errCmdParams', this.title);
        }

        if (file.locked) {
            return dfrd.reject(['errLocked', file.name]);
        }

        fm.one('select', function() {
            input.parent().length && file && $.inArray(file.hash, fm.selected()) === -1 && input.blur();
        });
        input.select().focus();

        input[0].setSelectionRange && input[0].setSelectionRange(0, name.length);

        return dfrd;
    };
};
"use strict";
/**
 * @class  elFinder command "help"
 * "About" dialog
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.help = function() {
    var fm = this.fm,
        self = this,
        linktpl = '<div class="elfinder-help-link"> <a href="{url}">{link}</a></div>',
        linktpltgt = '<div class="elfinder-help-link"> <a href="{url}" target="_blank">{link}</a></div>',
        atpl = '<div class="elfinder-help-team"><div>{author}</div>{work}</div>',
        url = /\{url\}/,
        link = /\{link\}/,
        author = /\{author\}/,
        work = /\{work\}/,
        r = 'replace',
        prim = 'ui-priority-primary',
        sec = 'ui-priority-secondary',
        lic = 'elfinder-help-license',
        tab = '<li class="ui-state-default ui-corner-top"><a href="#{id}">{title}</a></li>',
        html = [
            '<div class="ui-tabs ui-widget ui-widget-content ui-corner-all elfinder-help">',
            '<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">'
        ],
        stpl = '<div class="elfinder-help-shortcut"><div class="elfinder-help-shortcut-pattern">{pattern}</div> {descrip}</div>',
        sep = '<div class="elfinder-help-separator"/>',


        about = function() {
            html.push('<div id="about" class="ui-tabs-panel ui-widget-content ui-corner-bottom"><div class="elfinder-help-logo"/>');
            html.push('<h3>elFinder</h3>');
            html.push('<div class="' + prim + '">' + fm.i18n('webfm') + '</div>');
            html.push('<div class="' + sec + '">' + fm.i18n('ver') + ': ' + fm.version + ', ' + fm.i18n('protocolver') + ': <span id="apiver"></span></div>');
            html.push('<div class="' + sec + '">jQuery/jQuery UI: ' + $().jquery + '/' + $.ui.version + '</div>');

            html.push(sep);

            html.push(linktpltgt[r](url, 'http://elfinder.org/')[r](link, fm.i18n('homepage')));
            html.push(linktpltgt[r](url, 'https://github.com/Studio-42/elFinder/wiki')[r](link, fm.i18n('docs')));
            html.push(linktpltgt[r](url, 'https://github.com/Studio-42/elFinder')[r](link, fm.i18n('github')));
            html.push(linktpltgt[r](url, 'http://twitter.com/elrte_elfinder')[r](link, fm.i18n('twitter')));

            html.push(sep);

            html.push('<div class="' + prim + '">' + fm.i18n('team') + '</div>');

            html.push(atpl[r](author, 'Dmitry "dio" Levashov &lt;dio@std42.ru&gt;')[r](work, fm.i18n('chiefdev')));
            html.push(atpl[r](author, 'Troex Nevelin &lt;troex@fury.scancode.ru&gt;')[r](work, fm.i18n('maintainer')));
            html.push(atpl[r](author, 'Alexey Sukhotin &lt;strogg@yandex.ru&gt;')[r](work, fm.i18n('contributor')));
            html.push(atpl[r](author, 'Naoki Sawada &lt;hypweb@gmail.com&gt;')[r](work, fm.i18n('contributor')));

            fm.i18[fm.lang].translator && html.push(atpl[r](author, fm.i18[fm.lang].translator)[r](work, fm.i18n('translator') + ' (' + fm.i18[fm.lang].language + ')'));

            html.push(sep);
            html.push('<div class="' + lic + '">' + fm.i18n('icons') + ': Pixelmixer, <a href="http://p.yusukekamiyamane.com" target="_blank">Fugue</a></div>');

            html.push(sep);
            html.push('<div class="' + lic + '">Licence: BSD Licence</div>');
            html.push('<div class="' + lic + '">Copyright © 2009-2011, Studio 42</div>');
            html.push('<div class="' + lic + '">„ …' + fm.i18n('dontforget') + ' ”</div>');
            html.push('</div>');
        },
        shortcuts = function() {
            var sh = fm.shortcuts();
            // shortcuts tab
            html.push('<div id="shortcuts" class="ui-tabs-panel ui-widget-content ui-corner-bottom">');

            if (sh.length) {
                html.push('<div class="ui-widget-content elfinder-help-shortcuts">');
                $.each(sh, function(i, s) {
                    html.push(stpl.replace(/\{pattern\}/, s[0]).replace(/\{descrip\}/, s[1]));
                });

                html.push('</div>');
            } else {
                html.push('<div class="elfinder-help-disabled">' + fm.i18n('shortcutsof') + '</div>');
            }


            html.push('</div>');
        },
        help = function() {
            // help tab
            html.push('<div id="help" class="ui-tabs-panel ui-widget-content ui-corner-bottom">');
            html.push('<a href="http://elfinder.org/forum/" target="_blank" class="elfinder-dont-panic"><span>DON\'T PANIC</span></a>');
            html.push('</div>');
            // end help
        },
        content;

    this.alwaysEnabled = true;
    this.updateOnSelect = false;
    this.state = 0;

    this.shortcuts = [
        {
            pattern: 'f1',
            description: this.title
        }
    ];

    setTimeout(function() {
        var parts = self.options.view || ['about', 'shortcuts', 'help'];

        $.each(parts, function(i, title) {
            html.push(tab[r](/\{id\}/, title)[r](/\{title\}/, fm.i18n(title)));
        });

        html.push('</ul>');

        $.inArray('about', parts) !== -1 && about();
        $.inArray('shortcuts', parts) !== -1 && shortcuts();
        $.inArray('help', parts) !== -1 && help();

        html.push('</div>');
        content = $(html.join(''));

        fm.one('load', function setapi() { content.find('#apiver').text(fm.api); });

        content.find('.ui-tabs-nav li')
            .hover(function() {
                $(this).toggleClass('ui-state-hover');
            })
            .children()
            .click(function(e) {
                var link = $(this);

                e.preventDefault();
                e.stopPropagation();

                if (!link.is('.ui-tabs-selected')) {
                    link.parent().addClass('ui-tabs-selected ui-state-active').siblings().removeClass('ui-tabs-selected').removeClass('ui-state-active');
                    content.find('.ui-tabs-panel').hide().filter(link.attr('href')).show();
                }

            })
            .filter(':first').click();

    }, 200);
    this.getstate = function() {
        return 0;
    };
    this.exec = function() {
        if (!this.dialog) {
            this.dialog = this.fm.dialog(content, { title: this.title, width: 530, autoOpen: false, destroyOnClose: false });
        }

        this.dialog.elfinderdialog('open').find('.ui-tabs-nav li a:first').click();
    };
};
"use strict";
/**
 * @class elFinder command "getfile". 
 * Return selected files info into outer callback.
 * For use elFinder with wysiwyg editors etc.
 *
 * @author Dmitry (dio) Levashov, dio@std42.ru
 **/
elFinder.prototype.commands.getfile = function() {
    var self = this,
        fm = this.fm,
        filter = function(files) {
            var o = self.options;

            files = $.map(files, function(file) {
                return file.mime != 'directory' || o.folders ? file : null;
            });

            return o.multiple || files.length == 1 ? files : [];
        };

    this.alwaysEnabled = true;
    this.callback = fm.options.getFileCallback;
    this._disabled = typeof(this.callback) == 'function';

    this.getstate = function(sel) {
        var sel = this.files(sel),
            cnt = sel.length;

        return this.callback && cnt && filter(sel).length == cnt ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            opts = this.options,
            files = this.files(hashes),
            cnt = files.length,
            url = fm.option('url'),
            tmb = fm.option('tmbUrl'),
            dfrd = $.Deferred()
                .done(function(data) {
                    fm.trigger('getfile', { files: data });
                    self.callback(data, fm);

                    if (opts.oncomplete == 'close') {
                        fm.hide();
                    } else if (opts.oncomplete == 'destroy') {
                        fm.destroy();
                    }
                }),
            result = function(file) {
                return opts.onlyURL
                    ? opts.multiple ? $.map(files, function(f) { return f.url; }) : files[0].url
                    : opts.multiple ? files : files[0];
            },
            req = [],
            i,
            file,
            dim;

        if (this.getstate() == -1) {
            return dfrd.reject();
        }

        for (i = 0; i < cnt; i++) {
            file = files[i];
            if (file.mime == 'directory' && !opts.folders) {
                return dfrd.reject();
            }
            file.baseUrl = url;
            file.url = fm.url(file.hash);
            file.path = fm.path(file.hash);
            if (file.tmb && file.tmb != 1) {
                file.tmb = tmb + file.tmb;
            }
            if (!file.width && !file.height) {
                if (file.dim) {
                    dim = file.dim.split('x');
                    file.width = dim[0];
                    file.height = dim[1];
                } else if (file.mime.indexOf('image') !== -1) {
                    req.push(fm.request({
                            data: { cmd: 'dim', target: file.hash },
                            notify: { type: 'dim', cnt: 1, hideCnt: true },
                            preventDefault: true
                        })
                        .done(function(data) {
                            if (data.dim) {
                                var dim = data.dim.split('x');
                                var rfile = fm.file(this.hash);
                                rfile.width = this.width = dim[0];
                                rfile.height = this.height = dim[1];
                            }
                        }.bind(file)));
                }
            }
        }

        if (req.length) {
            $.when.apply(null, req).always(function() {
                dfrd.resolve(result(files));
            });
            return dfrd;
        }

        return dfrd.resolve(result(files));
    };
};
"use strict";
/**
 * @class  elFinder command "mkdir"
 * Create new folder
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.mkdir = function() {
    this.disableOnSearch = true;
    this.updateOnSelect = false;
    this.mime = 'directory';
    this.prefix = 'untitled folder';
    this.exec = $.proxy(this.fm.res('mixin', 'make'), this);

    this.shortcuts = [
        {
            pattern: 'ctrl+shift+n'
        }
    ];

    this.getstate = function() {
        return !this._disabled && this.fm.cwd().write ? 0 : -1;
    };
};
"use strict";
/**
 * @class  elFinder command "mkfile"
 * Create new empty file
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.mkfile = function() {
    this.disableOnSearch = true;
    this.updateOnSelect = false;
    this.mime = 'text/plain';
    this.prefix = 'untitled file.txt';
    this.exec = $.proxy(this.fm.res('mixin', 'make'), this);

    this.getstate = function() {
        return !this._disabled && this.fm.cwd().write ? 0 : -1;
    };
};
"use strict";
/**
 * @class elFinder command "upload"
 * Upload files using iframe or XMLHttpRequest & FormData.
 * Dialog allow to send files using drag and drop
 *
 * @type  elFinder.command
 * @author  Dmitry (dio) Levashov
 */
elFinder.prototype.commands.upload = function() {
    var hover = this.fm.res('class', 'hover');

    this.disableOnSearch = true;
    this.updateOnSelect = false;

    // Shortcut opens dialog
    this.shortcuts = [
        {
            pattern: 'ctrl+u'
        }
    ];

    /**
	 * Return command state
	 *
	 * @return Number
	 **/
    this.getstate = function() {
        return 0; //!this._disabled && this.fm.cwd().write ? 0 : -1;
    };
    this.exec = function(data) {
        var fm = this.fm,
            files,
            existed = [],
            notUpload = [],
            dublicateIndexes = [],

            errText = fm.i18n('errNotUplTitle') + '<br/>',
            error = false,
            opts = {
                title: fm.i18n('attention'),
                buttons: {},
                close: function() {
                    files.length != notUpload.length && fm.upload(data, notUpload);
                }
            },
            cwdFileNames = $.map(fm.files(), function(file) { return file.phash == fm.cwd().hash ? file.name : null; }),
            confirm = function(ndx) {
                var i = existed[ndx],
                    file = files[i],
                    last = ndx == existed.length - 1;

                if (!file) {
                    return;
                }

                fm.confirm({
                    title: fm.i18n('moveFiles'),
                    text: fm.i18n(['errExists', file.name, 'confirmRepl']),
                    //all: !last,
                    accept: {
                        label: 'btnYes',
                        callback: function(all) {
                            !last && !all ? confirm(++ndx)
                                : uploadConf();
                        }
                    },
                    reject: {
                        label: 'btnNo',
                        callback: function(all) {
                            var i;

                            if (all) {
                                i = existed.length;
                                while (ndx < i--) {
                                    //������ ���
                                    dublicateIndexes.push(existed[i]);
                                }
                            } else {
                                //������ ��������
                                dublicateIndexes.push(existed[ndx]);
                            }

                            !last && !all
                                ? confirm(++ndx)
                                : uploadConf();
                        }
                    },
                    cancel: {
                        label: 'btnCancel',
                        callback: function() {
                            dfrd2.resolve();
                        }
                    }
                });
            },
            intersect = function(files, names) {
                var ret = [],
                    i = files.length;

                while (i--) {
                    $.inArray(files[i].name, names) !== -1 && ret.unshift(i);
                }
                return ret;
            },
            uploadConf = function() {
                error
                    ? fm.dialog('<div class="error"><span>' + errText + '</span></div></div>', opts)
                    : fm.upload(data, notUpload, dublicateIndexes);
            },
            upload = function(data) {
                dialog.elfinderdialog('close');
                fm.upload(data)
                    .fail(function(error) {
                        dfrd.reject(error);
                    })
                    .done(function(data) {
                        dfrd.resolve(data);
                    });
            },
            dfrd2 = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                })
                .always(function() {
                    fm.enable();
                }),
            dfrd,
            dialog,
            input,
            button,
            dropbox;

        opts.buttons[fm.i18n('btnClose')] = function() {
            $(this).elfindercryptxdialog('close');
        };

        if (this.disabled()) {
            return $.Deferred().reject();
        }

        if (data && (data.input || data.files)) {
            if (data.input && data.input.files) {
                files = data.input.files;
            } else if (data.files) {
                files = data.files;
            }

            if (files.length > 10) {
                return dfrd2.reject('errUploadMax');
            }
            for (var key in files) {
                var f = files[key];
                if (typeof f.size == "undefined") break;
                if (typeof f.name == "undefined") break;
                if (f.size > 20971520) {
                    notUpload.push(key);
                    errText += '<b>"' + f.name + '"</b>: ' + fm.i18n('errUploadMaxSize') + ';<br/>';
                    error = true;
                } else if (f.size == 0) {
                    notUpload.push(key);
                    errText += '<b>"' + f.name + '"</b>: ' + fm.i18n('errUploadMinSize') + ';<br/>';
                    error = true;
                } else if (f.name.length > 100) {
                    notUpload.push(key);
                    errText += '<b>"' + f.name + '"</b>: ' + fm.i18n('errInvNameSize') + ';<br/>';
                    error = true;
                } else if (f.name.match("[\/|\\|\:|\*|\"|\<|\>|\+|\#|\|]")) {
                    notUpload.push(key);
                    errText += '<b>"' + f.name + '"</b>: ' + fm.i18n('errInvSym') + ';<br/>';
                    error = true;
                }
            }

            existed = intersect(files, cwdFileNames);
            existed.length
                ? confirm(0)
                : uploadConf();

            return;
        }

        dfrd = $.Deferred();


        input = $('<input type="file" multiple="true"/>')
            .change(function() {
                upload({ input: input[0] });
            });

        button = $('<div class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text">' + fm.i18n('selectForUpload') + '</span></div>')
            .append($('<form/>').append(input))
            .hover(function() {
                button.toggleClass(hover);
            });
        dialog = $('<div class="elfinder-upload-dialog-wrapper"/>')
            .append(button);

        if (fm.dragUpload) {
            dropbox = $('<div class="ui-corner-all elfinder-upload-dropbox">' + fm.i18n('dropFiles') + '</div>')
                .prependTo(dialog)
                .after('<div class="elfinder-upload-dialog-or">' + fm.i18n('or') + '</div>')[0];

            dropbox.addEventListener('dragenter', function(e) {
                e.stopPropagation();
                e.preventDefault();
                $(dropbox).addClass(hover);
            }, false);

            dropbox.addEventListener('dragleave', function(e) {
                e.stopPropagation();
                e.preventDefault();
                $(dropbox).removeClass(hover);
            }, false);

            dropbox.addEventListener('dragover', function(e) {
                e.stopPropagation();
                e.preventDefault();
            }, false);

            dropbox.addEventListener('drop', function(e) {
                e.stopPropagation();
                e.preventDefault();

                upload({ files: e.dataTransfer.files });
            }, false);

        }

        fm.dialog(dialog, {
            title: this.title,
            modal: true,
            resizable: false,
            destroyOnClose: true
        });

        return dfrd;
    };
};
"use strict";
/**
 * @class elFinder command "download". 
 * Download selected files.
 * Only for new api
 *
 * @author Dmitry (dio) Levashov, dio@std42.ru
 **/
elFinder.prototype.commands.download = function() {
    var self = this,
        fm = this.fm,
        filter = function(hashes) {
            return $.map(self.files(hashes), function(f) { return f.mime == 'directory' ? null : f; });
        };

    this.shortcuts = [
        {
            pattern: 'shift+enter'
        }
    ];

    this.getstate = function() {
        var sel = this.fm.selected(),
            cnt = sel.length;

        return !this._disabled && cnt &&  cnt == filter(sel).length ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            base = fm.options.url,
            files = filter(hashes),
            dfrd = $.Deferred(),
            iframes = '',
            iframe = '',
            targets = '',
            cdata = '',
            i = 1,
            url;

        if (this.disabled()) {
            return dfrd.reject();
        }

        if (fm.oldAPI) {
            fm.error('errCmdNoSupport');
            return dfrd.reject();
        }

        cdata = $.param(fm.options.customData || {});
        if (cdata) {
            cdata = '&' + cdata;
        }

        base += base.indexOf('?') === -1 ? '?' : '&';

        //for (i = 0; i < files.length; i++) {
        //	iframes += '<iframe class="downloader" id="downloader-' + files[i].hash+'" style="display:none" src="'+base + 'cmd=file&target=' + files[i].hash+'&download=1'+cdata+'"/>';
        //}
        for (i = 0; i < files.length; i++) {
            targets += files[i].hash + ',';
        }
        targets = targets.substring(targets.length - 1, 1);
        var newWin= window.open(base + 'cmd=download&targets=' + targets);
        //iframe = '<iframe class="downloader" id="downloader-' + 'cryptx' + '" style="display:none" src="' + base + 'cmd=download&targets=' + targets + '"/>';
        //$(iframe)
        //	.appendTo('body')
        //	.ready(function() {
        //		setTimeout(function() {
        //		    $(iframe).each(function () {
        //				$('#' + $(this).attr('id')).remove();
        //			});
        //		}, fm.UA.Firefox? (20000 + (10000 * i)) : 10000); // give mozilla 20 sec + 10 sec for each file to be saved
        //	});
        fm.trigger('download', { files: files });
        return dfrd.resolve(hashes);
    };
};
"use strict"; /**
 * @class elFinder command "edit". 
 * Edit text file in dialog window
 *
 * @author Dmitry (dio) Levashov, dio@std42.ru
 **/
elFinder.prototype.commands.edit = function() {
    var self = this,
        fm = this.fm,
        mimes = fm.res('mimes', 'text') || [],

        /**
		 * Return files acceptable to edit
		 *
		 * @param  Array  files hashes
		 * @return Array
		 **/
        filter = function(files) {
            return $.map(files, function(file) {
                return (file.mime.indexOf('text/') === 0 || $.inArray(file.mime, mimes) !== -1)
                    && file.mime.indexOf('text/rtf')
                    && (!self.onlyMimes.length || $.inArray(file.mime, self.onlyMimes) !== -1)
                    && file.read && file.write ? file : null;
            });
        },

        /**
		 * Open dialog with textarea to edit file
		 *
		 * @param  String  id       dialog id
		 * @param  Object  file     file object
		 * @param  String  content  file content
		 * @return $.Deferred
		 **/
        dialog = function(id, file, content) {

            var dfrd = $.Deferred(),
                ta = $('<textarea class="elfinder-file-edit" rows="20" id="' + id + '-ta">' + fm.escape(content) + '</textarea>'),
                save = function() {
                    ta.editor && ta.editor.save(ta[0], ta.editor.instance);
                    dfrd.resolve(ta.getContent());
                    ta.elfinderdialog('close');
                },
                cancel = function() {
                    dfrd.reject();
                    ta.elfinderdialog('close');
                },
                opts = {
                    title: file.name,
                    width: self.options.dialogWidth || 450,
                    buttons: {},
                    close: function() {
                        ta.editor && ta.editor.close(ta[0], ta.editor.instance);
                        $(this).elfinderdialog('destroy');
                    },
                    open: function() {
                        fm.disable();
                        ta.focus();
                        ta[0].setSelectionRange && ta[0].setSelectionRange(0, 0);
                        ta.editor && ta.editor.load(ta[0]);
                    }

                };

            ta.getContent = function() {
                return ta.val();
            };
            $.each(self.options.editors || [], function(i, editor) {
                if ($.inArray(file.mime, editor.mimes || []) !== -1
                    && typeof editor.load == 'function'
                    && typeof editor.save == 'function') {
                    ta.editor = {
                        load: editor.load,
                        save: editor.save,
                        close: typeof editor.close == 'function' ? editor.close : function() {},
                        instance: null
                    };
                    return false;
                }
            });

            if (!ta.editor) {
                ta.keydown(function(e) {
                    var code = e.keyCode,
                        value,
                        start;

                    e.stopPropagation();
                    if (code == 9) {
                        e.preventDefault();
                        // insert tab on tab press
                        if (this.setSelectionRange) {
                            value = this.value;
                            start = this.selectionStart;
                            this.value = value.substr(0, start) + "\t" + value.substr(this.selectionEnd);
                            start += 1;
                            this.setSelectionRange(start, start);
                        }
                    }

                    if (e.ctrlKey || e.metaKey) {
                        // close on ctrl+w/q
                        if (code == 81 || code == 87) {
                            e.preventDefault();
                            cancel();
                        }
                        if (code == 83) {
                            e.preventDefault();
                            save();
                        }
                    }

                });
            }

            opts.buttons[fm.i18n('Save')] = save;
            opts.buttons[fm.i18n('Cancel')] = cancel;
            fm.dialog(ta, opts).attr('id', id);
            return dfrd.promise();
        },

        /**
		 * Get file content and
		 * open dialog with textarea to edit file content
		 *
		 * @param  String  file hash
		 * @return jQuery.Deferred
		 **/
        edit = function(file) {
            var hash = file.hash,
                opts = fm.options,
                dfrd = $.Deferred(),
                data = { cmd: 'file', target: hash },
                url = fm.url(hash) || fm.options.url,
                id = 'edit-' + fm.namespace + '-' + file.hash,
                d = fm.getUI().find('#' + id),
                error;


            if (d.length) {
                d.elfinderdialog('toTop');
                return dfrd.resolve();
            }

            if (!file.read || !file.write) {
                error = ['errOpen', file.name, 'errPerm'];
                fm.error(error);
                return dfrd.reject(error);
            }

            fm.request({
                    data: { cmd: 'get', target: hash },
                    notify: { type: 'openfile', cnt: 1 },
                    syncOnFail: true
                })
                .done(function(data) {
                    dialog(id, file, data.content)
                        .done(function(content) {
                            fm.request({
                                    options: { type: 'post' },
                                    data: {
                                        cmd: 'put',
                                        target: hash,
                                        content: content
                                    },
                                    notify: { type: 'save', cnt: 1 },
                                    syncOnFail: true
                                })
                                .fail(function(error) {
                                    dfrd.reject(error);
                                })
                                .done(function(data) {
                                    data.changed && data.changed.length && fm.change(data);
                                    dfrd.resolve(data);
                                });
                        });
                })
                .fail(function(error) {
                    dfrd.reject(error);
                });
            return dfrd.promise();
        };


    this.shortcuts = [
        {
            pattern: 'ctrl+e'
        }
    ];

    this.init = function() {
        this.onlyMimes = this.options.mimes || [];
    };
    this.getstate = function(sel) {
        var sel = this.files(sel),
            cnt = sel.length;

        return !this._disabled && cnt && filter(sel).length == cnt ? 0 : -1;
    };
    this.exec = function(hashes) {
        var files = filter(this.files(hashes)),
            list = [],
            file;

        if (this.disabled()) {
            return $.Deferred().reject();
        }

        while ((file = files.shift())) {
            list.push(edit(file));
        }

        return list.length
            ? $.when.apply(null, list)
            : $.Deferred().reject();
    };
};
"use strict"; /**
 * @class  elFinder command "quicklook"
 * Fast preview for some files types
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.quicklook = function() {
    var self = this,
        fm = self.fm,
        /**
		 * window closed state
		 *
		 * @type Number
		 **/
        closed = 0,
        /**
		 * window animated state
		 *
		 * @type Number
		 **/
        animated = 1,
        /**
		 * window opened state
		 *
		 * @type Number
		 **/
        opened = 2,
        /**
		 * window state
		 *
		 * @type Number
		 **/
        state = closed,
        /**
		 * next/prev event name (requied to cwd catch it)
		 *
		 * @type Number
		 **/
        // keydown    = fm.UA.Firefox || fm.UA.Opera ? 'keypress' : 'keydown',
        /**
		 * navbar icon class
		 *
		 * @type Number
		 **/
        navicon = 'elfinder-quicklook-navbar-icon',
        /**
		 * navbar "fullscreen" icon class
		 *
		 * @type Number
		 **/
        fullscreen = 'elfinder-quicklook-fullscreen',
        /**
		 * Triger keydown/keypress event with left/right arrow key code
		 *
		 * @param  Number  left/right arrow key code
		 * @return void
		 **/
        navtrigger = function(code) {
            $(document).trigger($.Event('keydown', { keyCode: code, ctrlKey: false, shiftKey: false, altKey: false, metaKey: false }));
        },
        /**
		 * Return css for closed window
		 *
		 * @param  jQuery  file node in cwd
		 * @return void
		 **/
        closedCss = function(node) {
            return {
                opacity: 0,
                width: 20, //node.width(),
                height: fm.view == 'list' ? 1 : 20,
                top: node.offset().top + 'px',
                left: node.offset().left + 'px'
            };
        },
        /**
		 * Return css for opened window
		 *
		 * @return void
		 **/
        openedCss = function() {
            var win = $(window);
            return {
                opacity: 1,
                width: width,
                height: height,
                top: parseInt((win.height() - height) / 2 + win.scrollTop()),
                left: parseInt((win.width() - width) / 2 + win.scrollLeft())
            };
        },

        support = function(codec) {
            var media = document.createElement(codec.substr(0, codec.indexOf('/'))),
                value = false;

            try {
                value = media.canPlayType && media.canPlayType(codec);
            } catch (e) {

            }

            return value && value !== '' && value != 'no';
        },

        /**
		 * Opened window width (from config)
		 *
		 * @type Number
		 **/
        width,
        /**
		 * Opened window height (from config)
		 *
		 * @type Number
		 **/
        height,
        /**
		 * elFinder node
		 *
		 * @type jQuery
		 **/
        parent,
        /**
		 * elFinder current directory node
		 *
		 * @type jQuery
		 **/
        cwd,
        title = $('<div class="elfinder-quicklook-title"/>'),
        icon = $('<div/>'),
        info = $('<div class="elfinder-quicklook-info"/>'), //.hide(),
        fsicon = $('<div class="' + navicon + ' ' + navicon + '-fullscreen"/>')
            .mousedown(function(e) {
                var win = self.window,
                    full = win.is('.' + fullscreen),
                    scroll = 'scroll.' + fm.namespace,
                    $window = $(window);

                e.stopPropagation();

                if (full) {
                    win.css(win.data('position')).unbind('mousemove');
                    $window.unbind(scroll).trigger(self.resize).unbind(self.resize);
                    navbar.unbind('mouseenter').unbind('mousemove');
                } else {
                    win.data('position', {
                            left: win.css('left'),
                            top: win.css('top'),
                            width: win.width(),
                            height: win.height()
                        })
                        .css({
                            width: '100%',
                            height: '100%'
                        });

                    $(window).bind(scroll, function() {
                            win.css({
                                left: parseInt($(window).scrollLeft()) + 'px',
                                top: parseInt($(window).scrollTop()) + 'px'
                            });
                        })
                        .bind(self.resize, function(e) {
                            self.preview.trigger('changesize');
                        })
                        .trigger(scroll)
                        .trigger(self.resize);

                    win.bind('mousemove', function(e) {
                            navbar.stop(true, true).show().delay(3000).fadeOut('slow');
                        })
                        .mousemove();

                    navbar.mouseenter(function() {
                            navbar.stop(true, true).show();
                        })
                        .mousemove(function(e) {
                            e.stopPropagation();
                        });
                }
                navbar.attr('style', '').draggable(full ? 'destroy' : {});
                win.toggleClass(fullscreen);
                $(this).toggleClass(navicon + '-fullscreen-off');
                $.fn.resizable && parent.add(win).resizable(full ? 'enable' : 'disable').removeClass('ui-state-disabled');
            }),

        navbar = $('<div class="elfinder-quicklook-navbar"/>')
            .append($('<div class="' + navicon + ' ' + navicon + '-prev"/>').mousedown(function() { navtrigger(37); }))
            .append(fsicon)
            .append($('<div class="' + navicon + ' ' + navicon + '-next"/>').mousedown(function() { navtrigger(39); }))
            .append('<div class="elfinder-quicklook-navbar-separator"/>')
            .append($('<div class="' + navicon + ' ' + navicon + '-close"/>').mousedown(function() { self.window.trigger('close'); }));

    this.resize = 'resize.' + fm.namespace;
    this.info = $('<div class="elfinder-quicklook-info-wrapper"/>')
        .append(icon)
        .append(info);

    this.preview = $('<div class="elfinder-quicklook-preview ui-helper-clearfix"/>')
        // clean info/icon
        .bind('change', function(e) {
            self.info.attr('style', '').hide();
            icon.removeAttr('class').attr('style', '');
            info.html('');

        })
        // update info/icon
        .bind('update', function(e) {
            var fm = self.fm,
                preview = self.preview,
                file = e.file,
                tpl = '<div class="elfinder-quicklook-info-data">{value}</div>',
                tmb;

            if (file) {
                !file.read && e.stopImmediatePropagation();
                self.window.data('hash', file.hash);
                self.preview.unbind('changesize').trigger('change').children().remove();
                title.html(fm.escape(file.name));

                info.html(
                    tpl.replace(/\{value\}/, file.name)
                    + tpl.replace(/\{value\}/, fm.mime2kind(file))
                    + (file.mime == 'directory' ? '' : tpl.replace(/\{value\}/, fm.formatSize(file.size)))
                    + tpl.replace(/\{value\}/, fm.i18n('modify') + ': ' + fm.formatDate(file))
                );
                icon.addClass('elfinder-cwd-icon ui-corner-all ' + fm.mime2class(file.mime));

                if (file.tmb) {
                    $('<img/>')
                        .hide()
                        .appendTo(self.preview)
                        .load(function() {
                            icon.css('background', 'url("' + tmb + '") center center no-repeat');
                            $(this).remove();
                        })
                        .attr('src', (tmb = fm.tmb(file.hash)));
                }
                self.info.delay(100).fadeIn(10);
            } else {
                e.stopImmediatePropagation();
            }
        });


    this.window = $('<div class="ui-helper-reset ui-widget elfinder-quicklook" style="position:absolute"/>')
        .click(function(e) { e.stopPropagation(); })
        .append(
            $('<div class="elfinder-quicklook-titlebar"/>')
            .append(title)
            .append($('<span class="ui-icon ui-icon-circle-close"/>').mousedown(function(e) {
                e.stopPropagation();
                self.window.trigger('close');
            }))
        )
        .append(this.preview.add(navbar))
        .append(self.info.hide())
        .draggable({ handle: 'div.elfinder-quicklook-titlebar' })
        .bind('open', function(e) {
            var win = self.window,
                file = self.value,
                node;

            if (self.closed() && file && (node = cwd.find('#' + file.hash)).length) {
                navbar.attr('style', '');
                state = animated;
                node.trigger('scrolltoview');
                win.css(closedCss(node))
                    .show()
                    .animate(openedCss(), 550, function() {
                        state = opened;
                        self.update(1, self.value);
                    });
            }
        })
        .bind('close', function(e) {
            var win = self.window,
                preview = self.preview.trigger('change'),
                file = self.value,
                node = cwd.find('#' + win.data('hash')),
                close = function() {
                    state = closed;
                    win.hide();
                    preview.children().remove();
                    self.update(0, self.value);

                };

            if (self.opened()) {
                state = animated;
                win.is('.' + fullscreen) && fsicon.mousedown();
                node.length
                    ? win.animate(closedCss(node), 500, close)
                    : close();
            }
        });

    /**
	 * This command cannot be disable by backend
	 *
	 * @type Boolean
	 **/
    this.alwaysEnabled = true;

    /**
	 * Selected file
	 *
	 * @type Object
	 **/
    this.value = null;

    this.handlers = {
        // save selected file
        select: function() { this.update(void(0), this.fm.selectedFiles()[0]); },
        error: function() { self.window.is(':visible') && self.window.data('hash', '').trigger('close'); },
        'searchshow searchhide': function() { this.opened() && this.window.trigger('close'); }
    };
    this.shortcuts = [
        {
            pattern: 'space'
        }
    ];

    this.support = {
        audio: {
            ogg: support('audio/ogg; codecs="vorbis"'),
            mp3: support('audio/mpeg;'),
            wav: support('audio/wav; codecs="1"'),
            m4a: support('audio/x-m4a;') || support('audio/aac;')
        },
        video: {
            ogg: support('video/ogg; codecs="theora"'),
            webm: support('video/webm; codecs="vp8, vorbis"'),
            mp4: support('video/mp4; codecs="avc1.42E01E"') || support('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')
        }
    }; /**
	 * Return true if quickLoock window is visible and not animated
	 *
	 * @return Boolean
	 **/
    this.closed = function() {
        return state == closed;
    }; /**
	 * Return true if quickLoock window is hidden
	 *
	 * @return Boolean
	 **/
    this.opened = function() {
        return state == opened;
    }; /**
	 * Init command.
	 * Add default plugins and init other plugins
	 *
	 * @return Object
	 **/
    this.init = function() {
        var o = this.options,
            win = this.window,
            preview = this.preview,
            i,
            p;

        width = o.width > 0 ? parseInt(o.width) : 450;
        height = o.height > 0 ? parseInt(o.height) : 300;

        fm.one('load', function() {
            parent = fm.getUI();
            cwd = fm.getUI('cwd');

            win.appendTo('body').zIndex(100 + parent.zIndex());

            // close window on escape
            $(document).keydown(function(e) {
                e.keyCode == 27 && self.opened() && win.trigger('close');
            });
            if ($.fn.resizable) {
                win.resizable({
                    handles: 'se',
                    minWidth: 350,
                    minHeight: 120,
                    resize: function() {
                        // use another event to avoid recursion in fullscreen mode
                        // may be there is clever solution, but i cant find it :(
                        preview.trigger('changesize');
                    }
                });
            }

            self.change(function() {
                if (self.opened()) {
                    self.value ? preview.trigger($.Event('update', { file: self.value })) : win.trigger('close');
                }
            });

            $.each(fm.commands.quicklook.plugins || [], function(i, plugin) {
                if (typeof(plugin) == 'function') {
                    new plugin(self);
                }
            });

            preview.bind('update', function() {
                self.info.show();
            });
        });

    };
    this.getstate = function() {
        return this.fm.selected().length == 1 ? state == opened ? 1 : 0 : -1;
    };
    this.exec = function() {
        this.enabled() && this.window.trigger(this.opened() ? 'close' : 'open');
    };
    this.hideinfo = function() {
        this.info.stop(true).hide();
    };
};

elFinder.prototype.commands.quicklook.plugins = [

    /**
	 * Images preview plugin
	 *
	 * @param elFinder.commands.quicklook
	 **/
    function(ql) {
        var mimes = ['image/jpeg', 'image/png', 'image/gif'],
            preview = ql.preview;

        // what kind of images we can display
        $.each(navigator.mimeTypes, function(i, o) {
            var mime = o.type;

            if (mime.indexOf('image/') === 0 && $.inArray(mime, mimes)) {
                mimes.push(mime);
            }
        });

        preview.bind('update', function(e) {
            var file = e.file,
                img;

            if ($.inArray(file.mime, mimes) !== -1) {
                // this is our file - stop event propagation
                e.stopImmediatePropagation();

                img = $('<img/>')
                    .hide()
                    .appendTo(preview)
                    .load(function() {
                        // timeout - because of strange safari bug - 
                        // sometimes cant get image height 0_o
                        setTimeout(function() {
                            var prop = (img.width() / img.height()).toFixed(2);
                            preview.bind('changesize', function() {
                                    var pw = parseInt(preview.width()),
                                        ph = parseInt(preview.height()),
                                        w,
                                        h;

                                    if (prop < (pw / ph).toFixed(2)) {
                                        h = ph;
                                        w = Math.floor(h * prop);
                                    } else {
                                        w = pw;
                                        h = Math.floor(w / prop);
                                    }
                                    img.width(w).height(h).css('margin-top', h < ph ? Math.floor((ph - h) / 2) : 0);

                                })
                                .trigger('changesize');

                            // hide info/icon
                            ql.hideinfo();
                            //show image
                            img.fadeIn(100);
                        }, 1);
                    })
                    .attr('src', ql.fm.url(file.hash));
            }

        });
    },

    /**
	 * HTML preview plugin
	 *
	 * @param elFinder.commands.quicklook
	 **/
    function(ql) {
        var mimes = ['text/html', 'application/xhtml+xml'],
            preview = ql.preview,
            fm = ql.fm;

        preview.bind('update', function(e) {
            var file = e.file, jqxhr;

            if ($.inArray(file.mime, mimes) !== -1) {
                e.stopImmediatePropagation();

                // stop loading on change file if not loaded yet
                preview.one('change', function() {
                    jqxhr.state() == 'pending' && jqxhr.reject();
                });

                jqxhr = fm.request({
                        data: { cmd: 'get', target: file.hash, current: file.phash },
                        preventDefault: true
                    })
                    .done(function(data) {
                        ql.hideinfo();
                        doc = $('<iframe class="elfinder-quicklook-preview-html"/>').appendTo(preview)[0].contentWindow.document;
                        doc.open();
                        doc.write(data.content);
                        doc.close();
                    });
            }
        });
    },

    /**
	 * Texts preview plugin
	 *
	 * @param elFinder.commands.quicklook
	 **/
    function(ql) {
        var fm = ql.fm,
            mimes = fm.res('mimes', 'text'),
            preview = ql.preview;


        preview.bind('update', function(e) {
            var file = e.file,
                mime = file.mime,
                jqxhr;

            if (mime.indexOf('text/') === 0 || $.inArray(mime, mimes) !== -1) {
                e.stopImmediatePropagation();

                // stop loading on change file if not loadin yet
                preview.one('change', function() {
                    jqxhr.state() == 'pending' && jqxhr.reject();
                });

                jqxhr = fm.request({
                        data: { cmd: 'get', target: file.hash },
                        preventDefault: true
                    })
                    .done(function(data) {
                        ql.hideinfo();
                        $('<div class="elfinder-quicklook-preview-text-wrapper"><pre class="elfinder-quicklook-preview-text">' + fm.escape(data.content) + '</pre></div>').appendTo(preview);
                    });
            }
        });
    },

    /**
	 * PDF preview plugin
	 *
	 * @param elFinder.commands.quicklook
	 **/
    function(ql) {
        var fm = ql.fm,
            mime = 'application/pdf',
            preview = ql.preview,
            active = false;

        if ((fm.UA.Safari && fm.OS == 'mac') || fm.UA.IE) {
            active = true;
        } else {
            $.each(navigator.plugins, function(i, plugins) {
                $.each(plugins, function(i, plugin) {
                    if (plugin.type == mime) {
                        return !(active = true);
                    }
                });
            });
        }

        active && preview.bind('update', function(e) {
            var file = e.file, node;

            if (file.mime == mime) {
                e.stopImmediatePropagation();
                preview.one('change', function() {
                    node.unbind('load').remove();
                });

                node = $('<iframe class="elfinder-quicklook-preview-pdf"/>')
                    .hide()
                    .appendTo(preview)
                    .load(function() {
                        ql.hideinfo();
                        node.show();
                    })
                    .attr('src', fm.url(file.hash));
            }

        });
    },

    /**
	 * Flash preview plugin
	 *
	 * @param elFinder.commands.quicklook
	 **/
    function(ql) {
        var fm = ql.fm,
            mime = 'application/x-shockwave-flash',
            preview = ql.preview,
            active = false;

        $.each(navigator.plugins, function(i, plugins) {
            $.each(plugins, function(i, plugin) {
                if (plugin.type == mime) {
                    return !(active = true);
                }
            });
        });

        active && preview.bind('update', function(e) {
            var file = e.file,
                node;

            if (file.mime == mime) {
                e.stopImmediatePropagation();
                ql.hideinfo();
                preview.append((node = $('<embed class="elfinder-quicklook-preview-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="' + fm.url(file.hash) + '" quality="high" type="application/x-shockwave-flash" />')));
            }
        });
    },

    /**
	 * HTML5 audio preview plugin
	 *
	 * @param elFinder.commands.quicklook
	 **/
    function(ql) {
        var preview = ql.preview,
            autoplay = !!ql.options['autoplay'],
            mimes = {
                'audio/mpeg': 'mp3',
                'audio/mpeg3': 'mp3',
                'audio/mp3': 'mp3',
                'audio/x-mpeg3': 'mp3',
                'audio/x-mp3': 'mp3',
                'audio/x-wav': 'wav',
                'audio/wav': 'wav',
                'audio/x-m4a': 'm4a',
                'audio/aac': 'm4a',
                'audio/mp4': 'm4a',
                'audio/x-mp4': 'm4a',
                'audio/ogg': 'ogg'
            },
            node;

        preview.bind('update', function(e) {
            var file = e.file,
                type = mimes[file.mime];

            if (ql.support.audio[type]) {
                e.stopImmediatePropagation();

                node = $('<audio class="elfinder-quicklook-preview-audio" controls preload="auto" autobuffer><source src="' + ql.fm.url(file.hash) + '" /></audio>')
                    .appendTo(preview);
                autoplay && node[0].play();
            }
        }).bind('change', function() {
            if (node && node.parent().length) {
                node[0].pause();
                node.remove();
                node = null;
            }
        });
    },

    /**
	 * HTML5 video preview plugin
	 *
	 * @param elFinder.commands.quicklook
	 **/
    function(ql) {
        var preview = ql.preview,
            autoplay = !!ql.options['autoplay'],
            mimes = {
                'video/mp4': 'mp4',
                'video/x-m4v': 'mp4',
                'video/ogg': 'ogg',
                'application/ogg': 'ogg',
                'video/webm': 'webm'
            },
            node;

        preview.bind('update', function(e) {
            var file = e.file,
                type = mimes[file.mime];

            if (ql.support.video[type]) {
                e.stopImmediatePropagation();

                ql.hideinfo();
                node = $('<video class="elfinder-quicklook-preview-video" controls preload="auto" autobuffer><source src="' + ql.fm.url(file.hash) + '" /></video>').appendTo(preview);
                autoplay && node[0].play();

            }
        }).bind('change', function() {
            if (node && node.parent().length) {
                node[0].pause();
                node.remove();
                node = null;
            }
        });
    },

    /**
	 * Audio/video preview plugin using browser plugins
	 *
	 * @param elFinder.commands.quicklook
	 **/
    function(ql) {
        var preview = ql.preview,
            mimes = [],
            node;

        $.each(navigator.plugins, function(i, plugins) {
            $.each(plugins, function(i, plugin) {
                (plugin.type.indexOf('audio/') === 0 || plugin.type.indexOf('video/') === 0) && mimes.push(plugin.type);
            });
        });

        preview.bind('update', function(e) {
            var file = e.file,
                mime = file.mime,
                video;

            if ($.inArray(file.mime, mimes) !== -1) {
                e.stopImmediatePropagation();
                (video = mime.indexOf('video/') === 0) && ql.hideinfo();
                node = $('<embed src="' + ql.fm.url(file.hash) + '" type="' + mime + '" class="elfinder-quicklook-preview-' + (video ? 'video' : 'audio') + '"/>')
                    .appendTo(preview);
            }
        }).bind('change', function() {
            if (node && node.parent().length) {
                node.remove();
                node = null;
            }
        });

    }
]
"use strict"; /**
 * @class  elFinder command "extract"
 * Extract files from archive
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.extract = function() {
    var self = this,
        fm = self.fm,
        mimes = [],
        filter = function(files) {
            return $.map(files, function(file) {
                return file.read && $.inArray(file.mime, mimes) !== -1 ? file : null;
            });
        };

    this.disableOnSearch = true;

    // Update mimes list on open/reload
    fm.bind('open reload', function() {
        mimes = fm.option('archivers')['extract'] || [];
        self.change();
    });

    this.getstate = function(sel) {
        var sel = this.files(sel),
            cnt = sel.length;

        return !this._disabled && cnt && this.fm.cwd().write && filter(sel).length == cnt ? 0 : -1;
    };
    this.exec = function(hashes) {
        var files = this.files(hashes),
            dfrd = $.Deferred(),
            cnt = files.length,
            i,
            error,
            decision;

        var overwriteAll = false;
        var omitAll = false;

        var names = $.map(fm.files(hashes), function(file) { return file.name; });
        var map = {};
        $.map(fm.files(hashes), function(file) { map[file.name] = file; });

        var decide = function(decision) {
            switch (decision) {
            case 'overwrite_all':
                overwriteAll = true;
                break;
            case 'omit_all':
                omitAll = true;
                break;
            }
        };

        var unpack = function(file) {
            if (!(file.read && fm.file(file.phash).write)) {
                error = ['errExtract', file.name, 'errPerm'];
                fm.error(error);
                dfrd.reject(error);
            } else if ($.inArray(file.mime, mimes) === -1) {
                error = ['errExtract', file.name, 'errNoArchive'];
                fm.error(error);
                dfrd.reject(error);
            } else {
                fm.request({
                        data: { cmd: 'extract', target: file.hash },
                        notify: { type: 'extract', cnt: 1 },
                        syncOnFail: true
                    })
                    .fail(function(error) {
                        if (dfrd.state() != 'rejected') {
                            dfrd.reject(error);
                        }
                    })
                    .done(function() {
                    });
            }
        };

        var confirm = function(files, index) {
            var file = files[index];
            var name = file.name.replace(/\.((tar\.(gz|bz|bz2|z|lzo))|cpio\.gz|ps\.gz|xcf\.(gz|bz2)|[a-z0-9]{1,4})$/ig, '');
            var existed = ($.inArray(name, names) >= 0);
            if (existed && map[name].mime != 'directory') {
                fm.confirm(
                    {
                        title: fm.i18n('ntfextract'),
                        text: fm.i18n(['errExists', name, 'confirmRepl']),
                        accept: {
                            label: 'btnYes',
                            callback: function(all) {
                                decision = all ? 'overwrite_all' : 'overwrite';
                                decide(decision);
                                if (!overwriteAll && !omitAll) {
                                    if ('overwrite' == decision) {
                                        unpack(file);
                                    }
                                    if ((index + 1) < cnt) {
                                        confirm(files, index + 1);
                                    } else {
                                        dfrd.resolve();
                                    }
                                } else if (overwriteAll) {
                                    for (i = 0; i < cnt; i++) {
                                        unpack(files[i]);
                                    }
                                    dfrd.resolve();
                                }
                            }
                        },
                        reject: {
                            label: 'btnNo',
                            callback: function(all) {
                                decision = all ? 'omit_all' : 'omit';
                                decide(decision);
                                if (!overwriteAll && !omitAll && (index + 1) < cnt) {
                                    confirm(files, index + 1);
                                } else if (omitAll) {
                                    dfrd.resolve();
                                }
                            }
                        },
                        cancel: {
                            label: 'btnCancel',
                            callback: function() {
                                dfrd.resolve();
                            }
                        },
                        all: (cnt > 1)
                    }
                );
            } else {
                unpack(file);
                if ((index + 1) < cnt) {
                    confirm(files, index + 1);
                } else {
                    dfrd.resolve();
                }
            }
        };

        if (!(this.enabled() && cnt && mimes.length)) {
            return dfrd.reject();
        }

        if (cnt > 0) {
            confirm(files, 0);
        }

        return dfrd;
    };
};
"use strict"; /**
 * @class  elFinder command "archive"
 * Archive selected files
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.archive = function() {
    var self = this,
        fm = self.fm,
        mimes = [];

    this.variants = [];

    this.disableOnSearch = true;

    /**
	 * Update mimes on open/reload
	 *
	 * @return void
	 **/
    fm.bind('open reload', function() {
        self.variants = [];
        $.each((mimes = fm.option('archivers')['create'] || []), function(i, mime) {
            self.variants.push([mime, fm.mime2kind(mime)]);
        });
        self.change();
    });

    this.getstate = function() {
        return !this._disabled && mimes.length && fm.selected().length && fm.cwd().write ? 0 : -1;
    };
    this.exec = function(hashes, type) {
        var files = this.files(hashes),
            cnt = files.length,
            mime = type || mimes[0],
            cwd = fm.cwd(),
            error = ['errArchive', 'errPerm', 'errCreatingTempDir', 'errFtpDownloadFile', 'errFtpUploadFile', 'errFtpMkdir', 'errArchiveExec', 'errExtractExec', 'errRm'],
            dfrd = $.Deferred().fail(function(error) {
                error && fm.error(error);
            }),
            i;

        if (!(this.enabled() && cnt && mimes.length && $.inArray(mime, mimes) !== -1)) {
            return dfrd.reject();
        }

        if (!cwd.write) {
            return dfrd.reject(error);
        }

        for (i = 0; i < cnt; i++) {
            if (!files[i].read) {
                return dfrd.reject(error);
            }
        }

        return fm.request({
            data: { cmd: 'archive', targets: this.hashes(hashes), type: mime },
            notify: { type: 'archive', cnt: 1 },
            syncOnFail: true
        });
    };
};
"use strict"; /**
 * @class  elFinder command "search"
 * Find files
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.search = function() {
    this.title = 'Find files';
    this.options = { ui: 'searchbutton' };
    this.alwaysEnabled = true;
    this.updateOnSelect = false;

    /**
	 * Return command status.
	 * Search does not support old api.
	 *
	 * @return Number
	 **/
    this.getstate = function() {
        return 0;
    }; /**
	 * Send search request to backend.
	 *
	 * @param  String  search string
	 * @return $.Deferred
	 **/
    this.exec = function(q) {
        var fm = this.fm;

        if (typeof(q) == 'string' && q) {
            fm.trigger('searchstart', { query: q });

            return fm.request({
                data: { cmd: 'search', q: q },
                notify: { type: 'search', cnt: 1, hideCnt: true }
            });
        }
        fm.getUI('toolbar').find('.' + fm.res('class', 'searchbtn') + ' :text').focus();
        return $.Deferred().reject();
    };
};
"use strict";
/**
 * @class  elFinder command "view"
 * Change current directory view (icons/list)
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.view = function() {
    this.value = this.fm.viewType;
    this.alwaysEnabled = true;
    this.updateOnSelect = false;

    this.options = { ui: 'viewbutton' };

    this.getstate = function() {
        return 0;
    };
    this.exec = function() {
        var value = this.fm.storage('view', this.value == 'list' ? 'icons' : 'list');
        this.fm.viewchange();
        this.update(void(0), value);
    };
};
"use strict";
/**
 * @class  elFinder command "resize"
 * Open dialog to resize image
 *
 * @author Dmitry (dio) Levashov
 * @author Alexey Sukhotin
 * @author Naoki Sawada
 * @author Sergio Jovani
 **/
elFinder.prototype.commands.resize = function() {

    this.updateOnSelect = false;

    this.getstate = function() {
        var sel = this.fm.selectedFiles();
        return !this._disabled && sel.length == 1 && sel[0].read && sel[0].write && sel[0].mime.indexOf('image/') !== -1 ? 0 : -1;
    };

    this.exec = function(hashes) {
        var fm = this.fm,
            files = this.files(hashes),
            dfrd = $.Deferred(),

            open = function(file, id) {
                var dialog = $('<div class="elfinder-dialog-resize"/>'),
                    input = '<input type="text" size="5"/>',
                    row = '<div class="elfinder-resize-row"/>',
                    label = '<div class="elfinder-resize-label"/>',
                    control = $('<div class="elfinder-resize-control"/>'),
                    preview = $('<div class="elfinder-resize-preview"/>'),
                    spinner = $('<div class="elfinder-resize-spinner">' + fm.i18n('ntfloadimg') + '</div>'),
                    rhandle = $('<div class="elfinder-resize-handle"/>'),
                    rhandlec = $('<div class="elfinder-resize-handle"/>'),
                    uiresize = $('<div class="elfinder-resize-uiresize"/>'),
                    uicrop = $('<div class="elfinder-resize-uicrop"/>'),
                    uibuttonset = '<div class="ui-widget-content ui-corner-all elfinder-buttonset"/>',
                    uibutton = '<div class="ui-state-default elfinder-button"/>',
                    uiseparator = '<span class="ui-widget-content elfinder-toolbar-button-separator"/>',
                    uirotate = $('<div class="elfinder-resize-rotate"/>'),
                    uideg270 = $(uibutton).attr('title', fm.i18n('rotate-cw')).append($('<span class="elfinder-button-icon elfinder-button-icon-rotate-l"/>')
                        .click(function() {
                            rdegree = rdegree - 90;
                            rotate.update(rdegree);
                        })),
                    uideg90 = $(uibutton).attr('title', fm.i18n('rotate-ccw')).append($('<span class="elfinder-button-icon elfinder-button-icon-rotate-r"/>')
                        .click(function() {
                            rdegree = rdegree + 90;
                            rotate.update(rdegree);
                        })),
                    uiprop = $('<span />'),
                    reset = $('<div class="ui-state-default ui-corner-all elfinder-resize-reset"><span class="ui-icon ui-icon-arrowreturnthick-1-w"/></div>'),
                    uitype = $('<div class="elfinder-resize-type"/>')
                        .append('<input type="radio" name="type" id="' + id + '-resize" value="resize" checked="checked" /><label for="' + id + '-resize">' + fm.i18n('resize') + '</label>')
                        .append('<input type="radio" name="type" id="' + id + '-crop" value="crop" /><label for="' + id + '-crop">' + fm.i18n('crop') + '</label>')
                        .append('<input type="radio" name="type" id="' + id + '-rotate" value="rotate" /><label for="' + id + '-rotate">' + fm.i18n('rotate') + '</label>'),
                    type = $('input', uitype).attr('disabled', 'disabled')
                        .change(function() {
                            var val = $('input:checked', uitype).val();

                            resetView();
                            resizable(true);
                            croppable(true);
                            rotateable(true);

                            if (val == 'resize') {
                                uiresize.show();
                                uirotate.hide();
                                uicrop.hide();
                                resizable();
                            } else if (val == 'crop') {
                                uirotate.hide();
                                uiresize.hide();
                                uicrop.show();
                                croppable();
                            } else if (val == 'rotate') {
                                uiresize.hide();
                                uicrop.hide();
                                uirotate.show();
                                rotateable();
                            }
                        }),
                    constr = $('<input type="checkbox" checked="checked"/>')
                        .change(function() {
                            cratio = !!constr.prop('checked');
                            resize.fixHeight();
                            resizable(true);
                            resizable();
                        }),
                    width = $(input)
                        .change(function() {
                            var w = parseInt(width.val()),
                                h = parseInt(cratio ? Math.round(w / ratio) : height.val());

                            if (w > 0 && h > 0) {
                                resize.updateView(w, h);
                                height.val(h);
                            }
                        }),
                    height = $(input)
                        .change(function() {
                            var h = parseInt(height.val()),
                                w = parseInt(cratio ? Math.round(h * ratio) : width.val());

                            if (w > 0 && h > 0) {
                                resize.updateView(w, h);
                                width.val(w);
                            }
                        }),
                    pointX = $(input).change(function() { crop.updateView(); }),
                    pointY = $(input).change(function() { crop.updateView(); }),
                    offsetX = $(input).change(function() { crop.updateView(); }),
                    offsetY = $(input).change(function() { crop.updateView(); }),
                    degree = $('<input type="text" size="3" maxlength="3" value="0" />')
                        .change(function() {
                            rotate.update();
                        }),
                    uidegslider = $('<div class="elfinder-resize-rotate-slider"/>')
                        .slider({
                            min: 0,
                            max: 359,
                            value: degree.val(),
                            animate: true,
                            change: function(event, ui) {
                                if (ui.value != uidegslider.slider('value')) {
                                    rotate.update(ui.value);
                                }
                            },
                            slide: function(event, ui) {
                                rotate.update(ui.value, false);
                            }
                        }),
                    ratio = 1,
                    prop = 1,
                    owidth = 0,
                    oheight = 0,
                    cratio = true,
                    pwidth = 0,
                    pheight = 0,
                    rwidth = 0,
                    rheight = 0,
                    rdegree = 0,
                    img = $('<img/>')
                        .load(function() {
                            spinner.remove();

                            owidth = img.width();
                            oheight = img.height();
                            ratio = owidth / oheight;
                            resize.updateView(owidth, oheight);

                            rhandle.append(img.show()).show();
                            width.val(owidth);
                            height.val(oheight);

                            var r_scale = Math.min(pwidth, pheight) / Math.sqrt(Math.pow(owidth, 2) + Math.pow(oheight, 2));
                            rwidth = owidth * r_scale;
                            rheight = oheight * r_scale;

                            type.button('enable');
                            control.find('input, select').removeAttr('disabled')
                                .filter(':text').keydown(function(e) {
                                    var c = e.keyCode, i;

                                    e.stopPropagation();

                                    if ((c >= 37 && c <= 40)
                                        || c == $.ui.keyCode.BACKSPACE
                                        || c == $.ui.keyCode.DELETE
                                        || (c == 65 && (e.ctrlKey || e.metaKey))
                                        || c == 27) {
                                        return;
                                    }

                                    if (c == 9) {
                                        i = $(this).parent()[e.shiftKey ? 'prev' : 'next']('.elfinder-resize-row').children(':text');

                                        if (i.length) {
                                            i.focus();
                                        } else {
                                            $(this).parent().parent().find(':text:' + (e.shiftKey ? 'last' : 'first')).focus();
                                        }
                                    }

                                    if (c == 13) {
                                        fm.confirm({
                                            title: $('input:checked', uitype).val(),
                                            text: 'confirmReq',
                                            accept: {
                                                label: 'btnApply',
                                                callback: function() {
                                                    save();
                                                }
                                            },
                                            cancel: {
                                                label: 'btnCancel',
                                                callback: function() {}
                                            }
                                        });
                                        return;
                                    }

                                    if (!((c >= 48 && c <= 57) || (c >= 96 && c <= 105))) {
                                        e.preventDefault();
                                    }
                                })
                                .filter(':first').focus();

                            resizable();

                            reset.hover(function() { reset.toggleClass('ui-state-hover'); }).click(resetView);

                        })
                        .error(function() {
                            spinner.text('Unable to load image').css('background', 'transparent');
                        }),
                    basec = $('<div/>'),
                    imgc = $('<img/>'),
                    coverc = $('<div/>'),
                    imgr = $('<img/>'),
                    resetView = function() {
                        width.val(owidth);
                        height.val(oheight);
                        resize.updateView(owidth, oheight);
                    },
                    resize = {
                        update: function() {
                            width.val(Math.round(img.width() / prop));
                            height.val(Math.round(img.height() / prop));
                        },

                        updateView: function(w, h) {
                            if (w > pwidth || h > pheight) {
                                if (w / pwidth > h / pheight) {
                                    prop = pwidth / w;
                                    img.width(pwidth).height(Math.ceil(h * prop));
                                } else {
                                    prop = pheight / h;
                                    img.height(pheight).width(Math.ceil(w * prop));
                                }
                            } else {
                                img.width(w).height(h);
                            }

                            prop = img.width() / w;
                            uiprop.text('1 : ' + (1 / prop).toFixed(2));
                            resize.updateHandle();
                        },

                        updateHandle: function() {
                            rhandle.width(img.width()).height(img.height());
                        },
                        fixWidth: function() {
                            var w, h;
                            if (cratio) {
                                h = height.val();
                                h = Math.round(h * ratio);
                                resize.updateView(w, h);
                                width.val(w);
                            }
                        },
                        fixHeight: function() {
                            var w, h;
                            if (cratio) {
                                w = width.val();
                                h = Math.round(w / ratio);
                                resize.updateView(w, h);
                                height.val(h);
                            }
                        }
                    },
                    crop = {
                        update: function() {
                            offsetX.val(Math.round((rhandlec.data('w') || rhandlec.width()) / prop));
                            offsetY.val(Math.round((rhandlec.data('h') || rhandlec.height()) / prop));
                            pointX.val(Math.round(((rhandlec.data('x') || rhandlec.offset().left) - imgc.offset().left) / prop));
                            pointY.val(Math.round(((rhandlec.data('y') || rhandlec.offset().top) - imgc.offset().top) / prop));
                        },
                        updateView: function() {
                            var x = parseInt(pointX.val()) * prop + imgc.offset().left;
                            var y = parseInt(pointY.val()) * prop + imgc.offset().top;
                            var w = offsetX.val() * prop;
                            var h = offsetY.val() * prop;
                            rhandlec.data({ x: x, y: y, w: w, h: h });
                            rhandlec.width(Math.round(w));
                            rhandlec.height(Math.round(h));
                            coverc.width(rhandlec.width());
                            coverc.height(rhandlec.height());
                            rhandlec.offset({ left: Math.round(x), top: Math.round(y) });
                        },
                        resize_update: function() {
                            rhandlec.data({ w: null, h: null });
                            crop.update();
                            coverc.width(rhandlec.width());
                            coverc.height(rhandlec.height());
                        },
                        drag_update: function() {
                            rhandlec.data({ x: null, y: null });
                            crop.update();
                        }
                    },
                    rotate = {
                        mouseStartAngle: 0,
                        imageStartAngle: 0,
                        imageBeingRotated: false,

                        update: function(value, animate) {
                            if (typeof value == 'undefined') {
                                rdegree = value = parseInt(degree.val());
                            }
                            if (typeof animate == 'undefined') {
                                animate = true;
                            }
                            if (! animate || fm.UA.Opera || fm.UA.ltIE8) {
                                imgr.rotate(value);
                            } else {
                                imgr.animate({ rotate: value + 'deg' });
                            }
                            value = value % 360;
                            if (value < 0) {
                                value += 360;
                            }
                            degree.val(parseInt(value));

                            uidegslider.slider('value', degree.val());
                        },

                        execute: function(e) {

                            if (!rotate.imageBeingRotated) return;

                            var imageCentre = rotate.getCenter(imgr);
                            var mouseXFromCentre = e.pageX - imageCentre[0];
                            var mouseYFromCentre = e.pageY - imageCentre[1];
                            var mouseAngle = Math.atan2(mouseYFromCentre, mouseXFromCentre);

                            var rotateAngle = mouseAngle - rotate.mouseStartAngle + rotate.imageStartAngle;
                            rotateAngle = Math.round(parseFloat(rotateAngle) * 180 / Math.PI);

                            if (e.shiftKey) {
                                rotateAngle = Math.round((rotateAngle + 6) / 15) * 15;
                            }

                            imgr.rotate(rotateAngle);

                            rotateAngle = rotateAngle % 360;
                            if (rotateAngle < 0) {
                                rotateAngle += 360;
                            }
                            degree.val(rotateAngle);

                            uidegslider.slider('value', degree.val());

                            return false;
                        },

                        start: function(e) {

                            rotate.imageBeingRotated = true;

                            var imageCentre = rotate.getCenter(imgr);
                            var mouseStartXFromCentre = e.pageX - imageCentre[0];
                            var mouseStartYFromCentre = e.pageY - imageCentre[1];
                            rotate.mouseStartAngle = Math.atan2(mouseStartYFromCentre, mouseStartXFromCentre);

                            rotate.imageStartAngle = parseFloat(imgr.rotate()) * Math.PI / 180.0;

                            $(document).mousemove(rotate.execute);

                            return false;
                        },

                        stop: function(e) {

                            if (!rotate.imageBeingRotated) return;

                            $(document).unbind('mousemove', rotate.execute);

                            setTimeout(function() { rotate.imageBeingRotated = false; }, 10);
                            return false;
                        },

                        getCenter: function(image) {

                            var currentRotation = imgr.rotate();
                            imgr.rotate(0);

                            var imageOffset = imgr.offset();
                            var imageCentreX = imageOffset.left + imgr.width() / 2;
                            var imageCentreY = imageOffset.top + imgr.height() / 2;

                            imgr.rotate(currentRotation);

                            return Array(imageCentreX, imageCentreY);
                        }
                    },
                    resizable = function(destroy) {
                        if ($.fn.resizable) {
                            if (destroy) {
                                rhandle.filter(':ui-resizable').resizable('destroy');
                                rhandle.hide();
                            } else {
                                rhandle.show();
                                rhandle.resizable({
                                    alsoResize: img,
                                    aspectRatio: cratio,
                                    resize: resize.update,
                                    stop: resize.fixHeight
                                });
                            }
                        }
                    },
                    croppable = function(destroy) {
                        if ($.fn.draggable && $.fn.resizable) {
                            if (destroy) {
                                rhandlec.filter(':ui-resizable').resizable('destroy');
                                rhandlec.filter(':ui-draggable').draggable('destroy');
                                basec.hide();
                            } else {
                                imgc
                                    .width(img.width())
                                    .height(img.height());

                                coverc
                                    .width(img.width())
                                    .height(img.height());

                                rhandlec
                                    .width(imgc.width())
                                    .height(imgc.height())
                                    .offset(imgc.offset())
                                    .resizable({
                                        containment: basec,
                                        resize: crop.resize_update,
                                        handles: 'all'
                                    })
                                    .draggable({
                                        handle: coverc,
                                        containment: imgc,
                                        drag: crop.drag_update
                                    });

                                basec.show()
                                    .width(img.width())
                                    .height(img.height());

                                crop.update();
                            }
                        }
                    },
                    rotateable = function(destroy) {
                        if ($.fn.draggable && $.fn.resizable) {
                            if (destroy) {
                                imgr.hide();
                            } else {
                                imgr.show()
                                    .width(rwidth)
                                    .height(rheight)
                                    .css('margin-top', (pheight - rheight) / 2 + 'px')
                                    .css('margin-left', (pwidth - rwidth) / 2 + 'px');

                            }
                        }
                    },
                    save = function() {
                        var w, h, x, y, d;
                        var mode = $('input:checked', uitype).val();

                        //width.add(height).change(); // may be unnecessary

                        if (mode == 'resize') {
                            w = parseInt(width.val()) || 0;
                            h = parseInt(height.val()) || 0;
                        } else if (mode == 'crop') {
                            w = parseInt(offsetX.val()) || 0;
                            h = parseInt(offsetY.val()) || 0;
                            x = parseInt(pointX.val()) || 0;
                            y = parseInt(pointY.val()) || 0;
                        } else if (mode == 'rotate') {
                            w = owidth;
                            h = oheight;
                            d = parseInt(degree.val()) || 0;
                            if (d < 0 || d > 360) {
                                return fm.error('Invalid rotate degree');
                            }
                            if (d == 0 || d == 360) {
                                return fm.error('Image dose not rotated');
                            }
                        }

                        if (mode != 'rotate') {

                            if (w <= 0 || h <= 0) {
                                return fm.error('Invalid image size');
                            }

                            if (w == owidth && h == oheight) {
                                return fm.error('Image size not changed');
                            }

                        }

                        dialog.elfinderdialog('close');

                        fm.request({
                                data: {
                                    cmd: 'resize',
                                    target: file.hash,
                                    width: w,
                                    height: h,
                                    x: x,
                                    y: y,
                                    degree: d,
                                    mode: mode
                                },
                                notify: { type: 'resize', cnt: 1 }
                            })
                            .fail(function(error) {
                                dfrd.reject(error);
                            })
                            .done(function() {
                                dfrd.resolve();
                            });

                    },
                    buttons = {},
                    hline = 'elfinder-resize-handle-hline',
                    vline = 'elfinder-resize-handle-vline',
                    rpoint = 'elfinder-resize-handle-point',
                    src = fm.url(file.hash);

                imgr.mousedown(rotate.start);
                $(document).mouseup(rotate.stop);

                uiresize.append($(row).append($(label).text(fm.i18n('width'))).append(width).append(reset))
                    .append($(row).append($(label).text(fm.i18n('height'))).append(height))
                    .append($(row).append($('<label/>').text(fm.i18n('aspectRatio')).prepend(constr)))
                    .append($(row).append(fm.i18n('scale') + ' ').append(uiprop));

                uicrop.append($(row).append($(label).text('X')).append(pointX))
                    .append($(row).append($(label).text('Y')).append(pointY))
                    .append($(row).append($(label).text(fm.i18n('width'))).append(offsetX))
                    .append($(row).append($(label).text(fm.i18n('height'))).append(offsetY));

                uirotate.append($(row)
                    .append($(label).text(fm.i18n('rotate')))
                    .append($('<div style="float:left; width: 130px;">')
                        .append($('<div style="float:left;">')
                            .append(degree)
                            .append($('<span/>').text(fm.i18n('degree')))
                        )
                        .append($(uibuttonset).append(uideg270).append($(uiseparator)).append(uideg90))
                    )
                    .append(uidegslider)
                );


                dialog.append(uitype);

                control.append($(row))
                    .append(uiresize)
                    .append(uicrop.hide())
                    .append(uirotate.hide())
                    .find('input, select').attr('disabled', 'disabled');

                rhandle.append('<div class="' + hline + ' ' + hline + '-top"/>')
                    .append('<div class="' + hline + ' ' + hline + '-bottom"/>')
                    .append('<div class="' + vline + ' ' + vline + '-left"/>')
                    .append('<div class="' + vline + ' ' + vline + '-right"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-e"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-se"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-s"/>');

                preview.append(spinner).append(rhandle.hide()).append(img.hide());

                rhandlec.css('position', 'absolute')
                    .append('<div class="' + hline + ' ' + hline + '-top"/>')
                    .append('<div class="' + hline + ' ' + hline + '-bottom"/>')
                    .append('<div class="' + vline + ' ' + vline + '-left"/>')
                    .append('<div class="' + vline + ' ' + vline + '-right"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-n"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-e"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-s"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-w"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-ne"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-se"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-sw"/>')
                    .append('<div class="' + rpoint + ' ' + rpoint + '-nw"/>');

                preview.append(basec.css('position', 'absolute').hide().append(imgc).append(rhandlec.append(coverc)));

                preview.append(imgr.hide());

                preview.css('overflow', 'hidden');

                dialog.append(preview).append(control);

                buttons[fm.i18n('btnApply')] = save;
                buttons[fm.i18n('btnCancel')] = function() { dialog.elfinderdialog('close'); };

                fm.dialog(dialog, {
                    title: file.name,
                    width: 650,
                    resizable: false,
                    destroyOnClose: true,
                    buttons: buttons,
                    open: function() { preview.zIndex(1 + $(this).parent().zIndex()); }
                }).attr('id', id);

                // for IE < 9 dialog mising at open second+ time.
                if (fm.UA.ltIE8) {
                    $('.elfinder-dialog').css('filter', '');
                }

                reset.css('left', width.position().left + width.width() + 12);

                coverc.css({ 'opacity': 0.2, 'background-color': '#fff', 'position': 'absolute' }),
                    rhandlec.css('cursor', 'move');
                rhandlec.find('.elfinder-resize-handle-point').css({
                    'background-color': '#fff',
                    'opacity': 0.5,
                    'border-color': '#000'
                });

                imgr.css('cursor', 'pointer');

                uitype.buttonset();

                pwidth = preview.width() - (rhandle.outerWidth() - rhandle.width());
                pheight = preview.height() - (rhandle.outerHeight() - rhandle.height());

                img.attr('src', src + (src.indexOf('?') === -1 ? '?' : '&') + '_=' + Math.random());
                imgc.attr('src', img.attr('src'));
                imgr.attr('src', img.attr('src'));

            },

            id,
            dialog;


        if (!files.length || files[0].mime.indexOf('image/') === -1) {
            return dfrd.reject();
        }

        id = 'resize-' + fm.namespace + '-' + files[0].hash;
        dialog = fm.getUI().find('#' + id);

        if (dialog.length) {
            dialog.elfinderdialog('toTop');
            return dfrd.resolve();
        }

        open(files[0], id);

        return dfrd;
    };

};

(function($) {

    var findProperty = function(styleObject, styleArgs) {
        var i = 0;
        for (i in styleArgs) {
            if (typeof styleObject[styleArgs[i]] != 'undefined')
                return styleArgs[i];
        }
        styleObject[styleArgs[i]] = '';
        return styleArgs[i];
    };

    $.cssHooks.rotate = {
        get: function(elem, computed, extra) {
            return $(elem).rotate();
        },
        set: function(elem, value) {
            $(elem).rotate(value);
            return value;
        }
    };
    $.cssHooks.transform = {
        get: function(elem, computed, extra) {
            var name = findProperty(elem.style,
            ['WebkitTransform', 'MozTransform', 'OTransform', 'msTransform', 'transform']);
            return elem.style[name];
        },
        set: function(elem, value) {
            var name = findProperty(elem.style,
            ['WebkitTransform', 'MozTransform', 'OTransform', 'msTransform', 'transform']);
            elem.style[name] = value;
            return value;
        }
    };

    $.fn.rotate = function(val) {
        if (typeof val == 'undefined') {
            if (!!window.opera) {
                var r = this.css('transform').match(/rotate\((.*?)\)/);
                return (r && r[1]) ?
                    Math.round(parseFloat(r[1]) * 180 / Math.PI) : 0;
            } else {
                var r = this.css('transform').match(/rotate\((.*?)\)/);
                return (r && r[1]) ? parseInt(r[1]) : 0;
            }
        }
        this.css('transform',
            this.css('transform').replace(/none|rotate\(.*?\)/, '') + 'rotate(' + parseInt(val) + 'deg)');
        return this;
    };

    $.fx.step.rotate = function(fx) {
        if (fx.state == 0) {
            fx.start = $(fx.elem).rotate();
            fx.now = fx.start;
        }
        $(fx.elem).rotate(fx.now);
    };

    if (typeof window.addEventListener == "undefined" && typeof document.getElementsByClassName == "undefined") { // IE & IE<9
        var GetAbsoluteXY = function(element) {
            var pnode = element;
            var x = pnode.offsetLeft;
            var y = pnode.offsetTop;

            while (pnode.offsetParent) {
                pnode = pnode.offsetParent;
                if (pnode != document.body && pnode.currentStyle['position'] != 'static') {
                    break;
                }
                if (pnode != document.body && pnode != document.documentElement) {
                    x -= pnode.scrollLeft;
                    y -= pnode.scrollTop;
                }
                x += pnode.offsetLeft;
                y += pnode.offsetTop;
            }

            return { x: x, y: y };
        };

        var StaticToAbsolute = function(element) {
            if (element.currentStyle['position'] != 'static') {
                return;
            }

            var xy = GetAbsoluteXY(element);
            element.style.position = 'absolute';
            element.style.left = xy.x + 'px';
            element.style.top = xy.y + 'px';
        };

        var IETransform = function(element, transform) {

            var r;
            var m11 = 1;
            var m12 = 1;
            var m21 = 1;
            var m22 = 1;

            if (typeof element.style['msTransform'] != 'undefined') {
                return true;
            }

            StaticToAbsolute(element);

            r = transform.match(/rotate\((.*?)\)/);
            var rotate = (r && r[1]) ? parseInt(r[1]) : 0;

            rotate = rotate % 360;
            if (rotate < 0) rotate = 360 + rotate;

            var radian = rotate * Math.PI / 180;
            var cosX = Math.cos(radian);
            var sinY = Math.sin(radian);

            m11 *= cosX;
            m12 *= -sinY;
            m21 *= sinY;
            m22 *= cosX;

            element.style.filter = (element.style.filter || '').replace(/progid:DXImageTransform\.Microsoft\.Matrix\([^)]*\)/, "") +
            ("progid:DXImageTransform.Microsoft.Matrix(" +
                "M11=" + m11 +
                ",M12=" + m12 +
                ",M21=" + m21 +
                ",M22=" + m22 +
                ",FilterType='bilinear',sizingMethod='auto expand')");

            var ow = parseInt(element.style.width || element.width || 0);
            var oh = parseInt(element.style.height || element.height || 0);

            var radian = rotate * Math.PI / 180;
            var absCosX = Math.abs(Math.cos(radian));
            var absSinY = Math.abs(Math.sin(radian));

            var dx = (ow - (ow * absCosX + oh * absSinY)) / 2;
            var dy = (oh - (ow * absSinY + oh * absCosX)) / 2;

            element.style.marginLeft = Math.floor(dx) + "px";
            element.style.marginTop = Math.floor(dy) + "px";

            return(true);
        };

        var transform_set = $.cssHooks.transform.set;
        $.cssHooks.transform.set = function(elem, value) {
            transform_set.apply(this, [elem, value]);
            IETransform(elem, value);
            return value;
        };
    }

})(jQuery);
"use strict"; /**
 * @class  elFinder command "sort"
 * Change sort files rule
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.sort = function() {
    /**
	 * Command options
	 *
	 * @type  Object
	 */
    this.options = { ui: 'sortbutton' };

    this.getstate = function() {
        return 0;
    };
    this.exec = function(hashes, sort) {
        var fm = this.fm,
            sort = $.extend({
                type: fm.sortType,
                order: fm.sortOrder,
                stick: fm.sortStickFolders
            }, sort);

        this.fm.setSort(sort.type, sort.order, sort.stick);
        return $.Deferred().resolve();
    };
};
"use strict"; /**
 * @class  elFinder command "netmount"
 * Mount network volume with user credentials.
 *
 * @author Dmitry (dio) Levashov
 **/
elFinder.prototype.commands.netmount = function() {
    var self = this;

    this.alwaysEnabled = true;
    this.updateOnSelect = false;

    this.drivers = [];

    this.handlers = {
        load: function() {
            this.drivers = this.fm.netDrivers;
        }
    };
    this.getstate = function() {
        return this.drivers.length ? 0 : -1;
    };
    this.exec = function() {
        var fm = self.fm,
            dfrd = $.Deferred(),
            create = function() {
                var inputs = {
                        protocol: $('<select/>'),
                        host: $('<input type="text"/>'),
                        port: $('<input type="text"/>'),
                        path: $('<input type="text" value="/"/>'),
                        user: $('<input type="text"/>'),
                        pass: $('<input type="password"/>')
                    },
                    opts = {
                        title: fm.i18n('netMountDialogTitle'),
                        resizable: false,
                        modal: true,
                        destroyOnClose: true,
                        close: function() {
                            delete self.dialog;
                            dfrd.state() == 'pending' && dfrd.reject();
                        },
                        buttons: {}
                    },
                    content = $('<table class="elfinder-info-tb elfinder-netmount-tb"/>');

                $.each(self.drivers, function(i, protocol) {
                    inputs.protocol.append('<option value="' + protocol + '">' + fm.i18n(protocol) + '</option>');
                });


                $.each(inputs, function(name, input) {
                    name != 'protocol' && input.addClass('ui-corner-all');
                    content.append($('<tr/>').append($('<td>' + fm.i18n(name) + '</td>')).append($('<td/>').append(input)));
                });

                opts.buttons[fm.i18n('btnMount')] = function() {
                    var data = { cmd: 'netmount' };

                    $.each(inputs, function(name, input) {
                        var val = $.trim(input.val());

                        if (val) {
                            data[name] = val;
                        }
                    });

                    if (!data.host) {
                        return self.fm.trigger('error', { error: 'errNetMountHostReq' });
                    }

                    self.fm.request({ data: data, notify: { type: 'netmount', cnt: 1 } })
                        .done(function() { dfrd.resolve(); })
                        .fail(function(error) { dfrd.reject(error); });

                    self.dialog.elfinderdialog('close');
                };
                opts.buttons[fm.i18n('btnCancel')] = function() {
                    self.dialog.elfinderdialog('close');
                };
                return fm.dialog(content, opts);
            };

        if (!self.dialog) {
            self.dialog = create();
        }

        return dfrd.promise();
    };
};
"use strict";
elFinder.prototype.commands.more = function() {
    this.options = { ui: 'morebutton' };

    this.getstate = function() {
        var sel = this.fm.selectedFiles();

        return sel.length >= 1 ? 0 : -1;
    };
    this.exec = function(commandName) {
        var fm = this.fm,
            com,
            c = 'class',
            disabled = fm.res(c, 'disabled'),
            commands = fm._commands;

        if ((com = commands[commandName])) {
            if (!$(this).is('.' + disabled)) {
                com.exec();
            }
        }
        return $.Deferred().resolve();
    };
};
"use strict"
elFinder.prototype.commands.infobarcmd = function() {
	this.getstate = function() {
	    if (this.fm.selectedFiles().length >=1) return 0;
	    else return -1;
	}
	
	this.exec = function(info) {
	    var fm = this.fm,
	        c = 'class',
	        iconClass = "elfinder-cwd-icon {class} ui-corner-all",
	        sel = this.fm.selectedFiles(),
	        disabled = fm.res(c, 'disabled'),
	        infobar = fm.ui['infobar'],
            selblock = infobar.find('.selectblock'),
	        icon = infobar.find(".selectico span:first"),
	        name = infobar.find(".title"),
	        lastChange = infobar.find(".dateblock span.datespan"),
            size = infobar.find(".dateblock span.sizespan"),
	        cryptInfo = infobar.find(".signature"),
            cryptblock = '<div class="havesig">' +
			'<div class="icoblock">'+

				'<span class="{icon}"></span>' +
			'</div>'+
			'<div class="textblock">'+
				'<div class="top">'+
					'<div class="actiontitle">'+
						'<a href="#" class="action">{action}</a>' +
					'</div>'+
				'</div>'+
				'<div class="bottom">'+
				'</div>'+
			'</div>'+
			'</div>',

            cryptlist = "<div class='cert-list'>" +
                "<span class='elfinder-button-icon elfinder-button-icon-{icon}'/>"+
                "<span class='list-type'>{type}</span>" +
	            "<span class='list-count'>({count})</span>" +
	            "<span class='elfinder-button-icon elfinder-button-icon-info-more'/>",
	        clear = function() {
	            if (infobar) {
	                icon.removeClass();
	                name.text("");
	                lastChange.text("");
	                cryptInfo.empty();
	            }
	        },
            item = 'elfinder-button-menu-item',
            hover = fm.res('class', 'hover'),
            menu = $('<div class="ui-widget ui-widget-content elfinder-button-menu ui-corner-all"/>')
	            .hide()
	            //.delegate('.' + item, 'hover', function () { $(this).toggleClass(hover); })
	            .delegate('.' + item, 'click', function (e) {
	                e.preventDefault();
	                e.stopPropagation();
	                menu.hide();
	            }),
            hide=function() {
                menu.hide();
            },
            addItem = function (type, block) {
                    menu.append($('<div class="' + item + '"/>').append(block));

                },
	        getBlock = function (type, certinfo) {


	            var iconcl = type == 1 ? 'encrypt' : 'sign';
	            var block = cryptblock.replace('{icon}', 'elfinder-cwd-icon elfinder-cwd-icon-' + iconcl + ' ui-corner-all');
	            block = block.replace('{action}', type == 1 ? fm.i18n("encrypted") : fm.i18n("signed"));
	            
	            var com, button, link;
	            block = $(block);
	            if (certinfo.Thumbprint && certinfo.SubjectName) {
	                if ((com = fm._commands['certdownload'])) {
	                    button = 'elfinder' + 'linkbutton';
                        var isTest = certinfo.IsTest ? '<span class="test-certificate-icon no-padding js-test-certificate-tip" id="testTip-'+certinfo.Thumbprint+'"></span>'+certinfo.SubjectName : certinfo.SubjectName;
	                    if ($.fn[button]) link = $('<div/>')[button](com, certinfo.Thumbprint, isTest);
	                    block.find(".bottom").append(link);
	                }

	                var commandName = type == 1 ? 'decrypt' : 'checksign';
	                if ((com = fm._commands[commandName])) {
	                    button = 'elfinder' + 'linkbutton';
	                    if ($.fn[button]) link = $('<div/>')[button](com);
	                    block.find(".actiontitle").append(link);
	                }
	            } else {
	                block.find(".actiontitle").css('padding-top','11px');
	            }

	            return block;
	        };

	    if (info) {
	        cryptInfo.empty();
	        infobar.find(".dateblock div div").addClass('ui-state-disabled');
	        if (info == 'Empty') {
	            cryptInfo.prepend($("<h3>").text(fm.i18n("emptycryptinfo")));
	        }else if (info.Certificates.length==0) {
	            cryptInfo.prepend($("<h3>").text(fm.i18n("cryptinfonocert")));
	        }else {
	            if (info.Certificates.length > 1) {
                    for (var i = 0; i < info.Certificates.length; i++) {
	                    var cert = info.Certificates[i];
	                    addItem(info.FileType, getBlock(info.FileType, cert));
                    }
                    var iconcl = info.FileType == 1 ? 'encrypt' : 'sign';
                    cryptlist = cryptlist.replace('{icon}',iconcl);
                    cryptlist = cryptlist.replace('{type}', info.FileType == 1 ? fm.i18n("encrypted") : fm.i18n("signed"));
                    cryptlist = cryptlist.replace('{count}', info.Certificates.length +' ' + fm.i18n("times"));

                    cryptlist = $(cryptlist).bind('hover', function () { $(this).toggleClass(hover); });
                    cryptlist.find('.elfinder-button-icon').click(function (e) {
                        e.stopPropagation();
                        menu.slideToggle(100);
	                });

	                cryptInfo.append(cryptlist);
	                cryptInfo.append(menu);

	                fm.bind('disable select', hide).getUI().click(hide);
	            } else {

	                cryptInfo.append(getBlock(info.FileType, info.Certificates[0]));
	            }
                var regTipOptions = {
                    tipJoint: "left",
                    background: '#fff5d2',
                    borderRadius: 4,
                    borderWidth: 1,
                    borderColor: '#fee8ae'
                };
                $(".js-test-certificate-tip").each(function(i,el){
                    new Opentip($(el), 'Сертификат выпущен без участия<br>аккредитованного Удостоверяющего<br>Центра и не имеет юридической силы.', '', regTipOptions);
                });
	        }

	        return $.Deferred().resolve();
	    }

	    if (infobar) {
	        clear();
	        var file;
            var acceptExt = ['ods','xls','xlsb','xlsx','ods','xlsb','xlsm','xlsx','odp','pot','potm','potx',
                'pps','ppsm','ppsx','ppt','pptm','pptx','odp','ppsx','pptx','doc','docm','docx','dot',
                'dotm','dotx','odt','pdf','one','onetoc2','jpg','jpeg','gif','png','bmp','xml'];
            var ext = '';
	        if (sel.length == 1 && (file = sel[0]) && file && file.mime != "directory") {

                if (file.name !== null) {
                    ext = file.name.split('.');
                    ext = ext[ext.length-1];


                    $(infobar).find(".js-visaulize").data('type',file.VisualizationType);

                    if (acceptExt.indexOf(ext.toLowerCase()) !== -1) {

                        $(infobar).find(".js-visaulize").css('display', 'block');
                    }  else {
                        $(infobar).find(".js-visaulize").css('display', 'none');
                    }
                }

	            iconClass = iconClass.replace('{class}', fm.mime2class(file.mime));
	            icon.removeClass().addClass(iconClass);
	            name.text(file.name);
	            lastChange.text(fm.formatDate(file));
	            size.text(fm.formatSize(file.size));
	            $(infobar).find(".rename:first").css('display', 'block');
	            $(infobar).find(".dateblock:first").css('display', 'block');
	            selblock.show();
	        } else if (sel.length > 1) {
	            $(infobar).find(".rename:first").css('display', 'none');
	            $(infobar).find(".dateblock:first").css('display', 'none');
	            iconClass = iconClass.replace('{class}', 'elfinder-cwd-icon-group');
	            icon.removeClass().addClass(iconClass);
	            name.text(fm.i18n("infosel") + sel.length);
	            selblock.show();
	        } else selblock.hide();
	    }
	    return $.Deferred().resolve();
	}
}
"use strict";
elFinder.prototype.commands.encrypt = function() {

    this.getstate = function() {
        var sel = this.fm.selectedFiles(),
            cnt = sel.length;

        var files = $.map(sel, function(f) { return f.mime == 'directory' ? null : f; });
        return cnt >= 1 && cnt == files.length ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            cwd = fm.cwd().hash,
            files = this.files(hashes),
            cnt = files.length,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.phash) {
                return !dfrd.reject(['errRm', file.name, 'errPerm']);
            }
            if (file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }
        });

        if (dfrd.state() == 'pending') {
            files = this.hashes(hashes);

            //fm.lockfiles({ files: files });
            fm.request({
                    data: { cmd: 'encrypt', targets: files },
                    notify: { type: 'encrypt', cnt: cnt },
                    preventFail: true
                })
                .fail(function(error) {
                    dfrd.reject(error);
                })
                .done(function(data) {
                        var com;
                        if ((com = fm._commands['post'])) {
                            com.exec(fm.MasterUrl, data);
                        }
                        dfrd.done();
                    }
                ).always(function() {
                    //fm.unlockfiles({ files: files });
                });
        }

        return dfrd;
    };
};
"use strict";
elFinder.prototype.commands.decrypt = function() {

    this.getstate = function() {
        var sel = this.fm.selectedFiles(),
            cnt = sel.length;

        var files = $.map(sel, function(f) { return f.mime == 'directory' ? null : f; });
        return cnt >= 1 && cnt == files.length ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            cwd = fm.cwd().hash,
            files = this.files(hashes),
            cnt = files.length,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.phash) {
                return !dfrd.reject(['errRm', file.name, 'errPerm']);
            }
            if (file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }
        });

        if (dfrd.state() == 'pending') {
            files = this.hashes(hashes);

            //fm.lockfiles({ files: files });
            fm.request({
                    data: { cmd: 'decrypt', targets: files },
                    notify: { type: 'decrypt', cnt: cnt },
                    preventFail: true
                })
                .fail(function(error) {
                    dfrd.reject(error);
                })
                .done(function(data) {
                        var com;
                        if ((com = fm._commands['post'])) {
                            com.exec(fm.MasterUrl, data);
                        }
                        dfrd.done();
                    }
                ).always(function() {
                    //fm.unlockfiles({ files: files });
                });
        }

        return dfrd;
    };
};
"use strict";
elFinder.prototype.commands.checksign = function() {

    this.getstate = function() {
        var sel = this.fm.selectedFiles(),
            cnt = sel.length;

        var files = $.map(sel, function(f) { return f.mime == 'directory' ? null : f; });
        return cnt >= 1 && cnt == files.length ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            cwd = fm.cwd().hash,
            files = this.files(hashes),
            cnt = files.length,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.phash) {
                return !dfrd.reject(['errRm', file.name, 'errPerm']);
            }
            if (file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }
        });

        if (dfrd.state() == 'pending') {
            files = this.hashes(hashes);

            //fm.lockfiles({ files: files });
            fm.request({
                    data: { cmd: 'checksign', targets: files },
                    notify: { type: 'checksign', cnt: cnt },
                    preventFail: true
                })
                .fail(function(error) {
                    dfrd.reject(error);
                })
                .done(function(data) {
                        var com;
                        if ((com = fm._commands['post'])) {
                            com.exec(fm.MasterUrl, data);
                        }
                        dfrd.done();
                    }
                ).always(function() {
                    //fm.unlockfiles({ files: files });
                });
        }

        return dfrd;
    };
};
"use strict";
elFinder.prototype.commands.receivedmail = function () {
    var self = this,
        fm = self.fm;

    this.getstate = function () {
        return 0;
    };

    fm.bind('received', function () {
        var guid = fm.GetReceivedMailId();
        if (guid) {
            self.exec(guid);
        }
    });
    var $elFinder = $('#elfinder');

    this.exec = function (id) {
        $elFinder.find('#modal .popup').parent().remove();

        var disabled = fm.res('class', 'disabled'),
            hover = fm.res('class', 'hover'),
            popup = $('<div id="modal"><div class="window received-popup popup">' +
                '<div class="header"><h2>' + fm.i18n("receivedmailheader") + '</h2><div class="close"></div></div>' +
                '<div class="scroll-wrap">' +
                '<div class="scroller">' +
                '<div class="img">' +
                '<img src="../../Content/Images/preloader.GIF">' +
                '</div>' +
                '<div class="info">' +
                '<div class="message"></div>' +
                '</div>' +
                '<div class="documents-list ui-helper-clearfix elfinder-cwd ui-selectable ui-droppable elfinder-cwd-view-list"><table></table></div>' +
                '</div>' +
                '<div class="scroller__bar-wrapper"><div class="scroller__bar"></div></div>' +
                '</div>' +
                '<div class="buttons right">' +
                '<div class="elfinder-buttonset">' +
                '<div class="ui-state-default elfinder-button elfinder-link-button" title="' + fm.i18n('cmdcancel2') + '">' +
                '<a class="elfinder-button-text">' + fm.i18n('cmdcancel2') + '</a></div></div>' +
                '<div class="elfinder-buttonset btn btn-big btn-green">' + fm.i18n('gomaster') + '</div>' +
                //'<div class="elfinder-buttonset ui-elfinder-button-green">' +
                //'<div class="ui-state-default elfinder-button" title="' + fm.i18n('gomaster') + '">' +
                //'<span class="elfinder-button-text">' + fm.i18n('gomaster') + '</span></div></div>' +
                '</div>' +
                '</div></div>'),
            mainbut = popup.find('.btn.btn-big.btn-green').addClass(disabled),
            document = '' +
                '<tr  class="elfinder-cwd-file document js-visualize" >' +
                '<td class="name" title="{title}">' +
                '<div class="elfinder-cwd-file-wrapper">' +
                '<span class="elfinder-cwd-icon {icon}"></span>' +
                '<span class="elfinder-cwd-filename">{title}</span>' +
                '</div>' +
                '<div class="top">' +
                '<div class="path js-path" style="display:none">{path}</div>' +
                '<div class="lastChange" style="display:none">{lastChange}</div>' +
                '<div class="operationtype" style="display:none"></div>' +
                '</div>' +
                '</td>' +
                '<td class="kind" title="{type}">{type}</td>' +
                '<td class="actions text-right right" ><a href="#" class="action"></a></td>' +
                '</tr>',

            actionHandler = function (me) {
                var com;
                var file = { name: null, path: null, lastChange: null, mime: null };
                var doc = $(me).parents('.document');
                var type = doc.find('.top .operationtype').text();
                file.path = doc.find('.top .path').text();
                file.lastChange = doc.find('.top .lastChange').text();
                if ((com = fm._commands['post'])) {
                    var data = { Type: type, Files: [] };
                    data.Files.push(file);
                    com.exec(fm.MasterUrl, data);
                }
            },
            addFilesInPopup = function (fs) {

                if (!fs.length || fs.length == 0) showErrorBlock();
                popup.find('.img').hide();
                for (var key in fs) {
                    var file = fs[key];
                    var docPattern = document;

                    docPattern = docPattern.replace('{title}', file.name);
                    docPattern = docPattern.replace('{title}', file.name);
                    docPattern = docPattern.replace('{path}', file.path);
                    docPattern = docPattern.replace('{lastChange}', file.lastChange);
                    docPattern = docPattern.replace('{icon}', fm.mime2class(file.mime));
                    docPattern = docPattern.replace('{type}', fm.mime2kind(file));
                    docPattern = docPattern.replace('{type}', fm.mime2kind(file));
                    docPattern = $(docPattern);

                    var ext = file.name.split('.').pop();
                    var cmd = docPattern.find(".right a");
                    var type = file.type;
                    if (type == 3) {
                        cmd.text(fm.i18n('cmd' + 'decrypt'));
                        docPattern.find(".top .operationtype").text(type);
                        cmd.click(function () {
                            actionHandler($(this));
                        });
                    } else if (type == 4) {
                        cmd.text(fm.i18n('cmd' + 'checksign'));
                        docPattern.find(".top .operationtype").text(type);
                        cmd.click(function (e) {
                            actionHandler($(this));
                        });
                    } else if (type == 6) {
                        cmd.text(fm.i18n('cmd' + 'decryptandchecksign'));
                        docPattern.find(".top .operationtype").text(type);
                        cmd.click(function (e) {
                            actionHandler($(this));
                        });
                    }
                    else {
                        cmd.remove();
                    }

                    popup.find('.documents-list table').append(docPattern);
                }
            },
            checkButton = function () {
                if (popup.find('.documents-list').is(':empty')) {
                    mainbut.removeClass(hover).addClass(disabled);
                } else {
                    mainbut.removeClass(disabled);
                }
            },
            showErrorBlock = function () {
                popup.find('.info').show();
                popup.find('.img').hide();
                popup.find('.info .message')
                    .addClass('error')
                    .text(fm.i18n('errreceivedmail'));
            },
            dfrd = $.Deferred()
                .fail(function (error) {
                    error && fm.error(error);
                });
        checkButton();
        popup.find('.info').hide();
        popup.find('.close')
            .bind('hover', function () {
                $(this).toggleClass(hover);
            })
            .click(function () {
                window.location.href = window.location.href.split('?')[0];
            });
        popup.find('.buttons .elfinder-link-button a').click(function () {
            window.location.href = window.location.href.split('?')[0];
        });

        mainbut
            .click(function () {

                if (!mainbut.is('.' + disabled)) {
                    var docList = popup.find('.documents-list').children().find('tr');
                    var data = { Type: null, Files: [] };
                    var types = [];
                    $.each(docList, function (i, doc) {
                        doc = $(doc);
                        var file = { name: null, path: null, lastChange: null, mime: null };
                        types.push(doc.find('.top .operationtype').text());
                        file.path = doc.find('.top .path').text();
                        file.lastChange = doc.find('.top .lastChange').text();
                        data.Files.push(file);
                    });
                    var type1 = types[0];
                    var undefOper = false;
                    for (var key in types) {
                        if (types[key] != type1) {
                            undefOper = true;
                        }
                    }
                    if (!undefOper && type1 != "") data.Type = type1;
                    var com;
                    if ((com = fm._commands['post'])) {
                        com.exec(fm.MasterUrl, data);
                    }
                }
            })
            .bind("mouseenter mouseleave", function () {
                checkButton();
            })
            .bind('hover', function () {
                !$(this).is('.' + disabled) && $(this).toggleClass(hover);
            });

        $elFinder.append(popup);

        window.scroll = baron({
            root: '.scroll-wrap',
            scroller: '.scroller',
            bar: '.scroller__bar',
            barOnCls: 'baron'
        });



        fm.request({
            data: { cmd: 'recivedmail', fileGroupSendId: id },
            preventFail: true
        })
            .fail(function (error) {
                showErrorBlock();
                window.console && window.console.log && window.console.log(error);
                dfrd.reject();
            })
            .done(function (data) {
                addFilesInPopup(data.Files);
                $('.js-visualize').on('click', function (e) {

                    if ($(e.target).hasClass('action'))
                        return false;

                    var path = $(this).find('.js-path').html();

                    var acceptExt = ['ods','xls','xlsb','xlsx','ods','xlsb','xlsm','xlsx','odp','pot','potm','potx',
                        'pps','ppsm','ppsx','ppt','pptm','pptx','odp','ppsx','pptx','doc','docm','docx','dot',
                        'dotm','dotx','odt','pdf','one','onetoc2','jpg','jpeg','gif','png','bmp','xml'];
                    var name =  path.split('/');
                    var ext = '';
                    name = name[name.length-1];
                    if (name !== null) {
                        ext = name.split('.');
                        ext = ext[ext.length-1];
                        if (acceptExt.indexOf(ext.toLowerCase()) !== -1) {
                            $.fancybox('#no-visualize',{
                                wrapCSS : 'no-visualiseModal',
                                autoSize	: true,
                                autoResize	: true,
                                scrolling: 'no',
                                afterClose: function() {
                                    window.visualState = false;
                                }
                            });
                        }
                    }

                    $.ajax({
                        url: '/helper/GetVisualizationInfo',async: false,type: "GET",data: {filename: path},
                        success: function (result) {
                            if (!result.Error) {
                                var len = 100;
                                if (name.length > len) {
                                    name = '...'+name.substring(name.length-len, name.length);
                                }
                                if (result.VisualizationUrl) {
                                    var leng=40;
                                    if (name.length > leng) {
                                        name = '...'+name.substring(name.length-leng, name.length);
                                    }
                                    $.fancybox({href : result.VisualizationUrl,type: 'iframe'},{
                                        helpers: {title: {position: 'top'}},
                                        maxWidth	: 700,
                                        height      : 1000,
                                        minWidth	: 200,
                                        autoSize	: true,
                                        autoResize	: true,
                                        scrolling: 'no',
                                        topRatio: 0,
                                        margin: [20, 20, 90, 20],
                                        closeClick	: false,
                                        openEffect	: 'fade',
                                        wrapCSS     : 'visualiseModal',
                                        title       : name,
                                        afterClose: function() {
                                            window.visualState = false;
                                        }
                                    });
                                } else {

                                    $.fancybox("<img align='center' width='100%' style='margin: 0 auto;display: block;' src='data:image/jpg;base64,"+result.Base64Picture+"'>",{
                                        helpers: {title: {position: 'top'}},
                                        aspectRatio : true,
                                        fitToView	: true,
                                        autoSize	: true,
                                        autoResize	: true,
                                        scrolling: 'no',
                                        topRatio: 0,
                                        margin: [20, 20, 90, 20],
                                        closeClick	: false,
                                        openEffect	: 'fade',
                                        wrapCSS     : 'visualiseModal',
                                        title       : name,
                                        afterClose: function() {
                                            window.visualState = false;
                                        }
                                    });
                                }
                            } else {
                                $.fancybox('#no-visualize',{
                                    wrapCSS : 'no-visualiseModal',
                                    autoSize	: true,
                                    autoResize	: true,
                                    scrolling: 'no',
                                    afterClose: function() {
                                        window.visualState = false;
                                    }
                                });
                            }
                        },
                        error: function (request, error, result) {}
                    });
                });
                checkButton();
                dfrd.done();
            })
            .always(function () {
                window.scroll && window.scroll.update();
            });
        return dfrd;
    }
};

"use strict";
elFinder.prototype.commands.opensendpopup = function() {
    var self = this,
        filter = function(hashes) {
            return $.map(self.files(hashes), function(f) { return f.mime == 'directory' ? null : f; });
        };
    this.getstate = function() {
        var sel = this.fm.selected(),
            cnt = sel.length;

        return sel.length >= 1 && sel.length <= 30 && cnt == filter(sel).length ? 0 : -1;
    };

    this.exec = function(hashes) {
        $('#elfinder').find('#modal').remove();
        var fm = this.fm,
            files = this.hashes(hashes),
            src = '/Default/sendmail?parent=elfinder&files=',
            popup = '<div id="modal"><div class="window send-popup popup">' +
                '<iframe src="{src}" style="border: none;height: 500px;width: 100%;"></iframe>' +
                '</div></div>',
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });

        fm.request({
                data: { cmd: 'geturi', targets: files },
                preventFail: true
            })
            .fail(function(error) {
                dfrd.reject(error);
            })
            .done(function(data) {
                var uri = encodeURIComponent(JSON.stringify(data.Files));
                src = src + uri;
                popup = popup.replace('{src}', src);
                $('#elfinder').append(popup);

                window.hidePopup = function() {
                        $('#elfinder').find('#modal .popup').parent().remove();
                    },
                    dfrd.done();
            });
    };
};
"use strict";
elFinder.prototype.commands.decryptandchecksign = function() {

    this.getstate = function() {
        var sel = this.fm.selectedFiles(),
            cnt = sel.length;

        var files = $.map(sel, function(f) { return f.mime == 'directory' ? null : f; });
        return cnt >= 1 && cnt == files.length ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            cwd = fm.cwd().hash,
            files = this.files(hashes),
            cnt = files.length,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.phash) {
                return !dfrd.reject(['errRm', file.name, 'errPerm']);
            }
            if (file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }
        });

        if (dfrd.state() == 'pending') {
            files = this.hashes(hashes);

            //fm.lockfiles({ files: files });
            fm.request({
                    data: { cmd: 'decryptandchecksign', targets: files },
                    notify: { type: 'decryptandchecksign', cnt: cnt },
                    preventFail: true
                })
                .fail(function(error) {
                    dfrd.reject(error);
                })
                .done(function(data) {
                        var com;
                        if ((com = fm._commands['post'])) {
                            com.exec(fm.MasterUrl, data);
                        }
                        dfrd.done();
                    }
                ).always(function() {
                    //fm.unlockfiles({ files: files });
                });
        }

        return dfrd;
    };
};
"use strict";
elFinder.prototype.commands.signandencrypt = function() {

    this.getstate = function() {
        var sel = this.fm.selectedFiles(),
            cnt = sel.length;

        var files = $.map(sel, function(f) { return f.mime == 'directory' ? null : f; });
        return cnt >= 1 && cnt == files.length ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            cwd = fm.cwd().hash,
            files = this.files(hashes),
            cnt = files.length,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.phash) {
                return !dfrd.reject(['errRm', file.name, 'errPerm']);
            }
            if (file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }
        });

        if (dfrd.state() == 'pending') {
            files = this.hashes(hashes);

            //fm.lockfiles({ files: files });
            fm.request({
                    data: { cmd: 'signandencrypt', targets: files },
                    notify: { type: 'signandencrypt', cnt: cnt },
                    preventFail: true
                })
                .fail(function(error) {
                    dfrd.reject(error);
                })
                .done(function(data) {
                        var com;
                        if ((com = fm._commands['post'])) {
                            com.exec(fm.MasterUrl, data);
                        }
                        dfrd.done();
                    }
                ).always(function() {
                    //fm.unlockfiles({ files: files });
                });
        }

        return dfrd;
    };
};
"use strict";
elFinder.prototype.commands.add = function() {

    this.getstate = function() {
        var sel = this.fm.selectedFiles(),
            cnt = sel.length;

        var files = $.map(sel, function(f) {
            return f.mime == 'directory' ? null : f;
        });
        return cnt >= 1 && cnt == files.length ? 0 : -1;
    };
    this.exec = function(hashes, opts) {

        var fm = this.fm,
            cwd = fm.cwd().hash,
            files = this.files(hashes),
            cnt = files.length,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.phash) {
                return !dfrd.reject(['errRm', file.name, 'errPerm']);
            }
            if (file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }
        });
        if (dfrd.state() == 'pending') {
            var file = this.fm.selectedFiles();
            files = this.hashes(hashes);
            fm.request({
                    data: { cmd: 'add', targets: files },
                    notify: { type: 'add', cnt: cnt },
                    preventFail: true
                })
                .fail(function(error) {
                    dfrd.reject(error);
                })
                .done(function(data) {
                        var href = window.location.href;
                        var key = '';
                        var m = href.match('key=([A-Za-z0-9_]*)');
                        if (m && m.length > 0) {
                            key = m[1];
                        }
                        if (parent.Master && parent.Master.OpenFilesEventHandler) {
                            parent.Master.OpenFilesEventHandler('addFile', { files: data.Files, key: key });
                        } else {
                            visualisation(data.Files,file, opts);
                        }
                        dfrd.done();
                    }
                ).always(function() {
                });
        }
        return dfrd;
    };
};
"use strict";
elFinder.prototype.commands.cancel = function() {
    this.options = { ui: 'linkbutton' };

    this.getstate = function() {
        return 0;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            cwd = fm.cwd().hash,
            files = this.files(hashes),
            cnt = files.length,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });
        fm.trigger('cancel');
        return dfrd;
    };
};
"use strict";
elFinder.prototype.commands.cryptinfo = function() {
    this.options = { ui: 'linkbutton' };

    this.getstate = function() {
        var sel = this.fm.selectedFiles();

        if (sel.length == 1) {
            var extension = sel[0].name.substr((sel[0].name.lastIndexOf('.') + 1));
            switch (extension) {
            case 'enc':
            case 'sig':
                return 0;
            default:
                return -1;
            }
        }

        return -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            cwd = fm.cwd().hash,
            files = this.files(hashes),
            cnt = files.length,
            cmd = fm._commands['infobarcmd'],
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.phash) {
                return !dfrd.reject(['errRm', file.name, 'errPerm']);
            }
            if (file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }
        });

        if (dfrd.state() == 'pending') {
            files = this.hashes(hashes);

            //fm.lockfiles({ files: files });
            fm.request({
                    data: { cmd: 'cryptinfo', targets: files },
                    notify: { type: 'cryptinfo', cnt: cnt },
                    preventFail: true
                })
                .fail(function(error) {
                    if (cmd) {
                        cmd.exec("Empty");
                    }
                    dfrd.done();
                })
                .done(function(data) {
                        if (cmd) {
                            cmd.exec(data);
                        }
                        dfrd.done();
                    }
                ).always(function() {
                    fm.unlockfiles({ files: files });
                });
        }

        return dfrd;
    };
};
"use strict";
elFinder.prototype.commands.certdownload = function() {
    var self = this,
        fm = this.fm;

    this.getstate = function() {
        return 0;
    };
    this.exec = function(certThumb) {
        var fm = this.fm,
            base = fm.options.url,
            dfrd = $.Deferred(),
            iframe = '',
            cdata = '',
            i = 1,
            url;

        if (this.disabled() || !certThumb) {
            return dfrd.reject();
        }

        if (fm.oldAPI) {
            fm.error('errCmdNoSupport');
            return dfrd.reject();
        }

        base += base.indexOf('?') === -1 ? '?' : '&';

        iframe += '<iframe class="downloader" id="downloader-cert" style="display:none" src="' +
            base + 'cmd=certdownload&target=' + certThumb + '&download=1"/>';

        $(iframe)
            .appendTo('body')
            .ready(function() {
                setTimeout(function() {
                    $(iframe).each(function() {
                        $('#' + $(this).attr('id')).remove();
                    });
                }, fm.UA.Firefox ? (20000 + (10000 * i)) : 10000); // give mozilla 20 sec + 10 sec for each file to be saved
            });

        return dfrd.resolve();
    };
};
"use strict";
elFinder.prototype.commands.filter = function() {
    this.options = { ui: 'filterbutton' };
    this.alwaysEnabled = true;
    this.updateOnSelect = false;
    this.getstate = function() {
        return 0;
    };

    this.filterState = 'NotCryptSign';
    this.filterFolder = '';

    this.exec = function(q) {
        var fm = this.fm,
            hash = fm.cwd().hash;
        //console.log(hash)
        if (typeof(q) == 'string' && q) {
            fm.trigger('filterstart', { query: q });

            return fm.request({
                data: { cmd: 'filter', target: hash, q: q },
                notify: { type: 'filter', cnt: 1, hideCnt: true }
            });
        }
        return $.Deferred().reject();
    };
};
"use strict";
elFinder.prototype.commands.post = function() {

    this.getstate = function() {
        return 0;
    };
    this.exec = function(path, data) {
        var fm = this.fm,
            method = 'post',
            form = $('<form/>').attr("method", method).attr("action", path),
            addHidden = function(name, value) {
                var hiddenField = document.createElement("input");
                hiddenField.setAttribute("type", "hidden");
                hiddenField.setAttribute("name", name);
                hiddenField.setAttribute("value", value);
                form.append(hiddenField);
            },
            constructElements = function(item, parentString) {
                if (typeof (item) == 'object') {
                    for (var key in item) {
                        if (item.hasOwnProperty(key) && item[key] != null) {
                            if (Object.prototype.toString.call(item[key]) === '[object Array]') {
                                for (var i = 0; i < item[key].length; i++) {
                                    constructElements(item[key][i], parentString + key + "[" + i + "]");
                                }
                            } else if (Object.prototype.toString.call(item[key]) === '[object Object]') {
                                constructElements(item[key], parentString + key + ".");
                            } else {
                                addHidden(parentString + key, item[key]);
                            }
                        }
                    }
                } else {
                    addHidden(parentString, item);
                }
            };
        if (data.Files) data.Files = JSON.stringify(data.Files);
        constructElements(data, "");

        $(document.body).append(form);
        $(form).submit();
    };
};
"use strict";
elFinder.prototype.commands.multiplyadd = function() {
    this.options = { ui: 'multiplyaddbutton' };

    this.getstate = function() {
        return 0;
    };
    this.exec = function(commandName) {
        var fm = this.fm,
            com,
            c = 'class',
            disabled = fm.res(c, 'disabled'),
            commands = fm._commands;

        if ((com = commands[commandName])) {
            if (!$(this).is('.' + disabled)) {
                com.exec();
            }
        }
        return $.Deferred().resolve();
    };
};
"use strict";
elFinder.prototype.commands.sign = function() {

    this.getstate = function() {
        var sel = this.fm.selectedFiles(),
            cnt = sel.length;

        var files = $.map(sel, function(f) { return f.mime == 'directory' ? null : f; });
        return cnt >= 1 && cnt == files.length ? 0 : -1;
    };
    this.exec = function(hashes) {
        var fm = this.fm,
            cwd = fm.cwd().hash,
            files = this.files(hashes),
            cnt = files.length,
            dfrd = $.Deferred()
                .fail(function(error) {
                    error && fm.error(error);
                });

        if (!cnt || this._disabled) {
            return dfrd.reject();
        }

        $.each(files, function(i, file) {
            if (!file.phash) {
                return !dfrd.reject(['errRm', file.name, 'errPerm']);
            }
            if (file.locked) {
                return !dfrd.reject(['errLocked', file.name]);
            }
        });

        if (dfrd.state() == 'pending') {
            files = this.hashes(hashes);

            //fm.lockfiles({ files: files });
            fm.request({
                    data: { cmd: 'sign', targets: files },
                    notify: { type: 'sign', cnt: cnt },
                    preventFail: true
                })
                .fail(function(error) {
                    dfrd.reject(error);
                })
                .done(function(data) {
                        var com;
                        if ((com = fm._commands['post'])) {
                            com.exec(fm.MasterUrl, data);
                        }
                        dfrd.done();
                    }
                ).always(function() {
                    //fm.unlockfiles({ files: files });
                });
        }

        return dfrd;
    };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS0xLjcuMS5taW4uanMiLCJqcXVlcnktdWktMS44LjExLm1pbi5qcyIsImVsRmluZGVyLmpzIiwiZWxGaW5kZXIudmVyc2lvbi5qcyIsImpxdWVyeS5lbGZpbmRlci5qcyIsImVsRmluZGVyLnJlc291cmNlcy5qcyIsImVsRmluZGVyLm9wdGlvbnMuanMiLCJlbEZpbmRlci5oaXN0b3J5LmpzIiwiZWxGaW5kZXIuY29tbWFuZC5qcyIsImVsZmluZGVyLnJ1LmpzIiwiZWxGaW5kZXJTdXBwb3J0VmVyMS5qcyIsImpxdWVyeS5kaWFsb2dlbGZpbmRlci5qcyIsIm92ZXJsYXkuanMiLCJ3b3Jrem9uZS5qcyIsIm5hdmJhci5qcyIsImRpYWxvZy5qcyIsInRyZWUuanMiLCJjd2QuanMiLCJ0b29sYmFyLmpzIiwiYnV0dG9uLmpzIiwiYmx1ZWJ1dHRvbi5qcyIsInVwbG9hZEJ1dHRvbi5qcyIsInZpZXdidXR0b24uanMiLCJzZWFyY2hidXR0b24uanMiLCJzb3J0YnV0dG9uLmpzIiwibW9yZWJ1dHRvbi5qcyIsInBhbmVsLmpzIiwiY29udGV4dG1lbnUuanMiLCJwYXRoLmpzIiwic3RhdC5qcyIsImluZm9iYXIuanMiLCJwbGFjZXMuanMiLCJsaW5rYnV0dG9uLmpzIiwiZmlsdGVyYnV0dG9uLmpzIiwiY3J5cHR4ZGlhbG9nLmpzIiwiYm90dG9tYWRkcGFuZWwuanMiLCJtdWx0aXBseWFkZGJ1dHRvbi5qcyIsImJhY2suanMiLCJmb3J3YXJkLmpzIiwicmVsb2FkLmpzIiwidXAuanMiLCJob21lLmpzIiwiY29weS5qcyIsInBhc3RlLmpzIiwib3Blbi5qcyIsInJtLmpzIiwiaW5mby5qcyIsImR1cGxpY2F0ZS5qcyIsInJlbmFtZS5qcyIsImhlbHAuanMiLCJnZXRmaWxlLmpzIiwibWtkaXIuanMiLCJta2ZpbGUuanMiLCJ1cGxvYWQuanMiLCJkb3dubG9hZC5qcyIsImVkaXQuanMiLCJxdWlja2xvb2suanMiLCJxdWlja2xvb2sucGx1Z2lucy5qcyIsImV4dHJhY3QuanMiLCJhcmNoaXZlLmpzIiwic2VhcmNoLmpzIiwidmlldy5qcyIsInJlc2l6ZS5qcyIsInNvcnQuanMiLCJuZXRtb3VudC5qcyIsIm1vcmUuanMiLCJpbmZvYmFyY21kLmpzIiwiZW5jcnlwdC5qcyIsImRlY3J5cHQuanMiLCJjaGVja3NpZ24uanMiLCJyZWNlaXZlZG1haWwuanMiLCJvcGVuc2VuZHBvcHVwLmpzIiwiZGVjcnlwdGFuZGNoZWNrc2lnbi5qcyIsInNpZ25hbmRlbmNyeXB0LmpzIiwiYWRkLmpzIiwiY2FuY2VsLmpzIiwiY3J5cHRpbmZvLmpzIiwiY2VydGRvd25sb2FkLmpzIiwiZmlsdGVyLmpzIiwicG9zdC5qcyIsIm11bHRpcGx5YWRkLmpzIiwic2lnbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6NkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoa0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6UEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDblVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNqTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeHpDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaEtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0lBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDekRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9NQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM5T0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3pKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN3lCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzFMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNVRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImVsZmluZGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohIGpRdWVyeSB2MS43LjEganF1ZXJ5LmNvbSB8IGpxdWVyeS5vcmcvbGljZW5zZSAqL1xuKGZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gY3koYSl7cmV0dXJuIGYuaXNXaW5kb3coYSk/YTphLm5vZGVUeXBlPT09OT9hLmRlZmF1bHRWaWV3fHxhLnBhcmVudFdpbmRvdzohMX1mdW5jdGlvbiBjdihhKXtpZighY2tbYV0pe3ZhciBiPWMuYm9keSxkPWYoXCI8XCIrYStcIj5cIikuYXBwZW5kVG8oYiksZT1kLmNzcyhcImRpc3BsYXlcIik7ZC5yZW1vdmUoKTtpZihlPT09XCJub25lXCJ8fGU9PT1cIlwiKXtjbHx8KGNsPWMuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKSxjbC5mcmFtZUJvcmRlcj1jbC53aWR0aD1jbC5oZWlnaHQ9MCksYi5hcHBlbmRDaGlsZChjbCk7aWYoIWNtfHwhY2wuY3JlYXRlRWxlbWVudCljbT0oY2wuY29udGVudFdpbmRvd3x8Y2wuY29udGVudERvY3VtZW50KS5kb2N1bWVudCxjbS53cml0ZSgoYy5jb21wYXRNb2RlPT09XCJDU1MxQ29tcGF0XCI/XCI8IWRvY3R5cGUgaHRtbD5cIjpcIlwiKStcIjxodG1sPjxib2R5PlwiKSxjbS5jbG9zZSgpO2Q9Y20uY3JlYXRlRWxlbWVudChhKSxjbS5ib2R5LmFwcGVuZENoaWxkKGQpLGU9Zi5jc3MoZCxcImRpc3BsYXlcIiksYi5yZW1vdmVDaGlsZChjbCl9Y2tbYV09ZX1yZXR1cm4gY2tbYV19ZnVuY3Rpb24gY3UoYSxiKXt2YXIgYz17fTtmLmVhY2goY3EuY29uY2F0LmFwcGx5KFtdLGNxLnNsaWNlKDAsYikpLGZ1bmN0aW9uKCl7Y1t0aGlzXT1hfSk7cmV0dXJuIGN9ZnVuY3Rpb24gY3QoKXtjcj1ifWZ1bmN0aW9uIGNzKCl7c2V0VGltZW91dChjdCwwKTtyZXR1cm4gY3I9Zi5ub3coKX1mdW5jdGlvbiBjaigpe3RyeXtyZXR1cm4gbmV3IGEuQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxIVFRQXCIpfWNhdGNoKGIpe319ZnVuY3Rpb24gY2koKXt0cnl7cmV0dXJuIG5ldyBhLlhNTEh0dHBSZXF1ZXN0fWNhdGNoKGIpe319ZnVuY3Rpb24gY2MoYSxjKXthLmRhdGFGaWx0ZXImJihjPWEuZGF0YUZpbHRlcihjLGEuZGF0YVR5cGUpKTt2YXIgZD1hLmRhdGFUeXBlcyxlPXt9LGcsaCxpPWQubGVuZ3RoLGosaz1kWzBdLGwsbSxuLG8scDtmb3IoZz0xO2c8aTtnKyspe2lmKGc9PT0xKWZvcihoIGluIGEuY29udmVydGVycyl0eXBlb2YgaD09XCJzdHJpbmdcIiYmKGVbaC50b0xvd2VyQ2FzZSgpXT1hLmNvbnZlcnRlcnNbaF0pO2w9ayxrPWRbZ107aWYoaz09PVwiKlwiKWs9bDtlbHNlIGlmKGwhPT1cIipcIiYmbCE9PWspe209bCtcIiBcIitrLG49ZVttXXx8ZVtcIiogXCIra107aWYoIW4pe3A9Yjtmb3IobyBpbiBlKXtqPW8uc3BsaXQoXCIgXCIpO2lmKGpbMF09PT1sfHxqWzBdPT09XCIqXCIpe3A9ZVtqWzFdK1wiIFwiK2tdO2lmKHApe289ZVtvXSxvPT09ITA/bj1wOnA9PT0hMCYmKG49byk7YnJlYWt9fX19IW4mJiFwJiZmLmVycm9yKFwiTm8gY29udmVyc2lvbiBmcm9tIFwiK20ucmVwbGFjZShcIiBcIixcIiB0byBcIikpLG4hPT0hMCYmKGM9bj9uKGMpOnAobyhjKSkpfX1yZXR1cm4gY31mdW5jdGlvbiBjYihhLGMsZCl7dmFyIGU9YS5jb250ZW50cyxmPWEuZGF0YVR5cGVzLGc9YS5yZXNwb25zZUZpZWxkcyxoLGksaixrO2ZvcihpIGluIGcpaSBpbiBkJiYoY1tnW2ldXT1kW2ldKTt3aGlsZShmWzBdPT09XCIqXCIpZi5zaGlmdCgpLGg9PT1iJiYoaD1hLm1pbWVUeXBlfHxjLmdldFJlc3BvbnNlSGVhZGVyKFwiY29udGVudC10eXBlXCIpKTtpZihoKWZvcihpIGluIGUpaWYoZVtpXSYmZVtpXS50ZXN0KGgpKXtmLnVuc2hpZnQoaSk7YnJlYWt9aWYoZlswXWluIGQpaj1mWzBdO2Vsc2V7Zm9yKGkgaW4gZCl7aWYoIWZbMF18fGEuY29udmVydGVyc1tpK1wiIFwiK2ZbMF1dKXtqPWk7YnJlYWt9a3x8KGs9aSl9aj1qfHxrfWlmKGope2ohPT1mWzBdJiZmLnVuc2hpZnQoaik7cmV0dXJuIGRbal19fWZ1bmN0aW9uIGNhKGEsYixjLGQpe2lmKGYuaXNBcnJheShiKSlmLmVhY2goYixmdW5jdGlvbihiLGUpe2N8fGJFLnRlc3QoYSk/ZChhLGUpOmNhKGErXCJbXCIrKHR5cGVvZiBlPT1cIm9iamVjdFwifHxmLmlzQXJyYXkoZSk/YjpcIlwiKStcIl1cIixlLGMsZCl9KTtlbHNlIGlmKCFjJiZiIT1udWxsJiZ0eXBlb2YgYj09XCJvYmplY3RcIilmb3IodmFyIGUgaW4gYiljYShhK1wiW1wiK2UrXCJdXCIsYltlXSxjLGQpO2Vsc2UgZChhLGIpfWZ1bmN0aW9uIGJfKGEsYyl7dmFyIGQsZSxnPWYuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zfHx7fTtmb3IoZCBpbiBjKWNbZF0hPT1iJiYoKGdbZF0/YTplfHwoZT17fSkpW2RdPWNbZF0pO2UmJmYuZXh0ZW5kKCEwLGEsZSl9ZnVuY3Rpb24gYiQoYSxjLGQsZSxmLGcpe2Y9Znx8Yy5kYXRhVHlwZXNbMF0sZz1nfHx7fSxnW2ZdPSEwO3ZhciBoPWFbZl0saT0wLGo9aD9oLmxlbmd0aDowLGs9YT09PWJULGw7Zm9yKDtpPGomJihrfHwhbCk7aSsrKWw9aFtpXShjLGQsZSksdHlwZW9mIGw9PVwic3RyaW5nXCImJigha3x8Z1tsXT9sPWI6KGMuZGF0YVR5cGVzLnVuc2hpZnQobCksbD1iJChhLGMsZCxlLGwsZykpKTsoa3x8IWwpJiYhZ1tcIipcIl0mJihsPWIkKGEsYyxkLGUsXCIqXCIsZykpO3JldHVybiBsfWZ1bmN0aW9uIGJaKGEpe3JldHVybiBmdW5jdGlvbihiLGMpe3R5cGVvZiBiIT1cInN0cmluZ1wiJiYoYz1iLGI9XCIqXCIpO2lmKGYuaXNGdW5jdGlvbihjKSl7dmFyIGQ9Yi50b0xvd2VyQ2FzZSgpLnNwbGl0KGJQKSxlPTAsZz1kLmxlbmd0aCxoLGksajtmb3IoO2U8ZztlKyspaD1kW2VdLGo9L15cXCsvLnRlc3QoaCksaiYmKGg9aC5zdWJzdHIoMSl8fFwiKlwiKSxpPWFbaF09YVtoXXx8W10saVtqP1widW5zaGlmdFwiOlwicHVzaFwiXShjKX19fWZ1bmN0aW9uIGJDKGEsYixjKXt2YXIgZD1iPT09XCJ3aWR0aFwiP2Eub2Zmc2V0V2lkdGg6YS5vZmZzZXRIZWlnaHQsZT1iPT09XCJ3aWR0aFwiP2J4OmJ5LGc9MCxoPWUubGVuZ3RoO2lmKGQ+MCl7aWYoYyE9PVwiYm9yZGVyXCIpZm9yKDtnPGg7ZysrKWN8fChkLT1wYXJzZUZsb2F0KGYuY3NzKGEsXCJwYWRkaW5nXCIrZVtnXSkpfHwwKSxjPT09XCJtYXJnaW5cIj9kKz1wYXJzZUZsb2F0KGYuY3NzKGEsYytlW2ddKSl8fDA6ZC09cGFyc2VGbG9hdChmLmNzcyhhLFwiYm9yZGVyXCIrZVtnXStcIldpZHRoXCIpKXx8MDtyZXR1cm4gZCtcInB4XCJ9ZD1ieihhLGIsYik7aWYoZDwwfHxkPT1udWxsKWQ9YS5zdHlsZVtiXXx8MDtkPXBhcnNlRmxvYXQoZCl8fDA7aWYoYylmb3IoO2c8aDtnKyspZCs9cGFyc2VGbG9hdChmLmNzcyhhLFwicGFkZGluZ1wiK2VbZ10pKXx8MCxjIT09XCJwYWRkaW5nXCImJihkKz1wYXJzZUZsb2F0KGYuY3NzKGEsXCJib3JkZXJcIitlW2ddK1wiV2lkdGhcIikpfHwwKSxjPT09XCJtYXJnaW5cIiYmKGQrPXBhcnNlRmxvYXQoZi5jc3MoYSxjK2VbZ10pKXx8MCk7cmV0dXJuIGQrXCJweFwifWZ1bmN0aW9uIGJwKGEsYil7Yi5zcmM/Zi5hamF4KHt1cmw6Yi5zcmMsYXN5bmM6ITEsZGF0YVR5cGU6XCJzY3JpcHRcIn0pOmYuZ2xvYmFsRXZhbCgoYi50ZXh0fHxiLnRleHRDb250ZW50fHxiLmlubmVySFRNTHx8XCJcIikucmVwbGFjZShiZixcIi8qJDAqL1wiKSksYi5wYXJlbnROb2RlJiZiLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYil9ZnVuY3Rpb24gYm8oYSl7dmFyIGI9Yy5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2JoLmFwcGVuZENoaWxkKGIpLGIuaW5uZXJIVE1MPWEub3V0ZXJIVE1MO3JldHVybiBiLmZpcnN0Q2hpbGR9ZnVuY3Rpb24gYm4oYSl7dmFyIGI9KGEubm9kZU5hbWV8fFwiXCIpLnRvTG93ZXJDYXNlKCk7Yj09PVwiaW5wdXRcIj9ibShhKTpiIT09XCJzY3JpcHRcIiYmdHlwZW9mIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWUhPVwidW5kZWZpbmVkXCImJmYuZ3JlcChhLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIiksYm0pfWZ1bmN0aW9uIGJtKGEpe2lmKGEudHlwZT09PVwiY2hlY2tib3hcInx8YS50eXBlPT09XCJyYWRpb1wiKWEuZGVmYXVsdENoZWNrZWQ9YS5jaGVja2VkfWZ1bmN0aW9uIGJsKGEpe3JldHVybiB0eXBlb2YgYS5nZXRFbGVtZW50c0J5VGFnTmFtZSE9XCJ1bmRlZmluZWRcIj9hLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiKlwiKTp0eXBlb2YgYS5xdWVyeVNlbGVjdG9yQWxsIT1cInVuZGVmaW5lZFwiP2EucXVlcnlTZWxlY3RvckFsbChcIipcIik6W119ZnVuY3Rpb24gYmsoYSxiKXt2YXIgYztpZihiLm5vZGVUeXBlPT09MSl7Yi5jbGVhckF0dHJpYnV0ZXMmJmIuY2xlYXJBdHRyaWJ1dGVzKCksYi5tZXJnZUF0dHJpYnV0ZXMmJmIubWVyZ2VBdHRyaWJ1dGVzKGEpLGM9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO2lmKGM9PT1cIm9iamVjdFwiKWIub3V0ZXJIVE1MPWEub3V0ZXJIVE1MO2Vsc2UgaWYoYyE9PVwiaW5wdXRcInx8YS50eXBlIT09XCJjaGVja2JveFwiJiZhLnR5cGUhPT1cInJhZGlvXCIpe2lmKGM9PT1cIm9wdGlvblwiKWIuc2VsZWN0ZWQ9YS5kZWZhdWx0U2VsZWN0ZWQ7ZWxzZSBpZihjPT09XCJpbnB1dFwifHxjPT09XCJ0ZXh0YXJlYVwiKWIuZGVmYXVsdFZhbHVlPWEuZGVmYXVsdFZhbHVlfWVsc2UgYS5jaGVja2VkJiYoYi5kZWZhdWx0Q2hlY2tlZD1iLmNoZWNrZWQ9YS5jaGVja2VkKSxiLnZhbHVlIT09YS52YWx1ZSYmKGIudmFsdWU9YS52YWx1ZSk7Yi5yZW1vdmVBdHRyaWJ1dGUoZi5leHBhbmRvKX19ZnVuY3Rpb24gYmooYSxiKXtpZihiLm5vZGVUeXBlPT09MSYmISFmLmhhc0RhdGEoYSkpe3ZhciBjLGQsZSxnPWYuX2RhdGEoYSksaD1mLl9kYXRhKGIsZyksaT1nLmV2ZW50cztpZihpKXtkZWxldGUgaC5oYW5kbGUsaC5ldmVudHM9e307Zm9yKGMgaW4gaSlmb3IoZD0wLGU9aVtjXS5sZW5ndGg7ZDxlO2QrKylmLmV2ZW50LmFkZChiLGMrKGlbY11bZF0ubmFtZXNwYWNlP1wiLlwiOlwiXCIpK2lbY11bZF0ubmFtZXNwYWNlLGlbY11bZF0saVtjXVtkXS5kYXRhKX1oLmRhdGEmJihoLmRhdGE9Zi5leHRlbmQoe30saC5kYXRhKSl9fWZ1bmN0aW9uIGJpKGEsYil7cmV0dXJuIGYubm9kZU5hbWUoYSxcInRhYmxlXCIpP2EuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0Ym9keVwiKVswXXx8YS5hcHBlbmRDaGlsZChhLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRib2R5XCIpKTphfWZ1bmN0aW9uIFUoYSl7dmFyIGI9Vi5zcGxpdChcInxcIiksYz1hLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtpZihjLmNyZWF0ZUVsZW1lbnQpd2hpbGUoYi5sZW5ndGgpYy5jcmVhdGVFbGVtZW50KGIucG9wKCkpO3JldHVybiBjfWZ1bmN0aW9uIFQoYSxiLGMpe2I9Ynx8MDtpZihmLmlzRnVuY3Rpb24oYikpcmV0dXJuIGYuZ3JlcChhLGZ1bmN0aW9uKGEsZCl7dmFyIGU9ISFiLmNhbGwoYSxkLGEpO3JldHVybiBlPT09Y30pO2lmKGIubm9kZVR5cGUpcmV0dXJuIGYuZ3JlcChhLGZ1bmN0aW9uKGEsZCl7cmV0dXJuIGE9PT1iPT09Y30pO2lmKHR5cGVvZiBiPT1cInN0cmluZ1wiKXt2YXIgZD1mLmdyZXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gYS5ub2RlVHlwZT09PTF9KTtpZihPLnRlc3QoYikpcmV0dXJuIGYuZmlsdGVyKGIsZCwhYyk7Yj1mLmZpbHRlcihiLGQpfXJldHVybiBmLmdyZXAoYSxmdW5jdGlvbihhLGQpe3JldHVybiBmLmluQXJyYXkoYSxiKT49MD09PWN9KX1mdW5jdGlvbiBTKGEpe3JldHVybiFhfHwhYS5wYXJlbnROb2RlfHxhLnBhcmVudE5vZGUubm9kZVR5cGU9PT0xMX1mdW5jdGlvbiBLKCl7cmV0dXJuITB9ZnVuY3Rpb24gSigpe3JldHVybiExfWZ1bmN0aW9uIG4oYSxiLGMpe3ZhciBkPWIrXCJkZWZlclwiLGU9YitcInF1ZXVlXCIsZz1iK1wibWFya1wiLGg9Zi5fZGF0YShhLGQpO2gmJihjPT09XCJxdWV1ZVwifHwhZi5fZGF0YShhLGUpKSYmKGM9PT1cIm1hcmtcInx8IWYuX2RhdGEoYSxnKSkmJnNldFRpbWVvdXQoZnVuY3Rpb24oKXshZi5fZGF0YShhLGUpJiYhZi5fZGF0YShhLGcpJiYoZi5yZW1vdmVEYXRhKGEsZCwhMCksaC5maXJlKCkpfSwwKX1mdW5jdGlvbiBtKGEpe2Zvcih2YXIgYiBpbiBhKXtpZihiPT09XCJkYXRhXCImJmYuaXNFbXB0eU9iamVjdChhW2JdKSljb250aW51ZTtpZihiIT09XCJ0b0pTT05cIilyZXR1cm4hMX1yZXR1cm4hMH1mdW5jdGlvbiBsKGEsYyxkKXtpZihkPT09YiYmYS5ub2RlVHlwZT09PTEpe3ZhciBlPVwiZGF0YS1cIitjLnJlcGxhY2UoayxcIi0kMVwiKS50b0xvd2VyQ2FzZSgpO2Q9YS5nZXRBdHRyaWJ1dGUoZSk7aWYodHlwZW9mIGQ9PVwic3RyaW5nXCIpe3RyeXtkPWQ9PT1cInRydWVcIj8hMDpkPT09XCJmYWxzZVwiPyExOmQ9PT1cIm51bGxcIj9udWxsOmYuaXNOdW1lcmljKGQpP3BhcnNlRmxvYXQoZCk6ai50ZXN0KGQpP2YucGFyc2VKU09OKGQpOmR9Y2F0Y2goZyl7fWYuZGF0YShhLGMsZCl9ZWxzZSBkPWJ9cmV0dXJuIGR9ZnVuY3Rpb24gaChhKXt2YXIgYj1nW2FdPXt9LGMsZDthPWEuc3BsaXQoL1xccysvKTtmb3IoYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyliW2FbY11dPSEwO3JldHVybiBifXZhciBjPWEuZG9jdW1lbnQsZD1hLm5hdmlnYXRvcixlPWEubG9jYXRpb24sZj1mdW5jdGlvbigpe2Z1bmN0aW9uIEooKXtpZighZS5pc1JlYWR5KXt0cnl7Yy5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGwoXCJsZWZ0XCIpfWNhdGNoKGEpe3NldFRpbWVvdXQoSiwxKTtyZXR1cm59ZS5yZWFkeSgpfX12YXIgZT1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgZS5mbi5pbml0KGEsYixoKX0sZj1hLmpRdWVyeSxnPWEuJCxoLGk9L14oPzpbXiM8XSooPFtcXHdcXFddKz4pW14+XSokfCMoW1xcd1xcLV0qKSQpLyxqPS9cXFMvLGs9L15cXHMrLyxsPS9cXHMrJC8sbT0vXjwoXFx3KylcXHMqXFwvPz4oPzo8XFwvXFwxPik/JC8sbj0vXltcXF0sOnt9XFxzXSokLyxvPS9cXFxcKD86W1wiXFxcXFxcL2JmbnJ0XXx1WzAtOWEtZkEtRl17NH0pL2cscD0vXCJbXlwiXFxcXFxcblxccl0qXCJ8dHJ1ZXxmYWxzZXxudWxsfC0/XFxkKyg/OlxcLlxcZCopPyg/OltlRV1bK1xcLV0/XFxkKyk/L2cscT0vKD86Xnw6fCwpKD86XFxzKlxcWykrL2cscj0vKHdlYmtpdClbIFxcL10oW1xcdy5dKykvLHM9LyhvcGVyYSkoPzouKnZlcnNpb24pP1sgXFwvXShbXFx3Ll0rKS8sdD0vKG1zaWUpIChbXFx3Ll0rKS8sdT0vKG1vemlsbGEpKD86Lio/IHJ2OihbXFx3Ll0rKSk/Lyx2PS8tKFthLXpdfFswLTldKS9pZyx3PS9eLW1zLS8seD1mdW5jdGlvbihhLGIpe3JldHVybihiK1wiXCIpLnRvVXBwZXJDYXNlKCl9LHk9ZC51c2VyQWdlbnQseixBLEIsQz1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLEQ9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxFPUFycmF5LnByb3RvdHlwZS5wdXNoLEY9QXJyYXkucHJvdG90eXBlLnNsaWNlLEc9U3RyaW5nLnByb3RvdHlwZS50cmltLEg9QXJyYXkucHJvdG90eXBlLmluZGV4T2YsST17fTtlLmZuPWUucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjplLGluaXQ6ZnVuY3Rpb24oYSxkLGYpe3ZhciBnLGgsaixrO2lmKCFhKXJldHVybiB0aGlzO2lmKGEubm9kZVR5cGUpe3RoaXMuY29udGV4dD10aGlzWzBdPWEsdGhpcy5sZW5ndGg9MTtyZXR1cm4gdGhpc31pZihhPT09XCJib2R5XCImJiFkJiZjLmJvZHkpe3RoaXMuY29udGV4dD1jLHRoaXNbMF09Yy5ib2R5LHRoaXMuc2VsZWN0b3I9YSx0aGlzLmxlbmd0aD0xO3JldHVybiB0aGlzfWlmKHR5cGVvZiBhPT1cInN0cmluZ1wiKXthLmNoYXJBdCgwKSE9PVwiPFwifHxhLmNoYXJBdChhLmxlbmd0aC0xKSE9PVwiPlwifHxhLmxlbmd0aDwzP2c9aS5leGVjKGEpOmc9W251bGwsYSxudWxsXTtpZihnJiYoZ1sxXXx8IWQpKXtpZihnWzFdKXtkPWQgaW5zdGFuY2VvZiBlP2RbMF06ZCxrPWQ/ZC5vd25lckRvY3VtZW50fHxkOmMsaj1tLmV4ZWMoYSksaj9lLmlzUGxhaW5PYmplY3QoZCk/KGE9W2MuY3JlYXRlRWxlbWVudChqWzFdKV0sZS5mbi5hdHRyLmNhbGwoYSxkLCEwKSk6YT1bay5jcmVhdGVFbGVtZW50KGpbMV0pXTooaj1lLmJ1aWxkRnJhZ21lbnQoW2dbMV1dLFtrXSksYT0oai5jYWNoZWFibGU/ZS5jbG9uZShqLmZyYWdtZW50KTpqLmZyYWdtZW50KS5jaGlsZE5vZGVzKTtyZXR1cm4gZS5tZXJnZSh0aGlzLGEpfWg9Yy5nZXRFbGVtZW50QnlJZChnWzJdKTtpZihoJiZoLnBhcmVudE5vZGUpe2lmKGguaWQhPT1nWzJdKXJldHVybiBmLmZpbmQoYSk7dGhpcy5sZW5ndGg9MSx0aGlzWzBdPWh9dGhpcy5jb250ZXh0PWMsdGhpcy5zZWxlY3Rvcj1hO3JldHVybiB0aGlzfXJldHVybiFkfHxkLmpxdWVyeT8oZHx8ZikuZmluZChhKTp0aGlzLmNvbnN0cnVjdG9yKGQpLmZpbmQoYSl9aWYoZS5pc0Z1bmN0aW9uKGEpKXJldHVybiBmLnJlYWR5KGEpO2Euc2VsZWN0b3IhPT1iJiYodGhpcy5zZWxlY3Rvcj1hLnNlbGVjdG9yLHRoaXMuY29udGV4dD1hLmNvbnRleHQpO3JldHVybiBlLm1ha2VBcnJheShhLHRoaXMpfSxzZWxlY3RvcjpcIlwiLGpxdWVyeTpcIjEuNy4xXCIsbGVuZ3RoOjAsc2l6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxlbmd0aH0sdG9BcnJheTpmdW5jdGlvbigpe3JldHVybiBGLmNhbGwodGhpcywwKX0sZ2V0OmZ1bmN0aW9uKGEpe3JldHVybiBhPT1udWxsP3RoaXMudG9BcnJheSgpOmE8MD90aGlzW3RoaXMubGVuZ3RoK2FdOnRoaXNbYV19LHB1c2hTdGFjazpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5jb25zdHJ1Y3RvcigpO2UuaXNBcnJheShhKT9FLmFwcGx5KGQsYSk6ZS5tZXJnZShkLGEpLGQucHJldk9iamVjdD10aGlzLGQuY29udGV4dD10aGlzLmNvbnRleHQsYj09PVwiZmluZFwiP2Quc2VsZWN0b3I9dGhpcy5zZWxlY3RvcisodGhpcy5zZWxlY3Rvcj9cIiBcIjpcIlwiKStjOmImJihkLnNlbGVjdG9yPXRoaXMuc2VsZWN0b3IrXCIuXCIrYitcIihcIitjK1wiKVwiKTtyZXR1cm4gZH0sZWFjaDpmdW5jdGlvbihhLGIpe3JldHVybiBlLmVhY2godGhpcyxhLGIpfSxyZWFkeTpmdW5jdGlvbihhKXtlLmJpbmRSZWFkeSgpLEEuYWRkKGEpO3JldHVybiB0aGlzfSxlcTpmdW5jdGlvbihhKXthPSthO3JldHVybiBhPT09LTE/dGhpcy5zbGljZShhKTp0aGlzLnNsaWNlKGEsYSsxKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soRi5hcHBseSh0aGlzLGFyZ3VtZW50cyksXCJzbGljZVwiLEYuY2FsbChhcmd1bWVudHMpLmpvaW4oXCIsXCIpKX0sbWFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhlLm1hcCh0aGlzLGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGEuY2FsbChiLGMsYil9KSl9LGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByZXZPYmplY3R8fHRoaXMuY29uc3RydWN0b3IobnVsbCl9LHB1c2g6RSxzb3J0OltdLnNvcnQsc3BsaWNlOltdLnNwbGljZX0sZS5mbi5pbml0LnByb3RvdHlwZT1lLmZuLGUuZXh0ZW5kPWUuZm4uZXh0ZW5kPWZ1bmN0aW9uKCl7dmFyIGEsYyxkLGYsZyxoLGk9YXJndW1lbnRzWzBdfHx7fSxqPTEsaz1hcmd1bWVudHMubGVuZ3RoLGw9ITE7dHlwZW9mIGk9PVwiYm9vbGVhblwiJiYobD1pLGk9YXJndW1lbnRzWzFdfHx7fSxqPTIpLHR5cGVvZiBpIT1cIm9iamVjdFwiJiYhZS5pc0Z1bmN0aW9uKGkpJiYoaT17fSksaz09PWomJihpPXRoaXMsLS1qKTtmb3IoO2o8aztqKyspaWYoKGE9YXJndW1lbnRzW2pdKSE9bnVsbClmb3IoYyBpbiBhKXtkPWlbY10sZj1hW2NdO2lmKGk9PT1mKWNvbnRpbnVlO2wmJmYmJihlLmlzUGxhaW5PYmplY3QoZil8fChnPWUuaXNBcnJheShmKSkpPyhnPyhnPSExLGg9ZCYmZS5pc0FycmF5KGQpP2Q6W10pOmg9ZCYmZS5pc1BsYWluT2JqZWN0KGQpP2Q6e30saVtjXT1lLmV4dGVuZChsLGgsZikpOmYhPT1iJiYoaVtjXT1mKX1yZXR1cm4gaX0sZS5leHRlbmQoe25vQ29uZmxpY3Q6ZnVuY3Rpb24oYil7YS4kPT09ZSYmKGEuJD1nKSxiJiZhLmpRdWVyeT09PWUmJihhLmpRdWVyeT1mKTtyZXR1cm4gZX0saXNSZWFkeTohMSxyZWFkeVdhaXQ6MSxob2xkUmVhZHk6ZnVuY3Rpb24oYSl7YT9lLnJlYWR5V2FpdCsrOmUucmVhZHkoITApfSxyZWFkeTpmdW5jdGlvbihhKXtpZihhPT09ITAmJiEtLWUucmVhZHlXYWl0fHxhIT09ITAmJiFlLmlzUmVhZHkpe2lmKCFjLmJvZHkpcmV0dXJuIHNldFRpbWVvdXQoZS5yZWFkeSwxKTtlLmlzUmVhZHk9ITA7aWYoYSE9PSEwJiYtLWUucmVhZHlXYWl0PjApcmV0dXJuO0EuZmlyZVdpdGgoYyxbZV0pLGUuZm4udHJpZ2dlciYmZShjKS50cmlnZ2VyKFwicmVhZHlcIikub2ZmKFwicmVhZHlcIil9fSxiaW5kUmVhZHk6ZnVuY3Rpb24oKXtpZighQSl7QT1lLkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpO2lmKGMucmVhZHlTdGF0ZT09PVwiY29tcGxldGVcIilyZXR1cm4gc2V0VGltZW91dChlLnJlYWR5LDEpO2lmKGMuYWRkRXZlbnRMaXN0ZW5lciljLmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsQiwhMSksYS5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLGUucmVhZHksITEpO2Vsc2UgaWYoYy5hdHRhY2hFdmVudCl7Yy5hdHRhY2hFdmVudChcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiLEIpLGEuYXR0YWNoRXZlbnQoXCJvbmxvYWRcIixlLnJlYWR5KTt2YXIgYj0hMTt0cnl7Yj1hLmZyYW1lRWxlbWVudD09bnVsbH1jYXRjaChkKXt9Yy5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGwmJmImJkooKX19fSxpc0Z1bmN0aW9uOmZ1bmN0aW9uKGEpe3JldHVybiBlLnR5cGUoYSk9PT1cImZ1bmN0aW9uXCJ9LGlzQXJyYXk6QXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24oYSl7cmV0dXJuIGUudHlwZShhKT09PVwiYXJyYXlcIn0saXNXaW5kb3c6ZnVuY3Rpb24oYSl7cmV0dXJuIGEmJnR5cGVvZiBhPT1cIm9iamVjdFwiJiZcInNldEludGVydmFsXCJpbiBhfSxpc051bWVyaWM6ZnVuY3Rpb24oYSl7cmV0dXJuIWlzTmFOKHBhcnNlRmxvYXQoYSkpJiZpc0Zpbml0ZShhKX0sdHlwZTpmdW5jdGlvbihhKXtyZXR1cm4gYT09bnVsbD9TdHJpbmcoYSk6SVtDLmNhbGwoYSldfHxcIm9iamVjdFwifSxpc1BsYWluT2JqZWN0OmZ1bmN0aW9uKGEpe2lmKCFhfHxlLnR5cGUoYSkhPT1cIm9iamVjdFwifHxhLm5vZGVUeXBlfHxlLmlzV2luZG93KGEpKXJldHVybiExO3RyeXtpZihhLmNvbnN0cnVjdG9yJiYhRC5jYWxsKGEsXCJjb25zdHJ1Y3RvclwiKSYmIUQuY2FsbChhLmNvbnN0cnVjdG9yLnByb3RvdHlwZSxcImlzUHJvdG90eXBlT2ZcIikpcmV0dXJuITF9Y2F0Y2goYyl7cmV0dXJuITF9dmFyIGQ7Zm9yKGQgaW4gYSk7cmV0dXJuIGQ9PT1ifHxELmNhbGwoYSxkKX0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gYSlyZXR1cm4hMTtyZXR1cm4hMH0sZXJyb3I6ZnVuY3Rpb24oYSl7dGhyb3cgbmV3IEVycm9yKGEpfSxwYXJzZUpTT046ZnVuY3Rpb24oYil7aWYodHlwZW9mIGIhPVwic3RyaW5nXCJ8fCFiKXJldHVybiBudWxsO2I9ZS50cmltKGIpO2lmKGEuSlNPTiYmYS5KU09OLnBhcnNlKXJldHVybiBhLkpTT04ucGFyc2UoYik7aWYobi50ZXN0KGIucmVwbGFjZShvLFwiQFwiKS5yZXBsYWNlKHAsXCJdXCIpLnJlcGxhY2UocSxcIlwiKSkpcmV0dXJuKG5ldyBGdW5jdGlvbihcInJldHVybiBcIitiKSkoKTtlLmVycm9yKFwiSW52YWxpZCBKU09OOiBcIitiKX0scGFyc2VYTUw6ZnVuY3Rpb24oYyl7dmFyIGQsZjt0cnl7YS5ET01QYXJzZXI/KGY9bmV3IERPTVBhcnNlcixkPWYucGFyc2VGcm9tU3RyaW5nKGMsXCJ0ZXh0L3htbFwiKSk6KGQ9bmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MRE9NXCIpLGQuYXN5bmM9XCJmYWxzZVwiLGQubG9hZFhNTChjKSl9Y2F0Y2goZyl7ZD1ifSghZHx8IWQuZG9jdW1lbnRFbGVtZW50fHxkLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwicGFyc2VyZXJyb3JcIikubGVuZ3RoKSYmZS5lcnJvcihcIkludmFsaWQgWE1MOiBcIitjKTtyZXR1cm4gZH0sbm9vcDpmdW5jdGlvbigpe30sZ2xvYmFsRXZhbDpmdW5jdGlvbihiKXtiJiZqLnRlc3QoYikmJihhLmV4ZWNTY3JpcHR8fGZ1bmN0aW9uKGIpe2EuZXZhbC5jYWxsKGEsYil9KShiKX0sY2FtZWxDYXNlOmZ1bmN0aW9uKGEpe3JldHVybiBhLnJlcGxhY2UodyxcIm1zLVwiKS5yZXBsYWNlKHYseCl9LG5vZGVOYW1lOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9VcHBlckNhc2UoKT09PWIudG9VcHBlckNhc2UoKX0sZWFjaDpmdW5jdGlvbihhLGMsZCl7dmFyIGYsZz0wLGg9YS5sZW5ndGgsaT1oPT09Ynx8ZS5pc0Z1bmN0aW9uKGEpO2lmKGQpe2lmKGkpe2ZvcihmIGluIGEpaWYoYy5hcHBseShhW2ZdLGQpPT09ITEpYnJlYWt9ZWxzZSBmb3IoO2c8aDspaWYoYy5hcHBseShhW2crK10sZCk9PT0hMSlicmVha31lbHNlIGlmKGkpe2ZvcihmIGluIGEpaWYoYy5jYWxsKGFbZl0sZixhW2ZdKT09PSExKWJyZWFrfWVsc2UgZm9yKDtnPGg7KWlmKGMuY2FsbChhW2ddLGcsYVtnKytdKT09PSExKWJyZWFrO3JldHVybiBhfSx0cmltOkc/ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PW51bGw/XCJcIjpHLmNhbGwoYSl9OmZ1bmN0aW9uKGEpe3JldHVybiBhPT1udWxsP1wiXCI6KGErXCJcIikucmVwbGFjZShrLFwiXCIpLnJlcGxhY2UobCxcIlwiKX0sbWFrZUFycmF5OmZ1bmN0aW9uKGEsYil7dmFyIGM9Ynx8W107aWYoYSE9bnVsbCl7dmFyIGQ9ZS50eXBlKGEpO2EubGVuZ3RoPT1udWxsfHxkPT09XCJzdHJpbmdcInx8ZD09PVwiZnVuY3Rpb25cInx8ZD09PVwicmVnZXhwXCJ8fGUuaXNXaW5kb3coYSk/RS5jYWxsKGMsYSk6ZS5tZXJnZShjLGEpfXJldHVybiBjfSxpbkFycmF5OmZ1bmN0aW9uKGEsYixjKXt2YXIgZDtpZihiKXtpZihIKXJldHVybiBILmNhbGwoYixhLGMpO2Q9Yi5sZW5ndGgsYz1jP2M8MD9NYXRoLm1heCgwLGQrYyk6YzowO2Zvcig7YzxkO2MrKylpZihjIGluIGImJmJbY109PT1hKXJldHVybiBjfXJldHVybi0xfSxtZXJnZTpmdW5jdGlvbihhLGMpe3ZhciBkPWEubGVuZ3RoLGU9MDtpZih0eXBlb2YgYy5sZW5ndGg9PVwibnVtYmVyXCIpZm9yKHZhciBmPWMubGVuZ3RoO2U8ZjtlKyspYVtkKytdPWNbZV07ZWxzZSB3aGlsZShjW2VdIT09YilhW2QrK109Y1tlKytdO2EubGVuZ3RoPWQ7cmV0dXJuIGF9LGdyZXA6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGU7Yz0hIWM7Zm9yKHZhciBmPTAsZz1hLmxlbmd0aDtmPGc7ZisrKWU9ISFiKGFbZl0sZiksYyE9PWUmJmQucHVzaChhW2ZdKTtyZXR1cm4gZH0sbWFwOmZ1bmN0aW9uKGEsYyxkKXt2YXIgZixnLGg9W10saT0wLGo9YS5sZW5ndGgsaz1hIGluc3RhbmNlb2YgZXx8aiE9PWImJnR5cGVvZiBqPT1cIm51bWJlclwiJiYoaj4wJiZhWzBdJiZhW2otMV18fGo9PT0wfHxlLmlzQXJyYXkoYSkpO2lmKGspZm9yKDtpPGo7aSsrKWY9YyhhW2ldLGksZCksZiE9bnVsbCYmKGhbaC5sZW5ndGhdPWYpO2Vsc2UgZm9yKGcgaW4gYSlmPWMoYVtnXSxnLGQpLGYhPW51bGwmJihoW2gubGVuZ3RoXT1mKTtyZXR1cm4gaC5jb25jYXQuYXBwbHkoW10saCl9LGd1aWQ6MSxwcm94eTpmdW5jdGlvbihhLGMpe2lmKHR5cGVvZiBjPT1cInN0cmluZ1wiKXt2YXIgZD1hW2NdO2M9YSxhPWR9aWYoIWUuaXNGdW5jdGlvbihhKSlyZXR1cm4gYjt2YXIgZj1GLmNhbGwoYXJndW1lbnRzLDIpLGc9ZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShjLGYuY29uY2F0KEYuY2FsbChhcmd1bWVudHMpKSl9O2cuZ3VpZD1hLmd1aWQ9YS5ndWlkfHxnLmd1aWR8fGUuZ3VpZCsrO3JldHVybiBnfSxhY2Nlc3M6ZnVuY3Rpb24oYSxjLGQsZixnLGgpe3ZhciBpPWEubGVuZ3RoO2lmKHR5cGVvZiBjPT1cIm9iamVjdFwiKXtmb3IodmFyIGogaW4gYyllLmFjY2VzcyhhLGosY1tqXSxmLGcsZCk7cmV0dXJuIGF9aWYoZCE9PWIpe2Y9IWgmJmYmJmUuaXNGdW5jdGlvbihkKTtmb3IodmFyIGs9MDtrPGk7aysrKWcoYVtrXSxjLGY/ZC5jYWxsKGFba10sayxnKGFba10sYykpOmQsaCk7cmV0dXJuIGF9cmV0dXJuIGk/ZyhhWzBdLGMpOmJ9LG5vdzpmdW5jdGlvbigpe3JldHVybihuZXcgRGF0ZSkuZ2V0VGltZSgpfSx1YU1hdGNoOmZ1bmN0aW9uKGEpe2E9YS50b0xvd2VyQ2FzZSgpO3ZhciBiPXIuZXhlYyhhKXx8cy5leGVjKGEpfHx0LmV4ZWMoYSl8fGEuaW5kZXhPZihcImNvbXBhdGlibGVcIik8MCYmdS5leGVjKGEpfHxbXTtyZXR1cm57YnJvd3NlcjpiWzFdfHxcIlwiLHZlcnNpb246YlsyXXx8XCIwXCJ9fSxzdWI6ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsYyl7cmV0dXJuIG5ldyBhLmZuLmluaXQoYixjKX1lLmV4dGVuZCghMCxhLHRoaXMpLGEuc3VwZXJjbGFzcz10aGlzLGEuZm49YS5wcm90b3R5cGU9dGhpcygpLGEuZm4uY29uc3RydWN0b3I9YSxhLnN1Yj10aGlzLnN1YixhLmZuLmluaXQ9ZnVuY3Rpb24oZCxmKXtmJiZmIGluc3RhbmNlb2YgZSYmIShmIGluc3RhbmNlb2YgYSkmJihmPWEoZikpO3JldHVybiBlLmZuLmluaXQuY2FsbCh0aGlzLGQsZixiKX0sYS5mbi5pbml0LnByb3RvdHlwZT1hLmZuO3ZhciBiPWEoYyk7cmV0dXJuIGF9LGJyb3dzZXI6e319KSxlLmVhY2goXCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0XCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEsYil7SVtcIltvYmplY3QgXCIrYitcIl1cIl09Yi50b0xvd2VyQ2FzZSgpfSksej1lLnVhTWF0Y2goeSksei5icm93c2VyJiYoZS5icm93c2VyW3ouYnJvd3Nlcl09ITAsZS5icm93c2VyLnZlcnNpb249ei52ZXJzaW9uKSxlLmJyb3dzZXIud2Via2l0JiYoZS5icm93c2VyLnNhZmFyaT0hMCksai50ZXN0KFwiwqBcIikmJihrPS9eW1xcc1xceEEwXSsvLGw9L1tcXHNcXHhBMF0rJC8pLGg9ZShjKSxjLmFkZEV2ZW50TGlzdGVuZXI/Qj1mdW5jdGlvbigpe2MucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIixCLCExKSxlLnJlYWR5KCl9OmMuYXR0YWNoRXZlbnQmJihCPWZ1bmN0aW9uKCl7Yy5yZWFkeVN0YXRlPT09XCJjb21wbGV0ZVwiJiYoYy5kZXRhY2hFdmVudChcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiLEIpLGUucmVhZHkoKSl9KTtyZXR1cm4gZX0oKSxnPXt9O2YuQ2FsbGJhY2tzPWZ1bmN0aW9uKGEpe2E9YT9nW2FdfHxoKGEpOnt9O3ZhciBjPVtdLGQ9W10sZSxpLGosayxsLG09ZnVuY3Rpb24oYil7dmFyIGQsZSxnLGgsaTtmb3IoZD0wLGU9Yi5sZW5ndGg7ZDxlO2QrKylnPWJbZF0saD1mLnR5cGUoZyksaD09PVwiYXJyYXlcIj9tKGcpOmg9PT1cImZ1bmN0aW9uXCImJighYS51bmlxdWV8fCFvLmhhcyhnKSkmJmMucHVzaChnKX0sbj1mdW5jdGlvbihiLGYpe2Y9Znx8W10sZT0hYS5tZW1vcnl8fFtiLGZdLGk9ITAsbD1qfHwwLGo9MCxrPWMubGVuZ3RoO2Zvcig7YyYmbDxrO2wrKylpZihjW2xdLmFwcGx5KGIsZik9PT0hMSYmYS5zdG9wT25GYWxzZSl7ZT0hMDticmVha31pPSExLGMmJihhLm9uY2U/ZT09PSEwP28uZGlzYWJsZSgpOmM9W106ZCYmZC5sZW5ndGgmJihlPWQuc2hpZnQoKSxvLmZpcmVXaXRoKGVbMF0sZVsxXSkpKX0sbz17YWRkOmZ1bmN0aW9uKCl7aWYoYyl7dmFyIGE9Yy5sZW5ndGg7bShhcmd1bWVudHMpLGk/az1jLmxlbmd0aDplJiZlIT09ITAmJihqPWEsbihlWzBdLGVbMV0pKX1yZXR1cm4gdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7aWYoYyl7dmFyIGI9YXJndW1lbnRzLGQ9MCxlPWIubGVuZ3RoO2Zvcig7ZDxlO2QrKylmb3IodmFyIGY9MDtmPGMubGVuZ3RoO2YrKylpZihiW2RdPT09Y1tmXSl7aSYmZjw9ayYmKGstLSxmPD1sJiZsLS0pLGMuc3BsaWNlKGYtLSwxKTtpZihhLnVuaXF1ZSlicmVha319cmV0dXJuIHRoaXN9LGhhczpmdW5jdGlvbihhKXtpZihjKXt2YXIgYj0wLGQ9Yy5sZW5ndGg7Zm9yKDtiPGQ7YisrKWlmKGE9PT1jW2JdKXJldHVybiEwfXJldHVybiExfSxlbXB0eTpmdW5jdGlvbigpe2M9W107cmV0dXJuIHRoaXN9LGRpc2FibGU6ZnVuY3Rpb24oKXtjPWQ9ZT1iO3JldHVybiB0aGlzfSxkaXNhYmxlZDpmdW5jdGlvbigpe3JldHVybiFjfSxsb2NrOmZ1bmN0aW9uKCl7ZD1iLCghZXx8ZT09PSEwKSYmby5kaXNhYmxlKCk7cmV0dXJuIHRoaXN9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiFkfSxmaXJlV2l0aDpmdW5jdGlvbihiLGMpe2QmJihpP2Eub25jZXx8ZC5wdXNoKFtiLGNdKTooIWEub25jZXx8IWUpJiZuKGIsYykpO3JldHVybiB0aGlzfSxmaXJlOmZ1bmN0aW9uKCl7by5maXJlV2l0aCh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXN9LGZpcmVkOmZ1bmN0aW9uKCl7cmV0dXJuISFlfX07cmV0dXJuIG99O3ZhciBpPVtdLnNsaWNlO2YuZXh0ZW5kKHtEZWZlcnJlZDpmdW5jdGlvbihhKXt2YXIgYj1mLkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLGM9Zi5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSxkPWYuQ2FsbGJhY2tzKFwibWVtb3J5XCIpLGU9XCJwZW5kaW5nXCIsZz17cmVzb2x2ZTpiLHJlamVjdDpjLG5vdGlmeTpkfSxoPXtkb25lOmIuYWRkLGZhaWw6Yy5hZGQscHJvZ3Jlc3M6ZC5hZGQsc3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gZX0saXNSZXNvbHZlZDpiLmZpcmVkLGlzUmVqZWN0ZWQ6Yy5maXJlZCx0aGVuOmZ1bmN0aW9uKGEsYixjKXtpLmRvbmUoYSkuZmFpbChiKS5wcm9ncmVzcyhjKTtyZXR1cm4gdGhpc30sYWx3YXlzOmZ1bmN0aW9uKCl7aS5kb25lLmFwcGx5KGksYXJndW1lbnRzKS5mYWlsLmFwcGx5KGksYXJndW1lbnRzKTtyZXR1cm4gdGhpc30scGlwZTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGYuRGVmZXJyZWQoZnVuY3Rpb24oZCl7Zi5lYWNoKHtkb25lOlthLFwicmVzb2x2ZVwiXSxmYWlsOltiLFwicmVqZWN0XCJdLHByb2dyZXNzOltjLFwibm90aWZ5XCJdfSxmdW5jdGlvbihhLGIpe3ZhciBjPWJbMF0sZT1iWzFdLGc7Zi5pc0Z1bmN0aW9uKGMpP2lbYV0oZnVuY3Rpb24oKXtnPWMuYXBwbHkodGhpcyxhcmd1bWVudHMpLGcmJmYuaXNGdW5jdGlvbihnLnByb21pc2UpP2cucHJvbWlzZSgpLnRoZW4oZC5yZXNvbHZlLGQucmVqZWN0LGQubm90aWZ5KTpkW2UrXCJXaXRoXCJdKHRoaXM9PT1pP2Q6dGhpcyxbZ10pfSk6aVthXShkW2VdKX0pfSkucHJvbWlzZSgpfSxwcm9taXNlOmZ1bmN0aW9uKGEpe2lmKGE9PW51bGwpYT1oO2Vsc2UgZm9yKHZhciBiIGluIGgpYVtiXT1oW2JdO3JldHVybiBhfX0saT1oLnByb21pc2Uoe30pLGo7Zm9yKGogaW4gZylpW2pdPWdbal0uZmlyZSxpW2orXCJXaXRoXCJdPWdbal0uZmlyZVdpdGg7aS5kb25lKGZ1bmN0aW9uKCl7ZT1cInJlc29sdmVkXCJ9LGMuZGlzYWJsZSxkLmxvY2spLmZhaWwoZnVuY3Rpb24oKXtlPVwicmVqZWN0ZWRcIn0sYi5kaXNhYmxlLGQubG9jayksYSYmYS5jYWxsKGksaSk7cmV0dXJuIGl9LHdoZW46ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gbShhKXtyZXR1cm4gZnVuY3Rpb24oYil7ZVthXT1hcmd1bWVudHMubGVuZ3RoPjE/aS5jYWxsKGFyZ3VtZW50cywwKTpiLGoubm90aWZ5V2l0aChrLGUpfX1mdW5jdGlvbiBsKGEpe3JldHVybiBmdW5jdGlvbihjKXtiW2FdPWFyZ3VtZW50cy5sZW5ndGg+MT9pLmNhbGwoYXJndW1lbnRzLDApOmMsLS1nfHxqLnJlc29sdmVXaXRoKGosYil9fXZhciBiPWkuY2FsbChhcmd1bWVudHMsMCksYz0wLGQ9Yi5sZW5ndGgsZT1BcnJheShkKSxnPWQsaD1kLGo9ZDw9MSYmYSYmZi5pc0Z1bmN0aW9uKGEucHJvbWlzZSk/YTpmLkRlZmVycmVkKCksaz1qLnByb21pc2UoKTtpZihkPjEpe2Zvcig7YzxkO2MrKyliW2NdJiZiW2NdLnByb21pc2UmJmYuaXNGdW5jdGlvbihiW2NdLnByb21pc2UpP2JbY10ucHJvbWlzZSgpLnRoZW4obChjKSxqLnJlamVjdCxtKGMpKTotLWc7Z3x8ai5yZXNvbHZlV2l0aChqLGIpfWVsc2UgaiE9PWEmJmoucmVzb2x2ZVdpdGgoaixkP1thXTpbXSk7cmV0dXJuIGt9fSksZi5zdXBwb3J0PWZ1bmN0aW9uKCl7dmFyIGIsZCxlLGcsaCxpLGosayxsLG0sbixvLHAscT1jLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikscj1jLmRvY3VtZW50RWxlbWVudDtxLnNldEF0dHJpYnV0ZShcImNsYXNzTmFtZVwiLFwidFwiKSxxLmlubmVySFRNTD1cIiAgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYScgc3R5bGU9J3RvcDoxcHg7ZmxvYXQ6bGVmdDtvcGFjaXR5Oi41NTsnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+XCIsZD1xLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiKlwiKSxlPXEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJhXCIpWzBdO2lmKCFkfHwhZC5sZW5ndGh8fCFlKXJldHVybnt9O2c9Yy5jcmVhdGVFbGVtZW50KFwic2VsZWN0XCIpLGg9Zy5hcHBlbmRDaGlsZChjLmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIikpLGk9cS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdLGI9e2xlYWRpbmdXaGl0ZXNwYWNlOnEuZmlyc3RDaGlsZC5ub2RlVHlwZT09PTMsdGJvZHk6IXEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0Ym9keVwiKS5sZW5ndGgsaHRtbFNlcmlhbGl6ZTohIXEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJsaW5rXCIpLmxlbmd0aCxzdHlsZTovdG9wLy50ZXN0KGUuZ2V0QXR0cmlidXRlKFwic3R5bGVcIikpLGhyZWZOb3JtYWxpemVkOmUuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKT09PVwiL2FcIixvcGFjaXR5Oi9eMC41NS8udGVzdChlLnN0eWxlLm9wYWNpdHkpLGNzc0Zsb2F0OiEhZS5zdHlsZS5jc3NGbG9hdCxjaGVja09uOmkudmFsdWU9PT1cIm9uXCIsb3B0U2VsZWN0ZWQ6aC5zZWxlY3RlZCxnZXRTZXRBdHRyaWJ1dGU6cS5jbGFzc05hbWUhPT1cInRcIixlbmN0eXBlOiEhYy5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKS5lbmN0eXBlLGh0bWw1Q2xvbmU6Yy5jcmVhdGVFbGVtZW50KFwibmF2XCIpLmNsb25lTm9kZSghMCkub3V0ZXJIVE1MIT09XCI8Om5hdj48LzpuYXY+XCIsc3VibWl0QnViYmxlczohMCxjaGFuZ2VCdWJibGVzOiEwLGZvY3VzaW5CdWJibGVzOiExLGRlbGV0ZUV4cGFuZG86ITAsbm9DbG9uZUV2ZW50OiEwLGlubGluZUJsb2NrTmVlZHNMYXlvdXQ6ITEsc2hyaW5rV3JhcEJsb2NrczohMSxyZWxpYWJsZU1hcmdpblJpZ2h0OiEwfSxpLmNoZWNrZWQ9ITAsYi5ub0Nsb25lQ2hlY2tlZD1pLmNsb25lTm9kZSghMCkuY2hlY2tlZCxnLmRpc2FibGVkPSEwLGIub3B0RGlzYWJsZWQ9IWguZGlzYWJsZWQ7dHJ5e2RlbGV0ZSBxLnRlc3R9Y2F0Y2gocyl7Yi5kZWxldGVFeHBhbmRvPSExfSFxLmFkZEV2ZW50TGlzdGVuZXImJnEuYXR0YWNoRXZlbnQmJnEuZmlyZUV2ZW50JiYocS5hdHRhY2hFdmVudChcIm9uY2xpY2tcIixmdW5jdGlvbigpe2Iubm9DbG9uZUV2ZW50PSExfSkscS5jbG9uZU5vZGUoITApLmZpcmVFdmVudChcIm9uY2xpY2tcIikpLGk9Yy5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiksaS52YWx1ZT1cInRcIixpLnNldEF0dHJpYnV0ZShcInR5cGVcIixcInJhZGlvXCIpLGIucmFkaW9WYWx1ZT1pLnZhbHVlPT09XCJ0XCIsaS5zZXRBdHRyaWJ1dGUoXCJjaGVja2VkXCIsXCJjaGVja2VkXCIpLHEuYXBwZW5kQ2hpbGQoaSksaz1jLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxrLmFwcGVuZENoaWxkKHEubGFzdENoaWxkKSxiLmNoZWNrQ2xvbmU9ay5jbG9uZU5vZGUoITApLmNsb25lTm9kZSghMCkubGFzdENoaWxkLmNoZWNrZWQsYi5hcHBlbmRDaGVja2VkPWkuY2hlY2tlZCxrLnJlbW92ZUNoaWxkKGkpLGsuYXBwZW5kQ2hpbGQocSkscS5pbm5lckhUTUw9XCJcIixhLmdldENvbXB1dGVkU3R5bGUmJihqPWMuY3JlYXRlRWxlbWVudChcImRpdlwiKSxqLnN0eWxlLndpZHRoPVwiMFwiLGouc3R5bGUubWFyZ2luUmlnaHQ9XCIwXCIscS5zdHlsZS53aWR0aD1cIjJweFwiLHEuYXBwZW5kQ2hpbGQoaiksYi5yZWxpYWJsZU1hcmdpblJpZ2h0PShwYXJzZUludCgoYS5nZXRDb21wdXRlZFN0eWxlKGosbnVsbCl8fHttYXJnaW5SaWdodDowfSkubWFyZ2luUmlnaHQsMTApfHwwKT09PTApO2lmKHEuYXR0YWNoRXZlbnQpZm9yKG8gaW57c3VibWl0OjEsY2hhbmdlOjEsZm9jdXNpbjoxfSluPVwib25cIitvLHA9biBpbiBxLHB8fChxLnNldEF0dHJpYnV0ZShuLFwicmV0dXJuO1wiKSxwPXR5cGVvZiBxW25dPT1cImZ1bmN0aW9uXCIpLGJbbytcIkJ1YmJsZXNcIl09cDtrLnJlbW92ZUNoaWxkKHEpLGs9Zz1oPWo9cT1pPW51bGwsZihmdW5jdGlvbigpe3ZhciBhLGQsZSxnLGgsaSxqLGssbSxuLG8scj1jLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiYm9keVwiKVswXTshcnx8KGo9MSxrPVwicG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3dpZHRoOjFweDtoZWlnaHQ6MXB4O21hcmdpbjowO1wiLG09XCJ2aXNpYmlsaXR5OmhpZGRlbjtib3JkZXI6MDtcIixuPVwic3R5bGU9J1wiK2srXCJib3JkZXI6NXB4IHNvbGlkICMwMDA7cGFkZGluZzowOydcIixvPVwiPGRpdiBcIituK1wiPjxkaXY+PC9kaXY+PC9kaXY+XCIrXCI8dGFibGUgXCIrbitcIiBjZWxscGFkZGluZz0nMCcgY2VsbHNwYWNpbmc9JzAnPlwiK1wiPHRyPjx0ZD48L3RkPjwvdHI+PC90YWJsZT5cIixhPWMuY3JlYXRlRWxlbWVudChcImRpdlwiKSxhLnN0eWxlLmNzc1RleHQ9bStcIndpZHRoOjA7aGVpZ2h0OjA7cG9zaXRpb246c3RhdGljO3RvcDowO21hcmdpbi10b3A6XCIraitcInB4XCIsci5pbnNlcnRCZWZvcmUoYSxyLmZpcnN0Q2hpbGQpLHE9Yy5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLGEuYXBwZW5kQ2hpbGQocSkscS5pbm5lckhUTUw9XCI8dGFibGU+PHRyPjx0ZCBzdHlsZT0ncGFkZGluZzowO2JvcmRlcjowO2Rpc3BsYXk6bm9uZSc+PC90ZD48dGQ+dDwvdGQ+PC90cj48L3RhYmxlPlwiLGw9cS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRkXCIpLHA9bFswXS5vZmZzZXRIZWlnaHQ9PT0wLGxbMF0uc3R5bGUuZGlzcGxheT1cIlwiLGxbMV0uc3R5bGUuZGlzcGxheT1cIm5vbmVcIixiLnJlbGlhYmxlSGlkZGVuT2Zmc2V0cz1wJiZsWzBdLm9mZnNldEhlaWdodD09PTAscS5pbm5lckhUTUw9XCJcIixxLnN0eWxlLndpZHRoPXEuc3R5bGUucGFkZGluZ0xlZnQ9XCIxcHhcIixmLmJveE1vZGVsPWIuYm94TW9kZWw9cS5vZmZzZXRXaWR0aD09PTIsdHlwZW9mIHEuc3R5bGUuem9vbSE9XCJ1bmRlZmluZWRcIiYmKHEuc3R5bGUuZGlzcGxheT1cImlubGluZVwiLHEuc3R5bGUuem9vbT0xLGIuaW5saW5lQmxvY2tOZWVkc0xheW91dD1xLm9mZnNldFdpZHRoPT09MixxLnN0eWxlLmRpc3BsYXk9XCJcIixxLmlubmVySFRNTD1cIjxkaXYgc3R5bGU9J3dpZHRoOjRweDsnPjwvZGl2PlwiLGIuc2hyaW5rV3JhcEJsb2Nrcz1xLm9mZnNldFdpZHRoIT09MikscS5zdHlsZS5jc3NUZXh0PWsrbSxxLmlubmVySFRNTD1vLGQ9cS5maXJzdENoaWxkLGU9ZC5maXJzdENoaWxkLGg9ZC5uZXh0U2libGluZy5maXJzdENoaWxkLmZpcnN0Q2hpbGQsaT17ZG9lc05vdEFkZEJvcmRlcjplLm9mZnNldFRvcCE9PTUsZG9lc0FkZEJvcmRlckZvclRhYmxlQW5kQ2VsbHM6aC5vZmZzZXRUb3A9PT01fSxlLnN0eWxlLnBvc2l0aW9uPVwiZml4ZWRcIixlLnN0eWxlLnRvcD1cIjIwcHhcIixpLmZpeGVkUG9zaXRpb249ZS5vZmZzZXRUb3A9PT0yMHx8ZS5vZmZzZXRUb3A9PT0xNSxlLnN0eWxlLnBvc2l0aW9uPWUuc3R5bGUudG9wPVwiXCIsZC5zdHlsZS5vdmVyZmxvdz1cImhpZGRlblwiLGQuc3R5bGUucG9zaXRpb249XCJyZWxhdGl2ZVwiLGkuc3VidHJhY3RzQm9yZGVyRm9yT3ZlcmZsb3dOb3RWaXNpYmxlPWUub2Zmc2V0VG9wPT09LTUsaS5kb2VzTm90SW5jbHVkZU1hcmdpbkluQm9keU9mZnNldD1yLm9mZnNldFRvcCE9PWosci5yZW1vdmVDaGlsZChhKSxxPWE9bnVsbCxmLmV4dGVuZChiLGkpKX0pO3JldHVybiBifSgpO3ZhciBqPS9eKD86XFx7LipcXH18XFxbLipcXF0pJC8saz0vKFtBLVpdKS9nO2YuZXh0ZW5kKHtjYWNoZTp7fSx1dWlkOjAsZXhwYW5kbzpcImpRdWVyeVwiKyhmLmZuLmpxdWVyeStNYXRoLnJhbmRvbSgpKS5yZXBsYWNlKC9cXEQvZyxcIlwiKSxub0RhdGE6e2VtYmVkOiEwLG9iamVjdDpcImNsc2lkOkQyN0NEQjZFLUFFNkQtMTFjZi05NkI4LTQ0NDU1MzU0MDAwMFwiLGFwcGxldDohMH0saGFzRGF0YTpmdW5jdGlvbihhKXthPWEubm9kZVR5cGU/Zi5jYWNoZVthW2YuZXhwYW5kb11dOmFbZi5leHBhbmRvXTtyZXR1cm4hIWEmJiFtKGEpfSxkYXRhOmZ1bmN0aW9uKGEsYyxkLGUpe2lmKCEhZi5hY2NlcHREYXRhKGEpKXt2YXIgZyxoLGksaj1mLmV4cGFuZG8saz10eXBlb2YgYz09XCJzdHJpbmdcIixsPWEubm9kZVR5cGUsbT1sP2YuY2FjaGU6YSxuPWw/YVtqXTphW2pdJiZqLG89Yz09PVwiZXZlbnRzXCI7aWYoKCFufHwhbVtuXXx8IW8mJiFlJiYhbVtuXS5kYXRhKSYmayYmZD09PWIpcmV0dXJuO258fChsP2Fbal09bj0rK2YudXVpZDpuPWopLG1bbl18fChtW25dPXt9LGx8fChtW25dLnRvSlNPTj1mLm5vb3ApKTtpZih0eXBlb2YgYz09XCJvYmplY3RcInx8dHlwZW9mIGM9PVwiZnVuY3Rpb25cIillP21bbl09Zi5leHRlbmQobVtuXSxjKTptW25dLmRhdGE9Zi5leHRlbmQobVtuXS5kYXRhLGMpO2c9aD1tW25dLGV8fChoLmRhdGF8fChoLmRhdGE9e30pLGg9aC5kYXRhKSxkIT09YiYmKGhbZi5jYW1lbENhc2UoYyldPWQpO2lmKG8mJiFoW2NdKXJldHVybiBnLmV2ZW50cztrPyhpPWhbY10saT09bnVsbCYmKGk9aFtmLmNhbWVsQ2FzZShjKV0pKTppPWg7cmV0dXJuIGl9fSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGEsYixjKXtpZighIWYuYWNjZXB0RGF0YShhKSl7dmFyIGQsZSxnLGg9Zi5leHBhbmRvLGk9YS5ub2RlVHlwZSxqPWk/Zi5jYWNoZTphLGs9aT9hW2hdOmg7aWYoIWpba10pcmV0dXJuO2lmKGIpe2Q9Yz9qW2tdOmpba10uZGF0YTtpZihkKXtmLmlzQXJyYXkoYil8fChiIGluIGQ/Yj1bYl06KGI9Zi5jYW1lbENhc2UoYiksYiBpbiBkP2I9W2JdOmI9Yi5zcGxpdChcIiBcIikpKTtmb3IoZT0wLGc9Yi5sZW5ndGg7ZTxnO2UrKylkZWxldGUgZFtiW2VdXTtpZighKGM/bTpmLmlzRW1wdHlPYmplY3QpKGQpKXJldHVybn19aWYoIWMpe2RlbGV0ZSBqW2tdLmRhdGE7aWYoIW0oaltrXSkpcmV0dXJufWYuc3VwcG9ydC5kZWxldGVFeHBhbmRvfHwhai5zZXRJbnRlcnZhbD9kZWxldGUgaltrXTpqW2tdPW51bGwsaSYmKGYuc3VwcG9ydC5kZWxldGVFeHBhbmRvP2RlbGV0ZSBhW2hdOmEucmVtb3ZlQXR0cmlidXRlP2EucmVtb3ZlQXR0cmlidXRlKGgpOmFbaF09bnVsbCl9fSxfZGF0YTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGYuZGF0YShhLGIsYywhMCl9LGFjY2VwdERhdGE6ZnVuY3Rpb24oYSl7aWYoYS5ub2RlTmFtZSl7dmFyIGI9Zi5ub0RhdGFbYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXTtpZihiKXJldHVybiBiIT09ITAmJmEuZ2V0QXR0cmlidXRlKFwiY2xhc3NpZFwiKT09PWJ9cmV0dXJuITB9fSksZi5mbi5leHRlbmQoe2RhdGE6ZnVuY3Rpb24oYSxjKXt2YXIgZCxlLGcsaD1udWxsO2lmKHR5cGVvZiBhPT1cInVuZGVmaW5lZFwiKXtpZih0aGlzLmxlbmd0aCl7aD1mLmRhdGEodGhpc1swXSk7aWYodGhpc1swXS5ub2RlVHlwZT09PTEmJiFmLl9kYXRhKHRoaXNbMF0sXCJwYXJzZWRBdHRyc1wiKSl7ZT10aGlzWzBdLmF0dHJpYnV0ZXM7Zm9yKHZhciBpPTAsaj1lLmxlbmd0aDtpPGo7aSsrKWc9ZVtpXS5uYW1lLGcuaW5kZXhPZihcImRhdGEtXCIpPT09MCYmKGc9Zi5jYW1lbENhc2UoZy5zdWJzdHJpbmcoNSkpLGwodGhpc1swXSxnLGhbZ10pKTtmLl9kYXRhKHRoaXNbMF0sXCJwYXJzZWRBdHRyc1wiLCEwKX19cmV0dXJuIGh9aWYodHlwZW9mIGE9PVwib2JqZWN0XCIpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2YuZGF0YSh0aGlzLGEpfSk7ZD1hLnNwbGl0KFwiLlwiKSxkWzFdPWRbMV0/XCIuXCIrZFsxXTpcIlwiO2lmKGM9PT1iKXtoPXRoaXMudHJpZ2dlckhhbmRsZXIoXCJnZXREYXRhXCIrZFsxXStcIiFcIixbZFswXV0pLGg9PT1iJiZ0aGlzLmxlbmd0aCYmKGg9Zi5kYXRhKHRoaXNbMF0sYSksaD1sKHRoaXNbMF0sYSxoKSk7cmV0dXJuIGg9PT1iJiZkWzFdP3RoaXMuZGF0YShkWzBdKTpofXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj1mKHRoaXMpLGU9W2RbMF0sY107Yi50cmlnZ2VySGFuZGxlcihcInNldERhdGFcIitkWzFdK1wiIVwiLGUpLGYuZGF0YSh0aGlzLGEsYyksYi50cmlnZ2VySGFuZGxlcihcImNoYW5nZURhdGFcIitkWzFdK1wiIVwiLGUpfSl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2YucmVtb3ZlRGF0YSh0aGlzLGEpfSl9fSksZi5leHRlbmQoe19tYXJrOmZ1bmN0aW9uKGEsYil7YSYmKGI9KGJ8fFwiZnhcIikrXCJtYXJrXCIsZi5fZGF0YShhLGIsKGYuX2RhdGEoYSxiKXx8MCkrMSkpfSxfdW5tYXJrOmZ1bmN0aW9uKGEsYixjKXthIT09ITAmJihjPWIsYj1hLGE9ITEpO2lmKGIpe2M9Y3x8XCJmeFwiO3ZhciBkPWMrXCJtYXJrXCIsZT1hPzA6KGYuX2RhdGEoYixkKXx8MSktMTtlP2YuX2RhdGEoYixkLGUpOihmLnJlbW92ZURhdGEoYixkLCEwKSxuKGIsYyxcIm1hcmtcIikpfX0scXVldWU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkO2lmKGEpe2I9KGJ8fFwiZnhcIikrXCJxdWV1ZVwiLGQ9Zi5fZGF0YShhLGIpLGMmJighZHx8Zi5pc0FycmF5KGMpP2Q9Zi5fZGF0YShhLGIsZi5tYWtlQXJyYXkoYykpOmQucHVzaChjKSk7cmV0dXJuIGR8fFtdfX0sZGVxdWV1ZTpmdW5jdGlvbihhLGIpe2I9Ynx8XCJmeFwiO3ZhciBjPWYucXVldWUoYSxiKSxkPWMuc2hpZnQoKSxlPXt9O2Q9PT1cImlucHJvZ3Jlc3NcIiYmKGQ9Yy5zaGlmdCgpKSxkJiYoYj09PVwiZnhcIiYmYy51bnNoaWZ0KFwiaW5wcm9ncmVzc1wiKSxmLl9kYXRhKGEsYitcIi5ydW5cIixlKSxkLmNhbGwoYSxmdW5jdGlvbigpe2YuZGVxdWV1ZShhLGIpfSxlKSksYy5sZW5ndGh8fChmLnJlbW92ZURhdGEoYSxiK1wicXVldWUgXCIrYitcIi5ydW5cIiwhMCksbihhLGIsXCJxdWV1ZVwiKSl9fSksZi5mbi5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGEsYyl7dHlwZW9mIGEhPVwic3RyaW5nXCImJihjPWEsYT1cImZ4XCIpO2lmKGM9PT1iKXJldHVybiBmLnF1ZXVlKHRoaXNbMF0sYSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiPWYucXVldWUodGhpcyxhLGMpO2E9PT1cImZ4XCImJmJbMF0hPT1cImlucHJvZ3Jlc3NcIiYmZi5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Zi5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVsYXk6ZnVuY3Rpb24oYSxiKXthPWYuZng/Zi5meC5zcGVlZHNbYV18fGE6YSxiPWJ8fFwiZnhcIjtyZXR1cm4gdGhpcy5xdWV1ZShiLGZ1bmN0aW9uKGIsYyl7dmFyIGQ9c2V0VGltZW91dChiLGEpO2Muc3RvcD1mdW5jdGlvbigpe2NsZWFyVGltZW91dChkKX19KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShhfHxcImZ4XCIsW10pfSxwcm9taXNlOmZ1bmN0aW9uKGEsYyl7ZnVuY3Rpb24gbSgpey0taHx8ZC5yZXNvbHZlV2l0aChlLFtlXSl9dHlwZW9mIGEhPVwic3RyaW5nXCImJihjPWEsYT1iKSxhPWF8fFwiZnhcIjt2YXIgZD1mLkRlZmVycmVkKCksZT10aGlzLGc9ZS5sZW5ndGgsaD0xLGk9YStcImRlZmVyXCIsaj1hK1wicXVldWVcIixrPWErXCJtYXJrXCIsbDt3aGlsZShnLS0paWYobD1mLmRhdGEoZVtnXSxpLGIsITApfHwoZi5kYXRhKGVbZ10saixiLCEwKXx8Zi5kYXRhKGVbZ10sayxiLCEwKSkmJmYuZGF0YShlW2ddLGksZi5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSwhMCkpaCsrLGwuYWRkKG0pO20oKTtyZXR1cm4gZC5wcm9taXNlKCl9fSk7dmFyIG89L1tcXG5cXHRcXHJdL2cscD0vXFxzKy8scT0vXFxyL2cscj0vXig/OmJ1dHRvbnxpbnB1dCkkL2kscz0vXig/OmJ1dHRvbnxpbnB1dHxvYmplY3R8c2VsZWN0fHRleHRhcmVhKSQvaSx0PS9eYSg/OnJlYSk/JC9pLHU9L14oPzphdXRvZm9jdXN8YXV0b3BsYXl8YXN5bmN8Y2hlY2tlZHxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZHxzZWxlY3RlZCkkL2ksdj1mLnN1cHBvcnQuZ2V0U2V0QXR0cmlidXRlLHcseCx5O2YuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGYuYWNjZXNzKHRoaXMsYSxiLCEwLGYuYXR0cil9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2YucmVtb3ZlQXR0cih0aGlzLGEpfSl9LHByb3A6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZi5hY2Nlc3ModGhpcyxhLGIsITAsZi5wcm9wKX0scmVtb3ZlUHJvcDpmdW5jdGlvbihhKXthPWYucHJvcEZpeFthXXx8YTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dHJ5e3RoaXNbYV09YixkZWxldGUgdGhpc1thXX1jYXRjaChjKXt9fSl9LGFkZENsYXNzOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlLGcsaCxpO2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe2YodGhpcykuYWRkQ2xhc3MoYS5jYWxsKHRoaXMsYix0aGlzLmNsYXNzTmFtZSkpfSk7aWYoYSYmdHlwZW9mIGE9PVwic3RyaW5nXCIpe2I9YS5zcGxpdChwKTtmb3IoYz0wLGQ9dGhpcy5sZW5ndGg7YzxkO2MrKyl7ZT10aGlzW2NdO2lmKGUubm9kZVR5cGU9PT0xKWlmKCFlLmNsYXNzTmFtZSYmYi5sZW5ndGg9PT0xKWUuY2xhc3NOYW1lPWE7ZWxzZXtnPVwiIFwiK2UuY2xhc3NOYW1lK1wiIFwiO2ZvcihoPTAsaT1iLmxlbmd0aDtoPGk7aCsrKX5nLmluZGV4T2YoXCIgXCIrYltoXStcIiBcIil8fChnKz1iW2hdK1wiIFwiKTtlLmNsYXNzTmFtZT1mLnRyaW0oZyl9fX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGMsZCxlLGcsaCxpLGo7aWYoZi5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7Zih0aGlzKS5yZW1vdmVDbGFzcyhhLmNhbGwodGhpcyxiLHRoaXMuY2xhc3NOYW1lKSl9KTtpZihhJiZ0eXBlb2YgYT09XCJzdHJpbmdcInx8YT09PWIpe2M9KGF8fFwiXCIpLnNwbGl0KHApO2ZvcihkPTAsZT10aGlzLmxlbmd0aDtkPGU7ZCsrKXtnPXRoaXNbZF07aWYoZy5ub2RlVHlwZT09PTEmJmcuY2xhc3NOYW1lKWlmKGEpe2g9KFwiIFwiK2cuY2xhc3NOYW1lK1wiIFwiKS5yZXBsYWNlKG8sXCIgXCIpO2ZvcihpPTAsaj1jLmxlbmd0aDtpPGo7aSsrKWg9aC5yZXBsYWNlKFwiIFwiK2NbaV0rXCIgXCIsXCIgXCIpO2cuY2xhc3NOYW1lPWYudHJpbShoKX1lbHNlIGcuY2xhc3NOYW1lPVwiXCJ9fXJldHVybiB0aGlzfSx0b2dnbGVDbGFzczpmdW5jdGlvbihhLGIpe3ZhciBjPXR5cGVvZiBhLGQ9dHlwZW9mIGI9PVwiYm9vbGVhblwiO2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe2YodGhpcykudG9nZ2xlQ2xhc3MoYS5jYWxsKHRoaXMsYyx0aGlzLmNsYXNzTmFtZSxiKSxiKX0pO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtpZihjPT09XCJzdHJpbmdcIil7dmFyIGUsZz0wLGg9Zih0aGlzKSxpPWIsaj1hLnNwbGl0KHApO3doaWxlKGU9altnKytdKWk9ZD9pOiFoLmhhc0NsYXNzKGUpLGhbaT9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXShlKX1lbHNlIGlmKGM9PT1cInVuZGVmaW5lZFwifHxjPT09XCJib29sZWFuXCIpdGhpcy5jbGFzc05hbWUmJmYuX2RhdGEodGhpcyxcIl9fY2xhc3NOYW1lX19cIix0aGlzLmNsYXNzTmFtZSksdGhpcy5jbGFzc05hbWU9dGhpcy5jbGFzc05hbWV8fGE9PT0hMT9cIlwiOmYuX2RhdGEodGhpcyxcIl9fY2xhc3NOYW1lX19cIil8fFwiXCJ9KX0saGFzQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGI9XCIgXCIrYStcIiBcIixjPTAsZD10aGlzLmxlbmd0aDtmb3IoO2M8ZDtjKyspaWYodGhpc1tjXS5ub2RlVHlwZT09PTEmJihcIiBcIit0aGlzW2NdLmNsYXNzTmFtZStcIiBcIikucmVwbGFjZShvLFwiIFwiKS5pbmRleE9mKGIpPi0xKXJldHVybiEwO3JldHVybiExfSx2YWw6ZnVuY3Rpb24oYSl7dmFyIGMsZCxlLGc9dGhpc1swXTt7aWYoISFhcmd1bWVudHMubGVuZ3RoKXtlPWYuaXNGdW5jdGlvbihhKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGQpe3ZhciBnPWYodGhpcyksaDtpZih0aGlzLm5vZGVUeXBlPT09MSl7ZT9oPWEuY2FsbCh0aGlzLGQsZy52YWwoKSk6aD1hLGg9PW51bGw/aD1cIlwiOnR5cGVvZiBoPT1cIm51bWJlclwiP2grPVwiXCI6Zi5pc0FycmF5KGgpJiYoaD1mLm1hcChoLGZ1bmN0aW9uKGEpe3JldHVybiBhPT1udWxsP1wiXCI6YStcIlwifSkpLGM9Zi52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldfHxmLnZhbEhvb2tzW3RoaXMudHlwZV07aWYoIWN8fCEoXCJzZXRcImluIGMpfHxjLnNldCh0aGlzLGgsXCJ2YWx1ZVwiKT09PWIpdGhpcy52YWx1ZT1ofX0pfWlmKGcpe2M9Zi52YWxIb29rc1tnLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldfHxmLnZhbEhvb2tzW2cudHlwZV07aWYoYyYmXCJnZXRcImluIGMmJihkPWMuZ2V0KGcsXCJ2YWx1ZVwiKSkhPT1iKXJldHVybiBkO2Q9Zy52YWx1ZTtyZXR1cm4gdHlwZW9mIGQ9PVwic3RyaW5nXCI/ZC5yZXBsYWNlKHEsXCJcIik6ZD09bnVsbD9cIlwiOmR9fX19KSxmLmV4dGVuZCh7dmFsSG9va3M6e29wdGlvbjp7Z2V0OmZ1bmN0aW9uKGEpe3ZhciBiPWEuYXR0cmlidXRlcy52YWx1ZTtyZXR1cm4hYnx8Yi5zcGVjaWZpZWQ/YS52YWx1ZTphLnRleHR9fSxzZWxlY3Q6e2dldDpmdW5jdGlvbihhKXt2YXIgYixjLGQsZSxnPWEuc2VsZWN0ZWRJbmRleCxoPVtdLGk9YS5vcHRpb25zLGo9YS50eXBlPT09XCJzZWxlY3Qtb25lXCI7aWYoZzwwKXJldHVybiBudWxsO2M9aj9nOjAsZD1qP2crMTppLmxlbmd0aDtmb3IoO2M8ZDtjKyspe2U9aVtjXTtpZihlLnNlbGVjdGVkJiYoZi5zdXBwb3J0Lm9wdERpc2FibGVkPyFlLmRpc2FibGVkOmUuZ2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIik9PT1udWxsKSYmKCFlLnBhcmVudE5vZGUuZGlzYWJsZWR8fCFmLm5vZGVOYW1lKGUucGFyZW50Tm9kZSxcIm9wdGdyb3VwXCIpKSl7Yj1mKGUpLnZhbCgpO2lmKGopcmV0dXJuIGI7aC5wdXNoKGIpfX1pZihqJiYhaC5sZW5ndGgmJmkubGVuZ3RoKXJldHVybiBmKGlbZ10pLnZhbCgpO3JldHVybiBofSxzZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1mLm1ha2VBcnJheShiKTtmKGEpLmZpbmQoXCJvcHRpb25cIikuZWFjaChmdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWQ9Zi5pbkFycmF5KGYodGhpcykudmFsKCksYyk+PTB9KSxjLmxlbmd0aHx8KGEuc2VsZWN0ZWRJbmRleD0tMSk7cmV0dXJuIGN9fX0sYXR0ckZuOnt2YWw6ITAsY3NzOiEwLGh0bWw6ITAsdGV4dDohMCxkYXRhOiEwLHdpZHRoOiEwLGhlaWdodDohMCxvZmZzZXQ6ITB9LGF0dHI6ZnVuY3Rpb24oYSxjLGQsZSl7dmFyIGcsaCxpLGo9YS5ub2RlVHlwZTtpZighIWEmJmohPT0zJiZqIT09OCYmaiE9PTIpe2lmKGUmJmMgaW4gZi5hdHRyRm4pcmV0dXJuIGYoYSlbY10oZCk7aWYodHlwZW9mIGEuZ2V0QXR0cmlidXRlPT1cInVuZGVmaW5lZFwiKXJldHVybiBmLnByb3AoYSxjLGQpO2k9aiE9PTF8fCFmLmlzWE1MRG9jKGEpLGkmJihjPWMudG9Mb3dlckNhc2UoKSxoPWYuYXR0ckhvb2tzW2NdfHwodS50ZXN0KGMpP3g6dykpO2lmKGQhPT1iKXtpZihkPT09bnVsbCl7Zi5yZW1vdmVBdHRyKGEsYyk7cmV0dXJufWlmKGgmJlwic2V0XCJpbiBoJiZpJiYoZz1oLnNldChhLGQsYykpIT09YilyZXR1cm4gZzthLnNldEF0dHJpYnV0ZShjLFwiXCIrZCk7cmV0dXJuIGR9aWYoaCYmXCJnZXRcImluIGgmJmkmJihnPWguZ2V0KGEsYykpIT09bnVsbClyZXR1cm4gZztnPWEuZ2V0QXR0cmlidXRlKGMpO3JldHVybiBnPT09bnVsbD9iOmd9fSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGcsaD0wO2lmKGImJmEubm9kZVR5cGU9PT0xKXtkPWIudG9Mb3dlckNhc2UoKS5zcGxpdChwKSxnPWQubGVuZ3RoO2Zvcig7aDxnO2grKyllPWRbaF0sZSYmKGM9Zi5wcm9wRml4W2VdfHxlLGYuYXR0cihhLGUsXCJcIiksYS5yZW1vdmVBdHRyaWJ1dGUodj9lOmMpLHUudGVzdChlKSYmYyBpbiBhJiYoYVtjXT0hMSkpfX0sYXR0ckhvb2tzOnt0eXBlOntzZXQ6ZnVuY3Rpb24oYSxiKXtpZihyLnRlc3QoYS5ub2RlTmFtZSkmJmEucGFyZW50Tm9kZSlmLmVycm9yKFwidHlwZSBwcm9wZXJ0eSBjYW4ndCBiZSBjaGFuZ2VkXCIpO2Vsc2UgaWYoIWYuc3VwcG9ydC5yYWRpb1ZhbHVlJiZiPT09XCJyYWRpb1wiJiZmLm5vZGVOYW1lKGEsXCJpbnB1dFwiKSl7dmFyIGM9YS52YWx1ZTthLnNldEF0dHJpYnV0ZShcInR5cGVcIixiKSxjJiYoYS52YWx1ZT1jKTtyZXR1cm4gYn19fSx2YWx1ZTp7Z2V0OmZ1bmN0aW9uKGEsYil7aWYodyYmZi5ub2RlTmFtZShhLFwiYnV0dG9uXCIpKXJldHVybiB3LmdldChhLGIpO3JldHVybiBiIGluIGE/YS52YWx1ZTpudWxsfSxzZXQ6ZnVuY3Rpb24oYSxiLGMpe2lmKHcmJmYubm9kZU5hbWUoYSxcImJ1dHRvblwiKSlyZXR1cm4gdy5zZXQoYSxiLGMpO2EudmFsdWU9Yn19fSxwcm9wRml4Ont0YWJpbmRleDpcInRhYkluZGV4XCIscmVhZG9ubHk6XCJyZWFkT25seVwiLFwiZm9yXCI6XCJodG1sRm9yXCIsXCJjbGFzc1wiOlwiY2xhc3NOYW1lXCIsbWF4bGVuZ3RoOlwibWF4TGVuZ3RoXCIsY2VsbHNwYWNpbmc6XCJjZWxsU3BhY2luZ1wiLGNlbGxwYWRkaW5nOlwiY2VsbFBhZGRpbmdcIixyb3dzcGFuOlwicm93U3BhblwiLGNvbHNwYW46XCJjb2xTcGFuXCIsdXNlbWFwOlwidXNlTWFwXCIsZnJhbWVib3JkZXI6XCJmcmFtZUJvcmRlclwiLGNvbnRlbnRlZGl0YWJsZTpcImNvbnRlbnRFZGl0YWJsZVwifSxwcm9wOmZ1bmN0aW9uKGEsYyxkKXt2YXIgZSxnLGgsaT1hLm5vZGVUeXBlO2lmKCEhYSYmaSE9PTMmJmkhPT04JiZpIT09Mil7aD1pIT09MXx8IWYuaXNYTUxEb2MoYSksaCYmKGM9Zi5wcm9wRml4W2NdfHxjLGc9Zi5wcm9wSG9va3NbY10pO3JldHVybiBkIT09Yj9nJiZcInNldFwiaW4gZyYmKGU9Zy5zZXQoYSxkLGMpKSE9PWI/ZTphW2NdPWQ6ZyYmXCJnZXRcImluIGcmJihlPWcuZ2V0KGEsYykpIT09bnVsbD9lOmFbY119fSxwcm9wSG9va3M6e3RhYkluZGV4OntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGM9YS5nZXRBdHRyaWJ1dGVOb2RlKFwidGFiaW5kZXhcIik7cmV0dXJuIGMmJmMuc3BlY2lmaWVkP3BhcnNlSW50KGMudmFsdWUsMTApOnMudGVzdChhLm5vZGVOYW1lKXx8dC50ZXN0KGEubm9kZU5hbWUpJiZhLmhyZWY/MDpifX19fSksZi5hdHRySG9va3MudGFiaW5kZXg9Zi5wcm9wSG9va3MudGFiSW5kZXgseD17Z2V0OmZ1bmN0aW9uKGEsYyl7dmFyIGQsZT1mLnByb3AoYSxjKTtyZXR1cm4gZT09PSEwfHx0eXBlb2YgZSE9XCJib29sZWFuXCImJihkPWEuZ2V0QXR0cmlidXRlTm9kZShjKSkmJmQubm9kZVZhbHVlIT09ITE/Yy50b0xvd2VyQ2FzZSgpOmJ9LHNldDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ7Yj09PSExP2YucmVtb3ZlQXR0cihhLGMpOihkPWYucHJvcEZpeFtjXXx8YyxkIGluIGEmJihhW2RdPSEwKSxhLnNldEF0dHJpYnV0ZShjLGMudG9Mb3dlckNhc2UoKSkpO3JldHVybiBjfX0sdnx8KHk9e25hbWU6ITAsaWQ6ITB9LHc9Zi52YWxIb29rcy5idXR0b249e2dldDpmdW5jdGlvbihhLGMpe3ZhciBkO2Q9YS5nZXRBdHRyaWJ1dGVOb2RlKGMpO3JldHVybiBkJiYoeVtjXT9kLm5vZGVWYWx1ZSE9PVwiXCI6ZC5zcGVjaWZpZWQpP2Qubm9kZVZhbHVlOmJ9LHNldDpmdW5jdGlvbihhLGIsZCl7dmFyIGU9YS5nZXRBdHRyaWJ1dGVOb2RlKGQpO2V8fChlPWMuY3JlYXRlQXR0cmlidXRlKGQpLGEuc2V0QXR0cmlidXRlTm9kZShlKSk7cmV0dXJuIGUubm9kZVZhbHVlPWIrXCJcIn19LGYuYXR0ckhvb2tzLnRhYmluZGV4LnNldD13LnNldCxmLmVhY2goW1wid2lkdGhcIixcImhlaWdodFwiXSxmdW5jdGlvbihhLGIpe2YuYXR0ckhvb2tzW2JdPWYuZXh0ZW5kKGYuYXR0ckhvb2tzW2JdLHtzZXQ6ZnVuY3Rpb24oYSxjKXtpZihjPT09XCJcIil7YS5zZXRBdHRyaWJ1dGUoYixcImF1dG9cIik7cmV0dXJuIGN9fX0pfSksZi5hdHRySG9va3MuY29udGVudGVkaXRhYmxlPXtnZXQ6dy5nZXQsc2V0OmZ1bmN0aW9uKGEsYixjKXtiPT09XCJcIiYmKGI9XCJmYWxzZVwiKSx3LnNldChhLGIsYyl9fSksZi5zdXBwb3J0LmhyZWZOb3JtYWxpemVkfHxmLmVhY2goW1wiaHJlZlwiLFwic3JjXCIsXCJ3aWR0aFwiLFwiaGVpZ2h0XCJdLGZ1bmN0aW9uKGEsYyl7Zi5hdHRySG9va3NbY109Zi5leHRlbmQoZi5hdHRySG9va3NbY10se2dldDpmdW5jdGlvbihhKXt2YXIgZD1hLmdldEF0dHJpYnV0ZShjLDIpO3JldHVybiBkPT09bnVsbD9iOmR9fSl9KSxmLnN1cHBvcnQuc3R5bGV8fChmLmF0dHJIb29rcy5zdHlsZT17Z2V0OmZ1bmN0aW9uKGEpe3JldHVybiBhLnN0eWxlLmNzc1RleHQudG9Mb3dlckNhc2UoKXx8Yn0sc2V0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuc3R5bGUuY3NzVGV4dD1cIlwiK2J9fSksZi5zdXBwb3J0Lm9wdFNlbGVjdGVkfHwoZi5wcm9wSG9va3Muc2VsZWN0ZWQ9Zi5leHRlbmQoZi5wcm9wSG9va3Muc2VsZWN0ZWQse2dldDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7YiYmKGIuc2VsZWN0ZWRJbmRleCxiLnBhcmVudE5vZGUmJmIucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4KTtyZXR1cm4gbnVsbH19KSksZi5zdXBwb3J0LmVuY3R5cGV8fChmLnByb3BGaXguZW5jdHlwZT1cImVuY29kaW5nXCIpLGYuc3VwcG9ydC5jaGVja09ufHxmLmVhY2goW1wicmFkaW9cIixcImNoZWNrYm94XCJdLGZ1bmN0aW9uKCl7Zi52YWxIb29rc1t0aGlzXT17Z2V0OmZ1bmN0aW9uKGEpe3JldHVybiBhLmdldEF0dHJpYnV0ZShcInZhbHVlXCIpPT09bnVsbD9cIm9uXCI6YS52YWx1ZX19fSksZi5lYWNoKFtcInJhZGlvXCIsXCJjaGVja2JveFwiXSxmdW5jdGlvbigpe2YudmFsSG9va3NbdGhpc109Zi5leHRlbmQoZi52YWxIb29rc1t0aGlzXSx7c2V0OmZ1bmN0aW9uKGEsYil7aWYoZi5pc0FycmF5KGIpKXJldHVybiBhLmNoZWNrZWQ9Zi5pbkFycmF5KGYoYSkudmFsKCksYik+PTB9fSl9KTt2YXIgej0vXig/OnRleHRhcmVhfGlucHV0fHNlbGVjdCkkL2ksQT0vXihbXlxcLl0qKT8oPzpcXC4oLispKT8kLyxCPS9cXGJob3ZlcihcXC5cXFMrKT9cXGIvLEM9L15rZXkvLEQ9L14oPzptb3VzZXxjb250ZXh0bWVudSl8Y2xpY2svLEU9L14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLEY9L14oXFx3KikoPzojKFtcXHdcXC1dKykpPyg/OlxcLihbXFx3XFwtXSspKT8kLyxHPWZ1bmN0aW9uKGEpe3ZhciBiPUYuZXhlYyhhKTtiJiYoYlsxXT0oYlsxXXx8XCJcIikudG9Mb3dlckNhc2UoKSxiWzNdPWJbM10mJm5ldyBSZWdFeHAoXCIoPzpefFxcXFxzKVwiK2JbM10rXCIoPzpcXFxcc3wkKVwiKSk7cmV0dXJuIGJ9LEg9ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmF0dHJpYnV0ZXN8fHt9O3JldHVybighYlsxXXx8YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09YlsxXSkmJighYlsyXXx8KGMuaWR8fHt9KS52YWx1ZT09PWJbMl0pJiYoIWJbM118fGJbM10udGVzdCgoY1tcImNsYXNzXCJdfHx7fSkudmFsdWUpKX0sST1mdW5jdGlvbihhKXtyZXR1cm4gZi5ldmVudC5zcGVjaWFsLmhvdmVyP2E6YS5yZXBsYWNlKEIsXCJtb3VzZWVudGVyJDEgbW91c2VsZWF2ZSQxXCIpfTtcbmYuZXZlbnQ9e2FkZDpmdW5jdGlvbihhLGMsZCxlLGcpe3ZhciBoLGksaixrLGwsbSxuLG8scCxxLHIscztpZighKGEubm9kZVR5cGU9PT0zfHxhLm5vZGVUeXBlPT09OHx8IWN8fCFkfHwhKGg9Zi5fZGF0YShhKSkpKXtkLmhhbmRsZXImJihwPWQsZD1wLmhhbmRsZXIpLGQuZ3VpZHx8KGQuZ3VpZD1mLmd1aWQrKyksaj1oLmV2ZW50cyxqfHwoaC5ldmVudHM9aj17fSksaT1oLmhhbmRsZSxpfHwoaC5oYW5kbGU9aT1mdW5jdGlvbihhKXtyZXR1cm4gdHlwZW9mIGYhPVwidW5kZWZpbmVkXCImJighYXx8Zi5ldmVudC50cmlnZ2VyZWQhPT1hLnR5cGUpP2YuZXZlbnQuZGlzcGF0Y2guYXBwbHkoaS5lbGVtLGFyZ3VtZW50cyk6Yn0saS5lbGVtPWEpLGM9Zi50cmltKEkoYykpLnNwbGl0KFwiIFwiKTtmb3Ioaz0wO2s8Yy5sZW5ndGg7aysrKXtsPUEuZXhlYyhjW2tdKXx8W10sbT1sWzFdLG49KGxbMl18fFwiXCIpLnNwbGl0KFwiLlwiKS5zb3J0KCkscz1mLmV2ZW50LnNwZWNpYWxbbV18fHt9LG09KGc/cy5kZWxlZ2F0ZVR5cGU6cy5iaW5kVHlwZSl8fG0scz1mLmV2ZW50LnNwZWNpYWxbbV18fHt9LG89Zi5leHRlbmQoe3R5cGU6bSxvcmlnVHlwZTpsWzFdLGRhdGE6ZSxoYW5kbGVyOmQsZ3VpZDpkLmd1aWQsc2VsZWN0b3I6ZyxxdWljazpHKGcpLG5hbWVzcGFjZTpuLmpvaW4oXCIuXCIpfSxwKSxyPWpbbV07aWYoIXIpe3I9alttXT1bXSxyLmRlbGVnYXRlQ291bnQ9MDtpZighcy5zZXR1cHx8cy5zZXR1cC5jYWxsKGEsZSxuLGkpPT09ITEpYS5hZGRFdmVudExpc3RlbmVyP2EuYWRkRXZlbnRMaXN0ZW5lcihtLGksITEpOmEuYXR0YWNoRXZlbnQmJmEuYXR0YWNoRXZlbnQoXCJvblwiK20saSl9cy5hZGQmJihzLmFkZC5jYWxsKGEsbyksby5oYW5kbGVyLmd1aWR8fChvLmhhbmRsZXIuZ3VpZD1kLmd1aWQpKSxnP3Iuc3BsaWNlKHIuZGVsZWdhdGVDb3VudCsrLDAsbyk6ci5wdXNoKG8pLGYuZXZlbnQuZ2xvYmFsW21dPSEwfWE9bnVsbH19LGdsb2JhbDp7fSxyZW1vdmU6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZz1mLmhhc0RhdGEoYSkmJmYuX2RhdGEoYSksaCxpLGosayxsLG0sbixvLHAscSxyLHM7aWYoISFnJiYhIShvPWcuZXZlbnRzKSl7Yj1mLnRyaW0oSShifHxcIlwiKSkuc3BsaXQoXCIgXCIpO2ZvcihoPTA7aDxiLmxlbmd0aDtoKyspe2k9QS5leGVjKGJbaF0pfHxbXSxqPWs9aVsxXSxsPWlbMl07aWYoIWope2ZvcihqIGluIG8pZi5ldmVudC5yZW1vdmUoYSxqK2JbaF0sYyxkLCEwKTtjb250aW51ZX1wPWYuZXZlbnQuc3BlY2lhbFtqXXx8e30saj0oZD9wLmRlbGVnYXRlVHlwZTpwLmJpbmRUeXBlKXx8aixyPW9bal18fFtdLG09ci5sZW5ndGgsbD1sP25ldyBSZWdFeHAoXCIoXnxcXFxcLilcIitsLnNwbGl0KFwiLlwiKS5zb3J0KCkuam9pbihcIlxcXFwuKD86LipcXFxcLik/XCIpK1wiKFxcXFwufCQpXCIpOm51bGw7Zm9yKG49MDtuPHIubGVuZ3RoO24rKylzPXJbbl0sKGV8fGs9PT1zLm9yaWdUeXBlKSYmKCFjfHxjLmd1aWQ9PT1zLmd1aWQpJiYoIWx8fGwudGVzdChzLm5hbWVzcGFjZSkpJiYoIWR8fGQ9PT1zLnNlbGVjdG9yfHxkPT09XCIqKlwiJiZzLnNlbGVjdG9yKSYmKHIuc3BsaWNlKG4tLSwxKSxzLnNlbGVjdG9yJiZyLmRlbGVnYXRlQ291bnQtLSxwLnJlbW92ZSYmcC5yZW1vdmUuY2FsbChhLHMpKTtyLmxlbmd0aD09PTAmJm0hPT1yLmxlbmd0aCYmKCghcC50ZWFyZG93bnx8cC50ZWFyZG93bi5jYWxsKGEsbCk9PT0hMSkmJmYucmVtb3ZlRXZlbnQoYSxqLGcuaGFuZGxlKSxkZWxldGUgb1tqXSl9Zi5pc0VtcHR5T2JqZWN0KG8pJiYocT1nLmhhbmRsZSxxJiYocS5lbGVtPW51bGwpLGYucmVtb3ZlRGF0YShhLFtcImV2ZW50c1wiLFwiaGFuZGxlXCJdLCEwKSl9fSxjdXN0b21FdmVudDp7Z2V0RGF0YTohMCxzZXREYXRhOiEwLGNoYW5nZURhdGE6ITB9LHRyaWdnZXI6ZnVuY3Rpb24oYyxkLGUsZyl7aWYoIWV8fGUubm9kZVR5cGUhPT0zJiZlLm5vZGVUeXBlIT09OCl7dmFyIGg9Yy50eXBlfHxjLGk9W10saixrLGwsbSxuLG8scCxxLHIscztpZihFLnRlc3QoaCtmLmV2ZW50LnRyaWdnZXJlZCkpcmV0dXJuO2guaW5kZXhPZihcIiFcIik+PTAmJihoPWguc2xpY2UoMCwtMSksaz0hMCksaC5pbmRleE9mKFwiLlwiKT49MCYmKGk9aC5zcGxpdChcIi5cIiksaD1pLnNoaWZ0KCksaS5zb3J0KCkpO2lmKCghZXx8Zi5ldmVudC5jdXN0b21FdmVudFtoXSkmJiFmLmV2ZW50Lmdsb2JhbFtoXSlyZXR1cm47Yz10eXBlb2YgYz09XCJvYmplY3RcIj9jW2YuZXhwYW5kb10/YzpuZXcgZi5FdmVudChoLGMpOm5ldyBmLkV2ZW50KGgpLGMudHlwZT1oLGMuaXNUcmlnZ2VyPSEwLGMuZXhjbHVzaXZlPWssYy5uYW1lc3BhY2U9aS5qb2luKFwiLlwiKSxjLm5hbWVzcGFjZV9yZT1jLm5hbWVzcGFjZT9uZXcgUmVnRXhwKFwiKF58XFxcXC4pXCIraS5qb2luKFwiXFxcXC4oPzouKlxcXFwuKT9cIikrXCIoXFxcXC58JClcIik6bnVsbCxvPWguaW5kZXhPZihcIjpcIik8MD9cIm9uXCIraDpcIlwiO2lmKCFlKXtqPWYuY2FjaGU7Zm9yKGwgaW4gailqW2xdLmV2ZW50cyYmaltsXS5ldmVudHNbaF0mJmYuZXZlbnQudHJpZ2dlcihjLGQsaltsXS5oYW5kbGUuZWxlbSwhMCk7cmV0dXJufWMucmVzdWx0PWIsYy50YXJnZXR8fChjLnRhcmdldD1lKSxkPWQhPW51bGw/Zi5tYWtlQXJyYXkoZCk6W10sZC51bnNoaWZ0KGMpLHA9Zi5ldmVudC5zcGVjaWFsW2hdfHx7fTtpZihwLnRyaWdnZXImJnAudHJpZ2dlci5hcHBseShlLGQpPT09ITEpcmV0dXJuO3I9W1tlLHAuYmluZFR5cGV8fGhdXTtpZighZyYmIXAubm9CdWJibGUmJiFmLmlzV2luZG93KGUpKXtzPXAuZGVsZWdhdGVUeXBlfHxoLG09RS50ZXN0KHMraCk/ZTplLnBhcmVudE5vZGUsbj1udWxsO2Zvcig7bTttPW0ucGFyZW50Tm9kZSlyLnB1c2goW20sc10pLG49bTtuJiZuPT09ZS5vd25lckRvY3VtZW50JiZyLnB1c2goW24uZGVmYXVsdFZpZXd8fG4ucGFyZW50V2luZG93fHxhLHNdKX1mb3IobD0wO2w8ci5sZW5ndGgmJiFjLmlzUHJvcGFnYXRpb25TdG9wcGVkKCk7bCsrKW09cltsXVswXSxjLnR5cGU9cltsXVsxXSxxPShmLl9kYXRhKG0sXCJldmVudHNcIil8fHt9KVtjLnR5cGVdJiZmLl9kYXRhKG0sXCJoYW5kbGVcIikscSYmcS5hcHBseShtLGQpLHE9byYmbVtvXSxxJiZmLmFjY2VwdERhdGEobSkmJnEuYXBwbHkobSxkKT09PSExJiZjLnByZXZlbnREZWZhdWx0KCk7Yy50eXBlPWgsIWcmJiFjLmlzRGVmYXVsdFByZXZlbnRlZCgpJiYoIXAuX2RlZmF1bHR8fHAuX2RlZmF1bHQuYXBwbHkoZS5vd25lckRvY3VtZW50LGQpPT09ITEpJiYoaCE9PVwiY2xpY2tcInx8IWYubm9kZU5hbWUoZSxcImFcIikpJiZmLmFjY2VwdERhdGEoZSkmJm8mJmVbaF0mJihoIT09XCJmb2N1c1wiJiZoIT09XCJibHVyXCJ8fGMudGFyZ2V0Lm9mZnNldFdpZHRoIT09MCkmJiFmLmlzV2luZG93KGUpJiYobj1lW29dLG4mJihlW29dPW51bGwpLGYuZXZlbnQudHJpZ2dlcmVkPWgsZVtoXSgpLGYuZXZlbnQudHJpZ2dlcmVkPWIsbiYmKGVbb109bikpO3JldHVybiBjLnJlc3VsdH19LGRpc3BhdGNoOmZ1bmN0aW9uKGMpe2M9Zi5ldmVudC5maXgoY3x8YS5ldmVudCk7dmFyIGQ9KGYuX2RhdGEodGhpcyxcImV2ZW50c1wiKXx8e30pW2MudHlwZV18fFtdLGU9ZC5kZWxlZ2F0ZUNvdW50LGc9W10uc2xpY2UuY2FsbChhcmd1bWVudHMsMCksaD0hYy5leGNsdXNpdmUmJiFjLm5hbWVzcGFjZSxpPVtdLGosayxsLG0sbixvLHAscSxyLHMsdDtnWzBdPWMsYy5kZWxlZ2F0ZVRhcmdldD10aGlzO2lmKGUmJiFjLnRhcmdldC5kaXNhYmxlZCYmKCFjLmJ1dHRvbnx8Yy50eXBlIT09XCJjbGlja1wiKSl7bT1mKHRoaXMpLG0uY29udGV4dD10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXM7Zm9yKGw9Yy50YXJnZXQ7bCE9dGhpcztsPWwucGFyZW50Tm9kZXx8dGhpcyl7bz17fSxxPVtdLG1bMF09bDtmb3Ioaj0wO2o8ZTtqKyspcj1kW2pdLHM9ci5zZWxlY3RvcixvW3NdPT09YiYmKG9bc109ci5xdWljaz9IKGwsci5xdWljayk6bS5pcyhzKSksb1tzXSYmcS5wdXNoKHIpO3EubGVuZ3RoJiZpLnB1c2goe2VsZW06bCxtYXRjaGVzOnF9KX19ZC5sZW5ndGg+ZSYmaS5wdXNoKHtlbGVtOnRoaXMsbWF0Y2hlczpkLnNsaWNlKGUpfSk7Zm9yKGo9MDtqPGkubGVuZ3RoJiYhYy5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpO2orKyl7cD1pW2pdLGMuY3VycmVudFRhcmdldD1wLmVsZW07Zm9yKGs9MDtrPHAubWF0Y2hlcy5sZW5ndGgmJiFjLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCk7aysrKXtyPXAubWF0Y2hlc1trXTtpZihofHwhYy5uYW1lc3BhY2UmJiFyLm5hbWVzcGFjZXx8Yy5uYW1lc3BhY2VfcmUmJmMubmFtZXNwYWNlX3JlLnRlc3Qoci5uYW1lc3BhY2UpKWMuZGF0YT1yLmRhdGEsYy5oYW5kbGVPYmo9cixuPSgoZi5ldmVudC5zcGVjaWFsW3Iub3JpZ1R5cGVdfHx7fSkuaGFuZGxlfHxyLmhhbmRsZXIpLmFwcGx5KHAuZWxlbSxnKSxuIT09YiYmKGMucmVzdWx0PW4sbj09PSExJiYoYy5wcmV2ZW50RGVmYXVsdCgpLGMuc3RvcFByb3BhZ2F0aW9uKCkpKX19cmV0dXJuIGMucmVzdWx0fSxwcm9wczpcImF0dHJDaGFuZ2UgYXR0ck5hbWUgcmVsYXRlZE5vZGUgc3JjRWxlbWVudCBhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2hcIi5zcGxpdChcIiBcIiksZml4SG9va3M6e30sa2V5SG9va3M6e3Byb3BzOlwiY2hhciBjaGFyQ29kZSBrZXkga2V5Q29kZVwiLnNwbGl0KFwiIFwiKSxmaWx0ZXI6ZnVuY3Rpb24oYSxiKXthLndoaWNoPT1udWxsJiYoYS53aGljaD1iLmNoYXJDb2RlIT1udWxsP2IuY2hhckNvZGU6Yi5rZXlDb2RlKTtyZXR1cm4gYX19LG1vdXNlSG9va3M6e3Byb3BzOlwiYnV0dG9uIGJ1dHRvbnMgY2xpZW50WCBjbGllbnRZIGZyb21FbGVtZW50IG9mZnNldFggb2Zmc2V0WSBwYWdlWCBwYWdlWSBzY3JlZW5YIHNjcmVlblkgdG9FbGVtZW50XCIuc3BsaXQoXCIgXCIpLGZpbHRlcjpmdW5jdGlvbihhLGQpe3ZhciBlLGYsZyxoPWQuYnV0dG9uLGk9ZC5mcm9tRWxlbWVudDthLnBhZ2VYPT1udWxsJiZkLmNsaWVudFghPW51bGwmJihlPWEudGFyZ2V0Lm93bmVyRG9jdW1lbnR8fGMsZj1lLmRvY3VtZW50RWxlbWVudCxnPWUuYm9keSxhLnBhZ2VYPWQuY2xpZW50WCsoZiYmZi5zY3JvbGxMZWZ0fHxnJiZnLnNjcm9sbExlZnR8fDApLShmJiZmLmNsaWVudExlZnR8fGcmJmcuY2xpZW50TGVmdHx8MCksYS5wYWdlWT1kLmNsaWVudFkrKGYmJmYuc2Nyb2xsVG9wfHxnJiZnLnNjcm9sbFRvcHx8MCktKGYmJmYuY2xpZW50VG9wfHxnJiZnLmNsaWVudFRvcHx8MCkpLCFhLnJlbGF0ZWRUYXJnZXQmJmkmJihhLnJlbGF0ZWRUYXJnZXQ9aT09PWEudGFyZ2V0P2QudG9FbGVtZW50OmkpLCFhLndoaWNoJiZoIT09YiYmKGEud2hpY2g9aCYxPzE6aCYyPzM6aCY0PzI6MCk7cmV0dXJuIGF9fSxmaXg6ZnVuY3Rpb24oYSl7aWYoYVtmLmV4cGFuZG9dKXJldHVybiBhO3ZhciBkLGUsZz1hLGg9Zi5ldmVudC5maXhIb29rc1thLnR5cGVdfHx7fSxpPWgucHJvcHM/dGhpcy5wcm9wcy5jb25jYXQoaC5wcm9wcyk6dGhpcy5wcm9wczthPWYuRXZlbnQoZyk7Zm9yKGQ9aS5sZW5ndGg7ZDspZT1pWy0tZF0sYVtlXT1nW2VdO2EudGFyZ2V0fHwoYS50YXJnZXQ9Zy5zcmNFbGVtZW50fHxjKSxhLnRhcmdldC5ub2RlVHlwZT09PTMmJihhLnRhcmdldD1hLnRhcmdldC5wYXJlbnROb2RlKSxhLm1ldGFLZXk9PT1iJiYoYS5tZXRhS2V5PWEuY3RybEtleSk7cmV0dXJuIGguZmlsdGVyP2guZmlsdGVyKGEsZyk6YX0sc3BlY2lhbDp7cmVhZHk6e3NldHVwOmYuYmluZFJlYWR5fSxsb2FkOntub0J1YmJsZTohMH0sZm9jdXM6e2RlbGVnYXRlVHlwZTpcImZvY3VzaW5cIn0sYmx1cjp7ZGVsZWdhdGVUeXBlOlwiZm9jdXNvdXRcIn0sYmVmb3JldW5sb2FkOntzZXR1cDpmdW5jdGlvbihhLGIsYyl7Zi5pc1dpbmRvdyh0aGlzKSYmKHRoaXMub25iZWZvcmV1bmxvYWQ9Yyl9LHRlYXJkb3duOmZ1bmN0aW9uKGEsYil7dGhpcy5vbmJlZm9yZXVubG9hZD09PWImJih0aGlzLm9uYmVmb3JldW5sb2FkPW51bGwpfX19LHNpbXVsYXRlOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPWYuZXh0ZW5kKG5ldyBmLkV2ZW50LGMse3R5cGU6YSxpc1NpbXVsYXRlZDohMCxvcmlnaW5hbEV2ZW50Ont9fSk7ZD9mLmV2ZW50LnRyaWdnZXIoZSxudWxsLGIpOmYuZXZlbnQuZGlzcGF0Y2guY2FsbChiLGUpLGUuaXNEZWZhdWx0UHJldmVudGVkKCkmJmMucHJldmVudERlZmF1bHQoKX19LGYuZXZlbnQuaGFuZGxlPWYuZXZlbnQuZGlzcGF0Y2gsZi5yZW1vdmVFdmVudD1jLnJlbW92ZUV2ZW50TGlzdGVuZXI/ZnVuY3Rpb24oYSxiLGMpe2EucmVtb3ZlRXZlbnRMaXN0ZW5lciYmYS5yZW1vdmVFdmVudExpc3RlbmVyKGIsYywhMSl9OmZ1bmN0aW9uKGEsYixjKXthLmRldGFjaEV2ZW50JiZhLmRldGFjaEV2ZW50KFwib25cIitiLGMpfSxmLkV2ZW50PWZ1bmN0aW9uKGEsYil7aWYoISh0aGlzIGluc3RhbmNlb2YgZi5FdmVudCkpcmV0dXJuIG5ldyBmLkV2ZW50KGEsYik7YSYmYS50eXBlPyh0aGlzLm9yaWdpbmFsRXZlbnQ9YSx0aGlzLnR5cGU9YS50eXBlLHRoaXMuaXNEZWZhdWx0UHJldmVudGVkPWEuZGVmYXVsdFByZXZlbnRlZHx8YS5yZXR1cm5WYWx1ZT09PSExfHxhLmdldFByZXZlbnREZWZhdWx0JiZhLmdldFByZXZlbnREZWZhdWx0KCk/SzpKKTp0aGlzLnR5cGU9YSxiJiZmLmV4dGVuZCh0aGlzLGIpLHRoaXMudGltZVN0YW1wPWEmJmEudGltZVN0YW1wfHxmLm5vdygpLHRoaXNbZi5leHBhbmRvXT0hMH0sZi5FdmVudC5wcm90b3R5cGU9e3ByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9Szt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7IWF8fChhLnByZXZlbnREZWZhdWx0P2EucHJldmVudERlZmF1bHQoKTphLnJldHVyblZhbHVlPSExKX0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1LO3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDshYXx8KGEuc3RvcFByb3BhZ2F0aW9uJiZhLnN0b3BQcm9wYWdhdGlvbigpLGEuY2FuY2VsQnViYmxlPSEwKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1LLHRoaXMuc3RvcFByb3BhZ2F0aW9uKCl9LGlzRGVmYXVsdFByZXZlbnRlZDpKLGlzUHJvcGFnYXRpb25TdG9wcGVkOkosaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6Sn0sZi5lYWNoKHttb3VzZWVudGVyOlwibW91c2VvdmVyXCIsbW91c2VsZWF2ZTpcIm1vdXNlb3V0XCJ9LGZ1bmN0aW9uKGEsYil7Zi5ldmVudC5zcGVjaWFsW2FdPXtkZWxlZ2F0ZVR5cGU6YixiaW5kVHlwZTpiLGhhbmRsZTpmdW5jdGlvbihhKXt2YXIgYz10aGlzLGQ9YS5yZWxhdGVkVGFyZ2V0LGU9YS5oYW5kbGVPYmosZz1lLnNlbGVjdG9yLGg7aWYoIWR8fGQhPT1jJiYhZi5jb250YWlucyhjLGQpKWEudHlwZT1lLm9yaWdUeXBlLGg9ZS5oYW5kbGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxhLnR5cGU9YjtyZXR1cm4gaH19fSksZi5zdXBwb3J0LnN1Ym1pdEJ1YmJsZXN8fChmLmV2ZW50LnNwZWNpYWwuc3VibWl0PXtzZXR1cDpmdW5jdGlvbigpe2lmKGYubm9kZU5hbWUodGhpcyxcImZvcm1cIikpcmV0dXJuITE7Zi5ldmVudC5hZGQodGhpcyxcImNsaWNrLl9zdWJtaXQga2V5cHJlc3MuX3N1Ym1pdFwiLGZ1bmN0aW9uKGEpe3ZhciBjPWEudGFyZ2V0LGQ9Zi5ub2RlTmFtZShjLFwiaW5wdXRcIil8fGYubm9kZU5hbWUoYyxcImJ1dHRvblwiKT9jLmZvcm06YjtkJiYhZC5fc3VibWl0X2F0dGFjaGVkJiYoZi5ldmVudC5hZGQoZCxcInN1Ym1pdC5fc3VibWl0XCIsZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnROb2RlJiYhYS5pc1RyaWdnZXImJmYuZXZlbnQuc2ltdWxhdGUoXCJzdWJtaXRcIix0aGlzLnBhcmVudE5vZGUsYSwhMCl9KSxkLl9zdWJtaXRfYXR0YWNoZWQ9ITApfSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7aWYoZi5ub2RlTmFtZSh0aGlzLFwiZm9ybVwiKSlyZXR1cm4hMTtmLmV2ZW50LnJlbW92ZSh0aGlzLFwiLl9zdWJtaXRcIil9fSksZi5zdXBwb3J0LmNoYW5nZUJ1YmJsZXN8fChmLmV2ZW50LnNwZWNpYWwuY2hhbmdlPXtzZXR1cDpmdW5jdGlvbigpe2lmKHoudGVzdCh0aGlzLm5vZGVOYW1lKSl7aWYodGhpcy50eXBlPT09XCJjaGVja2JveFwifHx0aGlzLnR5cGU9PT1cInJhZGlvXCIpZi5ldmVudC5hZGQodGhpcyxcInByb3BlcnR5Y2hhbmdlLl9jaGFuZ2VcIixmdW5jdGlvbihhKXthLm9yaWdpbmFsRXZlbnQucHJvcGVydHlOYW1lPT09XCJjaGVja2VkXCImJih0aGlzLl9qdXN0X2NoYW5nZWQ9ITApfSksZi5ldmVudC5hZGQodGhpcyxcImNsaWNrLl9jaGFuZ2VcIixmdW5jdGlvbihhKXt0aGlzLl9qdXN0X2NoYW5nZWQmJiFhLmlzVHJpZ2dlciYmKHRoaXMuX2p1c3RfY2hhbmdlZD0hMSxmLmV2ZW50LnNpbXVsYXRlKFwiY2hhbmdlXCIsdGhpcyxhLCEwKSl9KTtyZXR1cm4hMX1mLmV2ZW50LmFkZCh0aGlzLFwiYmVmb3JlYWN0aXZhdGUuX2NoYW5nZVwiLGZ1bmN0aW9uKGEpe3ZhciBiPWEudGFyZ2V0O3oudGVzdChiLm5vZGVOYW1lKSYmIWIuX2NoYW5nZV9hdHRhY2hlZCYmKGYuZXZlbnQuYWRkKGIsXCJjaGFuZ2UuX2NoYW5nZVwiLGZ1bmN0aW9uKGEpe3RoaXMucGFyZW50Tm9kZSYmIWEuaXNTaW11bGF0ZWQmJiFhLmlzVHJpZ2dlciYmZi5ldmVudC5zaW11bGF0ZShcImNoYW5nZVwiLHRoaXMucGFyZW50Tm9kZSxhLCEwKX0pLGIuX2NoYW5nZV9hdHRhY2hlZD0hMCl9KX0saGFuZGxlOmZ1bmN0aW9uKGEpe3ZhciBiPWEudGFyZ2V0O2lmKHRoaXMhPT1ifHxhLmlzU2ltdWxhdGVkfHxhLmlzVHJpZ2dlcnx8Yi50eXBlIT09XCJyYWRpb1wiJiZiLnR5cGUhPT1cImNoZWNrYm94XCIpcmV0dXJuIGEuaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpfSx0ZWFyZG93bjpmdW5jdGlvbigpe2YuZXZlbnQucmVtb3ZlKHRoaXMsXCIuX2NoYW5nZVwiKTtyZXR1cm4gei50ZXN0KHRoaXMubm9kZU5hbWUpfX0pLGYuc3VwcG9ydC5mb2N1c2luQnViYmxlc3x8Zi5lYWNoKHtmb2N1czpcImZvY3VzaW5cIixibHVyOlwiZm9jdXNvdXRcIn0sZnVuY3Rpb24oYSxiKXt2YXIgZD0wLGU9ZnVuY3Rpb24oYSl7Zi5ldmVudC5zaW11bGF0ZShiLGEudGFyZ2V0LGYuZXZlbnQuZml4KGEpLCEwKX07Zi5ldmVudC5zcGVjaWFsW2JdPXtzZXR1cDpmdW5jdGlvbigpe2QrKz09PTAmJmMuYWRkRXZlbnRMaXN0ZW5lcihhLGUsITApfSx0ZWFyZG93bjpmdW5jdGlvbigpey0tZD09PTAmJmMucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLGUsITApfX19KSxmLmZuLmV4dGVuZCh7b246ZnVuY3Rpb24oYSxjLGQsZSxnKXt2YXIgaCxpO2lmKHR5cGVvZiBhPT1cIm9iamVjdFwiKXt0eXBlb2YgYyE9XCJzdHJpbmdcIiYmKGQ9YyxjPWIpO2ZvcihpIGluIGEpdGhpcy5vbihpLGMsZCxhW2ldLGcpO3JldHVybiB0aGlzfWQ9PW51bGwmJmU9PW51bGw/KGU9YyxkPWM9Yik6ZT09bnVsbCYmKHR5cGVvZiBjPT1cInN0cmluZ1wiPyhlPWQsZD1iKTooZT1kLGQ9YyxjPWIpKTtpZihlPT09ITEpZT1KO2Vsc2UgaWYoIWUpcmV0dXJuIHRoaXM7Zz09PTEmJihoPWUsZT1mdW5jdGlvbihhKXtmKCkub2ZmKGEpO3JldHVybiBoLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZS5ndWlkPWguZ3VpZHx8KGguZ3VpZD1mLmd1aWQrKykpO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtmLmV2ZW50LmFkZCh0aGlzLGEsZSxkLGMpfSl9LG9uZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5vbi5jYWxsKHRoaXMsYSxiLGMsZCwxKX0sb2ZmOmZ1bmN0aW9uKGEsYyxkKXtpZihhJiZhLnByZXZlbnREZWZhdWx0JiZhLmhhbmRsZU9iail7dmFyIGU9YS5oYW5kbGVPYmo7ZihhLmRlbGVnYXRlVGFyZ2V0KS5vZmYoZS5uYW1lc3BhY2U/ZS50eXBlK1wiLlwiK2UubmFtZXNwYWNlOmUudHlwZSxlLnNlbGVjdG9yLGUuaGFuZGxlcik7cmV0dXJuIHRoaXN9aWYodHlwZW9mIGE9PVwib2JqZWN0XCIpe2Zvcih2YXIgZyBpbiBhKXRoaXMub2ZmKGcsYyxhW2ddKTtyZXR1cm4gdGhpc31pZihjPT09ITF8fHR5cGVvZiBjPT1cImZ1bmN0aW9uXCIpZD1jLGM9YjtkPT09ITEmJihkPUopO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtmLmV2ZW50LnJlbW92ZSh0aGlzLGEsZCxjKX0pfSxiaW5kOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdGhpcy5vbihhLG51bGwsYixjKX0sdW5iaW5kOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMub2ZmKGEsbnVsbCxiKX0sbGl2ZTpmdW5jdGlvbihhLGIsYyl7Zih0aGlzLmNvbnRleHQpLm9uKGEsdGhpcy5zZWxlY3RvcixiLGMpO3JldHVybiB0aGlzfSxkaWU6ZnVuY3Rpb24oYSxiKXtmKHRoaXMuY29udGV4dCkub2ZmKGEsdGhpcy5zZWxlY3Rvcnx8XCIqKlwiLGIpO3JldHVybiB0aGlzfSxkZWxlZ2F0ZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5vbihiLGEsYyxkKX0sdW5kZWxlZ2F0ZTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg9PTE/dGhpcy5vZmYoYSxcIioqXCIpOnRoaXMub2ZmKGIsYSxjKX0sdHJpZ2dlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtmLmV2ZW50LnRyaWdnZXIoYSxiLHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGEsYil7aWYodGhpc1swXSlyZXR1cm4gZi5ldmVudC50cmlnZ2VyKGEsYix0aGlzWzBdLCEwKX0sdG9nZ2xlOmZ1bmN0aW9uKGEpe3ZhciBiPWFyZ3VtZW50cyxjPWEuZ3VpZHx8Zi5ndWlkKyssZD0wLGU9ZnVuY3Rpb24oYyl7dmFyIGU9KGYuX2RhdGEodGhpcyxcImxhc3RUb2dnbGVcIithLmd1aWQpfHwwKSVkO2YuX2RhdGEodGhpcyxcImxhc3RUb2dnbGVcIithLmd1aWQsZSsxKSxjLnByZXZlbnREZWZhdWx0KCk7cmV0dXJuIGJbZV0uYXBwbHkodGhpcyxhcmd1bWVudHMpfHwhMX07ZS5ndWlkPWM7d2hpbGUoZDxiLmxlbmd0aCliW2QrK10uZ3VpZD1jO3JldHVybiB0aGlzLmNsaWNrKGUpfSxob3ZlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLm1vdXNlZW50ZXIoYSkubW91c2VsZWF2ZShifHxhKX19KSxmLmVhY2goXCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGVycm9yIGNvbnRleHRtZW51XCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEsYil7Zi5mbltiXT1mdW5jdGlvbihhLGMpe2M9PW51bGwmJihjPWEsYT1udWxsKTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4wP3RoaXMub24oYixudWxsLGEsYyk6dGhpcy50cmlnZ2VyKGIpfSxmLmF0dHJGbiYmKGYuYXR0ckZuW2JdPSEwKSxDLnRlc3QoYikmJihmLmV2ZW50LmZpeEhvb2tzW2JdPWYuZXZlbnQua2V5SG9va3MpLEQudGVzdChiKSYmKGYuZXZlbnQuZml4SG9va3NbYl09Zi5ldmVudC5tb3VzZUhvb2tzKX0pLGZ1bmN0aW9uKCl7ZnVuY3Rpb24geChhLGIsYyxlLGYsZyl7Zm9yKHZhciBoPTAsaT1lLmxlbmd0aDtoPGk7aCsrKXt2YXIgaj1lW2hdO2lmKGope3ZhciBrPSExO2o9althXTt3aGlsZShqKXtpZihqW2RdPT09Yyl7az1lW2ouc2l6c2V0XTticmVha31pZihqLm5vZGVUeXBlPT09MSl7Z3x8KGpbZF09YyxqLnNpenNldD1oKTtpZih0eXBlb2YgYiE9XCJzdHJpbmdcIil7aWYoaj09PWIpe2s9ITA7YnJlYWt9fWVsc2UgaWYobS5maWx0ZXIoYixbal0pLmxlbmd0aD4wKXtrPWo7YnJlYWt9fWo9althXX1lW2hdPWt9fX1mdW5jdGlvbiB3KGEsYixjLGUsZixnKXtmb3IodmFyIGg9MCxpPWUubGVuZ3RoO2g8aTtoKyspe3ZhciBqPWVbaF07aWYoail7dmFyIGs9ITE7aj1qW2FdO3doaWxlKGope2lmKGpbZF09PT1jKXtrPWVbai5zaXpzZXRdO2JyZWFrfWoubm9kZVR5cGU9PT0xJiYhZyYmKGpbZF09YyxqLnNpenNldD1oKTtpZihqLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1iKXtrPWo7YnJlYWt9aj1qW2FdfWVbaF09a319fXZhciBhPS8oKD86XFwoKD86XFwoW14oKV0rXFwpfFteKCldKykrXFwpfFxcWyg/OlxcW1teXFxbXFxdXSpcXF18WydcIl1bXidcIl0qWydcIl18W15cXFtcXF0nXCJdKykrXFxdfFxcXFwufFteID4rfiwoXFxbXFxcXF0rKSt8Wz4rfl0pKFxccyosXFxzKik/KCg/Oi58XFxyfFxcbikqKS9nLGQ9XCJzaXpjYWNoZVwiKyhNYXRoLnJhbmRvbSgpK1wiXCIpLnJlcGxhY2UoXCIuXCIsXCJcIiksZT0wLGc9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxoPSExLGk9ITAsaj0vXFxcXC9nLGs9L1xcclxcbi9nLGw9L1xcVy87WzAsMF0uc29ydChmdW5jdGlvbigpe2k9ITE7cmV0dXJuIDB9KTt2YXIgbT1mdW5jdGlvbihiLGQsZSxmKXtlPWV8fFtdLGQ9ZHx8Yzt2YXIgaD1kO2lmKGQubm9kZVR5cGUhPT0xJiZkLm5vZGVUeXBlIT09OSlyZXR1cm5bXTtpZighYnx8dHlwZW9mIGIhPVwic3RyaW5nXCIpcmV0dXJuIGU7dmFyIGksaixrLGwsbixxLHIsdCx1PSEwLHY9bS5pc1hNTChkKSx3PVtdLHg9Yjtkb3thLmV4ZWMoXCJcIiksaT1hLmV4ZWMoeCk7aWYoaSl7eD1pWzNdLHcucHVzaChpWzFdKTtpZihpWzJdKXtsPWlbM107YnJlYWt9fX13aGlsZShpKTtpZih3Lmxlbmd0aD4xJiZwLmV4ZWMoYikpaWYody5sZW5ndGg9PT0yJiZvLnJlbGF0aXZlW3dbMF1dKWo9eSh3WzBdK3dbMV0sZCxmKTtlbHNle2o9by5yZWxhdGl2ZVt3WzBdXT9bZF06bSh3LnNoaWZ0KCksZCk7d2hpbGUody5sZW5ndGgpYj13LnNoaWZ0KCksby5yZWxhdGl2ZVtiXSYmKGIrPXcuc2hpZnQoKSksaj15KGIsaixmKX1lbHNleyFmJiZ3Lmxlbmd0aD4xJiZkLm5vZGVUeXBlPT09OSYmIXYmJm8ubWF0Y2guSUQudGVzdCh3WzBdKSYmIW8ubWF0Y2guSUQudGVzdCh3W3cubGVuZ3RoLTFdKSYmKG49bS5maW5kKHcuc2hpZnQoKSxkLHYpLGQ9bi5leHByP20uZmlsdGVyKG4uZXhwcixuLnNldClbMF06bi5zZXRbMF0pO2lmKGQpe249Zj97ZXhwcjp3LnBvcCgpLHNldDpzKGYpfTptLmZpbmQody5wb3AoKSx3Lmxlbmd0aD09PTEmJih3WzBdPT09XCJ+XCJ8fHdbMF09PT1cIitcIikmJmQucGFyZW50Tm9kZT9kLnBhcmVudE5vZGU6ZCx2KSxqPW4uZXhwcj9tLmZpbHRlcihuLmV4cHIsbi5zZXQpOm4uc2V0LHcubGVuZ3RoPjA/az1zKGopOnU9ITE7d2hpbGUody5sZW5ndGgpcT13LnBvcCgpLHI9cSxvLnJlbGF0aXZlW3FdP3I9dy5wb3AoKTpxPVwiXCIscj09bnVsbCYmKHI9ZCksby5yZWxhdGl2ZVtxXShrLHIsdil9ZWxzZSBrPXc9W119a3x8KGs9aiksa3x8bS5lcnJvcihxfHxiKTtpZihnLmNhbGwoayk9PT1cIltvYmplY3QgQXJyYXldXCIpaWYoIXUpZS5wdXNoLmFwcGx5KGUsayk7ZWxzZSBpZihkJiZkLm5vZGVUeXBlPT09MSlmb3IodD0wO2tbdF0hPW51bGw7dCsrKWtbdF0mJihrW3RdPT09ITB8fGtbdF0ubm9kZVR5cGU9PT0xJiZtLmNvbnRhaW5zKGQsa1t0XSkpJiZlLnB1c2goalt0XSk7ZWxzZSBmb3IodD0wO2tbdF0hPW51bGw7dCsrKWtbdF0mJmtbdF0ubm9kZVR5cGU9PT0xJiZlLnB1c2goalt0XSk7ZWxzZSBzKGssZSk7bCYmKG0obCxoLGUsZiksbS51bmlxdWVTb3J0KGUpKTtyZXR1cm4gZX07bS51bmlxdWVTb3J0PWZ1bmN0aW9uKGEpe2lmKHUpe2g9aSxhLnNvcnQodSk7aWYoaClmb3IodmFyIGI9MTtiPGEubGVuZ3RoO2IrKylhW2JdPT09YVtiLTFdJiZhLnNwbGljZShiLS0sMSl9cmV0dXJuIGF9LG0ubWF0Y2hlcz1mdW5jdGlvbihhLGIpe3JldHVybiBtKGEsbnVsbCxudWxsLGIpfSxtLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihhLGIpe3JldHVybiBtKGIsbnVsbCxudWxsLFthXSkubGVuZ3RoPjB9LG0uZmluZD1mdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmLGcsaCxpO2lmKCFhKXJldHVybltdO2ZvcihlPTAsZj1vLm9yZGVyLmxlbmd0aDtlPGY7ZSsrKXtoPW8ub3JkZXJbZV07aWYoZz1vLmxlZnRNYXRjaFtoXS5leGVjKGEpKXtpPWdbMV0sZy5zcGxpY2UoMSwxKTtpZihpLnN1YnN0cihpLmxlbmd0aC0xKSE9PVwiXFxcXFwiKXtnWzFdPShnWzFdfHxcIlwiKS5yZXBsYWNlKGosXCJcIiksZD1vLmZpbmRbaF0oZyxiLGMpO2lmKGQhPW51bGwpe2E9YS5yZXBsYWNlKG8ubWF0Y2hbaF0sXCJcIik7YnJlYWt9fX19ZHx8KGQ9dHlwZW9mIGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUhPVwidW5kZWZpbmVkXCI/Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShcIipcIik6W10pO3JldHVybntzZXQ6ZCxleHByOmF9fSxtLmZpbHRlcj1mdW5jdGlvbihhLGMsZCxlKXt2YXIgZixnLGgsaSxqLGssbCxuLHAscT1hLHI9W10scz1jLHQ9YyYmY1swXSYmbS5pc1hNTChjWzBdKTt3aGlsZShhJiZjLmxlbmd0aCl7Zm9yKGggaW4gby5maWx0ZXIpaWYoKGY9by5sZWZ0TWF0Y2hbaF0uZXhlYyhhKSkhPW51bGwmJmZbMl0pe2s9by5maWx0ZXJbaF0sbD1mWzFdLGc9ITEsZi5zcGxpY2UoMSwxKTtpZihsLnN1YnN0cihsLmxlbmd0aC0xKT09PVwiXFxcXFwiKWNvbnRpbnVlO3M9PT1yJiYocj1bXSk7aWYoby5wcmVGaWx0ZXJbaF0pe2Y9by5wcmVGaWx0ZXJbaF0oZixzLGQscixlLHQpO2lmKCFmKWc9aT0hMDtlbHNlIGlmKGY9PT0hMCljb250aW51ZX1pZihmKWZvcihuPTA7KGo9c1tuXSkhPW51bGw7bisrKWomJihpPWsoaixmLG4scykscD1lXmksZCYmaSE9bnVsbD9wP2c9ITA6c1tuXT0hMTpwJiYoci5wdXNoKGopLGc9ITApKTtpZihpIT09Yil7ZHx8KHM9ciksYT1hLnJlcGxhY2Uoby5tYXRjaFtoXSxcIlwiKTtpZighZylyZXR1cm5bXTticmVha319aWYoYT09PXEpaWYoZz09bnVsbCltLmVycm9yKGEpO2Vsc2UgYnJlYWs7cT1hfXJldHVybiBzfSxtLmVycm9yPWZ1bmN0aW9uKGEpe3Rocm93IG5ldyBFcnJvcihcIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246IFwiK2EpfTt2YXIgbj1tLmdldFRleHQ9ZnVuY3Rpb24oYSl7dmFyIGIsYyxkPWEubm9kZVR5cGUsZT1cIlwiO2lmKGQpe2lmKGQ9PT0xfHxkPT09OSl7aWYodHlwZW9mIGEudGV4dENvbnRlbnQ9PVwic3RyaW5nXCIpcmV0dXJuIGEudGV4dENvbnRlbnQ7aWYodHlwZW9mIGEuaW5uZXJUZXh0PT1cInN0cmluZ1wiKXJldHVybiBhLmlubmVyVGV4dC5yZXBsYWNlKGssXCJcIik7Zm9yKGE9YS5maXJzdENoaWxkO2E7YT1hLm5leHRTaWJsaW5nKWUrPW4oYSl9ZWxzZSBpZihkPT09M3x8ZD09PTQpcmV0dXJuIGEubm9kZVZhbHVlfWVsc2UgZm9yKGI9MDtjPWFbYl07YisrKWMubm9kZVR5cGUhPT04JiYoZSs9bihjKSk7cmV0dXJuIGV9LG89bS5zZWxlY3RvcnM9e29yZGVyOltcIklEXCIsXCJOQU1FXCIsXCJUQUdcIl0sbWF0Y2g6e0lEOi8jKCg/OltcXHdcXHUwMGMwLVxcdUZGRkZcXC1dfFxcXFwuKSspLyxDTEFTUzovXFwuKCg/OltcXHdcXHUwMGMwLVxcdUZGRkZcXC1dfFxcXFwuKSspLyxOQU1FOi9cXFtuYW1lPVsnXCJdKigoPzpbXFx3XFx1MDBjMC1cXHVGRkZGXFwtXXxcXFxcLikrKVsnXCJdKlxcXS8sQVRUUjovXFxbXFxzKigoPzpbXFx3XFx1MDBjMC1cXHVGRkZGXFwtXXxcXFxcLikrKVxccyooPzooXFxTPz0pXFxzKig/OihbJ1wiXSkoLio/KVxcM3woIz8oPzpbXFx3XFx1MDBjMC1cXHVGRkZGXFwtXXxcXFxcLikqKXwpfClcXHMqXFxdLyxUQUc6L14oKD86W1xcd1xcdTAwYzAtXFx1RkZGRlxcKlxcLV18XFxcXC4pKykvLENISUxEOi86KG9ubHl8bnRofGxhc3R8Zmlyc3QpLWNoaWxkKD86XFwoXFxzKihldmVufG9kZHwoPzpbK1xcLV0/XFxkK3woPzpbK1xcLV0/XFxkKik/blxccyooPzpbK1xcLV1cXHMqXFxkKyk/KSlcXHMqXFwpKT8vLFBPUzovOihudGh8ZXF8Z3R8bHR8Zmlyc3R8bGFzdHxldmVufG9kZCkoPzpcXCgoXFxkKilcXCkpPyg/PVteXFwtXXwkKS8sUFNFVURPOi86KCg/OltcXHdcXHUwMGMwLVxcdUZGRkZcXC1dfFxcXFwuKSspKD86XFwoKFsnXCJdPykoKD86XFwoW15cXCldK1xcKXxbXlxcKFxcKV0qKSspXFwyXFwpKT8vfSxsZWZ0TWF0Y2g6e30sYXR0ck1hcDp7XCJjbGFzc1wiOlwiY2xhc3NOYW1lXCIsXCJmb3JcIjpcImh0bWxGb3JcIn0sYXR0ckhhbmRsZTp7aHJlZjpmdW5jdGlvbihhKXtyZXR1cm4gYS5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpfSx0eXBlOmZ1bmN0aW9uKGEpe3JldHVybiBhLmdldEF0dHJpYnV0ZShcInR5cGVcIil9fSxyZWxhdGl2ZTp7XCIrXCI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10eXBlb2YgYj09XCJzdHJpbmdcIixkPWMmJiFsLnRlc3QoYiksZT1jJiYhZDtkJiYoYj1iLnRvTG93ZXJDYXNlKCkpO2Zvcih2YXIgZj0wLGc9YS5sZW5ndGgsaDtmPGc7ZisrKWlmKGg9YVtmXSl7d2hpbGUoKGg9aC5wcmV2aW91c1NpYmxpbmcpJiZoLm5vZGVUeXBlIT09MSk7YVtmXT1lfHxoJiZoLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1iP2h8fCExOmg9PT1ifWUmJm0uZmlsdGVyKGIsYSwhMCl9LFwiPlwiOmZ1bmN0aW9uKGEsYil7dmFyIGMsZD10eXBlb2YgYj09XCJzdHJpbmdcIixlPTAsZj1hLmxlbmd0aDtpZihkJiYhbC50ZXN0KGIpKXtiPWIudG9Mb3dlckNhc2UoKTtmb3IoO2U8ZjtlKyspe2M9YVtlXTtpZihjKXt2YXIgZz1jLnBhcmVudE5vZGU7YVtlXT1nLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1iP2c6ITF9fX1lbHNle2Zvcig7ZTxmO2UrKyljPWFbZV0sYyYmKGFbZV09ZD9jLnBhcmVudE5vZGU6Yy5wYXJlbnROb2RlPT09Yik7ZCYmbS5maWx0ZXIoYixhLCEwKX19LFwiXCI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGY9ZSsrLGc9eDt0eXBlb2YgYj09XCJzdHJpbmdcIiYmIWwudGVzdChiKSYmKGI9Yi50b0xvd2VyQ2FzZSgpLGQ9YixnPXcpLGcoXCJwYXJlbnROb2RlXCIsYixmLGEsZCxjKX0sXCJ+XCI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGY9ZSsrLGc9eDt0eXBlb2YgYj09XCJzdHJpbmdcIiYmIWwudGVzdChiKSYmKGI9Yi50b0xvd2VyQ2FzZSgpLGQ9YixnPXcpLGcoXCJwcmV2aW91c1NpYmxpbmdcIixiLGYsYSxkLGMpfX0sZmluZDp7SUQ6ZnVuY3Rpb24oYSxiLGMpe2lmKHR5cGVvZiBiLmdldEVsZW1lbnRCeUlkIT1cInVuZGVmaW5lZFwiJiYhYyl7dmFyIGQ9Yi5nZXRFbGVtZW50QnlJZChhWzFdKTtyZXR1cm4gZCYmZC5wYXJlbnROb2RlP1tkXTpbXX19LE5BTUU6ZnVuY3Rpb24oYSxiKXtpZih0eXBlb2YgYi5nZXRFbGVtZW50c0J5TmFtZSE9XCJ1bmRlZmluZWRcIil7dmFyIGM9W10sZD1iLmdldEVsZW1lbnRzQnlOYW1lKGFbMV0pO2Zvcih2YXIgZT0wLGY9ZC5sZW5ndGg7ZTxmO2UrKylkW2VdLmdldEF0dHJpYnV0ZShcIm5hbWVcIik9PT1hWzFdJiZjLnB1c2goZFtlXSk7cmV0dXJuIGMubGVuZ3RoPT09MD9udWxsOmN9fSxUQUc6ZnVuY3Rpb24oYSxiKXtpZih0eXBlb2YgYi5nZXRFbGVtZW50c0J5VGFnTmFtZSE9XCJ1bmRlZmluZWRcIilyZXR1cm4gYi5nZXRFbGVtZW50c0J5VGFnTmFtZShhWzFdKX19LHByZUZpbHRlcjp7Q0xBU1M6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe2E9XCIgXCIrYVsxXS5yZXBsYWNlKGosXCJcIikrXCIgXCI7aWYoZilyZXR1cm4gYTtmb3IodmFyIGc9MCxoOyhoPWJbZ10pIT1udWxsO2crKyloJiYoZV4oaC5jbGFzc05hbWUmJihcIiBcIitoLmNsYXNzTmFtZStcIiBcIikucmVwbGFjZSgvW1xcdFxcblxccl0vZyxcIiBcIikuaW5kZXhPZihhKT49MCk/Y3x8ZC5wdXNoKGgpOmMmJihiW2ddPSExKSk7cmV0dXJuITF9LElEOmZ1bmN0aW9uKGEpe3JldHVybiBhWzFdLnJlcGxhY2UoaixcIlwiKX0sVEFHOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGFbMV0ucmVwbGFjZShqLFwiXCIpLnRvTG93ZXJDYXNlKCl9LENISUxEOmZ1bmN0aW9uKGEpe2lmKGFbMV09PT1cIm50aFwiKXthWzJdfHxtLmVycm9yKGFbMF0pLGFbMl09YVsyXS5yZXBsYWNlKC9eXFwrfFxccyovZyxcIlwiKTt2YXIgYj0vKC0/KShcXGQqKSg/Om4oWytcXC1dP1xcZCopKT8vLmV4ZWMoYVsyXT09PVwiZXZlblwiJiZcIjJuXCJ8fGFbMl09PT1cIm9kZFwiJiZcIjJuKzFcInx8IS9cXEQvLnRlc3QoYVsyXSkmJlwiMG4rXCIrYVsyXXx8YVsyXSk7YVsyXT1iWzFdKyhiWzJdfHwxKS0wLGFbM109YlszXS0wfWVsc2UgYVsyXSYmbS5lcnJvcihhWzBdKTthWzBdPWUrKztyZXR1cm4gYX0sQVRUUjpmdW5jdGlvbihhLGIsYyxkLGUsZil7dmFyIGc9YVsxXT1hWzFdLnJlcGxhY2UoaixcIlwiKTshZiYmby5hdHRyTWFwW2ddJiYoYVsxXT1vLmF0dHJNYXBbZ10pLGFbNF09KGFbNF18fGFbNV18fFwiXCIpLnJlcGxhY2UoaixcIlwiKSxhWzJdPT09XCJ+PVwiJiYoYVs0XT1cIiBcIithWzRdK1wiIFwiKTtyZXR1cm4gYX0sUFNFVURPOmZ1bmN0aW9uKGIsYyxkLGUsZil7aWYoYlsxXT09PVwibm90XCIpaWYoKGEuZXhlYyhiWzNdKXx8XCJcIikubGVuZ3RoPjF8fC9eXFx3Ly50ZXN0KGJbM10pKWJbM109bShiWzNdLG51bGwsbnVsbCxjKTtlbHNle3ZhciBnPW0uZmlsdGVyKGJbM10sYyxkLCEwXmYpO2R8fGUucHVzaC5hcHBseShlLGcpO3JldHVybiExfWVsc2UgaWYoby5tYXRjaC5QT1MudGVzdChiWzBdKXx8by5tYXRjaC5DSElMRC50ZXN0KGJbMF0pKXJldHVybiEwO3JldHVybiBifSxQT1M6ZnVuY3Rpb24oYSl7YS51bnNoaWZ0KCEwKTtyZXR1cm4gYX19LGZpbHRlcnM6e2VuYWJsZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZGlzYWJsZWQ9PT0hMSYmYS50eXBlIT09XCJoaWRkZW5cIn0sZGlzYWJsZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZGlzYWJsZWQ9PT0hMH0sY2hlY2tlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5jaGVja2VkPT09ITB9LHNlbGVjdGVkOmZ1bmN0aW9uKGEpe2EucGFyZW50Tm9kZSYmYS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXg7cmV0dXJuIGEuc2VsZWN0ZWQ9PT0hMH0scGFyZW50OmZ1bmN0aW9uKGEpe3JldHVybiEhYS5maXJzdENoaWxkfSxlbXB0eTpmdW5jdGlvbihhKXtyZXR1cm4hYS5maXJzdENoaWxkfSxoYXM6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiEhbShjWzNdLGEpLmxlbmd0aH0saGVhZGVyOmZ1bmN0aW9uKGEpe3JldHVybi9oXFxkL2kudGVzdChhLm5vZGVOYW1lKX0sdGV4dDpmdW5jdGlvbihhKXt2YXIgYj1hLmdldEF0dHJpYnV0ZShcInR5cGVcIiksYz1hLnR5cGU7cmV0dXJuIGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PVwiaW5wdXRcIiYmXCJ0ZXh0XCI9PT1jJiYoYj09PWN8fGI9PT1udWxsKX0scmFkaW86ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PVwiaW5wdXRcIiYmXCJyYWRpb1wiPT09YS50eXBlfSxjaGVja2JveDpmdW5jdGlvbihhKXtyZXR1cm4gYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09XCJpbnB1dFwiJiZcImNoZWNrYm94XCI9PT1hLnR5cGV9LGZpbGU6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PVwiaW5wdXRcIiYmXCJmaWxlXCI9PT1hLnR5cGV9LHBhc3N3b3JkOmZ1bmN0aW9uKGEpe3JldHVybiBhLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1cImlucHV0XCImJlwicGFzc3dvcmRcIj09PWEudHlwZX0sc3VibWl0OmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4oYj09PVwiaW5wdXRcInx8Yj09PVwiYnV0dG9uXCIpJiZcInN1Ym1pdFwiPT09YS50eXBlfSxpbWFnZTpmdW5jdGlvbihhKXtyZXR1cm4gYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09XCJpbnB1dFwiJiZcImltYWdlXCI9PT1hLnR5cGV9LHJlc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4oYj09PVwiaW5wdXRcInx8Yj09PVwiYnV0dG9uXCIpJiZcInJlc2V0XCI9PT1hLnR5cGV9LGJ1dHRvbjpmdW5jdGlvbihhKXt2YXIgYj1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuIGI9PT1cImlucHV0XCImJlwiYnV0dG9uXCI9PT1hLnR5cGV8fGI9PT1cImJ1dHRvblwifSxpbnB1dDpmdW5jdGlvbihhKXtyZXR1cm4vaW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbi9pLnRlc3QoYS5ub2RlTmFtZSl9LGZvY3VzOmZ1bmN0aW9uKGEpe3JldHVybiBhPT09YS5vd25lckRvY3VtZW50LmFjdGl2ZUVsZW1lbnR9fSxzZXRGaWx0ZXJzOntmaXJzdDpmdW5jdGlvbihhLGIpe3JldHVybiBiPT09MH0sbGFzdDpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gYj09PWQubGVuZ3RoLTF9LGV2ZW46ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYiUyPT09MH0sb2RkOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGIlMj09PTF9LGx0OmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYjxjWzNdLTB9LGd0OmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYj5jWzNdLTB9LG50aDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGNbM10tMD09PWJ9LGVxOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gY1szXS0wPT09Yn19LGZpbHRlcjp7UFNFVURPOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPWJbMV0sZj1vLmZpbHRlcnNbZV07aWYoZilyZXR1cm4gZihhLGMsYixkKTtpZihlPT09XCJjb250YWluc1wiKXJldHVybihhLnRleHRDb250ZW50fHxhLmlubmVyVGV4dHx8bihbYV0pfHxcIlwiKS5pbmRleE9mKGJbM10pPj0wO2lmKGU9PT1cIm5vdFwiKXt2YXIgZz1iWzNdO2Zvcih2YXIgaD0wLGk9Zy5sZW5ndGg7aDxpO2grKylpZihnW2hdPT09YSlyZXR1cm4hMTtyZXR1cm4hMH1tLmVycm9yKGUpfSxDSElMRDpmdW5jdGlvbihhLGIpe3ZhciBjLGUsZixnLGgsaSxqLGs9YlsxXSxsPWE7c3dpdGNoKGspe2Nhc2VcIm9ubHlcIjpjYXNlXCJmaXJzdFwiOndoaWxlKGw9bC5wcmV2aW91c1NpYmxpbmcpaWYobC5ub2RlVHlwZT09PTEpcmV0dXJuITE7aWYoaz09PVwiZmlyc3RcIilyZXR1cm4hMDtsPWE7Y2FzZVwibGFzdFwiOndoaWxlKGw9bC5uZXh0U2libGluZylpZihsLm5vZGVUeXBlPT09MSlyZXR1cm4hMTtyZXR1cm4hMDtjYXNlXCJudGhcIjpjPWJbMl0sZT1iWzNdO2lmKGM9PT0xJiZlPT09MClyZXR1cm4hMDtmPWJbMF0sZz1hLnBhcmVudE5vZGU7aWYoZyYmKGdbZF0hPT1mfHwhYS5ub2RlSW5kZXgpKXtpPTA7Zm9yKGw9Zy5maXJzdENoaWxkO2w7bD1sLm5leHRTaWJsaW5nKWwubm9kZVR5cGU9PT0xJiYobC5ub2RlSW5kZXg9KytpKTtnW2RdPWZ9aj1hLm5vZGVJbmRleC1lO3JldHVybiBjPT09MD9qPT09MDpqJWM9PT0wJiZqL2M+PTB9fSxJRDpmdW5jdGlvbihhLGIpe3JldHVybiBhLm5vZGVUeXBlPT09MSYmYS5nZXRBdHRyaWJ1dGUoXCJpZFwiKT09PWJ9LFRBRzpmdW5jdGlvbihhLGIpe3JldHVybiBiPT09XCIqXCImJmEubm9kZVR5cGU9PT0xfHwhIWEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWJ9LENMQVNTOmZ1bmN0aW9uKGEsYil7cmV0dXJuKFwiIFwiKyhhLmNsYXNzTmFtZXx8YS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKSkrXCIgXCIpLmluZGV4T2YoYik+LTF9LEFUVFI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iWzFdLGQ9bS5hdHRyP20uYXR0cihhLGMpOm8uYXR0ckhhbmRsZVtjXT9vLmF0dHJIYW5kbGVbY10oYSk6YVtjXSE9bnVsbD9hW2NdOmEuZ2V0QXR0cmlidXRlKGMpLGU9ZCtcIlwiLGY9YlsyXSxnPWJbNF07cmV0dXJuIGQ9PW51bGw/Zj09PVwiIT1cIjohZiYmbS5hdHRyP2QhPW51bGw6Zj09PVwiPVwiP2U9PT1nOmY9PT1cIio9XCI/ZS5pbmRleE9mKGcpPj0wOmY9PT1cIn49XCI/KFwiIFwiK2UrXCIgXCIpLmluZGV4T2YoZyk+PTA6Zz9mPT09XCIhPVwiP2UhPT1nOmY9PT1cIl49XCI/ZS5pbmRleE9mKGcpPT09MDpmPT09XCIkPVwiP2Uuc3Vic3RyKGUubGVuZ3RoLWcubGVuZ3RoKT09PWc6Zj09PVwifD1cIj9lPT09Z3x8ZS5zdWJzdHIoMCxnLmxlbmd0aCsxKT09PWcrXCItXCI6ITE6ZSYmZCE9PSExfSxQT1M6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9YlsyXSxmPW8uc2V0RmlsdGVyc1tlXTtpZihmKXJldHVybiBmKGEsYyxiLGQpfX19LHA9by5tYXRjaC5QT1MscT1mdW5jdGlvbihhLGIpe3JldHVyblwiXFxcXFwiKyhiLTArMSl9O2Zvcih2YXIgciBpbiBvLm1hdGNoKW8ubWF0Y2hbcl09bmV3IFJlZ0V4cChvLm1hdGNoW3JdLnNvdXJjZSsvKD8hW15cXFtdKlxcXSkoPyFbXlxcKF0qXFwpKS8uc291cmNlKSxvLmxlZnRNYXRjaFtyXT1uZXcgUmVnRXhwKC8oXig/Oi58XFxyfFxcbikqPykvLnNvdXJjZStvLm1hdGNoW3JdLnNvdXJjZS5yZXBsYWNlKC9cXFxcKFxcZCspL2cscSkpO3ZhciBzPWZ1bmN0aW9uKGEsYil7YT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhLDApO2lmKGIpe2IucHVzaC5hcHBseShiLGEpO3JldHVybiBifXJldHVybiBhfTt0cnl7QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYy5kb2N1bWVudEVsZW1lbnQuY2hpbGROb2RlcywwKVswXS5ub2RlVHlwZX1jYXRjaCh0KXtzPWZ1bmN0aW9uKGEsYil7dmFyIGM9MCxkPWJ8fFtdO2lmKGcuY2FsbChhKT09PVwiW29iamVjdCBBcnJheV1cIilBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShkLGEpO2Vsc2UgaWYodHlwZW9mIGEubGVuZ3RoPT1cIm51bWJlclwiKWZvcih2YXIgZT1hLmxlbmd0aDtjPGU7YysrKWQucHVzaChhW2NdKTtlbHNlIGZvcig7YVtjXTtjKyspZC5wdXNoKGFbY10pO3JldHVybiBkfX12YXIgdSx2O2MuZG9jdW1lbnRFbGVtZW50LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uP3U9ZnVuY3Rpb24oYSxiKXtpZihhPT09Yil7aD0hMDtyZXR1cm4gMH1pZighYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbnx8IWIuY29tcGFyZURvY3VtZW50UG9zaXRpb24pcmV0dXJuIGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24/LTE6MTtyZXR1cm4gYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihiKSY0Py0xOjF9Oih1PWZ1bmN0aW9uKGEsYil7aWYoYT09PWIpe2g9ITA7cmV0dXJuIDB9aWYoYS5zb3VyY2VJbmRleCYmYi5zb3VyY2VJbmRleClyZXR1cm4gYS5zb3VyY2VJbmRleC1iLnNvdXJjZUluZGV4O3ZhciBjLGQsZT1bXSxmPVtdLGc9YS5wYXJlbnROb2RlLGk9Yi5wYXJlbnROb2RlLGo9ZztpZihnPT09aSlyZXR1cm4gdihhLGIpO2lmKCFnKXJldHVybi0xO2lmKCFpKXJldHVybiAxO3doaWxlKGopZS51bnNoaWZ0KGopLGo9ai5wYXJlbnROb2RlO2o9aTt3aGlsZShqKWYudW5zaGlmdChqKSxqPWoucGFyZW50Tm9kZTtjPWUubGVuZ3RoLGQ9Zi5sZW5ndGg7Zm9yKHZhciBrPTA7azxjJiZrPGQ7aysrKWlmKGVba10hPT1mW2tdKXJldHVybiB2KGVba10sZltrXSk7cmV0dXJuIGs9PT1jP3YoYSxmW2tdLC0xKTp2KGVba10sYiwxKX0sdj1mdW5jdGlvbihhLGIsYyl7aWYoYT09PWIpcmV0dXJuIGM7dmFyIGQ9YS5uZXh0U2libGluZzt3aGlsZShkKXtpZihkPT09YilyZXR1cm4tMTtkPWQubmV4dFNpYmxpbmd9cmV0dXJuIDF9KSxmdW5jdGlvbigpe3ZhciBhPWMuY3JlYXRlRWxlbWVudChcImRpdlwiKSxkPVwic2NyaXB0XCIrKG5ldyBEYXRlKS5nZXRUaW1lKCksZT1jLmRvY3VtZW50RWxlbWVudDthLmlubmVySFRNTD1cIjxhIG5hbWU9J1wiK2QrXCInLz5cIixlLmluc2VydEJlZm9yZShhLGUuZmlyc3RDaGlsZCksYy5nZXRFbGVtZW50QnlJZChkKSYmKG8uZmluZC5JRD1mdW5jdGlvbihhLGMsZCl7aWYodHlwZW9mIGMuZ2V0RWxlbWVudEJ5SWQhPVwidW5kZWZpbmVkXCImJiFkKXt2YXIgZT1jLmdldEVsZW1lbnRCeUlkKGFbMV0pO3JldHVybiBlP2UuaWQ9PT1hWzFdfHx0eXBlb2YgZS5nZXRBdHRyaWJ1dGVOb2RlIT1cInVuZGVmaW5lZFwiJiZlLmdldEF0dHJpYnV0ZU5vZGUoXCJpZFwiKS5ub2RlVmFsdWU9PT1hWzFdP1tlXTpiOltdfX0sby5maWx0ZXIuSUQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10eXBlb2YgYS5nZXRBdHRyaWJ1dGVOb2RlIT1cInVuZGVmaW5lZFwiJiZhLmdldEF0dHJpYnV0ZU5vZGUoXCJpZFwiKTtyZXR1cm4gYS5ub2RlVHlwZT09PTEmJmMmJmMubm9kZVZhbHVlPT09Yn0pLGUucmVtb3ZlQ2hpbGQoYSksZT1hPW51bGx9KCksZnVuY3Rpb24oKXt2YXIgYT1jLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7YS5hcHBlbmRDaGlsZChjLmNyZWF0ZUNvbW1lbnQoXCJcIikpLGEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpLmxlbmd0aD4wJiYoby5maW5kLlRBRz1mdW5jdGlvbihhLGIpe3ZhciBjPWIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYVsxXSk7aWYoYVsxXT09PVwiKlwiKXt2YXIgZD1bXTtmb3IodmFyIGU9MDtjW2VdO2UrKyljW2VdLm5vZGVUeXBlPT09MSYmZC5wdXNoKGNbZV0pO2M9ZH1yZXR1cm4gY30pLGEuaW5uZXJIVE1MPVwiPGEgaHJlZj0nIyc+PC9hPlwiLGEuZmlyc3RDaGlsZCYmdHlwZW9mIGEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUhPVwidW5kZWZpbmVkXCImJmEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpIT09XCIjXCImJihvLmF0dHJIYW5kbGUuaHJlZj1mdW5jdGlvbihhKXtyZXR1cm4gYS5nZXRBdHRyaWJ1dGUoXCJocmVmXCIsMil9KSxhPW51bGx9KCksYy5xdWVyeVNlbGVjdG9yQWxsJiZmdW5jdGlvbigpe3ZhciBhPW0sYj1jLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksZD1cIl9fc2l6emxlX19cIjtiLmlubmVySFRNTD1cIjxwIGNsYXNzPSdURVNUJz48L3A+XCI7aWYoIWIucXVlcnlTZWxlY3RvckFsbHx8Yi5xdWVyeVNlbGVjdG9yQWxsKFwiLlRFU1RcIikubGVuZ3RoIT09MCl7bT1mdW5jdGlvbihiLGUsZixnKXtlPWV8fGM7aWYoIWcmJiFtLmlzWE1MKGUpKXt2YXIgaD0vXihcXHcrJCl8XlxcLihbXFx3XFwtXSskKXxeIyhbXFx3XFwtXSskKS8uZXhlYyhiKTtpZihoJiYoZS5ub2RlVHlwZT09PTF8fGUubm9kZVR5cGU9PT05KSl7aWYoaFsxXSlyZXR1cm4gcyhlLmdldEVsZW1lbnRzQnlUYWdOYW1lKGIpLGYpO2lmKGhbMl0mJm8uZmluZC5DTEFTUyYmZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKXJldHVybiBzKGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShoWzJdKSxmKX1pZihlLm5vZGVUeXBlPT09OSl7aWYoYj09PVwiYm9keVwiJiZlLmJvZHkpcmV0dXJuIHMoW2UuYm9keV0sZik7aWYoaCYmaFszXSl7dmFyIGk9ZS5nZXRFbGVtZW50QnlJZChoWzNdKTtpZighaXx8IWkucGFyZW50Tm9kZSlyZXR1cm4gcyhbXSxmKTtpZihpLmlkPT09aFszXSlyZXR1cm4gcyhbaV0sZil9dHJ5e3JldHVybiBzKGUucXVlcnlTZWxlY3RvckFsbChiKSxmKX1jYXRjaChqKXt9fWVsc2UgaWYoZS5ub2RlVHlwZT09PTEmJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSE9PVwib2JqZWN0XCIpe3ZhciBrPWUsbD1lLmdldEF0dHJpYnV0ZShcImlkXCIpLG49bHx8ZCxwPWUucGFyZW50Tm9kZSxxPS9eXFxzKlsrfl0vLnRlc3QoYik7bD9uPW4ucmVwbGFjZSgvJy9nLFwiXFxcXCQmXCIpOmUuc2V0QXR0cmlidXRlKFwiaWRcIixuKSxxJiZwJiYoZT1lLnBhcmVudE5vZGUpO3RyeXtpZighcXx8cClyZXR1cm4gcyhlLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbaWQ9J1wiK24rXCInXSBcIitiKSxmKX1jYXRjaChyKXt9ZmluYWxseXtsfHxrLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpfX19cmV0dXJuIGEoYixlLGYsZyl9O2Zvcih2YXIgZSBpbiBhKW1bZV09YVtlXTtiPW51bGx9fSgpLGZ1bmN0aW9uKCl7dmFyIGE9Yy5kb2N1bWVudEVsZW1lbnQsYj1hLm1hdGNoZXNTZWxlY3Rvcnx8YS5tb3pNYXRjaGVzU2VsZWN0b3J8fGEud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxhLm1zTWF0Y2hlc1NlbGVjdG9yO2lmKGIpe3ZhciBkPSFiLmNhbGwoYy5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFwiZGl2XCIpLGU9ITE7dHJ5e2IuY2FsbChjLmRvY3VtZW50RWxlbWVudCxcIlt0ZXN0IT0nJ106c2l6emxlXCIpfWNhdGNoKGYpe2U9ITB9bS5tYXRjaGVzU2VsZWN0b3I9ZnVuY3Rpb24oYSxjKXtjPWMucmVwbGFjZSgvXFw9XFxzKihbXidcIlxcXV0qKVxccypcXF0vZyxcIj0nJDEnXVwiKTtpZighbS5pc1hNTChhKSl0cnl7aWYoZXx8IW8ubWF0Y2guUFNFVURPLnRlc3QoYykmJiEvIT0vLnRlc3QoYykpe3ZhciBmPWIuY2FsbChhLGMpO2lmKGZ8fCFkfHxhLmRvY3VtZW50JiZhLmRvY3VtZW50Lm5vZGVUeXBlIT09MTEpcmV0dXJuIGZ9fWNhdGNoKGcpe31yZXR1cm4gbShjLG51bGwsbnVsbCxbYV0pLmxlbmd0aD4wfX19KCksZnVuY3Rpb24oKXt2YXIgYT1jLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7YS5pbm5lckhUTUw9XCI8ZGl2IGNsYXNzPSd0ZXN0IGUnPjwvZGl2PjxkaXYgY2xhc3M9J3Rlc3QnPjwvZGl2PlwiO2lmKCEhYS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZhLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJlXCIpLmxlbmd0aCE9PTApe2EubGFzdENoaWxkLmNsYXNzTmFtZT1cImVcIjtpZihhLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJlXCIpLmxlbmd0aD09PTEpcmV0dXJuO28ub3JkZXIuc3BsaWNlKDEsMCxcIkNMQVNTXCIpLG8uZmluZC5DTEFTUz1mdW5jdGlvbihhLGIsYyl7aWYodHlwZW9mIGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSE9XCJ1bmRlZmluZWRcIiYmIWMpcmV0dXJuIGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShhWzFdKX0sYT1udWxsfX0oKSxjLmRvY3VtZW50RWxlbWVudC5jb250YWlucz9tLmNvbnRhaW5zPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGEhPT1iJiYoYS5jb250YWlucz9hLmNvbnRhaW5zKGIpOiEwKX06Yy5kb2N1bWVudEVsZW1lbnQuY29tcGFyZURvY3VtZW50UG9zaXRpb24/bS5jb250YWlucz1mdW5jdGlvbihhLGIpe3JldHVybiEhKGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYikmMTYpfTptLmNvbnRhaW5zPWZ1bmN0aW9uKCl7cmV0dXJuITF9LG0uaXNYTUw9ZnVuY3Rpb24oYSl7dmFyIGI9KGE/YS5vd25lckRvY3VtZW50fHxhOjApLmRvY3VtZW50RWxlbWVudDtyZXR1cm4gYj9iLm5vZGVOYW1lIT09XCJIVE1MXCI6ITF9O3ZhciB5PWZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPVtdLGY9XCJcIixnPWIubm9kZVR5cGU/W2JdOmI7d2hpbGUoZD1vLm1hdGNoLlBTRVVETy5leGVjKGEpKWYrPWRbMF0sYT1hLnJlcGxhY2Uoby5tYXRjaC5QU0VVRE8sXCJcIik7YT1vLnJlbGF0aXZlW2FdP2ErXCIqXCI6YTtmb3IodmFyIGg9MCxpPWcubGVuZ3RoO2g8aTtoKyspbShhLGdbaF0sZSxjKTtyZXR1cm4gbS5maWx0ZXIoZixlKX07bS5hdHRyPWYuYXR0cixtLnNlbGVjdG9ycy5hdHRyTWFwPXt9LGYuZmluZD1tLGYuZXhwcj1tLnNlbGVjdG9ycyxmLmV4cHJbXCI6XCJdPWYuZXhwci5maWx0ZXJzLGYudW5pcXVlPW0udW5pcXVlU29ydCxmLnRleHQ9bS5nZXRUZXh0LGYuaXNYTUxEb2M9bS5pc1hNTCxmLmNvbnRhaW5zPW0uY29udGFpbnN9KCk7dmFyIEw9L1VudGlsJC8sTT0vXig/OnBhcmVudHN8cHJldlVudGlsfHByZXZBbGwpLyxOPS8sLyxPPS9eLlteOiNcXFtcXC4sXSokLyxQPUFycmF5LnByb3RvdHlwZS5zbGljZSxRPWYuZXhwci5tYXRjaC5QT1MsUj17Y2hpbGRyZW46ITAsY29udGVudHM6ITAsbmV4dDohMCxwcmV2OiEwfTtmLmZuLmV4dGVuZCh7ZmluZDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGMsZDtpZih0eXBlb2YgYSE9XCJzdHJpbmdcIilyZXR1cm4gZihhKS5maWx0ZXIoZnVuY3Rpb24oKXtmb3IoYz0wLGQ9Yi5sZW5ndGg7YzxkO2MrKylpZihmLmNvbnRhaW5zKGJbY10sdGhpcykpcmV0dXJuITB9KTt2YXIgZT10aGlzLnB1c2hTdGFjayhcIlwiLFwiZmluZFwiLGEpLGcsaCxpO2ZvcihjPTAsZD10aGlzLmxlbmd0aDtjPGQ7YysrKXtnPWUubGVuZ3RoLGYuZmluZChhLHRoaXNbY10sZSk7aWYoYz4wKWZvcihoPWc7aDxlLmxlbmd0aDtoKyspZm9yKGk9MDtpPGc7aSsrKWlmKGVbaV09PT1lW2hdKXtlLnNwbGljZShoLS0sMSk7YnJlYWt9fXJldHVybiBlfSxoYXM6ZnVuY3Rpb24oYSl7dmFyIGI9ZihhKTtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodmFyIGE9MCxjPWIubGVuZ3RoO2E8YzthKyspaWYoZi5jb250YWlucyh0aGlzLGJbYV0pKXJldHVybiEwfSl9LG5vdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soVCh0aGlzLGEsITEpLFwibm90XCIsYSl9LGZpbHRlcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soVCh0aGlzLGEsITApLFwiZmlsdGVyXCIsYSl9LGlzOmZ1bmN0aW9uKGEpe3JldHVybiEhYSYmKHR5cGVvZiBhPT1cInN0cmluZ1wiP1EudGVzdChhKT9mKGEsdGhpcy5jb250ZXh0KS5pbmRleCh0aGlzWzBdKT49MDpmLmZpbHRlcihhLHRoaXMpLmxlbmd0aD4wOnRoaXMuZmlsdGVyKGEpLmxlbmd0aD4wKX0sY2xvc2VzdDpmdW5jdGlvbihhLGIpe3ZhciBjPVtdLGQsZSxnPXRoaXNbMF07aWYoZi5pc0FycmF5KGEpKXt2YXIgaD0xO3doaWxlKGcmJmcub3duZXJEb2N1bWVudCYmZyE9PWIpe2ZvcihkPTA7ZDxhLmxlbmd0aDtkKyspZihnKS5pcyhhW2RdKSYmYy5wdXNoKHtzZWxlY3RvcjphW2RdLGVsZW06ZyxsZXZlbDpofSk7Zz1nLnBhcmVudE5vZGUsaCsrfXJldHVybiBjfXZhciBpPVEudGVzdChhKXx8dHlwZW9mIGEhPVwic3RyaW5nXCI/ZihhLGJ8fHRoaXMuY29udGV4dCk6MDtmb3IoZD0wLGU9dGhpcy5sZW5ndGg7ZDxlO2QrKyl7Zz10aGlzW2RdO3doaWxlKGcpe2lmKGk/aS5pbmRleChnKT4tMTpmLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGcsYSkpe2MucHVzaChnKTticmVha31nPWcucGFyZW50Tm9kZTtpZighZ3x8IWcub3duZXJEb2N1bWVudHx8Zz09PWJ8fGcubm9kZVR5cGU9PT0xMSlicmVha319Yz1jLmxlbmd0aD4xP2YudW5pcXVlKGMpOmM7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGMsXCJjbG9zZXN0XCIsYSl9LGluZGV4OmZ1bmN0aW9uKGEpe2lmKCFhKXJldHVybiB0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGU/dGhpcy5wcmV2QWxsKCkubGVuZ3RoOi0xO2lmKHR5cGVvZiBhPT1cInN0cmluZ1wiKXJldHVybiBmLmluQXJyYXkodGhpc1swXSxmKGEpKTtyZXR1cm4gZi5pbkFycmF5KGEuanF1ZXJ5P2FbMF06YSx0aGlzKX0sYWRkOmZ1bmN0aW9uKGEsYil7dmFyIGM9dHlwZW9mIGE9PVwic3RyaW5nXCI/ZihhLGIpOmYubWFrZUFycmF5KGEmJmEubm9kZVR5cGU/W2FdOmEpLGQ9Zi5tZXJnZSh0aGlzLmdldCgpLGMpO3JldHVybiB0aGlzLnB1c2hTdGFjayhTKGNbMF0pfHxTKGRbMF0pP2Q6Zi51bmlxdWUoZCkpfSxhbmRTZWxmOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWRkKHRoaXMucHJldk9iamVjdCl9fSksZi5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5wYXJlbnROb2RlO3JldHVybiBiJiZiLm5vZGVUeXBlIT09MTE/YjpudWxsfSxwYXJlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBmLmRpcihhLFwicGFyZW50Tm9kZVwiKX0scGFyZW50c1VudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZi5kaXIoYSxcInBhcmVudE5vZGVcIixjKX0sbmV4dDpmdW5jdGlvbihhKXtyZXR1cm4gZi5udGgoYSwyLFwibmV4dFNpYmxpbmdcIil9LHByZXY6ZnVuY3Rpb24oYSl7cmV0dXJuIGYubnRoKGEsMixcInByZXZpb3VzU2libGluZ1wiKX0sbmV4dEFsbDpmdW5jdGlvbihhKXtyZXR1cm4gZi5kaXIoYSxcIm5leHRTaWJsaW5nXCIpfSxwcmV2QWxsOmZ1bmN0aW9uKGEpe3JldHVybiBmLmRpcihhLFwicHJldmlvdXNTaWJsaW5nXCIpfSxuZXh0VW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmLmRpcihhLFwibmV4dFNpYmxpbmdcIixjKX0scHJldlVudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZi5kaXIoYSxcInByZXZpb3VzU2libGluZ1wiLGMpfSxzaWJsaW5nczpmdW5jdGlvbihhKXtyZXR1cm4gZi5zaWJsaW5nKGEucGFyZW50Tm9kZS5maXJzdENoaWxkLGEpfSxjaGlsZHJlbjpmdW5jdGlvbihhKXtyZXR1cm4gZi5zaWJsaW5nKGEuZmlyc3RDaGlsZCl9LGNvbnRlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBmLm5vZGVOYW1lKGEsXCJpZnJhbWVcIik/YS5jb250ZW50RG9jdW1lbnR8fGEuY29udGVudFdpbmRvdy5kb2N1bWVudDpmLm1ha2VBcnJheShhLmNoaWxkTm9kZXMpfX0sZnVuY3Rpb24oYSxiKXtmLmZuW2FdPWZ1bmN0aW9uKGMsZCl7dmFyIGU9Zi5tYXAodGhpcyxiLGMpO0wudGVzdChhKXx8KGQ9YyksZCYmdHlwZW9mIGQ9PVwic3RyaW5nXCImJihlPWYuZmlsdGVyKGQsZSkpLGU9dGhpcy5sZW5ndGg+MSYmIVJbYV0/Zi51bmlxdWUoZSk6ZSwodGhpcy5sZW5ndGg+MXx8Ti50ZXN0KGQpKSYmTS50ZXN0KGEpJiYoZT1lLnJldmVyc2UoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGUsYSxQLmNhbGwoYXJndW1lbnRzKS5qb2luKFwiLFwiKSl9fSksZi5leHRlbmQoe2ZpbHRlcjpmdW5jdGlvbihhLGIsYyl7YyYmKGE9XCI6bm90KFwiK2ErXCIpXCIpO3JldHVybiBiLmxlbmd0aD09PTE/Zi5maW5kLm1hdGNoZXNTZWxlY3RvcihiWzBdLGEpP1tiWzBdXTpbXTpmLmZpbmQubWF0Y2hlcyhhLGIpfSxkaXI6ZnVuY3Rpb24oYSxjLGQpe3ZhciBlPVtdLGc9YVtjXTt3aGlsZShnJiZnLm5vZGVUeXBlIT09OSYmKGQ9PT1ifHxnLm5vZGVUeXBlIT09MXx8IWYoZykuaXMoZCkpKWcubm9kZVR5cGU9PT0xJiZlLnB1c2goZyksZz1nW2NdO3JldHVybiBlfSxudGg6ZnVuY3Rpb24oYSxiLGMsZCl7Yj1ifHwxO3ZhciBlPTA7Zm9yKDthO2E9YVtjXSlpZihhLm5vZGVUeXBlPT09MSYmKytlPT09YilicmVhaztyZXR1cm4gYX0sc2libGluZzpmdW5jdGlvbihhLGIpe3ZhciBjPVtdO2Zvcig7YTthPWEubmV4dFNpYmxpbmcpYS5ub2RlVHlwZT09PTEmJmEhPT1iJiZjLnB1c2goYSk7cmV0dXJuIGN9fSk7dmFyIFY9XCJhYmJyfGFydGljbGV8YXNpZGV8YXVkaW98Y2FudmFzfGRhdGFsaXN0fGRldGFpbHN8ZmlnY2FwdGlvbnxmaWd1cmV8Zm9vdGVyfGhlYWRlcnxoZ3JvdXB8bWFya3xtZXRlcnxuYXZ8b3V0cHV0fHByb2dyZXNzfHNlY3Rpb258c3VtbWFyeXx0aW1lfHZpZGVvXCIsVz0vIGpRdWVyeVxcZCs9XCIoPzpcXGQrfG51bGwpXCIvZyxYPS9eXFxzKy8sWT0vPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXFx3Ol0rKVtePl0qKVxcLz4vaWcsWj0vPChbXFx3Ol0rKS8sJD0vPHRib2R5L2ksXz0vPHwmIz9cXHcrOy8sYmE9LzwoPzpzY3JpcHR8c3R5bGUpL2ksYmI9LzwoPzpzY3JpcHR8b2JqZWN0fGVtYmVkfG9wdGlvbnxzdHlsZSkvaSxiYz1uZXcgUmVnRXhwKFwiPCg/OlwiK1YrXCIpXCIsXCJpXCIpLGJkPS9jaGVja2VkXFxzKig/OltePV18PVxccyouY2hlY2tlZC4pL2ksYmU9L1xcLyhqYXZhfGVjbWEpc2NyaXB0L2ksYmY9L15cXHMqPCEoPzpcXFtDREFUQVxcW3xcXC1cXC0pLyxiZz17b3B0aW9uOlsxLFwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPlwiLFwiPC9zZWxlY3Q+XCJdLGxlZ2VuZDpbMSxcIjxmaWVsZHNldD5cIixcIjwvZmllbGRzZXQ+XCJdLHRoZWFkOlsxLFwiPHRhYmxlPlwiLFwiPC90YWJsZT5cIl0sdHI6WzIsXCI8dGFibGU+PHRib2R5PlwiLFwiPC90Ym9keT48L3RhYmxlPlwiXSx0ZDpbMyxcIjx0YWJsZT48dGJvZHk+PHRyPlwiLFwiPC90cj48L3Rib2R5PjwvdGFibGU+XCJdLGNvbDpbMixcIjx0YWJsZT48dGJvZHk+PC90Ym9keT48Y29sZ3JvdXA+XCIsXCI8L2NvbGdyb3VwPjwvdGFibGU+XCJdLGFyZWE6WzEsXCI8bWFwPlwiLFwiPC9tYXA+XCJdLF9kZWZhdWx0OlswLFwiXCIsXCJcIl19LGJoPVUoYyk7Ymcub3B0Z3JvdXA9Ymcub3B0aW9uLGJnLnRib2R5PWJnLnRmb290PWJnLmNvbGdyb3VwPWJnLmNhcHRpb249YmcudGhlYWQsYmcudGg9YmcudGQsZi5zdXBwb3J0Lmh0bWxTZXJpYWxpemV8fChiZy5fZGVmYXVsdD1bMSxcImRpdjxkaXY+XCIsXCI8L2Rpdj5cIl0pLGYuZm4uZXh0ZW5kKHt0ZXh0OmZ1bmN0aW9uKGEpe2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3ZhciBjPWYodGhpcyk7Yy50ZXh0KGEuY2FsbCh0aGlzLGIsYy50ZXh0KCkpKX0pO2lmKHR5cGVvZiBhIT1cIm9iamVjdFwiJiZhIT09YilyZXR1cm4gdGhpcy5lbXB0eSgpLmFwcGVuZCgodGhpc1swXSYmdGhpc1swXS5vd25lckRvY3VtZW50fHxjKS5jcmVhdGVUZXh0Tm9kZShhKSk7cmV0dXJuIGYudGV4dCh0aGlzKX0sd3JhcEFsbDpmdW5jdGlvbihhKXtpZihmLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihiKXtmKHRoaXMpLndyYXBBbGwoYS5jYWxsKHRoaXMsYikpfSk7aWYodGhpc1swXSl7dmFyIGI9ZihhLHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUoITApO3RoaXNbMF0ucGFyZW50Tm9kZSYmYi5pbnNlcnRCZWZvcmUodGhpc1swXSksYi5tYXAoZnVuY3Rpb24oKXt2YXIgYT10aGlzO3doaWxlKGEuZmlyc3RDaGlsZCYmYS5maXJzdENoaWxkLm5vZGVUeXBlPT09MSlhPWEuZmlyc3RDaGlsZDtyZXR1cm4gYX0pLmFwcGVuZCh0aGlzKX1yZXR1cm4gdGhpc30sd3JhcElubmVyOmZ1bmN0aW9uKGEpe2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe2YodGhpcykud3JhcElubmVyKGEuY2FsbCh0aGlzLGIpKX0pO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj1mKHRoaXMpLGM9Yi5jb250ZW50cygpO2MubGVuZ3RoP2Mud3JhcEFsbChhKTpiLmFwcGVuZChhKX0pfSx3cmFwOmZ1bmN0aW9uKGEpe3ZhciBiPWYuaXNGdW5jdGlvbihhKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe2YodGhpcykud3JhcEFsbChiP2EuY2FsbCh0aGlzLGMpOmEpfSl9LHVud3JhcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24oKXtmLm5vZGVOYW1lKHRoaXMsXCJib2R5XCIpfHxmKHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyl9KS5lbmQoKX0sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCEwLGZ1bmN0aW9uKGEpe3RoaXMubm9kZVR5cGU9PT0xJiZ0aGlzLmFwcGVuZENoaWxkKGEpfSl9LHByZXBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsITAsZnVuY3Rpb24oYSl7dGhpcy5ub2RlVHlwZT09PTEmJnRoaXMuaW5zZXJ0QmVmb3JlKGEsdGhpcy5maXJzdENoaWxkKX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtpZih0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGUpcmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCExLGZ1bmN0aW9uKGEpe3RoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSx0aGlzKX0pO2lmKGFyZ3VtZW50cy5sZW5ndGgpe3ZhciBhPWYuY2xlYW4oYXJndW1lbnRzKTthLnB1c2guYXBwbHkoYSx0aGlzLnRvQXJyYXkoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGEsXCJiZWZvcmVcIixhcmd1bWVudHMpfX0sYWZ0ZXI6ZnVuY3Rpb24oKXtpZih0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGUpcmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCExLGZ1bmN0aW9uKGEpe3RoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSx0aGlzLm5leHRTaWJsaW5nKX0pO2lmKGFyZ3VtZW50cy5sZW5ndGgpe3ZhciBhPXRoaXMucHVzaFN0YWNrKHRoaXMsXCJhZnRlclwiLGFyZ3VtZW50cyk7YS5wdXNoLmFwcGx5KGEsZi5jbGVhbihhcmd1bWVudHMpKTtyZXR1cm4gYX19LHJlbW92ZTpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ7KGQ9dGhpc1tjXSkhPW51bGw7YysrKWlmKCFhfHxmLmZpbHRlcihhLFtkXSkubGVuZ3RoKSFiJiZkLm5vZGVUeXBlPT09MSYmKGYuY2xlYW5EYXRhKGQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpKSxmLmNsZWFuRGF0YShbZF0pKSxkLnBhcmVudE5vZGUmJmQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkKTtyZXR1cm4gdGhpc30sZW1wdHk6ZnVuY3Rpb24oKVxue2Zvcih2YXIgYT0wLGI7KGI9dGhpc1thXSkhPW51bGw7YSsrKXtiLm5vZGVUeXBlPT09MSYmZi5jbGVhbkRhdGEoYi5nZXRFbGVtZW50c0J5VGFnTmFtZShcIipcIikpO3doaWxlKGIuZmlyc3RDaGlsZCliLnJlbW92ZUNoaWxkKGIuZmlyc3RDaGlsZCl9cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGEsYil7YT1hPT1udWxsPyExOmEsYj1iPT1udWxsP2E6YjtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gZi5jbG9uZSh0aGlzLGEsYil9KX0saHRtbDpmdW5jdGlvbihhKXtpZihhPT09YilyZXR1cm4gdGhpc1swXSYmdGhpc1swXS5ub2RlVHlwZT09PTE/dGhpc1swXS5pbm5lckhUTUwucmVwbGFjZShXLFwiXCIpOm51bGw7aWYodHlwZW9mIGE9PVwic3RyaW5nXCImJiFiYS50ZXN0KGEpJiYoZi5zdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlfHwhWC50ZXN0KGEpKSYmIWJnWyhaLmV4ZWMoYSl8fFtcIlwiLFwiXCJdKVsxXS50b0xvd2VyQ2FzZSgpXSl7YT1hLnJlcGxhY2UoWSxcIjwkMT48LyQyPlwiKTt0cnl7Zm9yKHZhciBjPTAsZD10aGlzLmxlbmd0aDtjPGQ7YysrKXRoaXNbY10ubm9kZVR5cGU9PT0xJiYoZi5jbGVhbkRhdGEodGhpc1tjXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIipcIikpLHRoaXNbY10uaW5uZXJIVE1MPWEpfWNhdGNoKGUpe3RoaXMuZW1wdHkoKS5hcHBlbmQoYSl9fWVsc2UgZi5pc0Z1bmN0aW9uKGEpP3RoaXMuZWFjaChmdW5jdGlvbihiKXt2YXIgYz1mKHRoaXMpO2MuaHRtbChhLmNhbGwodGhpcyxiLGMuaHRtbCgpKSl9KTp0aGlzLmVtcHR5KCkuYXBwZW5kKGEpO3JldHVybiB0aGlzfSxyZXBsYWNlV2l0aDpmdW5jdGlvbihhKXtpZih0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGUpe2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3ZhciBjPWYodGhpcyksZD1jLmh0bWwoKTtjLnJlcGxhY2VXaXRoKGEuY2FsbCh0aGlzLGIsZCkpfSk7dHlwZW9mIGEhPVwic3RyaW5nXCImJihhPWYoYSkuZGV0YWNoKCkpO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj10aGlzLm5leHRTaWJsaW5nLGM9dGhpcy5wYXJlbnROb2RlO2YodGhpcykucmVtb3ZlKCksYj9mKGIpLmJlZm9yZShhKTpmKGMpLmFwcGVuZChhKX0pfXJldHVybiB0aGlzLmxlbmd0aD90aGlzLnB1c2hTdGFjayhmKGYuaXNGdW5jdGlvbihhKT9hKCk6YSksXCJyZXBsYWNlV2l0aFwiLGEpOnRoaXN9LGRldGFjaDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5yZW1vdmUoYSwhMCl9LGRvbU1hbmlwOmZ1bmN0aW9uKGEsYyxkKXt2YXIgZSxnLGgsaSxqPWFbMF0saz1bXTtpZighZi5zdXBwb3J0LmNoZWNrQ2xvbmUmJmFyZ3VtZW50cy5sZW5ndGg9PT0zJiZ0eXBlb2Ygaj09XCJzdHJpbmdcIiYmYmQudGVzdChqKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Zih0aGlzKS5kb21NYW5pcChhLGMsZCwhMCl9KTtpZihmLmlzRnVuY3Rpb24oaikpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihlKXt2YXIgZz1mKHRoaXMpO2FbMF09ai5jYWxsKHRoaXMsZSxjP2cuaHRtbCgpOmIpLGcuZG9tTWFuaXAoYSxjLGQpfSk7aWYodGhpc1swXSl7aT1qJiZqLnBhcmVudE5vZGUsZi5zdXBwb3J0LnBhcmVudE5vZGUmJmkmJmkubm9kZVR5cGU9PT0xMSYmaS5jaGlsZE5vZGVzLmxlbmd0aD09PXRoaXMubGVuZ3RoP2U9e2ZyYWdtZW50Oml9OmU9Zi5idWlsZEZyYWdtZW50KGEsdGhpcyxrKSxoPWUuZnJhZ21lbnQsaC5jaGlsZE5vZGVzLmxlbmd0aD09PTE/Zz1oPWguZmlyc3RDaGlsZDpnPWguZmlyc3RDaGlsZDtpZihnKXtjPWMmJmYubm9kZU5hbWUoZyxcInRyXCIpO2Zvcih2YXIgbD0wLG09dGhpcy5sZW5ndGgsbj1tLTE7bDxtO2wrKylkLmNhbGwoYz9iaSh0aGlzW2xdLGcpOnRoaXNbbF0sZS5jYWNoZWFibGV8fG0+MSYmbDxuP2YuY2xvbmUoaCwhMCwhMCk6aCl9ay5sZW5ndGgmJmYuZWFjaChrLGJwKX1yZXR1cm4gdGhpc319KSxmLmJ1aWxkRnJhZ21lbnQ9ZnVuY3Rpb24oYSxiLGQpe3ZhciBlLGcsaCxpLGo9YVswXTtiJiZiWzBdJiYoaT1iWzBdLm93bmVyRG9jdW1lbnR8fGJbMF0pLGkuY3JlYXRlRG9jdW1lbnRGcmFnbWVudHx8KGk9YyksYS5sZW5ndGg9PT0xJiZ0eXBlb2Ygaj09XCJzdHJpbmdcIiYmai5sZW5ndGg8NTEyJiZpPT09YyYmai5jaGFyQXQoMCk9PT1cIjxcIiYmIWJiLnRlc3QoaikmJihmLnN1cHBvcnQuY2hlY2tDbG9uZXx8IWJkLnRlc3QoaikpJiYoZi5zdXBwb3J0Lmh0bWw1Q2xvbmV8fCFiYy50ZXN0KGopKSYmKGc9ITAsaD1mLmZyYWdtZW50c1tqXSxoJiZoIT09MSYmKGU9aCkpLGV8fChlPWkuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLGYuY2xlYW4oYSxpLGUsZCkpLGcmJihmLmZyYWdtZW50c1tqXT1oP2U6MSk7cmV0dXJue2ZyYWdtZW50OmUsY2FjaGVhYmxlOmd9fSxmLmZyYWdtZW50cz17fSxmLmVhY2goe2FwcGVuZFRvOlwiYXBwZW5kXCIscHJlcGVuZFRvOlwicHJlcGVuZFwiLGluc2VydEJlZm9yZTpcImJlZm9yZVwiLGluc2VydEFmdGVyOlwiYWZ0ZXJcIixyZXBsYWNlQWxsOlwicmVwbGFjZVdpdGhcIn0sZnVuY3Rpb24oYSxiKXtmLmZuW2FdPWZ1bmN0aW9uKGMpe3ZhciBkPVtdLGU9ZihjKSxnPXRoaXMubGVuZ3RoPT09MSYmdGhpc1swXS5wYXJlbnROb2RlO2lmKGcmJmcubm9kZVR5cGU9PT0xMSYmZy5jaGlsZE5vZGVzLmxlbmd0aD09PTEmJmUubGVuZ3RoPT09MSl7ZVtiXSh0aGlzWzBdKTtyZXR1cm4gdGhpc31mb3IodmFyIGg9MCxpPWUubGVuZ3RoO2g8aTtoKyspe3ZhciBqPShoPjA/dGhpcy5jbG9uZSghMCk6dGhpcykuZ2V0KCk7ZihlW2hdKVtiXShqKSxkPWQuY29uY2F0KGopfXJldHVybiB0aGlzLnB1c2hTdGFjayhkLGEsZS5zZWxlY3Rvcil9fSksZi5leHRlbmQoe2Nsb25lOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGcsaD1mLnN1cHBvcnQuaHRtbDVDbG9uZXx8IWJjLnRlc3QoXCI8XCIrYS5ub2RlTmFtZSk/YS5jbG9uZU5vZGUoITApOmJvKGEpO2lmKCghZi5zdXBwb3J0Lm5vQ2xvbmVFdmVudHx8IWYuc3VwcG9ydC5ub0Nsb25lQ2hlY2tlZCkmJihhLm5vZGVUeXBlPT09MXx8YS5ub2RlVHlwZT09PTExKSYmIWYuaXNYTUxEb2MoYSkpe2JrKGEsaCksZD1ibChhKSxlPWJsKGgpO2ZvcihnPTA7ZFtnXTsrK2cpZVtnXSYmYmsoZFtnXSxlW2ddKX1pZihiKXtiaihhLGgpO2lmKGMpe2Q9YmwoYSksZT1ibChoKTtmb3IoZz0wO2RbZ107KytnKWJqKGRbZ10sZVtnXSl9fWQ9ZT1udWxsO3JldHVybiBofSxjbGVhbjpmdW5jdGlvbihhLGIsZCxlKXt2YXIgZztiPWJ8fGMsdHlwZW9mIGIuY3JlYXRlRWxlbWVudD09XCJ1bmRlZmluZWRcIiYmKGI9Yi5vd25lckRvY3VtZW50fHxiWzBdJiZiWzBdLm93bmVyRG9jdW1lbnR8fGMpO3ZhciBoPVtdLGk7Zm9yKHZhciBqPTAsazsoaz1hW2pdKSE9bnVsbDtqKyspe3R5cGVvZiBrPT1cIm51bWJlclwiJiYoays9XCJcIik7aWYoIWspY29udGludWU7aWYodHlwZW9mIGs9PVwic3RyaW5nXCIpaWYoIV8udGVzdChrKSlrPWIuY3JlYXRlVGV4dE5vZGUoayk7ZWxzZXtrPWsucmVwbGFjZShZLFwiPCQxPjwvJDI+XCIpO3ZhciBsPShaLmV4ZWMoayl8fFtcIlwiLFwiXCJdKVsxXS50b0xvd2VyQ2FzZSgpLG09YmdbbF18fGJnLl9kZWZhdWx0LG49bVswXSxvPWIuY3JlYXRlRWxlbWVudChcImRpdlwiKTtiPT09Yz9iaC5hcHBlbmRDaGlsZChvKTpVKGIpLmFwcGVuZENoaWxkKG8pLG8uaW5uZXJIVE1MPW1bMV0rayttWzJdO3doaWxlKG4tLSlvPW8ubGFzdENoaWxkO2lmKCFmLnN1cHBvcnQudGJvZHkpe3ZhciBwPSQudGVzdChrKSxxPWw9PT1cInRhYmxlXCImJiFwP28uZmlyc3RDaGlsZCYmby5maXJzdENoaWxkLmNoaWxkTm9kZXM6bVsxXT09PVwiPHRhYmxlPlwiJiYhcD9vLmNoaWxkTm9kZXM6W107Zm9yKGk9cS5sZW5ndGgtMTtpPj0wOy0taSlmLm5vZGVOYW1lKHFbaV0sXCJ0Ym9keVwiKSYmIXFbaV0uY2hpbGROb2Rlcy5sZW5ndGgmJnFbaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChxW2ldKX0hZi5zdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlJiZYLnRlc3QoaykmJm8uaW5zZXJ0QmVmb3JlKGIuY3JlYXRlVGV4dE5vZGUoWC5leGVjKGspWzBdKSxvLmZpcnN0Q2hpbGQpLGs9by5jaGlsZE5vZGVzfXZhciByO2lmKCFmLnN1cHBvcnQuYXBwZW5kQ2hlY2tlZClpZihrWzBdJiZ0eXBlb2YgKHI9ay5sZW5ndGgpPT1cIm51bWJlclwiKWZvcihpPTA7aTxyO2krKylibihrW2ldKTtlbHNlIGJuKGspO2subm9kZVR5cGU/aC5wdXNoKGspOmg9Zi5tZXJnZShoLGspfWlmKGQpe2c9ZnVuY3Rpb24oYSl7cmV0dXJuIWEudHlwZXx8YmUudGVzdChhLnR5cGUpfTtmb3Ioaj0wO2hbal07aisrKWlmKGUmJmYubm9kZU5hbWUoaFtqXSxcInNjcmlwdFwiKSYmKCFoW2pdLnR5cGV8fGhbal0udHlwZS50b0xvd2VyQ2FzZSgpPT09XCJ0ZXh0L2phdmFzY3JpcHRcIikpZS5wdXNoKGhbal0ucGFyZW50Tm9kZT9oW2pdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaFtqXSk6aFtqXSk7ZWxzZXtpZihoW2pdLm5vZGVUeXBlPT09MSl7dmFyIHM9Zi5ncmVwKGhbal0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIiksZyk7aC5zcGxpY2UuYXBwbHkoaCxbaisxLDBdLmNvbmNhdChzKSl9ZC5hcHBlbmRDaGlsZChoW2pdKX19cmV0dXJuIGh9LGNsZWFuRGF0YTpmdW5jdGlvbihhKXt2YXIgYixjLGQ9Zi5jYWNoZSxlPWYuZXZlbnQuc3BlY2lhbCxnPWYuc3VwcG9ydC5kZWxldGVFeHBhbmRvO2Zvcih2YXIgaD0wLGk7KGk9YVtoXSkhPW51bGw7aCsrKXtpZihpLm5vZGVOYW1lJiZmLm5vRGF0YVtpLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKWNvbnRpbnVlO2M9aVtmLmV4cGFuZG9dO2lmKGMpe2I9ZFtjXTtpZihiJiZiLmV2ZW50cyl7Zm9yKHZhciBqIGluIGIuZXZlbnRzKWVbal0/Zi5ldmVudC5yZW1vdmUoaSxqKTpmLnJlbW92ZUV2ZW50KGksaixiLmhhbmRsZSk7Yi5oYW5kbGUmJihiLmhhbmRsZS5lbGVtPW51bGwpfWc/ZGVsZXRlIGlbZi5leHBhbmRvXTppLnJlbW92ZUF0dHJpYnV0ZSYmaS5yZW1vdmVBdHRyaWJ1dGUoZi5leHBhbmRvKSxkZWxldGUgZFtjXX19fX0pO3ZhciBicT0vYWxwaGFcXChbXildKlxcKS9pLGJyPS9vcGFjaXR5PShbXildKikvLGJzPS8oW0EtWl18Xm1zKS9nLGJ0PS9eLT9cXGQrKD86cHgpPyQvaSxidT0vXi0/XFxkLyxidj0vXihbXFwtK10pPShbXFwtKy5cXGRlXSspLyxidz17cG9zaXRpb246XCJhYnNvbHV0ZVwiLHZpc2liaWxpdHk6XCJoaWRkZW5cIixkaXNwbGF5OlwiYmxvY2tcIn0sYng9W1wiTGVmdFwiLFwiUmlnaHRcIl0sYnk9W1wiVG9wXCIsXCJCb3R0b21cIl0sYnosYkEsYkI7Zi5mbi5jc3M9ZnVuY3Rpb24oYSxjKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MiYmYz09PWIpcmV0dXJuIHRoaXM7cmV0dXJuIGYuYWNjZXNzKHRoaXMsYSxjLCEwLGZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gZCE9PWI/Zi5zdHlsZShhLGMsZCk6Zi5jc3MoYSxjKX0pfSxmLmV4dGVuZCh7Y3NzSG9va3M6e29wYWNpdHk6e2dldDpmdW5jdGlvbihhLGIpe2lmKGIpe3ZhciBjPWJ6KGEsXCJvcGFjaXR5XCIsXCJvcGFjaXR5XCIpO3JldHVybiBjPT09XCJcIj9cIjFcIjpjfXJldHVybiBhLnN0eWxlLm9wYWNpdHl9fX0sY3NzTnVtYmVyOntmaWxsT3BhY2l0eTohMCxmb250V2VpZ2h0OiEwLGxpbmVIZWlnaHQ6ITAsb3BhY2l0eTohMCxvcnBoYW5zOiEwLHdpZG93czohMCx6SW5kZXg6ITAsem9vbTohMH0sY3NzUHJvcHM6e1wiZmxvYXRcIjpmLnN1cHBvcnQuY3NzRmxvYXQ/XCJjc3NGbG9hdFwiOlwic3R5bGVGbG9hdFwifSxzdHlsZTpmdW5jdGlvbihhLGMsZCxlKXtpZighIWEmJmEubm9kZVR5cGUhPT0zJiZhLm5vZGVUeXBlIT09OCYmISFhLnN0eWxlKXt2YXIgZyxoLGk9Zi5jYW1lbENhc2UoYyksaj1hLnN0eWxlLGs9Zi5jc3NIb29rc1tpXTtjPWYuY3NzUHJvcHNbaV18fGk7aWYoZD09PWIpe2lmKGsmJlwiZ2V0XCJpbiBrJiYoZz1rLmdldChhLCExLGUpKSE9PWIpcmV0dXJuIGc7cmV0dXJuIGpbY119aD10eXBlb2YgZCxoPT09XCJzdHJpbmdcIiYmKGc9YnYuZXhlYyhkKSkmJihkPSsoZ1sxXSsxKSorZ1syXStwYXJzZUZsb2F0KGYuY3NzKGEsYykpLGg9XCJudW1iZXJcIik7aWYoZD09bnVsbHx8aD09PVwibnVtYmVyXCImJmlzTmFOKGQpKXJldHVybjtoPT09XCJudW1iZXJcIiYmIWYuY3NzTnVtYmVyW2ldJiYoZCs9XCJweFwiKTtpZigha3x8IShcInNldFwiaW4gayl8fChkPWsuc2V0KGEsZCkpIT09Yil0cnl7altjXT1kfWNhdGNoKGwpe319fSxjc3M6ZnVuY3Rpb24oYSxjLGQpe3ZhciBlLGc7Yz1mLmNhbWVsQ2FzZShjKSxnPWYuY3NzSG9va3NbY10sYz1mLmNzc1Byb3BzW2NdfHxjLGM9PT1cImNzc0Zsb2F0XCImJihjPVwiZmxvYXRcIik7aWYoZyYmXCJnZXRcImluIGcmJihlPWcuZ2V0KGEsITAsZCkpIT09YilyZXR1cm4gZTtpZihieilyZXR1cm4gYnooYSxjKX0sc3dhcDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9e307Zm9yKHZhciBlIGluIGIpZFtlXT1hLnN0eWxlW2VdLGEuc3R5bGVbZV09YltlXTtjLmNhbGwoYSk7Zm9yKGUgaW4gYilhLnN0eWxlW2VdPWRbZV19fSksZi5jdXJDU1M9Zi5jc3MsZi5lYWNoKFtcImhlaWdodFwiLFwid2lkdGhcIl0sZnVuY3Rpb24oYSxiKXtmLmNzc0hvb2tzW2JdPXtnZXQ6ZnVuY3Rpb24oYSxjLGQpe3ZhciBlO2lmKGMpe2lmKGEub2Zmc2V0V2lkdGghPT0wKXJldHVybiBiQyhhLGIsZCk7Zi5zd2FwKGEsYncsZnVuY3Rpb24oKXtlPWJDKGEsYixkKX0pO3JldHVybiBlfX0sc2V0OmZ1bmN0aW9uKGEsYil7aWYoIWJ0LnRlc3QoYikpcmV0dXJuIGI7Yj1wYXJzZUZsb2F0KGIpO2lmKGI+PTApcmV0dXJuIGIrXCJweFwifX19KSxmLnN1cHBvcnQub3BhY2l0eXx8KGYuY3NzSG9va3Mub3BhY2l0eT17Z2V0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIGJyLnRlc3QoKGImJmEuY3VycmVudFN0eWxlP2EuY3VycmVudFN0eWxlLmZpbHRlcjphLnN0eWxlLmZpbHRlcil8fFwiXCIpP3BhcnNlRmxvYXQoUmVnRXhwLiQxKS8xMDArXCJcIjpiP1wiMVwiOlwiXCJ9LHNldDpmdW5jdGlvbihhLGIpe3ZhciBjPWEuc3R5bGUsZD1hLmN1cnJlbnRTdHlsZSxlPWYuaXNOdW1lcmljKGIpP1wiYWxwaGEob3BhY2l0eT1cIitiKjEwMCtcIilcIjpcIlwiLGc9ZCYmZC5maWx0ZXJ8fGMuZmlsdGVyfHxcIlwiO2Muem9vbT0xO2lmKGI+PTEmJmYudHJpbShnLnJlcGxhY2UoYnEsXCJcIikpPT09XCJcIil7Yy5yZW1vdmVBdHRyaWJ1dGUoXCJmaWx0ZXJcIik7aWYoZCYmIWQuZmlsdGVyKXJldHVybn1jLmZpbHRlcj1icS50ZXN0KGcpP2cucmVwbGFjZShicSxlKTpnK1wiIFwiK2V9fSksZihmdW5jdGlvbigpe2Yuc3VwcG9ydC5yZWxpYWJsZU1hcmdpblJpZ2h0fHwoZi5jc3NIb29rcy5tYXJnaW5SaWdodD17Z2V0OmZ1bmN0aW9uKGEsYil7dmFyIGM7Zi5zd2FwKGEse2Rpc3BsYXk6XCJpbmxpbmUtYmxvY2tcIn0sZnVuY3Rpb24oKXtiP2M9YnooYSxcIm1hcmdpbi1yaWdodFwiLFwibWFyZ2luUmlnaHRcIik6Yz1hLnN0eWxlLm1hcmdpblJpZ2h0fSk7cmV0dXJuIGN9fSl9KSxjLmRlZmF1bHRWaWV3JiZjLmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUmJihiQT1mdW5jdGlvbihhLGIpe3ZhciBjLGQsZTtiPWIucmVwbGFjZShicyxcIi0kMVwiKS50b0xvd2VyQ2FzZSgpLChkPWEub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldykmJihlPWQuZ2V0Q29tcHV0ZWRTdHlsZShhLG51bGwpKSYmKGM9ZS5nZXRQcm9wZXJ0eVZhbHVlKGIpLGM9PT1cIlwiJiYhZi5jb250YWlucyhhLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGEpJiYoYz1mLnN0eWxlKGEsYikpKTtyZXR1cm4gY30pLGMuZG9jdW1lbnRFbGVtZW50LmN1cnJlbnRTdHlsZSYmKGJCPWZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9YS5jdXJyZW50U3R5bGUmJmEuY3VycmVudFN0eWxlW2JdLGc9YS5zdHlsZTtmPT09bnVsbCYmZyYmKGU9Z1tiXSkmJihmPWUpLCFidC50ZXN0KGYpJiZidS50ZXN0KGYpJiYoYz1nLmxlZnQsZD1hLnJ1bnRpbWVTdHlsZSYmYS5ydW50aW1lU3R5bGUubGVmdCxkJiYoYS5ydW50aW1lU3R5bGUubGVmdD1hLmN1cnJlbnRTdHlsZS5sZWZ0KSxnLmxlZnQ9Yj09PVwiZm9udFNpemVcIj9cIjFlbVwiOmZ8fDAsZj1nLnBpeGVsTGVmdCtcInB4XCIsZy5sZWZ0PWMsZCYmKGEucnVudGltZVN0eWxlLmxlZnQ9ZCkpO3JldHVybiBmPT09XCJcIj9cImF1dG9cIjpmfSksYno9YkF8fGJCLGYuZXhwciYmZi5leHByLmZpbHRlcnMmJihmLmV4cHIuZmlsdGVycy5oaWRkZW49ZnVuY3Rpb24oYSl7dmFyIGI9YS5vZmZzZXRXaWR0aCxjPWEub2Zmc2V0SGVpZ2h0O3JldHVybiBiPT09MCYmYz09PTB8fCFmLnN1cHBvcnQucmVsaWFibGVIaWRkZW5PZmZzZXRzJiYoYS5zdHlsZSYmYS5zdHlsZS5kaXNwbGF5fHxmLmNzcyhhLFwiZGlzcGxheVwiKSk9PT1cIm5vbmVcIn0sZi5leHByLmZpbHRlcnMudmlzaWJsZT1mdW5jdGlvbihhKXtyZXR1cm4hZi5leHByLmZpbHRlcnMuaGlkZGVuKGEpfSk7dmFyIGJEPS8lMjAvZyxiRT0vXFxbXFxdJC8sYkY9L1xccj9cXG4vZyxiRz0vIy4qJC8sYkg9L14oLio/KTpbIFxcdF0qKFteXFxyXFxuXSopXFxyPyQvbWcsYkk9L14oPzpjb2xvcnxkYXRlfGRhdGV0aW1lfGRhdGV0aW1lLWxvY2FsfGVtYWlsfGhpZGRlbnxtb250aHxudW1iZXJ8cGFzc3dvcmR8cmFuZ2V8c2VhcmNofHRlbHx0ZXh0fHRpbWV8dXJsfHdlZWspJC9pLGJKPS9eKD86YWJvdXR8YXBwfGFwcFxcLXN0b3JhZ2V8LitcXC1leHRlbnNpb258ZmlsZXxyZXN8d2lkZ2V0KTokLyxiSz0vXig/OkdFVHxIRUFEKSQvLGJMPS9eXFwvXFwvLyxiTT0vXFw/LyxiTj0vPHNjcmlwdFxcYltePF0qKD86KD8hPFxcL3NjcmlwdD4pPFtePF0qKSo8XFwvc2NyaXB0Pi9naSxiTz0vXig/OnNlbGVjdHx0ZXh0YXJlYSkvaSxiUD0vXFxzKy8sYlE9LyhbPyZdKV89W14mXSovLGJSPS9eKFtcXHdcXCtcXC5cXC1dKzopKD86XFwvXFwvKFteXFwvPyM6XSopKD86OihcXGQrKSk/KT8vLGJTPWYuZm4ubG9hZCxiVD17fSxiVT17fSxiVixiVyxiWD1bXCIqL1wiXStbXCIqXCJdO3RyeXtiVj1lLmhyZWZ9Y2F0Y2goYlkpe2JWPWMuY3JlYXRlRWxlbWVudChcImFcIiksYlYuaHJlZj1cIlwiLGJWPWJWLmhyZWZ9Ylc9YlIuZXhlYyhiVi50b0xvd2VyQ2FzZSgpKXx8W10sZi5mbi5leHRlbmQoe2xvYWQ6ZnVuY3Rpb24oYSxjLGQpe2lmKHR5cGVvZiBhIT1cInN0cmluZ1wiJiZiUylyZXR1cm4gYlMuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKCF0aGlzLmxlbmd0aClyZXR1cm4gdGhpczt2YXIgZT1hLmluZGV4T2YoXCIgXCIpO2lmKGU+PTApe3ZhciBnPWEuc2xpY2UoZSxhLmxlbmd0aCk7YT1hLnNsaWNlKDAsZSl9dmFyIGg9XCJHRVRcIjtjJiYoZi5pc0Z1bmN0aW9uKGMpPyhkPWMsYz1iKTp0eXBlb2YgYz09XCJvYmplY3RcIiYmKGM9Zi5wYXJhbShjLGYuYWpheFNldHRpbmdzLnRyYWRpdGlvbmFsKSxoPVwiUE9TVFwiKSk7dmFyIGk9dGhpcztmLmFqYXgoe3VybDphLHR5cGU6aCxkYXRhVHlwZTpcImh0bWxcIixkYXRhOmMsY29tcGxldGU6ZnVuY3Rpb24oYSxiLGMpe2M9YS5yZXNwb25zZVRleHQsYS5pc1Jlc29sdmVkKCkmJihhLmRvbmUoZnVuY3Rpb24oYSl7Yz1hfSksaS5odG1sKGc/ZihcIjxkaXY+XCIpLmFwcGVuZChjLnJlcGxhY2UoYk4sXCJcIikpLmZpbmQoZyk6YykpLGQmJmkuZWFjaChkLFtjLGIsYV0pfX0pO3JldHVybiB0aGlzfSxzZXJpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gZi5wYXJhbSh0aGlzLnNlcmlhbGl6ZUFycmF5KCkpfSxzZXJpYWxpemVBcnJheTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3JldHVybiB0aGlzLmVsZW1lbnRzP2YubWFrZUFycmF5KHRoaXMuZWxlbWVudHMpOnRoaXN9KS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uYW1lJiYhdGhpcy5kaXNhYmxlZCYmKHRoaXMuY2hlY2tlZHx8Yk8udGVzdCh0aGlzLm5vZGVOYW1lKXx8YkkudGVzdCh0aGlzLnR5cGUpKX0pLm1hcChmdW5jdGlvbihhLGIpe3ZhciBjPWYodGhpcykudmFsKCk7cmV0dXJuIGM9PW51bGw/bnVsbDpmLmlzQXJyYXkoYyk/Zi5tYXAoYyxmdW5jdGlvbihhLGMpe3JldHVybntuYW1lOmIubmFtZSx2YWx1ZTphLnJlcGxhY2UoYkYsXCJcXHJcXG5cIil9fSk6e25hbWU6Yi5uYW1lLHZhbHVlOmMucmVwbGFjZShiRixcIlxcclxcblwiKX19KS5nZXQoKX19KSxmLmVhY2goXCJhamF4U3RhcnQgYWpheFN0b3AgYWpheENvbXBsZXRlIGFqYXhFcnJvciBhamF4U3VjY2VzcyBhamF4U2VuZFwiLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhLGIpe2YuZm5bYl09ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMub24oYixhKX19KSxmLmVhY2goW1wiZ2V0XCIsXCJwb3N0XCJdLGZ1bmN0aW9uKGEsYyl7ZltjXT1mdW5jdGlvbihhLGQsZSxnKXtmLmlzRnVuY3Rpb24oZCkmJihnPWd8fGUsZT1kLGQ9Yik7cmV0dXJuIGYuYWpheCh7dHlwZTpjLHVybDphLGRhdGE6ZCxzdWNjZXNzOmUsZGF0YVR5cGU6Z30pfX0pLGYuZXh0ZW5kKHtnZXRTY3JpcHQ6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gZi5nZXQoYSxiLGMsXCJzY3JpcHRcIil9LGdldEpTT046ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmLmdldChhLGIsYyxcImpzb25cIil9LGFqYXhTZXR1cDpmdW5jdGlvbihhLGIpe2I/Yl8oYSxmLmFqYXhTZXR0aW5ncyk6KGI9YSxhPWYuYWpheFNldHRpbmdzKSxiXyhhLGIpO3JldHVybiBhfSxhamF4U2V0dGluZ3M6e3VybDpiVixpc0xvY2FsOmJKLnRlc3QoYldbMV0pLGdsb2JhbDohMCx0eXBlOlwiR0VUXCIsY29udGVudFR5cGU6XCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixwcm9jZXNzRGF0YTohMCxhc3luYzohMCxhY2NlcHRzOnt4bWw6XCJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sXCIsaHRtbDpcInRleHQvaHRtbFwiLHRleHQ6XCJ0ZXh0L3BsYWluXCIsanNvbjpcImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdFwiLFwiKlwiOmJYfSxjb250ZW50czp7eG1sOi94bWwvLGh0bWw6L2h0bWwvLGpzb246L2pzb24vfSxyZXNwb25zZUZpZWxkczp7eG1sOlwicmVzcG9uc2VYTUxcIix0ZXh0OlwicmVzcG9uc2VUZXh0XCJ9LGNvbnZlcnRlcnM6e1wiKiB0ZXh0XCI6YS5TdHJpbmcsXCJ0ZXh0IGh0bWxcIjohMCxcInRleHQganNvblwiOmYucGFyc2VKU09OLFwidGV4dCB4bWxcIjpmLnBhcnNlWE1MfSxmbGF0T3B0aW9uczp7Y29udGV4dDohMCx1cmw6ITB9fSxhamF4UHJlZmlsdGVyOmJaKGJUKSxhamF4VHJhbnNwb3J0OmJaKGJVKSxhamF4OmZ1bmN0aW9uKGEsYyl7ZnVuY3Rpb24gdyhhLGMsbCxtKXtpZihzIT09Mil7cz0yLHEmJmNsZWFyVGltZW91dChxKSxwPWIsbj1tfHxcIlwiLHYucmVhZHlTdGF0ZT1hPjA/NDowO3ZhciBvLHIsdSx3PWMseD1sP2NiKGQsdixsKTpiLHksejtpZihhPj0yMDAmJmE8MzAwfHxhPT09MzA0KXtpZihkLmlmTW9kaWZpZWQpe2lmKHk9di5nZXRSZXNwb25zZUhlYWRlcihcIkxhc3QtTW9kaWZpZWRcIikpZi5sYXN0TW9kaWZpZWRba109eTtpZih6PXYuZ2V0UmVzcG9uc2VIZWFkZXIoXCJFdGFnXCIpKWYuZXRhZ1trXT16fWlmKGE9PT0zMDQpdz1cIm5vdG1vZGlmaWVkXCIsbz0hMDtlbHNlIHRyeXtyPWNjKGQseCksdz1cInN1Y2Nlc3NcIixvPSEwfWNhdGNoKEEpe3c9XCJwYXJzZXJlcnJvclwiLHU9QX19ZWxzZXt1PXc7aWYoIXd8fGEpdz1cImVycm9yXCIsYTwwJiYoYT0wKX12LnN0YXR1cz1hLHYuc3RhdHVzVGV4dD1cIlwiKyhjfHx3KSxvP2gucmVzb2x2ZVdpdGgoZSxbcix3LHZdKTpoLnJlamVjdFdpdGgoZSxbdix3LHVdKSx2LnN0YXR1c0NvZGUoaiksaj1iLHQmJmcudHJpZ2dlcihcImFqYXhcIisobz9cIlN1Y2Nlc3NcIjpcIkVycm9yXCIpLFt2LGQsbz9yOnVdKSxpLmZpcmVXaXRoKGUsW3Ysd10pLHQmJihnLnRyaWdnZXIoXCJhamF4Q29tcGxldGVcIixbdixkXSksLS1mLmFjdGl2ZXx8Zi5ldmVudC50cmlnZ2VyKFwiYWpheFN0b3BcIikpfX10eXBlb2YgYT09XCJvYmplY3RcIiYmKGM9YSxhPWIpLGM9Y3x8e307dmFyIGQ9Zi5hamF4U2V0dXAoe30sYyksZT1kLmNvbnRleHR8fGQsZz1lIT09ZCYmKGUubm9kZVR5cGV8fGUgaW5zdGFuY2VvZiBmKT9mKGUpOmYuZXZlbnQsaD1mLkRlZmVycmVkKCksaT1mLkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLGo9ZC5zdGF0dXNDb2RlfHx7fSxrLGw9e30sbT17fSxuLG8scCxxLHIscz0wLHQsdSx2PXtyZWFkeVN0YXRlOjAsc2V0UmVxdWVzdEhlYWRlcjpmdW5jdGlvbihhLGIpe2lmKCFzKXt2YXIgYz1hLnRvTG93ZXJDYXNlKCk7YT1tW2NdPW1bY118fGEsbFthXT1ifXJldHVybiB0aGlzfSxnZXRBbGxSZXNwb25zZUhlYWRlcnM6ZnVuY3Rpb24oKXtyZXR1cm4gcz09PTI/bjpudWxsfSxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbihhKXt2YXIgYztpZihzPT09Mil7aWYoIW8pe289e307d2hpbGUoYz1iSC5leGVjKG4pKW9bY1sxXS50b0xvd2VyQ2FzZSgpXT1jWzJdfWM9b1thLnRvTG93ZXJDYXNlKCldfXJldHVybiBjPT09Yj9udWxsOmN9LG92ZXJyaWRlTWltZVR5cGU6ZnVuY3Rpb24oYSl7c3x8KGQubWltZVR5cGU9YSk7cmV0dXJuIHRoaXN9LGFib3J0OmZ1bmN0aW9uKGEpe2E9YXx8XCJhYm9ydFwiLHAmJnAuYWJvcnQoYSksdygwLGEpO3JldHVybiB0aGlzfX07aC5wcm9taXNlKHYpLHYuc3VjY2Vzcz12LmRvbmUsdi5lcnJvcj12LmZhaWwsdi5jb21wbGV0ZT1pLmFkZCx2LnN0YXR1c0NvZGU9ZnVuY3Rpb24oYSl7aWYoYSl7dmFyIGI7aWYoczwyKWZvcihiIGluIGEpaltiXT1baltiXSxhW2JdXTtlbHNlIGI9YVt2LnN0YXR1c10sdi50aGVuKGIsYil9cmV0dXJuIHRoaXN9LGQudXJsPSgoYXx8ZC51cmwpK1wiXCIpLnJlcGxhY2UoYkcsXCJcIikucmVwbGFjZShiTCxiV1sxXStcIi8vXCIpLGQuZGF0YVR5cGVzPWYudHJpbShkLmRhdGFUeXBlfHxcIipcIikudG9Mb3dlckNhc2UoKS5zcGxpdChiUCksZC5jcm9zc0RvbWFpbj09bnVsbCYmKHI9YlIuZXhlYyhkLnVybC50b0xvd2VyQ2FzZSgpKSxkLmNyb3NzRG9tYWluPSEoIXJ8fHJbMV09PWJXWzFdJiZyWzJdPT1iV1syXSYmKHJbM118fChyWzFdPT09XCJodHRwOlwiPzgwOjQ0MykpPT0oYldbM118fChiV1sxXT09PVwiaHR0cDpcIj84MDo0NDMpKSkpLGQuZGF0YSYmZC5wcm9jZXNzRGF0YSYmdHlwZW9mIGQuZGF0YSE9XCJzdHJpbmdcIiYmKGQuZGF0YT1mLnBhcmFtKGQuZGF0YSxkLnRyYWRpdGlvbmFsKSksYiQoYlQsZCxjLHYpO2lmKHM9PT0yKXJldHVybiExO3Q9ZC5nbG9iYWwsZC50eXBlPWQudHlwZS50b1VwcGVyQ2FzZSgpLGQuaGFzQ29udGVudD0hYksudGVzdChkLnR5cGUpLHQmJmYuYWN0aXZlKys9PT0wJiZmLmV2ZW50LnRyaWdnZXIoXCJhamF4U3RhcnRcIik7aWYoIWQuaGFzQ29udGVudCl7ZC5kYXRhJiYoZC51cmwrPShiTS50ZXN0KGQudXJsKT9cIiZcIjpcIj9cIikrZC5kYXRhLGRlbGV0ZSBkLmRhdGEpLGs9ZC51cmw7aWYoZC5jYWNoZT09PSExKXt2YXIgeD1mLm5vdygpLHk9ZC51cmwucmVwbGFjZShiUSxcIiQxXz1cIit4KTtkLnVybD15Kyh5PT09ZC51cmw/KGJNLnRlc3QoZC51cmwpP1wiJlwiOlwiP1wiKStcIl89XCIreDpcIlwiKX19KGQuZGF0YSYmZC5oYXNDb250ZW50JiZkLmNvbnRlbnRUeXBlIT09ITF8fGMuY29udGVudFR5cGUpJiZ2LnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIixkLmNvbnRlbnRUeXBlKSxkLmlmTW9kaWZpZWQmJihrPWt8fGQudXJsLGYubGFzdE1vZGlmaWVkW2tdJiZ2LnNldFJlcXVlc3RIZWFkZXIoXCJJZi1Nb2RpZmllZC1TaW5jZVwiLGYubGFzdE1vZGlmaWVkW2tdKSxmLmV0YWdba10mJnYuc2V0UmVxdWVzdEhlYWRlcihcIklmLU5vbmUtTWF0Y2hcIixmLmV0YWdba10pKSx2LnNldFJlcXVlc3RIZWFkZXIoXCJBY2NlcHRcIixkLmRhdGFUeXBlc1swXSYmZC5hY2NlcHRzW2QuZGF0YVR5cGVzWzBdXT9kLmFjY2VwdHNbZC5kYXRhVHlwZXNbMF1dKyhkLmRhdGFUeXBlc1swXSE9PVwiKlwiP1wiLCBcIitiWCtcIjsgcT0wLjAxXCI6XCJcIik6ZC5hY2NlcHRzW1wiKlwiXSk7Zm9yKHUgaW4gZC5oZWFkZXJzKXYuc2V0UmVxdWVzdEhlYWRlcih1LGQuaGVhZGVyc1t1XSk7aWYoZC5iZWZvcmVTZW5kJiYoZC5iZWZvcmVTZW5kLmNhbGwoZSx2LGQpPT09ITF8fHM9PT0yKSl7di5hYm9ydCgpO3JldHVybiExfWZvcih1IGlue3N1Y2Nlc3M6MSxlcnJvcjoxLGNvbXBsZXRlOjF9KXZbdV0oZFt1XSk7cD1iJChiVSxkLGMsdik7aWYoIXApdygtMSxcIk5vIFRyYW5zcG9ydFwiKTtlbHNle3YucmVhZHlTdGF0ZT0xLHQmJmcudHJpZ2dlcihcImFqYXhTZW5kXCIsW3YsZF0pLGQuYXN5bmMmJmQudGltZW91dD4wJiYocT1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7di5hYm9ydChcInRpbWVvdXRcIil9LGQudGltZW91dCkpO3RyeXtzPTEscC5zZW5kKGwsdyl9Y2F0Y2goeil7aWYoczwyKXcoLTEseik7ZWxzZSB0aHJvdyB6fX1yZXR1cm4gdn0scGFyYW06ZnVuY3Rpb24oYSxjKXt2YXIgZD1bXSxlPWZ1bmN0aW9uKGEsYil7Yj1mLmlzRnVuY3Rpb24oYik/YigpOmIsZFtkLmxlbmd0aF09ZW5jb2RlVVJJQ29tcG9uZW50KGEpK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudChiKX07Yz09PWImJihjPWYuYWpheFNldHRpbmdzLnRyYWRpdGlvbmFsKTtpZihmLmlzQXJyYXkoYSl8fGEuanF1ZXJ5JiYhZi5pc1BsYWluT2JqZWN0KGEpKWYuZWFjaChhLGZ1bmN0aW9uKCl7ZSh0aGlzLm5hbWUsdGhpcy52YWx1ZSl9KTtlbHNlIGZvcih2YXIgZyBpbiBhKWNhKGcsYVtnXSxjLGUpO3JldHVybiBkLmpvaW4oXCImXCIpLnJlcGxhY2UoYkQsXCIrXCIpfX0pLGYuZXh0ZW5kKHthY3RpdmU6MCxsYXN0TW9kaWZpZWQ6e30sZXRhZzp7fX0pO3ZhciBjZD1mLm5vdygpLGNlPS8oXFw9KVxcPygmfCQpfFxcP1xcPy9pO2YuYWpheFNldHVwKHtqc29ucDpcImNhbGxiYWNrXCIsanNvbnBDYWxsYmFjazpmdW5jdGlvbigpe3JldHVybiBmLmV4cGFuZG8rXCJfXCIrY2QrK319KSxmLmFqYXhQcmVmaWx0ZXIoXCJqc29uIGpzb25wXCIsZnVuY3Rpb24oYixjLGQpe3ZhciBlPWIuY29udGVudFR5cGU9PT1cImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiJiZ0eXBlb2YgYi5kYXRhPT1cInN0cmluZ1wiO2lmKGIuZGF0YVR5cGVzWzBdPT09XCJqc29ucFwifHxiLmpzb25wIT09ITEmJihjZS50ZXN0KGIudXJsKXx8ZSYmY2UudGVzdChiLmRhdGEpKSl7dmFyIGcsaD1iLmpzb25wQ2FsbGJhY2s9Zi5pc0Z1bmN0aW9uKGIuanNvbnBDYWxsYmFjayk/Yi5qc29ucENhbGxiYWNrKCk6Yi5qc29ucENhbGxiYWNrLGk9YVtoXSxqPWIudXJsLGs9Yi5kYXRhLGw9XCIkMVwiK2grXCIkMlwiO2IuanNvbnAhPT0hMSYmKGo9ai5yZXBsYWNlKGNlLGwpLGIudXJsPT09aiYmKGUmJihrPWsucmVwbGFjZShjZSxsKSksYi5kYXRhPT09ayYmKGorPSgvXFw/Ly50ZXN0KGopP1wiJlwiOlwiP1wiKStiLmpzb25wK1wiPVwiK2gpKSksYi51cmw9aixiLmRhdGE9ayxhW2hdPWZ1bmN0aW9uKGEpe2c9W2FdfSxkLmFsd2F5cyhmdW5jdGlvbigpe2FbaF09aSxnJiZmLmlzRnVuY3Rpb24oaSkmJmFbaF0oZ1swXSl9KSxiLmNvbnZlcnRlcnNbXCJzY3JpcHQganNvblwiXT1mdW5jdGlvbigpe2d8fGYuZXJyb3IoaCtcIiB3YXMgbm90IGNhbGxlZFwiKTtyZXR1cm4gZ1swXX0sYi5kYXRhVHlwZXNbMF09XCJqc29uXCI7cmV0dXJuXCJzY3JpcHRcIn19KSxmLmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OlwidGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHRcIn0sY29udGVudHM6e3NjcmlwdDovamF2YXNjcmlwdHxlY21hc2NyaXB0L30sY29udmVydGVyczp7XCJ0ZXh0IHNjcmlwdFwiOmZ1bmN0aW9uKGEpe2YuZ2xvYmFsRXZhbChhKTtyZXR1cm4gYX19fSksZi5hamF4UHJlZmlsdGVyKFwic2NyaXB0XCIsZnVuY3Rpb24oYSl7YS5jYWNoZT09PWImJihhLmNhY2hlPSExKSxhLmNyb3NzRG9tYWluJiYoYS50eXBlPVwiR0VUXCIsYS5nbG9iYWw9ITEpfSksZi5hamF4VHJhbnNwb3J0KFwic2NyaXB0XCIsZnVuY3Rpb24oYSl7aWYoYS5jcm9zc0RvbWFpbil7dmFyIGQsZT1jLmhlYWR8fGMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdfHxjLmRvY3VtZW50RWxlbWVudDtyZXR1cm57c2VuZDpmdW5jdGlvbihmLGcpe2Q9Yy5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpLGQuYXN5bmM9XCJhc3luY1wiLGEuc2NyaXB0Q2hhcnNldCYmKGQuY2hhcnNldD1hLnNjcmlwdENoYXJzZXQpLGQuc3JjPWEudXJsLGQub25sb2FkPWQub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKGEsYyl7aWYoY3x8IWQucmVhZHlTdGF0ZXx8L2xvYWRlZHxjb21wbGV0ZS8udGVzdChkLnJlYWR5U3RhdGUpKWQub25sb2FkPWQub25yZWFkeXN0YXRlY2hhbmdlPW51bGwsZSYmZC5wYXJlbnROb2RlJiZlLnJlbW92ZUNoaWxkKGQpLGQ9YixjfHxnKDIwMCxcInN1Y2Nlc3NcIil9LGUuaW5zZXJ0QmVmb3JlKGQsZS5maXJzdENoaWxkKX0sYWJvcnQ6ZnVuY3Rpb24oKXtkJiZkLm9ubG9hZCgwLDEpfX19fSk7dmFyIGNmPWEuQWN0aXZlWE9iamVjdD9mdW5jdGlvbigpe2Zvcih2YXIgYSBpbiBjaCljaFthXSgwLDEpfTohMSxjZz0wLGNoO2YuYWpheFNldHRpbmdzLnhocj1hLkFjdGl2ZVhPYmplY3Q/ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5pc0xvY2FsJiZjaSgpfHxjaigpfTpjaSxmdW5jdGlvbihhKXtmLmV4dGVuZChmLnN1cHBvcnQse2FqYXg6ISFhLGNvcnM6ISFhJiZcIndpdGhDcmVkZW50aWFsc1wiaW4gYX0pfShmLmFqYXhTZXR0aW5ncy54aHIoKSksZi5zdXBwb3J0LmFqYXgmJmYuYWpheFRyYW5zcG9ydChmdW5jdGlvbihjKXtpZighYy5jcm9zc0RvbWFpbnx8Zi5zdXBwb3J0LmNvcnMpe3ZhciBkO3JldHVybntzZW5kOmZ1bmN0aW9uKGUsZyl7dmFyIGg9Yy54aHIoKSxpLGo7Yy51c2VybmFtZT9oLm9wZW4oYy50eXBlLGMudXJsLGMuYXN5bmMsYy51c2VybmFtZSxjLnBhc3N3b3JkKTpoLm9wZW4oYy50eXBlLGMudXJsLGMuYXN5bmMpO2lmKGMueGhyRmllbGRzKWZvcihqIGluIGMueGhyRmllbGRzKWhbal09Yy54aHJGaWVsZHNbal07Yy5taW1lVHlwZSYmaC5vdmVycmlkZU1pbWVUeXBlJiZoLm92ZXJyaWRlTWltZVR5cGUoYy5taW1lVHlwZSksIWMuY3Jvc3NEb21haW4mJiFlW1wiWC1SZXF1ZXN0ZWQtV2l0aFwiXSYmKGVbXCJYLVJlcXVlc3RlZC1XaXRoXCJdPVwiWE1MSHR0cFJlcXVlc3RcIik7dHJ5e2ZvcihqIGluIGUpaC5zZXRSZXF1ZXN0SGVhZGVyKGosZVtqXSl9Y2F0Y2goayl7fWguc2VuZChjLmhhc0NvbnRlbnQmJmMuZGF0YXx8bnVsbCksZD1mdW5jdGlvbihhLGUpe3ZhciBqLGssbCxtLG47dHJ5e2lmKGQmJihlfHxoLnJlYWR5U3RhdGU9PT00KSl7ZD1iLGkmJihoLm9ucmVhZHlzdGF0ZWNoYW5nZT1mLm5vb3AsY2YmJmRlbGV0ZSBjaFtpXSk7aWYoZSloLnJlYWR5U3RhdGUhPT00JiZoLmFib3J0KCk7ZWxzZXtqPWguc3RhdHVzLGw9aC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSxtPXt9LG49aC5yZXNwb25zZVhNTCxuJiZuLmRvY3VtZW50RWxlbWVudCYmKG0ueG1sPW4pLG0udGV4dD1oLnJlc3BvbnNlVGV4dDt0cnl7az1oLnN0YXR1c1RleHR9Y2F0Y2gobyl7az1cIlwifSFqJiZjLmlzTG9jYWwmJiFjLmNyb3NzRG9tYWluP2o9bS50ZXh0PzIwMDo0MDQ6aj09PTEyMjMmJihqPTIwNCl9fX1jYXRjaChwKXtlfHxnKC0xLHApfW0mJmcoaixrLG0sbCl9LCFjLmFzeW5jfHxoLnJlYWR5U3RhdGU9PT00P2QoKTooaT0rK2NnLGNmJiYoY2h8fChjaD17fSxmKGEpLnVubG9hZChjZikpLGNoW2ldPWQpLGgub25yZWFkeXN0YXRlY2hhbmdlPWQpfSxhYm9ydDpmdW5jdGlvbigpe2QmJmQoMCwxKX19fX0pO3ZhciBjaz17fSxjbCxjbSxjbj0vXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sY289L14oWytcXC1dPSk/KFtcXGQrLlxcLV0rKShbYS16JV0qKSQvaSxjcCxjcT1bW1wiaGVpZ2h0XCIsXCJtYXJnaW5Ub3BcIixcIm1hcmdpbkJvdHRvbVwiLFwicGFkZGluZ1RvcFwiLFwicGFkZGluZ0JvdHRvbVwiXSxbXCJ3aWR0aFwiLFwibWFyZ2luTGVmdFwiLFwibWFyZ2luUmlnaHRcIixcInBhZGRpbmdMZWZ0XCIsXCJwYWRkaW5nUmlnaHRcIl0sW1wib3BhY2l0eVwiXV0sY3I7Zi5mbi5leHRlbmQoe3Nob3c6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU7aWYoYXx8YT09PTApcmV0dXJuIHRoaXMuYW5pbWF0ZShjdShcInNob3dcIiwzKSxhLGIsYyk7Zm9yKHZhciBnPTAsaD10aGlzLmxlbmd0aDtnPGg7ZysrKWQ9dGhpc1tnXSxkLnN0eWxlJiYoZT1kLnN0eWxlLmRpc3BsYXksIWYuX2RhdGEoZCxcIm9sZGRpc3BsYXlcIikmJmU9PT1cIm5vbmVcIiYmKGU9ZC5zdHlsZS5kaXNwbGF5PVwiXCIpLGU9PT1cIlwiJiZmLmNzcyhkLFwiZGlzcGxheVwiKT09PVwibm9uZVwiJiZmLl9kYXRhKGQsXCJvbGRkaXNwbGF5XCIsY3YoZC5ub2RlTmFtZSkpKTtmb3IoZz0wO2c8aDtnKyspe2Q9dGhpc1tnXTtpZihkLnN0eWxlKXtlPWQuc3R5bGUuZGlzcGxheTtpZihlPT09XCJcInx8ZT09PVwibm9uZVwiKWQuc3R5bGUuZGlzcGxheT1mLl9kYXRhKGQsXCJvbGRkaXNwbGF5XCIpfHxcIlwifX1yZXR1cm4gdGhpc30saGlkZTpmdW5jdGlvbihhLGIsYyl7aWYoYXx8YT09PTApcmV0dXJuIHRoaXMuYW5pbWF0ZShjdShcImhpZGVcIiwzKSxhLGIsYyk7dmFyIGQsZSxnPTAsaD10aGlzLmxlbmd0aDtmb3IoO2c8aDtnKyspZD10aGlzW2ddLGQuc3R5bGUmJihlPWYuY3NzKGQsXCJkaXNwbGF5XCIpLGUhPT1cIm5vbmVcIiYmIWYuX2RhdGEoZCxcIm9sZGRpc3BsYXlcIikmJmYuX2RhdGEoZCxcIm9sZGRpc3BsYXlcIixlKSk7Zm9yKGc9MDtnPGg7ZysrKXRoaXNbZ10uc3R5bGUmJih0aGlzW2ddLnN0eWxlLmRpc3BsYXk9XCJub25lXCIpO3JldHVybiB0aGlzfSxfdG9nZ2xlOmYuZm4udG9nZ2xlLHRvZ2dsZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dHlwZW9mIGE9PVwiYm9vbGVhblwiO2YuaXNGdW5jdGlvbihhKSYmZi5pc0Z1bmN0aW9uKGIpP3RoaXMuX3RvZ2dsZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk6YT09bnVsbHx8ZD90aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj1kP2E6Zih0aGlzKS5pcyhcIjpoaWRkZW5cIik7Zih0aGlzKVtiP1wic2hvd1wiOlwiaGlkZVwiXSgpfSk6dGhpcy5hbmltYXRlKGN1KFwidG9nZ2xlXCIsMyksYSxiLGMpO3JldHVybiB0aGlzfSxmYWRlVG86ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuZmlsdGVyKFwiOmhpZGRlblwiKS5jc3MoXCJvcGFjaXR5XCIsMCkuc2hvdygpLmVuZCgpLmFuaW1hdGUoe29wYWNpdHk6Yn0sYSxjLGQpfSxhbmltYXRlOmZ1bmN0aW9uKGEsYixjLGQpe2Z1bmN0aW9uIGcoKXtlLnF1ZXVlPT09ITEmJmYuX21hcmsodGhpcyk7dmFyIGI9Zi5leHRlbmQoe30sZSksYz10aGlzLm5vZGVUeXBlPT09MSxkPWMmJmYodGhpcykuaXMoXCI6aGlkZGVuXCIpLGcsaCxpLGosayxsLG0sbixvO2IuYW5pbWF0ZWRQcm9wZXJ0aWVzPXt9O2ZvcihpIGluIGEpe2c9Zi5jYW1lbENhc2UoaSksaSE9PWcmJihhW2ddPWFbaV0sZGVsZXRlIGFbaV0pLGg9YVtnXSxmLmlzQXJyYXkoaCk/KGIuYW5pbWF0ZWRQcm9wZXJ0aWVzW2ddPWhbMV0saD1hW2ddPWhbMF0pOmIuYW5pbWF0ZWRQcm9wZXJ0aWVzW2ddPWIuc3BlY2lhbEVhc2luZyYmYi5zcGVjaWFsRWFzaW5nW2ddfHxiLmVhc2luZ3x8XCJzd2luZ1wiO2lmKGg9PT1cImhpZGVcIiYmZHx8aD09PVwic2hvd1wiJiYhZClyZXR1cm4gYi5jb21wbGV0ZS5jYWxsKHRoaXMpO2MmJihnPT09XCJoZWlnaHRcInx8Zz09PVwid2lkdGhcIikmJihiLm92ZXJmbG93PVt0aGlzLnN0eWxlLm92ZXJmbG93LHRoaXMuc3R5bGUub3ZlcmZsb3dYLHRoaXMuc3R5bGUub3ZlcmZsb3dZXSxmLmNzcyh0aGlzLFwiZGlzcGxheVwiKT09PVwiaW5saW5lXCImJmYuY3NzKHRoaXMsXCJmbG9hdFwiKT09PVwibm9uZVwiJiYoIWYuc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0fHxjdih0aGlzLm5vZGVOYW1lKT09PVwiaW5saW5lXCI/dGhpcy5zdHlsZS5kaXNwbGF5PVwiaW5saW5lLWJsb2NrXCI6dGhpcy5zdHlsZS56b29tPTEpKX1iLm92ZXJmbG93IT1udWxsJiYodGhpcy5zdHlsZS5vdmVyZmxvdz1cImhpZGRlblwiKTtmb3IoaSBpbiBhKWo9bmV3IGYuZngodGhpcyxiLGkpLGg9YVtpXSxjbi50ZXN0KGgpPyhvPWYuX2RhdGEodGhpcyxcInRvZ2dsZVwiK2kpfHwoaD09PVwidG9nZ2xlXCI/ZD9cInNob3dcIjpcImhpZGVcIjowKSxvPyhmLl9kYXRhKHRoaXMsXCJ0b2dnbGVcIitpLG89PT1cInNob3dcIj9cImhpZGVcIjpcInNob3dcIiksaltvXSgpKTpqW2hdKCkpOihrPWNvLmV4ZWMoaCksbD1qLmN1cigpLGs/KG09cGFyc2VGbG9hdChrWzJdKSxuPWtbM118fChmLmNzc051bWJlcltpXT9cIlwiOlwicHhcIiksbiE9PVwicHhcIiYmKGYuc3R5bGUodGhpcyxpLChtfHwxKStuKSxsPShtfHwxKS9qLmN1cigpKmwsZi5zdHlsZSh0aGlzLGksbCtuKSksa1sxXSYmKG09KGtbMV09PT1cIi09XCI/LTE6MSkqbStsKSxqLmN1c3RvbShsLG0sbikpOmouY3VzdG9tKGwsaCxcIlwiKSk7cmV0dXJuITB9dmFyIGU9Zi5zcGVlZChiLGMsZCk7aWYoZi5pc0VtcHR5T2JqZWN0KGEpKXJldHVybiB0aGlzLmVhY2goZS5jb21wbGV0ZSxbITFdKTthPWYuZXh0ZW5kKHt9LGEpO3JldHVybiBlLnF1ZXVlPT09ITE/dGhpcy5lYWNoKGcpOnRoaXMucXVldWUoZS5xdWV1ZSxnKX0sc3RvcDpmdW5jdGlvbihhLGMsZCl7dHlwZW9mIGEhPVwic3RyaW5nXCImJihkPWMsYz1hLGE9YiksYyYmYSE9PSExJiZ0aGlzLnF1ZXVlKGF8fFwiZnhcIixbXSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2Z1bmN0aW9uIGgoYSxiLGMpe3ZhciBlPWJbY107Zi5yZW1vdmVEYXRhKGEsYywhMCksZS5zdG9wKGQpfXZhciBiLGM9ITEsZT1mLnRpbWVycyxnPWYuX2RhdGEodGhpcyk7ZHx8Zi5fdW5tYXJrKCEwLHRoaXMpO2lmKGE9PW51bGwpZm9yKGIgaW4gZylnW2JdJiZnW2JdLnN0b3AmJmIuaW5kZXhPZihcIi5ydW5cIik9PT1iLmxlbmd0aC00JiZoKHRoaXMsZyxiKTtlbHNlIGdbYj1hK1wiLnJ1blwiXSYmZ1tiXS5zdG9wJiZoKHRoaXMsZyxiKTtmb3IoYj1lLmxlbmd0aDtiLS07KWVbYl0uZWxlbT09PXRoaXMmJihhPT1udWxsfHxlW2JdLnF1ZXVlPT09YSkmJihkP2VbYl0oITApOmVbYl0uc2F2ZVN0YXRlKCksYz0hMCxlLnNwbGljZShiLDEpKTsoIWR8fCFjKSYmZi5kZXF1ZXVlKHRoaXMsYSl9KX19KSxmLmVhY2goe3NsaWRlRG93bjpjdShcInNob3dcIiwxKSxzbGlkZVVwOmN1KFwiaGlkZVwiLDEpLHNsaWRlVG9nZ2xlOmN1KFwidG9nZ2xlXCIsMSksZmFkZUluOntvcGFjaXR5Olwic2hvd1wifSxmYWRlT3V0OntvcGFjaXR5OlwiaGlkZVwifSxmYWRlVG9nZ2xlOntvcGFjaXR5OlwidG9nZ2xlXCJ9fSxmdW5jdGlvbihhLGIpe2YuZm5bYV09ZnVuY3Rpb24oYSxjLGQpe3JldHVybiB0aGlzLmFuaW1hdGUoYixhLGMsZCl9fSksZi5leHRlbmQoe3NwZWVkOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hJiZ0eXBlb2YgYT09XCJvYmplY3RcIj9mLmV4dGVuZCh7fSxhKTp7Y29tcGxldGU6Y3x8IWMmJmJ8fGYuaXNGdW5jdGlvbihhKSYmYSxkdXJhdGlvbjphLGVhc2luZzpjJiZifHxiJiYhZi5pc0Z1bmN0aW9uKGIpJiZifTtkLmR1cmF0aW9uPWYuZngub2ZmPzA6dHlwZW9mIGQuZHVyYXRpb249PVwibnVtYmVyXCI/ZC5kdXJhdGlvbjpkLmR1cmF0aW9uIGluIGYuZnguc3BlZWRzP2YuZnguc3BlZWRzW2QuZHVyYXRpb25dOmYuZnguc3BlZWRzLl9kZWZhdWx0O2lmKGQucXVldWU9PW51bGx8fGQucXVldWU9PT0hMClkLnF1ZXVlPVwiZnhcIjtkLm9sZD1kLmNvbXBsZXRlLGQuY29tcGxldGU9ZnVuY3Rpb24oYSl7Zi5pc0Z1bmN0aW9uKGQub2xkKSYmZC5vbGQuY2FsbCh0aGlzKSxkLnF1ZXVlP2YuZGVxdWV1ZSh0aGlzLGQucXVldWUpOmEhPT0hMSYmZi5fdW5tYXJrKHRoaXMpfTtyZXR1cm4gZH0sZWFzaW5nOntsaW5lYXI6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGMrZCphfSxzd2luZzpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4oLU1hdGguY29zKGEqTWF0aC5QSSkvMisuNSkqZCtjfX0sdGltZXJzOltdLGZ4OmZ1bmN0aW9uKGEsYixjKXt0aGlzLm9wdGlvbnM9Yix0aGlzLmVsZW09YSx0aGlzLnByb3A9YyxiLm9yaWc9Yi5vcmlnfHx7fX19KSxmLmZ4LnByb3RvdHlwZT17dXBkYXRlOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLnN0ZXAmJnRoaXMub3B0aW9ucy5zdGVwLmNhbGwodGhpcy5lbGVtLHRoaXMubm93LHRoaXMpLChmLmZ4LnN0ZXBbdGhpcy5wcm9wXXx8Zi5meC5zdGVwLl9kZWZhdWx0KSh0aGlzKX0sY3VyOmZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtW3RoaXMucHJvcF0hPW51bGwmJighdGhpcy5lbGVtLnN0eWxlfHx0aGlzLmVsZW0uc3R5bGVbdGhpcy5wcm9wXT09bnVsbCkpcmV0dXJuIHRoaXMuZWxlbVt0aGlzLnByb3BdO3ZhciBhLGI9Zi5jc3ModGhpcy5lbGVtLHRoaXMucHJvcCk7cmV0dXJuIGlzTmFOKGE9cGFyc2VGbG9hdChiKSk/IWJ8fGI9PT1cImF1dG9cIj8wOmI6YX0sY3VzdG9tOmZ1bmN0aW9uKGEsYyxkKXtmdW5jdGlvbiBoKGEpe3JldHVybiBlLnN0ZXAoYSl9dmFyIGU9dGhpcyxnPWYuZng7dGhpcy5zdGFydFRpbWU9Y3J8fGNzKCksdGhpcy5lbmQ9Yyx0aGlzLm5vdz10aGlzLnN0YXJ0PWEsdGhpcy5wb3M9dGhpcy5zdGF0ZT0wLHRoaXMudW5pdD1kfHx0aGlzLnVuaXR8fChmLmNzc051bWJlclt0aGlzLnByb3BdP1wiXCI6XCJweFwiKSxoLnF1ZXVlPXRoaXMub3B0aW9ucy5xdWV1ZSxoLmVsZW09dGhpcy5lbGVtLGguc2F2ZVN0YXRlPWZ1bmN0aW9uKCl7ZS5vcHRpb25zLmhpZGUmJmYuX2RhdGEoZS5lbGVtLFwiZnhzaG93XCIrZS5wcm9wKT09PWImJmYuX2RhdGEoZS5lbGVtLFwiZnhzaG93XCIrZS5wcm9wLGUuc3RhcnQpfSxoKCkmJmYudGltZXJzLnB1c2goaCkmJiFjcCYmKGNwPXNldEludGVydmFsKGcudGljayxnLmludGVydmFsKSl9LHNob3c6ZnVuY3Rpb24oKXt2YXIgYT1mLl9kYXRhKHRoaXMuZWxlbSxcImZ4c2hvd1wiK3RoaXMucHJvcCk7dGhpcy5vcHRpb25zLm9yaWdbdGhpcy5wcm9wXT1hfHxmLnN0eWxlKHRoaXMuZWxlbSx0aGlzLnByb3ApLHRoaXMub3B0aW9ucy5zaG93PSEwLGEhPT1iP3RoaXMuY3VzdG9tKHRoaXMuY3VyKCksYSk6dGhpcy5jdXN0b20odGhpcy5wcm9wPT09XCJ3aWR0aFwifHx0aGlzLnByb3A9PT1cImhlaWdodFwiPzE6MCx0aGlzLmN1cigpKSxmKHRoaXMuZWxlbSkuc2hvdygpfSxoaWRlOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLm9yaWdbdGhpcy5wcm9wXT1mLl9kYXRhKHRoaXMuZWxlbSxcImZ4c2hvd1wiK3RoaXMucHJvcCl8fGYuc3R5bGUodGhpcy5lbGVtLHRoaXMucHJvcCksdGhpcy5vcHRpb25zLmhpZGU9ITAsdGhpcy5jdXN0b20odGhpcy5jdXIoKSwwKX0sc3RlcDpmdW5jdGlvbihhKXt2YXIgYixjLGQsZT1jcnx8Y3MoKSxnPSEwLGg9dGhpcy5lbGVtLGk9dGhpcy5vcHRpb25zO2lmKGF8fGU+PWkuZHVyYXRpb24rdGhpcy5zdGFydFRpbWUpe3RoaXMubm93PXRoaXMuZW5kLHRoaXMucG9zPXRoaXMuc3RhdGU9MSx0aGlzLnVwZGF0ZSgpLGkuYW5pbWF0ZWRQcm9wZXJ0aWVzW3RoaXMucHJvcF09ITA7Zm9yKGIgaW4gaS5hbmltYXRlZFByb3BlcnRpZXMpaS5hbmltYXRlZFByb3BlcnRpZXNbYl0hPT0hMCYmKGc9ITEpO2lmKGcpe2kub3ZlcmZsb3chPW51bGwmJiFmLnN1cHBvcnQuc2hyaW5rV3JhcEJsb2NrcyYmZi5lYWNoKFtcIlwiLFwiWFwiLFwiWVwiXSxmdW5jdGlvbihhLGIpe2guc3R5bGVbXCJvdmVyZmxvd1wiK2JdPWkub3ZlcmZsb3dbYV19KSxpLmhpZGUmJmYoaCkuaGlkZSgpO2lmKGkuaGlkZXx8aS5zaG93KWZvcihiIGluIGkuYW5pbWF0ZWRQcm9wZXJ0aWVzKWYuc3R5bGUoaCxiLGkub3JpZ1tiXSksZi5yZW1vdmVEYXRhKGgsXCJmeHNob3dcIitiLCEwKSxmLnJlbW92ZURhdGEoaCxcInRvZ2dsZVwiK2IsITApO2Q9aS5jb21wbGV0ZSxkJiYoaS5jb21wbGV0ZT0hMSxkLmNhbGwoaCkpfXJldHVybiExfWkuZHVyYXRpb249PUluZmluaXR5P3RoaXMubm93PWU6KGM9ZS10aGlzLnN0YXJ0VGltZSx0aGlzLnN0YXRlPWMvaS5kdXJhdGlvbix0aGlzLnBvcz1mLmVhc2luZ1tpLmFuaW1hdGVkUHJvcGVydGllc1t0aGlzLnByb3BdXSh0aGlzLnN0YXRlLGMsMCwxLGkuZHVyYXRpb24pLHRoaXMubm93PXRoaXMuc3RhcnQrKHRoaXMuZW5kLXRoaXMuc3RhcnQpKnRoaXMucG9zKSx0aGlzLnVwZGF0ZSgpO3JldHVybiEwfX0sZi5leHRlbmQoZi5meCx7dGljazpmdW5jdGlvbigpe3ZhciBhLGI9Zi50aW1lcnMsYz0wO2Zvcig7YzxiLmxlbmd0aDtjKyspYT1iW2NdLCFhKCkmJmJbY109PT1hJiZiLnNwbGljZShjLS0sMSk7Yi5sZW5ndGh8fGYuZnguc3RvcCgpfSxpbnRlcnZhbDoxMyxzdG9wOmZ1bmN0aW9uKCl7Y2xlYXJJbnRlcnZhbChjcCksY3A9bnVsbH0sc3BlZWRzOntzbG93OjYwMCxmYXN0OjIwMCxfZGVmYXVsdDo0MDB9LHN0ZXA6e29wYWNpdHk6ZnVuY3Rpb24oYSl7Zi5zdHlsZShhLmVsZW0sXCJvcGFjaXR5XCIsYS5ub3cpfSxfZGVmYXVsdDpmdW5jdGlvbihhKXthLmVsZW0uc3R5bGUmJmEuZWxlbS5zdHlsZVthLnByb3BdIT1udWxsP2EuZWxlbS5zdHlsZVthLnByb3BdPWEubm93K2EudW5pdDphLmVsZW1bYS5wcm9wXT1hLm5vd319fSksZi5lYWNoKFtcIndpZHRoXCIsXCJoZWlnaHRcIl0sZnVuY3Rpb24oYSxiKXtmLmZ4LnN0ZXBbYl09ZnVuY3Rpb24oYSl7Zi5zdHlsZShhLmVsZW0sYixNYXRoLm1heCgwLGEubm93KSthLnVuaXQpfX0pLGYuZXhwciYmZi5leHByLmZpbHRlcnMmJihmLmV4cHIuZmlsdGVycy5hbmltYXRlZD1mdW5jdGlvbihhKXtyZXR1cm4gZi5ncmVwKGYudGltZXJzLGZ1bmN0aW9uKGIpe3JldHVybiBhPT09Yi5lbGVtfSkubGVuZ3RofSk7dmFyIGN3PS9edCg/OmFibGV8ZHxoKSQvaSxjeD0vXig/OmJvZHl8aHRtbCkkL2k7XCJnZXRCb3VuZGluZ0NsaWVudFJlY3RcImluIGMuZG9jdW1lbnRFbGVtZW50P2YuZm4ub2Zmc2V0PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXNbMF0sYztpZihhKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7Zi5vZmZzZXQuc2V0T2Zmc2V0KHRoaXMsYSxiKX0pO2lmKCFifHwhYi5vd25lckRvY3VtZW50KXJldHVybiBudWxsO2lmKGI9PT1iLm93bmVyRG9jdW1lbnQuYm9keSlyZXR1cm4gZi5vZmZzZXQuYm9keU9mZnNldChiKTt0cnl7Yz1iLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpfWNhdGNoKGQpe312YXIgZT1iLm93bmVyRG9jdW1lbnQsZz1lLmRvY3VtZW50RWxlbWVudDtpZighY3x8IWYuY29udGFpbnMoZyxiKSlyZXR1cm4gYz97dG9wOmMudG9wLGxlZnQ6Yy5sZWZ0fTp7dG9wOjAsbGVmdDowfTt2YXIgaD1lLmJvZHksaT1jeShlKSxqPWcuY2xpZW50VG9wfHxoLmNsaWVudFRvcHx8MCxrPWcuY2xpZW50TGVmdHx8aC5jbGllbnRMZWZ0fHwwLGw9aS5wYWdlWU9mZnNldHx8Zi5zdXBwb3J0LmJveE1vZGVsJiZnLnNjcm9sbFRvcHx8aC5zY3JvbGxUb3AsbT1pLnBhZ2VYT2Zmc2V0fHxmLnN1cHBvcnQuYm94TW9kZWwmJmcuc2Nyb2xsTGVmdHx8aC5zY3JvbGxMZWZ0LG49Yy50b3ArbC1qLG89Yy5sZWZ0K20taztyZXR1cm57dG9wOm4sbGVmdDpvfX06Zi5mbi5vZmZzZXQ9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpc1swXTtpZihhKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7Zi5vZmZzZXQuc2V0T2Zmc2V0KHRoaXMsYSxiKX0pO2lmKCFifHwhYi5vd25lckRvY3VtZW50KXJldHVybiBudWxsO2lmKGI9PT1iLm93bmVyRG9jdW1lbnQuYm9keSlyZXR1cm4gZi5vZmZzZXQuYm9keU9mZnNldChiKTt2YXIgYyxkPWIub2Zmc2V0UGFyZW50LGU9YixnPWIub3duZXJEb2N1bWVudCxoPWcuZG9jdW1lbnRFbGVtZW50LGk9Zy5ib2R5LGo9Zy5kZWZhdWx0VmlldyxrPWo/ai5nZXRDb21wdXRlZFN0eWxlKGIsbnVsbCk6Yi5jdXJyZW50U3R5bGUsbD1iLm9mZnNldFRvcCxtPWIub2Zmc2V0TGVmdDt3aGlsZSgoYj1iLnBhcmVudE5vZGUpJiZiIT09aSYmYiE9PWgpe2lmKGYuc3VwcG9ydC5maXhlZFBvc2l0aW9uJiZrLnBvc2l0aW9uPT09XCJmaXhlZFwiKWJyZWFrO2M9aj9qLmdldENvbXB1dGVkU3R5bGUoYixudWxsKTpiLmN1cnJlbnRTdHlsZSxsLT1iLnNjcm9sbFRvcCxtLT1iLnNjcm9sbExlZnQsYj09PWQmJihsKz1iLm9mZnNldFRvcCxtKz1iLm9mZnNldExlZnQsZi5zdXBwb3J0LmRvZXNOb3RBZGRCb3JkZXImJighZi5zdXBwb3J0LmRvZXNBZGRCb3JkZXJGb3JUYWJsZUFuZENlbGxzfHwhY3cudGVzdChiLm5vZGVOYW1lKSkmJihsKz1wYXJzZUZsb2F0KGMuYm9yZGVyVG9wV2lkdGgpfHwwLG0rPXBhcnNlRmxvYXQoYy5ib3JkZXJMZWZ0V2lkdGgpfHwwKSxlPWQsZD1iLm9mZnNldFBhcmVudCksZi5zdXBwb3J0LnN1YnRyYWN0c0JvcmRlckZvck92ZXJmbG93Tm90VmlzaWJsZSYmYy5vdmVyZmxvdyE9PVwidmlzaWJsZVwiJiYobCs9cGFyc2VGbG9hdChjLmJvcmRlclRvcFdpZHRoKXx8MCxtKz1wYXJzZUZsb2F0KGMuYm9yZGVyTGVmdFdpZHRoKXx8MCksaz1jfWlmKGsucG9zaXRpb249PT1cInJlbGF0aXZlXCJ8fGsucG9zaXRpb249PT1cInN0YXRpY1wiKWwrPWkub2Zmc2V0VG9wLG0rPWkub2Zmc2V0TGVmdDtmLnN1cHBvcnQuZml4ZWRQb3NpdGlvbiYmay5wb3NpdGlvbj09PVwiZml4ZWRcIiYmKGwrPU1hdGgubWF4KGguc2Nyb2xsVG9wLGkuc2Nyb2xsVG9wKSxtKz1NYXRoLm1heChoLnNjcm9sbExlZnQsaS5zY3JvbGxMZWZ0KSk7cmV0dXJue3RvcDpsLGxlZnQ6bX19LGYub2Zmc2V0PXtib2R5T2Zmc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPWEub2Zmc2V0VG9wLGM9YS5vZmZzZXRMZWZ0O2Yuc3VwcG9ydC5kb2VzTm90SW5jbHVkZU1hcmdpbkluQm9keU9mZnNldCYmKGIrPXBhcnNlRmxvYXQoZi5jc3MoYSxcIm1hcmdpblRvcFwiKSl8fDAsYys9cGFyc2VGbG9hdChmLmNzcyhhLFwibWFyZ2luTGVmdFwiKSl8fDApO3JldHVybnt0b3A6YixsZWZ0OmN9fSxzZXRPZmZzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWYuY3NzKGEsXCJwb3NpdGlvblwiKTtkPT09XCJzdGF0aWNcIiYmKGEuc3R5bGUucG9zaXRpb249XCJyZWxhdGl2ZVwiKTt2YXIgZT1mKGEpLGc9ZS5vZmZzZXQoKSxoPWYuY3NzKGEsXCJ0b3BcIiksaT1mLmNzcyhhLFwibGVmdFwiKSxqPShkPT09XCJhYnNvbHV0ZVwifHxkPT09XCJmaXhlZFwiKSYmZi5pbkFycmF5KFwiYXV0b1wiLFtoLGldKT4tMSxrPXt9LGw9e30sbSxuO2o/KGw9ZS5wb3NpdGlvbigpLG09bC50b3Asbj1sLmxlZnQpOihtPXBhcnNlRmxvYXQoaCl8fDAsbj1wYXJzZUZsb2F0KGkpfHwwKSxmLmlzRnVuY3Rpb24oYikmJihiPWIuY2FsbChhLGMsZykpLGIudG9wIT1udWxsJiYoay50b3A9Yi50b3AtZy50b3ArbSksYi5sZWZ0IT1udWxsJiYoay5sZWZ0PWIubGVmdC1nLmxlZnQrbiksXCJ1c2luZ1wiaW4gYj9iLnVzaW5nLmNhbGwoYSxrKTplLmNzcyhrKX19LGYuZm4uZXh0ZW5kKHtwb3NpdGlvbjpmdW5jdGlvbigpe2lmKCF0aGlzWzBdKXJldHVybiBudWxsO3ZhciBhPXRoaXNbMF0sYj10aGlzLm9mZnNldFBhcmVudCgpLGM9dGhpcy5vZmZzZXQoKSxkPWN4LnRlc3QoYlswXS5ub2RlTmFtZSk/e3RvcDowLGxlZnQ6MH06Yi5vZmZzZXQoKTtjLnRvcC09cGFyc2VGbG9hdChmLmNzcyhhLFwibWFyZ2luVG9wXCIpKXx8MCxjLmxlZnQtPXBhcnNlRmxvYXQoZi5jc3MoYSxcIm1hcmdpbkxlZnRcIikpfHwwLGQudG9wKz1wYXJzZUZsb2F0KGYuY3NzKGJbMF0sXCJib3JkZXJUb3BXaWR0aFwiKSl8fDAsZC5sZWZ0Kz1wYXJzZUZsb2F0KGYuY3NzKGJbMF0sXCJib3JkZXJMZWZ0V2lkdGhcIikpfHwwO3JldHVybnt0b3A6Yy50b3AtZC50b3AsbGVmdDpjLmxlZnQtZC5sZWZ0fX0sb2Zmc2V0UGFyZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vZmZzZXRQYXJlbnR8fGMuYm9keTt3aGlsZShhJiYhY3gudGVzdChhLm5vZGVOYW1lKSYmZi5jc3MoYSxcInBvc2l0aW9uXCIpPT09XCJzdGF0aWNcIilhPWEub2Zmc2V0UGFyZW50O3JldHVybiBhfSl9fSksZi5lYWNoKFtcIkxlZnRcIixcIlRvcFwiXSxmdW5jdGlvbihhLGMpe3ZhciBkPVwic2Nyb2xsXCIrYztmLmZuW2RdPWZ1bmN0aW9uKGMpe3ZhciBlLGc7aWYoYz09PWIpe2U9dGhpc1swXTtpZighZSlyZXR1cm4gbnVsbDtnPWN5KGUpO3JldHVybiBnP1wicGFnZVhPZmZzZXRcImluIGc/Z1thP1wicGFnZVlPZmZzZXRcIjpcInBhZ2VYT2Zmc2V0XCJdOmYuc3VwcG9ydC5ib3hNb2RlbCYmZy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbZF18fGcuZG9jdW1lbnQuYm9keVtkXTplW2RdfXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtnPWN5KHRoaXMpLGc/Zy5zY3JvbGxUbyhhP2YoZykuc2Nyb2xsTGVmdCgpOmMsYT9jOmYoZykuc2Nyb2xsVG9wKCkpOnRoaXNbZF09Y30pfX0pLGYuZWFjaChbXCJIZWlnaHRcIixcIldpZHRoXCJdLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9Yy50b0xvd2VyQ2FzZSgpO2YuZm5bXCJpbm5lclwiK2NdPWZ1bmN0aW9uKCl7dmFyIGE9dGhpc1swXTtyZXR1cm4gYT9hLnN0eWxlP3BhcnNlRmxvYXQoZi5jc3MoYSxkLFwicGFkZGluZ1wiKSk6dGhpc1tkXSgpOm51bGx9LGYuZm5bXCJvdXRlclwiK2NdPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXNbMF07cmV0dXJuIGI/Yi5zdHlsZT9wYXJzZUZsb2F0KGYuY3NzKGIsZCxhP1wibWFyZ2luXCI6XCJib3JkZXJcIikpOnRoaXNbZF0oKTpudWxsfSxmLmZuW2RdPWZ1bmN0aW9uKGEpe3ZhciBlPXRoaXNbMF07aWYoIWUpcmV0dXJuIGE9PW51bGw/bnVsbDp0aGlzO2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3ZhciBjPWYodGhpcyk7Y1tkXShhLmNhbGwodGhpcyxiLGNbZF0oKSkpfSk7aWYoZi5pc1dpbmRvdyhlKSl7dmFyIGc9ZS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbXCJjbGllbnRcIitjXSxoPWUuZG9jdW1lbnQuYm9keTtyZXR1cm4gZS5kb2N1bWVudC5jb21wYXRNb2RlPT09XCJDU1MxQ29tcGF0XCImJmd8fGgmJmhbXCJjbGllbnRcIitjXXx8Z31pZihlLm5vZGVUeXBlPT09OSlyZXR1cm4gTWF0aC5tYXgoZS5kb2N1bWVudEVsZW1lbnRbXCJjbGllbnRcIitjXSxlLmJvZHlbXCJzY3JvbGxcIitjXSxlLmRvY3VtZW50RWxlbWVudFtcInNjcm9sbFwiK2NdLGUuYm9keVtcIm9mZnNldFwiK2NdLGUuZG9jdW1lbnRFbGVtZW50W1wib2Zmc2V0XCIrY10pO2lmKGE9PT1iKXt2YXIgaT1mLmNzcyhlLGQpLGo9cGFyc2VGbG9hdChpKTtyZXR1cm4gZi5pc051bWVyaWMoaik/ajppfXJldHVybiB0aGlzLmNzcyhkLHR5cGVvZiBhPT1cInN0cmluZ1wiP2E6YStcInB4XCIpfX0pLGEualF1ZXJ5PWEuJD1mLHR5cGVvZiBkZWZpbmU9PVwiZnVuY3Rpb25cIiYmZGVmaW5lLmFtZCYmZGVmaW5lLmFtZC5qUXVlcnkmJmRlZmluZShcImpxdWVyeVwiLFtdLGZ1bmN0aW9uKCl7cmV0dXJuIGZ9KX0pKHdpbmRvdyk7IiwiLyohXG4qIE5vdGU6IFdoaWxlIE1pY3Jvc29mdCBpcyBub3QgdGhlIGF1dGhvciBvZiB0aGlzIGZpbGUsIE1pY3Jvc29mdCBpc1xuKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4qIE1pY3Jvc29mdCByZXNlcnZlcyBhbGwgb3RoZXIgcmlnaHRzLiBUaGUgbm90aWNlcyBiZWxvdyBhcmUgcHJvdmlkZWRcbiogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuKlxuKiBqUXVlcnkgVUkgMS44LjExXG4qXG4qIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbipcbiogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSVxuKi9cbihmdW5jdGlvbihjLGope2Z1bmN0aW9uIGsoYSl7cmV0dXJuIWMoYSkucGFyZW50cygpLmFuZFNlbGYoKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gYy5jdXJDU1ModGhpcyxcInZpc2liaWxpdHlcIik9PT1cImhpZGRlblwifHxjLmV4cHIuZmlsdGVycy5oaWRkZW4odGhpcyl9KS5sZW5ndGh9Yy51aT1jLnVpfHx7fTtpZighYy51aS52ZXJzaW9uKXtjLmV4dGVuZChjLnVpLHt2ZXJzaW9uOlwiMS44LjExXCIsa2V5Q29kZTp7QUxUOjE4LEJBQ0tTUEFDRTo4LENBUFNfTE9DSzoyMCxDT01NQToxODgsQ09NTUFORDo5MSxDT01NQU5EX0xFRlQ6OTEsQ09NTUFORF9SSUdIVDo5MyxDT05UUk9MOjE3LERFTEVURTo0NixET1dOOjQwLEVORDozNSxFTlRFUjoxMyxFU0NBUEU6MjcsSE9NRTozNixJTlNFUlQ6NDUsTEVGVDozNyxNRU5VOjkzLE5VTVBBRF9BREQ6MTA3LE5VTVBBRF9ERUNJTUFMOjExMCxOVU1QQURfRElWSURFOjExMSxOVU1QQURfRU5URVI6MTA4LE5VTVBBRF9NVUxUSVBMWToxMDYsXG5OVU1QQURfU1VCVFJBQ1Q6MTA5LFBBR0VfRE9XTjozNCxQQUdFX1VQOjMzLFBFUklPRDoxOTAsUklHSFQ6MzksU0hJRlQ6MTYsU1BBQ0U6MzIsVEFCOjksVVA6MzgsV0lORE9XUzo5MX19KTtjLmZuLmV4dGVuZCh7X2ZvY3VzOmMuZm4uZm9jdXMsZm9jdXM6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdHlwZW9mIGE9PT1cIm51bWJlclwiP3RoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBkPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2MoZCkuZm9jdXMoKTtiJiZiLmNhbGwoZCl9LGEpfSk6dGhpcy5fZm9jdXMuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzY3JvbGxQYXJlbnQ6ZnVuY3Rpb24oKXt2YXIgYTthPWMuYnJvd3Nlci5tc2llJiYvKHN0YXRpY3xyZWxhdGl2ZSkvLnRlc3QodGhpcy5jc3MoXCJwb3NpdGlvblwiKSl8fC9hYnNvbHV0ZS8udGVzdCh0aGlzLmNzcyhcInBvc2l0aW9uXCIpKT90aGlzLnBhcmVudHMoKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4vKHJlbGF0aXZlfGFic29sdXRlfGZpeGVkKS8udGVzdChjLmN1ckNTUyh0aGlzLFxuXCJwb3NpdGlvblwiLDEpKSYmLyhhdXRvfHNjcm9sbCkvLnRlc3QoYy5jdXJDU1ModGhpcyxcIm92ZXJmbG93XCIsMSkrYy5jdXJDU1ModGhpcyxcIm92ZXJmbG93LXlcIiwxKStjLmN1ckNTUyh0aGlzLFwib3ZlcmZsb3cteFwiLDEpKX0pLmVxKDApOnRoaXMucGFyZW50cygpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybi8oYXV0b3xzY3JvbGwpLy50ZXN0KGMuY3VyQ1NTKHRoaXMsXCJvdmVyZmxvd1wiLDEpK2MuY3VyQ1NTKHRoaXMsXCJvdmVyZmxvdy15XCIsMSkrYy5jdXJDU1ModGhpcyxcIm92ZXJmbG93LXhcIiwxKSl9KS5lcSgwKTtyZXR1cm4vZml4ZWQvLnRlc3QodGhpcy5jc3MoXCJwb3NpdGlvblwiKSl8fCFhLmxlbmd0aD9jKGRvY3VtZW50KTphfSx6SW5kZXg6ZnVuY3Rpb24oYSl7aWYoYSE9PWopcmV0dXJuIHRoaXMuY3NzKFwiekluZGV4XCIsYSk7aWYodGhpcy5sZW5ndGgpe2E9Yyh0aGlzWzBdKTtmb3IodmFyIGI7YS5sZW5ndGgmJmFbMF0hPT1kb2N1bWVudDspe2I9YS5jc3MoXCJwb3NpdGlvblwiKTtcbmlmKGI9PT1cImFic29sdXRlXCJ8fGI9PT1cInJlbGF0aXZlXCJ8fGI9PT1cImZpeGVkXCIpe2I9cGFyc2VJbnQoYS5jc3MoXCJ6SW5kZXhcIiksMTApO2lmKCFpc05hTihiKSYmYiE9PTApcmV0dXJuIGJ9YT1hLnBhcmVudCgpfX1yZXR1cm4gMH0sZGlzYWJsZVNlbGVjdGlvbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmJpbmQoKGMuc3VwcG9ydC5zZWxlY3RzdGFydD9cInNlbGVjdHN0YXJ0XCI6XCJtb3VzZWRvd25cIikrXCIudWktZGlzYWJsZVNlbGVjdGlvblwiLGZ1bmN0aW9uKGEpe2EucHJldmVudERlZmF1bHQoKX0pfSxlbmFibGVTZWxlY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51bmJpbmQoXCIudWktZGlzYWJsZVNlbGVjdGlvblwiKX19KTtjLmVhY2goW1wiV2lkdGhcIixcIkhlaWdodFwiXSxmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGQoZixnLGwsbSl7Yy5lYWNoKGUsZnVuY3Rpb24oKXtnLT1wYXJzZUZsb2F0KGMuY3VyQ1NTKGYsXCJwYWRkaW5nXCIrdGhpcyx0cnVlKSl8fDA7aWYobClnLT1wYXJzZUZsb2F0KGMuY3VyQ1NTKGYsXG5cImJvcmRlclwiK3RoaXMrXCJXaWR0aFwiLHRydWUpKXx8MDtpZihtKWctPXBhcnNlRmxvYXQoYy5jdXJDU1MoZixcIm1hcmdpblwiK3RoaXMsdHJ1ZSkpfHwwfSk7cmV0dXJuIGd9dmFyIGU9Yj09PVwiV2lkdGhcIj9bXCJMZWZ0XCIsXCJSaWdodFwiXTpbXCJUb3BcIixcIkJvdHRvbVwiXSxoPWIudG9Mb3dlckNhc2UoKSxpPXtpbm5lcldpZHRoOmMuZm4uaW5uZXJXaWR0aCxpbm5lckhlaWdodDpjLmZuLmlubmVySGVpZ2h0LG91dGVyV2lkdGg6Yy5mbi5vdXRlcldpZHRoLG91dGVySGVpZ2h0OmMuZm4ub3V0ZXJIZWlnaHR9O2MuZm5bXCJpbm5lclwiK2JdPWZ1bmN0aW9uKGYpe2lmKGY9PT1qKXJldHVybiBpW1wiaW5uZXJcIitiXS5jYWxsKHRoaXMpO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjKHRoaXMpLmNzcyhoLGQodGhpcyxmKStcInB4XCIpfSl9O2MuZm5bXCJvdXRlclwiK2JdPWZ1bmN0aW9uKGYsZyl7aWYodHlwZW9mIGYhPT1cIm51bWJlclwiKXJldHVybiBpW1wib3V0ZXJcIitiXS5jYWxsKHRoaXMsZik7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2ModGhpcykuY3NzKGgsXG5kKHRoaXMsZix0cnVlLGcpK1wicHhcIil9KX19KTtjLmV4dGVuZChjLmV4cHJbXCI6XCJdLHtkYXRhOmZ1bmN0aW9uKGEsYixkKXtyZXR1cm4hIWMuZGF0YShhLGRbM10pfSxmb2N1c2FibGU6ZnVuY3Rpb24oYSl7dmFyIGI9YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLGQ9Yy5hdHRyKGEsXCJ0YWJpbmRleFwiKTtpZihcImFyZWFcIj09PWIpe2I9YS5wYXJlbnROb2RlO2Q9Yi5uYW1lO2lmKCFhLmhyZWZ8fCFkfHxiLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkhPT1cIm1hcFwiKXJldHVybiBmYWxzZTthPWMoXCJpbWdbdXNlbWFwPSNcIitkK1wiXVwiKVswXTtyZXR1cm4hIWEmJmsoYSl9cmV0dXJuKC9pbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9ufG9iamVjdC8udGVzdChiKT8hYS5kaXNhYmxlZDpcImFcIj09Yj9hLmhyZWZ8fCFpc05hTihkKTohaXNOYU4oZCkpJiZrKGEpfSx0YWJiYWJsZTpmdW5jdGlvbihhKXt2YXIgYj1jLmF0dHIoYSxcInRhYmluZGV4XCIpO3JldHVybihpc05hTihiKXx8Yj49MCkmJmMoYSkuaXMoXCI6Zm9jdXNhYmxlXCIpfX0pO1xuYyhmdW5jdGlvbigpe3ZhciBhPWRvY3VtZW50LmJvZHksYj1hLmFwcGVuZENoaWxkKGI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7Yy5leHRlbmQoYi5zdHlsZSx7bWluSGVpZ2h0OlwiMTAwcHhcIixoZWlnaHQ6XCJhdXRvXCIscGFkZGluZzowLGJvcmRlcldpZHRoOjB9KTtjLnN1cHBvcnQubWluSGVpZ2h0PWIub2Zmc2V0SGVpZ2h0PT09MTAwO2Muc3VwcG9ydC5zZWxlY3RzdGFydD1cIm9uc2VsZWN0c3RhcnRcImluIGI7YS5yZW1vdmVDaGlsZChiKS5zdHlsZS5kaXNwbGF5PVwibm9uZVwifSk7Yy5leHRlbmQoYy51aSx7cGx1Z2luOnthZGQ6ZnVuY3Rpb24oYSxiLGQpe2E9Yy51aVthXS5wcm90b3R5cGU7Zm9yKHZhciBlIGluIGQpe2EucGx1Z2luc1tlXT1hLnBsdWdpbnNbZV18fFtdO2EucGx1Z2luc1tlXS5wdXNoKFtiLGRbZV1dKX19LGNhbGw6ZnVuY3Rpb24oYSxiLGQpe2lmKChiPWEucGx1Z2luc1tiXSkmJmEuZWxlbWVudFswXS5wYXJlbnROb2RlKWZvcih2YXIgZT0wO2U8Yi5sZW5ndGg7ZSsrKWEub3B0aW9uc1tiW2VdWzBdXSYmXG5iW2VdWzFdLmFwcGx5KGEuZWxlbWVudCxkKX19LGNvbnRhaW5zOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGRvY3VtZW50LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uP2EuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYikmMTY6YSE9PWImJmEuY29udGFpbnMoYil9LGhhc1Njcm9sbDpmdW5jdGlvbihhLGIpe2lmKGMoYSkuY3NzKFwib3ZlcmZsb3dcIik9PT1cImhpZGRlblwiKXJldHVybiBmYWxzZTtiPWImJmI9PT1cImxlZnRcIj9cInNjcm9sbExlZnRcIjpcInNjcm9sbFRvcFwiO3ZhciBkPWZhbHNlO2lmKGFbYl0+MClyZXR1cm4gdHJ1ZTthW2JdPTE7ZD1hW2JdPjA7YVtiXT0wO3JldHVybiBkfSxpc092ZXJBeGlzOmZ1bmN0aW9uKGEsYixkKXtyZXR1cm4gYT5iJiZhPGIrZH0saXNPdmVyOmZ1bmN0aW9uKGEsYixkLGUsaCxpKXtyZXR1cm4gYy51aS5pc092ZXJBeGlzKGEsZCxoKSYmYy51aS5pc092ZXJBeGlzKGIsZSxpKX19KX19KShqUXVlcnkpO1xuOyAvKiFcbiAqIE5vdGU6IFdoaWxlIE1pY3Jvc29mdCBpcyBub3QgdGhlIGF1dGhvciBvZiB0aGlzIGZpbGUsIE1pY3Jvc29mdCBpc1xuICogb2ZmZXJpbmcgeW91IGEgbGljZW5zZSBzdWJqZWN0IHRvIHRoZSB0ZXJtcyBvZiB0aGUgTWljcm9zb2Z0IFNvZnR3YXJlXG4gKiBMaWNlbnNlIFRlcm1zIGZvciBNaWNyb3NvZnQgQVNQLk5FVCBNb2RlbCBWaWV3IENvbnRyb2xsZXIgMy5cbiAqIE1pY3Jvc29mdCByZXNlcnZlcyBhbGwgb3RoZXIgcmlnaHRzLiBUaGUgbm90aWNlcyBiZWxvdyBhcmUgcHJvdmlkZWRcbiAqIGZvciBpbmZvcm1hdGlvbmFsIHB1cnBvc2VzIG9ubHkgYW5kIGFyZSBub3QgdGhlIGxpY2Vuc2UgdGVybXMgdW5kZXJcbiAqIHdoaWNoIE1pY3Jvc29mdCBkaXN0cmlidXRlZCB0aGlzIGZpbGUuXG4gKlxuICogalF1ZXJ5IFVJIFdpZGdldCAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXFxcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL1dpZGdldFxuICovXG4oZnVuY3Rpb24oYixqKXtpZihiLmNsZWFuRGF0YSl7dmFyIGs9Yi5jbGVhbkRhdGE7Yi5jbGVhbkRhdGE9ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPTAsZDsoZD1hW2NdKSE9bnVsbDtjKyspYihkKS50cmlnZ2VySGFuZGxlcihcInJlbW92ZVwiKTtrKGEpfX1lbHNle3ZhciBsPWIuZm4ucmVtb3ZlO2IuZm4ucmVtb3ZlPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2lmKCFjKWlmKCFhfHxiLmZpbHRlcihhLFt0aGlzXSkubGVuZ3RoKWIoXCIqXCIsdGhpcykuYWRkKFt0aGlzXSkuZWFjaChmdW5jdGlvbigpe2IodGhpcykudHJpZ2dlckhhbmRsZXIoXCJyZW1vdmVcIil9KTtyZXR1cm4gbC5jYWxsKGIodGhpcyksYSxjKX0pfX1iLndpZGdldD1mdW5jdGlvbihhLGMsZCl7dmFyIGU9YS5zcGxpdChcIi5cIilbMF0sZjthPWEuc3BsaXQoXCIuXCIpWzFdO2Y9ZStcIi1cIithO2lmKCFkKXtkPWM7Yz1iLldpZGdldH1iLmV4cHJbXCI6XCJdW2ZdPWZ1bmN0aW9uKGgpe3JldHVybiEhYi5kYXRhKGgsXG5hKX07YltlXT1iW2VdfHx7fTtiW2VdW2FdPWZ1bmN0aW9uKGgsZyl7YXJndW1lbnRzLmxlbmd0aCYmdGhpcy5fY3JlYXRlV2lkZ2V0KGgsZyl9O2M9bmV3IGM7Yy5vcHRpb25zPWIuZXh0ZW5kKHRydWUse30sYy5vcHRpb25zKTtiW2VdW2FdLnByb3RvdHlwZT1iLmV4dGVuZCh0cnVlLGMse25hbWVzcGFjZTplLHdpZGdldE5hbWU6YSx3aWRnZXRFdmVudFByZWZpeDpiW2VdW2FdLnByb3RvdHlwZS53aWRnZXRFdmVudFByZWZpeHx8YSx3aWRnZXRCYXNlQ2xhc3M6Zn0sZCk7Yi53aWRnZXQuYnJpZGdlKGEsYltlXVthXSl9O2Iud2lkZ2V0LmJyaWRnZT1mdW5jdGlvbihhLGMpe2IuZm5bYV09ZnVuY3Rpb24oZCl7dmFyIGU9dHlwZW9mIGQ9PT1cInN0cmluZ1wiLGY9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLGg9dGhpcztkPSFlJiZmLmxlbmd0aD9iLmV4dGVuZC5hcHBseShudWxsLFt0cnVlLGRdLmNvbmNhdChmKSk6ZDtpZihlJiZkLmNoYXJBdCgwKT09PVwiX1wiKXJldHVybiBoO1xuZT90aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgZz1iLmRhdGEodGhpcyxhKSxpPWcmJmIuaXNGdW5jdGlvbihnW2RdKT9nW2RdLmFwcGx5KGcsZik6ZztpZihpIT09ZyYmaSE9PWope2g9aTtyZXR1cm4gZmFsc2V9fSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGc9Yi5kYXRhKHRoaXMsYSk7Zz9nLm9wdGlvbihkfHx7fSkuX2luaXQoKTpiLmRhdGEodGhpcyxhLG5ldyBjKGQsdGhpcykpfSk7cmV0dXJuIGh9fTtiLldpZGdldD1mdW5jdGlvbihhLGMpe2FyZ3VtZW50cy5sZW5ndGgmJnRoaXMuX2NyZWF0ZVdpZGdldChhLGMpfTtiLldpZGdldC5wcm90b3R5cGU9e3dpZGdldE5hbWU6XCJ3aWRnZXRcIix3aWRnZXRFdmVudFByZWZpeDpcIlwiLG9wdGlvbnM6e2Rpc2FibGVkOmZhbHNlfSxfY3JlYXRlV2lkZ2V0OmZ1bmN0aW9uKGEsYyl7Yi5kYXRhKGMsdGhpcy53aWRnZXROYW1lLHRoaXMpO3RoaXMuZWxlbWVudD1iKGMpO3RoaXMub3B0aW9ucz1iLmV4dGVuZCh0cnVlLHt9LHRoaXMub3B0aW9ucyxcbnRoaXMuX2dldENyZWF0ZU9wdGlvbnMoKSxhKTt2YXIgZD10aGlzO3RoaXMuZWxlbWVudC5iaW5kKFwicmVtb3ZlLlwiK3RoaXMud2lkZ2V0TmFtZSxmdW5jdGlvbigpe2QuZGVzdHJveSgpfSk7dGhpcy5fY3JlYXRlKCk7dGhpcy5fdHJpZ2dlcihcImNyZWF0ZVwiKTt0aGlzLl9pbml0KCl9LF9nZXRDcmVhdGVPcHRpb25zOmZ1bmN0aW9uKCl7cmV0dXJuIGIubWV0YWRhdGEmJmIubWV0YWRhdGEuZ2V0KHRoaXMuZWxlbWVudFswXSlbdGhpcy53aWRnZXROYW1lXX0sX2NyZWF0ZTpmdW5jdGlvbigpe30sX2luaXQ6ZnVuY3Rpb24oKXt9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQudW5iaW5kKFwiLlwiK3RoaXMud2lkZ2V0TmFtZSkucmVtb3ZlRGF0YSh0aGlzLndpZGdldE5hbWUpO3RoaXMud2lkZ2V0KCkudW5iaW5kKFwiLlwiK3RoaXMud2lkZ2V0TmFtZSkucmVtb3ZlQXR0cihcImFyaWEtZGlzYWJsZWRcIikucmVtb3ZlQ2xhc3ModGhpcy53aWRnZXRCYXNlQ2xhc3MrXCItZGlzYWJsZWQgdWktc3RhdGUtZGlzYWJsZWRcIil9LFxud2lkZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudH0sb3B0aW9uOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9YTtpZihhcmd1bWVudHMubGVuZ3RoPT09MClyZXR1cm4gYi5leHRlbmQoe30sdGhpcy5vcHRpb25zKTtpZih0eXBlb2YgYT09PVwic3RyaW5nXCIpe2lmKGM9PT1qKXJldHVybiB0aGlzLm9wdGlvbnNbYV07ZD17fTtkW2FdPWN9dGhpcy5fc2V0T3B0aW9ucyhkKTtyZXR1cm4gdGhpc30sX3NldE9wdGlvbnM6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcztiLmVhY2goYSxmdW5jdGlvbihkLGUpe2MuX3NldE9wdGlvbihkLGUpfSk7cmV0dXJuIHRoaXN9LF9zZXRPcHRpb246ZnVuY3Rpb24oYSxjKXt0aGlzLm9wdGlvbnNbYV09YztpZihhPT09XCJkaXNhYmxlZFwiKXRoaXMud2lkZ2V0KClbYz9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXSh0aGlzLndpZGdldEJhc2VDbGFzcytcIi1kaXNhYmxlZCB1aS1zdGF0ZS1kaXNhYmxlZFwiKS5hdHRyKFwiYXJpYS1kaXNhYmxlZFwiLGMpO3JldHVybiB0aGlzfSxcbmVuYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zZXRPcHRpb24oXCJkaXNhYmxlZFwiLGZhbHNlKX0sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zZXRPcHRpb24oXCJkaXNhYmxlZFwiLHRydWUpfSxfdHJpZ2dlcjpmdW5jdGlvbihhLGMsZCl7dmFyIGU9dGhpcy5vcHRpb25zW2FdO2M9Yi5FdmVudChjKTtjLnR5cGU9KGE9PT10aGlzLndpZGdldEV2ZW50UHJlZml4P2E6dGhpcy53aWRnZXRFdmVudFByZWZpeCthKS50b0xvd2VyQ2FzZSgpO2Q9ZHx8e307aWYoYy5vcmlnaW5hbEV2ZW50KXthPWIuZXZlbnQucHJvcHMubGVuZ3RoO2Zvcih2YXIgZjthOyl7Zj1iLmV2ZW50LnByb3BzWy0tYV07Y1tmXT1jLm9yaWdpbmFsRXZlbnRbZl19fXRoaXMuZWxlbWVudC50cmlnZ2VyKGMsZCk7cmV0dXJuIShiLmlzRnVuY3Rpb24oZSkmJmUuY2FsbCh0aGlzLmVsZW1lbnRbMF0sYyxkKT09PWZhbHNlfHxjLmlzRGVmYXVsdFByZXZlbnRlZCgpKX19fSkoalF1ZXJ5KTtcbjsgLyohXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBNb3VzZSAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXFxcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL01vdXNlXG4gKlxuICogRGVwZW5kczpcbiAqXHRqcXVlcnkudWkud2lkZ2V0LmpzXG4gKi9cbihmdW5jdGlvbihiKXtiLndpZGdldChcInVpLm1vdXNlXCIse29wdGlvbnM6e2NhbmNlbDpcIjppbnB1dCxvcHRpb25cIixkaXN0YW5jZToxLGRlbGF5OjB9LF9tb3VzZUluaXQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3RoaXMuZWxlbWVudC5iaW5kKFwibW91c2Vkb3duLlwiK3RoaXMud2lkZ2V0TmFtZSxmdW5jdGlvbihjKXtyZXR1cm4gYS5fbW91c2VEb3duKGMpfSkuYmluZChcImNsaWNrLlwiK3RoaXMud2lkZ2V0TmFtZSxmdW5jdGlvbihjKXtpZih0cnVlPT09Yi5kYXRhKGMudGFyZ2V0LGEud2lkZ2V0TmFtZStcIi5wcmV2ZW50Q2xpY2tFdmVudFwiKSl7Yi5yZW1vdmVEYXRhKGMudGFyZ2V0LGEud2lkZ2V0TmFtZStcIi5wcmV2ZW50Q2xpY2tFdmVudFwiKTtjLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO3JldHVybiBmYWxzZX19KTt0aGlzLnN0YXJ0ZWQ9ZmFsc2V9LF9tb3VzZURlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQudW5iaW5kKFwiLlwiK3RoaXMud2lkZ2V0TmFtZSl9LF9tb3VzZURvd246ZnVuY3Rpb24oYSl7YS5vcmlnaW5hbEV2ZW50PVxuYS5vcmlnaW5hbEV2ZW50fHx7fTtpZighYS5vcmlnaW5hbEV2ZW50Lm1vdXNlSGFuZGxlZCl7dGhpcy5fbW91c2VTdGFydGVkJiZ0aGlzLl9tb3VzZVVwKGEpO3RoaXMuX21vdXNlRG93bkV2ZW50PWE7dmFyIGM9dGhpcyxlPWEud2hpY2g9PTEsZj10eXBlb2YgdGhpcy5vcHRpb25zLmNhbmNlbD09XCJzdHJpbmdcIj9iKGEudGFyZ2V0KS5wYXJlbnRzKCkuYWRkKGEudGFyZ2V0KS5maWx0ZXIodGhpcy5vcHRpb25zLmNhbmNlbCkubGVuZ3RoOmZhbHNlO2lmKCFlfHxmfHwhdGhpcy5fbW91c2VDYXB0dXJlKGEpKXJldHVybiB0cnVlO3RoaXMubW91c2VEZWxheU1ldD0hdGhpcy5vcHRpb25zLmRlbGF5O2lmKCF0aGlzLm1vdXNlRGVsYXlNZXQpdGhpcy5fbW91c2VEZWxheVRpbWVyPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtjLm1vdXNlRGVsYXlNZXQ9dHJ1ZX0sdGhpcy5vcHRpb25zLmRlbGF5KTtpZih0aGlzLl9tb3VzZURpc3RhbmNlTWV0KGEpJiZ0aGlzLl9tb3VzZURlbGF5TWV0KGEpKXt0aGlzLl9tb3VzZVN0YXJ0ZWQ9XG50aGlzLl9tb3VzZVN0YXJ0KGEpIT09ZmFsc2U7aWYoIXRoaXMuX21vdXNlU3RhcnRlZCl7YS5wcmV2ZW50RGVmYXVsdCgpO3JldHVybiB0cnVlfX10cnVlPT09Yi5kYXRhKGEudGFyZ2V0LHRoaXMud2lkZ2V0TmFtZStcIi5wcmV2ZW50Q2xpY2tFdmVudFwiKSYmYi5yZW1vdmVEYXRhKGEudGFyZ2V0LHRoaXMud2lkZ2V0TmFtZStcIi5wcmV2ZW50Q2xpY2tFdmVudFwiKTt0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZT1mdW5jdGlvbihkKXtyZXR1cm4gYy5fbW91c2VNb3ZlKGQpfTt0aGlzLl9tb3VzZVVwRGVsZWdhdGU9ZnVuY3Rpb24oZCl7cmV0dXJuIGMuX21vdXNlVXAoZCl9O2IoZG9jdW1lbnQpLmJpbmQoXCJtb3VzZW1vdmUuXCIrdGhpcy53aWRnZXROYW1lLHRoaXMuX21vdXNlTW92ZURlbGVnYXRlKS5iaW5kKFwibW91c2V1cC5cIit0aGlzLndpZGdldE5hbWUsdGhpcy5fbW91c2VVcERlbGVnYXRlKTthLnByZXZlbnREZWZhdWx0KCk7cmV0dXJuIGEub3JpZ2luYWxFdmVudC5tb3VzZUhhbmRsZWQ9XG50cnVlfX0sX21vdXNlTW92ZTpmdW5jdGlvbihhKXtpZihiLmJyb3dzZXIubXNpZSYmIShkb2N1bWVudC5kb2N1bWVudE1vZGU+PTkpJiYhYS5idXR0b24pcmV0dXJuIHRoaXMuX21vdXNlVXAoYSk7aWYodGhpcy5fbW91c2VTdGFydGVkKXt0aGlzLl9tb3VzZURyYWcoYSk7cmV0dXJuIGEucHJldmVudERlZmF1bHQoKX1pZih0aGlzLl9tb3VzZURpc3RhbmNlTWV0KGEpJiZ0aGlzLl9tb3VzZURlbGF5TWV0KGEpKSh0aGlzLl9tb3VzZVN0YXJ0ZWQ9dGhpcy5fbW91c2VTdGFydCh0aGlzLl9tb3VzZURvd25FdmVudCxhKSE9PWZhbHNlKT90aGlzLl9tb3VzZURyYWcoYSk6dGhpcy5fbW91c2VVcChhKTtyZXR1cm4hdGhpcy5fbW91c2VTdGFydGVkfSxfbW91c2VVcDpmdW5jdGlvbihhKXtiKGRvY3VtZW50KS51bmJpbmQoXCJtb3VzZW1vdmUuXCIrdGhpcy53aWRnZXROYW1lLHRoaXMuX21vdXNlTW92ZURlbGVnYXRlKS51bmJpbmQoXCJtb3VzZXVwLlwiK3RoaXMud2lkZ2V0TmFtZSx0aGlzLl9tb3VzZVVwRGVsZWdhdGUpO1xuaWYodGhpcy5fbW91c2VTdGFydGVkKXt0aGlzLl9tb3VzZVN0YXJ0ZWQ9ZmFsc2U7YS50YXJnZXQ9PXRoaXMuX21vdXNlRG93bkV2ZW50LnRhcmdldCYmYi5kYXRhKGEudGFyZ2V0LHRoaXMud2lkZ2V0TmFtZStcIi5wcmV2ZW50Q2xpY2tFdmVudFwiLHRydWUpO3RoaXMuX21vdXNlU3RvcChhKX1yZXR1cm4gZmFsc2V9LF9tb3VzZURpc3RhbmNlTWV0OmZ1bmN0aW9uKGEpe3JldHVybiBNYXRoLm1heChNYXRoLmFicyh0aGlzLl9tb3VzZURvd25FdmVudC5wYWdlWC1hLnBhZ2VYKSxNYXRoLmFicyh0aGlzLl9tb3VzZURvd25FdmVudC5wYWdlWS1hLnBhZ2VZKSk+PXRoaXMub3B0aW9ucy5kaXN0YW5jZX0sX21vdXNlRGVsYXlNZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb3VzZURlbGF5TWV0fSxfbW91c2VTdGFydDpmdW5jdGlvbigpe30sX21vdXNlRHJhZzpmdW5jdGlvbigpe30sX21vdXNlU3RvcDpmdW5jdGlvbigpe30sX21vdXNlQ2FwdHVyZTpmdW5jdGlvbigpe3JldHVybiB0cnVlfX0pfSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgUG9zaXRpb24gMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvUG9zaXRpb25cbiAqL1xuKGZ1bmN0aW9uKGMpe2MudWk9Yy51aXx8e307dmFyIG49L2xlZnR8Y2VudGVyfHJpZ2h0LyxvPS90b3B8Y2VudGVyfGJvdHRvbS8sdD1jLmZuLnBvc2l0aW9uLHU9Yy5mbi5vZmZzZXQ7Yy5mbi5wb3NpdGlvbj1mdW5jdGlvbihiKXtpZighYnx8IWIub2YpcmV0dXJuIHQuYXBwbHkodGhpcyxhcmd1bWVudHMpO2I9Yy5leHRlbmQoe30sYik7dmFyIGE9YyhiLm9mKSxkPWFbMF0sZz0oYi5jb2xsaXNpb258fFwiZmxpcFwiKS5zcGxpdChcIiBcIiksZT1iLm9mZnNldD9iLm9mZnNldC5zcGxpdChcIiBcIik6WzAsMF0saCxrLGo7aWYoZC5ub2RlVHlwZT09PTkpe2g9YS53aWR0aCgpO2s9YS5oZWlnaHQoKTtqPXt0b3A6MCxsZWZ0OjB9fWVsc2UgaWYoZC5zZXRUaW1lb3V0KXtoPWEud2lkdGgoKTtrPWEuaGVpZ2h0KCk7aj17dG9wOmEuc2Nyb2xsVG9wKCksbGVmdDphLnNjcm9sbExlZnQoKX19ZWxzZSBpZihkLnByZXZlbnREZWZhdWx0KXtiLmF0PVwibGVmdCB0b3BcIjtoPWs9MDtqPXt0b3A6Yi5vZi5wYWdlWSxcbmxlZnQ6Yi5vZi5wYWdlWH19ZWxzZXtoPWEub3V0ZXJXaWR0aCgpO2s9YS5vdXRlckhlaWdodCgpO2o9YS5vZmZzZXQoKX1jLmVhY2goW1wibXlcIixcImF0XCJdLGZ1bmN0aW9uKCl7dmFyIGY9KGJbdGhpc118fFwiXCIpLnNwbGl0KFwiIFwiKTtpZihmLmxlbmd0aD09PTEpZj1uLnRlc3QoZlswXSk/Zi5jb25jYXQoW1wiY2VudGVyXCJdKTpvLnRlc3QoZlswXSk/W1wiY2VudGVyXCJdLmNvbmNhdChmKTpbXCJjZW50ZXJcIixcImNlbnRlclwiXTtmWzBdPW4udGVzdChmWzBdKT9mWzBdOlwiY2VudGVyXCI7ZlsxXT1vLnRlc3QoZlsxXSk/ZlsxXTpcImNlbnRlclwiO2JbdGhpc109Zn0pO2lmKGcubGVuZ3RoPT09MSlnWzFdPWdbMF07ZVswXT1wYXJzZUludChlWzBdLDEwKXx8MDtpZihlLmxlbmd0aD09PTEpZVsxXT1lWzBdO2VbMV09cGFyc2VJbnQoZVsxXSwxMCl8fDA7aWYoYi5hdFswXT09PVwicmlnaHRcIilqLmxlZnQrPWg7ZWxzZSBpZihiLmF0WzBdPT09XCJjZW50ZXJcIilqLmxlZnQrPWgvMjtpZihiLmF0WzFdPT09XCJib3R0b21cIilqLnRvcCs9XG5rO2Vsc2UgaWYoYi5hdFsxXT09PVwiY2VudGVyXCIpai50b3ArPWsvMjtqLmxlZnQrPWVbMF07ai50b3ArPWVbMV07cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBmPWModGhpcyksbD1mLm91dGVyV2lkdGgoKSxtPWYub3V0ZXJIZWlnaHQoKSxwPXBhcnNlSW50KGMuY3VyQ1NTKHRoaXMsXCJtYXJnaW5MZWZ0XCIsdHJ1ZSkpfHwwLHE9cGFyc2VJbnQoYy5jdXJDU1ModGhpcyxcIm1hcmdpblRvcFwiLHRydWUpKXx8MCx2PWwrcCsocGFyc2VJbnQoYy5jdXJDU1ModGhpcyxcIm1hcmdpblJpZ2h0XCIsdHJ1ZSkpfHwwKSx3PW0rcSsocGFyc2VJbnQoYy5jdXJDU1ModGhpcyxcIm1hcmdpbkJvdHRvbVwiLHRydWUpKXx8MCksaT1jLmV4dGVuZCh7fSxqKSxyO2lmKGIubXlbMF09PT1cInJpZ2h0XCIpaS5sZWZ0LT1sO2Vsc2UgaWYoYi5teVswXT09PVwiY2VudGVyXCIpaS5sZWZ0LT1sLzI7aWYoYi5teVsxXT09PVwiYm90dG9tXCIpaS50b3AtPW07ZWxzZSBpZihiLm15WzFdPT09XCJjZW50ZXJcIilpLnRvcC09XG5tLzI7aS5sZWZ0PU1hdGgucm91bmQoaS5sZWZ0KTtpLnRvcD1NYXRoLnJvdW5kKGkudG9wKTtyPXtsZWZ0OmkubGVmdC1wLHRvcDppLnRvcC1xfTtjLmVhY2goW1wibGVmdFwiLFwidG9wXCJdLGZ1bmN0aW9uKHMseCl7Yy51aS5wb3NpdGlvbltnW3NdXSYmYy51aS5wb3NpdGlvbltnW3NdXVt4XShpLHt0YXJnZXRXaWR0aDpoLHRhcmdldEhlaWdodDprLGVsZW1XaWR0aDpsLGVsZW1IZWlnaHQ6bSxjb2xsaXNpb25Qb3NpdGlvbjpyLGNvbGxpc2lvbldpZHRoOnYsY29sbGlzaW9uSGVpZ2h0Oncsb2Zmc2V0OmUsbXk6Yi5teSxhdDpiLmF0fSl9KTtjLmZuLmJnaWZyYW1lJiZmLmJnaWZyYW1lKCk7Zi5vZmZzZXQoYy5leHRlbmQoaSx7dXNpbmc6Yi51c2luZ30pKX0pfTtjLnVpLnBvc2l0aW9uPXtmaXQ6e2xlZnQ6ZnVuY3Rpb24oYixhKXt2YXIgZD1jKHdpbmRvdyk7ZD1hLmNvbGxpc2lvblBvc2l0aW9uLmxlZnQrYS5jb2xsaXNpb25XaWR0aC1kLndpZHRoKCktZC5zY3JvbGxMZWZ0KCk7Yi5sZWZ0PVxuZD4wP2IubGVmdC1kOk1hdGgubWF4KGIubGVmdC1hLmNvbGxpc2lvblBvc2l0aW9uLmxlZnQsYi5sZWZ0KX0sdG9wOmZ1bmN0aW9uKGIsYSl7dmFyIGQ9Yyh3aW5kb3cpO2Q9YS5jb2xsaXNpb25Qb3NpdGlvbi50b3ArYS5jb2xsaXNpb25IZWlnaHQtZC5oZWlnaHQoKS1kLnNjcm9sbFRvcCgpO2IudG9wPWQ+MD9iLnRvcC1kOk1hdGgubWF4KGIudG9wLWEuY29sbGlzaW9uUG9zaXRpb24udG9wLGIudG9wKX19LGZsaXA6e2xlZnQ6ZnVuY3Rpb24oYixhKXtpZihhLmF0WzBdIT09XCJjZW50ZXJcIil7dmFyIGQ9Yyh3aW5kb3cpO2Q9YS5jb2xsaXNpb25Qb3NpdGlvbi5sZWZ0K2EuY29sbGlzaW9uV2lkdGgtZC53aWR0aCgpLWQuc2Nyb2xsTGVmdCgpO3ZhciBnPWEubXlbMF09PT1cImxlZnRcIj8tYS5lbGVtV2lkdGg6YS5teVswXT09PVwicmlnaHRcIj9hLmVsZW1XaWR0aDowLGU9YS5hdFswXT09PVwibGVmdFwiP2EudGFyZ2V0V2lkdGg6LWEudGFyZ2V0V2lkdGgsaD0tMiphLm9mZnNldFswXTtiLmxlZnQrPVxuYS5jb2xsaXNpb25Qb3NpdGlvbi5sZWZ0PDA/ZytlK2g6ZD4wP2crZStoOjB9fSx0b3A6ZnVuY3Rpb24oYixhKXtpZihhLmF0WzFdIT09XCJjZW50ZXJcIil7dmFyIGQ9Yyh3aW5kb3cpO2Q9YS5jb2xsaXNpb25Qb3NpdGlvbi50b3ArYS5jb2xsaXNpb25IZWlnaHQtZC5oZWlnaHQoKS1kLnNjcm9sbFRvcCgpO3ZhciBnPWEubXlbMV09PT1cInRvcFwiPy1hLmVsZW1IZWlnaHQ6YS5teVsxXT09PVwiYm90dG9tXCI/YS5lbGVtSGVpZ2h0OjAsZT1hLmF0WzFdPT09XCJ0b3BcIj9hLnRhcmdldEhlaWdodDotYS50YXJnZXRIZWlnaHQsaD0tMiphLm9mZnNldFsxXTtiLnRvcCs9YS5jb2xsaXNpb25Qb3NpdGlvbi50b3A8MD9nK2UraDpkPjA/ZytlK2g6MH19fX07aWYoIWMub2Zmc2V0LnNldE9mZnNldCl7Yy5vZmZzZXQuc2V0T2Zmc2V0PWZ1bmN0aW9uKGIsYSl7aWYoL3N0YXRpYy8udGVzdChjLmN1ckNTUyhiLFwicG9zaXRpb25cIikpKWIuc3R5bGUucG9zaXRpb249XCJyZWxhdGl2ZVwiO3ZhciBkPWMoYiksXG5nPWQub2Zmc2V0KCksZT1wYXJzZUludChjLmN1ckNTUyhiLFwidG9wXCIsdHJ1ZSksMTApfHwwLGg9cGFyc2VJbnQoYy5jdXJDU1MoYixcImxlZnRcIix0cnVlKSwxMCl8fDA7Zz17dG9wOmEudG9wLWcudG9wK2UsbGVmdDphLmxlZnQtZy5sZWZ0K2h9O1widXNpbmdcImluIGE/YS51c2luZy5jYWxsKGIsZyk6ZC5jc3MoZyl9O2MuZm4ub2Zmc2V0PWZ1bmN0aW9uKGIpe3ZhciBhPXRoaXNbMF07aWYoIWF8fCFhLm93bmVyRG9jdW1lbnQpcmV0dXJuIG51bGw7aWYoYilyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Yy5vZmZzZXQuc2V0T2Zmc2V0KHRoaXMsYil9KTtyZXR1cm4gdS5jYWxsKHRoaXMpfX19KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBEcmFnZ2FibGUgMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvRHJhZ2dhYmxlc1xuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LnVpLmNvcmUuanNcbiAqXHRqcXVlcnkudWkubW91c2UuanNcbiAqXHRqcXVlcnkudWkud2lkZ2V0LmpzXG4gKi9cbihmdW5jdGlvbihkKXtkLndpZGdldChcInVpLmRyYWdnYWJsZVwiLGQudWkubW91c2Use3dpZGdldEV2ZW50UHJlZml4OlwiZHJhZ1wiLG9wdGlvbnM6e2FkZENsYXNzZXM6dHJ1ZSxhcHBlbmRUbzpcInBhcmVudFwiLGF4aXM6ZmFsc2UsY29ubmVjdFRvU29ydGFibGU6ZmFsc2UsY29udGFpbm1lbnQ6ZmFsc2UsY3Vyc29yOlwiYXV0b1wiLGN1cnNvckF0OmZhbHNlLGdyaWQ6ZmFsc2UsaGFuZGxlOmZhbHNlLGhlbHBlcjpcIm9yaWdpbmFsXCIsaWZyYW1lRml4OmZhbHNlLG9wYWNpdHk6ZmFsc2UscmVmcmVzaFBvc2l0aW9uczpmYWxzZSxyZXZlcnQ6ZmFsc2UscmV2ZXJ0RHVyYXRpb246NTAwLHNjb3BlOlwiZGVmYXVsdFwiLHNjcm9sbDp0cnVlLHNjcm9sbFNlbnNpdGl2aXR5OjIwLHNjcm9sbFNwZWVkOjIwLHNuYXA6ZmFsc2Usc25hcE1vZGU6XCJib3RoXCIsc25hcFRvbGVyYW5jZToyMCxzdGFjazpmYWxzZSx6SW5kZXg6ZmFsc2V9LF9jcmVhdGU6ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMuaGVscGVyPT1cblwib3JpZ2luYWxcIiYmIS9eKD86cnxhfGYpLy50ZXN0KHRoaXMuZWxlbWVudC5jc3MoXCJwb3NpdGlvblwiKSkpdGhpcy5lbGVtZW50WzBdLnN0eWxlLnBvc2l0aW9uPVwicmVsYXRpdmVcIjt0aGlzLm9wdGlvbnMuYWRkQ2xhc3NlcyYmdGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktZHJhZ2dhYmxlXCIpO3RoaXMub3B0aW9ucy5kaXNhYmxlZCYmdGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktZHJhZ2dhYmxlLWRpc2FibGVkXCIpO3RoaXMuX21vdXNlSW5pdCgpfSxkZXN0cm95OmZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtZW50LmRhdGEoXCJkcmFnZ2FibGVcIikpe3RoaXMuZWxlbWVudC5yZW1vdmVEYXRhKFwiZHJhZ2dhYmxlXCIpLnVuYmluZChcIi5kcmFnZ2FibGVcIikucmVtb3ZlQ2xhc3MoXCJ1aS1kcmFnZ2FibGUgdWktZHJhZ2dhYmxlLWRyYWdnaW5nIHVpLWRyYWdnYWJsZS1kaXNhYmxlZFwiKTt0aGlzLl9tb3VzZURlc3Ryb3koKTtyZXR1cm4gdGhpc319LF9tb3VzZUNhcHR1cmU6ZnVuY3Rpb24oYSl7dmFyIGI9XG50aGlzLm9wdGlvbnM7aWYodGhpcy5oZWxwZXJ8fGIuZGlzYWJsZWR8fGQoYS50YXJnZXQpLmlzKFwiLnVpLXJlc2l6YWJsZS1oYW5kbGVcIikpcmV0dXJuIGZhbHNlO3RoaXMuaGFuZGxlPXRoaXMuX2dldEhhbmRsZShhKTtpZighdGhpcy5oYW5kbGUpcmV0dXJuIGZhbHNlO3JldHVybiB0cnVlfSxfbW91c2VTdGFydDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnM7dGhpcy5oZWxwZXI9dGhpcy5fY3JlYXRlSGVscGVyKGEpO3RoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTtpZihkLnVpLmRkbWFuYWdlcilkLnVpLmRkbWFuYWdlci5jdXJyZW50PXRoaXM7dGhpcy5fY2FjaGVNYXJnaW5zKCk7dGhpcy5jc3NQb3NpdGlvbj10aGlzLmhlbHBlci5jc3MoXCJwb3NpdGlvblwiKTt0aGlzLnNjcm9sbFBhcmVudD10aGlzLmhlbHBlci5zY3JvbGxQYXJlbnQoKTt0aGlzLm9mZnNldD10aGlzLnBvc2l0aW9uQWJzPXRoaXMuZWxlbWVudC5vZmZzZXQoKTt0aGlzLm9mZnNldD17dG9wOnRoaXMub2Zmc2V0LnRvcC1cbnRoaXMubWFyZ2lucy50b3AsbGVmdDp0aGlzLm9mZnNldC5sZWZ0LXRoaXMubWFyZ2lucy5sZWZ0fTtkLmV4dGVuZCh0aGlzLm9mZnNldCx7Y2xpY2s6e2xlZnQ6YS5wYWdlWC10aGlzLm9mZnNldC5sZWZ0LHRvcDphLnBhZ2VZLXRoaXMub2Zmc2V0LnRvcH0scGFyZW50OnRoaXMuX2dldFBhcmVudE9mZnNldCgpLHJlbGF0aXZlOnRoaXMuX2dldFJlbGF0aXZlT2Zmc2V0KCl9KTt0aGlzLm9yaWdpbmFsUG9zaXRpb249dGhpcy5wb3NpdGlvbj10aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKGEpO3RoaXMub3JpZ2luYWxQYWdlWD1hLnBhZ2VYO3RoaXMub3JpZ2luYWxQYWdlWT1hLnBhZ2VZO2IuY3Vyc29yQXQmJnRoaXMuX2FkanVzdE9mZnNldEZyb21IZWxwZXIoYi5jdXJzb3JBdCk7Yi5jb250YWlubWVudCYmdGhpcy5fc2V0Q29udGFpbm1lbnQoKTtpZih0aGlzLl90cmlnZ2VyKFwic3RhcnRcIixhKT09PWZhbHNlKXt0aGlzLl9jbGVhcigpO3JldHVybiBmYWxzZX10aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7XG5kLnVpLmRkbWFuYWdlciYmIWIuZHJvcEJlaGF2aW91ciYmZC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHModGhpcyxhKTt0aGlzLmhlbHBlci5hZGRDbGFzcyhcInVpLWRyYWdnYWJsZS1kcmFnZ2luZ1wiKTt0aGlzLl9tb3VzZURyYWcoYSx0cnVlKTtyZXR1cm4gdHJ1ZX0sX21vdXNlRHJhZzpmdW5jdGlvbihhLGIpe3RoaXMucG9zaXRpb249dGhpcy5fZ2VuZXJhdGVQb3NpdGlvbihhKTt0aGlzLnBvc2l0aW9uQWJzPXRoaXMuX2NvbnZlcnRQb3NpdGlvblRvKFwiYWJzb2x1dGVcIik7aWYoIWIpe2I9dGhpcy5fdWlIYXNoKCk7aWYodGhpcy5fdHJpZ2dlcihcImRyYWdcIixhLGIpPT09ZmFsc2Upe3RoaXMuX21vdXNlVXAoe30pO3JldHVybiBmYWxzZX10aGlzLnBvc2l0aW9uPWIucG9zaXRpb259aWYoIXRoaXMub3B0aW9ucy5heGlzfHx0aGlzLm9wdGlvbnMuYXhpcyE9XCJ5XCIpdGhpcy5oZWxwZXJbMF0uc3R5bGUubGVmdD10aGlzLnBvc2l0aW9uLmxlZnQrXCJweFwiO2lmKCF0aGlzLm9wdGlvbnMuYXhpc3x8XG50aGlzLm9wdGlvbnMuYXhpcyE9XCJ4XCIpdGhpcy5oZWxwZXJbMF0uc3R5bGUudG9wPXRoaXMucG9zaXRpb24udG9wK1wicHhcIjtkLnVpLmRkbWFuYWdlciYmZC51aS5kZG1hbmFnZXIuZHJhZyh0aGlzLGEpO3JldHVybiBmYWxzZX0sX21vdXNlU3RvcDpmdW5jdGlvbihhKXt2YXIgYj1mYWxzZTtpZihkLnVpLmRkbWFuYWdlciYmIXRoaXMub3B0aW9ucy5kcm9wQmVoYXZpb3VyKWI9ZC51aS5kZG1hbmFnZXIuZHJvcCh0aGlzLGEpO2lmKHRoaXMuZHJvcHBlZCl7Yj10aGlzLmRyb3BwZWQ7dGhpcy5kcm9wcGVkPWZhbHNlfWlmKCghdGhpcy5lbGVtZW50WzBdfHwhdGhpcy5lbGVtZW50WzBdLnBhcmVudE5vZGUpJiZ0aGlzLm9wdGlvbnMuaGVscGVyPT1cIm9yaWdpbmFsXCIpcmV0dXJuIGZhbHNlO2lmKHRoaXMub3B0aW9ucy5yZXZlcnQ9PVwiaW52YWxpZFwiJiYhYnx8dGhpcy5vcHRpb25zLnJldmVydD09XCJ2YWxpZFwiJiZifHx0aGlzLm9wdGlvbnMucmV2ZXJ0PT09dHJ1ZXx8ZC5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy5yZXZlcnQpJiZcbnRoaXMub3B0aW9ucy5yZXZlcnQuY2FsbCh0aGlzLmVsZW1lbnQsYikpe3ZhciBjPXRoaXM7ZCh0aGlzLmhlbHBlcikuYW5pbWF0ZSh0aGlzLm9yaWdpbmFsUG9zaXRpb24scGFyc2VJbnQodGhpcy5vcHRpb25zLnJldmVydER1cmF0aW9uLDEwKSxmdW5jdGlvbigpe2MuX3RyaWdnZXIoXCJzdG9wXCIsYSkhPT1mYWxzZSYmYy5fY2xlYXIoKX0pfWVsc2UgdGhpcy5fdHJpZ2dlcihcInN0b3BcIixhKSE9PWZhbHNlJiZ0aGlzLl9jbGVhcigpO3JldHVybiBmYWxzZX0sY2FuY2VsOmZ1bmN0aW9uKCl7dGhpcy5oZWxwZXIuaXMoXCIudWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIpP3RoaXMuX21vdXNlVXAoe30pOnRoaXMuX2NsZWFyKCk7cmV0dXJuIHRoaXN9LF9nZXRIYW5kbGU6ZnVuY3Rpb24oYSl7dmFyIGI9IXRoaXMub3B0aW9ucy5oYW5kbGV8fCFkKHRoaXMub3B0aW9ucy5oYW5kbGUsdGhpcy5lbGVtZW50KS5sZW5ndGg/dHJ1ZTpmYWxzZTtkKHRoaXMub3B0aW9ucy5oYW5kbGUsdGhpcy5lbGVtZW50KS5maW5kKFwiKlwiKS5hbmRTZWxmKCkuZWFjaChmdW5jdGlvbigpe2lmKHRoaXM9PVxuYS50YXJnZXQpYj10cnVlfSk7cmV0dXJuIGJ9LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zO2E9ZC5pc0Z1bmN0aW9uKGIuaGVscGVyKT9kKGIuaGVscGVyLmFwcGx5KHRoaXMuZWxlbWVudFswXSxbYV0pKTpiLmhlbHBlcj09XCJjbG9uZVwiP3RoaXMuZWxlbWVudC5jbG9uZSgpOnRoaXMuZWxlbWVudDthLnBhcmVudHMoXCJib2R5XCIpLmxlbmd0aHx8YS5hcHBlbmRUbyhiLmFwcGVuZFRvPT1cInBhcmVudFwiP3RoaXMuZWxlbWVudFswXS5wYXJlbnROb2RlOmIuYXBwZW5kVG8pO2FbMF0hPXRoaXMuZWxlbWVudFswXSYmIS8oZml4ZWR8YWJzb2x1dGUpLy50ZXN0KGEuY3NzKFwicG9zaXRpb25cIikpJiZhLmNzcyhcInBvc2l0aW9uXCIsXCJhYnNvbHV0ZVwiKTtyZXR1cm4gYX0sX2FkanVzdE9mZnNldEZyb21IZWxwZXI6ZnVuY3Rpb24oYSl7aWYodHlwZW9mIGE9PVwic3RyaW5nXCIpYT1hLnNwbGl0KFwiIFwiKTtpZihkLmlzQXJyYXkoYSkpYT17bGVmdDorYVswXSx0b3A6K2FbMV18fFxuMH07aWYoXCJsZWZ0XCJpbiBhKXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ9YS5sZWZ0K3RoaXMubWFyZ2lucy5sZWZ0O2lmKFwicmlnaHRcImluIGEpdGhpcy5vZmZzZXQuY2xpY2subGVmdD10aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLWEucmlnaHQrdGhpcy5tYXJnaW5zLmxlZnQ7aWYoXCJ0b3BcImluIGEpdGhpcy5vZmZzZXQuY2xpY2sudG9wPWEudG9wK3RoaXMubWFyZ2lucy50b3A7aWYoXCJib3R0b21cImluIGEpdGhpcy5vZmZzZXQuY2xpY2sudG9wPXRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LWEuYm90dG9tK3RoaXMubWFyZ2lucy50b3B9LF9nZXRQYXJlbnRPZmZzZXQ6ZnVuY3Rpb24oKXt0aGlzLm9mZnNldFBhcmVudD10aGlzLmhlbHBlci5vZmZzZXRQYXJlbnQoKTt2YXIgYT10aGlzLm9mZnNldFBhcmVudC5vZmZzZXQoKTtpZih0aGlzLmNzc1Bvc2l0aW9uPT1cImFic29sdXRlXCImJnRoaXMuc2Nyb2xsUGFyZW50WzBdIT1kb2N1bWVudCYmZC51aS5jb250YWlucyh0aGlzLnNjcm9sbFBhcmVudFswXSxcbnRoaXMub2Zmc2V0UGFyZW50WzBdKSl7YS5sZWZ0Kz10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCk7YS50b3ArPXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpfWlmKHRoaXMub2Zmc2V0UGFyZW50WzBdPT1kb2N1bWVudC5ib2R5fHx0aGlzLm9mZnNldFBhcmVudFswXS50YWdOYW1lJiZ0aGlzLm9mZnNldFBhcmVudFswXS50YWdOYW1lLnRvTG93ZXJDYXNlKCk9PVwiaHRtbFwiJiZkLmJyb3dzZXIubXNpZSlhPXt0b3A6MCxsZWZ0OjB9O3JldHVybnt0b3A6YS50b3ArKHBhcnNlSW50KHRoaXMub2Zmc2V0UGFyZW50LmNzcyhcImJvcmRlclRvcFdpZHRoXCIpLDEwKXx8MCksbGVmdDphLmxlZnQrKHBhcnNlSW50KHRoaXMub2Zmc2V0UGFyZW50LmNzcyhcImJvcmRlckxlZnRXaWR0aFwiKSwxMCl8fDApfX0sX2dldFJlbGF0aXZlT2Zmc2V0OmZ1bmN0aW9uKCl7aWYodGhpcy5jc3NQb3NpdGlvbj09XCJyZWxhdGl2ZVwiKXt2YXIgYT10aGlzLmVsZW1lbnQucG9zaXRpb24oKTtyZXR1cm57dG9wOmEudG9wLVxuKHBhcnNlSW50KHRoaXMuaGVscGVyLmNzcyhcInRvcFwiKSwxMCl8fDApK3RoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpLGxlZnQ6YS5sZWZ0LShwYXJzZUludCh0aGlzLmhlbHBlci5jc3MoXCJsZWZ0XCIpLDEwKXx8MCkrdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpfX1lbHNlIHJldHVybnt0b3A6MCxsZWZ0OjB9fSxfY2FjaGVNYXJnaW5zOmZ1bmN0aW9uKCl7dGhpcy5tYXJnaW5zPXtsZWZ0OnBhcnNlSW50KHRoaXMuZWxlbWVudC5jc3MoXCJtYXJnaW5MZWZ0XCIpLDEwKXx8MCx0b3A6cGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcyhcIm1hcmdpblRvcFwiKSwxMCl8fDAscmlnaHQ6cGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcyhcIm1hcmdpblJpZ2h0XCIpLDEwKXx8MCxib3R0b206cGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcyhcIm1hcmdpbkJvdHRvbVwiKSwxMCl8fDB9fSxfY2FjaGVIZWxwZXJQcm9wb3J0aW9uczpmdW5jdGlvbigpe3RoaXMuaGVscGVyUHJvcG9ydGlvbnM9e3dpZHRoOnRoaXMuaGVscGVyLm91dGVyV2lkdGgoKSxcbmhlaWdodDp0aGlzLmhlbHBlci5vdXRlckhlaWdodCgpfX0sX3NldENvbnRhaW5tZW50OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zO2lmKGEuY29udGFpbm1lbnQ9PVwicGFyZW50XCIpYS5jb250YWlubWVudD10aGlzLmhlbHBlclswXS5wYXJlbnROb2RlO2lmKGEuY29udGFpbm1lbnQ9PVwiZG9jdW1lbnRcInx8YS5jb250YWlubWVudD09XCJ3aW5kb3dcIil0aGlzLmNvbnRhaW5tZW50PVsoYS5jb250YWlubWVudD09XCJkb2N1bWVudFwiPzA6ZCh3aW5kb3cpLnNjcm9sbExlZnQoKSktdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdC10aGlzLm9mZnNldC5wYXJlbnQubGVmdCwoYS5jb250YWlubWVudD09XCJkb2N1bWVudFwiPzA6ZCh3aW5kb3cpLnNjcm9sbFRvcCgpKS10aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AtdGhpcy5vZmZzZXQucGFyZW50LnRvcCwoYS5jb250YWlubWVudD09XCJkb2N1bWVudFwiPzA6ZCh3aW5kb3cpLnNjcm9sbExlZnQoKSkrZChhLmNvbnRhaW5tZW50PT1cImRvY3VtZW50XCI/XG5kb2N1bWVudDp3aW5kb3cpLndpZHRoKCktdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aC10aGlzLm1hcmdpbnMubGVmdCwoYS5jb250YWlubWVudD09XCJkb2N1bWVudFwiPzA6ZCh3aW5kb3cpLnNjcm9sbFRvcCgpKSsoZChhLmNvbnRhaW5tZW50PT1cImRvY3VtZW50XCI/ZG9jdW1lbnQ6d2luZG93KS5oZWlnaHQoKXx8ZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodCktdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQtdGhpcy5tYXJnaW5zLnRvcF07aWYoIS9eKGRvY3VtZW50fHdpbmRvd3xwYXJlbnQpJC8udGVzdChhLmNvbnRhaW5tZW50KSYmYS5jb250YWlubWVudC5jb25zdHJ1Y3RvciE9QXJyYXkpe3ZhciBiPWQoYS5jb250YWlubWVudClbMF07aWYoYil7YT1kKGEuY29udGFpbm1lbnQpLm9mZnNldCgpO3ZhciBjPWQoYikuY3NzKFwib3ZlcmZsb3dcIikhPVwiaGlkZGVuXCI7dGhpcy5jb250YWlubWVudD1bYS5sZWZ0KyhwYXJzZUludChkKGIpLmNzcyhcImJvcmRlckxlZnRXaWR0aFwiKSxcbjEwKXx8MCkrKHBhcnNlSW50KGQoYikuY3NzKFwicGFkZGluZ0xlZnRcIiksMTApfHwwKSxhLnRvcCsocGFyc2VJbnQoZChiKS5jc3MoXCJib3JkZXJUb3BXaWR0aFwiKSwxMCl8fDApKyhwYXJzZUludChkKGIpLmNzcyhcInBhZGRpbmdUb3BcIiksMTApfHwwKSxhLmxlZnQrKGM/TWF0aC5tYXgoYi5zY3JvbGxXaWR0aCxiLm9mZnNldFdpZHRoKTpiLm9mZnNldFdpZHRoKS0ocGFyc2VJbnQoZChiKS5jc3MoXCJib3JkZXJMZWZ0V2lkdGhcIiksMTApfHwwKS0ocGFyc2VJbnQoZChiKS5jc3MoXCJwYWRkaW5nUmlnaHRcIiksMTApfHwwKS10aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLXRoaXMubWFyZ2lucy5sZWZ0LXRoaXMubWFyZ2lucy5yaWdodCxhLnRvcCsoYz9NYXRoLm1heChiLnNjcm9sbEhlaWdodCxiLm9mZnNldEhlaWdodCk6Yi5vZmZzZXRIZWlnaHQpLShwYXJzZUludChkKGIpLmNzcyhcImJvcmRlclRvcFdpZHRoXCIpLDEwKXx8MCktKHBhcnNlSW50KGQoYikuY3NzKFwicGFkZGluZ0JvdHRvbVwiKSxcbjEwKXx8MCktdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQtdGhpcy5tYXJnaW5zLnRvcC10aGlzLm1hcmdpbnMuYm90dG9tXX19ZWxzZSBpZihhLmNvbnRhaW5tZW50LmNvbnN0cnVjdG9yPT1BcnJheSl0aGlzLmNvbnRhaW5tZW50PWEuY29udGFpbm1lbnR9LF9jb252ZXJ0UG9zaXRpb25UbzpmdW5jdGlvbihhLGIpe2lmKCFiKWI9dGhpcy5wb3NpdGlvbjthPWE9PVwiYWJzb2x1dGVcIj8xOi0xO3ZhciBjPXRoaXMuY3NzUG9zaXRpb249PVwiYWJzb2x1dGVcIiYmISh0aGlzLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmQudWkuY29udGFpbnModGhpcy5zY3JvbGxQYXJlbnRbMF0sdGhpcy5vZmZzZXRQYXJlbnRbMF0pKT90aGlzLm9mZnNldFBhcmVudDp0aGlzLnNjcm9sbFBhcmVudCxmPS8oaHRtbHxib2R5KS9pLnRlc3QoY1swXS50YWdOYW1lKTtyZXR1cm57dG9wOmIudG9wK3RoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCphK3RoaXMub2Zmc2V0LnBhcmVudC50b3AqYS0oZC5icm93c2VyLnNhZmFyaSYmXG5kLmJyb3dzZXIudmVyc2lvbjw1MjYmJnRoaXMuY3NzUG9zaXRpb249PVwiZml4ZWRcIj8wOih0aGlzLmNzc1Bvc2l0aW9uPT1cImZpeGVkXCI/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpOmY/MDpjLnNjcm9sbFRvcCgpKSphKSxsZWZ0OmIubGVmdCt0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0KmErdGhpcy5vZmZzZXQucGFyZW50LmxlZnQqYS0oZC5icm93c2VyLnNhZmFyaSYmZC5icm93c2VyLnZlcnNpb248NTI2JiZ0aGlzLmNzc1Bvc2l0aW9uPT1cImZpeGVkXCI/MDoodGhpcy5jc3NQb3NpdGlvbj09XCJmaXhlZFwiPy10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCk6Zj8wOmMuc2Nyb2xsTGVmdCgpKSphKX19LF9nZW5lcmF0ZVBvc2l0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPXRoaXMuY3NzUG9zaXRpb249PVwiYWJzb2x1dGVcIiYmISh0aGlzLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmQudWkuY29udGFpbnModGhpcy5zY3JvbGxQYXJlbnRbMF0sXG50aGlzLm9mZnNldFBhcmVudFswXSkpP3RoaXMub2Zmc2V0UGFyZW50OnRoaXMuc2Nyb2xsUGFyZW50LGY9LyhodG1sfGJvZHkpL2kudGVzdChjWzBdLnRhZ05hbWUpLGU9YS5wYWdlWCxnPWEucGFnZVk7aWYodGhpcy5vcmlnaW5hbFBvc2l0aW9uKXtpZih0aGlzLmNvbnRhaW5tZW50KXtpZihhLnBhZ2VYLXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ8dGhpcy5jb250YWlubWVudFswXSllPXRoaXMuY29udGFpbm1lbnRbMF0rdGhpcy5vZmZzZXQuY2xpY2subGVmdDtpZihhLnBhZ2VZLXRoaXMub2Zmc2V0LmNsaWNrLnRvcDx0aGlzLmNvbnRhaW5tZW50WzFdKWc9dGhpcy5jb250YWlubWVudFsxXSt0aGlzLm9mZnNldC5jbGljay50b3A7aWYoYS5wYWdlWC10aGlzLm9mZnNldC5jbGljay5sZWZ0PnRoaXMuY29udGFpbm1lbnRbMl0pZT10aGlzLmNvbnRhaW5tZW50WzJdK3RoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7aWYoYS5wYWdlWS10aGlzLm9mZnNldC5jbGljay50b3A+dGhpcy5jb250YWlubWVudFszXSlnPVxudGhpcy5jb250YWlubWVudFszXSt0aGlzLm9mZnNldC5jbGljay50b3B9aWYoYi5ncmlkKXtnPXRoaXMub3JpZ2luYWxQYWdlWStNYXRoLnJvdW5kKChnLXRoaXMub3JpZ2luYWxQYWdlWSkvYi5ncmlkWzFdKSpiLmdyaWRbMV07Zz10aGlzLmNvbnRhaW5tZW50PyEoZy10aGlzLm9mZnNldC5jbGljay50b3A8dGhpcy5jb250YWlubWVudFsxXXx8Zy10aGlzLm9mZnNldC5jbGljay50b3A+dGhpcy5jb250YWlubWVudFszXSk/ZzohKGctdGhpcy5vZmZzZXQuY2xpY2sudG9wPHRoaXMuY29udGFpbm1lbnRbMV0pP2ctYi5ncmlkWzFdOmcrYi5ncmlkWzFdOmc7ZT10aGlzLm9yaWdpbmFsUGFnZVgrTWF0aC5yb3VuZCgoZS10aGlzLm9yaWdpbmFsUGFnZVgpL2IuZ3JpZFswXSkqYi5ncmlkWzBdO2U9dGhpcy5jb250YWlubWVudD8hKGUtdGhpcy5vZmZzZXQuY2xpY2subGVmdDx0aGlzLmNvbnRhaW5tZW50WzBdfHxlLXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ+dGhpcy5jb250YWlubWVudFsyXSk/XG5lOiEoZS10aGlzLm9mZnNldC5jbGljay5sZWZ0PHRoaXMuY29udGFpbm1lbnRbMF0pP2UtYi5ncmlkWzBdOmUrYi5ncmlkWzBdOmV9fXJldHVybnt0b3A6Zy10aGlzLm9mZnNldC5jbGljay50b3AtdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wLXRoaXMub2Zmc2V0LnBhcmVudC50b3ArKGQuYnJvd3Nlci5zYWZhcmkmJmQuYnJvd3Nlci52ZXJzaW9uPDUyNiYmdGhpcy5jc3NQb3NpdGlvbj09XCJmaXhlZFwiPzA6dGhpcy5jc3NQb3NpdGlvbj09XCJmaXhlZFwiPy10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKTpmPzA6Yy5zY3JvbGxUb3AoKSksbGVmdDplLXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQtdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdC10aGlzLm9mZnNldC5wYXJlbnQubGVmdCsoZC5icm93c2VyLnNhZmFyaSYmZC5icm93c2VyLnZlcnNpb248NTI2JiZ0aGlzLmNzc1Bvc2l0aW9uPT1cImZpeGVkXCI/MDp0aGlzLmNzc1Bvc2l0aW9uPT1cImZpeGVkXCI/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKTpcbmY/MDpjLnNjcm9sbExlZnQoKSl9fSxfY2xlYXI6ZnVuY3Rpb24oKXt0aGlzLmhlbHBlci5yZW1vdmVDbGFzcyhcInVpLWRyYWdnYWJsZS1kcmFnZ2luZ1wiKTt0aGlzLmhlbHBlclswXSE9dGhpcy5lbGVtZW50WzBdJiYhdGhpcy5jYW5jZWxIZWxwZXJSZW1vdmFsJiZ0aGlzLmhlbHBlci5yZW1vdmUoKTt0aGlzLmhlbHBlcj1udWxsO3RoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbD1mYWxzZX0sX3RyaWdnZXI6ZnVuY3Rpb24oYSxiLGMpe2M9Y3x8dGhpcy5fdWlIYXNoKCk7ZC51aS5wbHVnaW4uY2FsbCh0aGlzLGEsW2IsY10pO2lmKGE9PVwiZHJhZ1wiKXRoaXMucG9zaXRpb25BYnM9dGhpcy5fY29udmVydFBvc2l0aW9uVG8oXCJhYnNvbHV0ZVwiKTtyZXR1cm4gZC5XaWRnZXQucHJvdG90eXBlLl90cmlnZ2VyLmNhbGwodGhpcyxhLGIsYyl9LHBsdWdpbnM6e30sX3VpSGFzaDpmdW5jdGlvbigpe3JldHVybntoZWxwZXI6dGhpcy5oZWxwZXIscG9zaXRpb246dGhpcy5wb3NpdGlvbixvcmlnaW5hbFBvc2l0aW9uOnRoaXMub3JpZ2luYWxQb3NpdGlvbixcbm9mZnNldDp0aGlzLnBvc2l0aW9uQWJzfX19KTtkLmV4dGVuZChkLnVpLmRyYWdnYWJsZSx7dmVyc2lvbjpcIjEuOC4xMVwifSk7ZC51aS5wbHVnaW4uYWRkKFwiZHJhZ2dhYmxlXCIsXCJjb25uZWN0VG9Tb3J0YWJsZVwiLHtzdGFydDpmdW5jdGlvbihhLGIpe3ZhciBjPWQodGhpcykuZGF0YShcImRyYWdnYWJsZVwiKSxmPWMub3B0aW9ucyxlPWQuZXh0ZW5kKHt9LGIse2l0ZW06Yy5lbGVtZW50fSk7Yy5zb3J0YWJsZXM9W107ZChmLmNvbm5lY3RUb1NvcnRhYmxlKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGc9ZC5kYXRhKHRoaXMsXCJzb3J0YWJsZVwiKTtpZihnJiYhZy5vcHRpb25zLmRpc2FibGVkKXtjLnNvcnRhYmxlcy5wdXNoKHtpbnN0YW5jZTpnLHNob3VsZFJldmVydDpnLm9wdGlvbnMucmV2ZXJ0fSk7Zy5yZWZyZXNoUG9zaXRpb25zKCk7Zy5fdHJpZ2dlcihcImFjdGl2YXRlXCIsYSxlKX19KX0sc3RvcDpmdW5jdGlvbihhLGIpe3ZhciBjPWQodGhpcykuZGF0YShcImRyYWdnYWJsZVwiKSxmPWQuZXh0ZW5kKHt9LFxuYix7aXRlbTpjLmVsZW1lbnR9KTtkLmVhY2goYy5zb3J0YWJsZXMsZnVuY3Rpb24oKXtpZih0aGlzLmluc3RhbmNlLmlzT3Zlcil7dGhpcy5pbnN0YW5jZS5pc092ZXI9MDtjLmNhbmNlbEhlbHBlclJlbW92YWw9dHJ1ZTt0aGlzLmluc3RhbmNlLmNhbmNlbEhlbHBlclJlbW92YWw9ZmFsc2U7aWYodGhpcy5zaG91bGRSZXZlcnQpdGhpcy5pbnN0YW5jZS5vcHRpb25zLnJldmVydD10cnVlO3RoaXMuaW5zdGFuY2UuX21vdXNlU3RvcChhKTt0aGlzLmluc3RhbmNlLm9wdGlvbnMuaGVscGVyPXRoaXMuaW5zdGFuY2Uub3B0aW9ucy5faGVscGVyO2Mub3B0aW9ucy5oZWxwZXI9PVwib3JpZ2luYWxcIiYmdGhpcy5pbnN0YW5jZS5jdXJyZW50SXRlbS5jc3Moe3RvcDpcImF1dG9cIixsZWZ0OlwiYXV0b1wifSl9ZWxzZXt0aGlzLmluc3RhbmNlLmNhbmNlbEhlbHBlclJlbW92YWw9ZmFsc2U7dGhpcy5pbnN0YW5jZS5fdHJpZ2dlcihcImRlYWN0aXZhdGVcIixhLGYpfX0pfSxkcmFnOmZ1bmN0aW9uKGEsYil7dmFyIGM9XG5kKHRoaXMpLmRhdGEoXCJkcmFnZ2FibGVcIiksZj10aGlzO2QuZWFjaChjLnNvcnRhYmxlcyxmdW5jdGlvbigpe3RoaXMuaW5zdGFuY2UucG9zaXRpb25BYnM9Yy5wb3NpdGlvbkFiczt0aGlzLmluc3RhbmNlLmhlbHBlclByb3BvcnRpb25zPWMuaGVscGVyUHJvcG9ydGlvbnM7dGhpcy5pbnN0YW5jZS5vZmZzZXQuY2xpY2s9Yy5vZmZzZXQuY2xpY2s7aWYodGhpcy5pbnN0YW5jZS5faW50ZXJzZWN0c1dpdGgodGhpcy5pbnN0YW5jZS5jb250YWluZXJDYWNoZSkpe2lmKCF0aGlzLmluc3RhbmNlLmlzT3Zlcil7dGhpcy5pbnN0YW5jZS5pc092ZXI9MTt0aGlzLmluc3RhbmNlLmN1cnJlbnRJdGVtPWQoZikuY2xvbmUoKS5hcHBlbmRUbyh0aGlzLmluc3RhbmNlLmVsZW1lbnQpLmRhdGEoXCJzb3J0YWJsZS1pdGVtXCIsdHJ1ZSk7dGhpcy5pbnN0YW5jZS5vcHRpb25zLl9oZWxwZXI9dGhpcy5pbnN0YW5jZS5vcHRpb25zLmhlbHBlcjt0aGlzLmluc3RhbmNlLm9wdGlvbnMuaGVscGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGIuaGVscGVyWzBdfTtcbmEudGFyZ2V0PXRoaXMuaW5zdGFuY2UuY3VycmVudEl0ZW1bMF07dGhpcy5pbnN0YW5jZS5fbW91c2VDYXB0dXJlKGEsdHJ1ZSk7dGhpcy5pbnN0YW5jZS5fbW91c2VTdGFydChhLHRydWUsdHJ1ZSk7dGhpcy5pbnN0YW5jZS5vZmZzZXQuY2xpY2sudG9wPWMub2Zmc2V0LmNsaWNrLnRvcDt0aGlzLmluc3RhbmNlLm9mZnNldC5jbGljay5sZWZ0PWMub2Zmc2V0LmNsaWNrLmxlZnQ7dGhpcy5pbnN0YW5jZS5vZmZzZXQucGFyZW50LmxlZnQtPWMub2Zmc2V0LnBhcmVudC5sZWZ0LXRoaXMuaW5zdGFuY2Uub2Zmc2V0LnBhcmVudC5sZWZ0O3RoaXMuaW5zdGFuY2Uub2Zmc2V0LnBhcmVudC50b3AtPWMub2Zmc2V0LnBhcmVudC50b3AtdGhpcy5pbnN0YW5jZS5vZmZzZXQucGFyZW50LnRvcDtjLl90cmlnZ2VyKFwidG9Tb3J0YWJsZVwiLGEpO2MuZHJvcHBlZD10aGlzLmluc3RhbmNlLmVsZW1lbnQ7Yy5jdXJyZW50SXRlbT1jLmVsZW1lbnQ7dGhpcy5pbnN0YW5jZS5mcm9tT3V0c2lkZT1jfXRoaXMuaW5zdGFuY2UuY3VycmVudEl0ZW0mJlxudGhpcy5pbnN0YW5jZS5fbW91c2VEcmFnKGEpfWVsc2UgaWYodGhpcy5pbnN0YW5jZS5pc092ZXIpe3RoaXMuaW5zdGFuY2UuaXNPdmVyPTA7dGhpcy5pbnN0YW5jZS5jYW5jZWxIZWxwZXJSZW1vdmFsPXRydWU7dGhpcy5pbnN0YW5jZS5vcHRpb25zLnJldmVydD1mYWxzZTt0aGlzLmluc3RhbmNlLl90cmlnZ2VyKFwib3V0XCIsYSx0aGlzLmluc3RhbmNlLl91aUhhc2godGhpcy5pbnN0YW5jZSkpO3RoaXMuaW5zdGFuY2UuX21vdXNlU3RvcChhLHRydWUpO3RoaXMuaW5zdGFuY2Uub3B0aW9ucy5oZWxwZXI9dGhpcy5pbnN0YW5jZS5vcHRpb25zLl9oZWxwZXI7dGhpcy5pbnN0YW5jZS5jdXJyZW50SXRlbS5yZW1vdmUoKTt0aGlzLmluc3RhbmNlLnBsYWNlaG9sZGVyJiZ0aGlzLmluc3RhbmNlLnBsYWNlaG9sZGVyLnJlbW92ZSgpO2MuX3RyaWdnZXIoXCJmcm9tU29ydGFibGVcIixhKTtjLmRyb3BwZWQ9ZmFsc2V9fSl9fSk7ZC51aS5wbHVnaW4uYWRkKFwiZHJhZ2dhYmxlXCIsXCJjdXJzb3JcIixcbntzdGFydDpmdW5jdGlvbigpe3ZhciBhPWQoXCJib2R5XCIpLGI9ZCh0aGlzKS5kYXRhKFwiZHJhZ2dhYmxlXCIpLm9wdGlvbnM7aWYoYS5jc3MoXCJjdXJzb3JcIikpYi5fY3Vyc29yPWEuY3NzKFwiY3Vyc29yXCIpO2EuY3NzKFwiY3Vyc29yXCIsYi5jdXJzb3IpfSxzdG9wOmZ1bmN0aW9uKCl7dmFyIGE9ZCh0aGlzKS5kYXRhKFwiZHJhZ2dhYmxlXCIpLm9wdGlvbnM7YS5fY3Vyc29yJiZkKFwiYm9keVwiKS5jc3MoXCJjdXJzb3JcIixhLl9jdXJzb3IpfX0pO2QudWkucGx1Z2luLmFkZChcImRyYWdnYWJsZVwiLFwiaWZyYW1lRml4XCIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCh0aGlzKS5kYXRhKFwiZHJhZ2dhYmxlXCIpLm9wdGlvbnM7ZChhLmlmcmFtZUZpeD09PXRydWU/XCJpZnJhbWVcIjphLmlmcmFtZUZpeCkuZWFjaChmdW5jdGlvbigpe2QoJzxkaXYgY2xhc3M9XCJ1aS1kcmFnZ2FibGUtaWZyYW1lRml4XCIgc3R5bGU9XCJiYWNrZ3JvdW5kOiAjZmZmO1wiPjwvZGl2PicpLmNzcyh7d2lkdGg6dGhpcy5vZmZzZXRXaWR0aCtcblwicHhcIixoZWlnaHQ6dGhpcy5vZmZzZXRIZWlnaHQrXCJweFwiLHBvc2l0aW9uOlwiYWJzb2x1dGVcIixvcGFjaXR5OlwiMC4wMDFcIix6SW5kZXg6MUUzfSkuY3NzKGQodGhpcykub2Zmc2V0KCkpLmFwcGVuZFRvKFwiYm9keVwiKX0pfSxzdG9wOmZ1bmN0aW9uKCl7ZChcImRpdi51aS1kcmFnZ2FibGUtaWZyYW1lRml4XCIpLmVhY2goZnVuY3Rpb24oKXt0aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcyl9KX19KTtkLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIixcIm9wYWNpdHlcIix7c3RhcnQ6ZnVuY3Rpb24oYSxiKXthPWQoYi5oZWxwZXIpO2I9ZCh0aGlzKS5kYXRhKFwiZHJhZ2dhYmxlXCIpLm9wdGlvbnM7aWYoYS5jc3MoXCJvcGFjaXR5XCIpKWIuX29wYWNpdHk9YS5jc3MoXCJvcGFjaXR5XCIpO2EuY3NzKFwib3BhY2l0eVwiLGIub3BhY2l0eSl9LHN0b3A6ZnVuY3Rpb24oYSxiKXthPWQodGhpcykuZGF0YShcImRyYWdnYWJsZVwiKS5vcHRpb25zO2EuX29wYWNpdHkmJmQoYi5oZWxwZXIpLmNzcyhcIm9wYWNpdHlcIixcbmEuX29wYWNpdHkpfX0pO2QudWkucGx1Z2luLmFkZChcImRyYWdnYWJsZVwiLFwic2Nyb2xsXCIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCh0aGlzKS5kYXRhKFwiZHJhZ2dhYmxlXCIpO2lmKGEuc2Nyb2xsUGFyZW50WzBdIT1kb2N1bWVudCYmYS5zY3JvbGxQYXJlbnRbMF0udGFnTmFtZSE9XCJIVE1MXCIpYS5vdmVyZmxvd09mZnNldD1hLnNjcm9sbFBhcmVudC5vZmZzZXQoKX0sZHJhZzpmdW5jdGlvbihhKXt2YXIgYj1kKHRoaXMpLmRhdGEoXCJkcmFnZ2FibGVcIiksYz1iLm9wdGlvbnMsZj1mYWxzZTtpZihiLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmIuc2Nyb2xsUGFyZW50WzBdLnRhZ05hbWUhPVwiSFRNTFwiKXtpZighYy5heGlzfHxjLmF4aXMhPVwieFwiKWlmKGIub3ZlcmZsb3dPZmZzZXQudG9wK2Iuc2Nyb2xsUGFyZW50WzBdLm9mZnNldEhlaWdodC1hLnBhZ2VZPGMuc2Nyb2xsU2Vuc2l0aXZpdHkpYi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wPWY9Yi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wK1xuYy5zY3JvbGxTcGVlZDtlbHNlIGlmKGEucGFnZVktYi5vdmVyZmxvd09mZnNldC50b3A8Yy5zY3JvbGxTZW5zaXRpdml0eSliLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3A9Zj1iLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3AtYy5zY3JvbGxTcGVlZDtpZighYy5heGlzfHxjLmF4aXMhPVwieVwiKWlmKGIub3ZlcmZsb3dPZmZzZXQubGVmdCtiLnNjcm9sbFBhcmVudFswXS5vZmZzZXRXaWR0aC1hLnBhZ2VYPGMuc2Nyb2xsU2Vuc2l0aXZpdHkpYi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdD1mPWIuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbExlZnQrYy5zY3JvbGxTcGVlZDtlbHNlIGlmKGEucGFnZVgtYi5vdmVyZmxvd09mZnNldC5sZWZ0PGMuc2Nyb2xsU2Vuc2l0aXZpdHkpYi5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdD1mPWIuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbExlZnQtYy5zY3JvbGxTcGVlZH1lbHNle2lmKCFjLmF4aXN8fGMuYXhpcyE9XCJ4XCIpaWYoYS5wYWdlWS1kKGRvY3VtZW50KS5zY3JvbGxUb3AoKTxcbmMuc2Nyb2xsU2Vuc2l0aXZpdHkpZj1kKGRvY3VtZW50KS5zY3JvbGxUb3AoZChkb2N1bWVudCkuc2Nyb2xsVG9wKCktYy5zY3JvbGxTcGVlZCk7ZWxzZSBpZihkKHdpbmRvdykuaGVpZ2h0KCktKGEucGFnZVktZChkb2N1bWVudCkuc2Nyb2xsVG9wKCkpPGMuc2Nyb2xsU2Vuc2l0aXZpdHkpZj1kKGRvY3VtZW50KS5zY3JvbGxUb3AoZChkb2N1bWVudCkuc2Nyb2xsVG9wKCkrYy5zY3JvbGxTcGVlZCk7aWYoIWMuYXhpc3x8Yy5heGlzIT1cInlcIilpZihhLnBhZ2VYLWQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKTxjLnNjcm9sbFNlbnNpdGl2aXR5KWY9ZChkb2N1bWVudCkuc2Nyb2xsTGVmdChkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCktYy5zY3JvbGxTcGVlZCk7ZWxzZSBpZihkKHdpbmRvdykud2lkdGgoKS0oYS5wYWdlWC1kKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCkpPGMuc2Nyb2xsU2Vuc2l0aXZpdHkpZj1kKGRvY3VtZW50KS5zY3JvbGxMZWZ0KGQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKStcbmMuc2Nyb2xsU3BlZWQpfWYhPT1mYWxzZSYmZC51aS5kZG1hbmFnZXImJiFjLmRyb3BCZWhhdmlvdXImJmQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKGIsYSl9fSk7ZC51aS5wbHVnaW4uYWRkKFwiZHJhZ2dhYmxlXCIsXCJzbmFwXCIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCh0aGlzKS5kYXRhKFwiZHJhZ2dhYmxlXCIpLGI9YS5vcHRpb25zO2Euc25hcEVsZW1lbnRzPVtdO2QoYi5zbmFwLmNvbnN0cnVjdG9yIT1TdHJpbmc/Yi5zbmFwLml0ZW1zfHxcIjpkYXRhKGRyYWdnYWJsZSlcIjpiLnNuYXApLmVhY2goZnVuY3Rpb24oKXt2YXIgYz1kKHRoaXMpLGY9Yy5vZmZzZXQoKTt0aGlzIT1hLmVsZW1lbnRbMF0mJmEuc25hcEVsZW1lbnRzLnB1c2goe2l0ZW06dGhpcyx3aWR0aDpjLm91dGVyV2lkdGgoKSxoZWlnaHQ6Yy5vdXRlckhlaWdodCgpLHRvcDpmLnRvcCxsZWZ0OmYubGVmdH0pfSl9LGRyYWc6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9ZCh0aGlzKS5kYXRhKFwiZHJhZ2dhYmxlXCIpLFxuZj1jLm9wdGlvbnMsZT1mLnNuYXBUb2xlcmFuY2UsZz1iLm9mZnNldC5sZWZ0LG49ZytjLmhlbHBlclByb3BvcnRpb25zLndpZHRoLG09Yi5vZmZzZXQudG9wLG89bStjLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCxoPWMuc25hcEVsZW1lbnRzLmxlbmd0aC0xO2g+PTA7aC0tKXt2YXIgaT1jLnNuYXBFbGVtZW50c1toXS5sZWZ0LGs9aStjLnNuYXBFbGVtZW50c1toXS53aWR0aCxqPWMuc25hcEVsZW1lbnRzW2hdLnRvcCxsPWorYy5zbmFwRWxlbWVudHNbaF0uaGVpZ2h0O2lmKGktZTxnJiZnPGsrZSYmai1lPG0mJm08bCtlfHxpLWU8ZyYmZzxrK2UmJmotZTxvJiZvPGwrZXx8aS1lPG4mJm48aytlJiZqLWU8bSYmbTxsK2V8fGktZTxuJiZuPGsrZSYmai1lPG8mJm88bCtlKXtpZihmLnNuYXBNb2RlIT1cImlubmVyXCIpe3ZhciBwPU1hdGguYWJzKGotbyk8PWUscT1NYXRoLmFicyhsLW0pPD1lLHI9TWF0aC5hYnMoaS1uKTw9ZSxzPU1hdGguYWJzKGstZyk8PWU7aWYocCliLnBvc2l0aW9uLnRvcD1cbmMuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIix7dG9wOmotYy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsbGVmdDowfSkudG9wLWMubWFyZ2lucy50b3A7aWYocSliLnBvc2l0aW9uLnRvcD1jLl9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIse3RvcDpsLGxlZnQ6MH0pLnRvcC1jLm1hcmdpbnMudG9wO2lmKHIpYi5wb3NpdGlvbi5sZWZ0PWMuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIix7dG9wOjAsbGVmdDppLWMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGh9KS5sZWZ0LWMubWFyZ2lucy5sZWZ0O2lmKHMpYi5wb3NpdGlvbi5sZWZ0PWMuX2NvbnZlcnRQb3NpdGlvblRvKFwicmVsYXRpdmVcIix7dG9wOjAsbGVmdDprfSkubGVmdC1jLm1hcmdpbnMubGVmdH12YXIgdD1wfHxxfHxyfHxzO2lmKGYuc25hcE1vZGUhPVwib3V0ZXJcIil7cD1NYXRoLmFicyhqLW0pPD1lO3E9TWF0aC5hYnMobC1vKTw9ZTtyPU1hdGguYWJzKGktZyk8PWU7cz1NYXRoLmFicyhrLW4pPD1lO2lmKHApYi5wb3NpdGlvbi50b3A9XG5jLl9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIse3RvcDpqLGxlZnQ6MH0pLnRvcC1jLm1hcmdpbnMudG9wO2lmKHEpYi5wb3NpdGlvbi50b3A9Yy5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLHt0b3A6bC1jLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCxsZWZ0OjB9KS50b3AtYy5tYXJnaW5zLnRvcDtpZihyKWIucG9zaXRpb24ubGVmdD1jLl9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIse3RvcDowLGxlZnQ6aX0pLmxlZnQtYy5tYXJnaW5zLmxlZnQ7aWYocyliLnBvc2l0aW9uLmxlZnQ9Yy5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLHt0b3A6MCxsZWZ0OmstYy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aH0pLmxlZnQtYy5tYXJnaW5zLmxlZnR9aWYoIWMuc25hcEVsZW1lbnRzW2hdLnNuYXBwaW5nJiYocHx8cXx8cnx8c3x8dCkpYy5vcHRpb25zLnNuYXAuc25hcCYmYy5vcHRpb25zLnNuYXAuc25hcC5jYWxsKGMuZWxlbWVudCxhLGQuZXh0ZW5kKGMuX3VpSGFzaCgpLFxue3NuYXBJdGVtOmMuc25hcEVsZW1lbnRzW2hdLml0ZW19KSk7Yy5zbmFwRWxlbWVudHNbaF0uc25hcHBpbmc9cHx8cXx8cnx8c3x8dH1lbHNle2Muc25hcEVsZW1lbnRzW2hdLnNuYXBwaW5nJiZjLm9wdGlvbnMuc25hcC5yZWxlYXNlJiZjLm9wdGlvbnMuc25hcC5yZWxlYXNlLmNhbGwoYy5lbGVtZW50LGEsZC5leHRlbmQoYy5fdWlIYXNoKCkse3NuYXBJdGVtOmMuc25hcEVsZW1lbnRzW2hdLml0ZW19KSk7Yy5zbmFwRWxlbWVudHNbaF0uc25hcHBpbmc9ZmFsc2V9fX19KTtkLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIixcInN0YWNrXCIse3N0YXJ0OmZ1bmN0aW9uKCl7dmFyIGE9ZCh0aGlzKS5kYXRhKFwiZHJhZ2dhYmxlXCIpLm9wdGlvbnM7YT1kLm1ha2VBcnJheShkKGEuc3RhY2spKS5zb3J0KGZ1bmN0aW9uKGMsZil7cmV0dXJuKHBhcnNlSW50KGQoYykuY3NzKFwiekluZGV4XCIpLDEwKXx8MCktKHBhcnNlSW50KGQoZikuY3NzKFwiekluZGV4XCIpLDEwKXx8MCl9KTtpZihhLmxlbmd0aCl7dmFyIGI9XG5wYXJzZUludChhWzBdLnN0eWxlLnpJbmRleCl8fDA7ZChhKS5lYWNoKGZ1bmN0aW9uKGMpe3RoaXMuc3R5bGUuekluZGV4PWIrY30pO3RoaXNbMF0uc3R5bGUuekluZGV4PWIrYS5sZW5ndGh9fX0pO2QudWkucGx1Z2luLmFkZChcImRyYWdnYWJsZVwiLFwiekluZGV4XCIse3N0YXJ0OmZ1bmN0aW9uKGEsYil7YT1kKGIuaGVscGVyKTtiPWQodGhpcykuZGF0YShcImRyYWdnYWJsZVwiKS5vcHRpb25zO2lmKGEuY3NzKFwiekluZGV4XCIpKWIuX3pJbmRleD1hLmNzcyhcInpJbmRleFwiKTthLmNzcyhcInpJbmRleFwiLGIuekluZGV4KX0sc3RvcDpmdW5jdGlvbihhLGIpe2E9ZCh0aGlzKS5kYXRhKFwiZHJhZ2dhYmxlXCIpLm9wdGlvbnM7YS5fekluZGV4JiZkKGIuaGVscGVyKS5jc3MoXCJ6SW5kZXhcIixhLl96SW5kZXgpfX0pfSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgRHJvcHBhYmxlIDEuOC4xMVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL0Ryb3BwYWJsZXNcbiAqXG4gKiBEZXBlbmRzOlxuICpcdGpxdWVyeS51aS5jb3JlLmpzXG4gKlx0anF1ZXJ5LnVpLndpZGdldC5qc1xuICpcdGpxdWVyeS51aS5tb3VzZS5qc1xuICpcdGpxdWVyeS51aS5kcmFnZ2FibGUuanNcbiAqL1xuKGZ1bmN0aW9uKGQpe2Qud2lkZ2V0KFwidWkuZHJvcHBhYmxlXCIse3dpZGdldEV2ZW50UHJlZml4OlwiZHJvcFwiLG9wdGlvbnM6e2FjY2VwdDpcIipcIixhY3RpdmVDbGFzczpmYWxzZSxhZGRDbGFzc2VzOnRydWUsZ3JlZWR5OmZhbHNlLGhvdmVyQ2xhc3M6ZmFsc2Usc2NvcGU6XCJkZWZhdWx0XCIsdG9sZXJhbmNlOlwiaW50ZXJzZWN0XCJ9LF9jcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj1hLmFjY2VwdDt0aGlzLmlzb3Zlcj0wO3RoaXMuaXNvdXQ9MTt0aGlzLmFjY2VwdD1kLmlzRnVuY3Rpb24oYik/YjpmdW5jdGlvbihjKXtyZXR1cm4gYy5pcyhiKX07dGhpcy5wcm9wb3J0aW9ucz17d2lkdGg6dGhpcy5lbGVtZW50WzBdLm9mZnNldFdpZHRoLGhlaWdodDp0aGlzLmVsZW1lbnRbMF0ub2Zmc2V0SGVpZ2h0fTtkLnVpLmRkbWFuYWdlci5kcm9wcGFibGVzW2Euc2NvcGVdPWQudWkuZGRtYW5hZ2VyLmRyb3BwYWJsZXNbYS5zY29wZV18fFtdO2QudWkuZGRtYW5hZ2VyLmRyb3BwYWJsZXNbYS5zY29wZV0ucHVzaCh0aGlzKTtcbmEuYWRkQ2xhc3NlcyYmdGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktZHJvcHBhYmxlXCIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPWQudWkuZGRtYW5hZ2VyLmRyb3BwYWJsZXNbdGhpcy5vcHRpb25zLnNjb3BlXSxiPTA7YjxhLmxlbmd0aDtiKyspYVtiXT09dGhpcyYmYS5zcGxpY2UoYiwxKTt0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJ1aS1kcm9wcGFibGUgdWktZHJvcHBhYmxlLWRpc2FibGVkXCIpLnJlbW92ZURhdGEoXCJkcm9wcGFibGVcIikudW5iaW5kKFwiLmRyb3BwYWJsZVwiKTtyZXR1cm4gdGhpc30sX3NldE9wdGlvbjpmdW5jdGlvbihhLGIpe2lmKGE9PVwiYWNjZXB0XCIpdGhpcy5hY2NlcHQ9ZC5pc0Z1bmN0aW9uKGIpP2I6ZnVuY3Rpb24oYyl7cmV0dXJuIGMuaXMoYil9O2QuV2lkZ2V0LnByb3RvdHlwZS5fc2V0T3B0aW9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sX2FjdGl2YXRlOmZ1bmN0aW9uKGEpe3ZhciBiPWQudWkuZGRtYW5hZ2VyLmN1cnJlbnQ7dGhpcy5vcHRpb25zLmFjdGl2ZUNsYXNzJiZcbnRoaXMuZWxlbWVudC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3MpO2ImJnRoaXMuX3RyaWdnZXIoXCJhY3RpdmF0ZVwiLGEsdGhpcy51aShiKSl9LF9kZWFjdGl2YXRlOmZ1bmN0aW9uKGEpe3ZhciBiPWQudWkuZGRtYW5hZ2VyLmN1cnJlbnQ7dGhpcy5vcHRpb25zLmFjdGl2ZUNsYXNzJiZ0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmFjdGl2ZUNsYXNzKTtiJiZ0aGlzLl90cmlnZ2VyKFwiZGVhY3RpdmF0ZVwiLGEsdGhpcy51aShiKSl9LF9vdmVyOmZ1bmN0aW9uKGEpe3ZhciBiPWQudWkuZGRtYW5hZ2VyLmN1cnJlbnQ7aWYoISghYnx8KGIuY3VycmVudEl0ZW18fGIuZWxlbWVudClbMF09PXRoaXMuZWxlbWVudFswXSkpaWYodGhpcy5hY2NlcHQuY2FsbCh0aGlzLmVsZW1lbnRbMF0sYi5jdXJyZW50SXRlbXx8Yi5lbGVtZW50KSl7dGhpcy5vcHRpb25zLmhvdmVyQ2xhc3MmJnRoaXMuZWxlbWVudC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuaG92ZXJDbGFzcyk7XG50aGlzLl90cmlnZ2VyKFwib3ZlclwiLGEsdGhpcy51aShiKSl9fSxfb3V0OmZ1bmN0aW9uKGEpe3ZhciBiPWQudWkuZGRtYW5hZ2VyLmN1cnJlbnQ7aWYoISghYnx8KGIuY3VycmVudEl0ZW18fGIuZWxlbWVudClbMF09PXRoaXMuZWxlbWVudFswXSkpaWYodGhpcy5hY2NlcHQuY2FsbCh0aGlzLmVsZW1lbnRbMF0sYi5jdXJyZW50SXRlbXx8Yi5lbGVtZW50KSl7dGhpcy5vcHRpb25zLmhvdmVyQ2xhc3MmJnRoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuaG92ZXJDbGFzcyk7dGhpcy5fdHJpZ2dlcihcIm91dFwiLGEsdGhpcy51aShiKSl9fSxfZHJvcDpmdW5jdGlvbihhLGIpe3ZhciBjPWJ8fGQudWkuZGRtYW5hZ2VyLmN1cnJlbnQ7aWYoIWN8fChjLmN1cnJlbnRJdGVtfHxjLmVsZW1lbnQpWzBdPT10aGlzLmVsZW1lbnRbMF0pcmV0dXJuIGZhbHNlO3ZhciBlPWZhbHNlO3RoaXMuZWxlbWVudC5maW5kKFwiOmRhdGEoZHJvcHBhYmxlKVwiKS5ub3QoXCIudWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIpLmVhY2goZnVuY3Rpb24oKXt2YXIgZz1cbmQuZGF0YSh0aGlzLFwiZHJvcHBhYmxlXCIpO2lmKGcub3B0aW9ucy5ncmVlZHkmJiFnLm9wdGlvbnMuZGlzYWJsZWQmJmcub3B0aW9ucy5zY29wZT09Yy5vcHRpb25zLnNjb3BlJiZnLmFjY2VwdC5jYWxsKGcuZWxlbWVudFswXSxjLmN1cnJlbnRJdGVtfHxjLmVsZW1lbnQpJiZkLnVpLmludGVyc2VjdChjLGQuZXh0ZW5kKGcse29mZnNldDpnLmVsZW1lbnQub2Zmc2V0KCl9KSxnLm9wdGlvbnMudG9sZXJhbmNlKSl7ZT10cnVlO3JldHVybiBmYWxzZX19KTtpZihlKXJldHVybiBmYWxzZTtpZih0aGlzLmFjY2VwdC5jYWxsKHRoaXMuZWxlbWVudFswXSxjLmN1cnJlbnRJdGVtfHxjLmVsZW1lbnQpKXt0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3MmJnRoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3MpO3RoaXMub3B0aW9ucy5ob3ZlckNsYXNzJiZ0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmhvdmVyQ2xhc3MpO3RoaXMuX3RyaWdnZXIoXCJkcm9wXCIsXG5hLHRoaXMudWkoYykpO3JldHVybiB0aGlzLmVsZW1lbnR9cmV0dXJuIGZhbHNlfSx1aTpmdW5jdGlvbihhKXtyZXR1cm57ZHJhZ2dhYmxlOmEuY3VycmVudEl0ZW18fGEuZWxlbWVudCxoZWxwZXI6YS5oZWxwZXIscG9zaXRpb246YS5wb3NpdGlvbixvZmZzZXQ6YS5wb3NpdGlvbkFic319fSk7ZC5leHRlbmQoZC51aS5kcm9wcGFibGUse3ZlcnNpb246XCIxLjguMTFcIn0pO2QudWkuaW50ZXJzZWN0PWZ1bmN0aW9uKGEsYixjKXtpZighYi5vZmZzZXQpcmV0dXJuIGZhbHNlO3ZhciBlPShhLnBvc2l0aW9uQWJzfHxhLnBvc2l0aW9uLmFic29sdXRlKS5sZWZ0LGc9ZSthLmhlbHBlclByb3BvcnRpb25zLndpZHRoLGY9KGEucG9zaXRpb25BYnN8fGEucG9zaXRpb24uYWJzb2x1dGUpLnRvcCxoPWYrYS5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsaT1iLm9mZnNldC5sZWZ0LGs9aStiLnByb3BvcnRpb25zLndpZHRoLGo9Yi5vZmZzZXQudG9wLGw9aitiLnByb3BvcnRpb25zLmhlaWdodDtcbnN3aXRjaChjKXtjYXNlIFwiZml0XCI6cmV0dXJuIGk8PWUmJmc8PWsmJmo8PWYmJmg8PWw7Y2FzZSBcImludGVyc2VjdFwiOnJldHVybiBpPGUrYS5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aC8yJiZnLWEuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgvMjxrJiZqPGYrYS5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQvMiYmaC1hLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC8yPGw7Y2FzZSBcInBvaW50ZXJcIjpyZXR1cm4gZC51aS5pc092ZXIoKGEucG9zaXRpb25BYnN8fGEucG9zaXRpb24uYWJzb2x1dGUpLnRvcCsoYS5jbGlja09mZnNldHx8YS5vZmZzZXQuY2xpY2spLnRvcCwoYS5wb3NpdGlvbkFic3x8YS5wb3NpdGlvbi5hYnNvbHV0ZSkubGVmdCsoYS5jbGlja09mZnNldHx8YS5vZmZzZXQuY2xpY2spLmxlZnQsaixpLGIucHJvcG9ydGlvbnMuaGVpZ2h0LGIucHJvcG9ydGlvbnMud2lkdGgpO2Nhc2UgXCJ0b3VjaFwiOnJldHVybihmPj1qJiZmPD1sfHxoPj1qJiZoPD1sfHxmPGomJmg+bCkmJihlPj1cbmkmJmU8PWt8fGc+PWkmJmc8PWt8fGU8aSYmZz5rKTtkZWZhdWx0OnJldHVybiBmYWxzZX19O2QudWkuZGRtYW5hZ2VyPXtjdXJyZW50Om51bGwsZHJvcHBhYmxlczp7XCJkZWZhdWx0XCI6W119LHByZXBhcmVPZmZzZXRzOmZ1bmN0aW9uKGEsYil7dmFyIGM9ZC51aS5kZG1hbmFnZXIuZHJvcHBhYmxlc1thLm9wdGlvbnMuc2NvcGVdfHxbXSxlPWI/Yi50eXBlOm51bGwsZz0oYS5jdXJyZW50SXRlbXx8YS5lbGVtZW50KS5maW5kKFwiOmRhdGEoZHJvcHBhYmxlKVwiKS5hbmRTZWxmKCksZj0wO2E6Zm9yKDtmPGMubGVuZ3RoO2YrKylpZighKGNbZl0ub3B0aW9ucy5kaXNhYmxlZHx8YSYmIWNbZl0uYWNjZXB0LmNhbGwoY1tmXS5lbGVtZW50WzBdLGEuY3VycmVudEl0ZW18fGEuZWxlbWVudCkpKXtmb3IodmFyIGg9MDtoPGcubGVuZ3RoO2grKylpZihnW2hdPT1jW2ZdLmVsZW1lbnRbMF0pe2NbZl0ucHJvcG9ydGlvbnMuaGVpZ2h0PTA7Y29udGludWUgYX1jW2ZdLnZpc2libGU9Y1tmXS5lbGVtZW50LmNzcyhcImRpc3BsYXlcIikhPVxuXCJub25lXCI7aWYoY1tmXS52aXNpYmxlKXtlPT1cIm1vdXNlZG93blwiJiZjW2ZdLl9hY3RpdmF0ZS5jYWxsKGNbZl0sYik7Y1tmXS5vZmZzZXQ9Y1tmXS5lbGVtZW50Lm9mZnNldCgpO2NbZl0ucHJvcG9ydGlvbnM9e3dpZHRoOmNbZl0uZWxlbWVudFswXS5vZmZzZXRXaWR0aCxoZWlnaHQ6Y1tmXS5lbGVtZW50WzBdLm9mZnNldEhlaWdodH19fX0sZHJvcDpmdW5jdGlvbihhLGIpe3ZhciBjPWZhbHNlO2QuZWFjaChkLnVpLmRkbWFuYWdlci5kcm9wcGFibGVzW2Eub3B0aW9ucy5zY29wZV18fFtdLGZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zKXtpZighdGhpcy5vcHRpb25zLmRpc2FibGVkJiZ0aGlzLnZpc2libGUmJmQudWkuaW50ZXJzZWN0KGEsdGhpcyx0aGlzLm9wdGlvbnMudG9sZXJhbmNlKSljPWN8fHRoaXMuX2Ryb3AuY2FsbCh0aGlzLGIpO2lmKCF0aGlzLm9wdGlvbnMuZGlzYWJsZWQmJnRoaXMudmlzaWJsZSYmdGhpcy5hY2NlcHQuY2FsbCh0aGlzLmVsZW1lbnRbMF0sYS5jdXJyZW50SXRlbXx8XG5hLmVsZW1lbnQpKXt0aGlzLmlzb3V0PTE7dGhpcy5pc292ZXI9MDt0aGlzLl9kZWFjdGl2YXRlLmNhbGwodGhpcyxiKX19fSk7cmV0dXJuIGN9LGRyYWc6ZnVuY3Rpb24oYSxiKXthLm9wdGlvbnMucmVmcmVzaFBvc2l0aW9ucyYmZC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHMoYSxiKTtkLmVhY2goZC51aS5kZG1hbmFnZXIuZHJvcHBhYmxlc1thLm9wdGlvbnMuc2NvcGVdfHxbXSxmdW5jdGlvbigpe2lmKCEodGhpcy5vcHRpb25zLmRpc2FibGVkfHx0aGlzLmdyZWVkeUNoaWxkfHwhdGhpcy52aXNpYmxlKSl7dmFyIGM9ZC51aS5pbnRlcnNlY3QoYSx0aGlzLHRoaXMub3B0aW9ucy50b2xlcmFuY2UpO2lmKGM9IWMmJnRoaXMuaXNvdmVyPT0xP1wiaXNvdXRcIjpjJiZ0aGlzLmlzb3Zlcj09MD9cImlzb3ZlclwiOm51bGwpe3ZhciBlO2lmKHRoaXMub3B0aW9ucy5ncmVlZHkpe3ZhciBnPXRoaXMuZWxlbWVudC5wYXJlbnRzKFwiOmRhdGEoZHJvcHBhYmxlKTplcSgwKVwiKTtpZihnLmxlbmd0aCl7ZT1cbmQuZGF0YShnWzBdLFwiZHJvcHBhYmxlXCIpO2UuZ3JlZWR5Q2hpbGQ9Yz09XCJpc292ZXJcIj8xOjB9fWlmKGUmJmM9PVwiaXNvdmVyXCIpe2UuaXNvdmVyPTA7ZS5pc291dD0xO2UuX291dC5jYWxsKGUsYil9dGhpc1tjXT0xO3RoaXNbYz09XCJpc291dFwiP1wiaXNvdmVyXCI6XCJpc291dFwiXT0wO3RoaXNbYz09XCJpc292ZXJcIj9cIl9vdmVyXCI6XCJfb3V0XCJdLmNhbGwodGhpcyxiKTtpZihlJiZjPT1cImlzb3V0XCIpe2UuaXNvdXQ9MDtlLmlzb3Zlcj0xO2UuX292ZXIuY2FsbChlLGIpfX19fSl9fX0pKGpRdWVyeSk7XG47LypcbiAqIE5vdGU6IFdoaWxlIE1pY3Jvc29mdCBpcyBub3QgdGhlIGF1dGhvciBvZiB0aGlzIGZpbGUsIE1pY3Jvc29mdCBpc1xuICogb2ZmZXJpbmcgeW91IGEgbGljZW5zZSBzdWJqZWN0IHRvIHRoZSB0ZXJtcyBvZiB0aGUgTWljcm9zb2Z0IFNvZnR3YXJlXG4gKiBMaWNlbnNlIFRlcm1zIGZvciBNaWNyb3NvZnQgQVNQLk5FVCBNb2RlbCBWaWV3IENvbnRyb2xsZXIgMy5cbiAqIE1pY3Jvc29mdCByZXNlcnZlcyBhbGwgb3RoZXIgcmlnaHRzLiBUaGUgbm90aWNlcyBiZWxvdyBhcmUgcHJvdmlkZWRcbiAqIGZvciBpbmZvcm1hdGlvbmFsIHB1cnBvc2VzIG9ubHkgYW5kIGFyZSBub3QgdGhlIGxpY2Vuc2UgdGVybXMgdW5kZXJcbiAqIHdoaWNoIE1pY3Jvc29mdCBkaXN0cmlidXRlZCB0aGlzIGZpbGUuXG4gKlxuICogalF1ZXJ5IFVJIFJlc2l6YWJsZSAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXG4gKlxuICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9SZXNpemFibGVzXG4gKlxuICogRGVwZW5kczpcbiAqXHRqcXVlcnkudWkuY29yZS5qc1xuICpcdGpxdWVyeS51aS5tb3VzZS5qc1xuICpcdGpxdWVyeS51aS53aWRnZXQuanNcbiAqL1xuKGZ1bmN0aW9uKGUpe2Uud2lkZ2V0KFwidWkucmVzaXphYmxlXCIsZS51aS5tb3VzZSx7d2lkZ2V0RXZlbnRQcmVmaXg6XCJyZXNpemVcIixvcHRpb25zOnthbHNvUmVzaXplOmZhbHNlLGFuaW1hdGU6ZmFsc2UsYW5pbWF0ZUR1cmF0aW9uOlwic2xvd1wiLGFuaW1hdGVFYXNpbmc6XCJzd2luZ1wiLGFzcGVjdFJhdGlvOmZhbHNlLGF1dG9IaWRlOmZhbHNlLGNvbnRhaW5tZW50OmZhbHNlLGdob3N0OmZhbHNlLGdyaWQ6ZmFsc2UsaGFuZGxlczpcImUscyxzZVwiLGhlbHBlcjpmYWxzZSxtYXhIZWlnaHQ6bnVsbCxtYXhXaWR0aDpudWxsLG1pbkhlaWdodDoxMCxtaW5XaWR0aDoxMCx6SW5kZXg6MUUzfSxfY3JlYXRlOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcyxhPXRoaXMub3B0aW9uczt0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoXCJ1aS1yZXNpemFibGVcIik7ZS5leHRlbmQodGhpcyx7X2FzcGVjdFJhdGlvOiEhYS5hc3BlY3RSYXRpbyxhc3BlY3RSYXRpbzphLmFzcGVjdFJhdGlvLG9yaWdpbmFsRWxlbWVudDp0aGlzLmVsZW1lbnQsXG5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50czpbXSxfaGVscGVyOmEuaGVscGVyfHxhLmdob3N0fHxhLmFuaW1hdGU/YS5oZWxwZXJ8fFwidWktcmVzaXphYmxlLWhlbHBlclwiOm51bGx9KTtpZih0aGlzLmVsZW1lbnRbMF0ubm9kZU5hbWUubWF0Y2goL2NhbnZhc3x0ZXh0YXJlYXxpbnB1dHxzZWxlY3R8YnV0dG9ufGltZy9pKSl7L3JlbGF0aXZlLy50ZXN0KHRoaXMuZWxlbWVudC5jc3MoXCJwb3NpdGlvblwiKSkmJmUuYnJvd3Nlci5vcGVyYSYmdGhpcy5lbGVtZW50LmNzcyh7cG9zaXRpb246XCJyZWxhdGl2ZVwiLHRvcDpcImF1dG9cIixsZWZ0OlwiYXV0b1wifSk7dGhpcy5lbGVtZW50LndyYXAoZSgnPGRpdiBjbGFzcz1cInVpLXdyYXBwZXJcIiBzdHlsZT1cIm92ZXJmbG93OiBoaWRkZW47XCI+PC9kaXY+JykuY3NzKHtwb3NpdGlvbjp0aGlzLmVsZW1lbnQuY3NzKFwicG9zaXRpb25cIiksd2lkdGg6dGhpcy5lbGVtZW50Lm91dGVyV2lkdGgoKSxoZWlnaHQ6dGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCksXG50b3A6dGhpcy5lbGVtZW50LmNzcyhcInRvcFwiKSxsZWZ0OnRoaXMuZWxlbWVudC5jc3MoXCJsZWZ0XCIpfSkpO3RoaXMuZWxlbWVudD10aGlzLmVsZW1lbnQucGFyZW50KCkuZGF0YShcInJlc2l6YWJsZVwiLHRoaXMuZWxlbWVudC5kYXRhKFwicmVzaXphYmxlXCIpKTt0aGlzLmVsZW1lbnRJc1dyYXBwZXI9dHJ1ZTt0aGlzLmVsZW1lbnQuY3NzKHttYXJnaW5MZWZ0OnRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyhcIm1hcmdpbkxlZnRcIiksbWFyZ2luVG9wOnRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyhcIm1hcmdpblRvcFwiKSxtYXJnaW5SaWdodDp0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoXCJtYXJnaW5SaWdodFwiKSxtYXJnaW5Cb3R0b206dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKFwibWFyZ2luQm90dG9tXCIpfSk7dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKHttYXJnaW5MZWZ0OjAsbWFyZ2luVG9wOjAsbWFyZ2luUmlnaHQ6MCxtYXJnaW5Cb3R0b206MH0pO3RoaXMub3JpZ2luYWxSZXNpemVTdHlsZT1cbnRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyhcInJlc2l6ZVwiKTt0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoXCJyZXNpemVcIixcIm5vbmVcIik7dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5wdXNoKHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyh7cG9zaXRpb246XCJzdGF0aWNcIix6b29tOjEsZGlzcGxheTpcImJsb2NrXCJ9KSk7dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKHttYXJnaW46dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKFwibWFyZ2luXCIpfSk7dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemUoKX10aGlzLmhhbmRsZXM9YS5oYW5kbGVzfHwoIWUoXCIudWktcmVzaXphYmxlLWhhbmRsZVwiLHRoaXMuZWxlbWVudCkubGVuZ3RoP1wiZSxzLHNlXCI6e246XCIudWktcmVzaXphYmxlLW5cIixlOlwiLnVpLXJlc2l6YWJsZS1lXCIsczpcIi51aS1yZXNpemFibGUtc1wiLHc6XCIudWktcmVzaXphYmxlLXdcIixzZTpcIi51aS1yZXNpemFibGUtc2VcIixzdzpcIi51aS1yZXNpemFibGUtc3dcIixuZTpcIi51aS1yZXNpemFibGUtbmVcIixcbm53OlwiLnVpLXJlc2l6YWJsZS1ud1wifSk7aWYodGhpcy5oYW5kbGVzLmNvbnN0cnVjdG9yPT1TdHJpbmcpe2lmKHRoaXMuaGFuZGxlcz09XCJhbGxcIil0aGlzLmhhbmRsZXM9XCJuLGUscyx3LHNlLHN3LG5lLG53XCI7dmFyIGM9dGhpcy5oYW5kbGVzLnNwbGl0KFwiLFwiKTt0aGlzLmhhbmRsZXM9e307Zm9yKHZhciBkPTA7ZDxjLmxlbmd0aDtkKyspe3ZhciBmPWUudHJpbShjW2RdKSxnPWUoJzxkaXYgY2xhc3M9XCJ1aS1yZXNpemFibGUtaGFuZGxlICcrKFwidWktcmVzaXphYmxlLVwiK2YpKydcIj48L2Rpdj4nKTsvc3d8c2V8bmV8bncvLnRlc3QoZikmJmcuY3NzKHt6SW5kZXg6KythLnpJbmRleH0pO1wic2VcIj09ZiYmZy5hZGRDbGFzcyhcInVpLWljb24gdWktaWNvbi1ncmlwc21hbGwtZGlhZ29uYWwtc2VcIik7dGhpcy5oYW5kbGVzW2ZdPVwiLnVpLXJlc2l6YWJsZS1cIitmO3RoaXMuZWxlbWVudC5hcHBlbmQoZyl9fXRoaXMuX3JlbmRlckF4aXM9ZnVuY3Rpb24oaCl7aD1ofHx0aGlzLmVsZW1lbnQ7Zm9yKHZhciBpIGluIHRoaXMuaGFuZGxlcyl7aWYodGhpcy5oYW5kbGVzW2ldLmNvbnN0cnVjdG9yPT1cblN0cmluZyl0aGlzLmhhbmRsZXNbaV09ZSh0aGlzLmhhbmRsZXNbaV0sdGhpcy5lbGVtZW50KS5zaG93KCk7aWYodGhpcy5lbGVtZW50SXNXcmFwcGVyJiZ0aGlzLm9yaWdpbmFsRWxlbWVudFswXS5ub2RlTmFtZS5tYXRjaCgvdGV4dGFyZWF8aW5wdXR8c2VsZWN0fGJ1dHRvbi9pKSl7dmFyIGo9ZSh0aGlzLmhhbmRsZXNbaV0sdGhpcy5lbGVtZW50KSxrPTA7az0vc3d8bmV8bnd8c2V8bnxzLy50ZXN0KGkpP2oub3V0ZXJIZWlnaHQoKTpqLm91dGVyV2lkdGgoKTtqPVtcInBhZGRpbmdcIiwvbmV8bnd8bi8udGVzdChpKT9cIlRvcFwiOi9zZXxzd3xzLy50ZXN0KGkpP1wiQm90dG9tXCI6L15lJC8udGVzdChpKT9cIlJpZ2h0XCI6XCJMZWZ0XCJdLmpvaW4oXCJcIik7aC5jc3MoaixrKTt0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZSgpfWUodGhpcy5oYW5kbGVzW2ldKX19O3RoaXMuX3JlbmRlckF4aXModGhpcy5lbGVtZW50KTt0aGlzLl9oYW5kbGVzPWUoXCIudWktcmVzaXphYmxlLWhhbmRsZVwiLHRoaXMuZWxlbWVudCkuZGlzYWJsZVNlbGVjdGlvbigpO1xudGhpcy5faGFuZGxlcy5tb3VzZW92ZXIoZnVuY3Rpb24oKXtpZighYi5yZXNpemluZyl7aWYodGhpcy5jbGFzc05hbWUpdmFyIGg9dGhpcy5jbGFzc05hbWUubWF0Y2goL3VpLXJlc2l6YWJsZS0oc2V8c3d8bmV8bnd8bnxlfHN8dykvaSk7Yi5heGlzPWgmJmhbMV0/aFsxXTpcInNlXCJ9fSk7aWYoYS5hdXRvSGlkZSl7dGhpcy5faGFuZGxlcy5oaWRlKCk7ZSh0aGlzLmVsZW1lbnQpLmFkZENsYXNzKFwidWktcmVzaXphYmxlLWF1dG9oaWRlXCIpLmhvdmVyKGZ1bmN0aW9uKCl7ZSh0aGlzKS5yZW1vdmVDbGFzcyhcInVpLXJlc2l6YWJsZS1hdXRvaGlkZVwiKTtiLl9oYW5kbGVzLnNob3coKX0sZnVuY3Rpb24oKXtpZighYi5yZXNpemluZyl7ZSh0aGlzKS5hZGRDbGFzcyhcInVpLXJlc2l6YWJsZS1hdXRvaGlkZVwiKTtiLl9oYW5kbGVzLmhpZGUoKX19KX10aGlzLl9tb3VzZUluaXQoKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuX21vdXNlRGVzdHJveSgpO3ZhciBiPWZ1bmN0aW9uKGMpe2UoYykucmVtb3ZlQ2xhc3MoXCJ1aS1yZXNpemFibGUgdWktcmVzaXphYmxlLWRpc2FibGVkIHVpLXJlc2l6YWJsZS1yZXNpemluZ1wiKS5yZW1vdmVEYXRhKFwicmVzaXphYmxlXCIpLnVuYmluZChcIi5yZXNpemFibGVcIikuZmluZChcIi51aS1yZXNpemFibGUtaGFuZGxlXCIpLnJlbW92ZSgpfTtcbmlmKHRoaXMuZWxlbWVudElzV3JhcHBlcil7Yih0aGlzLmVsZW1lbnQpO3ZhciBhPXRoaXMuZWxlbWVudDthLmFmdGVyKHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcyh7cG9zaXRpb246YS5jc3MoXCJwb3NpdGlvblwiKSx3aWR0aDphLm91dGVyV2lkdGgoKSxoZWlnaHQ6YS5vdXRlckhlaWdodCgpLHRvcDphLmNzcyhcInRvcFwiKSxsZWZ0OmEuY3NzKFwibGVmdFwiKX0pKS5yZW1vdmUoKX10aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoXCJyZXNpemVcIix0aGlzLm9yaWdpbmFsUmVzaXplU3R5bGUpO2IodGhpcy5vcmlnaW5hbEVsZW1lbnQpO3JldHVybiB0aGlzfSxfbW91c2VDYXB0dXJlOmZ1bmN0aW9uKGIpe3ZhciBhPWZhbHNlO2Zvcih2YXIgYyBpbiB0aGlzLmhhbmRsZXMpaWYoZSh0aGlzLmhhbmRsZXNbY10pWzBdPT1iLnRhcmdldClhPXRydWU7cmV0dXJuIXRoaXMub3B0aW9ucy5kaXNhYmxlZCYmYX0sX21vdXNlU3RhcnQ6ZnVuY3Rpb24oYil7dmFyIGE9dGhpcy5vcHRpb25zLGM9dGhpcy5lbGVtZW50LnBvc2l0aW9uKCksXG5kPXRoaXMuZWxlbWVudDt0aGlzLnJlc2l6aW5nPXRydWU7dGhpcy5kb2N1bWVudFNjcm9sbD17dG9wOmUoZG9jdW1lbnQpLnNjcm9sbFRvcCgpLGxlZnQ6ZShkb2N1bWVudCkuc2Nyb2xsTGVmdCgpfTtpZihkLmlzKFwiLnVpLWRyYWdnYWJsZVwiKXx8L2Fic29sdXRlLy50ZXN0KGQuY3NzKFwicG9zaXRpb25cIikpKWQuY3NzKHtwb3NpdGlvbjpcImFic29sdXRlXCIsdG9wOmMudG9wLGxlZnQ6Yy5sZWZ0fSk7ZS5icm93c2VyLm9wZXJhJiYvcmVsYXRpdmUvLnRlc3QoZC5jc3MoXCJwb3NpdGlvblwiKSkmJmQuY3NzKHtwb3NpdGlvbjpcInJlbGF0aXZlXCIsdG9wOlwiYXV0b1wiLGxlZnQ6XCJhdXRvXCJ9KTt0aGlzLl9yZW5kZXJQcm94eSgpO2M9bSh0aGlzLmhlbHBlci5jc3MoXCJsZWZ0XCIpKTt2YXIgZj1tKHRoaXMuaGVscGVyLmNzcyhcInRvcFwiKSk7aWYoYS5jb250YWlubWVudCl7Yys9ZShhLmNvbnRhaW5tZW50KS5zY3JvbGxMZWZ0KCl8fDA7Zis9ZShhLmNvbnRhaW5tZW50KS5zY3JvbGxUb3AoKXx8MH10aGlzLm9mZnNldD1cbnRoaXMuaGVscGVyLm9mZnNldCgpO3RoaXMucG9zaXRpb249e2xlZnQ6Yyx0b3A6Zn07dGhpcy5zaXplPXRoaXMuX2hlbHBlcj97d2lkdGg6ZC5vdXRlcldpZHRoKCksaGVpZ2h0OmQub3V0ZXJIZWlnaHQoKX06e3dpZHRoOmQud2lkdGgoKSxoZWlnaHQ6ZC5oZWlnaHQoKX07dGhpcy5vcmlnaW5hbFNpemU9dGhpcy5faGVscGVyP3t3aWR0aDpkLm91dGVyV2lkdGgoKSxoZWlnaHQ6ZC5vdXRlckhlaWdodCgpfTp7d2lkdGg6ZC53aWR0aCgpLGhlaWdodDpkLmhlaWdodCgpfTt0aGlzLm9yaWdpbmFsUG9zaXRpb249e2xlZnQ6Yyx0b3A6Zn07dGhpcy5zaXplRGlmZj17d2lkdGg6ZC5vdXRlcldpZHRoKCktZC53aWR0aCgpLGhlaWdodDpkLm91dGVySGVpZ2h0KCktZC5oZWlnaHQoKX07dGhpcy5vcmlnaW5hbE1vdXNlUG9zaXRpb249e2xlZnQ6Yi5wYWdlWCx0b3A6Yi5wYWdlWX07dGhpcy5hc3BlY3RSYXRpbz10eXBlb2YgYS5hc3BlY3RSYXRpbz09XCJudW1iZXJcIj9hLmFzcGVjdFJhdGlvOlxudGhpcy5vcmlnaW5hbFNpemUud2lkdGgvdGhpcy5vcmlnaW5hbFNpemUuaGVpZ2h0fHwxO2E9ZShcIi51aS1yZXNpemFibGUtXCIrdGhpcy5heGlzKS5jc3MoXCJjdXJzb3JcIik7ZShcImJvZHlcIikuY3NzKFwiY3Vyc29yXCIsYT09XCJhdXRvXCI/dGhpcy5heGlzK1wiLXJlc2l6ZVwiOmEpO2QuYWRkQ2xhc3MoXCJ1aS1yZXNpemFibGUtcmVzaXppbmdcIik7dGhpcy5fcHJvcGFnYXRlKFwic3RhcnRcIixiKTtyZXR1cm4gdHJ1ZX0sX21vdXNlRHJhZzpmdW5jdGlvbihiKXt2YXIgYT10aGlzLmhlbHBlcixjPXRoaXMub3JpZ2luYWxNb3VzZVBvc2l0aW9uLGQ9dGhpcy5fY2hhbmdlW3RoaXMuYXhpc107aWYoIWQpcmV0dXJuIGZhbHNlO2M9ZC5hcHBseSh0aGlzLFtiLGIucGFnZVgtYy5sZWZ0fHwwLGIucGFnZVktYy50b3B8fDBdKTtpZih0aGlzLl9hc3BlY3RSYXRpb3x8Yi5zaGlmdEtleSljPXRoaXMuX3VwZGF0ZVJhdGlvKGMsYik7Yz10aGlzLl9yZXNwZWN0U2l6ZShjLGIpO3RoaXMuX3Byb3BhZ2F0ZShcInJlc2l6ZVwiLFxuYik7YS5jc3Moe3RvcDp0aGlzLnBvc2l0aW9uLnRvcCtcInB4XCIsbGVmdDp0aGlzLnBvc2l0aW9uLmxlZnQrXCJweFwiLHdpZHRoOnRoaXMuc2l6ZS53aWR0aCtcInB4XCIsaGVpZ2h0OnRoaXMuc2l6ZS5oZWlnaHQrXCJweFwifSk7IXRoaXMuX2hlbHBlciYmdGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5sZW5ndGgmJnRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCk7dGhpcy5fdXBkYXRlQ2FjaGUoYyk7dGhpcy5fdHJpZ2dlcihcInJlc2l6ZVwiLGIsdGhpcy51aSgpKTtyZXR1cm4gZmFsc2V9LF9tb3VzZVN0b3A6ZnVuY3Rpb24oYil7dGhpcy5yZXNpemluZz1mYWxzZTt2YXIgYT10aGlzLm9wdGlvbnMsYz10aGlzO2lmKHRoaXMuX2hlbHBlcil7dmFyIGQ9dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cyxmPWQubGVuZ3RoJiYvdGV4dGFyZWEvaS50ZXN0KGRbMF0ubm9kZU5hbWUpO2Q9ZiYmZS51aS5oYXNTY3JvbGwoZFswXSxcImxlZnRcIik/MDpjLnNpemVEaWZmLmhlaWdodDtcbmY9Zj8wOmMuc2l6ZURpZmYud2lkdGg7Zj17d2lkdGg6Yy5oZWxwZXIud2lkdGgoKS1mLGhlaWdodDpjLmhlbHBlci5oZWlnaHQoKS1kfTtkPXBhcnNlSW50KGMuZWxlbWVudC5jc3MoXCJsZWZ0XCIpLDEwKSsoYy5wb3NpdGlvbi5sZWZ0LWMub3JpZ2luYWxQb3NpdGlvbi5sZWZ0KXx8bnVsbDt2YXIgZz1wYXJzZUludChjLmVsZW1lbnQuY3NzKFwidG9wXCIpLDEwKSsoYy5wb3NpdGlvbi50b3AtYy5vcmlnaW5hbFBvc2l0aW9uLnRvcCl8fG51bGw7YS5hbmltYXRlfHx0aGlzLmVsZW1lbnQuY3NzKGUuZXh0ZW5kKGYse3RvcDpnLGxlZnQ6ZH0pKTtjLmhlbHBlci5oZWlnaHQoYy5zaXplLmhlaWdodCk7Yy5oZWxwZXIud2lkdGgoYy5zaXplLndpZHRoKTt0aGlzLl9oZWxwZXImJiFhLmFuaW1hdGUmJnRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCl9ZShcImJvZHlcIikuY3NzKFwiY3Vyc29yXCIsXCJhdXRvXCIpO3RoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyhcInVpLXJlc2l6YWJsZS1yZXNpemluZ1wiKTtcbnRoaXMuX3Byb3BhZ2F0ZShcInN0b3BcIixiKTt0aGlzLl9oZWxwZXImJnRoaXMuaGVscGVyLnJlbW92ZSgpO3JldHVybiBmYWxzZX0sX3VwZGF0ZUNhY2hlOmZ1bmN0aW9uKGIpe3RoaXMub2Zmc2V0PXRoaXMuaGVscGVyLm9mZnNldCgpO2lmKGwoYi5sZWZ0KSl0aGlzLnBvc2l0aW9uLmxlZnQ9Yi5sZWZ0O2lmKGwoYi50b3ApKXRoaXMucG9zaXRpb24udG9wPWIudG9wO2lmKGwoYi5oZWlnaHQpKXRoaXMuc2l6ZS5oZWlnaHQ9Yi5oZWlnaHQ7aWYobChiLndpZHRoKSl0aGlzLnNpemUud2lkdGg9Yi53aWR0aH0sX3VwZGF0ZVJhdGlvOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMucG9zaXRpb24sYz10aGlzLnNpemUsZD10aGlzLmF4aXM7aWYoYi5oZWlnaHQpYi53aWR0aD1jLmhlaWdodCp0aGlzLmFzcGVjdFJhdGlvO2Vsc2UgaWYoYi53aWR0aCliLmhlaWdodD1jLndpZHRoL3RoaXMuYXNwZWN0UmF0aW87aWYoZD09XCJzd1wiKXtiLmxlZnQ9YS5sZWZ0KyhjLndpZHRoLWIud2lkdGgpO2IudG9wPVxubnVsbH1pZihkPT1cIm53XCIpe2IudG9wPWEudG9wKyhjLmhlaWdodC1iLmhlaWdodCk7Yi5sZWZ0PWEubGVmdCsoYy53aWR0aC1iLndpZHRoKX1yZXR1cm4gYn0sX3Jlc3BlY3RTaXplOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMub3B0aW9ucyxjPXRoaXMuYXhpcyxkPWwoYi53aWR0aCkmJmEubWF4V2lkdGgmJmEubWF4V2lkdGg8Yi53aWR0aCxmPWwoYi5oZWlnaHQpJiZhLm1heEhlaWdodCYmYS5tYXhIZWlnaHQ8Yi5oZWlnaHQsZz1sKGIud2lkdGgpJiZhLm1pbldpZHRoJiZhLm1pbldpZHRoPmIud2lkdGgsaD1sKGIuaGVpZ2h0KSYmYS5taW5IZWlnaHQmJmEubWluSGVpZ2h0PmIuaGVpZ2h0O2lmKGcpYi53aWR0aD1hLm1pbldpZHRoO2lmKGgpYi5oZWlnaHQ9YS5taW5IZWlnaHQ7aWYoZCliLndpZHRoPWEubWF4V2lkdGg7aWYoZiliLmhlaWdodD1hLm1heEhlaWdodDt2YXIgaT10aGlzLm9yaWdpbmFsUG9zaXRpb24ubGVmdCt0aGlzLm9yaWdpbmFsU2l6ZS53aWR0aCxqPXRoaXMucG9zaXRpb24udG9wK1xudGhpcy5zaXplLmhlaWdodCxrPS9zd3xud3x3Ly50ZXN0KGMpO2M9L253fG5lfG4vLnRlc3QoYyk7aWYoZyYmayliLmxlZnQ9aS1hLm1pbldpZHRoO2lmKGQmJmspYi5sZWZ0PWktYS5tYXhXaWR0aDtpZihoJiZjKWIudG9wPWotYS5taW5IZWlnaHQ7aWYoZiYmYyliLnRvcD1qLWEubWF4SGVpZ2h0O2lmKChhPSFiLndpZHRoJiYhYi5oZWlnaHQpJiYhYi5sZWZ0JiZiLnRvcCliLnRvcD1udWxsO2Vsc2UgaWYoYSYmIWIudG9wJiZiLmxlZnQpYi5sZWZ0PW51bGw7cmV0dXJuIGJ9LF9wcm9wb3J0aW9uYWxseVJlc2l6ZTpmdW5jdGlvbigpe2lmKHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHMubGVuZ3RoKWZvcih2YXIgYj10aGlzLmhlbHBlcnx8dGhpcy5lbGVtZW50LGE9MDthPHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHMubGVuZ3RoO2ErKyl7dmFyIGM9dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50c1thXTtpZighdGhpcy5ib3JkZXJEaWYpe3ZhciBkPVxuW2MuY3NzKFwiYm9yZGVyVG9wV2lkdGhcIiksYy5jc3MoXCJib3JkZXJSaWdodFdpZHRoXCIpLGMuY3NzKFwiYm9yZGVyQm90dG9tV2lkdGhcIiksYy5jc3MoXCJib3JkZXJMZWZ0V2lkdGhcIildLGY9W2MuY3NzKFwicGFkZGluZ1RvcFwiKSxjLmNzcyhcInBhZGRpbmdSaWdodFwiKSxjLmNzcyhcInBhZGRpbmdCb3R0b21cIiksYy5jc3MoXCJwYWRkaW5nTGVmdFwiKV07dGhpcy5ib3JkZXJEaWY9ZS5tYXAoZCxmdW5jdGlvbihnLGgpe2c9cGFyc2VJbnQoZywxMCl8fDA7aD1wYXJzZUludChmW2hdLDEwKXx8MDtyZXR1cm4gZytofSl9ZS5icm93c2VyLm1zaWUmJihlKGIpLmlzKFwiOmhpZGRlblwiKXx8ZShiKS5wYXJlbnRzKFwiOmhpZGRlblwiKS5sZW5ndGgpfHxjLmNzcyh7aGVpZ2h0OmIuaGVpZ2h0KCktdGhpcy5ib3JkZXJEaWZbMF0tdGhpcy5ib3JkZXJEaWZbMl18fDAsd2lkdGg6Yi53aWR0aCgpLXRoaXMuYm9yZGVyRGlmWzFdLXRoaXMuYm9yZGVyRGlmWzNdfHwwfSl9fSxfcmVuZGVyUHJveHk6ZnVuY3Rpb24oKXt2YXIgYj1cbnRoaXMub3B0aW9uczt0aGlzLmVsZW1lbnRPZmZzZXQ9dGhpcy5lbGVtZW50Lm9mZnNldCgpO2lmKHRoaXMuX2hlbHBlcil7dGhpcy5oZWxwZXI9dGhpcy5oZWxwZXJ8fGUoJzxkaXYgc3R5bGU9XCJvdmVyZmxvdzpoaWRkZW47XCI+PC9kaXY+Jyk7dmFyIGE9ZS5icm93c2VyLm1zaWUmJmUuYnJvd3Nlci52ZXJzaW9uPDcsYz1hPzE6MDthPWE/MjotMTt0aGlzLmhlbHBlci5hZGRDbGFzcyh0aGlzLl9oZWxwZXIpLmNzcyh7d2lkdGg6dGhpcy5lbGVtZW50Lm91dGVyV2lkdGgoKSthLGhlaWdodDp0aGlzLmVsZW1lbnQub3V0ZXJIZWlnaHQoKSthLHBvc2l0aW9uOlwiYWJzb2x1dGVcIixsZWZ0OnRoaXMuZWxlbWVudE9mZnNldC5sZWZ0LWMrXCJweFwiLHRvcDp0aGlzLmVsZW1lbnRPZmZzZXQudG9wLWMrXCJweFwiLHpJbmRleDorK2IuekluZGV4fSk7dGhpcy5oZWxwZXIuYXBwZW5kVG8oXCJib2R5XCIpLmRpc2FibGVTZWxlY3Rpb24oKX1lbHNlIHRoaXMuaGVscGVyPXRoaXMuZWxlbWVudH0sX2NoYW5nZTp7ZTpmdW5jdGlvbihiLFxuYSl7cmV0dXJue3dpZHRoOnRoaXMub3JpZ2luYWxTaXplLndpZHRoK2F9fSx3OmZ1bmN0aW9uKGIsYSl7cmV0dXJue2xlZnQ6dGhpcy5vcmlnaW5hbFBvc2l0aW9uLmxlZnQrYSx3aWR0aDp0aGlzLm9yaWdpbmFsU2l6ZS53aWR0aC1hfX0sbjpmdW5jdGlvbihiLGEsYyl7cmV0dXJue3RvcDp0aGlzLm9yaWdpbmFsUG9zaXRpb24udG9wK2MsaGVpZ2h0OnRoaXMub3JpZ2luYWxTaXplLmhlaWdodC1jfX0sczpmdW5jdGlvbihiLGEsYyl7cmV0dXJue2hlaWdodDp0aGlzLm9yaWdpbmFsU2l6ZS5oZWlnaHQrY319LHNlOmZ1bmN0aW9uKGIsYSxjKXtyZXR1cm4gZS5leHRlbmQodGhpcy5fY2hhbmdlLnMuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX2NoYW5nZS5lLmFwcGx5KHRoaXMsW2IsYSxjXSkpfSxzdzpmdW5jdGlvbihiLGEsYyl7cmV0dXJuIGUuZXh0ZW5kKHRoaXMuX2NoYW5nZS5zLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLl9jaGFuZ2Uudy5hcHBseSh0aGlzLFtiLGEsXG5jXSkpfSxuZTpmdW5jdGlvbihiLGEsYyl7cmV0dXJuIGUuZXh0ZW5kKHRoaXMuX2NoYW5nZS5uLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLl9jaGFuZ2UuZS5hcHBseSh0aGlzLFtiLGEsY10pKX0sbnc6ZnVuY3Rpb24oYixhLGMpe3JldHVybiBlLmV4dGVuZCh0aGlzLl9jaGFuZ2Uubi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fY2hhbmdlLncuYXBwbHkodGhpcyxbYixhLGNdKSl9fSxfcHJvcGFnYXRlOmZ1bmN0aW9uKGIsYSl7ZS51aS5wbHVnaW4uY2FsbCh0aGlzLGIsW2EsdGhpcy51aSgpXSk7YiE9XCJyZXNpemVcIiYmdGhpcy5fdHJpZ2dlcihiLGEsdGhpcy51aSgpKX0scGx1Z2luczp7fSx1aTpmdW5jdGlvbigpe3JldHVybntvcmlnaW5hbEVsZW1lbnQ6dGhpcy5vcmlnaW5hbEVsZW1lbnQsZWxlbWVudDp0aGlzLmVsZW1lbnQsaGVscGVyOnRoaXMuaGVscGVyLHBvc2l0aW9uOnRoaXMucG9zaXRpb24sc2l6ZTp0aGlzLnNpemUsb3JpZ2luYWxTaXplOnRoaXMub3JpZ2luYWxTaXplLFxub3JpZ2luYWxQb3NpdGlvbjp0aGlzLm9yaWdpbmFsUG9zaXRpb259fX0pO2UuZXh0ZW5kKGUudWkucmVzaXphYmxlLHt2ZXJzaW9uOlwiMS44LjExXCJ9KTtlLnVpLnBsdWdpbi5hZGQoXCJyZXNpemFibGVcIixcImFsc29SZXNpemVcIix7c3RhcnQ6ZnVuY3Rpb24oKXt2YXIgYj1lKHRoaXMpLmRhdGEoXCJyZXNpemFibGVcIikub3B0aW9ucyxhPWZ1bmN0aW9uKGMpe2UoYykuZWFjaChmdW5jdGlvbigpe3ZhciBkPWUodGhpcyk7ZC5kYXRhKFwicmVzaXphYmxlLWFsc29yZXNpemVcIix7d2lkdGg6cGFyc2VJbnQoZC53aWR0aCgpLDEwKSxoZWlnaHQ6cGFyc2VJbnQoZC5oZWlnaHQoKSwxMCksbGVmdDpwYXJzZUludChkLmNzcyhcImxlZnRcIiksMTApLHRvcDpwYXJzZUludChkLmNzcyhcInRvcFwiKSwxMCkscG9zaXRpb246ZC5jc3MoXCJwb3NpdGlvblwiKX0pfSl9O2lmKHR5cGVvZiBiLmFsc29SZXNpemU9PVwib2JqZWN0XCImJiFiLmFsc29SZXNpemUucGFyZW50Tm9kZSlpZihiLmFsc29SZXNpemUubGVuZ3RoKXtiLmFsc29SZXNpemU9XG5iLmFsc29SZXNpemVbMF07YShiLmFsc29SZXNpemUpfWVsc2UgZS5lYWNoKGIuYWxzb1Jlc2l6ZSxmdW5jdGlvbihjKXthKGMpfSk7ZWxzZSBhKGIuYWxzb1Jlc2l6ZSl9LHJlc2l6ZTpmdW5jdGlvbihiLGEpe3ZhciBjPWUodGhpcykuZGF0YShcInJlc2l6YWJsZVwiKTtiPWMub3B0aW9uczt2YXIgZD1jLm9yaWdpbmFsU2l6ZSxmPWMub3JpZ2luYWxQb3NpdGlvbixnPXtoZWlnaHQ6Yy5zaXplLmhlaWdodC1kLmhlaWdodHx8MCx3aWR0aDpjLnNpemUud2lkdGgtZC53aWR0aHx8MCx0b3A6Yy5wb3NpdGlvbi50b3AtZi50b3B8fDAsbGVmdDpjLnBvc2l0aW9uLmxlZnQtZi5sZWZ0fHwwfSxoPWZ1bmN0aW9uKGksail7ZShpKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGs9ZSh0aGlzKSxxPWUodGhpcykuZGF0YShcInJlc2l6YWJsZS1hbHNvcmVzaXplXCIpLHA9e30scj1qJiZqLmxlbmd0aD9qOmsucGFyZW50cyhhLm9yaWdpbmFsRWxlbWVudFswXSkubGVuZ3RoP1tcIndpZHRoXCIsXCJoZWlnaHRcIl06W1wid2lkdGhcIixcblwiaGVpZ2h0XCIsXCJ0b3BcIixcImxlZnRcIl07ZS5lYWNoKHIsZnVuY3Rpb24obixvKXtpZigobj0ocVtvXXx8MCkrKGdbb118fDApKSYmbj49MClwW29dPW58fG51bGx9KTtpZihlLmJyb3dzZXIub3BlcmEmJi9yZWxhdGl2ZS8udGVzdChrLmNzcyhcInBvc2l0aW9uXCIpKSl7Yy5fcmV2ZXJ0VG9SZWxhdGl2ZVBvc2l0aW9uPXRydWU7ay5jc3Moe3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6XCJhdXRvXCIsbGVmdDpcImF1dG9cIn0pfWsuY3NzKHApfSl9O3R5cGVvZiBiLmFsc29SZXNpemU9PVwib2JqZWN0XCImJiFiLmFsc29SZXNpemUubm9kZVR5cGU/ZS5lYWNoKGIuYWxzb1Jlc2l6ZSxmdW5jdGlvbihpLGope2goaSxqKX0pOmgoYi5hbHNvUmVzaXplKX0sc3RvcDpmdW5jdGlvbigpe3ZhciBiPWUodGhpcykuZGF0YShcInJlc2l6YWJsZVwiKSxhPWIub3B0aW9ucyxjPWZ1bmN0aW9uKGQpe2UoZCkuZWFjaChmdW5jdGlvbigpe3ZhciBmPWUodGhpcyk7Zi5jc3Moe3Bvc2l0aW9uOmYuZGF0YShcInJlc2l6YWJsZS1hbHNvcmVzaXplXCIpLnBvc2l0aW9ufSl9KX07XG5pZihiLl9yZXZlcnRUb1JlbGF0aXZlUG9zaXRpb24pe2IuX3JldmVydFRvUmVsYXRpdmVQb3NpdGlvbj1mYWxzZTt0eXBlb2YgYS5hbHNvUmVzaXplPT1cIm9iamVjdFwiJiYhYS5hbHNvUmVzaXplLm5vZGVUeXBlP2UuZWFjaChhLmFsc29SZXNpemUsZnVuY3Rpb24oZCl7YyhkKX0pOmMoYS5hbHNvUmVzaXplKX1lKHRoaXMpLnJlbW92ZURhdGEoXCJyZXNpemFibGUtYWxzb3Jlc2l6ZVwiKX19KTtlLnVpLnBsdWdpbi5hZGQoXCJyZXNpemFibGVcIixcImFuaW1hdGVcIix7c3RvcDpmdW5jdGlvbihiKXt2YXIgYT1lKHRoaXMpLmRhdGEoXCJyZXNpemFibGVcIiksYz1hLm9wdGlvbnMsZD1hLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLGY9ZC5sZW5ndGgmJi90ZXh0YXJlYS9pLnRlc3QoZFswXS5ub2RlTmFtZSksZz1mJiZlLnVpLmhhc1Njcm9sbChkWzBdLFwibGVmdFwiKT8wOmEuc2l6ZURpZmYuaGVpZ2h0O2Y9e3dpZHRoOmEuc2l6ZS53aWR0aC0oZj8wOmEuc2l6ZURpZmYud2lkdGgpLGhlaWdodDphLnNpemUuaGVpZ2h0LVxuZ307Zz1wYXJzZUludChhLmVsZW1lbnQuY3NzKFwibGVmdFwiKSwxMCkrKGEucG9zaXRpb24ubGVmdC1hLm9yaWdpbmFsUG9zaXRpb24ubGVmdCl8fG51bGw7dmFyIGg9cGFyc2VJbnQoYS5lbGVtZW50LmNzcyhcInRvcFwiKSwxMCkrKGEucG9zaXRpb24udG9wLWEub3JpZ2luYWxQb3NpdGlvbi50b3ApfHxudWxsO2EuZWxlbWVudC5hbmltYXRlKGUuZXh0ZW5kKGYsaCYmZz97dG9wOmgsbGVmdDpnfTp7fSkse2R1cmF0aW9uOmMuYW5pbWF0ZUR1cmF0aW9uLGVhc2luZzpjLmFuaW1hdGVFYXNpbmcsc3RlcDpmdW5jdGlvbigpe3ZhciBpPXt3aWR0aDpwYXJzZUludChhLmVsZW1lbnQuY3NzKFwid2lkdGhcIiksMTApLGhlaWdodDpwYXJzZUludChhLmVsZW1lbnQuY3NzKFwiaGVpZ2h0XCIpLDEwKSx0b3A6cGFyc2VJbnQoYS5lbGVtZW50LmNzcyhcInRvcFwiKSwxMCksbGVmdDpwYXJzZUludChhLmVsZW1lbnQuY3NzKFwibGVmdFwiKSwxMCl9O2QmJmQubGVuZ3RoJiZlKGRbMF0pLmNzcyh7d2lkdGg6aS53aWR0aCxcbmhlaWdodDppLmhlaWdodH0pO2EuX3VwZGF0ZUNhY2hlKGkpO2EuX3Byb3BhZ2F0ZShcInJlc2l6ZVwiLGIpfX0pfX0pO2UudWkucGx1Z2luLmFkZChcInJlc2l6YWJsZVwiLFwiY29udGFpbm1lbnRcIix7c3RhcnQ6ZnVuY3Rpb24oKXt2YXIgYj1lKHRoaXMpLmRhdGEoXCJyZXNpemFibGVcIiksYT1iLmVsZW1lbnQsYz1iLm9wdGlvbnMuY29udGFpbm1lbnQ7aWYoYT1jIGluc3RhbmNlb2YgZT9jLmdldCgwKTovcGFyZW50Ly50ZXN0KGMpP2EucGFyZW50KCkuZ2V0KDApOmMpe2IuY29udGFpbmVyRWxlbWVudD1lKGEpO2lmKC9kb2N1bWVudC8udGVzdChjKXx8Yz09ZG9jdW1lbnQpe2IuY29udGFpbmVyT2Zmc2V0PXtsZWZ0OjAsdG9wOjB9O2IuY29udGFpbmVyUG9zaXRpb249e2xlZnQ6MCx0b3A6MH07Yi5wYXJlbnREYXRhPXtlbGVtZW50OmUoZG9jdW1lbnQpLGxlZnQ6MCx0b3A6MCx3aWR0aDplKGRvY3VtZW50KS53aWR0aCgpLGhlaWdodDplKGRvY3VtZW50KS5oZWlnaHQoKXx8ZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodH19ZWxzZXt2YXIgZD1cbmUoYSksZj1bXTtlKFtcIlRvcFwiLFwiUmlnaHRcIixcIkxlZnRcIixcIkJvdHRvbVwiXSkuZWFjaChmdW5jdGlvbihpLGope2ZbaV09bShkLmNzcyhcInBhZGRpbmdcIitqKSl9KTtiLmNvbnRhaW5lck9mZnNldD1kLm9mZnNldCgpO2IuY29udGFpbmVyUG9zaXRpb249ZC5wb3NpdGlvbigpO2IuY29udGFpbmVyU2l6ZT17aGVpZ2h0OmQuaW5uZXJIZWlnaHQoKS1mWzNdLHdpZHRoOmQuaW5uZXJXaWR0aCgpLWZbMV19O2M9Yi5jb250YWluZXJPZmZzZXQ7dmFyIGc9Yi5jb250YWluZXJTaXplLmhlaWdodCxoPWIuY29udGFpbmVyU2l6ZS53aWR0aDtoPWUudWkuaGFzU2Nyb2xsKGEsXCJsZWZ0XCIpP2Euc2Nyb2xsV2lkdGg6aDtnPWUudWkuaGFzU2Nyb2xsKGEpP2Euc2Nyb2xsSGVpZ2h0Omc7Yi5wYXJlbnREYXRhPXtlbGVtZW50OmEsbGVmdDpjLmxlZnQsdG9wOmMudG9wLHdpZHRoOmgsaGVpZ2h0Omd9fX19LHJlc2l6ZTpmdW5jdGlvbihiKXt2YXIgYT1lKHRoaXMpLmRhdGEoXCJyZXNpemFibGVcIiksYz1hLm9wdGlvbnMsXG5kPWEuY29udGFpbmVyT2Zmc2V0LGY9YS5wb3NpdGlvbjtiPWEuX2FzcGVjdFJhdGlvfHxiLnNoaWZ0S2V5O3ZhciBnPXt0b3A6MCxsZWZ0OjB9LGg9YS5jb250YWluZXJFbGVtZW50O2lmKGhbMF0hPWRvY3VtZW50JiYvc3RhdGljLy50ZXN0KGguY3NzKFwicG9zaXRpb25cIikpKWc9ZDtpZihmLmxlZnQ8KGEuX2hlbHBlcj9kLmxlZnQ6MCkpe2Euc2l6ZS53aWR0aCs9YS5faGVscGVyP2EucG9zaXRpb24ubGVmdC1kLmxlZnQ6YS5wb3NpdGlvbi5sZWZ0LWcubGVmdDtpZihiKWEuc2l6ZS5oZWlnaHQ9YS5zaXplLndpZHRoL2MuYXNwZWN0UmF0aW87YS5wb3NpdGlvbi5sZWZ0PWMuaGVscGVyP2QubGVmdDowfWlmKGYudG9wPChhLl9oZWxwZXI/ZC50b3A6MCkpe2Euc2l6ZS5oZWlnaHQrPWEuX2hlbHBlcj9hLnBvc2l0aW9uLnRvcC1kLnRvcDphLnBvc2l0aW9uLnRvcDtpZihiKWEuc2l6ZS53aWR0aD1hLnNpemUuaGVpZ2h0KmMuYXNwZWN0UmF0aW87YS5wb3NpdGlvbi50b3A9YS5faGVscGVyP1xuZC50b3A6MH1hLm9mZnNldC5sZWZ0PWEucGFyZW50RGF0YS5sZWZ0K2EucG9zaXRpb24ubGVmdDthLm9mZnNldC50b3A9YS5wYXJlbnREYXRhLnRvcCthLnBvc2l0aW9uLnRvcDtjPU1hdGguYWJzKChhLl9oZWxwZXI/YS5vZmZzZXQubGVmdC1nLmxlZnQ6YS5vZmZzZXQubGVmdC1nLmxlZnQpK2Euc2l6ZURpZmYud2lkdGgpO2Q9TWF0aC5hYnMoKGEuX2hlbHBlcj9hLm9mZnNldC50b3AtZy50b3A6YS5vZmZzZXQudG9wLWQudG9wKSthLnNpemVEaWZmLmhlaWdodCk7Zj1hLmNvbnRhaW5lckVsZW1lbnQuZ2V0KDApPT1hLmVsZW1lbnQucGFyZW50KCkuZ2V0KDApO2c9L3JlbGF0aXZlfGFic29sdXRlLy50ZXN0KGEuY29udGFpbmVyRWxlbWVudC5jc3MoXCJwb3NpdGlvblwiKSk7aWYoZiYmZyljLT1hLnBhcmVudERhdGEubGVmdDtpZihjK2Euc2l6ZS53aWR0aD49YS5wYXJlbnREYXRhLndpZHRoKXthLnNpemUud2lkdGg9YS5wYXJlbnREYXRhLndpZHRoLWM7aWYoYilhLnNpemUuaGVpZ2h0PVxuYS5zaXplLndpZHRoL2EuYXNwZWN0UmF0aW99aWYoZCthLnNpemUuaGVpZ2h0Pj1hLnBhcmVudERhdGEuaGVpZ2h0KXthLnNpemUuaGVpZ2h0PWEucGFyZW50RGF0YS5oZWlnaHQtZDtpZihiKWEuc2l6ZS53aWR0aD1hLnNpemUuaGVpZ2h0KmEuYXNwZWN0UmF0aW99fSxzdG9wOmZ1bmN0aW9uKCl7dmFyIGI9ZSh0aGlzKS5kYXRhKFwicmVzaXphYmxlXCIpLGE9Yi5vcHRpb25zLGM9Yi5jb250YWluZXJPZmZzZXQsZD1iLmNvbnRhaW5lclBvc2l0aW9uLGY9Yi5jb250YWluZXJFbGVtZW50LGc9ZShiLmhlbHBlciksaD1nLm9mZnNldCgpLGk9Zy5vdXRlcldpZHRoKCktYi5zaXplRGlmZi53aWR0aDtnPWcub3V0ZXJIZWlnaHQoKS1iLnNpemVEaWZmLmhlaWdodDtiLl9oZWxwZXImJiFhLmFuaW1hdGUmJi9yZWxhdGl2ZS8udGVzdChmLmNzcyhcInBvc2l0aW9uXCIpKSYmZSh0aGlzKS5jc3Moe2xlZnQ6aC5sZWZ0LWQubGVmdC1jLmxlZnQsd2lkdGg6aSxoZWlnaHQ6Z30pO2IuX2hlbHBlciYmIWEuYW5pbWF0ZSYmXG4vc3RhdGljLy50ZXN0KGYuY3NzKFwicG9zaXRpb25cIikpJiZlKHRoaXMpLmNzcyh7bGVmdDpoLmxlZnQtZC5sZWZ0LWMubGVmdCx3aWR0aDppLGhlaWdodDpnfSl9fSk7ZS51aS5wbHVnaW4uYWRkKFwicmVzaXphYmxlXCIsXCJnaG9zdFwiLHtzdGFydDpmdW5jdGlvbigpe3ZhciBiPWUodGhpcykuZGF0YShcInJlc2l6YWJsZVwiKSxhPWIub3B0aW9ucyxjPWIuc2l6ZTtiLmdob3N0PWIub3JpZ2luYWxFbGVtZW50LmNsb25lKCk7Yi5naG9zdC5jc3Moe29wYWNpdHk6MC4yNSxkaXNwbGF5OlwiYmxvY2tcIixwb3NpdGlvbjpcInJlbGF0aXZlXCIsaGVpZ2h0OmMuaGVpZ2h0LHdpZHRoOmMud2lkdGgsbWFyZ2luOjAsbGVmdDowLHRvcDowfSkuYWRkQ2xhc3MoXCJ1aS1yZXNpemFibGUtZ2hvc3RcIikuYWRkQ2xhc3ModHlwZW9mIGEuZ2hvc3Q9PVwic3RyaW5nXCI/YS5naG9zdDpcIlwiKTtiLmdob3N0LmFwcGVuZFRvKGIuaGVscGVyKX0scmVzaXplOmZ1bmN0aW9uKCl7dmFyIGI9ZSh0aGlzKS5kYXRhKFwicmVzaXphYmxlXCIpO1xuYi5naG9zdCYmYi5naG9zdC5jc3Moe3Bvc2l0aW9uOlwicmVsYXRpdmVcIixoZWlnaHQ6Yi5zaXplLmhlaWdodCx3aWR0aDpiLnNpemUud2lkdGh9KX0sc3RvcDpmdW5jdGlvbigpe3ZhciBiPWUodGhpcykuZGF0YShcInJlc2l6YWJsZVwiKTtiLmdob3N0JiZiLmhlbHBlciYmYi5oZWxwZXIuZ2V0KDApLnJlbW92ZUNoaWxkKGIuZ2hvc3QuZ2V0KDApKX19KTtlLnVpLnBsdWdpbi5hZGQoXCJyZXNpemFibGVcIixcImdyaWRcIix7cmVzaXplOmZ1bmN0aW9uKCl7dmFyIGI9ZSh0aGlzKS5kYXRhKFwicmVzaXphYmxlXCIpLGE9Yi5vcHRpb25zLGM9Yi5zaXplLGQ9Yi5vcmlnaW5hbFNpemUsZj1iLm9yaWdpbmFsUG9zaXRpb24sZz1iLmF4aXM7YS5ncmlkPXR5cGVvZiBhLmdyaWQ9PVwibnVtYmVyXCI/W2EuZ3JpZCxhLmdyaWRdOmEuZ3JpZDt2YXIgaD1NYXRoLnJvdW5kKChjLndpZHRoLWQud2lkdGgpLyhhLmdyaWRbMF18fDEpKSooYS5ncmlkWzBdfHwxKTthPU1hdGgucm91bmQoKGMuaGVpZ2h0LWQuaGVpZ2h0KS9cbihhLmdyaWRbMV18fDEpKSooYS5ncmlkWzFdfHwxKTtpZigvXihzZXxzfGUpJC8udGVzdChnKSl7Yi5zaXplLndpZHRoPWQud2lkdGgraDtiLnNpemUuaGVpZ2h0PWQuaGVpZ2h0K2F9ZWxzZSBpZigvXihuZSkkLy50ZXN0KGcpKXtiLnNpemUud2lkdGg9ZC53aWR0aCtoO2Iuc2l6ZS5oZWlnaHQ9ZC5oZWlnaHQrYTtiLnBvc2l0aW9uLnRvcD1mLnRvcC1hfWVsc2V7aWYoL14oc3cpJC8udGVzdChnKSl7Yi5zaXplLndpZHRoPWQud2lkdGgraDtiLnNpemUuaGVpZ2h0PWQuaGVpZ2h0K2F9ZWxzZXtiLnNpemUud2lkdGg9ZC53aWR0aCtoO2Iuc2l6ZS5oZWlnaHQ9ZC5oZWlnaHQrYTtiLnBvc2l0aW9uLnRvcD1mLnRvcC1hfWIucG9zaXRpb24ubGVmdD1mLmxlZnQtaH19fSk7dmFyIG09ZnVuY3Rpb24oYil7cmV0dXJuIHBhcnNlSW50KGIsMTApfHwwfSxsPWZ1bmN0aW9uKGIpe3JldHVybiFpc05hTihwYXJzZUludChiLDEwKSl9fSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgU2VsZWN0YWJsZSAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXG4gKlxuICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9TZWxlY3RhYmxlc1xuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LnVpLmNvcmUuanNcbiAqXHRqcXVlcnkudWkubW91c2UuanNcbiAqXHRqcXVlcnkudWkud2lkZ2V0LmpzXG4gKi9cbihmdW5jdGlvbihlKXtlLndpZGdldChcInVpLnNlbGVjdGFibGVcIixlLnVpLm1vdXNlLHtvcHRpb25zOnthcHBlbmRUbzpcImJvZHlcIixhdXRvUmVmcmVzaDp0cnVlLGRpc3RhbmNlOjAsZmlsdGVyOlwiKlwiLHRvbGVyYW5jZTpcInRvdWNoXCJ9LF9jcmVhdGU6ZnVuY3Rpb24oKXt2YXIgYz10aGlzO3RoaXMuZWxlbWVudC5hZGRDbGFzcyhcInVpLXNlbGVjdGFibGVcIik7dGhpcy5kcmFnZ2VkPWZhbHNlO3ZhciBmO3RoaXMucmVmcmVzaD1mdW5jdGlvbigpe2Y9ZShjLm9wdGlvbnMuZmlsdGVyLGMuZWxlbWVudFswXSk7Zi5lYWNoKGZ1bmN0aW9uKCl7dmFyIGQ9ZSh0aGlzKSxiPWQub2Zmc2V0KCk7ZS5kYXRhKHRoaXMsXCJzZWxlY3RhYmxlLWl0ZW1cIix7ZWxlbWVudDp0aGlzLCRlbGVtZW50OmQsbGVmdDpiLmxlZnQsdG9wOmIudG9wLHJpZ2h0OmIubGVmdCtkLm91dGVyV2lkdGgoKSxib3R0b206Yi50b3ArZC5vdXRlckhlaWdodCgpLHN0YXJ0c2VsZWN0ZWQ6ZmFsc2Usc2VsZWN0ZWQ6ZC5oYXNDbGFzcyhcInVpLXNlbGVjdGVkXCIpLFxuc2VsZWN0aW5nOmQuaGFzQ2xhc3MoXCJ1aS1zZWxlY3RpbmdcIiksdW5zZWxlY3Rpbmc6ZC5oYXNDbGFzcyhcInVpLXVuc2VsZWN0aW5nXCIpfSl9KX07dGhpcy5yZWZyZXNoKCk7dGhpcy5zZWxlY3RlZXM9Zi5hZGRDbGFzcyhcInVpLXNlbGVjdGVlXCIpO3RoaXMuX21vdXNlSW5pdCgpO3RoaXMuaGVscGVyPWUoXCI8ZGl2IGNsYXNzPSd1aS1zZWxlY3RhYmxlLWhlbHBlcic+PC9kaXY+XCIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5zZWxlY3RlZXMucmVtb3ZlQ2xhc3MoXCJ1aS1zZWxlY3RlZVwiKS5yZW1vdmVEYXRhKFwic2VsZWN0YWJsZS1pdGVtXCIpO3RoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyhcInVpLXNlbGVjdGFibGUgdWktc2VsZWN0YWJsZS1kaXNhYmxlZFwiKS5yZW1vdmVEYXRhKFwic2VsZWN0YWJsZVwiKS51bmJpbmQoXCIuc2VsZWN0YWJsZVwiKTt0aGlzLl9tb3VzZURlc3Ryb3koKTtyZXR1cm4gdGhpc30sX21vdXNlU3RhcnQ6ZnVuY3Rpb24oYyl7dmFyIGY9dGhpczt0aGlzLm9wb3M9W2MucGFnZVgsXG5jLnBhZ2VZXTtpZighdGhpcy5vcHRpb25zLmRpc2FibGVkKXt2YXIgZD10aGlzLm9wdGlvbnM7dGhpcy5zZWxlY3RlZXM9ZShkLmZpbHRlcix0aGlzLmVsZW1lbnRbMF0pO3RoaXMuX3RyaWdnZXIoXCJzdGFydFwiLGMpO2UoZC5hcHBlbmRUbykuYXBwZW5kKHRoaXMuaGVscGVyKTt0aGlzLmhlbHBlci5jc3Moe2xlZnQ6Yy5jbGllbnRYLHRvcDpjLmNsaWVudFksd2lkdGg6MCxoZWlnaHQ6MH0pO2QuYXV0b1JlZnJlc2gmJnRoaXMucmVmcmVzaCgpO3RoaXMuc2VsZWN0ZWVzLmZpbHRlcihcIi51aS1zZWxlY3RlZFwiKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9ZS5kYXRhKHRoaXMsXCJzZWxlY3RhYmxlLWl0ZW1cIik7Yi5zdGFydHNlbGVjdGVkPXRydWU7aWYoIWMubWV0YUtleSl7Yi4kZWxlbWVudC5yZW1vdmVDbGFzcyhcInVpLXNlbGVjdGVkXCIpO2Iuc2VsZWN0ZWQ9ZmFsc2U7Yi4kZWxlbWVudC5hZGRDbGFzcyhcInVpLXVuc2VsZWN0aW5nXCIpO2IudW5zZWxlY3Rpbmc9dHJ1ZTtmLl90cmlnZ2VyKFwidW5zZWxlY3RpbmdcIixcbmMse3Vuc2VsZWN0aW5nOmIuZWxlbWVudH0pfX0pO2UoYy50YXJnZXQpLnBhcmVudHMoKS5hbmRTZWxmKCkuZWFjaChmdW5jdGlvbigpe3ZhciBiPWUuZGF0YSh0aGlzLFwic2VsZWN0YWJsZS1pdGVtXCIpO2lmKGIpe3ZhciBnPSFjLm1ldGFLZXl8fCFiLiRlbGVtZW50Lmhhc0NsYXNzKFwidWktc2VsZWN0ZWRcIik7Yi4kZWxlbWVudC5yZW1vdmVDbGFzcyhnP1widWktdW5zZWxlY3RpbmdcIjpcInVpLXNlbGVjdGVkXCIpLmFkZENsYXNzKGc/XCJ1aS1zZWxlY3RpbmdcIjpcInVpLXVuc2VsZWN0aW5nXCIpO2IudW5zZWxlY3Rpbmc9IWc7Yi5zZWxlY3Rpbmc9ZzsoYi5zZWxlY3RlZD1nKT9mLl90cmlnZ2VyKFwic2VsZWN0aW5nXCIsYyx7c2VsZWN0aW5nOmIuZWxlbWVudH0pOmYuX3RyaWdnZXIoXCJ1bnNlbGVjdGluZ1wiLGMse3Vuc2VsZWN0aW5nOmIuZWxlbWVudH0pO3JldHVybiBmYWxzZX19KX19LF9tb3VzZURyYWc6ZnVuY3Rpb24oYyl7dmFyIGY9dGhpczt0aGlzLmRyYWdnZWQ9dHJ1ZTtpZighdGhpcy5vcHRpb25zLmRpc2FibGVkKXt2YXIgZD1cbnRoaXMub3B0aW9ucyxiPXRoaXMub3Bvc1swXSxnPXRoaXMub3Bvc1sxXSxoPWMucGFnZVgsaT1jLnBhZ2VZO2lmKGI+aCl7dmFyIGo9aDtoPWI7Yj1qfWlmKGc+aSl7aj1pO2k9ZztnPWp9dGhpcy5oZWxwZXIuY3NzKHtsZWZ0OmIsdG9wOmcsd2lkdGg6aC1iLGhlaWdodDppLWd9KTt0aGlzLnNlbGVjdGVlcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGE9ZS5kYXRhKHRoaXMsXCJzZWxlY3RhYmxlLWl0ZW1cIik7aWYoISghYXx8YS5lbGVtZW50PT1mLmVsZW1lbnRbMF0pKXt2YXIgaz1mYWxzZTtpZihkLnRvbGVyYW5jZT09XCJ0b3VjaFwiKWs9IShhLmxlZnQ+aHx8YS5yaWdodDxifHxhLnRvcD5pfHxhLmJvdHRvbTxnKTtlbHNlIGlmKGQudG9sZXJhbmNlPT1cImZpdFwiKWs9YS5sZWZ0PmImJmEucmlnaHQ8aCYmYS50b3A+ZyYmYS5ib3R0b208aTtpZihrKXtpZihhLnNlbGVjdGVkKXthLiRlbGVtZW50LnJlbW92ZUNsYXNzKFwidWktc2VsZWN0ZWRcIik7YS5zZWxlY3RlZD1mYWxzZX1pZihhLnVuc2VsZWN0aW5nKXthLiRlbGVtZW50LnJlbW92ZUNsYXNzKFwidWktdW5zZWxlY3RpbmdcIik7XG5hLnVuc2VsZWN0aW5nPWZhbHNlfWlmKCFhLnNlbGVjdGluZyl7YS4kZWxlbWVudC5hZGRDbGFzcyhcInVpLXNlbGVjdGluZ1wiKTthLnNlbGVjdGluZz10cnVlO2YuX3RyaWdnZXIoXCJzZWxlY3RpbmdcIixjLHtzZWxlY3Rpbmc6YS5lbGVtZW50fSl9fWVsc2V7aWYoYS5zZWxlY3RpbmcpaWYoYy5tZXRhS2V5JiZhLnN0YXJ0c2VsZWN0ZWQpe2EuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJ1aS1zZWxlY3RpbmdcIik7YS5zZWxlY3Rpbmc9ZmFsc2U7YS4kZWxlbWVudC5hZGRDbGFzcyhcInVpLXNlbGVjdGVkXCIpO2Euc2VsZWN0ZWQ9dHJ1ZX1lbHNle2EuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJ1aS1zZWxlY3RpbmdcIik7YS5zZWxlY3Rpbmc9ZmFsc2U7aWYoYS5zdGFydHNlbGVjdGVkKXthLiRlbGVtZW50LmFkZENsYXNzKFwidWktdW5zZWxlY3RpbmdcIik7YS51bnNlbGVjdGluZz10cnVlfWYuX3RyaWdnZXIoXCJ1bnNlbGVjdGluZ1wiLGMse3Vuc2VsZWN0aW5nOmEuZWxlbWVudH0pfWlmKGEuc2VsZWN0ZWQpaWYoIWMubWV0YUtleSYmXG4hYS5zdGFydHNlbGVjdGVkKXthLiRlbGVtZW50LnJlbW92ZUNsYXNzKFwidWktc2VsZWN0ZWRcIik7YS5zZWxlY3RlZD1mYWxzZTthLiRlbGVtZW50LmFkZENsYXNzKFwidWktdW5zZWxlY3RpbmdcIik7YS51bnNlbGVjdGluZz10cnVlO2YuX3RyaWdnZXIoXCJ1bnNlbGVjdGluZ1wiLGMse3Vuc2VsZWN0aW5nOmEuZWxlbWVudH0pfX19fSk7cmV0dXJuIGZhbHNlfX0sX21vdXNlU3RvcDpmdW5jdGlvbihjKXt2YXIgZj10aGlzO3RoaXMuZHJhZ2dlZD1mYWxzZTtlKFwiLnVpLXVuc2VsZWN0aW5nXCIsdGhpcy5lbGVtZW50WzBdKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGQ9ZS5kYXRhKHRoaXMsXCJzZWxlY3RhYmxlLWl0ZW1cIik7ZC4kZWxlbWVudC5yZW1vdmVDbGFzcyhcInVpLXVuc2VsZWN0aW5nXCIpO2QudW5zZWxlY3Rpbmc9ZmFsc2U7ZC5zdGFydHNlbGVjdGVkPWZhbHNlO2YuX3RyaWdnZXIoXCJ1bnNlbGVjdGVkXCIsYyx7dW5zZWxlY3RlZDpkLmVsZW1lbnR9KX0pO2UoXCIudWktc2VsZWN0aW5nXCIsdGhpcy5lbGVtZW50WzBdKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGQ9XG5lLmRhdGEodGhpcyxcInNlbGVjdGFibGUtaXRlbVwiKTtkLiRlbGVtZW50LnJlbW92ZUNsYXNzKFwidWktc2VsZWN0aW5nXCIpLmFkZENsYXNzKFwidWktc2VsZWN0ZWRcIik7ZC5zZWxlY3Rpbmc9ZmFsc2U7ZC5zZWxlY3RlZD10cnVlO2Quc3RhcnRzZWxlY3RlZD10cnVlO2YuX3RyaWdnZXIoXCJzZWxlY3RlZFwiLGMse3NlbGVjdGVkOmQuZWxlbWVudH0pfSk7dGhpcy5fdHJpZ2dlcihcInN0b3BcIixjKTt0aGlzLmhlbHBlci5yZW1vdmUoKTtyZXR1cm4gZmFsc2V9fSk7ZS5leHRlbmQoZS51aS5zZWxlY3RhYmxlLHt2ZXJzaW9uOlwiMS44LjExXCJ9KX0pKGpRdWVyeSk7XG47LypcbiAqIE5vdGU6IFdoaWxlIE1pY3Jvc29mdCBpcyBub3QgdGhlIGF1dGhvciBvZiB0aGlzIGZpbGUsIE1pY3Jvc29mdCBpc1xuICogb2ZmZXJpbmcgeW91IGEgbGljZW5zZSBzdWJqZWN0IHRvIHRoZSB0ZXJtcyBvZiB0aGUgTWljcm9zb2Z0IFNvZnR3YXJlXG4gKiBMaWNlbnNlIFRlcm1zIGZvciBNaWNyb3NvZnQgQVNQLk5FVCBNb2RlbCBWaWV3IENvbnRyb2xsZXIgMy5cbiAqIE1pY3Jvc29mdCByZXNlcnZlcyBhbGwgb3RoZXIgcmlnaHRzLiBUaGUgbm90aWNlcyBiZWxvdyBhcmUgcHJvdmlkZWRcbiAqIGZvciBpbmZvcm1hdGlvbmFsIHB1cnBvc2VzIG9ubHkgYW5kIGFyZSBub3QgdGhlIGxpY2Vuc2UgdGVybXMgdW5kZXJcbiAqIHdoaWNoIE1pY3Jvc29mdCBkaXN0cmlidXRlZCB0aGlzIGZpbGUuXG4gKlxuICogalF1ZXJ5IFVJIFNvcnRhYmxlIDEuOC4xMVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL1NvcnRhYmxlc1xuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LnVpLmNvcmUuanNcbiAqXHRqcXVlcnkudWkubW91c2UuanNcbiAqXHRqcXVlcnkudWkud2lkZ2V0LmpzXG4gKi9cbihmdW5jdGlvbihkKXtkLndpZGdldChcInVpLnNvcnRhYmxlXCIsZC51aS5tb3VzZSx7d2lkZ2V0RXZlbnRQcmVmaXg6XCJzb3J0XCIsb3B0aW9uczp7YXBwZW5kVG86XCJwYXJlbnRcIixheGlzOmZhbHNlLGNvbm5lY3RXaXRoOmZhbHNlLGNvbnRhaW5tZW50OmZhbHNlLGN1cnNvcjpcImF1dG9cIixjdXJzb3JBdDpmYWxzZSxkcm9wT25FbXB0eTp0cnVlLGZvcmNlUGxhY2Vob2xkZXJTaXplOmZhbHNlLGZvcmNlSGVscGVyU2l6ZTpmYWxzZSxncmlkOmZhbHNlLGhhbmRsZTpmYWxzZSxoZWxwZXI6XCJvcmlnaW5hbFwiLGl0ZW1zOlwiPiAqXCIsb3BhY2l0eTpmYWxzZSxwbGFjZWhvbGRlcjpmYWxzZSxyZXZlcnQ6ZmFsc2Usc2Nyb2xsOnRydWUsc2Nyb2xsU2Vuc2l0aXZpdHk6MjAsc2Nyb2xsU3BlZWQ6MjAsc2NvcGU6XCJkZWZhdWx0XCIsdG9sZXJhbmNlOlwiaW50ZXJzZWN0XCIsekluZGV4OjFFM30sX2NyZWF0ZTpmdW5jdGlvbigpe3RoaXMuY29udGFpbmVyQ2FjaGU9e307dGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktc29ydGFibGVcIik7XG50aGlzLnJlZnJlc2goKTt0aGlzLmZsb2F0aW5nPXRoaXMuaXRlbXMubGVuZ3RoPy9sZWZ0fHJpZ2h0Ly50ZXN0KHRoaXMuaXRlbXNbMF0uaXRlbS5jc3MoXCJmbG9hdFwiKSl8fC9pbmxpbmV8dGFibGUtY2VsbC8udGVzdCh0aGlzLml0ZW1zWzBdLml0ZW0uY3NzKFwiZGlzcGxheVwiKSk6ZmFsc2U7dGhpcy5vZmZzZXQ9dGhpcy5lbGVtZW50Lm9mZnNldCgpO3RoaXMuX21vdXNlSW5pdCgpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKFwidWktc29ydGFibGUgdWktc29ydGFibGUtZGlzYWJsZWRcIikucmVtb3ZlRGF0YShcInNvcnRhYmxlXCIpLnVuYmluZChcIi5zb3J0YWJsZVwiKTt0aGlzLl9tb3VzZURlc3Ryb3koKTtmb3IodmFyIGE9dGhpcy5pdGVtcy5sZW5ndGgtMTthPj0wO2EtLSl0aGlzLml0ZW1zW2FdLml0ZW0ucmVtb3ZlRGF0YShcInNvcnRhYmxlLWl0ZW1cIik7cmV0dXJuIHRoaXN9LF9zZXRPcHRpb246ZnVuY3Rpb24oYSxiKXtpZihhPT09XCJkaXNhYmxlZFwiKXt0aGlzLm9wdGlvbnNbYV09XG5iO3RoaXMud2lkZ2V0KClbYj9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXShcInVpLXNvcnRhYmxlLWRpc2FibGVkXCIpfWVsc2UgZC5XaWRnZXQucHJvdG90eXBlLl9zZXRPcHRpb24uYXBwbHkodGhpcyxhcmd1bWVudHMpfSxfbW91c2VDYXB0dXJlOmZ1bmN0aW9uKGEsYil7aWYodGhpcy5yZXZlcnRpbmcpcmV0dXJuIGZhbHNlO2lmKHRoaXMub3B0aW9ucy5kaXNhYmxlZHx8dGhpcy5vcHRpb25zLnR5cGU9PVwic3RhdGljXCIpcmV0dXJuIGZhbHNlO3RoaXMuX3JlZnJlc2hJdGVtcyhhKTt2YXIgYz1udWxsLGU9dGhpcztkKGEudGFyZ2V0KS5wYXJlbnRzKCkuZWFjaChmdW5jdGlvbigpe2lmKGQuZGF0YSh0aGlzLFwic29ydGFibGUtaXRlbVwiKT09ZSl7Yz1kKHRoaXMpO3JldHVybiBmYWxzZX19KTtpZihkLmRhdGEoYS50YXJnZXQsXCJzb3J0YWJsZS1pdGVtXCIpPT1lKWM9ZChhLnRhcmdldCk7aWYoIWMpcmV0dXJuIGZhbHNlO2lmKHRoaXMub3B0aW9ucy5oYW5kbGUmJiFiKXt2YXIgZj1mYWxzZTtcbmQodGhpcy5vcHRpb25zLmhhbmRsZSxjKS5maW5kKFwiKlwiKS5hbmRTZWxmKCkuZWFjaChmdW5jdGlvbigpe2lmKHRoaXM9PWEudGFyZ2V0KWY9dHJ1ZX0pO2lmKCFmKXJldHVybiBmYWxzZX10aGlzLmN1cnJlbnRJdGVtPWM7dGhpcy5fcmVtb3ZlQ3VycmVudHNGcm9tSXRlbXMoKTtyZXR1cm4gdHJ1ZX0sX21vdXNlU3RhcnQ6ZnVuY3Rpb24oYSxiLGMpe2I9dGhpcy5vcHRpb25zO3ZhciBlPXRoaXM7dGhpcy5jdXJyZW50Q29udGFpbmVyPXRoaXM7dGhpcy5yZWZyZXNoUG9zaXRpb25zKCk7dGhpcy5oZWxwZXI9dGhpcy5fY3JlYXRlSGVscGVyKGEpO3RoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTt0aGlzLl9jYWNoZU1hcmdpbnMoKTt0aGlzLnNjcm9sbFBhcmVudD10aGlzLmhlbHBlci5zY3JvbGxQYXJlbnQoKTt0aGlzLm9mZnNldD10aGlzLmN1cnJlbnRJdGVtLm9mZnNldCgpO3RoaXMub2Zmc2V0PXt0b3A6dGhpcy5vZmZzZXQudG9wLXRoaXMubWFyZ2lucy50b3AsbGVmdDp0aGlzLm9mZnNldC5sZWZ0LVxudGhpcy5tYXJnaW5zLmxlZnR9O3RoaXMuaGVscGVyLmNzcyhcInBvc2l0aW9uXCIsXCJhYnNvbHV0ZVwiKTt0aGlzLmNzc1Bvc2l0aW9uPXRoaXMuaGVscGVyLmNzcyhcInBvc2l0aW9uXCIpO2QuZXh0ZW5kKHRoaXMub2Zmc2V0LHtjbGljazp7bGVmdDphLnBhZ2VYLXRoaXMub2Zmc2V0LmxlZnQsdG9wOmEucGFnZVktdGhpcy5vZmZzZXQudG9wfSxwYXJlbnQ6dGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCkscmVsYXRpdmU6dGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKX0pO3RoaXMub3JpZ2luYWxQb3NpdGlvbj10aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKGEpO3RoaXMub3JpZ2luYWxQYWdlWD1hLnBhZ2VYO3RoaXMub3JpZ2luYWxQYWdlWT1hLnBhZ2VZO2IuY3Vyc29yQXQmJnRoaXMuX2FkanVzdE9mZnNldEZyb21IZWxwZXIoYi5jdXJzb3JBdCk7dGhpcy5kb21Qb3NpdGlvbj17cHJldjp0aGlzLmN1cnJlbnRJdGVtLnByZXYoKVswXSxwYXJlbnQ6dGhpcy5jdXJyZW50SXRlbS5wYXJlbnQoKVswXX07XG50aGlzLmhlbHBlclswXSE9dGhpcy5jdXJyZW50SXRlbVswXSYmdGhpcy5jdXJyZW50SXRlbS5oaWRlKCk7dGhpcy5fY3JlYXRlUGxhY2Vob2xkZXIoKTtiLmNvbnRhaW5tZW50JiZ0aGlzLl9zZXRDb250YWlubWVudCgpO2lmKGIuY3Vyc29yKXtpZihkKFwiYm9keVwiKS5jc3MoXCJjdXJzb3JcIikpdGhpcy5fc3RvcmVkQ3Vyc29yPWQoXCJib2R5XCIpLmNzcyhcImN1cnNvclwiKTtkKFwiYm9keVwiKS5jc3MoXCJjdXJzb3JcIixiLmN1cnNvcil9aWYoYi5vcGFjaXR5KXtpZih0aGlzLmhlbHBlci5jc3MoXCJvcGFjaXR5XCIpKXRoaXMuX3N0b3JlZE9wYWNpdHk9dGhpcy5oZWxwZXIuY3NzKFwib3BhY2l0eVwiKTt0aGlzLmhlbHBlci5jc3MoXCJvcGFjaXR5XCIsYi5vcGFjaXR5KX1pZihiLnpJbmRleCl7aWYodGhpcy5oZWxwZXIuY3NzKFwiekluZGV4XCIpKXRoaXMuX3N0b3JlZFpJbmRleD10aGlzLmhlbHBlci5jc3MoXCJ6SW5kZXhcIik7dGhpcy5oZWxwZXIuY3NzKFwiekluZGV4XCIsYi56SW5kZXgpfWlmKHRoaXMuc2Nyb2xsUGFyZW50WzBdIT1cbmRvY3VtZW50JiZ0aGlzLnNjcm9sbFBhcmVudFswXS50YWdOYW1lIT1cIkhUTUxcIil0aGlzLm92ZXJmbG93T2Zmc2V0PXRoaXMuc2Nyb2xsUGFyZW50Lm9mZnNldCgpO3RoaXMuX3RyaWdnZXIoXCJzdGFydFwiLGEsdGhpcy5fdWlIYXNoKCkpO3RoaXMuX3ByZXNlcnZlSGVscGVyUHJvcG9ydGlvbnN8fHRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTtpZighYylmb3IoYz10aGlzLmNvbnRhaW5lcnMubGVuZ3RoLTE7Yz49MDtjLS0pdGhpcy5jb250YWluZXJzW2NdLl90cmlnZ2VyKFwiYWN0aXZhdGVcIixhLGUuX3VpSGFzaCh0aGlzKSk7aWYoZC51aS5kZG1hbmFnZXIpZC51aS5kZG1hbmFnZXIuY3VycmVudD10aGlzO2QudWkuZGRtYW5hZ2VyJiYhYi5kcm9wQmVoYXZpb3VyJiZkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyh0aGlzLGEpO3RoaXMuZHJhZ2dpbmc9dHJ1ZTt0aGlzLmhlbHBlci5hZGRDbGFzcyhcInVpLXNvcnRhYmxlLWhlbHBlclwiKTt0aGlzLl9tb3VzZURyYWcoYSk7XG5yZXR1cm4gdHJ1ZX0sX21vdXNlRHJhZzpmdW5jdGlvbihhKXt0aGlzLnBvc2l0aW9uPXRoaXMuX2dlbmVyYXRlUG9zaXRpb24oYSk7dGhpcy5wb3NpdGlvbkFicz10aGlzLl9jb252ZXJ0UG9zaXRpb25UbyhcImFic29sdXRlXCIpO2lmKCF0aGlzLmxhc3RQb3NpdGlvbkFicyl0aGlzLmxhc3RQb3NpdGlvbkFicz10aGlzLnBvc2l0aW9uQWJzO2lmKHRoaXMub3B0aW9ucy5zY3JvbGwpe3ZhciBiPXRoaXMub3B0aW9ucyxjPWZhbHNlO2lmKHRoaXMuc2Nyb2xsUGFyZW50WzBdIT1kb2N1bWVudCYmdGhpcy5zY3JvbGxQYXJlbnRbMF0udGFnTmFtZSE9XCJIVE1MXCIpe2lmKHRoaXMub3ZlcmZsb3dPZmZzZXQudG9wK3RoaXMuc2Nyb2xsUGFyZW50WzBdLm9mZnNldEhlaWdodC1hLnBhZ2VZPGIuc2Nyb2xsU2Vuc2l0aXZpdHkpdGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wPWM9dGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wK2Iuc2Nyb2xsU3BlZWQ7ZWxzZSBpZihhLnBhZ2VZLXRoaXMub3ZlcmZsb3dPZmZzZXQudG9wPFxuYi5zY3JvbGxTZW5zaXRpdml0eSl0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3A9Yz10aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3AtYi5zY3JvbGxTcGVlZDtpZih0aGlzLm92ZXJmbG93T2Zmc2V0LmxlZnQrdGhpcy5zY3JvbGxQYXJlbnRbMF0ub2Zmc2V0V2lkdGgtYS5wYWdlWDxiLnNjcm9sbFNlbnNpdGl2aXR5KXRoaXMuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbExlZnQ9Yz10aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0K2Iuc2Nyb2xsU3BlZWQ7ZWxzZSBpZihhLnBhZ2VYLXRoaXMub3ZlcmZsb3dPZmZzZXQubGVmdDxiLnNjcm9sbFNlbnNpdGl2aXR5KXRoaXMuc2Nyb2xsUGFyZW50WzBdLnNjcm9sbExlZnQ9Yz10aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0LWIuc2Nyb2xsU3BlZWR9ZWxzZXtpZihhLnBhZ2VZLWQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpPGIuc2Nyb2xsU2Vuc2l0aXZpdHkpYz1kKGRvY3VtZW50KS5zY3JvbGxUb3AoZChkb2N1bWVudCkuc2Nyb2xsVG9wKCktXG5iLnNjcm9sbFNwZWVkKTtlbHNlIGlmKGQod2luZG93KS5oZWlnaHQoKS0oYS5wYWdlWS1kKGRvY3VtZW50KS5zY3JvbGxUb3AoKSk8Yi5zY3JvbGxTZW5zaXRpdml0eSljPWQoZG9jdW1lbnQpLnNjcm9sbFRvcChkKGRvY3VtZW50KS5zY3JvbGxUb3AoKStiLnNjcm9sbFNwZWVkKTtpZihhLnBhZ2VYLWQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKTxiLnNjcm9sbFNlbnNpdGl2aXR5KWM9ZChkb2N1bWVudCkuc2Nyb2xsTGVmdChkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCktYi5zY3JvbGxTcGVlZCk7ZWxzZSBpZihkKHdpbmRvdykud2lkdGgoKS0oYS5wYWdlWC1kKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCkpPGIuc2Nyb2xsU2Vuc2l0aXZpdHkpYz1kKGRvY3VtZW50KS5zY3JvbGxMZWZ0KGQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKStiLnNjcm9sbFNwZWVkKX1jIT09ZmFsc2UmJmQudWkuZGRtYW5hZ2VyJiYhYi5kcm9wQmVoYXZpb3VyJiZkLnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyh0aGlzLFxuYSl9dGhpcy5wb3NpdGlvbkFicz10aGlzLl9jb252ZXJ0UG9zaXRpb25UbyhcImFic29sdXRlXCIpO2lmKCF0aGlzLm9wdGlvbnMuYXhpc3x8dGhpcy5vcHRpb25zLmF4aXMhPVwieVwiKXRoaXMuaGVscGVyWzBdLnN0eWxlLmxlZnQ9dGhpcy5wb3NpdGlvbi5sZWZ0K1wicHhcIjtpZighdGhpcy5vcHRpb25zLmF4aXN8fHRoaXMub3B0aW9ucy5heGlzIT1cInhcIil0aGlzLmhlbHBlclswXS5zdHlsZS50b3A9dGhpcy5wb3NpdGlvbi50b3ArXCJweFwiO2ZvcihiPXRoaXMuaXRlbXMubGVuZ3RoLTE7Yj49MDtiLS0pe2M9dGhpcy5pdGVtc1tiXTt2YXIgZT1jLml0ZW1bMF0sZj10aGlzLl9pbnRlcnNlY3RzV2l0aFBvaW50ZXIoYyk7aWYoZilpZihlIT10aGlzLmN1cnJlbnRJdGVtWzBdJiZ0aGlzLnBsYWNlaG9sZGVyW2Y9PTE/XCJuZXh0XCI6XCJwcmV2XCJdKClbMF0hPWUmJiFkLnVpLmNvbnRhaW5zKHRoaXMucGxhY2Vob2xkZXJbMF0sZSkmJih0aGlzLm9wdGlvbnMudHlwZT09XCJzZW1pLWR5bmFtaWNcIj8hZC51aS5jb250YWlucyh0aGlzLmVsZW1lbnRbMF0sXG5lKTp0cnVlKSl7dGhpcy5kaXJlY3Rpb249Zj09MT9cImRvd25cIjpcInVwXCI7aWYodGhpcy5vcHRpb25zLnRvbGVyYW5jZT09XCJwb2ludGVyXCJ8fHRoaXMuX2ludGVyc2VjdHNXaXRoU2lkZXMoYykpdGhpcy5fcmVhcnJhbmdlKGEsYyk7ZWxzZSBicmVhazt0aGlzLl90cmlnZ2VyKFwiY2hhbmdlXCIsYSx0aGlzLl91aUhhc2goKSk7YnJlYWt9fXRoaXMuX2NvbnRhY3RDb250YWluZXJzKGEpO2QudWkuZGRtYW5hZ2VyJiZkLnVpLmRkbWFuYWdlci5kcmFnKHRoaXMsYSk7dGhpcy5fdHJpZ2dlcihcInNvcnRcIixhLHRoaXMuX3VpSGFzaCgpKTt0aGlzLmxhc3RQb3NpdGlvbkFicz10aGlzLnBvc2l0aW9uQWJzO3JldHVybiBmYWxzZX0sX21vdXNlU3RvcDpmdW5jdGlvbihhLGIpe2lmKGEpe2QudWkuZGRtYW5hZ2VyJiYhdGhpcy5vcHRpb25zLmRyb3BCZWhhdmlvdXImJmQudWkuZGRtYW5hZ2VyLmRyb3AodGhpcyxhKTtpZih0aGlzLm9wdGlvbnMucmV2ZXJ0KXt2YXIgYz10aGlzO2I9Yy5wbGFjZWhvbGRlci5vZmZzZXQoKTtcbmMucmV2ZXJ0aW5nPXRydWU7ZCh0aGlzLmhlbHBlcikuYW5pbWF0ZSh7bGVmdDpiLmxlZnQtdGhpcy5vZmZzZXQucGFyZW50LmxlZnQtYy5tYXJnaW5zLmxlZnQrKHRoaXMub2Zmc2V0UGFyZW50WzBdPT1kb2N1bWVudC5ib2R5PzA6dGhpcy5vZmZzZXRQYXJlbnRbMF0uc2Nyb2xsTGVmdCksdG9wOmIudG9wLXRoaXMub2Zmc2V0LnBhcmVudC50b3AtYy5tYXJnaW5zLnRvcCsodGhpcy5vZmZzZXRQYXJlbnRbMF09PWRvY3VtZW50LmJvZHk/MDp0aGlzLm9mZnNldFBhcmVudFswXS5zY3JvbGxUb3ApfSxwYXJzZUludCh0aGlzLm9wdGlvbnMucmV2ZXJ0LDEwKXx8NTAwLGZ1bmN0aW9uKCl7Yy5fY2xlYXIoYSl9KX1lbHNlIHRoaXMuX2NsZWFyKGEsYik7cmV0dXJuIGZhbHNlfX0sY2FuY2VsOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztpZih0aGlzLmRyYWdnaW5nKXt0aGlzLl9tb3VzZVVwKHt0YXJnZXQ6bnVsbH0pO3RoaXMub3B0aW9ucy5oZWxwZXI9PVwib3JpZ2luYWxcIj90aGlzLmN1cnJlbnRJdGVtLmNzcyh0aGlzLl9zdG9yZWRDU1MpLnJlbW92ZUNsYXNzKFwidWktc29ydGFibGUtaGVscGVyXCIpOlxudGhpcy5jdXJyZW50SXRlbS5zaG93KCk7Zm9yKHZhciBiPXRoaXMuY29udGFpbmVycy5sZW5ndGgtMTtiPj0wO2ItLSl7dGhpcy5jb250YWluZXJzW2JdLl90cmlnZ2VyKFwiZGVhY3RpdmF0ZVwiLG51bGwsYS5fdWlIYXNoKHRoaXMpKTtpZih0aGlzLmNvbnRhaW5lcnNbYl0uY29udGFpbmVyQ2FjaGUub3Zlcil7dGhpcy5jb250YWluZXJzW2JdLl90cmlnZ2VyKFwib3V0XCIsbnVsbCxhLl91aUhhc2godGhpcykpO3RoaXMuY29udGFpbmVyc1tiXS5jb250YWluZXJDYWNoZS5vdmVyPTB9fX1pZih0aGlzLnBsYWNlaG9sZGVyKXt0aGlzLnBsYWNlaG9sZGVyWzBdLnBhcmVudE5vZGUmJnRoaXMucGxhY2Vob2xkZXJbMF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnBsYWNlaG9sZGVyWzBdKTt0aGlzLm9wdGlvbnMuaGVscGVyIT1cIm9yaWdpbmFsXCImJnRoaXMuaGVscGVyJiZ0aGlzLmhlbHBlclswXS5wYXJlbnROb2RlJiZ0aGlzLmhlbHBlci5yZW1vdmUoKTtkLmV4dGVuZCh0aGlzLHtoZWxwZXI6bnVsbCxcbmRyYWdnaW5nOmZhbHNlLHJldmVydGluZzpmYWxzZSxfbm9GaW5hbFNvcnQ6bnVsbH0pO3RoaXMuZG9tUG9zaXRpb24ucHJldj9kKHRoaXMuZG9tUG9zaXRpb24ucHJldikuYWZ0ZXIodGhpcy5jdXJyZW50SXRlbSk6ZCh0aGlzLmRvbVBvc2l0aW9uLnBhcmVudCkucHJlcGVuZCh0aGlzLmN1cnJlbnRJdGVtKX1yZXR1cm4gdGhpc30sc2VyaWFsaXplOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuX2dldEl0ZW1zQXNqUXVlcnkoYSYmYS5jb25uZWN0ZWQpLGM9W107YT1hfHx7fTtkKGIpLmVhY2goZnVuY3Rpb24oKXt2YXIgZT0oZChhLml0ZW18fHRoaXMpLmF0dHIoYS5hdHRyaWJ1dGV8fFwiaWRcIil8fFwiXCIpLm1hdGNoKGEuZXhwcmVzc2lvbnx8LyguKylbLT1fXSguKykvKTtpZihlKWMucHVzaCgoYS5rZXl8fGVbMV0rXCJbXVwiKStcIj1cIisoYS5rZXkmJmEuZXhwcmVzc2lvbj9lWzFdOmVbMl0pKX0pOyFjLmxlbmd0aCYmYS5rZXkmJmMucHVzaChhLmtleStcIj1cIik7cmV0dXJuIGMuam9pbihcIiZcIil9LFxudG9BcnJheTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLl9nZXRJdGVtc0FzalF1ZXJ5KGEmJmEuY29ubmVjdGVkKSxjPVtdO2E9YXx8e307Yi5lYWNoKGZ1bmN0aW9uKCl7Yy5wdXNoKGQoYS5pdGVtfHx0aGlzKS5hdHRyKGEuYXR0cmlidXRlfHxcImlkXCIpfHxcIlwiKX0pO3JldHVybiBjfSxfaW50ZXJzZWN0c1dpdGg6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5wb3NpdGlvbkFicy5sZWZ0LGM9Yit0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLGU9dGhpcy5wb3NpdGlvbkFicy50b3AsZj1lK3RoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LGc9YS5sZWZ0LGg9ZythLndpZHRoLGk9YS50b3Asaz1pK2EuaGVpZ2h0LGo9dGhpcy5vZmZzZXQuY2xpY2sudG9wLGw9dGhpcy5vZmZzZXQuY2xpY2subGVmdDtqPWUraj5pJiZlK2o8ayYmYitsPmcmJmIrbDxoO3JldHVybiB0aGlzLm9wdGlvbnMudG9sZXJhbmNlPT1cInBvaW50ZXJcInx8dGhpcy5vcHRpb25zLmZvcmNlUG9pbnRlckZvckNvbnRhaW5lcnN8fFxudGhpcy5vcHRpb25zLnRvbGVyYW5jZSE9XCJwb2ludGVyXCImJnRoaXMuaGVscGVyUHJvcG9ydGlvbnNbdGhpcy5mbG9hdGluZz9cIndpZHRoXCI6XCJoZWlnaHRcIl0+YVt0aGlzLmZsb2F0aW5nP1wid2lkdGhcIjpcImhlaWdodFwiXT9qOmc8Yit0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLzImJmMtdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aC8yPGgmJmk8ZSt0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC8yJiZmLXRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LzI8a30sX2ludGVyc2VjdHNXaXRoUG9pbnRlcjpmdW5jdGlvbihhKXt2YXIgYj1kLnVpLmlzT3ZlckF4aXModGhpcy5wb3NpdGlvbkFicy50b3ArdGhpcy5vZmZzZXQuY2xpY2sudG9wLGEudG9wLGEuaGVpZ2h0KTthPWQudWkuaXNPdmVyQXhpcyh0aGlzLnBvc2l0aW9uQWJzLmxlZnQrdGhpcy5vZmZzZXQuY2xpY2subGVmdCxhLmxlZnQsYS53aWR0aCk7Yj1iJiZhO2E9dGhpcy5fZ2V0RHJhZ1ZlcnRpY2FsRGlyZWN0aW9uKCk7XG52YXIgYz10aGlzLl9nZXREcmFnSG9yaXpvbnRhbERpcmVjdGlvbigpO2lmKCFiKXJldHVybiBmYWxzZTtyZXR1cm4gdGhpcy5mbG9hdGluZz9jJiZjPT1cInJpZ2h0XCJ8fGE9PVwiZG93blwiPzI6MTphJiYoYT09XCJkb3duXCI/MjoxKX0sX2ludGVyc2VjdHNXaXRoU2lkZXM6ZnVuY3Rpb24oYSl7dmFyIGI9ZC51aS5pc092ZXJBeGlzKHRoaXMucG9zaXRpb25BYnMudG9wK3RoaXMub2Zmc2V0LmNsaWNrLnRvcCxhLnRvcCthLmhlaWdodC8yLGEuaGVpZ2h0KTthPWQudWkuaXNPdmVyQXhpcyh0aGlzLnBvc2l0aW9uQWJzLmxlZnQrdGhpcy5vZmZzZXQuY2xpY2subGVmdCxhLmxlZnQrYS53aWR0aC8yLGEud2lkdGgpO3ZhciBjPXRoaXMuX2dldERyYWdWZXJ0aWNhbERpcmVjdGlvbigpLGU9dGhpcy5fZ2V0RHJhZ0hvcml6b250YWxEaXJlY3Rpb24oKTtyZXR1cm4gdGhpcy5mbG9hdGluZyYmZT9lPT1cInJpZ2h0XCImJmF8fGU9PVwibGVmdFwiJiYhYTpjJiYoYz09XCJkb3duXCImJmJ8fGM9PVwidXBcIiYmIWIpfSxcbl9nZXREcmFnVmVydGljYWxEaXJlY3Rpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnBvc2l0aW9uQWJzLnRvcC10aGlzLmxhc3RQb3NpdGlvbkFicy50b3A7cmV0dXJuIGEhPTAmJihhPjA/XCJkb3duXCI6XCJ1cFwiKX0sX2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wb3NpdGlvbkFicy5sZWZ0LXRoaXMubGFzdFBvc2l0aW9uQWJzLmxlZnQ7cmV0dXJuIGEhPTAmJihhPjA/XCJyaWdodFwiOlwibGVmdFwiKX0scmVmcmVzaDpmdW5jdGlvbihhKXt0aGlzLl9yZWZyZXNoSXRlbXMoYSk7dGhpcy5yZWZyZXNoUG9zaXRpb25zKCk7cmV0dXJuIHRoaXN9LF9jb25uZWN0V2l0aDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucztyZXR1cm4gYS5jb25uZWN0V2l0aC5jb25zdHJ1Y3Rvcj09U3RyaW5nP1thLmNvbm5lY3RXaXRoXTphLmNvbm5lY3RXaXRofSxfZ2V0SXRlbXNBc2pRdWVyeTpmdW5jdGlvbihhKXt2YXIgYj1bXSxjPVtdLGU9dGhpcy5fY29ubmVjdFdpdGgoKTtcbmlmKGUmJmEpZm9yKGE9ZS5sZW5ndGgtMTthPj0wO2EtLSlmb3IodmFyIGY9ZChlW2FdKSxnPWYubGVuZ3RoLTE7Zz49MDtnLS0pe3ZhciBoPWQuZGF0YShmW2ddLFwic29ydGFibGVcIik7aWYoaCYmaCE9dGhpcyYmIWgub3B0aW9ucy5kaXNhYmxlZCljLnB1c2goW2QuaXNGdW5jdGlvbihoLm9wdGlvbnMuaXRlbXMpP2gub3B0aW9ucy5pdGVtcy5jYWxsKGguZWxlbWVudCk6ZChoLm9wdGlvbnMuaXRlbXMsaC5lbGVtZW50KS5ub3QoXCIudWktc29ydGFibGUtaGVscGVyXCIpLm5vdChcIi51aS1zb3J0YWJsZS1wbGFjZWhvbGRlclwiKSxoXSl9Yy5wdXNoKFtkLmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLml0ZW1zKT90aGlzLm9wdGlvbnMuaXRlbXMuY2FsbCh0aGlzLmVsZW1lbnQsbnVsbCx7b3B0aW9uczp0aGlzLm9wdGlvbnMsaXRlbTp0aGlzLmN1cnJlbnRJdGVtfSk6ZCh0aGlzLm9wdGlvbnMuaXRlbXMsdGhpcy5lbGVtZW50KS5ub3QoXCIudWktc29ydGFibGUtaGVscGVyXCIpLm5vdChcIi51aS1zb3J0YWJsZS1wbGFjZWhvbGRlclwiKSxcbnRoaXNdKTtmb3IoYT1jLmxlbmd0aC0xO2E+PTA7YS0tKWNbYV1bMF0uZWFjaChmdW5jdGlvbigpe2IucHVzaCh0aGlzKX0pO3JldHVybiBkKGIpfSxfcmVtb3ZlQ3VycmVudHNGcm9tSXRlbXM6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5jdXJyZW50SXRlbS5maW5kKFwiOmRhdGEoc29ydGFibGUtaXRlbSlcIiksYj0wO2I8dGhpcy5pdGVtcy5sZW5ndGg7YisrKWZvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKWFbY109PXRoaXMuaXRlbXNbYl0uaXRlbVswXSYmdGhpcy5pdGVtcy5zcGxpY2UoYiwxKX0sX3JlZnJlc2hJdGVtczpmdW5jdGlvbihhKXt0aGlzLml0ZW1zPVtdO3RoaXMuY29udGFpbmVycz1bdGhpc107dmFyIGI9dGhpcy5pdGVtcyxjPVtbZC5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy5pdGVtcyk/dGhpcy5vcHRpb25zLml0ZW1zLmNhbGwodGhpcy5lbGVtZW50WzBdLGEse2l0ZW06dGhpcy5jdXJyZW50SXRlbX0pOmQodGhpcy5vcHRpb25zLml0ZW1zLHRoaXMuZWxlbWVudCksXG50aGlzXV0sZT10aGlzLl9jb25uZWN0V2l0aCgpO2lmKGUpZm9yKHZhciBmPWUubGVuZ3RoLTE7Zj49MDtmLS0pZm9yKHZhciBnPWQoZVtmXSksaD1nLmxlbmd0aC0xO2g+PTA7aC0tKXt2YXIgaT1kLmRhdGEoZ1toXSxcInNvcnRhYmxlXCIpO2lmKGkmJmkhPXRoaXMmJiFpLm9wdGlvbnMuZGlzYWJsZWQpe2MucHVzaChbZC5pc0Z1bmN0aW9uKGkub3B0aW9ucy5pdGVtcyk/aS5vcHRpb25zLml0ZW1zLmNhbGwoaS5lbGVtZW50WzBdLGEse2l0ZW06dGhpcy5jdXJyZW50SXRlbX0pOmQoaS5vcHRpb25zLml0ZW1zLGkuZWxlbWVudCksaV0pO3RoaXMuY29udGFpbmVycy5wdXNoKGkpfX1mb3IoZj1jLmxlbmd0aC0xO2Y+PTA7Zi0tKXthPWNbZl1bMV07ZT1jW2ZdWzBdO2g9MDtmb3IoZz1lLmxlbmd0aDtoPGc7aCsrKXtpPWQoZVtoXSk7aS5kYXRhKFwic29ydGFibGUtaXRlbVwiLGEpO2IucHVzaCh7aXRlbTppLGluc3RhbmNlOmEsd2lkdGg6MCxoZWlnaHQ6MCxsZWZ0OjAsdG9wOjB9KX19fSxyZWZyZXNoUG9zaXRpb25zOmZ1bmN0aW9uKGEpe2lmKHRoaXMub2Zmc2V0UGFyZW50JiZcbnRoaXMuaGVscGVyKXRoaXMub2Zmc2V0LnBhcmVudD10aGlzLl9nZXRQYXJlbnRPZmZzZXQoKTtmb3IodmFyIGI9dGhpcy5pdGVtcy5sZW5ndGgtMTtiPj0wO2ItLSl7dmFyIGM9dGhpcy5pdGVtc1tiXSxlPXRoaXMub3B0aW9ucy50b2xlcmFuY2VFbGVtZW50P2QodGhpcy5vcHRpb25zLnRvbGVyYW5jZUVsZW1lbnQsYy5pdGVtKTpjLml0ZW07aWYoIWEpe2Mud2lkdGg9ZS5vdXRlcldpZHRoKCk7Yy5oZWlnaHQ9ZS5vdXRlckhlaWdodCgpfWU9ZS5vZmZzZXQoKTtjLmxlZnQ9ZS5sZWZ0O2MudG9wPWUudG9wfWlmKHRoaXMub3B0aW9ucy5jdXN0b20mJnRoaXMub3B0aW9ucy5jdXN0b20ucmVmcmVzaENvbnRhaW5lcnMpdGhpcy5vcHRpb25zLmN1c3RvbS5yZWZyZXNoQ29udGFpbmVycy5jYWxsKHRoaXMpO2Vsc2UgZm9yKGI9dGhpcy5jb250YWluZXJzLmxlbmd0aC0xO2I+PTA7Yi0tKXtlPXRoaXMuY29udGFpbmVyc1tiXS5lbGVtZW50Lm9mZnNldCgpO3RoaXMuY29udGFpbmVyc1tiXS5jb250YWluZXJDYWNoZS5sZWZ0PVxuZS5sZWZ0O3RoaXMuY29udGFpbmVyc1tiXS5jb250YWluZXJDYWNoZS50b3A9ZS50b3A7dGhpcy5jb250YWluZXJzW2JdLmNvbnRhaW5lckNhY2hlLndpZHRoPXRoaXMuY29udGFpbmVyc1tiXS5lbGVtZW50Lm91dGVyV2lkdGgoKTt0aGlzLmNvbnRhaW5lcnNbYl0uY29udGFpbmVyQ2FjaGUuaGVpZ2h0PXRoaXMuY29udGFpbmVyc1tiXS5lbGVtZW50Lm91dGVySGVpZ2h0KCl9cmV0dXJuIHRoaXN9LF9jcmVhdGVQbGFjZWhvbGRlcjpmdW5jdGlvbihhKXt2YXIgYj1hfHx0aGlzLGM9Yi5vcHRpb25zO2lmKCFjLnBsYWNlaG9sZGVyfHxjLnBsYWNlaG9sZGVyLmNvbnN0cnVjdG9yPT1TdHJpbmcpe3ZhciBlPWMucGxhY2Vob2xkZXI7Yy5wbGFjZWhvbGRlcj17ZWxlbWVudDpmdW5jdGlvbigpe3ZhciBmPWQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChiLmN1cnJlbnRJdGVtWzBdLm5vZGVOYW1lKSkuYWRkQ2xhc3MoZXx8Yi5jdXJyZW50SXRlbVswXS5jbGFzc05hbWUrXCIgdWktc29ydGFibGUtcGxhY2Vob2xkZXJcIikucmVtb3ZlQ2xhc3MoXCJ1aS1zb3J0YWJsZS1oZWxwZXJcIilbMF07XG5pZighZSlmLnN0eWxlLnZpc2liaWxpdHk9XCJoaWRkZW5cIjtyZXR1cm4gZn0sdXBkYXRlOmZ1bmN0aW9uKGYsZyl7aWYoIShlJiYhYy5mb3JjZVBsYWNlaG9sZGVyU2l6ZSkpe2cuaGVpZ2h0KCl8fGcuaGVpZ2h0KGIuY3VycmVudEl0ZW0uaW5uZXJIZWlnaHQoKS1wYXJzZUludChiLmN1cnJlbnRJdGVtLmNzcyhcInBhZGRpbmdUb3BcIil8fDAsMTApLXBhcnNlSW50KGIuY3VycmVudEl0ZW0uY3NzKFwicGFkZGluZ0JvdHRvbVwiKXx8MCwxMCkpO2cud2lkdGgoKXx8Zy53aWR0aChiLmN1cnJlbnRJdGVtLmlubmVyV2lkdGgoKS1wYXJzZUludChiLmN1cnJlbnRJdGVtLmNzcyhcInBhZGRpbmdMZWZ0XCIpfHwwLDEwKS1wYXJzZUludChiLmN1cnJlbnRJdGVtLmNzcyhcInBhZGRpbmdSaWdodFwiKXx8MCwxMCkpfX19fWIucGxhY2Vob2xkZXI9ZChjLnBsYWNlaG9sZGVyLmVsZW1lbnQuY2FsbChiLmVsZW1lbnQsYi5jdXJyZW50SXRlbSkpO2IuY3VycmVudEl0ZW0uYWZ0ZXIoYi5wbGFjZWhvbGRlcik7XG5jLnBsYWNlaG9sZGVyLnVwZGF0ZShiLGIucGxhY2Vob2xkZXIpfSxfY29udGFjdENvbnRhaW5lcnM6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPW51bGwsYz1udWxsLGU9dGhpcy5jb250YWluZXJzLmxlbmd0aC0xO2U+PTA7ZS0tKWlmKCFkLnVpLmNvbnRhaW5zKHRoaXMuY3VycmVudEl0ZW1bMF0sdGhpcy5jb250YWluZXJzW2VdLmVsZW1lbnRbMF0pKWlmKHRoaXMuX2ludGVyc2VjdHNXaXRoKHRoaXMuY29udGFpbmVyc1tlXS5jb250YWluZXJDYWNoZSkpe2lmKCEoYiYmZC51aS5jb250YWlucyh0aGlzLmNvbnRhaW5lcnNbZV0uZWxlbWVudFswXSxiLmVsZW1lbnRbMF0pKSl7Yj10aGlzLmNvbnRhaW5lcnNbZV07Yz1lfX1lbHNlIGlmKHRoaXMuY29udGFpbmVyc1tlXS5jb250YWluZXJDYWNoZS5vdmVyKXt0aGlzLmNvbnRhaW5lcnNbZV0uX3RyaWdnZXIoXCJvdXRcIixhLHRoaXMuX3VpSGFzaCh0aGlzKSk7dGhpcy5jb250YWluZXJzW2VdLmNvbnRhaW5lckNhY2hlLm92ZXI9MH1pZihiKWlmKHRoaXMuY29udGFpbmVycy5sZW5ndGg9PT1cbjEpe3RoaXMuY29udGFpbmVyc1tjXS5fdHJpZ2dlcihcIm92ZXJcIixhLHRoaXMuX3VpSGFzaCh0aGlzKSk7dGhpcy5jb250YWluZXJzW2NdLmNvbnRhaW5lckNhY2hlLm92ZXI9MX1lbHNlIGlmKHRoaXMuY3VycmVudENvbnRhaW5lciE9dGhpcy5jb250YWluZXJzW2NdKXtiPTFFNDtlPW51bGw7Zm9yKHZhciBmPXRoaXMucG9zaXRpb25BYnNbdGhpcy5jb250YWluZXJzW2NdLmZsb2F0aW5nP1wibGVmdFwiOlwidG9wXCJdLGc9dGhpcy5pdGVtcy5sZW5ndGgtMTtnPj0wO2ctLSlpZihkLnVpLmNvbnRhaW5zKHRoaXMuY29udGFpbmVyc1tjXS5lbGVtZW50WzBdLHRoaXMuaXRlbXNbZ10uaXRlbVswXSkpe3ZhciBoPXRoaXMuaXRlbXNbZ11bdGhpcy5jb250YWluZXJzW2NdLmZsb2F0aW5nP1wibGVmdFwiOlwidG9wXCJdO2lmKE1hdGguYWJzKGgtZik8Yil7Yj1NYXRoLmFicyhoLWYpO2U9dGhpcy5pdGVtc1tnXX19aWYoZXx8dGhpcy5vcHRpb25zLmRyb3BPbkVtcHR5KXt0aGlzLmN1cnJlbnRDb250YWluZXI9XG50aGlzLmNvbnRhaW5lcnNbY107ZT90aGlzLl9yZWFycmFuZ2UoYSxlLG51bGwsdHJ1ZSk6dGhpcy5fcmVhcnJhbmdlKGEsbnVsbCx0aGlzLmNvbnRhaW5lcnNbY10uZWxlbWVudCx0cnVlKTt0aGlzLl90cmlnZ2VyKFwiY2hhbmdlXCIsYSx0aGlzLl91aUhhc2goKSk7dGhpcy5jb250YWluZXJzW2NdLl90cmlnZ2VyKFwiY2hhbmdlXCIsYSx0aGlzLl91aUhhc2godGhpcykpO3RoaXMub3B0aW9ucy5wbGFjZWhvbGRlci51cGRhdGUodGhpcy5jdXJyZW50Q29udGFpbmVyLHRoaXMucGxhY2Vob2xkZXIpO3RoaXMuY29udGFpbmVyc1tjXS5fdHJpZ2dlcihcIm92ZXJcIixhLHRoaXMuX3VpSGFzaCh0aGlzKSk7dGhpcy5jb250YWluZXJzW2NdLmNvbnRhaW5lckNhY2hlLm92ZXI9MX19fSxfY3JlYXRlSGVscGVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9uczthPWQuaXNGdW5jdGlvbihiLmhlbHBlcik/ZChiLmhlbHBlci5hcHBseSh0aGlzLmVsZW1lbnRbMF0sW2EsdGhpcy5jdXJyZW50SXRlbV0pKTpcbmIuaGVscGVyPT1cImNsb25lXCI/dGhpcy5jdXJyZW50SXRlbS5jbG9uZSgpOnRoaXMuY3VycmVudEl0ZW07YS5wYXJlbnRzKFwiYm9keVwiKS5sZW5ndGh8fGQoYi5hcHBlbmRUbyE9XCJwYXJlbnRcIj9iLmFwcGVuZFRvOnRoaXMuY3VycmVudEl0ZW1bMF0ucGFyZW50Tm9kZSlbMF0uYXBwZW5kQ2hpbGQoYVswXSk7aWYoYVswXT09dGhpcy5jdXJyZW50SXRlbVswXSl0aGlzLl9zdG9yZWRDU1M9e3dpZHRoOnRoaXMuY3VycmVudEl0ZW1bMF0uc3R5bGUud2lkdGgsaGVpZ2h0OnRoaXMuY3VycmVudEl0ZW1bMF0uc3R5bGUuaGVpZ2h0LHBvc2l0aW9uOnRoaXMuY3VycmVudEl0ZW0uY3NzKFwicG9zaXRpb25cIiksdG9wOnRoaXMuY3VycmVudEl0ZW0uY3NzKFwidG9wXCIpLGxlZnQ6dGhpcy5jdXJyZW50SXRlbS5jc3MoXCJsZWZ0XCIpfTtpZihhWzBdLnN0eWxlLndpZHRoPT1cIlwifHxiLmZvcmNlSGVscGVyU2l6ZSlhLndpZHRoKHRoaXMuY3VycmVudEl0ZW0ud2lkdGgoKSk7aWYoYVswXS5zdHlsZS5oZWlnaHQ9PVxuXCJcInx8Yi5mb3JjZUhlbHBlclNpemUpYS5oZWlnaHQodGhpcy5jdXJyZW50SXRlbS5oZWlnaHQoKSk7cmV0dXJuIGF9LF9hZGp1c3RPZmZzZXRGcm9tSGVscGVyOmZ1bmN0aW9uKGEpe2lmKHR5cGVvZiBhPT1cInN0cmluZ1wiKWE9YS5zcGxpdChcIiBcIik7aWYoZC5pc0FycmF5KGEpKWE9e2xlZnQ6K2FbMF0sdG9wOithWzFdfHwwfTtpZihcImxlZnRcImluIGEpdGhpcy5vZmZzZXQuY2xpY2subGVmdD1hLmxlZnQrdGhpcy5tYXJnaW5zLmxlZnQ7aWYoXCJyaWdodFwiaW4gYSl0aGlzLm9mZnNldC5jbGljay5sZWZ0PXRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgtYS5yaWdodCt0aGlzLm1hcmdpbnMubGVmdDtpZihcInRvcFwiaW4gYSl0aGlzLm9mZnNldC5jbGljay50b3A9YS50b3ArdGhpcy5tYXJnaW5zLnRvcDtpZihcImJvdHRvbVwiaW4gYSl0aGlzLm9mZnNldC5jbGljay50b3A9dGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQtYS5ib3R0b20rdGhpcy5tYXJnaW5zLnRvcH0sX2dldFBhcmVudE9mZnNldDpmdW5jdGlvbigpe3RoaXMub2Zmc2V0UGFyZW50PVxudGhpcy5oZWxwZXIub2Zmc2V0UGFyZW50KCk7dmFyIGE9dGhpcy5vZmZzZXRQYXJlbnQub2Zmc2V0KCk7aWYodGhpcy5jc3NQb3NpdGlvbj09XCJhYnNvbHV0ZVwiJiZ0aGlzLnNjcm9sbFBhcmVudFswXSE9ZG9jdW1lbnQmJmQudWkuY29udGFpbnModGhpcy5zY3JvbGxQYXJlbnRbMF0sdGhpcy5vZmZzZXRQYXJlbnRbMF0pKXthLmxlZnQrPXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKTthLnRvcCs9dGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCl9aWYodGhpcy5vZmZzZXRQYXJlbnRbMF09PWRvY3VtZW50LmJvZHl8fHRoaXMub2Zmc2V0UGFyZW50WzBdLnRhZ05hbWUmJnRoaXMub2Zmc2V0UGFyZW50WzBdLnRhZ05hbWUudG9Mb3dlckNhc2UoKT09XCJodG1sXCImJmQuYnJvd3Nlci5tc2llKWE9e3RvcDowLGxlZnQ6MH07cmV0dXJue3RvcDphLnRvcCsocGFyc2VJbnQodGhpcy5vZmZzZXRQYXJlbnQuY3NzKFwiYm9yZGVyVG9wV2lkdGhcIiksMTApfHwwKSxsZWZ0OmEubGVmdCsocGFyc2VJbnQodGhpcy5vZmZzZXRQYXJlbnQuY3NzKFwiYm9yZGVyTGVmdFdpZHRoXCIpLFxuMTApfHwwKX19LF9nZXRSZWxhdGl2ZU9mZnNldDpmdW5jdGlvbigpe2lmKHRoaXMuY3NzUG9zaXRpb249PVwicmVsYXRpdmVcIil7dmFyIGE9dGhpcy5jdXJyZW50SXRlbS5wb3NpdGlvbigpO3JldHVybnt0b3A6YS50b3AtKHBhcnNlSW50KHRoaXMuaGVscGVyLmNzcyhcInRvcFwiKSwxMCl8fDApK3RoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpLGxlZnQ6YS5sZWZ0LShwYXJzZUludCh0aGlzLmhlbHBlci5jc3MoXCJsZWZ0XCIpLDEwKXx8MCkrdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpfX1lbHNlIHJldHVybnt0b3A6MCxsZWZ0OjB9fSxfY2FjaGVNYXJnaW5zOmZ1bmN0aW9uKCl7dGhpcy5tYXJnaW5zPXtsZWZ0OnBhcnNlSW50KHRoaXMuY3VycmVudEl0ZW0uY3NzKFwibWFyZ2luTGVmdFwiKSwxMCl8fDAsdG9wOnBhcnNlSW50KHRoaXMuY3VycmVudEl0ZW0uY3NzKFwibWFyZ2luVG9wXCIpLDEwKXx8MH19LF9jYWNoZUhlbHBlclByb3BvcnRpb25zOmZ1bmN0aW9uKCl7dGhpcy5oZWxwZXJQcm9wb3J0aW9ucz1cbnt3aWR0aDp0aGlzLmhlbHBlci5vdXRlcldpZHRoKCksaGVpZ2h0OnRoaXMuaGVscGVyLm91dGVySGVpZ2h0KCl9fSxfc2V0Q29udGFpbm1lbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnM7aWYoYS5jb250YWlubWVudD09XCJwYXJlbnRcIilhLmNvbnRhaW5tZW50PXRoaXMuaGVscGVyWzBdLnBhcmVudE5vZGU7aWYoYS5jb250YWlubWVudD09XCJkb2N1bWVudFwifHxhLmNvbnRhaW5tZW50PT1cIndpbmRvd1wiKXRoaXMuY29udGFpbm1lbnQ9WzAtdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdC10aGlzLm9mZnNldC5wYXJlbnQubGVmdCwwLXRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcC10aGlzLm9mZnNldC5wYXJlbnQudG9wLGQoYS5jb250YWlubWVudD09XCJkb2N1bWVudFwiP2RvY3VtZW50OndpbmRvdykud2lkdGgoKS10aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLXRoaXMubWFyZ2lucy5sZWZ0LChkKGEuY29udGFpbm1lbnQ9PVwiZG9jdW1lbnRcIj9kb2N1bWVudDp3aW5kb3cpLmhlaWdodCgpfHxcbmRvY3VtZW50LmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHQpLXRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LXRoaXMubWFyZ2lucy50b3BdO2lmKCEvXihkb2N1bWVudHx3aW5kb3d8cGFyZW50KSQvLnRlc3QoYS5jb250YWlubWVudCkpe3ZhciBiPWQoYS5jb250YWlubWVudClbMF07YT1kKGEuY29udGFpbm1lbnQpLm9mZnNldCgpO3ZhciBjPWQoYikuY3NzKFwib3ZlcmZsb3dcIikhPVwiaGlkZGVuXCI7dGhpcy5jb250YWlubWVudD1bYS5sZWZ0KyhwYXJzZUludChkKGIpLmNzcyhcImJvcmRlckxlZnRXaWR0aFwiKSwxMCl8fDApKyhwYXJzZUludChkKGIpLmNzcyhcInBhZGRpbmdMZWZ0XCIpLDEwKXx8MCktdGhpcy5tYXJnaW5zLmxlZnQsYS50b3ArKHBhcnNlSW50KGQoYikuY3NzKFwiYm9yZGVyVG9wV2lkdGhcIiksMTApfHwwKSsocGFyc2VJbnQoZChiKS5jc3MoXCJwYWRkaW5nVG9wXCIpLDEwKXx8MCktdGhpcy5tYXJnaW5zLnRvcCxhLmxlZnQrKGM/TWF0aC5tYXgoYi5zY3JvbGxXaWR0aCxcbmIub2Zmc2V0V2lkdGgpOmIub2Zmc2V0V2lkdGgpLShwYXJzZUludChkKGIpLmNzcyhcImJvcmRlckxlZnRXaWR0aFwiKSwxMCl8fDApLShwYXJzZUludChkKGIpLmNzcyhcInBhZGRpbmdSaWdodFwiKSwxMCl8fDApLXRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgtdGhpcy5tYXJnaW5zLmxlZnQsYS50b3ArKGM/TWF0aC5tYXgoYi5zY3JvbGxIZWlnaHQsYi5vZmZzZXRIZWlnaHQpOmIub2Zmc2V0SGVpZ2h0KS0ocGFyc2VJbnQoZChiKS5jc3MoXCJib3JkZXJUb3BXaWR0aFwiKSwxMCl8fDApLShwYXJzZUludChkKGIpLmNzcyhcInBhZGRpbmdCb3R0b21cIiksMTApfHwwKS10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC10aGlzLm1hcmdpbnMudG9wXX19LF9jb252ZXJ0UG9zaXRpb25UbzpmdW5jdGlvbihhLGIpe2lmKCFiKWI9dGhpcy5wb3NpdGlvbjthPWE9PVwiYWJzb2x1dGVcIj8xOi0xO3ZhciBjPXRoaXMuY3NzUG9zaXRpb249PVwiYWJzb2x1dGVcIiYmISh0aGlzLnNjcm9sbFBhcmVudFswXSE9XG5kb2N1bWVudCYmZC51aS5jb250YWlucyh0aGlzLnNjcm9sbFBhcmVudFswXSx0aGlzLm9mZnNldFBhcmVudFswXSkpP3RoaXMub2Zmc2V0UGFyZW50OnRoaXMuc2Nyb2xsUGFyZW50LGU9LyhodG1sfGJvZHkpL2kudGVzdChjWzBdLnRhZ05hbWUpO3JldHVybnt0b3A6Yi50b3ArdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wKmErdGhpcy5vZmZzZXQucGFyZW50LnRvcCphLShkLmJyb3dzZXIuc2FmYXJpJiZ0aGlzLmNzc1Bvc2l0aW9uPT1cImZpeGVkXCI/MDoodGhpcy5jc3NQb3NpdGlvbj09XCJmaXhlZFwiPy10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKTplPzA6Yy5zY3JvbGxUb3AoKSkqYSksbGVmdDpiLmxlZnQrdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCphK3RoaXMub2Zmc2V0LnBhcmVudC5sZWZ0KmEtKGQuYnJvd3Nlci5zYWZhcmkmJnRoaXMuY3NzUG9zaXRpb249PVwiZml4ZWRcIj8wOih0aGlzLmNzc1Bvc2l0aW9uPT1cImZpeGVkXCI/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKTpcbmU/MDpjLnNjcm9sbExlZnQoKSkqYSl9fSxfZ2VuZXJhdGVQb3NpdGlvbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsYz10aGlzLmNzc1Bvc2l0aW9uPT1cImFic29sdXRlXCImJiEodGhpcy5zY3JvbGxQYXJlbnRbMF0hPWRvY3VtZW50JiZkLnVpLmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLHRoaXMub2Zmc2V0UGFyZW50WzBdKSk/dGhpcy5vZmZzZXRQYXJlbnQ6dGhpcy5zY3JvbGxQYXJlbnQsZT0vKGh0bWx8Ym9keSkvaS50ZXN0KGNbMF0udGFnTmFtZSk7aWYodGhpcy5jc3NQb3NpdGlvbj09XCJyZWxhdGl2ZVwiJiYhKHRoaXMuc2Nyb2xsUGFyZW50WzBdIT1kb2N1bWVudCYmdGhpcy5zY3JvbGxQYXJlbnRbMF0hPXRoaXMub2Zmc2V0UGFyZW50WzBdKSl0aGlzLm9mZnNldC5yZWxhdGl2ZT10aGlzLl9nZXRSZWxhdGl2ZU9mZnNldCgpO3ZhciBmPWEucGFnZVgsZz1hLnBhZ2VZO2lmKHRoaXMub3JpZ2luYWxQb3NpdGlvbil7aWYodGhpcy5jb250YWlubWVudCl7aWYoYS5wYWdlWC1cbnRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ8dGhpcy5jb250YWlubWVudFswXSlmPXRoaXMuY29udGFpbm1lbnRbMF0rdGhpcy5vZmZzZXQuY2xpY2subGVmdDtpZihhLnBhZ2VZLXRoaXMub2Zmc2V0LmNsaWNrLnRvcDx0aGlzLmNvbnRhaW5tZW50WzFdKWc9dGhpcy5jb250YWlubWVudFsxXSt0aGlzLm9mZnNldC5jbGljay50b3A7aWYoYS5wYWdlWC10aGlzLm9mZnNldC5jbGljay5sZWZ0PnRoaXMuY29udGFpbm1lbnRbMl0pZj10aGlzLmNvbnRhaW5tZW50WzJdK3RoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7aWYoYS5wYWdlWS10aGlzLm9mZnNldC5jbGljay50b3A+dGhpcy5jb250YWlubWVudFszXSlnPXRoaXMuY29udGFpbm1lbnRbM10rdGhpcy5vZmZzZXQuY2xpY2sudG9wfWlmKGIuZ3JpZCl7Zz10aGlzLm9yaWdpbmFsUGFnZVkrTWF0aC5yb3VuZCgoZy10aGlzLm9yaWdpbmFsUGFnZVkpL2IuZ3JpZFsxXSkqYi5ncmlkWzFdO2c9dGhpcy5jb250YWlubWVudD8hKGctdGhpcy5vZmZzZXQuY2xpY2sudG9wPFxudGhpcy5jb250YWlubWVudFsxXXx8Zy10aGlzLm9mZnNldC5jbGljay50b3A+dGhpcy5jb250YWlubWVudFszXSk/ZzohKGctdGhpcy5vZmZzZXQuY2xpY2sudG9wPHRoaXMuY29udGFpbm1lbnRbMV0pP2ctYi5ncmlkWzFdOmcrYi5ncmlkWzFdOmc7Zj10aGlzLm9yaWdpbmFsUGFnZVgrTWF0aC5yb3VuZCgoZi10aGlzLm9yaWdpbmFsUGFnZVgpL2IuZ3JpZFswXSkqYi5ncmlkWzBdO2Y9dGhpcy5jb250YWlubWVudD8hKGYtdGhpcy5vZmZzZXQuY2xpY2subGVmdDx0aGlzLmNvbnRhaW5tZW50WzBdfHxmLXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ+dGhpcy5jb250YWlubWVudFsyXSk/ZjohKGYtdGhpcy5vZmZzZXQuY2xpY2subGVmdDx0aGlzLmNvbnRhaW5tZW50WzBdKT9mLWIuZ3JpZFswXTpmK2IuZ3JpZFswXTpmfX1yZXR1cm57dG9wOmctdGhpcy5vZmZzZXQuY2xpY2sudG9wLXRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcC10aGlzLm9mZnNldC5wYXJlbnQudG9wKyhkLmJyb3dzZXIuc2FmYXJpJiZcbnRoaXMuY3NzUG9zaXRpb249PVwiZml4ZWRcIj8wOnRoaXMuY3NzUG9zaXRpb249PVwiZml4ZWRcIj8tdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCk6ZT8wOmMuc2Nyb2xsVG9wKCkpLGxlZnQ6Zi10aGlzLm9mZnNldC5jbGljay5sZWZ0LXRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQtdGhpcy5vZmZzZXQucGFyZW50LmxlZnQrKGQuYnJvd3Nlci5zYWZhcmkmJnRoaXMuY3NzUG9zaXRpb249PVwiZml4ZWRcIj8wOnRoaXMuY3NzUG9zaXRpb249PVwiZml4ZWRcIj8tdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpOmU/MDpjLnNjcm9sbExlZnQoKSl9fSxfcmVhcnJhbmdlOmZ1bmN0aW9uKGEsYixjLGUpe2M/Y1swXS5hcHBlbmRDaGlsZCh0aGlzLnBsYWNlaG9sZGVyWzBdKTpiLml0ZW1bMF0ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGhpcy5wbGFjZWhvbGRlclswXSx0aGlzLmRpcmVjdGlvbj09XCJkb3duXCI/Yi5pdGVtWzBdOmIuaXRlbVswXS5uZXh0U2libGluZyk7dGhpcy5jb3VudGVyPVxudGhpcy5jb3VudGVyPysrdGhpcy5jb3VudGVyOjE7dmFyIGY9dGhpcyxnPXRoaXMuY291bnRlcjt3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe2c9PWYuY291bnRlciYmZi5yZWZyZXNoUG9zaXRpb25zKCFlKX0sMCl9LF9jbGVhcjpmdW5jdGlvbihhLGIpe3RoaXMucmV2ZXJ0aW5nPWZhbHNlO3ZhciBjPVtdOyF0aGlzLl9ub0ZpbmFsU29ydCYmdGhpcy5jdXJyZW50SXRlbVswXS5wYXJlbnROb2RlJiZ0aGlzLnBsYWNlaG9sZGVyLmJlZm9yZSh0aGlzLmN1cnJlbnRJdGVtKTt0aGlzLl9ub0ZpbmFsU29ydD1udWxsO2lmKHRoaXMuaGVscGVyWzBdPT10aGlzLmN1cnJlbnRJdGVtWzBdKXtmb3IodmFyIGUgaW4gdGhpcy5fc3RvcmVkQ1NTKWlmKHRoaXMuX3N0b3JlZENTU1tlXT09XCJhdXRvXCJ8fHRoaXMuX3N0b3JlZENTU1tlXT09XCJzdGF0aWNcIil0aGlzLl9zdG9yZWRDU1NbZV09XCJcIjt0aGlzLmN1cnJlbnRJdGVtLmNzcyh0aGlzLl9zdG9yZWRDU1MpLnJlbW92ZUNsYXNzKFwidWktc29ydGFibGUtaGVscGVyXCIpfWVsc2UgdGhpcy5jdXJyZW50SXRlbS5zaG93KCk7XG50aGlzLmZyb21PdXRzaWRlJiYhYiYmYy5wdXNoKGZ1bmN0aW9uKGYpe3RoaXMuX3RyaWdnZXIoXCJyZWNlaXZlXCIsZix0aGlzLl91aUhhc2godGhpcy5mcm9tT3V0c2lkZSkpfSk7aWYoKHRoaXMuZnJvbU91dHNpZGV8fHRoaXMuZG9tUG9zaXRpb24ucHJldiE9dGhpcy5jdXJyZW50SXRlbS5wcmV2KCkubm90KFwiLnVpLXNvcnRhYmxlLWhlbHBlclwiKVswXXx8dGhpcy5kb21Qb3NpdGlvbi5wYXJlbnQhPXRoaXMuY3VycmVudEl0ZW0ucGFyZW50KClbMF0pJiYhYiljLnB1c2goZnVuY3Rpb24oZil7dGhpcy5fdHJpZ2dlcihcInVwZGF0ZVwiLGYsdGhpcy5fdWlIYXNoKCkpfSk7aWYoIWQudWkuY29udGFpbnModGhpcy5lbGVtZW50WzBdLHRoaXMuY3VycmVudEl0ZW1bMF0pKXtifHxjLnB1c2goZnVuY3Rpb24oZil7dGhpcy5fdHJpZ2dlcihcInJlbW92ZVwiLGYsdGhpcy5fdWlIYXNoKCkpfSk7Zm9yKGU9dGhpcy5jb250YWluZXJzLmxlbmd0aC0xO2U+PTA7ZS0tKWlmKGQudWkuY29udGFpbnModGhpcy5jb250YWluZXJzW2VdLmVsZW1lbnRbMF0sXG50aGlzLmN1cnJlbnRJdGVtWzBdKSYmIWIpe2MucHVzaChmdW5jdGlvbihmKXtyZXR1cm4gZnVuY3Rpb24oZyl7Zi5fdHJpZ2dlcihcInJlY2VpdmVcIixnLHRoaXMuX3VpSGFzaCh0aGlzKSl9fS5jYWxsKHRoaXMsdGhpcy5jb250YWluZXJzW2VdKSk7Yy5wdXNoKGZ1bmN0aW9uKGYpe3JldHVybiBmdW5jdGlvbihnKXtmLl90cmlnZ2VyKFwidXBkYXRlXCIsZyx0aGlzLl91aUhhc2godGhpcykpfX0uY2FsbCh0aGlzLHRoaXMuY29udGFpbmVyc1tlXSkpfX1mb3IoZT10aGlzLmNvbnRhaW5lcnMubGVuZ3RoLTE7ZT49MDtlLS0pe2J8fGMucHVzaChmdW5jdGlvbihmKXtyZXR1cm4gZnVuY3Rpb24oZyl7Zi5fdHJpZ2dlcihcImRlYWN0aXZhdGVcIixnLHRoaXMuX3VpSGFzaCh0aGlzKSl9fS5jYWxsKHRoaXMsdGhpcy5jb250YWluZXJzW2VdKSk7aWYodGhpcy5jb250YWluZXJzW2VdLmNvbnRhaW5lckNhY2hlLm92ZXIpe2MucHVzaChmdW5jdGlvbihmKXtyZXR1cm4gZnVuY3Rpb24oZyl7Zi5fdHJpZ2dlcihcIm91dFwiLFxuZyx0aGlzLl91aUhhc2godGhpcykpfX0uY2FsbCh0aGlzLHRoaXMuY29udGFpbmVyc1tlXSkpO3RoaXMuY29udGFpbmVyc1tlXS5jb250YWluZXJDYWNoZS5vdmVyPTB9fXRoaXMuX3N0b3JlZEN1cnNvciYmZChcImJvZHlcIikuY3NzKFwiY3Vyc29yXCIsdGhpcy5fc3RvcmVkQ3Vyc29yKTt0aGlzLl9zdG9yZWRPcGFjaXR5JiZ0aGlzLmhlbHBlci5jc3MoXCJvcGFjaXR5XCIsdGhpcy5fc3RvcmVkT3BhY2l0eSk7aWYodGhpcy5fc3RvcmVkWkluZGV4KXRoaXMuaGVscGVyLmNzcyhcInpJbmRleFwiLHRoaXMuX3N0b3JlZFpJbmRleD09XCJhdXRvXCI/XCJcIjp0aGlzLl9zdG9yZWRaSW5kZXgpO3RoaXMuZHJhZ2dpbmc9ZmFsc2U7aWYodGhpcy5jYW5jZWxIZWxwZXJSZW1vdmFsKXtpZighYil7dGhpcy5fdHJpZ2dlcihcImJlZm9yZVN0b3BcIixhLHRoaXMuX3VpSGFzaCgpKTtmb3IoZT0wO2U8Yy5sZW5ndGg7ZSsrKWNbZV0uY2FsbCh0aGlzLGEpO3RoaXMuX3RyaWdnZXIoXCJzdG9wXCIsYSx0aGlzLl91aUhhc2goKSl9cmV0dXJuIGZhbHNlfWJ8fFxudGhpcy5fdHJpZ2dlcihcImJlZm9yZVN0b3BcIixhLHRoaXMuX3VpSGFzaCgpKTt0aGlzLnBsYWNlaG9sZGVyWzBdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5wbGFjZWhvbGRlclswXSk7dGhpcy5oZWxwZXJbMF0hPXRoaXMuY3VycmVudEl0ZW1bMF0mJnRoaXMuaGVscGVyLnJlbW92ZSgpO3RoaXMuaGVscGVyPW51bGw7aWYoIWIpe2ZvcihlPTA7ZTxjLmxlbmd0aDtlKyspY1tlXS5jYWxsKHRoaXMsYSk7dGhpcy5fdHJpZ2dlcihcInN0b3BcIixhLHRoaXMuX3VpSGFzaCgpKX10aGlzLmZyb21PdXRzaWRlPWZhbHNlO3JldHVybiB0cnVlfSxfdHJpZ2dlcjpmdW5jdGlvbigpe2QuV2lkZ2V0LnByb3RvdHlwZS5fdHJpZ2dlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk9PT1mYWxzZSYmdGhpcy5jYW5jZWwoKX0sX3VpSGFzaDpmdW5jdGlvbihhKXt2YXIgYj1hfHx0aGlzO3JldHVybntoZWxwZXI6Yi5oZWxwZXIscGxhY2Vob2xkZXI6Yi5wbGFjZWhvbGRlcnx8ZChbXSkscG9zaXRpb246Yi5wb3NpdGlvbixcbm9yaWdpbmFsUG9zaXRpb246Yi5vcmlnaW5hbFBvc2l0aW9uLG9mZnNldDpiLnBvc2l0aW9uQWJzLGl0ZW06Yi5jdXJyZW50SXRlbSxzZW5kZXI6YT9hLmVsZW1lbnQ6bnVsbH19fSk7ZC5leHRlbmQoZC51aS5zb3J0YWJsZSx7dmVyc2lvbjpcIjEuOC4xMVwifSl9KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBBY2NvcmRpb24gMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvQWNjb3JkaW9uXG4gKlxuICogRGVwZW5kczpcbiAqXHRqcXVlcnkudWkuY29yZS5qc1xuICpcdGpxdWVyeS51aS53aWRnZXQuanNcbiAqL1xuKGZ1bmN0aW9uKGMpe2Mud2lkZ2V0KFwidWkuYWNjb3JkaW9uXCIse29wdGlvbnM6e2FjdGl2ZTowLGFuaW1hdGVkOlwic2xpZGVcIixhdXRvSGVpZ2h0OnRydWUsY2xlYXJTdHlsZTpmYWxzZSxjb2xsYXBzaWJsZTpmYWxzZSxldmVudDpcImNsaWNrXCIsZmlsbFNwYWNlOmZhbHNlLGhlYWRlcjpcIj4gbGkgPiA6Zmlyc3QtY2hpbGQsPiA6bm90KGxpKTpldmVuXCIsaWNvbnM6e2hlYWRlcjpcInVpLWljb24tdHJpYW5nbGUtMS1lXCIsaGVhZGVyU2VsZWN0ZWQ6XCJ1aS1pY29uLXRyaWFuZ2xlLTEtc1wifSxuYXZpZ2F0aW9uOmZhbHNlLG5hdmlnYXRpb25GaWx0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ocmVmLnRvTG93ZXJDYXNlKCk9PT1sb2NhdGlvbi5ocmVmLnRvTG93ZXJDYXNlKCl9fSxfY3JlYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9uczthLnJ1bm5pbmc9MDthLmVsZW1lbnQuYWRkQ2xhc3MoXCJ1aS1hY2NvcmRpb24gdWktd2lkZ2V0IHVpLWhlbHBlci1yZXNldFwiKS5jaGlsZHJlbihcImxpXCIpLmFkZENsYXNzKFwidWktYWNjb3JkaW9uLWxpLWZpeFwiKTtcbmEuaGVhZGVycz1hLmVsZW1lbnQuZmluZChiLmhlYWRlcikuYWRkQ2xhc3MoXCJ1aS1hY2NvcmRpb24taGVhZGVyIHVpLWhlbHBlci1yZXNldCB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGxcIikuYmluZChcIm1vdXNlZW50ZXIuYWNjb3JkaW9uXCIsZnVuY3Rpb24oKXtiLmRpc2FibGVkfHxjKHRoaXMpLmFkZENsYXNzKFwidWktc3RhdGUtaG92ZXJcIil9KS5iaW5kKFwibW91c2VsZWF2ZS5hY2NvcmRpb25cIixmdW5jdGlvbigpe2IuZGlzYWJsZWR8fGModGhpcykucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1ob3ZlclwiKX0pLmJpbmQoXCJmb2N1cy5hY2NvcmRpb25cIixmdW5jdGlvbigpe2IuZGlzYWJsZWR8fGModGhpcykuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1mb2N1c1wiKX0pLmJpbmQoXCJibHVyLmFjY29yZGlvblwiLGZ1bmN0aW9uKCl7Yi5kaXNhYmxlZHx8Yyh0aGlzKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWZvY3VzXCIpfSk7YS5oZWFkZXJzLm5leHQoKS5hZGRDbGFzcyhcInVpLWFjY29yZGlvbi1jb250ZW50IHVpLWhlbHBlci1yZXNldCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYm90dG9tXCIpO1xuaWYoYi5uYXZpZ2F0aW9uKXt2YXIgZD1hLmVsZW1lbnQuZmluZChcImFcIikuZmlsdGVyKGIubmF2aWdhdGlvbkZpbHRlcikuZXEoMCk7aWYoZC5sZW5ndGgpe3ZhciBoPWQuY2xvc2VzdChcIi51aS1hY2NvcmRpb24taGVhZGVyXCIpO2EuYWN0aXZlPWgubGVuZ3RoP2g6ZC5jbG9zZXN0KFwiLnVpLWFjY29yZGlvbi1jb250ZW50XCIpLnByZXYoKX19YS5hY3RpdmU9YS5fZmluZEFjdGl2ZShhLmFjdGl2ZXx8Yi5hY3RpdmUpLmFkZENsYXNzKFwidWktc3RhdGUtZGVmYXVsdCB1aS1zdGF0ZS1hY3RpdmVcIikudG9nZ2xlQ2xhc3MoXCJ1aS1jb3JuZXItYWxsXCIpLnRvZ2dsZUNsYXNzKFwidWktY29ybmVyLXRvcFwiKTthLmFjdGl2ZS5uZXh0KCkuYWRkQ2xhc3MoXCJ1aS1hY2NvcmRpb24tY29udGVudC1hY3RpdmVcIik7YS5fY3JlYXRlSWNvbnMoKTthLnJlc2l6ZSgpO2EuZWxlbWVudC5hdHRyKFwicm9sZVwiLFwidGFibGlzdFwiKTthLmhlYWRlcnMuYXR0cihcInJvbGVcIixcInRhYlwiKS5iaW5kKFwia2V5ZG93bi5hY2NvcmRpb25cIixcbmZ1bmN0aW9uKGYpe3JldHVybiBhLl9rZXlkb3duKGYpfSkubmV4dCgpLmF0dHIoXCJyb2xlXCIsXCJ0YWJwYW5lbFwiKTthLmhlYWRlcnMubm90KGEuYWN0aXZlfHxcIlwiKS5hdHRyKHtcImFyaWEtZXhwYW5kZWRcIjpcImZhbHNlXCIsXCJhcmlhLXNlbGVjdGVkXCI6XCJmYWxzZVwiLHRhYkluZGV4Oi0xfSkubmV4dCgpLmhpZGUoKTthLmFjdGl2ZS5sZW5ndGg/YS5hY3RpdmUuYXR0cih7XCJhcmlhLWV4cGFuZGVkXCI6XCJ0cnVlXCIsXCJhcmlhLXNlbGVjdGVkXCI6XCJ0cnVlXCIsdGFiSW5kZXg6MH0pOmEuaGVhZGVycy5lcSgwKS5hdHRyKFwidGFiSW5kZXhcIiwwKTtjLmJyb3dzZXIuc2FmYXJpfHxhLmhlYWRlcnMuZmluZChcImFcIikuYXR0cihcInRhYkluZGV4XCIsLTEpO2IuZXZlbnQmJmEuaGVhZGVycy5iaW5kKGIuZXZlbnQuc3BsaXQoXCIgXCIpLmpvaW4oXCIuYWNjb3JkaW9uIFwiKStcIi5hY2NvcmRpb25cIixmdW5jdGlvbihmKXthLl9jbGlja0hhbmRsZXIuY2FsbChhLGYsdGhpcyk7Zi5wcmV2ZW50RGVmYXVsdCgpfSl9LF9jcmVhdGVJY29uczpmdW5jdGlvbigpe3ZhciBhPVxudGhpcy5vcHRpb25zO2lmKGEuaWNvbnMpe2MoXCI8c3Bhbj48L3NwYW4+XCIpLmFkZENsYXNzKFwidWktaWNvbiBcIithLmljb25zLmhlYWRlcikucHJlcGVuZFRvKHRoaXMuaGVhZGVycyk7dGhpcy5hY3RpdmUuY2hpbGRyZW4oXCIudWktaWNvblwiKS50b2dnbGVDbGFzcyhhLmljb25zLmhlYWRlcikudG9nZ2xlQ2xhc3MoYS5pY29ucy5oZWFkZXJTZWxlY3RlZCk7dGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktYWNjb3JkaW9uLWljb25zXCIpfX0sX2Rlc3Ryb3lJY29uczpmdW5jdGlvbigpe3RoaXMuaGVhZGVycy5jaGlsZHJlbihcIi51aS1pY29uXCIpLnJlbW92ZSgpO3RoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyhcInVpLWFjY29yZGlvbi1pY29uc1wiKX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9uczt0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJ1aS1hY2NvcmRpb24gdWktd2lkZ2V0IHVpLWhlbHBlci1yZXNldFwiKS5yZW1vdmVBdHRyKFwicm9sZVwiKTt0aGlzLmhlYWRlcnMudW5iaW5kKFwiLmFjY29yZGlvblwiKS5yZW1vdmVDbGFzcyhcInVpLWFjY29yZGlvbi1oZWFkZXIgdWktYWNjb3JkaW9uLWRpc2FibGVkIHVpLWhlbHBlci1yZXNldCB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwgdWktc3RhdGUtYWN0aXZlIHVpLXN0YXRlLWRpc2FibGVkIHVpLWNvcm5lci10b3BcIikucmVtb3ZlQXR0cihcInJvbGVcIikucmVtb3ZlQXR0cihcImFyaWEtZXhwYW5kZWRcIikucmVtb3ZlQXR0cihcImFyaWEtc2VsZWN0ZWRcIikucmVtb3ZlQXR0cihcInRhYkluZGV4XCIpO1xudGhpcy5oZWFkZXJzLmZpbmQoXCJhXCIpLnJlbW92ZUF0dHIoXCJ0YWJJbmRleFwiKTt0aGlzLl9kZXN0cm95SWNvbnMoKTt2YXIgYj10aGlzLmhlYWRlcnMubmV4dCgpLmNzcyhcImRpc3BsYXlcIixcIlwiKS5yZW1vdmVBdHRyKFwicm9sZVwiKS5yZW1vdmVDbGFzcyhcInVpLWhlbHBlci1yZXNldCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYm90dG9tIHVpLWFjY29yZGlvbi1jb250ZW50IHVpLWFjY29yZGlvbi1jb250ZW50LWFjdGl2ZSB1aS1hY2NvcmRpb24tZGlzYWJsZWQgdWktc3RhdGUtZGlzYWJsZWRcIik7aWYoYS5hdXRvSGVpZ2h0fHxhLmZpbGxIZWlnaHQpYi5jc3MoXCJoZWlnaHRcIixcIlwiKTtyZXR1cm4gYy5XaWRnZXQucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKX0sX3NldE9wdGlvbjpmdW5jdGlvbihhLGIpe2MuV2lkZ2V0LnByb3RvdHlwZS5fc2V0T3B0aW9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTthPT1cImFjdGl2ZVwiJiZ0aGlzLmFjdGl2YXRlKGIpO2lmKGE9PVwiaWNvbnNcIil7dGhpcy5fZGVzdHJveUljb25zKCk7XG5iJiZ0aGlzLl9jcmVhdGVJY29ucygpfWlmKGE9PVwiZGlzYWJsZWRcIil0aGlzLmhlYWRlcnMuYWRkKHRoaXMuaGVhZGVycy5uZXh0KCkpW2I/XCJhZGRDbGFzc1wiOlwicmVtb3ZlQ2xhc3NcIl0oXCJ1aS1hY2NvcmRpb24tZGlzYWJsZWQgdWktc3RhdGUtZGlzYWJsZWRcIil9LF9rZXlkb3duOmZ1bmN0aW9uKGEpe2lmKCEodGhpcy5vcHRpb25zLmRpc2FibGVkfHxhLmFsdEtleXx8YS5jdHJsS2V5KSl7dmFyIGI9Yy51aS5rZXlDb2RlLGQ9dGhpcy5oZWFkZXJzLmxlbmd0aCxoPXRoaXMuaGVhZGVycy5pbmRleChhLnRhcmdldCksZj1mYWxzZTtzd2l0Y2goYS5rZXlDb2RlKXtjYXNlIGIuUklHSFQ6Y2FzZSBiLkRPV046Zj10aGlzLmhlYWRlcnNbKGgrMSklZF07YnJlYWs7Y2FzZSBiLkxFRlQ6Y2FzZSBiLlVQOmY9dGhpcy5oZWFkZXJzWyhoLTErZCklZF07YnJlYWs7Y2FzZSBiLlNQQUNFOmNhc2UgYi5FTlRFUjp0aGlzLl9jbGlja0hhbmRsZXIoe3RhcmdldDphLnRhcmdldH0sYS50YXJnZXQpO1xuYS5wcmV2ZW50RGVmYXVsdCgpfWlmKGYpe2MoYS50YXJnZXQpLmF0dHIoXCJ0YWJJbmRleFwiLC0xKTtjKGYpLmF0dHIoXCJ0YWJJbmRleFwiLDApO2YuZm9jdXMoKTtyZXR1cm4gZmFsc2V9cmV0dXJuIHRydWV9fSxyZXNpemU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYjtpZihhLmZpbGxTcGFjZSl7aWYoYy5icm93c2VyLm1zaWUpe3ZhciBkPXRoaXMuZWxlbWVudC5wYXJlbnQoKS5jc3MoXCJvdmVyZmxvd1wiKTt0aGlzLmVsZW1lbnQucGFyZW50KCkuY3NzKFwib3ZlcmZsb3dcIixcImhpZGRlblwiKX1iPXRoaXMuZWxlbWVudC5wYXJlbnQoKS5oZWlnaHQoKTtjLmJyb3dzZXIubXNpZSYmdGhpcy5lbGVtZW50LnBhcmVudCgpLmNzcyhcIm92ZXJmbG93XCIsZCk7dGhpcy5oZWFkZXJzLmVhY2goZnVuY3Rpb24oKXtiLT1jKHRoaXMpLm91dGVySGVpZ2h0KHRydWUpfSk7dGhpcy5oZWFkZXJzLm5leHQoKS5lYWNoKGZ1bmN0aW9uKCl7Yyh0aGlzKS5oZWlnaHQoTWF0aC5tYXgoMCxiLWModGhpcykuaW5uZXJIZWlnaHQoKStcbmModGhpcykuaGVpZ2h0KCkpKX0pLmNzcyhcIm92ZXJmbG93XCIsXCJhdXRvXCIpfWVsc2UgaWYoYS5hdXRvSGVpZ2h0KXtiPTA7dGhpcy5oZWFkZXJzLm5leHQoKS5lYWNoKGZ1bmN0aW9uKCl7Yj1NYXRoLm1heChiLGModGhpcykuaGVpZ2h0KFwiXCIpLmhlaWdodCgpKX0pLmhlaWdodChiKX1yZXR1cm4gdGhpc30sYWN0aXZhdGU6ZnVuY3Rpb24oYSl7dGhpcy5vcHRpb25zLmFjdGl2ZT1hO2E9dGhpcy5fZmluZEFjdGl2ZShhKVswXTt0aGlzLl9jbGlja0hhbmRsZXIoe3RhcmdldDphfSxhKTtyZXR1cm4gdGhpc30sX2ZpbmRBY3RpdmU6ZnVuY3Rpb24oYSl7cmV0dXJuIGE/dHlwZW9mIGE9PT1cIm51bWJlclwiP3RoaXMuaGVhZGVycy5maWx0ZXIoXCI6ZXEoXCIrYStcIilcIik6dGhpcy5oZWFkZXJzLm5vdCh0aGlzLmhlYWRlcnMubm90KGEpKTphPT09ZmFsc2U/YyhbXSk6dGhpcy5oZWFkZXJzLmZpbHRlcihcIjplcSgwKVwiKX0sX2NsaWNrSGFuZGxlcjpmdW5jdGlvbihhLGIpe3ZhciBkPXRoaXMub3B0aW9ucztcbmlmKCFkLmRpc2FibGVkKWlmKGEudGFyZ2V0KXthPWMoYS5jdXJyZW50VGFyZ2V0fHxiKTtiPWFbMF09PT10aGlzLmFjdGl2ZVswXTtkLmFjdGl2ZT1kLmNvbGxhcHNpYmxlJiZiP2ZhbHNlOnRoaXMuaGVhZGVycy5pbmRleChhKTtpZighKHRoaXMucnVubmluZ3x8IWQuY29sbGFwc2libGUmJmIpKXt2YXIgaD10aGlzLmFjdGl2ZTtqPWEubmV4dCgpO2c9dGhpcy5hY3RpdmUubmV4dCgpO2U9e29wdGlvbnM6ZCxuZXdIZWFkZXI6YiYmZC5jb2xsYXBzaWJsZT9jKFtdKTphLG9sZEhlYWRlcjp0aGlzLmFjdGl2ZSxuZXdDb250ZW50OmImJmQuY29sbGFwc2libGU/YyhbXSk6aixvbGRDb250ZW50Omd9O3ZhciBmPXRoaXMuaGVhZGVycy5pbmRleCh0aGlzLmFjdGl2ZVswXSk+dGhpcy5oZWFkZXJzLmluZGV4KGFbMF0pO3RoaXMuYWN0aXZlPWI/YyhbXSk6YTt0aGlzLl90b2dnbGUoaixnLGUsYixmKTtoLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtYWN0aXZlIHVpLWNvcm5lci10b3BcIikuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGxcIikuY2hpbGRyZW4oXCIudWktaWNvblwiKS5yZW1vdmVDbGFzcyhkLmljb25zLmhlYWRlclNlbGVjdGVkKS5hZGRDbGFzcyhkLmljb25zLmhlYWRlcik7XG5pZighYil7YS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbFwiKS5hZGRDbGFzcyhcInVpLXN0YXRlLWFjdGl2ZSB1aS1jb3JuZXItdG9wXCIpLmNoaWxkcmVuKFwiLnVpLWljb25cIikucmVtb3ZlQ2xhc3MoZC5pY29ucy5oZWFkZXIpLmFkZENsYXNzKGQuaWNvbnMuaGVhZGVyU2VsZWN0ZWQpO2EubmV4dCgpLmFkZENsYXNzKFwidWktYWNjb3JkaW9uLWNvbnRlbnQtYWN0aXZlXCIpfX19ZWxzZSBpZihkLmNvbGxhcHNpYmxlKXt0aGlzLmFjdGl2ZS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWFjdGl2ZSB1aS1jb3JuZXItdG9wXCIpLmFkZENsYXNzKFwidWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsXCIpLmNoaWxkcmVuKFwiLnVpLWljb25cIikucmVtb3ZlQ2xhc3MoZC5pY29ucy5oZWFkZXJTZWxlY3RlZCkuYWRkQ2xhc3MoZC5pY29ucy5oZWFkZXIpO3RoaXMuYWN0aXZlLm5leHQoKS5hZGRDbGFzcyhcInVpLWFjY29yZGlvbi1jb250ZW50LWFjdGl2ZVwiKTt2YXIgZz10aGlzLmFjdGl2ZS5uZXh0KCksXG5lPXtvcHRpb25zOmQsbmV3SGVhZGVyOmMoW10pLG9sZEhlYWRlcjpkLmFjdGl2ZSxuZXdDb250ZW50OmMoW10pLG9sZENvbnRlbnQ6Z30saj10aGlzLmFjdGl2ZT1jKFtdKTt0aGlzLl90b2dnbGUoaixnLGUpfX0sX3RvZ2dsZTpmdW5jdGlvbihhLGIsZCxoLGYpe3ZhciBnPXRoaXMsZT1nLm9wdGlvbnM7Zy50b1Nob3c9YTtnLnRvSGlkZT1iO2cuZGF0YT1kO3ZhciBqPWZ1bmN0aW9uKCl7aWYoZylyZXR1cm4gZy5fY29tcGxldGVkLmFwcGx5KGcsYXJndW1lbnRzKX07Zy5fdHJpZ2dlcihcImNoYW5nZXN0YXJ0XCIsbnVsbCxnLmRhdGEpO2cucnVubmluZz1iLnNpemUoKT09PTA/YS5zaXplKCk6Yi5zaXplKCk7aWYoZS5hbmltYXRlZCl7ZD17fTtkPWUuY29sbGFwc2libGUmJmg/e3RvU2hvdzpjKFtdKSx0b0hpZGU6Yixjb21wbGV0ZTpqLGRvd246ZixhdXRvSGVpZ2h0OmUuYXV0b0hlaWdodHx8ZS5maWxsU3BhY2V9Ont0b1Nob3c6YSx0b0hpZGU6Yixjb21wbGV0ZTpqLGRvd246ZixhdXRvSGVpZ2h0OmUuYXV0b0hlaWdodHx8XG5lLmZpbGxTcGFjZX07aWYoIWUucHJveGllZCllLnByb3hpZWQ9ZS5hbmltYXRlZDtpZighZS5wcm94aWVkRHVyYXRpb24pZS5wcm94aWVkRHVyYXRpb249ZS5kdXJhdGlvbjtlLmFuaW1hdGVkPWMuaXNGdW5jdGlvbihlLnByb3hpZWQpP2UucHJveGllZChkKTplLnByb3hpZWQ7ZS5kdXJhdGlvbj1jLmlzRnVuY3Rpb24oZS5wcm94aWVkRHVyYXRpb24pP2UucHJveGllZER1cmF0aW9uKGQpOmUucHJveGllZER1cmF0aW9uO2g9Yy51aS5hY2NvcmRpb24uYW5pbWF0aW9uczt2YXIgaT1lLmR1cmF0aW9uLGs9ZS5hbmltYXRlZDtpZihrJiYhaFtrXSYmIWMuZWFzaW5nW2tdKWs9XCJzbGlkZVwiO2hba118fChoW2tdPWZ1bmN0aW9uKGwpe3RoaXMuc2xpZGUobCx7ZWFzaW5nOmssZHVyYXRpb246aXx8NzAwfSl9KTtoW2tdKGQpfWVsc2V7aWYoZS5jb2xsYXBzaWJsZSYmaClhLnRvZ2dsZSgpO2Vsc2V7Yi5oaWRlKCk7YS5zaG93KCl9aih0cnVlKX1iLnByZXYoKS5hdHRyKHtcImFyaWEtZXhwYW5kZWRcIjpcImZhbHNlXCIsXG5cImFyaWEtc2VsZWN0ZWRcIjpcImZhbHNlXCIsdGFiSW5kZXg6LTF9KS5ibHVyKCk7YS5wcmV2KCkuYXR0cih7XCJhcmlhLWV4cGFuZGVkXCI6XCJ0cnVlXCIsXCJhcmlhLXNlbGVjdGVkXCI6XCJ0cnVlXCIsdGFiSW5kZXg6MH0pLmZvY3VzKCl9LF9jb21wbGV0ZWQ6ZnVuY3Rpb24oYSl7dGhpcy5ydW5uaW5nPWE/MDotLXRoaXMucnVubmluZztpZighdGhpcy5ydW5uaW5nKXt0aGlzLm9wdGlvbnMuY2xlYXJTdHlsZSYmdGhpcy50b1Nob3cuYWRkKHRoaXMudG9IaWRlKS5jc3Moe2hlaWdodDpcIlwiLG92ZXJmbG93OlwiXCJ9KTt0aGlzLnRvSGlkZS5yZW1vdmVDbGFzcyhcInVpLWFjY29yZGlvbi1jb250ZW50LWFjdGl2ZVwiKTtpZih0aGlzLnRvSGlkZS5sZW5ndGgpdGhpcy50b0hpZGUucGFyZW50KClbMF0uY2xhc3NOYW1lPXRoaXMudG9IaWRlLnBhcmVudCgpWzBdLmNsYXNzTmFtZTt0aGlzLl90cmlnZ2VyKFwiY2hhbmdlXCIsbnVsbCx0aGlzLmRhdGEpfX19KTtjLmV4dGVuZChjLnVpLmFjY29yZGlvbix7dmVyc2lvbjpcIjEuOC4xMVwiLFxuYW5pbWF0aW9uczp7c2xpZGU6ZnVuY3Rpb24oYSxiKXthPWMuZXh0ZW5kKHtlYXNpbmc6XCJzd2luZ1wiLGR1cmF0aW9uOjMwMH0sYSxiKTtpZihhLnRvSGlkZS5zaXplKCkpaWYoYS50b1Nob3cuc2l6ZSgpKXt2YXIgZD1hLnRvU2hvdy5jc3MoXCJvdmVyZmxvd1wiKSxoPTAsZj17fSxnPXt9LGU7Yj1hLnRvU2hvdztlPWJbMF0uc3R5bGUud2lkdGg7Yi53aWR0aChwYXJzZUludChiLnBhcmVudCgpLndpZHRoKCksMTApLXBhcnNlSW50KGIuY3NzKFwicGFkZGluZ0xlZnRcIiksMTApLXBhcnNlSW50KGIuY3NzKFwicGFkZGluZ1JpZ2h0XCIpLDEwKS0ocGFyc2VJbnQoYi5jc3MoXCJib3JkZXJMZWZ0V2lkdGhcIiksMTApfHwwKS0ocGFyc2VJbnQoYi5jc3MoXCJib3JkZXJSaWdodFdpZHRoXCIpLDEwKXx8MCkpO2MuZWFjaChbXCJoZWlnaHRcIixcInBhZGRpbmdUb3BcIixcInBhZGRpbmdCb3R0b21cIl0sZnVuY3Rpb24oaixpKXtnW2ldPVwiaGlkZVwiO2o9KFwiXCIrYy5jc3MoYS50b1Nob3dbMF0saSkpLm1hdGNoKC9eKFtcXGQrLS5dKykoLiopJC8pO1xuZltpXT17dmFsdWU6alsxXSx1bml0OmpbMl18fFwicHhcIn19KTthLnRvU2hvdy5jc3Moe2hlaWdodDowLG92ZXJmbG93OlwiaGlkZGVuXCJ9KS5zaG93KCk7YS50b0hpZGUuZmlsdGVyKFwiOmhpZGRlblwiKS5lYWNoKGEuY29tcGxldGUpLmVuZCgpLmZpbHRlcihcIjp2aXNpYmxlXCIpLmFuaW1hdGUoZyx7c3RlcDpmdW5jdGlvbihqLGkpe2lmKGkucHJvcD09XCJoZWlnaHRcIiloPWkuZW5kLWkuc3RhcnQ9PT0wPzA6KGkubm93LWkuc3RhcnQpLyhpLmVuZC1pLnN0YXJ0KTthLnRvU2hvd1swXS5zdHlsZVtpLnByb3BdPWgqZltpLnByb3BdLnZhbHVlK2ZbaS5wcm9wXS51bml0fSxkdXJhdGlvbjphLmR1cmF0aW9uLGVhc2luZzphLmVhc2luZyxjb21wbGV0ZTpmdW5jdGlvbigpe2EuYXV0b0hlaWdodHx8YS50b1Nob3cuY3NzKFwiaGVpZ2h0XCIsXCJcIik7YS50b1Nob3cuY3NzKHt3aWR0aDplLG92ZXJmbG93OmR9KTthLmNvbXBsZXRlKCl9fSl9ZWxzZSBhLnRvSGlkZS5hbmltYXRlKHtoZWlnaHQ6XCJoaWRlXCIsXG5wYWRkaW5nVG9wOlwiaGlkZVwiLHBhZGRpbmdCb3R0b206XCJoaWRlXCJ9LGEpO2Vsc2UgYS50b1Nob3cuYW5pbWF0ZSh7aGVpZ2h0Olwic2hvd1wiLHBhZGRpbmdUb3A6XCJzaG93XCIscGFkZGluZ0JvdHRvbTpcInNob3dcIn0sYSl9LGJvdW5jZXNsaWRlOmZ1bmN0aW9uKGEpe3RoaXMuc2xpZGUoYSx7ZWFzaW5nOmEuZG93bj9cImVhc2VPdXRCb3VuY2VcIjpcInN3aW5nXCIsZHVyYXRpb246YS5kb3duPzFFMzoyMDB9KX19fSl9KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBBdXRvY29tcGxldGUgMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvQXV0b2NvbXBsZXRlXG4gKlxuICogRGVwZW5kczpcbiAqXHRqcXVlcnkudWkuY29yZS5qc1xuICpcdGpxdWVyeS51aS53aWRnZXQuanNcbiAqXHRqcXVlcnkudWkucG9zaXRpb24uanNcbiAqL1xuKGZ1bmN0aW9uKGQpe3ZhciBlPTA7ZC53aWRnZXQoXCJ1aS5hdXRvY29tcGxldGVcIix7b3B0aW9uczp7YXBwZW5kVG86XCJib2R5XCIsYXV0b0ZvY3VzOmZhbHNlLGRlbGF5OjMwMCxtaW5MZW5ndGg6MSxwb3NpdGlvbjp7bXk6XCJsZWZ0IHRvcFwiLGF0OlwibGVmdCBib3R0b21cIixjb2xsaXNpb246XCJub25lXCJ9LHNvdXJjZTpudWxsfSxwZW5kaW5nOjAsX2NyZWF0ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj10aGlzLmVsZW1lbnRbMF0ub3duZXJEb2N1bWVudCxnO3RoaXMuZWxlbWVudC5hZGRDbGFzcyhcInVpLWF1dG9jb21wbGV0ZS1pbnB1dFwiKS5hdHRyKFwiYXV0b2NvbXBsZXRlXCIsXCJvZmZcIikuYXR0cih7cm9sZTpcInRleHRib3hcIixcImFyaWEtYXV0b2NvbXBsZXRlXCI6XCJsaXN0XCIsXCJhcmlhLWhhc3BvcHVwXCI6XCJ0cnVlXCJ9KS5iaW5kKFwia2V5ZG93bi5hdXRvY29tcGxldGVcIixmdW5jdGlvbihjKXtpZighKGEub3B0aW9ucy5kaXNhYmxlZHx8YS5lbGVtZW50LmF0dHIoXCJyZWFkb25seVwiKSkpe2c9XG5mYWxzZTt2YXIgZj1kLnVpLmtleUNvZGU7c3dpdGNoKGMua2V5Q29kZSl7Y2FzZSBmLlBBR0VfVVA6YS5fbW92ZShcInByZXZpb3VzUGFnZVwiLGMpO2JyZWFrO2Nhc2UgZi5QQUdFX0RPV046YS5fbW92ZShcIm5leHRQYWdlXCIsYyk7YnJlYWs7Y2FzZSBmLlVQOmEuX21vdmUoXCJwcmV2aW91c1wiLGMpO2MucHJldmVudERlZmF1bHQoKTticmVhaztjYXNlIGYuRE9XTjphLl9tb3ZlKFwibmV4dFwiLGMpO2MucHJldmVudERlZmF1bHQoKTticmVhaztjYXNlIGYuRU5URVI6Y2FzZSBmLk5VTVBBRF9FTlRFUjppZihhLm1lbnUuYWN0aXZlKXtnPXRydWU7Yy5wcmV2ZW50RGVmYXVsdCgpfWNhc2UgZi5UQUI6aWYoIWEubWVudS5hY3RpdmUpcmV0dXJuO2EubWVudS5zZWxlY3QoYyk7YnJlYWs7Y2FzZSBmLkVTQ0FQRTphLmVsZW1lbnQudmFsKGEudGVybSk7YS5jbG9zZShjKTticmVhaztkZWZhdWx0OmNsZWFyVGltZW91dChhLnNlYXJjaGluZyk7YS5zZWFyY2hpbmc9c2V0VGltZW91dChmdW5jdGlvbigpe2lmKGEudGVybSE9XG5hLmVsZW1lbnQudmFsKCkpe2Euc2VsZWN0ZWRJdGVtPW51bGw7YS5zZWFyY2gobnVsbCxjKX19LGEub3B0aW9ucy5kZWxheSk7YnJlYWt9fX0pLmJpbmQoXCJrZXlwcmVzcy5hdXRvY29tcGxldGVcIixmdW5jdGlvbihjKXtpZihnKXtnPWZhbHNlO2MucHJldmVudERlZmF1bHQoKX19KS5iaW5kKFwiZm9jdXMuYXV0b2NvbXBsZXRlXCIsZnVuY3Rpb24oKXtpZighYS5vcHRpb25zLmRpc2FibGVkKXthLnNlbGVjdGVkSXRlbT1udWxsO2EucHJldmlvdXM9YS5lbGVtZW50LnZhbCgpfX0pLmJpbmQoXCJibHVyLmF1dG9jb21wbGV0ZVwiLGZ1bmN0aW9uKGMpe2lmKCFhLm9wdGlvbnMuZGlzYWJsZWQpe2NsZWFyVGltZW91dChhLnNlYXJjaGluZyk7YS5jbG9zaW5nPXNldFRpbWVvdXQoZnVuY3Rpb24oKXthLmNsb3NlKGMpO2EuX2NoYW5nZShjKX0sMTUwKX19KTt0aGlzLl9pbml0U291cmNlKCk7dGhpcy5yZXNwb25zZT1mdW5jdGlvbigpe3JldHVybiBhLl9yZXNwb25zZS5hcHBseShhLGFyZ3VtZW50cyl9O1xudGhpcy5tZW51PWQoXCI8dWw+PC91bD5cIikuYWRkQ2xhc3MoXCJ1aS1hdXRvY29tcGxldGVcIikuYXBwZW5kVG8oZCh0aGlzLm9wdGlvbnMuYXBwZW5kVG98fFwiYm9keVwiLGIpWzBdKS5tb3VzZWRvd24oZnVuY3Rpb24oYyl7dmFyIGY9YS5tZW51LmVsZW1lbnRbMF07ZChjLnRhcmdldCkuY2xvc2VzdChcIi51aS1tZW51LWl0ZW1cIikubGVuZ3RofHxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZChkb2N1bWVudCkub25lKFwibW91c2Vkb3duXCIsZnVuY3Rpb24oaCl7aC50YXJnZXQhPT1hLmVsZW1lbnRbMF0mJmgudGFyZ2V0IT09ZiYmIWQudWkuY29udGFpbnMoZixoLnRhcmdldCkmJmEuY2xvc2UoKX0pfSwxKTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KGEuY2xvc2luZyl9LDEzKX0pLm1lbnUoe2ZvY3VzOmZ1bmN0aW9uKGMsZil7Zj1mLml0ZW0uZGF0YShcIml0ZW0uYXV0b2NvbXBsZXRlXCIpO2ZhbHNlIT09YS5fdHJpZ2dlcihcImZvY3VzXCIsYyx7aXRlbTpmfSkmJi9ea2V5Ly50ZXN0KGMub3JpZ2luYWxFdmVudC50eXBlKSYmXG5hLmVsZW1lbnQudmFsKGYudmFsdWUpfSxzZWxlY3RlZDpmdW5jdGlvbihjLGYpe3ZhciBoPWYuaXRlbS5kYXRhKFwiaXRlbS5hdXRvY29tcGxldGVcIiksaT1hLnByZXZpb3VzO2lmKGEuZWxlbWVudFswXSE9PWIuYWN0aXZlRWxlbWVudCl7YS5lbGVtZW50LmZvY3VzKCk7YS5wcmV2aW91cz1pO3NldFRpbWVvdXQoZnVuY3Rpb24oKXthLnByZXZpb3VzPWk7YS5zZWxlY3RlZEl0ZW09aH0sMSl9ZmFsc2UhPT1hLl90cmlnZ2VyKFwic2VsZWN0XCIsYyx7aXRlbTpofSkmJmEuZWxlbWVudC52YWwoaC52YWx1ZSk7YS50ZXJtPWEuZWxlbWVudC52YWwoKTthLmNsb3NlKGMpO2Euc2VsZWN0ZWRJdGVtPWh9LGJsdXI6ZnVuY3Rpb24oKXthLm1lbnUuZWxlbWVudC5pcyhcIjp2aXNpYmxlXCIpJiZhLmVsZW1lbnQudmFsKCkhPT1hLnRlcm0mJmEuZWxlbWVudC52YWwoYS50ZXJtKX19KS56SW5kZXgodGhpcy5lbGVtZW50LnpJbmRleCgpKzEpLmNzcyh7dG9wOjAsbGVmdDowfSkuaGlkZSgpLmRhdGEoXCJtZW51XCIpO1xuZC5mbi5iZ2lmcmFtZSYmdGhpcy5tZW51LmVsZW1lbnQuYmdpZnJhbWUoKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyhcInVpLWF1dG9jb21wbGV0ZS1pbnB1dFwiKS5yZW1vdmVBdHRyKFwiYXV0b2NvbXBsZXRlXCIpLnJlbW92ZUF0dHIoXCJyb2xlXCIpLnJlbW92ZUF0dHIoXCJhcmlhLWF1dG9jb21wbGV0ZVwiKS5yZW1vdmVBdHRyKFwiYXJpYS1oYXNwb3B1cFwiKTt0aGlzLm1lbnUuZWxlbWVudC5yZW1vdmUoKTtkLldpZGdldC5wcm90b3R5cGUuZGVzdHJveS5jYWxsKHRoaXMpfSxfc2V0T3B0aW9uOmZ1bmN0aW9uKGEsYil7ZC5XaWRnZXQucHJvdG90eXBlLl9zZXRPcHRpb24uYXBwbHkodGhpcyxhcmd1bWVudHMpO2E9PT1cInNvdXJjZVwiJiZ0aGlzLl9pbml0U291cmNlKCk7aWYoYT09PVwiYXBwZW5kVG9cIil0aGlzLm1lbnUuZWxlbWVudC5hcHBlbmRUbyhkKGJ8fFwiYm9keVwiLHRoaXMuZWxlbWVudFswXS5vd25lckRvY3VtZW50KVswXSk7YT09PVwiZGlzYWJsZWRcIiYmXG5iJiZ0aGlzLnhociYmdGhpcy54aHIuYWJvcnQoKX0sX2luaXRTb3VyY2U6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGIsZztpZihkLmlzQXJyYXkodGhpcy5vcHRpb25zLnNvdXJjZSkpe2I9dGhpcy5vcHRpb25zLnNvdXJjZTt0aGlzLnNvdXJjZT1mdW5jdGlvbihjLGYpe2YoZC51aS5hdXRvY29tcGxldGUuZmlsdGVyKGIsYy50ZXJtKSl9fWVsc2UgaWYodHlwZW9mIHRoaXMub3B0aW9ucy5zb3VyY2U9PT1cInN0cmluZ1wiKXtnPXRoaXMub3B0aW9ucy5zb3VyY2U7dGhpcy5zb3VyY2U9ZnVuY3Rpb24oYyxmKXthLnhociYmYS54aHIuYWJvcnQoKTthLnhocj1kLmFqYXgoe3VybDpnLGRhdGE6YyxkYXRhVHlwZTpcImpzb25cIixhdXRvY29tcGxldGVSZXF1ZXN0OisrZSxzdWNjZXNzOmZ1bmN0aW9uKGgpe3RoaXMuYXV0b2NvbXBsZXRlUmVxdWVzdD09PWUmJmYoaCl9LGVycm9yOmZ1bmN0aW9uKCl7dGhpcy5hdXRvY29tcGxldGVSZXF1ZXN0PT09ZSYmZihbXSl9fSl9fWVsc2UgdGhpcy5zb3VyY2U9XG50aGlzLm9wdGlvbnMuc291cmNlfSxzZWFyY2g6ZnVuY3Rpb24oYSxiKXthPWEhPW51bGw/YTp0aGlzLmVsZW1lbnQudmFsKCk7dGhpcy50ZXJtPXRoaXMuZWxlbWVudC52YWwoKTtpZihhLmxlbmd0aDx0aGlzLm9wdGlvbnMubWluTGVuZ3RoKXJldHVybiB0aGlzLmNsb3NlKGIpO2NsZWFyVGltZW91dCh0aGlzLmNsb3NpbmcpO2lmKHRoaXMuX3RyaWdnZXIoXCJzZWFyY2hcIixiKSE9PWZhbHNlKXJldHVybiB0aGlzLl9zZWFyY2goYSl9LF9zZWFyY2g6ZnVuY3Rpb24oYSl7dGhpcy5wZW5kaW5nKys7dGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktYXV0b2NvbXBsZXRlLWxvYWRpbmdcIik7dGhpcy5zb3VyY2Uoe3Rlcm06YX0sdGhpcy5yZXNwb25zZSl9LF9yZXNwb25zZTpmdW5jdGlvbihhKXtpZighdGhpcy5vcHRpb25zLmRpc2FibGVkJiZhJiZhLmxlbmd0aCl7YT10aGlzLl9ub3JtYWxpemUoYSk7dGhpcy5fc3VnZ2VzdChhKTt0aGlzLl90cmlnZ2VyKFwib3BlblwiKX1lbHNlIHRoaXMuY2xvc2UoKTtcbnRoaXMucGVuZGluZy0tO3RoaXMucGVuZGluZ3x8dGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKFwidWktYXV0b2NvbXBsZXRlLWxvYWRpbmdcIil9LGNsb3NlOmZ1bmN0aW9uKGEpe2NsZWFyVGltZW91dCh0aGlzLmNsb3NpbmcpO2lmKHRoaXMubWVudS5lbGVtZW50LmlzKFwiOnZpc2libGVcIikpe3RoaXMubWVudS5lbGVtZW50LmhpZGUoKTt0aGlzLm1lbnUuZGVhY3RpdmF0ZSgpO3RoaXMuX3RyaWdnZXIoXCJjbG9zZVwiLGEpfX0sX2NoYW5nZTpmdW5jdGlvbihhKXt0aGlzLnByZXZpb3VzIT09dGhpcy5lbGVtZW50LnZhbCgpJiZ0aGlzLl90cmlnZ2VyKFwiY2hhbmdlXCIsYSx7aXRlbTp0aGlzLnNlbGVjdGVkSXRlbX0pfSxfbm9ybWFsaXplOmZ1bmN0aW9uKGEpe2lmKGEubGVuZ3RoJiZhWzBdLmxhYmVsJiZhWzBdLnZhbHVlKXJldHVybiBhO3JldHVybiBkLm1hcChhLGZ1bmN0aW9uKGIpe2lmKHR5cGVvZiBiPT09XCJzdHJpbmdcIilyZXR1cm57bGFiZWw6Yix2YWx1ZTpifTtyZXR1cm4gZC5leHRlbmQoe2xhYmVsOmIubGFiZWx8fFxuYi52YWx1ZSx2YWx1ZTpiLnZhbHVlfHxiLmxhYmVsfSxiKX0pfSxfc3VnZ2VzdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm1lbnUuZWxlbWVudC5lbXB0eSgpLnpJbmRleCh0aGlzLmVsZW1lbnQuekluZGV4KCkrMSk7dGhpcy5fcmVuZGVyTWVudShiLGEpO3RoaXMubWVudS5kZWFjdGl2YXRlKCk7dGhpcy5tZW51LnJlZnJlc2goKTtiLnNob3coKTt0aGlzLl9yZXNpemVNZW51KCk7Yi5wb3NpdGlvbihkLmV4dGVuZCh7b2Y6dGhpcy5lbGVtZW50fSx0aGlzLm9wdGlvbnMucG9zaXRpb24pKTt0aGlzLm9wdGlvbnMuYXV0b0ZvY3VzJiZ0aGlzLm1lbnUubmV4dChuZXcgZC5FdmVudChcIm1vdXNlb3ZlclwiKSl9LF9yZXNpemVNZW51OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tZW51LmVsZW1lbnQ7YS5vdXRlcldpZHRoKE1hdGgubWF4KGEud2lkdGgoXCJcIikub3V0ZXJXaWR0aCgpLHRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCkpKX0sX3JlbmRlck1lbnU6ZnVuY3Rpb24oYSxiKXt2YXIgZz10aGlzO1xuZC5lYWNoKGIsZnVuY3Rpb24oYyxmKXtnLl9yZW5kZXJJdGVtKGEsZil9KX0sX3JlbmRlckl0ZW06ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZChcIjxsaT48L2xpPlwiKS5kYXRhKFwiaXRlbS5hdXRvY29tcGxldGVcIixiKS5hcHBlbmQoZChcIjxhPjwvYT5cIikudGV4dChiLmxhYmVsKSkuYXBwZW5kVG8oYSl9LF9tb3ZlOmZ1bmN0aW9uKGEsYil7aWYodGhpcy5tZW51LmVsZW1lbnQuaXMoXCI6dmlzaWJsZVwiKSlpZih0aGlzLm1lbnUuZmlyc3QoKSYmL15wcmV2aW91cy8udGVzdChhKXx8dGhpcy5tZW51Lmxhc3QoKSYmL15uZXh0Ly50ZXN0KGEpKXt0aGlzLmVsZW1lbnQudmFsKHRoaXMudGVybSk7dGhpcy5tZW51LmRlYWN0aXZhdGUoKX1lbHNlIHRoaXMubWVudVthXShiKTtlbHNlIHRoaXMuc2VhcmNoKG51bGwsYil9LHdpZGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1lbnUuZWxlbWVudH19KTtkLmV4dGVuZChkLnVpLmF1dG9jb21wbGV0ZSx7ZXNjYXBlUmVnZXg6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZSgvWy1bXFxde30oKSorPy4sXFxcXF4kfCNcXHNdL2csXG5cIlxcXFwkJlwiKX0sZmlsdGVyOmZ1bmN0aW9uKGEsYil7dmFyIGc9bmV3IFJlZ0V4cChkLnVpLmF1dG9jb21wbGV0ZS5lc2NhcGVSZWdleChiKSxcImlcIik7cmV0dXJuIGQuZ3JlcChhLGZ1bmN0aW9uKGMpe3JldHVybiBnLnRlc3QoYy5sYWJlbHx8Yy52YWx1ZXx8Yyl9KX19KX0pKGpRdWVyeSk7XG4oZnVuY3Rpb24oZCl7ZC53aWRnZXQoXCJ1aS5tZW51XCIse19jcmVhdGU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuZWxlbWVudC5hZGRDbGFzcyhcInVpLW1lbnUgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGxcIikuYXR0cih7cm9sZTpcImxpc3Rib3hcIixcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiOlwidWktYWN0aXZlLW1lbnVpdGVtXCJ9KS5jbGljayhmdW5jdGlvbihhKXtpZihkKGEudGFyZ2V0KS5jbG9zZXN0KFwiLnVpLW1lbnUtaXRlbSBhXCIpLmxlbmd0aCl7YS5wcmV2ZW50RGVmYXVsdCgpO2Uuc2VsZWN0KGEpfX0pO3RoaXMucmVmcmVzaCgpfSxyZWZyZXNoOmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLmVsZW1lbnQuY2hpbGRyZW4oXCJsaTpub3QoLnVpLW1lbnUtaXRlbSk6aGFzKGEpXCIpLmFkZENsYXNzKFwidWktbWVudS1pdGVtXCIpLmF0dHIoXCJyb2xlXCIsXCJtZW51aXRlbVwiKS5jaGlsZHJlbihcImFcIikuYWRkQ2xhc3MoXCJ1aS1jb3JuZXItYWxsXCIpLmF0dHIoXCJ0YWJpbmRleFwiLFxuLTEpLm1vdXNlZW50ZXIoZnVuY3Rpb24oYSl7ZS5hY3RpdmF0ZShhLGQodGhpcykucGFyZW50KCkpfSkubW91c2VsZWF2ZShmdW5jdGlvbigpe2UuZGVhY3RpdmF0ZSgpfSl9LGFjdGl2YXRlOmZ1bmN0aW9uKGUsYSl7dGhpcy5kZWFjdGl2YXRlKCk7aWYodGhpcy5oYXNTY3JvbGwoKSl7dmFyIGI9YS5vZmZzZXQoKS50b3AtdGhpcy5lbGVtZW50Lm9mZnNldCgpLnRvcCxnPXRoaXMuZWxlbWVudC5hdHRyKFwic2Nyb2xsVG9wXCIpLGM9dGhpcy5lbGVtZW50LmhlaWdodCgpO2lmKGI8MCl0aGlzLmVsZW1lbnQuYXR0cihcInNjcm9sbFRvcFwiLGcrYik7ZWxzZSBiPj1jJiZ0aGlzLmVsZW1lbnQuYXR0cihcInNjcm9sbFRvcFwiLGcrYi1jK2EuaGVpZ2h0KCkpfXRoaXMuYWN0aXZlPWEuZXEoMCkuY2hpbGRyZW4oXCJhXCIpLmFkZENsYXNzKFwidWktc3RhdGUtaG92ZXJcIikuYXR0cihcImlkXCIsXCJ1aS1hY3RpdmUtbWVudWl0ZW1cIikuZW5kKCk7dGhpcy5fdHJpZ2dlcihcImZvY3VzXCIsZSx7aXRlbTphfSl9LFxuZGVhY3RpdmF0ZTpmdW5jdGlvbigpe2lmKHRoaXMuYWN0aXZlKXt0aGlzLmFjdGl2ZS5jaGlsZHJlbihcImFcIikucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1ob3ZlclwiKS5yZW1vdmVBdHRyKFwiaWRcIik7dGhpcy5fdHJpZ2dlcihcImJsdXJcIik7dGhpcy5hY3RpdmU9bnVsbH19LG5leHQ6ZnVuY3Rpb24oZSl7dGhpcy5tb3ZlKFwibmV4dFwiLFwiLnVpLW1lbnUtaXRlbTpmaXJzdFwiLGUpfSxwcmV2aW91czpmdW5jdGlvbihlKXt0aGlzLm1vdmUoXCJwcmV2XCIsXCIudWktbWVudS1pdGVtOmxhc3RcIixlKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hY3RpdmUmJiF0aGlzLmFjdGl2ZS5wcmV2QWxsKFwiLnVpLW1lbnUtaXRlbVwiKS5sZW5ndGh9LGxhc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hY3RpdmUmJiF0aGlzLmFjdGl2ZS5uZXh0QWxsKFwiLnVpLW1lbnUtaXRlbVwiKS5sZW5ndGh9LG1vdmU6ZnVuY3Rpb24oZSxhLGIpe2lmKHRoaXMuYWN0aXZlKXtlPXRoaXMuYWN0aXZlW2UrXCJBbGxcIl0oXCIudWktbWVudS1pdGVtXCIpLmVxKDApO1xuZS5sZW5ndGg/dGhpcy5hY3RpdmF0ZShiLGUpOnRoaXMuYWN0aXZhdGUoYix0aGlzLmVsZW1lbnQuY2hpbGRyZW4oYSkpfWVsc2UgdGhpcy5hY3RpdmF0ZShiLHRoaXMuZWxlbWVudC5jaGlsZHJlbihhKSl9LG5leHRQYWdlOmZ1bmN0aW9uKGUpe2lmKHRoaXMuaGFzU2Nyb2xsKCkpaWYoIXRoaXMuYWN0aXZlfHx0aGlzLmxhc3QoKSl0aGlzLmFjdGl2YXRlKGUsdGhpcy5lbGVtZW50LmNoaWxkcmVuKFwiLnVpLW1lbnUtaXRlbTpmaXJzdFwiKSk7ZWxzZXt2YXIgYT10aGlzLmFjdGl2ZS5vZmZzZXQoKS50b3AsYj10aGlzLmVsZW1lbnQuaGVpZ2h0KCksZz10aGlzLmVsZW1lbnQuY2hpbGRyZW4oXCIudWktbWVudS1pdGVtXCIpLmZpbHRlcihmdW5jdGlvbigpe3ZhciBjPWQodGhpcykub2Zmc2V0KCkudG9wLWEtYitkKHRoaXMpLmhlaWdodCgpO3JldHVybiBjPDEwJiZjPi0xMH0pO2cubGVuZ3RofHwoZz10aGlzLmVsZW1lbnQuY2hpbGRyZW4oXCIudWktbWVudS1pdGVtOmxhc3RcIikpO3RoaXMuYWN0aXZhdGUoZSxcbmcpfWVsc2UgdGhpcy5hY3RpdmF0ZShlLHRoaXMuZWxlbWVudC5jaGlsZHJlbihcIi51aS1tZW51LWl0ZW1cIikuZmlsdGVyKCF0aGlzLmFjdGl2ZXx8dGhpcy5sYXN0KCk/XCI6Zmlyc3RcIjpcIjpsYXN0XCIpKX0scHJldmlvdXNQYWdlOmZ1bmN0aW9uKGUpe2lmKHRoaXMuaGFzU2Nyb2xsKCkpaWYoIXRoaXMuYWN0aXZlfHx0aGlzLmZpcnN0KCkpdGhpcy5hY3RpdmF0ZShlLHRoaXMuZWxlbWVudC5jaGlsZHJlbihcIi51aS1tZW51LWl0ZW06bGFzdFwiKSk7ZWxzZXt2YXIgYT10aGlzLmFjdGl2ZS5vZmZzZXQoKS50b3AsYj10aGlzLmVsZW1lbnQuaGVpZ2h0KCk7cmVzdWx0PXRoaXMuZWxlbWVudC5jaGlsZHJlbihcIi51aS1tZW51LWl0ZW1cIikuZmlsdGVyKGZ1bmN0aW9uKCl7dmFyIGc9ZCh0aGlzKS5vZmZzZXQoKS50b3AtYStiLWQodGhpcykuaGVpZ2h0KCk7cmV0dXJuIGc8MTAmJmc+LTEwfSk7cmVzdWx0Lmxlbmd0aHx8KHJlc3VsdD10aGlzLmVsZW1lbnQuY2hpbGRyZW4oXCIudWktbWVudS1pdGVtOmZpcnN0XCIpKTtcbnRoaXMuYWN0aXZhdGUoZSxyZXN1bHQpfWVsc2UgdGhpcy5hY3RpdmF0ZShlLHRoaXMuZWxlbWVudC5jaGlsZHJlbihcIi51aS1tZW51LWl0ZW1cIikuZmlsdGVyKCF0aGlzLmFjdGl2ZXx8dGhpcy5maXJzdCgpP1wiOmxhc3RcIjpcIjpmaXJzdFwiKSl9LGhhc1Njcm9sbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVsZW1lbnQuaGVpZ2h0KCk8dGhpcy5lbGVtZW50LmF0dHIoXCJzY3JvbGxIZWlnaHRcIil9LHNlbGVjdDpmdW5jdGlvbihlKXt0aGlzLl90cmlnZ2VyKFwic2VsZWN0ZWRcIixlLHtpdGVtOnRoaXMuYWN0aXZlfSl9fSl9KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBCdXR0b24gMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvQnV0dG9uXG4gKlxuICogRGVwZW5kczpcbiAqXHRqcXVlcnkudWkuY29yZS5qc1xuICpcdGpxdWVyeS51aS53aWRnZXQuanNcbiAqL1xuKGZ1bmN0aW9uKGEpe3ZhciBnLGk9ZnVuY3Rpb24oYil7YShcIjp1aS1idXR0b25cIixiLnRhcmdldC5mb3JtKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGM9YSh0aGlzKS5kYXRhKFwiYnV0dG9uXCIpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtjLnJlZnJlc2goKX0sMSl9KX0saD1mdW5jdGlvbihiKXt2YXIgYz1iLm5hbWUsZD1iLmZvcm0sZj1hKFtdKTtpZihjKWY9ZD9hKGQpLmZpbmQoXCJbbmFtZT0nXCIrYytcIiddXCIpOmEoXCJbbmFtZT0nXCIrYytcIiddXCIsYi5vd25lckRvY3VtZW50KS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5mb3JtfSk7cmV0dXJuIGZ9O2Eud2lkZ2V0KFwidWkuYnV0dG9uXCIse29wdGlvbnM6e2Rpc2FibGVkOm51bGwsdGV4dDp0cnVlLGxhYmVsOm51bGwsaWNvbnM6e3ByaW1hcnk6bnVsbCxzZWNvbmRhcnk6bnVsbH19LF9jcmVhdGU6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQuY2xvc2VzdChcImZvcm1cIikudW5iaW5kKFwicmVzZXQuYnV0dG9uXCIpLmJpbmQoXCJyZXNldC5idXR0b25cIixcbmkpO2lmKHR5cGVvZiB0aGlzLm9wdGlvbnMuZGlzYWJsZWQhPT1cImJvb2xlYW5cIil0aGlzLm9wdGlvbnMuZGlzYWJsZWQ9dGhpcy5lbGVtZW50LmF0dHIoXCJkaXNhYmxlZFwiKTt0aGlzLl9kZXRlcm1pbmVCdXR0b25UeXBlKCk7dGhpcy5oYXNUaXRsZT0hIXRoaXMuYnV0dG9uRWxlbWVudC5hdHRyKFwidGl0bGVcIik7dmFyIGI9dGhpcyxjPXRoaXMub3B0aW9ucyxkPXRoaXMudHlwZT09PVwiY2hlY2tib3hcInx8dGhpcy50eXBlPT09XCJyYWRpb1wiLGY9XCJ1aS1zdGF0ZS1ob3ZlclwiKyghZD9cIiB1aS1zdGF0ZS1hY3RpdmVcIjpcIlwiKTtpZihjLmxhYmVsPT09bnVsbCljLmxhYmVsPXRoaXMuYnV0dG9uRWxlbWVudC5odG1sKCk7aWYodGhpcy5lbGVtZW50LmlzKFwiOmRpc2FibGVkXCIpKWMuZGlzYWJsZWQ9dHJ1ZTt0aGlzLmJ1dHRvbkVsZW1lbnQuYWRkQ2xhc3MoXCJ1aS1idXR0b24gdWktd2lkZ2V0IHVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbFwiKS5hdHRyKFwicm9sZVwiLFwiYnV0dG9uXCIpLmJpbmQoXCJtb3VzZWVudGVyLmJ1dHRvblwiLFxuZnVuY3Rpb24oKXtpZighYy5kaXNhYmxlZCl7YSh0aGlzKS5hZGRDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpO3RoaXM9PT1nJiZhKHRoaXMpLmFkZENsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpfX0pLmJpbmQoXCJtb3VzZWxlYXZlLmJ1dHRvblwiLGZ1bmN0aW9uKCl7Yy5kaXNhYmxlZHx8YSh0aGlzKS5yZW1vdmVDbGFzcyhmKX0pLmJpbmQoXCJmb2N1cy5idXR0b25cIixmdW5jdGlvbigpe2EodGhpcykuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1mb2N1c1wiKX0pLmJpbmQoXCJibHVyLmJ1dHRvblwiLGZ1bmN0aW9uKCl7YSh0aGlzKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWZvY3VzXCIpfSk7ZCYmdGhpcy5lbGVtZW50LmJpbmQoXCJjaGFuZ2UuYnV0dG9uXCIsZnVuY3Rpb24oKXtiLnJlZnJlc2goKX0pO2lmKHRoaXMudHlwZT09PVwiY2hlY2tib3hcIil0aGlzLmJ1dHRvbkVsZW1lbnQuYmluZChcImNsaWNrLmJ1dHRvblwiLGZ1bmN0aW9uKCl7aWYoYy5kaXNhYmxlZClyZXR1cm4gZmFsc2U7YSh0aGlzKS50b2dnbGVDbGFzcyhcInVpLXN0YXRlLWFjdGl2ZVwiKTtcbmIuYnV0dG9uRWxlbWVudC5hdHRyKFwiYXJpYS1wcmVzc2VkXCIsYi5lbGVtZW50WzBdLmNoZWNrZWQpfSk7ZWxzZSBpZih0aGlzLnR5cGU9PT1cInJhZGlvXCIpdGhpcy5idXR0b25FbGVtZW50LmJpbmQoXCJjbGljay5idXR0b25cIixmdW5jdGlvbigpe2lmKGMuZGlzYWJsZWQpcmV0dXJuIGZhbHNlO2EodGhpcykuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1hY3RpdmVcIik7Yi5idXR0b25FbGVtZW50LmF0dHIoXCJhcmlhLXByZXNzZWRcIix0cnVlKTt2YXIgZT1iLmVsZW1lbnRbMF07aChlKS5ub3QoZSkubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIGEodGhpcykuYnV0dG9uKFwid2lkZ2V0XCIpWzBdfSkucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1hY3RpdmVcIikuYXR0cihcImFyaWEtcHJlc3NlZFwiLGZhbHNlKX0pO2Vsc2V7dGhpcy5idXR0b25FbGVtZW50LmJpbmQoXCJtb3VzZWRvd24uYnV0dG9uXCIsZnVuY3Rpb24oKXtpZihjLmRpc2FibGVkKXJldHVybiBmYWxzZTthKHRoaXMpLmFkZENsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpO1xuZz10aGlzO2EoZG9jdW1lbnQpLm9uZShcIm1vdXNldXBcIixmdW5jdGlvbigpe2c9bnVsbH0pfSkuYmluZChcIm1vdXNldXAuYnV0dG9uXCIsZnVuY3Rpb24oKXtpZihjLmRpc2FibGVkKXJldHVybiBmYWxzZTthKHRoaXMpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpfSkuYmluZChcImtleWRvd24uYnV0dG9uXCIsZnVuY3Rpb24oZSl7aWYoYy5kaXNhYmxlZClyZXR1cm4gZmFsc2U7aWYoZS5rZXlDb2RlPT1hLnVpLmtleUNvZGUuU1BBQ0V8fGUua2V5Q29kZT09YS51aS5rZXlDb2RlLkVOVEVSKWEodGhpcykuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1hY3RpdmVcIil9KS5iaW5kKFwia2V5dXAuYnV0dG9uXCIsZnVuY3Rpb24oKXthKHRoaXMpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpfSk7dGhpcy5idXR0b25FbGVtZW50LmlzKFwiYVwiKSYmdGhpcy5idXR0b25FbGVtZW50LmtleXVwKGZ1bmN0aW9uKGUpe2Uua2V5Q29kZT09PWEudWkua2V5Q29kZS5TUEFDRSYmYSh0aGlzKS5jbGljaygpfSl9dGhpcy5fc2V0T3B0aW9uKFwiZGlzYWJsZWRcIixcbmMuZGlzYWJsZWQpfSxfZGV0ZXJtaW5lQnV0dG9uVHlwZTpmdW5jdGlvbigpe3RoaXMudHlwZT10aGlzLmVsZW1lbnQuaXMoXCI6Y2hlY2tib3hcIik/XCJjaGVja2JveFwiOnRoaXMuZWxlbWVudC5pcyhcIjpyYWRpb1wiKT9cInJhZGlvXCI6dGhpcy5lbGVtZW50LmlzKFwiaW5wdXRcIik/XCJpbnB1dFwiOlwiYnV0dG9uXCI7aWYodGhpcy50eXBlPT09XCJjaGVja2JveFwifHx0aGlzLnR5cGU9PT1cInJhZGlvXCIpe3ZhciBiPXRoaXMuZWxlbWVudC5wYXJlbnRzKCkuZmlsdGVyKFwiOmxhc3RcIiksYz1cImxhYmVsW2Zvcj1cIit0aGlzLmVsZW1lbnQuYXR0cihcImlkXCIpK1wiXVwiO3RoaXMuYnV0dG9uRWxlbWVudD1iLmZpbmQoYyk7aWYoIXRoaXMuYnV0dG9uRWxlbWVudC5sZW5ndGgpe2I9Yi5sZW5ndGg/Yi5zaWJsaW5ncygpOnRoaXMuZWxlbWVudC5zaWJsaW5ncygpO3RoaXMuYnV0dG9uRWxlbWVudD1iLmZpbHRlcihjKTtpZighdGhpcy5idXR0b25FbGVtZW50Lmxlbmd0aCl0aGlzLmJ1dHRvbkVsZW1lbnQ9Yi5maW5kKGMpfXRoaXMuZWxlbWVudC5hZGRDbGFzcyhcInVpLWhlbHBlci1oaWRkZW4tYWNjZXNzaWJsZVwiKTtcbihiPXRoaXMuZWxlbWVudC5pcyhcIjpjaGVja2VkXCIpKSYmdGhpcy5idXR0b25FbGVtZW50LmFkZENsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpO3RoaXMuYnV0dG9uRWxlbWVudC5hdHRyKFwiYXJpYS1wcmVzc2VkXCIsYil9ZWxzZSB0aGlzLmJ1dHRvbkVsZW1lbnQ9dGhpcy5lbGVtZW50fSx3aWRnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5idXR0b25FbGVtZW50fSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKFwidWktaGVscGVyLWhpZGRlbi1hY2Nlc3NpYmxlXCIpO3RoaXMuYnV0dG9uRWxlbWVudC5yZW1vdmVDbGFzcyhcInVpLWJ1dHRvbiB1aS13aWRnZXQgdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsIHVpLXN0YXRlLWhvdmVyIHVpLXN0YXRlLWFjdGl2ZSAgdWktYnV0dG9uLWljb25zLW9ubHkgdWktYnV0dG9uLWljb24tb25seSB1aS1idXR0b24tdGV4dC1pY29ucyB1aS1idXR0b24tdGV4dC1pY29uLXByaW1hcnkgdWktYnV0dG9uLXRleHQtaWNvbi1zZWNvbmRhcnkgdWktYnV0dG9uLXRleHQtb25seVwiKS5yZW1vdmVBdHRyKFwicm9sZVwiKS5yZW1vdmVBdHRyKFwiYXJpYS1wcmVzc2VkXCIpLmh0bWwodGhpcy5idXR0b25FbGVtZW50LmZpbmQoXCIudWktYnV0dG9uLXRleHRcIikuaHRtbCgpKTtcbnRoaXMuaGFzVGl0bGV8fHRoaXMuYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyKFwidGl0bGVcIik7YS5XaWRnZXQucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKX0sX3NldE9wdGlvbjpmdW5jdGlvbihiLGMpe2EuV2lkZ2V0LnByb3RvdHlwZS5fc2V0T3B0aW9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihiPT09XCJkaXNhYmxlZFwiKWM/dGhpcy5lbGVtZW50LmF0dHIoXCJkaXNhYmxlZFwiLHRydWUpOnRoaXMuZWxlbWVudC5yZW1vdmVBdHRyKFwiZGlzYWJsZWRcIik7dGhpcy5fcmVzZXRCdXR0b24oKX0scmVmcmVzaDpmdW5jdGlvbigpe3ZhciBiPXRoaXMuZWxlbWVudC5pcyhcIjpkaXNhYmxlZFwiKTtiIT09dGhpcy5vcHRpb25zLmRpc2FibGVkJiZ0aGlzLl9zZXRPcHRpb24oXCJkaXNhYmxlZFwiLGIpO2lmKHRoaXMudHlwZT09PVwicmFkaW9cIiloKHRoaXMuZWxlbWVudFswXSkuZWFjaChmdW5jdGlvbigpe2EodGhpcykuaXMoXCI6Y2hlY2tlZFwiKT9hKHRoaXMpLmJ1dHRvbihcIndpZGdldFwiKS5hZGRDbGFzcyhcInVpLXN0YXRlLWFjdGl2ZVwiKS5hdHRyKFwiYXJpYS1wcmVzc2VkXCIsXG50cnVlKTphKHRoaXMpLmJ1dHRvbihcIndpZGdldFwiKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWFjdGl2ZVwiKS5hdHRyKFwiYXJpYS1wcmVzc2VkXCIsZmFsc2UpfSk7ZWxzZSBpZih0aGlzLnR5cGU9PT1cImNoZWNrYm94XCIpdGhpcy5lbGVtZW50LmlzKFwiOmNoZWNrZWRcIik/dGhpcy5idXR0b25FbGVtZW50LmFkZENsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpLmF0dHIoXCJhcmlhLXByZXNzZWRcIix0cnVlKTp0aGlzLmJ1dHRvbkVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1hY3RpdmVcIikuYXR0cihcImFyaWEtcHJlc3NlZFwiLGZhbHNlKX0sX3Jlc2V0QnV0dG9uOmZ1bmN0aW9uKCl7aWYodGhpcy50eXBlPT09XCJpbnB1dFwiKXRoaXMub3B0aW9ucy5sYWJlbCYmdGhpcy5lbGVtZW50LnZhbCh0aGlzLm9wdGlvbnMubGFiZWwpO2Vsc2V7dmFyIGI9dGhpcy5idXR0b25FbGVtZW50LnJlbW92ZUNsYXNzKFwidWktYnV0dG9uLWljb25zLW9ubHkgdWktYnV0dG9uLWljb24tb25seSB1aS1idXR0b24tdGV4dC1pY29ucyB1aS1idXR0b24tdGV4dC1pY29uLXByaW1hcnkgdWktYnV0dG9uLXRleHQtaWNvbi1zZWNvbmRhcnkgdWktYnV0dG9uLXRleHQtb25seVwiKSxcbmM9YShcIjxzcGFuPjwvc3Bhbj5cIikuYWRkQ2xhc3MoXCJ1aS1idXR0b24tdGV4dFwiKS5odG1sKHRoaXMub3B0aW9ucy5sYWJlbCkuYXBwZW5kVG8oYi5lbXB0eSgpKS50ZXh0KCksZD10aGlzLm9wdGlvbnMuaWNvbnMsZj1kLnByaW1hcnkmJmQuc2Vjb25kYXJ5LGU9W107aWYoZC5wcmltYXJ5fHxkLnNlY29uZGFyeSl7aWYodGhpcy5vcHRpb25zLnRleHQpZS5wdXNoKFwidWktYnV0dG9uLXRleHQtaWNvblwiKyhmP1wic1wiOmQucHJpbWFyeT9cIi1wcmltYXJ5XCI6XCItc2Vjb25kYXJ5XCIpKTtkLnByaW1hcnkmJmIucHJlcGVuZChcIjxzcGFuIGNsYXNzPSd1aS1idXR0b24taWNvbi1wcmltYXJ5IHVpLWljb24gXCIrZC5wcmltYXJ5K1wiJz48L3NwYW4+XCIpO2Quc2Vjb25kYXJ5JiZiLmFwcGVuZChcIjxzcGFuIGNsYXNzPSd1aS1idXR0b24taWNvbi1zZWNvbmRhcnkgdWktaWNvbiBcIitkLnNlY29uZGFyeStcIic+PC9zcGFuPlwiKTtpZighdGhpcy5vcHRpb25zLnRleHQpe2UucHVzaChmP1widWktYnV0dG9uLWljb25zLW9ubHlcIjpcblwidWktYnV0dG9uLWljb24tb25seVwiKTt0aGlzLmhhc1RpdGxlfHxiLmF0dHIoXCJ0aXRsZVwiLGMpfX1lbHNlIGUucHVzaChcInVpLWJ1dHRvbi10ZXh0LW9ubHlcIik7Yi5hZGRDbGFzcyhlLmpvaW4oXCIgXCIpKX19fSk7YS53aWRnZXQoXCJ1aS5idXR0b25zZXRcIix7b3B0aW9uczp7aXRlbXM6XCI6YnV0dG9uLCA6c3VibWl0LCA6cmVzZXQsIDpjaGVja2JveCwgOnJhZGlvLCBhLCA6ZGF0YShidXR0b24pXCJ9LF9jcmVhdGU6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoXCJ1aS1idXR0b25zZXRcIil9LF9pbml0OmZ1bmN0aW9uKCl7dGhpcy5yZWZyZXNoKCl9LF9zZXRPcHRpb246ZnVuY3Rpb24oYixjKXtiPT09XCJkaXNhYmxlZFwiJiZ0aGlzLmJ1dHRvbnMuYnV0dG9uKFwib3B0aW9uXCIsYixjKTthLldpZGdldC5wcm90b3R5cGUuX3NldE9wdGlvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHJlZnJlc2g6ZnVuY3Rpb24oKXt0aGlzLmJ1dHRvbnM9dGhpcy5lbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLml0ZW1zKS5maWx0ZXIoXCI6dWktYnV0dG9uXCIpLmJ1dHRvbihcInJlZnJlc2hcIikuZW5kKCkubm90KFwiOnVpLWJ1dHRvblwiKS5idXR0b24oKS5lbmQoKS5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gYSh0aGlzKS5idXR0b24oXCJ3aWRnZXRcIilbMF19KS5yZW1vdmVDbGFzcyhcInVpLWNvcm5lci1hbGwgdWktY29ybmVyLWxlZnQgdWktY29ybmVyLXJpZ2h0XCIpLmZpbHRlcihcIjpmaXJzdFwiKS5hZGRDbGFzcyhcInVpLWNvcm5lci1sZWZ0XCIpLmVuZCgpLmZpbHRlcihcIjpsYXN0XCIpLmFkZENsYXNzKFwidWktY29ybmVyLXJpZ2h0XCIpLmVuZCgpLmVuZCgpfSxcbmRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJ1aS1idXR0b25zZXRcIik7dGhpcy5idXR0b25zLm1hcChmdW5jdGlvbigpe3JldHVybiBhKHRoaXMpLmJ1dHRvbihcIndpZGdldFwiKVswXX0pLnJlbW92ZUNsYXNzKFwidWktY29ybmVyLWxlZnQgdWktY29ybmVyLXJpZ2h0XCIpLmVuZCgpLmJ1dHRvbihcImRlc3Ryb3lcIik7YS5XaWRnZXQucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKX19KX0pKGpRdWVyeSk7XG47LypcbiAqIE5vdGU6IFdoaWxlIE1pY3Jvc29mdCBpcyBub3QgdGhlIGF1dGhvciBvZiB0aGlzIGZpbGUsIE1pY3Jvc29mdCBpc1xuICogb2ZmZXJpbmcgeW91IGEgbGljZW5zZSBzdWJqZWN0IHRvIHRoZSB0ZXJtcyBvZiB0aGUgTWljcm9zb2Z0IFNvZnR3YXJlXG4gKiBMaWNlbnNlIFRlcm1zIGZvciBNaWNyb3NvZnQgQVNQLk5FVCBNb2RlbCBWaWV3IENvbnRyb2xsZXIgMy5cbiAqIE1pY3Jvc29mdCByZXNlcnZlcyBhbGwgb3RoZXIgcmlnaHRzLiBUaGUgbm90aWNlcyBiZWxvdyBhcmUgcHJvdmlkZWRcbiAqIGZvciBpbmZvcm1hdGlvbmFsIHB1cnBvc2VzIG9ubHkgYW5kIGFyZSBub3QgdGhlIGxpY2Vuc2UgdGVybXMgdW5kZXJcbiAqIHdoaWNoIE1pY3Jvc29mdCBkaXN0cmlidXRlZCB0aGlzIGZpbGUuXG4gKlxuICogalF1ZXJ5IFVJIERpYWxvZyAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXG4gKlxuICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9EaWFsb2dcbiAqXG4gKiBEZXBlbmRzOlxuICpcdGpxdWVyeS51aS5jb3JlLmpzXG4gKlx0anF1ZXJ5LnVpLndpZGdldC5qc1xuICogIGpxdWVyeS51aS5idXR0b24uanNcbiAqXHRqcXVlcnkudWkuZHJhZ2dhYmxlLmpzXG4gKlx0anF1ZXJ5LnVpLm1vdXNlLmpzXG4gKlx0anF1ZXJ5LnVpLnBvc2l0aW9uLmpzXG4gKlx0anF1ZXJ5LnVpLnJlc2l6YWJsZS5qc1xuICovXG4oZnVuY3Rpb24oYyxqKXt2YXIgaz17YnV0dG9uczp0cnVlLGhlaWdodDp0cnVlLG1heEhlaWdodDp0cnVlLG1heFdpZHRoOnRydWUsbWluSGVpZ2h0OnRydWUsbWluV2lkdGg6dHJ1ZSx3aWR0aDp0cnVlfSxsPXttYXhIZWlnaHQ6dHJ1ZSxtYXhXaWR0aDp0cnVlLG1pbkhlaWdodDp0cnVlLG1pbldpZHRoOnRydWV9O2Mud2lkZ2V0KFwidWkuZGlhbG9nXCIse29wdGlvbnM6e2F1dG9PcGVuOnRydWUsYnV0dG9uczp7fSxjbG9zZU9uRXNjYXBlOnRydWUsY2xvc2VUZXh0OlwiY2xvc2VcIixkaWFsb2dDbGFzczpcIlwiLGRyYWdnYWJsZTp0cnVlLGhpZGU6bnVsbCxoZWlnaHQ6XCJhdXRvXCIsbWF4SGVpZ2h0OmZhbHNlLG1heFdpZHRoOmZhbHNlLG1pbkhlaWdodDoxNTAsbWluV2lkdGg6MTUwLG1vZGFsOmZhbHNlLHBvc2l0aW9uOntteTpcImNlbnRlclwiLGF0OlwiY2VudGVyXCIsY29sbGlzaW9uOlwiZml0XCIsdXNpbmc6ZnVuY3Rpb24oYSl7dmFyIGI9Yyh0aGlzKS5jc3MoYSkub2Zmc2V0KCkudG9wO2I8MCYmXG5jKHRoaXMpLmNzcyhcInRvcFwiLGEudG9wLWIpfX0scmVzaXphYmxlOnRydWUsc2hvdzpudWxsLHN0YWNrOnRydWUsdGl0bGU6XCJcIix3aWR0aDozMDAsekluZGV4OjFFM30sX2NyZWF0ZTpmdW5jdGlvbigpe3RoaXMub3JpZ2luYWxUaXRsZT10aGlzLmVsZW1lbnQuYXR0cihcInRpdGxlXCIpO2lmKHR5cGVvZiB0aGlzLm9yaWdpbmFsVGl0bGUhPT1cInN0cmluZ1wiKXRoaXMub3JpZ2luYWxUaXRsZT1cIlwiO3RoaXMub3B0aW9ucy50aXRsZT10aGlzLm9wdGlvbnMudGl0bGV8fHRoaXMub3JpZ2luYWxUaXRsZTt2YXIgYT10aGlzLGI9YS5vcHRpb25zLGQ9Yi50aXRsZXx8XCImIzE2MDtcIixlPWMudWkuZGlhbG9nLmdldFRpdGxlSWQoYS5lbGVtZW50KSxnPShhLnVpRGlhbG9nPWMoXCI8ZGl2PjwvZGl2PlwiKSkuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSkuaGlkZSgpLmFkZENsYXNzKFwidWktZGlhbG9nIHVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYWxsIFwiK2IuZGlhbG9nQ2xhc3MpLmNzcyh7ekluZGV4OmIuekluZGV4fSkuYXR0cihcInRhYkluZGV4XCIsXG4tMSkuY3NzKFwib3V0bGluZVwiLDApLmtleWRvd24oZnVuY3Rpb24oaSl7aWYoYi5jbG9zZU9uRXNjYXBlJiZpLmtleUNvZGUmJmkua2V5Q29kZT09PWMudWkua2V5Q29kZS5FU0NBUEUpe2EuY2xvc2UoaSk7aS5wcmV2ZW50RGVmYXVsdCgpfX0pLmF0dHIoe3JvbGU6XCJkaWFsb2dcIixcImFyaWEtbGFiZWxsZWRieVwiOmV9KS5tb3VzZWRvd24oZnVuY3Rpb24oaSl7YS5tb3ZlVG9Ub3AoZmFsc2UsaSl9KTthLmVsZW1lbnQuc2hvdygpLnJlbW92ZUF0dHIoXCJ0aXRsZVwiKS5hZGRDbGFzcyhcInVpLWRpYWxvZy1jb250ZW50IHVpLXdpZGdldC1jb250ZW50XCIpLmFwcGVuZFRvKGcpO3ZhciBmPShhLnVpRGlhbG9nVGl0bGViYXI9YyhcIjxkaXY+PC9kaXY+XCIpKS5hZGRDbGFzcyhcInVpLWRpYWxvZy10aXRsZWJhciB1aS13aWRnZXQtaGVhZGVyIHVpLWNvcm5lci1hbGwgdWktaGVscGVyLWNsZWFyZml4XCIpLnByZXBlbmRUbyhnKSxoPWMoJzxhIGhyZWY9XCIjXCI+PC9hPicpLmFkZENsYXNzKFwidWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlIHVpLWNvcm5lci1hbGxcIikuYXR0cihcInJvbGVcIixcblwiYnV0dG9uXCIpLmhvdmVyKGZ1bmN0aW9uKCl7aC5hZGRDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpfSxmdW5jdGlvbigpe2gucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1ob3ZlclwiKX0pLmZvY3VzKGZ1bmN0aW9uKCl7aC5hZGRDbGFzcyhcInVpLXN0YXRlLWZvY3VzXCIpfSkuYmx1cihmdW5jdGlvbigpe2gucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1mb2N1c1wiKX0pLmNsaWNrKGZ1bmN0aW9uKGkpe2EuY2xvc2UoaSk7cmV0dXJuIGZhbHNlfSkuYXBwZW5kVG8oZik7KGEudWlEaWFsb2dUaXRsZWJhckNsb3NlVGV4dD1jKFwiPHNwYW4+PC9zcGFuPlwiKSkuYWRkQ2xhc3MoXCJ1aS1pY29uIHVpLWljb24tY2xvc2V0aGlja1wiKS50ZXh0KGIuY2xvc2VUZXh0KS5hcHBlbmRUbyhoKTtjKFwiPHNwYW4+PC9zcGFuPlwiKS5hZGRDbGFzcyhcInVpLWRpYWxvZy10aXRsZVwiKS5hdHRyKFwiaWRcIixlKS5odG1sKGQpLnByZXBlbmRUbyhmKTtpZihjLmlzRnVuY3Rpb24oYi5iZWZvcmVjbG9zZSkmJiFjLmlzRnVuY3Rpb24oYi5iZWZvcmVDbG9zZSkpYi5iZWZvcmVDbG9zZT1cbmIuYmVmb3JlY2xvc2U7Zi5maW5kKFwiKlwiKS5hZGQoZikuZGlzYWJsZVNlbGVjdGlvbigpO2IuZHJhZ2dhYmxlJiZjLmZuLmRyYWdnYWJsZSYmYS5fbWFrZURyYWdnYWJsZSgpO2IucmVzaXphYmxlJiZjLmZuLnJlc2l6YWJsZSYmYS5fbWFrZVJlc2l6YWJsZSgpO2EuX2NyZWF0ZUJ1dHRvbnMoYi5idXR0b25zKTthLl9pc09wZW49ZmFsc2U7Yy5mbi5iZ2lmcmFtZSYmZy5iZ2lmcmFtZSgpfSxfaW5pdDpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5hdXRvT3BlbiYmdGhpcy5vcGVuKCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2Eub3ZlcmxheSYmYS5vdmVybGF5LmRlc3Ryb3koKTthLnVpRGlhbG9nLmhpZGUoKTthLmVsZW1lbnQudW5iaW5kKFwiLmRpYWxvZ1wiKS5yZW1vdmVEYXRhKFwiZGlhbG9nXCIpLnJlbW92ZUNsYXNzKFwidWktZGlhbG9nLWNvbnRlbnQgdWktd2lkZ2V0LWNvbnRlbnRcIikuaGlkZSgpLmFwcGVuZFRvKFwiYm9keVwiKTthLnVpRGlhbG9nLnJlbW92ZSgpO2Eub3JpZ2luYWxUaXRsZSYmXG5hLmVsZW1lbnQuYXR0cihcInRpdGxlXCIsYS5vcmlnaW5hbFRpdGxlKTtyZXR1cm4gYX0sd2lkZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudWlEaWFsb2d9LGNsb3NlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsZCxlO2lmKGZhbHNlIT09Yi5fdHJpZ2dlcihcImJlZm9yZUNsb3NlXCIsYSkpe2Iub3ZlcmxheSYmYi5vdmVybGF5LmRlc3Ryb3koKTtiLnVpRGlhbG9nLnVuYmluZChcImtleXByZXNzLnVpLWRpYWxvZ1wiKTtiLl9pc09wZW49ZmFsc2U7aWYoYi5vcHRpb25zLmhpZGUpYi51aURpYWxvZy5oaWRlKGIub3B0aW9ucy5oaWRlLGZ1bmN0aW9uKCl7Yi5fdHJpZ2dlcihcImNsb3NlXCIsYSl9KTtlbHNle2IudWlEaWFsb2cuaGlkZSgpO2IuX3RyaWdnZXIoXCJjbG9zZVwiLGEpfWMudWkuZGlhbG9nLm92ZXJsYXkucmVzaXplKCk7aWYoYi5vcHRpb25zLm1vZGFsKXtkPTA7YyhcIi51aS1kaWFsb2dcIikuZWFjaChmdW5jdGlvbigpe2lmKHRoaXMhPT1iLnVpRGlhbG9nWzBdKXtlPWModGhpcykuY3NzKFwiei1pbmRleFwiKTtcbmlzTmFOKGUpfHwoZD1NYXRoLm1heChkLGUpKX19KTtjLnVpLmRpYWxvZy5tYXhaPWR9cmV0dXJuIGJ9fSxpc09wZW46ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNPcGVufSxtb3ZlVG9Ub3A6ZnVuY3Rpb24oYSxiKXt2YXIgZD10aGlzLGU9ZC5vcHRpb25zO2lmKGUubW9kYWwmJiFhfHwhZS5zdGFjayYmIWUubW9kYWwpcmV0dXJuIGQuX3RyaWdnZXIoXCJmb2N1c1wiLGIpO2lmKGUuekluZGV4PmMudWkuZGlhbG9nLm1heFopYy51aS5kaWFsb2cubWF4Wj1lLnpJbmRleDtpZihkLm92ZXJsYXkpe2MudWkuZGlhbG9nLm1heForPTE7ZC5vdmVybGF5LiRlbC5jc3MoXCJ6LWluZGV4XCIsYy51aS5kaWFsb2cub3ZlcmxheS5tYXhaPWMudWkuZGlhbG9nLm1heFopfWE9e3Njcm9sbFRvcDpkLmVsZW1lbnQuYXR0cihcInNjcm9sbFRvcFwiKSxzY3JvbGxMZWZ0OmQuZWxlbWVudC5hdHRyKFwic2Nyb2xsTGVmdFwiKX07Yy51aS5kaWFsb2cubWF4Wis9MTtkLnVpRGlhbG9nLmNzcyhcInotaW5kZXhcIixjLnVpLmRpYWxvZy5tYXhaKTtcbmQuZWxlbWVudC5hdHRyKGEpO2QuX3RyaWdnZXIoXCJmb2N1c1wiLGIpO3JldHVybiBkfSxvcGVuOmZ1bmN0aW9uKCl7aWYoIXRoaXMuX2lzT3Blbil7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxkPWEudWlEaWFsb2c7YS5vdmVybGF5PWIubW9kYWw/bmV3IGMudWkuZGlhbG9nLm92ZXJsYXkoYSk6bnVsbDthLl9zaXplKCk7YS5fcG9zaXRpb24oYi5wb3NpdGlvbik7ZC5zaG93KGIuc2hvdyk7YS5tb3ZlVG9Ub3AodHJ1ZSk7Yi5tb2RhbCYmZC5iaW5kKFwia2V5cHJlc3MudWktZGlhbG9nXCIsZnVuY3Rpb24oZSl7aWYoZS5rZXlDb2RlPT09Yy51aS5rZXlDb2RlLlRBQil7dmFyIGc9YyhcIjp0YWJiYWJsZVwiLHRoaXMpLGY9Zy5maWx0ZXIoXCI6Zmlyc3RcIik7Zz1nLmZpbHRlcihcIjpsYXN0XCIpO2lmKGUudGFyZ2V0PT09Z1swXSYmIWUuc2hpZnRLZXkpe2YuZm9jdXMoMSk7cmV0dXJuIGZhbHNlfWVsc2UgaWYoZS50YXJnZXQ9PT1mWzBdJiZlLnNoaWZ0S2V5KXtnLmZvY3VzKDEpO3JldHVybiBmYWxzZX19fSk7XG5jKGEuZWxlbWVudC5maW5kKFwiOnRhYmJhYmxlXCIpLmdldCgpLmNvbmNhdChkLmZpbmQoXCIudWktZGlhbG9nLWJ1dHRvbnBhbmUgOnRhYmJhYmxlXCIpLmdldCgpLmNvbmNhdChkLmdldCgpKSkpLmVxKDApLmZvY3VzKCk7YS5faXNPcGVuPXRydWU7YS5fdHJpZ2dlcihcIm9wZW5cIik7cmV0dXJuIGF9fSxfY3JlYXRlQnV0dG9uczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGQ9ZmFsc2UsZT1jKFwiPGRpdj48L2Rpdj5cIikuYWRkQ2xhc3MoXCJ1aS1kaWFsb2ctYnV0dG9ucGFuZSB1aS13aWRnZXQtY29udGVudCB1aS1oZWxwZXItY2xlYXJmaXhcIiksZz1jKFwiPGRpdj48L2Rpdj5cIikuYWRkQ2xhc3MoXCJ1aS1kaWFsb2ctYnV0dG9uc2V0XCIpLmFwcGVuZFRvKGUpO2IudWlEaWFsb2cuZmluZChcIi51aS1kaWFsb2ctYnV0dG9ucGFuZVwiKS5yZW1vdmUoKTt0eXBlb2YgYT09PVwib2JqZWN0XCImJmEhPT1udWxsJiZjLmVhY2goYSxmdW5jdGlvbigpe3JldHVybiEoZD10cnVlKX0pO2lmKGQpe2MuZWFjaChhLGZ1bmN0aW9uKGYsXG5oKXtoPWMuaXNGdW5jdGlvbihoKT97Y2xpY2s6aCx0ZXh0OmZ9Omg7Zj1jKCc8YnV0dG9uIHR5cGU9XCJidXR0b25cIj48L2J1dHRvbj4nKS5hdHRyKGgsdHJ1ZSkudW5iaW5kKFwiY2xpY2tcIikuY2xpY2soZnVuY3Rpb24oKXtoLmNsaWNrLmFwcGx5KGIuZWxlbWVudFswXSxhcmd1bWVudHMpfSkuYXBwZW5kVG8oZyk7Yy5mbi5idXR0b24mJmYuYnV0dG9uKCl9KTtlLmFwcGVuZFRvKGIudWlEaWFsb2cpfX0sX21ha2VEcmFnZ2FibGU6ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGYpe3JldHVybntwb3NpdGlvbjpmLnBvc2l0aW9uLG9mZnNldDpmLm9mZnNldH19dmFyIGI9dGhpcyxkPWIub3B0aW9ucyxlPWMoZG9jdW1lbnQpLGc7Yi51aURpYWxvZy5kcmFnZ2FibGUoe2NhbmNlbDpcIi51aS1kaWFsb2ctY29udGVudCwgLnVpLWRpYWxvZy10aXRsZWJhci1jbG9zZVwiLGhhbmRsZTpcIi51aS1kaWFsb2ctdGl0bGViYXJcIixjb250YWlubWVudDpcImRvY3VtZW50XCIsc3RhcnQ6ZnVuY3Rpb24oZixoKXtnPVxuZC5oZWlnaHQ9PT1cImF1dG9cIj9cImF1dG9cIjpjKHRoaXMpLmhlaWdodCgpO2ModGhpcykuaGVpZ2h0KGModGhpcykuaGVpZ2h0KCkpLmFkZENsYXNzKFwidWktZGlhbG9nLWRyYWdnaW5nXCIpO2IuX3RyaWdnZXIoXCJkcmFnU3RhcnRcIixmLGEoaCkpfSxkcmFnOmZ1bmN0aW9uKGYsaCl7Yi5fdHJpZ2dlcihcImRyYWdcIixmLGEoaCkpfSxzdG9wOmZ1bmN0aW9uKGYsaCl7ZC5wb3NpdGlvbj1baC5wb3NpdGlvbi5sZWZ0LWUuc2Nyb2xsTGVmdCgpLGgucG9zaXRpb24udG9wLWUuc2Nyb2xsVG9wKCldO2ModGhpcykucmVtb3ZlQ2xhc3MoXCJ1aS1kaWFsb2ctZHJhZ2dpbmdcIikuaGVpZ2h0KGcpO2IuX3RyaWdnZXIoXCJkcmFnU3RvcFwiLGYsYShoKSk7Yy51aS5kaWFsb2cub3ZlcmxheS5yZXNpemUoKX19KX0sX21ha2VSZXNpemFibGU6ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihmKXtyZXR1cm57b3JpZ2luYWxQb3NpdGlvbjpmLm9yaWdpbmFsUG9zaXRpb24sb3JpZ2luYWxTaXplOmYub3JpZ2luYWxTaXplLFxucG9zaXRpb246Zi5wb3NpdGlvbixzaXplOmYuc2l6ZX19YT1hPT09aj90aGlzLm9wdGlvbnMucmVzaXphYmxlOmE7dmFyIGQ9dGhpcyxlPWQub3B0aW9ucyxnPWQudWlEaWFsb2cuY3NzKFwicG9zaXRpb25cIik7YT10eXBlb2YgYT09PVwic3RyaW5nXCI/YTpcIm4sZSxzLHcsc2Usc3csbmUsbndcIjtkLnVpRGlhbG9nLnJlc2l6YWJsZSh7Y2FuY2VsOlwiLnVpLWRpYWxvZy1jb250ZW50XCIsY29udGFpbm1lbnQ6XCJkb2N1bWVudFwiLGFsc29SZXNpemU6ZC5lbGVtZW50LG1heFdpZHRoOmUubWF4V2lkdGgsbWF4SGVpZ2h0OmUubWF4SGVpZ2h0LG1pbldpZHRoOmUubWluV2lkdGgsbWluSGVpZ2h0OmQuX21pbkhlaWdodCgpLGhhbmRsZXM6YSxzdGFydDpmdW5jdGlvbihmLGgpe2ModGhpcykuYWRkQ2xhc3MoXCJ1aS1kaWFsb2ctcmVzaXppbmdcIik7ZC5fdHJpZ2dlcihcInJlc2l6ZVN0YXJ0XCIsZixiKGgpKX0scmVzaXplOmZ1bmN0aW9uKGYsaCl7ZC5fdHJpZ2dlcihcInJlc2l6ZVwiLGYsYihoKSl9LHN0b3A6ZnVuY3Rpb24oZixcbmgpe2ModGhpcykucmVtb3ZlQ2xhc3MoXCJ1aS1kaWFsb2ctcmVzaXppbmdcIik7ZS5oZWlnaHQ9Yyh0aGlzKS5oZWlnaHQoKTtlLndpZHRoPWModGhpcykud2lkdGgoKTtkLl90cmlnZ2VyKFwicmVzaXplU3RvcFwiLGYsYihoKSk7Yy51aS5kaWFsb2cub3ZlcmxheS5yZXNpemUoKX19KS5jc3MoXCJwb3NpdGlvblwiLGcpLmZpbmQoXCIudWktcmVzaXphYmxlLXNlXCIpLmFkZENsYXNzKFwidWktaWNvbiB1aS1pY29uLWdyaXAtZGlhZ29uYWwtc2VcIil9LF9taW5IZWlnaHQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnM7cmV0dXJuIGEuaGVpZ2h0PT09XCJhdXRvXCI/YS5taW5IZWlnaHQ6TWF0aC5taW4oYS5taW5IZWlnaHQsYS5oZWlnaHQpfSxfcG9zaXRpb246ZnVuY3Rpb24oYSl7dmFyIGI9W10sZD1bMCwwXSxlO2lmKGEpe2lmKHR5cGVvZiBhPT09XCJzdHJpbmdcInx8dHlwZW9mIGE9PT1cIm9iamVjdFwiJiZcIjBcImluIGEpe2I9YS5zcGxpdD9hLnNwbGl0KFwiIFwiKTpbYVswXSxhWzFdXTtpZihiLmxlbmd0aD09PVxuMSliWzFdPWJbMF07Yy5lYWNoKFtcImxlZnRcIixcInRvcFwiXSxmdW5jdGlvbihnLGYpe2lmKCtiW2ddPT09YltnXSl7ZFtnXT1iW2ddO2JbZ109Zn19KTthPXtteTpiLmpvaW4oXCIgXCIpLGF0OmIuam9pbihcIiBcIiksb2Zmc2V0OmQuam9pbihcIiBcIil9fWE9Yy5leHRlbmQoe30sYy51aS5kaWFsb2cucHJvdG90eXBlLm9wdGlvbnMucG9zaXRpb24sYSl9ZWxzZSBhPWMudWkuZGlhbG9nLnByb3RvdHlwZS5vcHRpb25zLnBvc2l0aW9uOyhlPXRoaXMudWlEaWFsb2cuaXMoXCI6dmlzaWJsZVwiKSl8fHRoaXMudWlEaWFsb2cuc2hvdygpO3RoaXMudWlEaWFsb2cuY3NzKHt0b3A6MCxsZWZ0OjB9KS5wb3NpdGlvbihjLmV4dGVuZCh7b2Y6d2luZG93fSxhKSk7ZXx8dGhpcy51aURpYWxvZy5oaWRlKCl9LF9zZXRPcHRpb25zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsZD17fSxlPWZhbHNlO2MuZWFjaChhLGZ1bmN0aW9uKGcsZil7Yi5fc2V0T3B0aW9uKGcsZik7aWYoZyBpbiBrKWU9dHJ1ZTtpZihnIGluXG5sKWRbZ109Zn0pO2UmJnRoaXMuX3NpemUoKTt0aGlzLnVpRGlhbG9nLmlzKFwiOmRhdGEocmVzaXphYmxlKVwiKSYmdGhpcy51aURpYWxvZy5yZXNpemFibGUoXCJvcHRpb25cIixkKX0sX3NldE9wdGlvbjpmdW5jdGlvbihhLGIpe3ZhciBkPXRoaXMsZT1kLnVpRGlhbG9nO3N3aXRjaChhKXtjYXNlIFwiYmVmb3JlY2xvc2VcIjphPVwiYmVmb3JlQ2xvc2VcIjticmVhaztjYXNlIFwiYnV0dG9uc1wiOmQuX2NyZWF0ZUJ1dHRvbnMoYik7YnJlYWs7Y2FzZSBcImNsb3NlVGV4dFwiOmQudWlEaWFsb2dUaXRsZWJhckNsb3NlVGV4dC50ZXh0KFwiXCIrYik7YnJlYWs7Y2FzZSBcImRpYWxvZ0NsYXNzXCI6ZS5yZW1vdmVDbGFzcyhkLm9wdGlvbnMuZGlhbG9nQ2xhc3MpLmFkZENsYXNzKFwidWktZGlhbG9nIHVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYWxsIFwiK2IpO2JyZWFrO2Nhc2UgXCJkaXNhYmxlZFwiOmI/ZS5hZGRDbGFzcyhcInVpLWRpYWxvZy1kaXNhYmxlZFwiKTplLnJlbW92ZUNsYXNzKFwidWktZGlhbG9nLWRpc2FibGVkXCIpO1xuYnJlYWs7Y2FzZSBcImRyYWdnYWJsZVwiOnZhciBnPWUuaXMoXCI6ZGF0YShkcmFnZ2FibGUpXCIpO2cmJiFiJiZlLmRyYWdnYWJsZShcImRlc3Ryb3lcIik7IWcmJmImJmQuX21ha2VEcmFnZ2FibGUoKTticmVhaztjYXNlIFwicG9zaXRpb25cIjpkLl9wb3NpdGlvbihiKTticmVhaztjYXNlIFwicmVzaXphYmxlXCI6KGc9ZS5pcyhcIjpkYXRhKHJlc2l6YWJsZSlcIikpJiYhYiYmZS5yZXNpemFibGUoXCJkZXN0cm95XCIpO2cmJnR5cGVvZiBiPT09XCJzdHJpbmdcIiYmZS5yZXNpemFibGUoXCJvcHRpb25cIixcImhhbmRsZXNcIixiKTshZyYmYiE9PWZhbHNlJiZkLl9tYWtlUmVzaXphYmxlKGIpO2JyZWFrO2Nhc2UgXCJ0aXRsZVwiOmMoXCIudWktZGlhbG9nLXRpdGxlXCIsZC51aURpYWxvZ1RpdGxlYmFyKS5odG1sKFwiXCIrKGJ8fFwiJiMxNjA7XCIpKTticmVha31jLldpZGdldC5wcm90b3R5cGUuX3NldE9wdGlvbi5hcHBseShkLGFyZ3VtZW50cyl9LF9zaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGIsZCxlPVxudGhpcy51aURpYWxvZy5pcyhcIjp2aXNpYmxlXCIpO3RoaXMuZWxlbWVudC5zaG93KCkuY3NzKHt3aWR0aDpcImF1dG9cIixtaW5IZWlnaHQ6MCxoZWlnaHQ6MH0pO2lmKGEubWluV2lkdGg+YS53aWR0aClhLndpZHRoPWEubWluV2lkdGg7Yj10aGlzLnVpRGlhbG9nLmNzcyh7aGVpZ2h0OlwiYXV0b1wiLHdpZHRoOmEud2lkdGh9KS5oZWlnaHQoKTtkPU1hdGgubWF4KDAsYS5taW5IZWlnaHQtYik7aWYoYS5oZWlnaHQ9PT1cImF1dG9cIilpZihjLnN1cHBvcnQubWluSGVpZ2h0KXRoaXMuZWxlbWVudC5jc3Moe21pbkhlaWdodDpkLGhlaWdodDpcImF1dG9cIn0pO2Vsc2V7dGhpcy51aURpYWxvZy5zaG93KCk7YT10aGlzLmVsZW1lbnQuY3NzKFwiaGVpZ2h0XCIsXCJhdXRvXCIpLmhlaWdodCgpO2V8fHRoaXMudWlEaWFsb2cuaGlkZSgpO3RoaXMuZWxlbWVudC5oZWlnaHQoTWF0aC5tYXgoYSxkKSl9ZWxzZSB0aGlzLmVsZW1lbnQuaGVpZ2h0KE1hdGgubWF4KGEuaGVpZ2h0LWIsMCkpO3RoaXMudWlEaWFsb2cuaXMoXCI6ZGF0YShyZXNpemFibGUpXCIpJiZcbnRoaXMudWlEaWFsb2cucmVzaXphYmxlKFwib3B0aW9uXCIsXCJtaW5IZWlnaHRcIix0aGlzLl9taW5IZWlnaHQoKSl9fSk7Yy5leHRlbmQoYy51aS5kaWFsb2cse3ZlcnNpb246XCIxLjguMTFcIix1dWlkOjAsbWF4WjowLGdldFRpdGxlSWQ6ZnVuY3Rpb24oYSl7YT1hLmF0dHIoXCJpZFwiKTtpZighYSl7dGhpcy51dWlkKz0xO2E9dGhpcy51dWlkfXJldHVyblwidWktZGlhbG9nLXRpdGxlLVwiK2F9LG92ZXJsYXk6ZnVuY3Rpb24oYSl7dGhpcy4kZWw9Yy51aS5kaWFsb2cub3ZlcmxheS5jcmVhdGUoYSl9fSk7Yy5leHRlbmQoYy51aS5kaWFsb2cub3ZlcmxheSx7aW5zdGFuY2VzOltdLG9sZEluc3RhbmNlczpbXSxtYXhaOjAsZXZlbnRzOmMubWFwKFwiZm9jdXMsbW91c2Vkb3duLG1vdXNldXAsa2V5ZG93bixrZXlwcmVzcyxjbGlja1wiLnNwbGl0KFwiLFwiKSxmdW5jdGlvbihhKXtyZXR1cm4gYStcIi5kaWFsb2ctb3ZlcmxheVwifSkuam9pbihcIiBcIiksY3JlYXRlOmZ1bmN0aW9uKGEpe2lmKHRoaXMuaW5zdGFuY2VzLmxlbmd0aD09PVxuMCl7c2V0VGltZW91dChmdW5jdGlvbigpe2MudWkuZGlhbG9nLm92ZXJsYXkuaW5zdGFuY2VzLmxlbmd0aCYmYyhkb2N1bWVudCkuYmluZChjLnVpLmRpYWxvZy5vdmVybGF5LmV2ZW50cyxmdW5jdGlvbihkKXtpZihjKGQudGFyZ2V0KS56SW5kZXgoKTxjLnVpLmRpYWxvZy5vdmVybGF5Lm1heFopcmV0dXJuIGZhbHNlfSl9LDEpO2MoZG9jdW1lbnQpLmJpbmQoXCJrZXlkb3duLmRpYWxvZy1vdmVybGF5XCIsZnVuY3Rpb24oZCl7aWYoYS5vcHRpb25zLmNsb3NlT25Fc2NhcGUmJmQua2V5Q29kZSYmZC5rZXlDb2RlPT09Yy51aS5rZXlDb2RlLkVTQ0FQRSl7YS5jbG9zZShkKTtkLnByZXZlbnREZWZhdWx0KCl9fSk7Yyh3aW5kb3cpLmJpbmQoXCJyZXNpemUuZGlhbG9nLW92ZXJsYXlcIixjLnVpLmRpYWxvZy5vdmVybGF5LnJlc2l6ZSl9dmFyIGI9KHRoaXMub2xkSW5zdGFuY2VzLnBvcCgpfHxjKFwiPGRpdj48L2Rpdj5cIikuYWRkQ2xhc3MoXCJ1aS13aWRnZXQtb3ZlcmxheVwiKSkuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSkuY3NzKHt3aWR0aDp0aGlzLndpZHRoKCksXG5oZWlnaHQ6dGhpcy5oZWlnaHQoKX0pO2MuZm4uYmdpZnJhbWUmJmIuYmdpZnJhbWUoKTt0aGlzLmluc3RhbmNlcy5wdXNoKGIpO3JldHVybiBifSxkZXN0cm95OmZ1bmN0aW9uKGEpe3ZhciBiPWMuaW5BcnJheShhLHRoaXMuaW5zdGFuY2VzKTtiIT0tMSYmdGhpcy5vbGRJbnN0YW5jZXMucHVzaCh0aGlzLmluc3RhbmNlcy5zcGxpY2UoYiwxKVswXSk7dGhpcy5pbnN0YW5jZXMubGVuZ3RoPT09MCYmYyhbZG9jdW1lbnQsd2luZG93XSkudW5iaW5kKFwiLmRpYWxvZy1vdmVybGF5XCIpO2EucmVtb3ZlKCk7dmFyIGQ9MDtjLmVhY2godGhpcy5pbnN0YW5jZXMsZnVuY3Rpb24oKXtkPU1hdGgubWF4KGQsdGhpcy5jc3MoXCJ6LWluZGV4XCIpKX0pO3RoaXMubWF4Wj1kfSxoZWlnaHQ6ZnVuY3Rpb24oKXt2YXIgYSxiO2lmKGMuYnJvd3Nlci5tc2llJiZjLmJyb3dzZXIudmVyc2lvbjw3KXthPU1hdGgubWF4KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQsZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQpO1xuYj1NYXRoLm1heChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQub2Zmc2V0SGVpZ2h0LGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0KTtyZXR1cm4gYTxiP2Mod2luZG93KS5oZWlnaHQoKStcInB4XCI6YStcInB4XCJ9ZWxzZSByZXR1cm4gYyhkb2N1bWVudCkuaGVpZ2h0KCkrXCJweFwifSx3aWR0aDpmdW5jdGlvbigpe3ZhciBhLGI7aWYoYy5icm93c2VyLm1zaWUmJmMuYnJvd3Nlci52ZXJzaW9uPDcpe2E9TWF0aC5tYXgoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFdpZHRoLGRvY3VtZW50LmJvZHkuc2Nyb2xsV2lkdGgpO2I9TWF0aC5tYXgoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm9mZnNldFdpZHRoLGRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGgpO3JldHVybiBhPGI/Yyh3aW5kb3cpLndpZHRoKCkrXCJweFwiOmErXCJweFwifWVsc2UgcmV0dXJuIGMoZG9jdW1lbnQpLndpZHRoKCkrXCJweFwifSxyZXNpemU6ZnVuY3Rpb24oKXt2YXIgYT1jKFtdKTtjLmVhY2goYy51aS5kaWFsb2cub3ZlcmxheS5pbnN0YW5jZXMsXG5mdW5jdGlvbigpe2E9YS5hZGQodGhpcyl9KTthLmNzcyh7d2lkdGg6MCxoZWlnaHQ6MH0pLmNzcyh7d2lkdGg6Yy51aS5kaWFsb2cub3ZlcmxheS53aWR0aCgpLGhlaWdodDpjLnVpLmRpYWxvZy5vdmVybGF5LmhlaWdodCgpfSl9fSk7Yy5leHRlbmQoYy51aS5kaWFsb2cub3ZlcmxheS5wcm90b3R5cGUse2Rlc3Ryb3k6ZnVuY3Rpb24oKXtjLnVpLmRpYWxvZy5vdmVybGF5LmRlc3Ryb3kodGhpcy4kZWwpfX0pfSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgU2xpZGVyIDEuOC4xMVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL1NsaWRlclxuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LnVpLmNvcmUuanNcbiAqXHRqcXVlcnkudWkubW91c2UuanNcbiAqXHRqcXVlcnkudWkud2lkZ2V0LmpzXG4gKi9cbihmdW5jdGlvbihkKXtkLndpZGdldChcInVpLnNsaWRlclwiLGQudWkubW91c2Use3dpZGdldEV2ZW50UHJlZml4Olwic2xpZGVcIixvcHRpb25zOnthbmltYXRlOmZhbHNlLGRpc3RhbmNlOjAsbWF4OjEwMCxtaW46MCxvcmllbnRhdGlvbjpcImhvcml6b250YWxcIixyYW5nZTpmYWxzZSxzdGVwOjEsdmFsdWU6MCx2YWx1ZXM6bnVsbH0sX2NyZWF0ZTpmdW5jdGlvbigpe3ZhciBiPXRoaXMsYT10aGlzLm9wdGlvbnM7dGhpcy5fbW91c2VTbGlkaW5nPXRoaXMuX2tleVNsaWRpbmc9ZmFsc2U7dGhpcy5fYW5pbWF0ZU9mZj10cnVlO3RoaXMuX2hhbmRsZUluZGV4PW51bGw7dGhpcy5fZGV0ZWN0T3JpZW50YXRpb24oKTt0aGlzLl9tb3VzZUluaXQoKTt0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoXCJ1aS1zbGlkZXIgdWktc2xpZGVyLVwiK3RoaXMub3JpZW50YXRpb24rXCIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGxcIik7YS5kaXNhYmxlZCYmdGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktc2xpZGVyLWRpc2FibGVkIHVpLWRpc2FibGVkXCIpO1xudGhpcy5yYW5nZT1kKFtdKTtpZihhLnJhbmdlKXtpZihhLnJhbmdlPT09dHJ1ZSl7dGhpcy5yYW5nZT1kKFwiPGRpdj48L2Rpdj5cIik7aWYoIWEudmFsdWVzKWEudmFsdWVzPVt0aGlzLl92YWx1ZU1pbigpLHRoaXMuX3ZhbHVlTWluKCldO2lmKGEudmFsdWVzLmxlbmd0aCYmYS52YWx1ZXMubGVuZ3RoIT09MilhLnZhbHVlcz1bYS52YWx1ZXNbMF0sYS52YWx1ZXNbMF1dfWVsc2UgdGhpcy5yYW5nZT1kKFwiPGRpdj48L2Rpdj5cIik7dGhpcy5yYW5nZS5hcHBlbmRUbyh0aGlzLmVsZW1lbnQpLmFkZENsYXNzKFwidWktc2xpZGVyLXJhbmdlXCIpO2lmKGEucmFuZ2U9PT1cIm1pblwifHxhLnJhbmdlPT09XCJtYXhcIil0aGlzLnJhbmdlLmFkZENsYXNzKFwidWktc2xpZGVyLXJhbmdlLVwiK2EucmFuZ2UpO3RoaXMucmFuZ2UuYWRkQ2xhc3MoXCJ1aS13aWRnZXQtaGVhZGVyXCIpfWQoXCIudWktc2xpZGVyLWhhbmRsZVwiLHRoaXMuZWxlbWVudCkubGVuZ3RoPT09MCYmZChcIjxhIGhyZWY9JyMnPjwvYT5cIikuYXBwZW5kVG8odGhpcy5lbGVtZW50KS5hZGRDbGFzcyhcInVpLXNsaWRlci1oYW5kbGVcIik7XG5pZihhLnZhbHVlcyYmYS52YWx1ZXMubGVuZ3RoKWZvcig7ZChcIi51aS1zbGlkZXItaGFuZGxlXCIsdGhpcy5lbGVtZW50KS5sZW5ndGg8YS52YWx1ZXMubGVuZ3RoOylkKFwiPGEgaHJlZj0nIyc+PC9hPlwiKS5hcHBlbmRUbyh0aGlzLmVsZW1lbnQpLmFkZENsYXNzKFwidWktc2xpZGVyLWhhbmRsZVwiKTt0aGlzLmhhbmRsZXM9ZChcIi51aS1zbGlkZXItaGFuZGxlXCIsdGhpcy5lbGVtZW50KS5hZGRDbGFzcyhcInVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbFwiKTt0aGlzLmhhbmRsZT10aGlzLmhhbmRsZXMuZXEoMCk7dGhpcy5oYW5kbGVzLmFkZCh0aGlzLnJhbmdlKS5maWx0ZXIoXCJhXCIpLmNsaWNrKGZ1bmN0aW9uKGMpe2MucHJldmVudERlZmF1bHQoKX0pLmhvdmVyKGZ1bmN0aW9uKCl7YS5kaXNhYmxlZHx8ZCh0aGlzKS5hZGRDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpfSxmdW5jdGlvbigpe2QodGhpcykucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1ob3ZlclwiKX0pLmZvY3VzKGZ1bmN0aW9uKCl7aWYoYS5kaXNhYmxlZClkKHRoaXMpLmJsdXIoKTtcbmVsc2V7ZChcIi51aS1zbGlkZXIgLnVpLXN0YXRlLWZvY3VzXCIpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtZm9jdXNcIik7ZCh0aGlzKS5hZGRDbGFzcyhcInVpLXN0YXRlLWZvY3VzXCIpfX0pLmJsdXIoZnVuY3Rpb24oKXtkKHRoaXMpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtZm9jdXNcIil9KTt0aGlzLmhhbmRsZXMuZWFjaChmdW5jdGlvbihjKXtkKHRoaXMpLmRhdGEoXCJpbmRleC51aS1zbGlkZXItaGFuZGxlXCIsYyl9KTt0aGlzLmhhbmRsZXMua2V5ZG93bihmdW5jdGlvbihjKXt2YXIgZT10cnVlLGY9ZCh0aGlzKS5kYXRhKFwiaW5kZXgudWktc2xpZGVyLWhhbmRsZVwiKSxoLGcsaTtpZighYi5vcHRpb25zLmRpc2FibGVkKXtzd2l0Y2goYy5rZXlDb2RlKXtjYXNlIGQudWkua2V5Q29kZS5IT01FOmNhc2UgZC51aS5rZXlDb2RlLkVORDpjYXNlIGQudWkua2V5Q29kZS5QQUdFX1VQOmNhc2UgZC51aS5rZXlDb2RlLlBBR0VfRE9XTjpjYXNlIGQudWkua2V5Q29kZS5VUDpjYXNlIGQudWkua2V5Q29kZS5SSUdIVDpjYXNlIGQudWkua2V5Q29kZS5ET1dOOmNhc2UgZC51aS5rZXlDb2RlLkxFRlQ6ZT1cbmZhbHNlO2lmKCFiLl9rZXlTbGlkaW5nKXtiLl9rZXlTbGlkaW5nPXRydWU7ZCh0aGlzKS5hZGRDbGFzcyhcInVpLXN0YXRlLWFjdGl2ZVwiKTtoPWIuX3N0YXJ0KGMsZik7aWYoaD09PWZhbHNlKXJldHVybn1icmVha31pPWIub3B0aW9ucy5zdGVwO2g9Yi5vcHRpb25zLnZhbHVlcyYmYi5vcHRpb25zLnZhbHVlcy5sZW5ndGg/KGc9Yi52YWx1ZXMoZikpOihnPWIudmFsdWUoKSk7c3dpdGNoKGMua2V5Q29kZSl7Y2FzZSBkLnVpLmtleUNvZGUuSE9NRTpnPWIuX3ZhbHVlTWluKCk7YnJlYWs7Y2FzZSBkLnVpLmtleUNvZGUuRU5EOmc9Yi5fdmFsdWVNYXgoKTticmVhaztjYXNlIGQudWkua2V5Q29kZS5QQUdFX1VQOmc9Yi5fdHJpbUFsaWduVmFsdWUoaCsoYi5fdmFsdWVNYXgoKS1iLl92YWx1ZU1pbigpKS81KTticmVhaztjYXNlIGQudWkua2V5Q29kZS5QQUdFX0RPV046Zz1iLl90cmltQWxpZ25WYWx1ZShoLShiLl92YWx1ZU1heCgpLWIuX3ZhbHVlTWluKCkpLzUpO2JyZWFrO2Nhc2UgZC51aS5rZXlDb2RlLlVQOmNhc2UgZC51aS5rZXlDb2RlLlJJR0hUOmlmKGg9PT1cbmIuX3ZhbHVlTWF4KCkpcmV0dXJuO2c9Yi5fdHJpbUFsaWduVmFsdWUoaCtpKTticmVhaztjYXNlIGQudWkua2V5Q29kZS5ET1dOOmNhc2UgZC51aS5rZXlDb2RlLkxFRlQ6aWYoaD09PWIuX3ZhbHVlTWluKCkpcmV0dXJuO2c9Yi5fdHJpbUFsaWduVmFsdWUoaC1pKTticmVha31iLl9zbGlkZShjLGYsZyk7cmV0dXJuIGV9fSkua2V5dXAoZnVuY3Rpb24oYyl7dmFyIGU9ZCh0aGlzKS5kYXRhKFwiaW5kZXgudWktc2xpZGVyLWhhbmRsZVwiKTtpZihiLl9rZXlTbGlkaW5nKXtiLl9rZXlTbGlkaW5nPWZhbHNlO2IuX3N0b3AoYyxlKTtiLl9jaGFuZ2UoYyxlKTtkKHRoaXMpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpfX0pO3RoaXMuX3JlZnJlc2hWYWx1ZSgpO3RoaXMuX2FuaW1hdGVPZmY9ZmFsc2V9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmhhbmRsZXMucmVtb3ZlKCk7dGhpcy5yYW5nZS5yZW1vdmUoKTt0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJ1aS1zbGlkZXIgdWktc2xpZGVyLWhvcml6b250YWwgdWktc2xpZGVyLXZlcnRpY2FsIHVpLXNsaWRlci1kaXNhYmxlZCB1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgdWktY29ybmVyLWFsbFwiKS5yZW1vdmVEYXRhKFwic2xpZGVyXCIpLnVuYmluZChcIi5zbGlkZXJcIik7XG50aGlzLl9tb3VzZURlc3Ryb3koKTtyZXR1cm4gdGhpc30sX21vdXNlQ2FwdHVyZTpmdW5jdGlvbihiKXt2YXIgYT10aGlzLm9wdGlvbnMsYyxlLGYsaCxnO2lmKGEuZGlzYWJsZWQpcmV0dXJuIGZhbHNlO3RoaXMuZWxlbWVudFNpemU9e3dpZHRoOnRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCksaGVpZ2h0OnRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpfTt0aGlzLmVsZW1lbnRPZmZzZXQ9dGhpcy5lbGVtZW50Lm9mZnNldCgpO2M9dGhpcy5fbm9ybVZhbHVlRnJvbU1vdXNlKHt4OmIucGFnZVgseTpiLnBhZ2VZfSk7ZT10aGlzLl92YWx1ZU1heCgpLXRoaXMuX3ZhbHVlTWluKCkrMTtoPXRoaXM7dGhpcy5oYW5kbGVzLmVhY2goZnVuY3Rpb24oaSl7dmFyIGo9TWF0aC5hYnMoYy1oLnZhbHVlcyhpKSk7aWYoZT5qKXtlPWo7Zj1kKHRoaXMpO2c9aX19KTtpZihhLnJhbmdlPT09dHJ1ZSYmdGhpcy52YWx1ZXMoMSk9PT1hLm1pbil7Zys9MTtmPWQodGhpcy5oYW5kbGVzW2ddKX1pZih0aGlzLl9zdGFydChiLFxuZyk9PT1mYWxzZSlyZXR1cm4gZmFsc2U7dGhpcy5fbW91c2VTbGlkaW5nPXRydWU7aC5faGFuZGxlSW5kZXg9ZztmLmFkZENsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpLmZvY3VzKCk7YT1mLm9mZnNldCgpO3RoaXMuX2NsaWNrT2Zmc2V0PSFkKGIudGFyZ2V0KS5wYXJlbnRzKCkuYW5kU2VsZigpLmlzKFwiLnVpLXNsaWRlci1oYW5kbGVcIik/e2xlZnQ6MCx0b3A6MH06e2xlZnQ6Yi5wYWdlWC1hLmxlZnQtZi53aWR0aCgpLzIsdG9wOmIucGFnZVktYS50b3AtZi5oZWlnaHQoKS8yLShwYXJzZUludChmLmNzcyhcImJvcmRlclRvcFdpZHRoXCIpLDEwKXx8MCktKHBhcnNlSW50KGYuY3NzKFwiYm9yZGVyQm90dG9tV2lkdGhcIiksMTApfHwwKSsocGFyc2VJbnQoZi5jc3MoXCJtYXJnaW5Ub3BcIiksMTApfHwwKX07dGhpcy5oYW5kbGVzLmhhc0NsYXNzKFwidWktc3RhdGUtaG92ZXJcIil8fHRoaXMuX3NsaWRlKGIsZyxjKTtyZXR1cm4gdGhpcy5fYW5pbWF0ZU9mZj10cnVlfSxfbW91c2VTdGFydDpmdW5jdGlvbigpe3JldHVybiB0cnVlfSxcbl9tb3VzZURyYWc6ZnVuY3Rpb24oYil7dmFyIGE9dGhpcy5fbm9ybVZhbHVlRnJvbU1vdXNlKHt4OmIucGFnZVgseTpiLnBhZ2VZfSk7dGhpcy5fc2xpZGUoYix0aGlzLl9oYW5kbGVJbmRleCxhKTtyZXR1cm4gZmFsc2V9LF9tb3VzZVN0b3A6ZnVuY3Rpb24oYil7dGhpcy5oYW5kbGVzLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpO3RoaXMuX21vdXNlU2xpZGluZz1mYWxzZTt0aGlzLl9zdG9wKGIsdGhpcy5faGFuZGxlSW5kZXgpO3RoaXMuX2NoYW5nZShiLHRoaXMuX2hhbmRsZUluZGV4KTt0aGlzLl9jbGlja09mZnNldD10aGlzLl9oYW5kbGVJbmRleD1udWxsO3JldHVybiB0aGlzLl9hbmltYXRlT2ZmPWZhbHNlfSxfZGV0ZWN0T3JpZW50YXRpb246ZnVuY3Rpb24oKXt0aGlzLm9yaWVudGF0aW9uPXRoaXMub3B0aW9ucy5vcmllbnRhdGlvbj09PVwidmVydGljYWxcIj9cInZlcnRpY2FsXCI6XCJob3Jpem9udGFsXCJ9LF9ub3JtVmFsdWVGcm9tTW91c2U6ZnVuY3Rpb24oYil7dmFyIGE7XG5pZih0aGlzLm9yaWVudGF0aW9uPT09XCJob3Jpem9udGFsXCIpe2E9dGhpcy5lbGVtZW50U2l6ZS53aWR0aDtiPWIueC10aGlzLmVsZW1lbnRPZmZzZXQubGVmdC0odGhpcy5fY2xpY2tPZmZzZXQ/dGhpcy5fY2xpY2tPZmZzZXQubGVmdDowKX1lbHNle2E9dGhpcy5lbGVtZW50U2l6ZS5oZWlnaHQ7Yj1iLnktdGhpcy5lbGVtZW50T2Zmc2V0LnRvcC0odGhpcy5fY2xpY2tPZmZzZXQ/dGhpcy5fY2xpY2tPZmZzZXQudG9wOjApfWE9Yi9hO2lmKGE+MSlhPTE7aWYoYTwwKWE9MDtpZih0aGlzLm9yaWVudGF0aW9uPT09XCJ2ZXJ0aWNhbFwiKWE9MS1hO2I9dGhpcy5fdmFsdWVNYXgoKS10aGlzLl92YWx1ZU1pbigpO3JldHVybiB0aGlzLl90cmltQWxpZ25WYWx1ZSh0aGlzLl92YWx1ZU1pbigpK2EqYil9LF9zdGFydDpmdW5jdGlvbihiLGEpe3ZhciBjPXtoYW5kbGU6dGhpcy5oYW5kbGVzW2FdLHZhbHVlOnRoaXMudmFsdWUoKX07aWYodGhpcy5vcHRpb25zLnZhbHVlcyYmdGhpcy5vcHRpb25zLnZhbHVlcy5sZW5ndGgpe2MudmFsdWU9XG50aGlzLnZhbHVlcyhhKTtjLnZhbHVlcz10aGlzLnZhbHVlcygpfXJldHVybiB0aGlzLl90cmlnZ2VyKFwic3RhcnRcIixiLGMpfSxfc2xpZGU6ZnVuY3Rpb24oYixhLGMpe3ZhciBlO2lmKHRoaXMub3B0aW9ucy52YWx1ZXMmJnRoaXMub3B0aW9ucy52YWx1ZXMubGVuZ3RoKXtlPXRoaXMudmFsdWVzKGE/MDoxKTtpZih0aGlzLm9wdGlvbnMudmFsdWVzLmxlbmd0aD09PTImJnRoaXMub3B0aW9ucy5yYW5nZT09PXRydWUmJihhPT09MCYmYz5lfHxhPT09MSYmYzxlKSljPWU7aWYoYyE9PXRoaXMudmFsdWVzKGEpKXtlPXRoaXMudmFsdWVzKCk7ZVthXT1jO2I9dGhpcy5fdHJpZ2dlcihcInNsaWRlXCIsYix7aGFuZGxlOnRoaXMuaGFuZGxlc1thXSx2YWx1ZTpjLHZhbHVlczplfSk7dGhpcy52YWx1ZXMoYT8wOjEpO2IhPT1mYWxzZSYmdGhpcy52YWx1ZXMoYSxjLHRydWUpfX1lbHNlIGlmKGMhPT10aGlzLnZhbHVlKCkpe2I9dGhpcy5fdHJpZ2dlcihcInNsaWRlXCIsYix7aGFuZGxlOnRoaXMuaGFuZGxlc1thXSxcbnZhbHVlOmN9KTtiIT09ZmFsc2UmJnRoaXMudmFsdWUoYyl9fSxfc3RvcDpmdW5jdGlvbihiLGEpe3ZhciBjPXtoYW5kbGU6dGhpcy5oYW5kbGVzW2FdLHZhbHVlOnRoaXMudmFsdWUoKX07aWYodGhpcy5vcHRpb25zLnZhbHVlcyYmdGhpcy5vcHRpb25zLnZhbHVlcy5sZW5ndGgpe2MudmFsdWU9dGhpcy52YWx1ZXMoYSk7Yy52YWx1ZXM9dGhpcy52YWx1ZXMoKX10aGlzLl90cmlnZ2VyKFwic3RvcFwiLGIsYyl9LF9jaGFuZ2U6ZnVuY3Rpb24oYixhKXtpZighdGhpcy5fa2V5U2xpZGluZyYmIXRoaXMuX21vdXNlU2xpZGluZyl7dmFyIGM9e2hhbmRsZTp0aGlzLmhhbmRsZXNbYV0sdmFsdWU6dGhpcy52YWx1ZSgpfTtpZih0aGlzLm9wdGlvbnMudmFsdWVzJiZ0aGlzLm9wdGlvbnMudmFsdWVzLmxlbmd0aCl7Yy52YWx1ZT10aGlzLnZhbHVlcyhhKTtjLnZhbHVlcz10aGlzLnZhbHVlcygpfXRoaXMuX3RyaWdnZXIoXCJjaGFuZ2VcIixiLGMpfX0sdmFsdWU6ZnVuY3Rpb24oYil7aWYoYXJndW1lbnRzLmxlbmd0aCl7dGhpcy5vcHRpb25zLnZhbHVlPVxudGhpcy5fdHJpbUFsaWduVmFsdWUoYik7dGhpcy5fcmVmcmVzaFZhbHVlKCk7dGhpcy5fY2hhbmdlKG51bGwsMCl9cmV0dXJuIHRoaXMuX3ZhbHVlKCl9LHZhbHVlczpmdW5jdGlvbihiLGEpe3ZhciBjLGUsZjtpZihhcmd1bWVudHMubGVuZ3RoPjEpe3RoaXMub3B0aW9ucy52YWx1ZXNbYl09dGhpcy5fdHJpbUFsaWduVmFsdWUoYSk7dGhpcy5fcmVmcmVzaFZhbHVlKCk7dGhpcy5fY2hhbmdlKG51bGwsYil9aWYoYXJndW1lbnRzLmxlbmd0aClpZihkLmlzQXJyYXkoYXJndW1lbnRzWzBdKSl7Yz10aGlzLm9wdGlvbnMudmFsdWVzO2U9YXJndW1lbnRzWzBdO2ZvcihmPTA7ZjxjLmxlbmd0aDtmKz0xKXtjW2ZdPXRoaXMuX3RyaW1BbGlnblZhbHVlKGVbZl0pO3RoaXMuX2NoYW5nZShudWxsLGYpfXRoaXMuX3JlZnJlc2hWYWx1ZSgpfWVsc2UgcmV0dXJuIHRoaXMub3B0aW9ucy52YWx1ZXMmJnRoaXMub3B0aW9ucy52YWx1ZXMubGVuZ3RoP3RoaXMuX3ZhbHVlcyhiKTp0aGlzLnZhbHVlKCk7XG5lbHNlIHJldHVybiB0aGlzLl92YWx1ZXMoKX0sX3NldE9wdGlvbjpmdW5jdGlvbihiLGEpe3ZhciBjLGU9MDtpZihkLmlzQXJyYXkodGhpcy5vcHRpb25zLnZhbHVlcykpZT10aGlzLm9wdGlvbnMudmFsdWVzLmxlbmd0aDtkLldpZGdldC5wcm90b3R5cGUuX3NldE9wdGlvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7c3dpdGNoKGIpe2Nhc2UgXCJkaXNhYmxlZFwiOmlmKGEpe3RoaXMuaGFuZGxlcy5maWx0ZXIoXCIudWktc3RhdGUtZm9jdXNcIikuYmx1cigpO3RoaXMuaGFuZGxlcy5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpO3RoaXMuaGFuZGxlcy5hdHRyKFwiZGlzYWJsZWRcIixcImRpc2FibGVkXCIpO3RoaXMuZWxlbWVudC5hZGRDbGFzcyhcInVpLWRpc2FibGVkXCIpfWVsc2V7dGhpcy5oYW5kbGVzLnJlbW92ZUF0dHIoXCJkaXNhYmxlZFwiKTt0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJ1aS1kaXNhYmxlZFwiKX1icmVhaztjYXNlIFwib3JpZW50YXRpb25cIjp0aGlzLl9kZXRlY3RPcmllbnRhdGlvbigpO1xudGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKFwidWktc2xpZGVyLWhvcml6b250YWwgdWktc2xpZGVyLXZlcnRpY2FsXCIpLmFkZENsYXNzKFwidWktc2xpZGVyLVwiK3RoaXMub3JpZW50YXRpb24pO3RoaXMuX3JlZnJlc2hWYWx1ZSgpO2JyZWFrO2Nhc2UgXCJ2YWx1ZVwiOnRoaXMuX2FuaW1hdGVPZmY9dHJ1ZTt0aGlzLl9yZWZyZXNoVmFsdWUoKTt0aGlzLl9jaGFuZ2UobnVsbCwwKTt0aGlzLl9hbmltYXRlT2ZmPWZhbHNlO2JyZWFrO2Nhc2UgXCJ2YWx1ZXNcIjp0aGlzLl9hbmltYXRlT2ZmPXRydWU7dGhpcy5fcmVmcmVzaFZhbHVlKCk7Zm9yKGM9MDtjPGU7Yys9MSl0aGlzLl9jaGFuZ2UobnVsbCxjKTt0aGlzLl9hbmltYXRlT2ZmPWZhbHNlO2JyZWFrfX0sX3ZhbHVlOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5vcHRpb25zLnZhbHVlO3JldHVybiBiPXRoaXMuX3RyaW1BbGlnblZhbHVlKGIpfSxfdmFsdWVzOmZ1bmN0aW9uKGIpe3ZhciBhLGM7aWYoYXJndW1lbnRzLmxlbmd0aCl7YT10aGlzLm9wdGlvbnMudmFsdWVzW2JdO1xucmV0dXJuIGE9dGhpcy5fdHJpbUFsaWduVmFsdWUoYSl9ZWxzZXthPXRoaXMub3B0aW9ucy52YWx1ZXMuc2xpY2UoKTtmb3IoYz0wO2M8YS5sZW5ndGg7Yys9MSlhW2NdPXRoaXMuX3RyaW1BbGlnblZhbHVlKGFbY10pO3JldHVybiBhfX0sX3RyaW1BbGlnblZhbHVlOmZ1bmN0aW9uKGIpe2lmKGI8PXRoaXMuX3ZhbHVlTWluKCkpcmV0dXJuIHRoaXMuX3ZhbHVlTWluKCk7aWYoYj49dGhpcy5fdmFsdWVNYXgoKSlyZXR1cm4gdGhpcy5fdmFsdWVNYXgoKTt2YXIgYT10aGlzLm9wdGlvbnMuc3RlcD4wP3RoaXMub3B0aW9ucy5zdGVwOjEsYz0oYi10aGlzLl92YWx1ZU1pbigpKSVhO2FsaWduVmFsdWU9Yi1jO2lmKE1hdGguYWJzKGMpKjI+PWEpYWxpZ25WYWx1ZSs9Yz4wP2E6LWE7cmV0dXJuIHBhcnNlRmxvYXQoYWxpZ25WYWx1ZS50b0ZpeGVkKDUpKX0sX3ZhbHVlTWluOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9ucy5taW59LF92YWx1ZU1heDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMubWF4fSxcbl9yZWZyZXNoVmFsdWU6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLm9wdGlvbnMucmFuZ2UsYT10aGlzLm9wdGlvbnMsYz10aGlzLGU9IXRoaXMuX2FuaW1hdGVPZmY/YS5hbmltYXRlOmZhbHNlLGYsaD17fSxnLGksaixsO2lmKHRoaXMub3B0aW9ucy52YWx1ZXMmJnRoaXMub3B0aW9ucy52YWx1ZXMubGVuZ3RoKXRoaXMuaGFuZGxlcy5lYWNoKGZ1bmN0aW9uKGspe2Y9KGMudmFsdWVzKGspLWMuX3ZhbHVlTWluKCkpLyhjLl92YWx1ZU1heCgpLWMuX3ZhbHVlTWluKCkpKjEwMDtoW2Mub3JpZW50YXRpb249PT1cImhvcml6b250YWxcIj9cImxlZnRcIjpcImJvdHRvbVwiXT1mK1wiJVwiO2QodGhpcykuc3RvcCgxLDEpW2U/XCJhbmltYXRlXCI6XCJjc3NcIl0oaCxhLmFuaW1hdGUpO2lmKGMub3B0aW9ucy5yYW5nZT09PXRydWUpaWYoYy5vcmllbnRhdGlvbj09PVwiaG9yaXpvbnRhbFwiKXtpZihrPT09MCljLnJhbmdlLnN0b3AoMSwxKVtlP1wiYW5pbWF0ZVwiOlwiY3NzXCJdKHtsZWZ0OmYrXCIlXCJ9LGEuYW5pbWF0ZSk7XG5pZihrPT09MSljLnJhbmdlW2U/XCJhbmltYXRlXCI6XCJjc3NcIl0oe3dpZHRoOmYtZytcIiVcIn0se3F1ZXVlOmZhbHNlLGR1cmF0aW9uOmEuYW5pbWF0ZX0pfWVsc2V7aWYoaz09PTApYy5yYW5nZS5zdG9wKDEsMSlbZT9cImFuaW1hdGVcIjpcImNzc1wiXSh7Ym90dG9tOmYrXCIlXCJ9LGEuYW5pbWF0ZSk7aWYoaz09PTEpYy5yYW5nZVtlP1wiYW5pbWF0ZVwiOlwiY3NzXCJdKHtoZWlnaHQ6Zi1nK1wiJVwifSx7cXVldWU6ZmFsc2UsZHVyYXRpb246YS5hbmltYXRlfSl9Zz1mfSk7ZWxzZXtpPXRoaXMudmFsdWUoKTtqPXRoaXMuX3ZhbHVlTWluKCk7bD10aGlzLl92YWx1ZU1heCgpO2Y9bCE9PWo/KGktaikvKGwtaikqMTAwOjA7aFtjLm9yaWVudGF0aW9uPT09XCJob3Jpem9udGFsXCI/XCJsZWZ0XCI6XCJib3R0b21cIl09ZitcIiVcIjt0aGlzLmhhbmRsZS5zdG9wKDEsMSlbZT9cImFuaW1hdGVcIjpcImNzc1wiXShoLGEuYW5pbWF0ZSk7aWYoYj09PVwibWluXCImJnRoaXMub3JpZW50YXRpb249PT1cImhvcml6b250YWxcIil0aGlzLnJhbmdlLnN0b3AoMSxcbjEpW2U/XCJhbmltYXRlXCI6XCJjc3NcIl0oe3dpZHRoOmYrXCIlXCJ9LGEuYW5pbWF0ZSk7aWYoYj09PVwibWF4XCImJnRoaXMub3JpZW50YXRpb249PT1cImhvcml6b250YWxcIil0aGlzLnJhbmdlW2U/XCJhbmltYXRlXCI6XCJjc3NcIl0oe3dpZHRoOjEwMC1mK1wiJVwifSx7cXVldWU6ZmFsc2UsZHVyYXRpb246YS5hbmltYXRlfSk7aWYoYj09PVwibWluXCImJnRoaXMub3JpZW50YXRpb249PT1cInZlcnRpY2FsXCIpdGhpcy5yYW5nZS5zdG9wKDEsMSlbZT9cImFuaW1hdGVcIjpcImNzc1wiXSh7aGVpZ2h0OmYrXCIlXCJ9LGEuYW5pbWF0ZSk7aWYoYj09PVwibWF4XCImJnRoaXMub3JpZW50YXRpb249PT1cInZlcnRpY2FsXCIpdGhpcy5yYW5nZVtlP1wiYW5pbWF0ZVwiOlwiY3NzXCJdKHtoZWlnaHQ6MTAwLWYrXCIlXCJ9LHtxdWV1ZTpmYWxzZSxkdXJhdGlvbjphLmFuaW1hdGV9KX19fSk7ZC5leHRlbmQoZC51aS5zbGlkZXIse3ZlcnNpb246XCIxLjguMTFcIn0pfSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgVGFicyAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXG4gKlxuICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9UYWJzXG4gKlxuICogRGVwZW5kczpcbiAqXHRqcXVlcnkudWkuY29yZS5qc1xuICpcdGpxdWVyeS51aS53aWRnZXQuanNcbiAqL1xuKGZ1bmN0aW9uKGQscCl7ZnVuY3Rpb24gdSgpe3JldHVybisrdn1mdW5jdGlvbiB3KCl7cmV0dXJuKyt4fXZhciB2PTAseD0wO2Qud2lkZ2V0KFwidWkudGFic1wiLHtvcHRpb25zOnthZGQ6bnVsbCxhamF4T3B0aW9uczpudWxsLGNhY2hlOmZhbHNlLGNvb2tpZTpudWxsLGNvbGxhcHNpYmxlOmZhbHNlLGRpc2FibGU6bnVsbCxkaXNhYmxlZDpbXSxlbmFibGU6bnVsbCxldmVudDpcImNsaWNrXCIsZng6bnVsbCxpZFByZWZpeDpcInVpLXRhYnMtXCIsbG9hZDpudWxsLHBhbmVsVGVtcGxhdGU6XCI8ZGl2PjwvZGl2PlwiLHJlbW92ZTpudWxsLHNlbGVjdDpudWxsLHNob3c6bnVsbCxzcGlubmVyOlwiPGVtPkxvYWRpbmcmIzgyMzA7PC9lbT5cIix0YWJUZW1wbGF0ZTpcIjxsaT48YSBocmVmPScje2hyZWZ9Jz48c3Bhbj4je2xhYmVsfTwvc3Bhbj48L2E+PC9saT5cIn0sX2NyZWF0ZTpmdW5jdGlvbigpe3RoaXMuX3RhYmlmeSh0cnVlKX0sX3NldE9wdGlvbjpmdW5jdGlvbihiLGUpe2lmKGI9PVwic2VsZWN0ZWRcIil0aGlzLm9wdGlvbnMuY29sbGFwc2libGUmJlxuZT09dGhpcy5vcHRpb25zLnNlbGVjdGVkfHx0aGlzLnNlbGVjdChlKTtlbHNle3RoaXMub3B0aW9uc1tiXT1lO3RoaXMuX3RhYmlmeSgpfX0sX3RhYklkOmZ1bmN0aW9uKGIpe3JldHVybiBiLnRpdGxlJiZiLnRpdGxlLnJlcGxhY2UoL1xccy9nLFwiX1wiKS5yZXBsYWNlKC9bXlxcd1xcdTAwYzAtXFx1RkZGRi1dL2csXCJcIil8fHRoaXMub3B0aW9ucy5pZFByZWZpeCt1KCl9LF9zYW5pdGl6ZVNlbGVjdG9yOmZ1bmN0aW9uKGIpe3JldHVybiBiLnJlcGxhY2UoLzovZyxcIlxcXFw6XCIpfSxfY29va2llOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5jb29raWV8fCh0aGlzLmNvb2tpZT10aGlzLm9wdGlvbnMuY29va2llLm5hbWV8fFwidWktdGFicy1cIit3KCkpO3JldHVybiBkLmNvb2tpZS5hcHBseShudWxsLFtiXS5jb25jYXQoZC5tYWtlQXJyYXkoYXJndW1lbnRzKSkpfSxfdWk6ZnVuY3Rpb24oYixlKXtyZXR1cm57dGFiOmIscGFuZWw6ZSxpbmRleDp0aGlzLmFuY2hvcnMuaW5kZXgoYil9fSxfY2xlYW51cDpmdW5jdGlvbigpe3RoaXMubGlzLmZpbHRlcihcIi51aS1zdGF0ZS1wcm9jZXNzaW5nXCIpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtcHJvY2Vzc2luZ1wiKS5maW5kKFwic3BhbjpkYXRhKGxhYmVsLnRhYnMpXCIpLmVhY2goZnVuY3Rpb24oKXt2YXIgYj1cbmQodGhpcyk7Yi5odG1sKGIuZGF0YShcImxhYmVsLnRhYnNcIikpLnJlbW92ZURhdGEoXCJsYWJlbC50YWJzXCIpfSl9LF90YWJpZnk6ZnVuY3Rpb24oYil7ZnVuY3Rpb24gZShnLGYpe2cuY3NzKFwiZGlzcGxheVwiLFwiXCIpOyFkLnN1cHBvcnQub3BhY2l0eSYmZi5vcGFjaXR5JiZnWzBdLnN0eWxlLnJlbW92ZUF0dHJpYnV0ZShcImZpbHRlclwiKX12YXIgYT10aGlzLGM9dGhpcy5vcHRpb25zLGg9L14jLisvO3RoaXMubGlzdD10aGlzLmVsZW1lbnQuZmluZChcIm9sLHVsXCIpLmVxKDApO3RoaXMubGlzPWQoXCIgPiBsaTpoYXMoYVtocmVmXSlcIix0aGlzLmxpc3QpO3RoaXMuYW5jaG9ycz10aGlzLmxpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gZChcImFcIix0aGlzKVswXX0pO3RoaXMucGFuZWxzPWQoW10pO3RoaXMuYW5jaG9ycy5lYWNoKGZ1bmN0aW9uKGcsZil7dmFyIGk9ZChmKS5hdHRyKFwiaHJlZlwiKSxsPWkuc3BsaXQoXCIjXCIpWzBdLHE7aWYobCYmKGw9PT1sb2NhdGlvbi50b1N0cmluZygpLnNwbGl0KFwiI1wiKVswXXx8XG4ocT1kKFwiYmFzZVwiKVswXSkmJmw9PT1xLmhyZWYpKXtpPWYuaGFzaDtmLmhyZWY9aX1pZihoLnRlc3QoaSkpYS5wYW5lbHM9YS5wYW5lbHMuYWRkKGEuZWxlbWVudC5maW5kKGEuX3Nhbml0aXplU2VsZWN0b3IoaSkpKTtlbHNlIGlmKGkmJmkhPT1cIiNcIil7ZC5kYXRhKGYsXCJocmVmLnRhYnNcIixpKTtkLmRhdGEoZixcImxvYWQudGFic1wiLGkucmVwbGFjZSgvIy4qJC8sXCJcIikpO2k9YS5fdGFiSWQoZik7Zi5ocmVmPVwiI1wiK2k7Zj1hLmVsZW1lbnQuZmluZChcIiNcIitpKTtpZighZi5sZW5ndGgpe2Y9ZChjLnBhbmVsVGVtcGxhdGUpLmF0dHIoXCJpZFwiLGkpLmFkZENsYXNzKFwidWktdGFicy1wYW5lbCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYm90dG9tXCIpLmluc2VydEFmdGVyKGEucGFuZWxzW2ctMV18fGEubGlzdCk7Zi5kYXRhKFwiZGVzdHJveS50YWJzXCIsdHJ1ZSl9YS5wYW5lbHM9YS5wYW5lbHMuYWRkKGYpfWVsc2UgYy5kaXNhYmxlZC5wdXNoKGcpfSk7aWYoYil7dGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktdGFicyB1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgdWktY29ybmVyLWFsbFwiKTtcbnRoaXMubGlzdC5hZGRDbGFzcyhcInVpLXRhYnMtbmF2IHVpLWhlbHBlci1yZXNldCB1aS1oZWxwZXItY2xlYXJmaXggdWktd2lkZ2V0LWhlYWRlciB1aS1jb3JuZXItYWxsXCIpO3RoaXMubGlzLmFkZENsYXNzKFwidWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItdG9wXCIpO3RoaXMucGFuZWxzLmFkZENsYXNzKFwidWktdGFicy1wYW5lbCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYm90dG9tXCIpO2lmKGMuc2VsZWN0ZWQ9PT1wKXtsb2NhdGlvbi5oYXNoJiZ0aGlzLmFuY2hvcnMuZWFjaChmdW5jdGlvbihnLGYpe2lmKGYuaGFzaD09bG9jYXRpb24uaGFzaCl7Yy5zZWxlY3RlZD1nO3JldHVybiBmYWxzZX19KTtpZih0eXBlb2YgYy5zZWxlY3RlZCE9PVwibnVtYmVyXCImJmMuY29va2llKWMuc2VsZWN0ZWQ9cGFyc2VJbnQoYS5fY29va2llKCksMTApO2lmKHR5cGVvZiBjLnNlbGVjdGVkIT09XCJudW1iZXJcIiYmdGhpcy5saXMuZmlsdGVyKFwiLnVpLXRhYnMtc2VsZWN0ZWRcIikubGVuZ3RoKWMuc2VsZWN0ZWQ9XG50aGlzLmxpcy5pbmRleCh0aGlzLmxpcy5maWx0ZXIoXCIudWktdGFicy1zZWxlY3RlZFwiKSk7Yy5zZWxlY3RlZD1jLnNlbGVjdGVkfHwodGhpcy5saXMubGVuZ3RoPzA6LTEpfWVsc2UgaWYoYy5zZWxlY3RlZD09PW51bGwpYy5zZWxlY3RlZD0tMTtjLnNlbGVjdGVkPWMuc2VsZWN0ZWQ+PTAmJnRoaXMuYW5jaG9yc1tjLnNlbGVjdGVkXXx8Yy5zZWxlY3RlZDwwP2Muc2VsZWN0ZWQ6MDtjLmRpc2FibGVkPWQudW5pcXVlKGMuZGlzYWJsZWQuY29uY2F0KGQubWFwKHRoaXMubGlzLmZpbHRlcihcIi51aS1zdGF0ZS1kaXNhYmxlZFwiKSxmdW5jdGlvbihnKXtyZXR1cm4gYS5saXMuaW5kZXgoZyl9KSkpLnNvcnQoKTtkLmluQXJyYXkoYy5zZWxlY3RlZCxjLmRpc2FibGVkKSE9LTEmJmMuZGlzYWJsZWQuc3BsaWNlKGQuaW5BcnJheShjLnNlbGVjdGVkLGMuZGlzYWJsZWQpLDEpO3RoaXMucGFuZWxzLmFkZENsYXNzKFwidWktdGFicy1oaWRlXCIpO3RoaXMubGlzLnJlbW92ZUNsYXNzKFwidWktdGFicy1zZWxlY3RlZCB1aS1zdGF0ZS1hY3RpdmVcIik7XG5pZihjLnNlbGVjdGVkPj0wJiZ0aGlzLmFuY2hvcnMubGVuZ3RoKXthLmVsZW1lbnQuZmluZChhLl9zYW5pdGl6ZVNlbGVjdG9yKGEuYW5jaG9yc1tjLnNlbGVjdGVkXS5oYXNoKSkucmVtb3ZlQ2xhc3MoXCJ1aS10YWJzLWhpZGVcIik7dGhpcy5saXMuZXEoYy5zZWxlY3RlZCkuYWRkQ2xhc3MoXCJ1aS10YWJzLXNlbGVjdGVkIHVpLXN0YXRlLWFjdGl2ZVwiKTthLmVsZW1lbnQucXVldWUoXCJ0YWJzXCIsZnVuY3Rpb24oKXthLl90cmlnZ2VyKFwic2hvd1wiLG51bGwsYS5fdWkoYS5hbmNob3JzW2Muc2VsZWN0ZWRdLGEuZWxlbWVudC5maW5kKGEuX3Nhbml0aXplU2VsZWN0b3IoYS5hbmNob3JzW2Muc2VsZWN0ZWRdLmhhc2gpKVswXSkpfSk7dGhpcy5sb2FkKGMuc2VsZWN0ZWQpfWQod2luZG93KS5iaW5kKFwidW5sb2FkXCIsZnVuY3Rpb24oKXthLmxpcy5hZGQoYS5hbmNob3JzKS51bmJpbmQoXCIudGFic1wiKTthLmxpcz1hLmFuY2hvcnM9YS5wYW5lbHM9bnVsbH0pfWVsc2UgYy5zZWxlY3RlZD10aGlzLmxpcy5pbmRleCh0aGlzLmxpcy5maWx0ZXIoXCIudWktdGFicy1zZWxlY3RlZFwiKSk7XG50aGlzLmVsZW1lbnRbYy5jb2xsYXBzaWJsZT9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXShcInVpLXRhYnMtY29sbGFwc2libGVcIik7Yy5jb29raWUmJnRoaXMuX2Nvb2tpZShjLnNlbGVjdGVkLGMuY29va2llKTtiPTA7Zm9yKHZhciBqO2o9dGhpcy5saXNbYl07YisrKWQoailbZC5pbkFycmF5KGIsYy5kaXNhYmxlZCkhPS0xJiYhZChqKS5oYXNDbGFzcyhcInVpLXRhYnMtc2VsZWN0ZWRcIik/XCJhZGRDbGFzc1wiOlwicmVtb3ZlQ2xhc3NcIl0oXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiKTtjLmNhY2hlPT09ZmFsc2UmJnRoaXMuYW5jaG9ycy5yZW1vdmVEYXRhKFwiY2FjaGUudGFic1wiKTt0aGlzLmxpcy5hZGQodGhpcy5hbmNob3JzKS51bmJpbmQoXCIudGFic1wiKTtpZihjLmV2ZW50IT09XCJtb3VzZW92ZXJcIil7dmFyIGs9ZnVuY3Rpb24oZyxmKXtmLmlzKFwiOm5vdCgudWktc3RhdGUtZGlzYWJsZWQpXCIpJiZmLmFkZENsYXNzKFwidWktc3RhdGUtXCIrZyl9LG49ZnVuY3Rpb24oZyxmKXtmLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtXCIrXG5nKX07dGhpcy5saXMuYmluZChcIm1vdXNlb3Zlci50YWJzXCIsZnVuY3Rpb24oKXtrKFwiaG92ZXJcIixkKHRoaXMpKX0pO3RoaXMubGlzLmJpbmQoXCJtb3VzZW91dC50YWJzXCIsZnVuY3Rpb24oKXtuKFwiaG92ZXJcIixkKHRoaXMpKX0pO3RoaXMuYW5jaG9ycy5iaW5kKFwiZm9jdXMudGFic1wiLGZ1bmN0aW9uKCl7ayhcImZvY3VzXCIsZCh0aGlzKS5jbG9zZXN0KFwibGlcIikpfSk7dGhpcy5hbmNob3JzLmJpbmQoXCJibHVyLnRhYnNcIixmdW5jdGlvbigpe24oXCJmb2N1c1wiLGQodGhpcykuY2xvc2VzdChcImxpXCIpKX0pfXZhciBtLG87aWYoYy5meClpZihkLmlzQXJyYXkoYy5meCkpe209Yy5meFswXTtvPWMuZnhbMV19ZWxzZSBtPW89Yy5meDt2YXIgcj1vP2Z1bmN0aW9uKGcsZil7ZChnKS5jbG9zZXN0KFwibGlcIikuYWRkQ2xhc3MoXCJ1aS10YWJzLXNlbGVjdGVkIHVpLXN0YXRlLWFjdGl2ZVwiKTtmLmhpZGUoKS5yZW1vdmVDbGFzcyhcInVpLXRhYnMtaGlkZVwiKS5hbmltYXRlKG8sby5kdXJhdGlvbnx8XCJub3JtYWxcIixcbmZ1bmN0aW9uKCl7ZShmLG8pO2EuX3RyaWdnZXIoXCJzaG93XCIsbnVsbCxhLl91aShnLGZbMF0pKX0pfTpmdW5jdGlvbihnLGYpe2QoZykuY2xvc2VzdChcImxpXCIpLmFkZENsYXNzKFwidWktdGFicy1zZWxlY3RlZCB1aS1zdGF0ZS1hY3RpdmVcIik7Zi5yZW1vdmVDbGFzcyhcInVpLXRhYnMtaGlkZVwiKTthLl90cmlnZ2VyKFwic2hvd1wiLG51bGwsYS5fdWkoZyxmWzBdKSl9LHM9bT9mdW5jdGlvbihnLGYpe2YuYW5pbWF0ZShtLG0uZHVyYXRpb258fFwibm9ybWFsXCIsZnVuY3Rpb24oKXthLmxpcy5yZW1vdmVDbGFzcyhcInVpLXRhYnMtc2VsZWN0ZWQgdWktc3RhdGUtYWN0aXZlXCIpO2YuYWRkQ2xhc3MoXCJ1aS10YWJzLWhpZGVcIik7ZShmLG0pO2EuZWxlbWVudC5kZXF1ZXVlKFwidGFic1wiKX0pfTpmdW5jdGlvbihnLGYpe2EubGlzLnJlbW92ZUNsYXNzKFwidWktdGFicy1zZWxlY3RlZCB1aS1zdGF0ZS1hY3RpdmVcIik7Zi5hZGRDbGFzcyhcInVpLXRhYnMtaGlkZVwiKTthLmVsZW1lbnQuZGVxdWV1ZShcInRhYnNcIil9O1xudGhpcy5hbmNob3JzLmJpbmQoYy5ldmVudCtcIi50YWJzXCIsZnVuY3Rpb24oKXt2YXIgZz10aGlzLGY9ZChnKS5jbG9zZXN0KFwibGlcIiksaT1hLnBhbmVscy5maWx0ZXIoXCI6bm90KC51aS10YWJzLWhpZGUpXCIpLGw9YS5lbGVtZW50LmZpbmQoYS5fc2FuaXRpemVTZWxlY3RvcihnLmhhc2gpKTtpZihmLmhhc0NsYXNzKFwidWktdGFicy1zZWxlY3RlZFwiKSYmIWMuY29sbGFwc2libGV8fGYuaGFzQ2xhc3MoXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiKXx8Zi5oYXNDbGFzcyhcInVpLXN0YXRlLXByb2Nlc3NpbmdcIil8fGEucGFuZWxzLmZpbHRlcihcIjphbmltYXRlZFwiKS5sZW5ndGh8fGEuX3RyaWdnZXIoXCJzZWxlY3RcIixudWxsLGEuX3VpKHRoaXMsbFswXSkpPT09ZmFsc2Upe3RoaXMuYmx1cigpO3JldHVybiBmYWxzZX1jLnNlbGVjdGVkPWEuYW5jaG9ycy5pbmRleCh0aGlzKTthLmFib3J0KCk7aWYoYy5jb2xsYXBzaWJsZSlpZihmLmhhc0NsYXNzKFwidWktdGFicy1zZWxlY3RlZFwiKSl7Yy5zZWxlY3RlZD1cbi0xO2MuY29va2llJiZhLl9jb29raWUoYy5zZWxlY3RlZCxjLmNvb2tpZSk7YS5lbGVtZW50LnF1ZXVlKFwidGFic1wiLGZ1bmN0aW9uKCl7cyhnLGkpfSkuZGVxdWV1ZShcInRhYnNcIik7dGhpcy5ibHVyKCk7cmV0dXJuIGZhbHNlfWVsc2UgaWYoIWkubGVuZ3RoKXtjLmNvb2tpZSYmYS5fY29va2llKGMuc2VsZWN0ZWQsYy5jb29raWUpO2EuZWxlbWVudC5xdWV1ZShcInRhYnNcIixmdW5jdGlvbigpe3IoZyxsKX0pO2EubG9hZChhLmFuY2hvcnMuaW5kZXgodGhpcykpO3RoaXMuYmx1cigpO3JldHVybiBmYWxzZX1jLmNvb2tpZSYmYS5fY29va2llKGMuc2VsZWN0ZWQsYy5jb29raWUpO2lmKGwubGVuZ3RoKXtpLmxlbmd0aCYmYS5lbGVtZW50LnF1ZXVlKFwidGFic1wiLGZ1bmN0aW9uKCl7cyhnLGkpfSk7YS5lbGVtZW50LnF1ZXVlKFwidGFic1wiLGZ1bmN0aW9uKCl7cihnLGwpfSk7YS5sb2FkKGEuYW5jaG9ycy5pbmRleCh0aGlzKSl9ZWxzZSB0aHJvd1wialF1ZXJ5IFVJIFRhYnM6IE1pc21hdGNoaW5nIGZyYWdtZW50IGlkZW50aWZpZXIuXCI7XG5kLmJyb3dzZXIubXNpZSYmdGhpcy5ibHVyKCl9KTt0aGlzLmFuY2hvcnMuYmluZChcImNsaWNrLnRhYnNcIixmdW5jdGlvbigpe3JldHVybiBmYWxzZX0pfSxfZ2V0SW5kZXg6ZnVuY3Rpb24oYil7aWYodHlwZW9mIGI9PVwic3RyaW5nXCIpYj10aGlzLmFuY2hvcnMuaW5kZXgodGhpcy5hbmNob3JzLmZpbHRlcihcIltocmVmJD1cIitiK1wiXVwiKSk7cmV0dXJuIGJ9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLm9wdGlvbnM7dGhpcy5hYm9ydCgpO3RoaXMuZWxlbWVudC51bmJpbmQoXCIudGFic1wiKS5yZW1vdmVDbGFzcyhcInVpLXRhYnMgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwgdWktdGFicy1jb2xsYXBzaWJsZVwiKS5yZW1vdmVEYXRhKFwidGFic1wiKTt0aGlzLmxpc3QucmVtb3ZlQ2xhc3MoXCJ1aS10YWJzLW5hdiB1aS1oZWxwZXItcmVzZXQgdWktaGVscGVyLWNsZWFyZml4IHVpLXdpZGdldC1oZWFkZXIgdWktY29ybmVyLWFsbFwiKTt0aGlzLmFuY2hvcnMuZWFjaChmdW5jdGlvbigpe3ZhciBlPVxuZC5kYXRhKHRoaXMsXCJocmVmLnRhYnNcIik7aWYoZSl0aGlzLmhyZWY9ZTt2YXIgYT1kKHRoaXMpLnVuYmluZChcIi50YWJzXCIpO2QuZWFjaChbXCJocmVmXCIsXCJsb2FkXCIsXCJjYWNoZVwiXSxmdW5jdGlvbihjLGgpe2EucmVtb3ZlRGF0YShoK1wiLnRhYnNcIil9KX0pO3RoaXMubGlzLnVuYmluZChcIi50YWJzXCIpLmFkZCh0aGlzLnBhbmVscykuZWFjaChmdW5jdGlvbigpe2QuZGF0YSh0aGlzLFwiZGVzdHJveS50YWJzXCIpP2QodGhpcykucmVtb3ZlKCk6ZCh0aGlzKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLXRvcCB1aS10YWJzLXNlbGVjdGVkIHVpLXN0YXRlLWFjdGl2ZSB1aS1zdGF0ZS1ob3ZlciB1aS1zdGF0ZS1mb2N1cyB1aS1zdGF0ZS1kaXNhYmxlZCB1aS10YWJzLXBhbmVsIHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1ib3R0b20gdWktdGFicy1oaWRlXCIpfSk7Yi5jb29raWUmJnRoaXMuX2Nvb2tpZShudWxsLGIuY29va2llKTtyZXR1cm4gdGhpc30sYWRkOmZ1bmN0aW9uKGIsXG5lLGEpe2lmKGE9PT1wKWE9dGhpcy5hbmNob3JzLmxlbmd0aDt2YXIgYz10aGlzLGg9dGhpcy5vcHRpb25zO2U9ZChoLnRhYlRlbXBsYXRlLnJlcGxhY2UoLyNcXHtocmVmXFx9L2csYikucmVwbGFjZSgvI1xce2xhYmVsXFx9L2csZSkpO2I9IWIuaW5kZXhPZihcIiNcIik/Yi5yZXBsYWNlKFwiI1wiLFwiXCIpOnRoaXMuX3RhYklkKGQoXCJhXCIsZSlbMF0pO2UuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci10b3BcIikuZGF0YShcImRlc3Ryb3kudGFic1wiLHRydWUpO3ZhciBqPWMuZWxlbWVudC5maW5kKFwiI1wiK2IpO2oubGVuZ3RofHwoaj1kKGgucGFuZWxUZW1wbGF0ZSkuYXR0cihcImlkXCIsYikuZGF0YShcImRlc3Ryb3kudGFic1wiLHRydWUpKTtqLmFkZENsYXNzKFwidWktdGFicy1wYW5lbCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYm90dG9tIHVpLXRhYnMtaGlkZVwiKTtpZihhPj10aGlzLmxpcy5sZW5ndGgpe2UuYXBwZW5kVG8odGhpcy5saXN0KTtqLmFwcGVuZFRvKHRoaXMubGlzdFswXS5wYXJlbnROb2RlKX1lbHNle2UuaW5zZXJ0QmVmb3JlKHRoaXMubGlzW2FdKTtcbmouaW5zZXJ0QmVmb3JlKHRoaXMucGFuZWxzW2FdKX1oLmRpc2FibGVkPWQubWFwKGguZGlzYWJsZWQsZnVuY3Rpb24oayl7cmV0dXJuIGs+PWE/KytrOmt9KTt0aGlzLl90YWJpZnkoKTtpZih0aGlzLmFuY2hvcnMubGVuZ3RoPT0xKXtoLnNlbGVjdGVkPTA7ZS5hZGRDbGFzcyhcInVpLXRhYnMtc2VsZWN0ZWQgdWktc3RhdGUtYWN0aXZlXCIpO2oucmVtb3ZlQ2xhc3MoXCJ1aS10YWJzLWhpZGVcIik7dGhpcy5lbGVtZW50LnF1ZXVlKFwidGFic1wiLGZ1bmN0aW9uKCl7Yy5fdHJpZ2dlcihcInNob3dcIixudWxsLGMuX3VpKGMuYW5jaG9yc1swXSxjLnBhbmVsc1swXSkpfSk7dGhpcy5sb2FkKDApfXRoaXMuX3RyaWdnZXIoXCJhZGRcIixudWxsLHRoaXMuX3VpKHRoaXMuYW5jaG9yc1thXSx0aGlzLnBhbmVsc1thXSkpO3JldHVybiB0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oYil7Yj10aGlzLl9nZXRJbmRleChiKTt2YXIgZT10aGlzLm9wdGlvbnMsYT10aGlzLmxpcy5lcShiKS5yZW1vdmUoKSxjPXRoaXMucGFuZWxzLmVxKGIpLnJlbW92ZSgpO1xuaWYoYS5oYXNDbGFzcyhcInVpLXRhYnMtc2VsZWN0ZWRcIikmJnRoaXMuYW5jaG9ycy5sZW5ndGg+MSl0aGlzLnNlbGVjdChiKyhiKzE8dGhpcy5hbmNob3JzLmxlbmd0aD8xOi0xKSk7ZS5kaXNhYmxlZD1kLm1hcChkLmdyZXAoZS5kaXNhYmxlZCxmdW5jdGlvbihoKXtyZXR1cm4gaCE9Yn0pLGZ1bmN0aW9uKGgpe3JldHVybiBoPj1iPy0taDpofSk7dGhpcy5fdGFiaWZ5KCk7dGhpcy5fdHJpZ2dlcihcInJlbW92ZVwiLG51bGwsdGhpcy5fdWkoYS5maW5kKFwiYVwiKVswXSxjWzBdKSk7cmV0dXJuIHRoaXN9LGVuYWJsZTpmdW5jdGlvbihiKXtiPXRoaXMuX2dldEluZGV4KGIpO3ZhciBlPXRoaXMub3B0aW9ucztpZihkLmluQXJyYXkoYixlLmRpc2FibGVkKSE9LTEpe3RoaXMubGlzLmVxKGIpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtZGlzYWJsZWRcIik7ZS5kaXNhYmxlZD1kLmdyZXAoZS5kaXNhYmxlZCxmdW5jdGlvbihhKXtyZXR1cm4gYSE9Yn0pO3RoaXMuX3RyaWdnZXIoXCJlbmFibGVcIixudWxsLFxudGhpcy5fdWkodGhpcy5hbmNob3JzW2JdLHRoaXMucGFuZWxzW2JdKSk7cmV0dXJuIHRoaXN9fSxkaXNhYmxlOmZ1bmN0aW9uKGIpe2I9dGhpcy5fZ2V0SW5kZXgoYik7dmFyIGU9dGhpcy5vcHRpb25zO2lmKGIhPWUuc2VsZWN0ZWQpe3RoaXMubGlzLmVxKGIpLmFkZENsYXNzKFwidWktc3RhdGUtZGlzYWJsZWRcIik7ZS5kaXNhYmxlZC5wdXNoKGIpO2UuZGlzYWJsZWQuc29ydCgpO3RoaXMuX3RyaWdnZXIoXCJkaXNhYmxlXCIsbnVsbCx0aGlzLl91aSh0aGlzLmFuY2hvcnNbYl0sdGhpcy5wYW5lbHNbYl0pKX1yZXR1cm4gdGhpc30sc2VsZWN0OmZ1bmN0aW9uKGIpe2I9dGhpcy5fZ2V0SW5kZXgoYik7aWYoYj09LTEpaWYodGhpcy5vcHRpb25zLmNvbGxhcHNpYmxlJiZ0aGlzLm9wdGlvbnMuc2VsZWN0ZWQhPS0xKWI9dGhpcy5vcHRpb25zLnNlbGVjdGVkO2Vsc2UgcmV0dXJuIHRoaXM7dGhpcy5hbmNob3JzLmVxKGIpLnRyaWdnZXIodGhpcy5vcHRpb25zLmV2ZW50K1wiLnRhYnNcIik7cmV0dXJuIHRoaXN9LFxubG9hZDpmdW5jdGlvbihiKXtiPXRoaXMuX2dldEluZGV4KGIpO3ZhciBlPXRoaXMsYT10aGlzLm9wdGlvbnMsYz10aGlzLmFuY2hvcnMuZXEoYilbMF0saD1kLmRhdGEoYyxcImxvYWQudGFic1wiKTt0aGlzLmFib3J0KCk7aWYoIWh8fHRoaXMuZWxlbWVudC5xdWV1ZShcInRhYnNcIikubGVuZ3RoIT09MCYmZC5kYXRhKGMsXCJjYWNoZS50YWJzXCIpKXRoaXMuZWxlbWVudC5kZXF1ZXVlKFwidGFic1wiKTtlbHNle3RoaXMubGlzLmVxKGIpLmFkZENsYXNzKFwidWktc3RhdGUtcHJvY2Vzc2luZ1wiKTtpZihhLnNwaW5uZXIpe3ZhciBqPWQoXCJzcGFuXCIsYyk7ai5kYXRhKFwibGFiZWwudGFic1wiLGouaHRtbCgpKS5odG1sKGEuc3Bpbm5lcil9dGhpcy54aHI9ZC5hamF4KGQuZXh0ZW5kKHt9LGEuYWpheE9wdGlvbnMse3VybDpoLHN1Y2Nlc3M6ZnVuY3Rpb24oayxuKXtlLmVsZW1lbnQuZmluZChlLl9zYW5pdGl6ZVNlbGVjdG9yKGMuaGFzaCkpLmh0bWwoayk7ZS5fY2xlYW51cCgpO2EuY2FjaGUmJmQuZGF0YShjLFxuXCJjYWNoZS50YWJzXCIsdHJ1ZSk7ZS5fdHJpZ2dlcihcImxvYWRcIixudWxsLGUuX3VpKGUuYW5jaG9yc1tiXSxlLnBhbmVsc1tiXSkpO3RyeXthLmFqYXhPcHRpb25zLnN1Y2Nlc3MoayxuKX1jYXRjaChtKXt9fSxlcnJvcjpmdW5jdGlvbihrLG4pe2UuX2NsZWFudXAoKTtlLl90cmlnZ2VyKFwibG9hZFwiLG51bGwsZS5fdWkoZS5hbmNob3JzW2JdLGUucGFuZWxzW2JdKSk7dHJ5e2EuYWpheE9wdGlvbnMuZXJyb3IoayxuLGIsYyl9Y2F0Y2gobSl7fX19KSk7ZS5lbGVtZW50LmRlcXVldWUoXCJ0YWJzXCIpO3JldHVybiB0aGlzfX0sYWJvcnQ6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQucXVldWUoW10pO3RoaXMucGFuZWxzLnN0b3AoZmFsc2UsdHJ1ZSk7dGhpcy5lbGVtZW50LnF1ZXVlKFwidGFic1wiLHRoaXMuZWxlbWVudC5xdWV1ZShcInRhYnNcIikuc3BsaWNlKC0yLDIpKTtpZih0aGlzLnhocil7dGhpcy54aHIuYWJvcnQoKTtkZWxldGUgdGhpcy54aHJ9dGhpcy5fY2xlYW51cCgpO3JldHVybiB0aGlzfSxcbnVybDpmdW5jdGlvbihiLGUpe3RoaXMuYW5jaG9ycy5lcShiKS5yZW1vdmVEYXRhKFwiY2FjaGUudGFic1wiKS5kYXRhKFwibG9hZC50YWJzXCIsZSk7cmV0dXJuIHRoaXN9LGxlbmd0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFuY2hvcnMubGVuZ3RofX0pO2QuZXh0ZW5kKGQudWkudGFicyx7dmVyc2lvbjpcIjEuOC4xMVwifSk7ZC5leHRlbmQoZC51aS50YWJzLnByb3RvdHlwZSx7cm90YXRpb246bnVsbCxyb3RhdGU6ZnVuY3Rpb24oYixlKXt2YXIgYT10aGlzLGM9dGhpcy5vcHRpb25zLGg9YS5fcm90YXRlfHwoYS5fcm90YXRlPWZ1bmN0aW9uKGope2NsZWFyVGltZW91dChhLnJvdGF0aW9uKTthLnJvdGF0aW9uPXNldFRpbWVvdXQoZnVuY3Rpb24oKXt2YXIgaz1jLnNlbGVjdGVkO2Euc2VsZWN0KCsrazxhLmFuY2hvcnMubGVuZ3RoP2s6MCl9LGIpO2omJmouc3RvcFByb3BhZ2F0aW9uKCl9KTtlPWEuX3Vucm90YXRlfHwoYS5fdW5yb3RhdGU9IWU/ZnVuY3Rpb24oail7ai5jbGllbnRYJiZcbmEucm90YXRlKG51bGwpfTpmdW5jdGlvbigpe3Q9Yy5zZWxlY3RlZDtoKCl9KTtpZihiKXt0aGlzLmVsZW1lbnQuYmluZChcInRhYnNzaG93XCIsaCk7dGhpcy5hbmNob3JzLmJpbmQoYy5ldmVudCtcIi50YWJzXCIsZSk7aCgpfWVsc2V7Y2xlYXJUaW1lb3V0KGEucm90YXRpb24pO3RoaXMuZWxlbWVudC51bmJpbmQoXCJ0YWJzc2hvd1wiLGgpO3RoaXMuYW5jaG9ycy51bmJpbmQoYy5ldmVudCtcIi50YWJzXCIsZSk7ZGVsZXRlIHRoaXMuX3JvdGF0ZTtkZWxldGUgdGhpcy5fdW5yb3RhdGV9cmV0dXJuIHRoaXN9fSl9KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBEYXRlcGlja2VyIDEuOC4xMVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL0RhdGVwaWNrZXJcbiAqXG4gKiBEZXBlbmRzOlxuICpcdGpxdWVyeS51aS5jb3JlLmpzXG4gKi9cbihmdW5jdGlvbihkLEEpe2Z1bmN0aW9uIEsoKXt0aGlzLmRlYnVnPWZhbHNlO3RoaXMuX2N1ckluc3Q9bnVsbDt0aGlzLl9rZXlFdmVudD1mYWxzZTt0aGlzLl9kaXNhYmxlZElucHV0cz1bXTt0aGlzLl9pbkRpYWxvZz10aGlzLl9kYXRlcGlja2VyU2hvd2luZz1mYWxzZTt0aGlzLl9tYWluRGl2SWQ9XCJ1aS1kYXRlcGlja2VyLWRpdlwiO3RoaXMuX2lubGluZUNsYXNzPVwidWktZGF0ZXBpY2tlci1pbmxpbmVcIjt0aGlzLl9hcHBlbmRDbGFzcz1cInVpLWRhdGVwaWNrZXItYXBwZW5kXCI7dGhpcy5fdHJpZ2dlckNsYXNzPVwidWktZGF0ZXBpY2tlci10cmlnZ2VyXCI7dGhpcy5fZGlhbG9nQ2xhc3M9XCJ1aS1kYXRlcGlja2VyLWRpYWxvZ1wiO3RoaXMuX2Rpc2FibGVDbGFzcz1cInVpLWRhdGVwaWNrZXItZGlzYWJsZWRcIjt0aGlzLl91bnNlbGVjdGFibGVDbGFzcz1cInVpLWRhdGVwaWNrZXItdW5zZWxlY3RhYmxlXCI7dGhpcy5fY3VycmVudENsYXNzPVwidWktZGF0ZXBpY2tlci1jdXJyZW50LWRheVwiO3RoaXMuX2RheU92ZXJDbGFzcz1cblwidWktZGF0ZXBpY2tlci1kYXlzLWNlbGwtb3ZlclwiO3RoaXMucmVnaW9uYWw9W107dGhpcy5yZWdpb25hbFtcIlwiXT17Y2xvc2VUZXh0OlwiRG9uZVwiLHByZXZUZXh0OlwiUHJldlwiLG5leHRUZXh0OlwiTmV4dFwiLGN1cnJlbnRUZXh0OlwiVG9kYXlcIixtb250aE5hbWVzOltcIkphbnVhcnlcIixcIkZlYnJ1YXJ5XCIsXCJNYXJjaFwiLFwiQXByaWxcIixcIk1heVwiLFwiSnVuZVwiLFwiSnVseVwiLFwiQXVndXN0XCIsXCJTZXB0ZW1iZXJcIixcIk9jdG9iZXJcIixcIk5vdmVtYmVyXCIsXCJEZWNlbWJlclwiXSxtb250aE5hbWVzU2hvcnQ6W1wiSmFuXCIsXCJGZWJcIixcIk1hclwiLFwiQXByXCIsXCJNYXlcIixcIkp1blwiLFwiSnVsXCIsXCJBdWdcIixcIlNlcFwiLFwiT2N0XCIsXCJOb3ZcIixcIkRlY1wiXSxkYXlOYW1lczpbXCJTdW5kYXlcIixcIk1vbmRheVwiLFwiVHVlc2RheVwiLFwiV2VkbmVzZGF5XCIsXCJUaHVyc2RheVwiLFwiRnJpZGF5XCIsXCJTYXR1cmRheVwiXSxkYXlOYW1lc1Nob3J0OltcIlN1blwiLFwiTW9uXCIsXCJUdWVcIixcIldlZFwiLFwiVGh1XCIsXCJGcmlcIixcIlNhdFwiXSxkYXlOYW1lc01pbjpbXCJTdVwiLFxuXCJNb1wiLFwiVHVcIixcIldlXCIsXCJUaFwiLFwiRnJcIixcIlNhXCJdLHdlZWtIZWFkZXI6XCJXa1wiLGRhdGVGb3JtYXQ6XCJtbS9kZC95eVwiLGZpcnN0RGF5OjAsaXNSVEw6ZmFsc2Usc2hvd01vbnRoQWZ0ZXJZZWFyOmZhbHNlLHllYXJTdWZmaXg6XCJcIn07dGhpcy5fZGVmYXVsdHM9e3Nob3dPbjpcImZvY3VzXCIsc2hvd0FuaW06XCJmYWRlSW5cIixzaG93T3B0aW9uczp7fSxkZWZhdWx0RGF0ZTpudWxsLGFwcGVuZFRleHQ6XCJcIixidXR0b25UZXh0OlwiLi4uXCIsYnV0dG9uSW1hZ2U6XCJcIixidXR0b25JbWFnZU9ubHk6ZmFsc2UsaGlkZUlmTm9QcmV2TmV4dDpmYWxzZSxuYXZpZ2F0aW9uQXNEYXRlRm9ybWF0OmZhbHNlLGdvdG9DdXJyZW50OmZhbHNlLGNoYW5nZU1vbnRoOmZhbHNlLGNoYW5nZVllYXI6ZmFsc2UseWVhclJhbmdlOlwiYy0xMDpjKzEwXCIsc2hvd090aGVyTW9udGhzOmZhbHNlLHNlbGVjdE90aGVyTW9udGhzOmZhbHNlLHNob3dXZWVrOmZhbHNlLGNhbGN1bGF0ZVdlZWs6dGhpcy5pc284NjAxV2VlayxzaG9ydFllYXJDdXRvZmY6XCIrMTBcIixcbm1pbkRhdGU6bnVsbCxtYXhEYXRlOm51bGwsZHVyYXRpb246XCJmYXN0XCIsYmVmb3JlU2hvd0RheTpudWxsLGJlZm9yZVNob3c6bnVsbCxvblNlbGVjdDpudWxsLG9uQ2hhbmdlTW9udGhZZWFyOm51bGwsb25DbG9zZTpudWxsLG51bWJlck9mTW9udGhzOjEsc2hvd0N1cnJlbnRBdFBvczowLHN0ZXBNb250aHM6MSxzdGVwQmlnTW9udGhzOjEyLGFsdEZpZWxkOlwiXCIsYWx0Rm9ybWF0OlwiXCIsY29uc3RyYWluSW5wdXQ6dHJ1ZSxzaG93QnV0dG9uUGFuZWw6ZmFsc2UsYXV0b1NpemU6ZmFsc2V9O2QuZXh0ZW5kKHRoaXMuX2RlZmF1bHRzLHRoaXMucmVnaW9uYWxbXCJcIl0pO3RoaXMuZHBEaXY9ZCgnPGRpdiBpZD1cIicrdGhpcy5fbWFpbkRpdklkKydcIiBjbGFzcz1cInVpLWRhdGVwaWNrZXIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWhlbHBlci1jbGVhcmZpeCB1aS1jb3JuZXItYWxsXCI+PC9kaXY+Jyl9ZnVuY3Rpb24gRihhLGIpe2QuZXh0ZW5kKGEsYik7Zm9yKHZhciBjIGluIGIpaWYoYltjXT09XG5udWxsfHxiW2NdPT1BKWFbY109YltjXTtyZXR1cm4gYX1kLmV4dGVuZChkLnVpLHtkYXRlcGlja2VyOnt2ZXJzaW9uOlwiMS44LjExXCJ9fSk7dmFyIHk9KG5ldyBEYXRlKS5nZXRUaW1lKCk7ZC5leHRlbmQoSy5wcm90b3R5cGUse21hcmtlckNsYXNzTmFtZTpcImhhc0RhdGVwaWNrZXJcIixsb2c6ZnVuY3Rpb24oKXt0aGlzLmRlYnVnJiZjb25zb2xlLmxvZy5hcHBseShcIlwiLGFyZ3VtZW50cyl9LF93aWRnZXREYXRlcGlja2VyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZHBEaXZ9LHNldERlZmF1bHRzOmZ1bmN0aW9uKGEpe0YodGhpcy5fZGVmYXVsdHMsYXx8e30pO3JldHVybiB0aGlzfSxfYXR0YWNoRGF0ZXBpY2tlcjpmdW5jdGlvbihhLGIpe3ZhciBjPW51bGw7Zm9yKHZhciBlIGluIHRoaXMuX2RlZmF1bHRzKXt2YXIgZj1hLmdldEF0dHJpYnV0ZShcImRhdGU6XCIrZSk7aWYoZil7Yz1jfHx7fTt0cnl7Y1tlXT1ldmFsKGYpfWNhdGNoKGgpe2NbZV09Zn19fWU9YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuZj1lPT1cImRpdlwifHxlPT1cInNwYW5cIjtpZighYS5pZCl7dGhpcy51dWlkKz0xO2EuaWQ9XCJkcFwiK3RoaXMudXVpZH12YXIgaT10aGlzLl9uZXdJbnN0KGQoYSksZik7aS5zZXR0aW5ncz1kLmV4dGVuZCh7fSxifHx7fSxjfHx7fSk7aWYoZT09XCJpbnB1dFwiKXRoaXMuX2Nvbm5lY3REYXRlcGlja2VyKGEsaSk7ZWxzZSBmJiZ0aGlzLl9pbmxpbmVEYXRlcGlja2VyKGEsaSl9LF9uZXdJbnN0OmZ1bmN0aW9uKGEsYil7cmV0dXJue2lkOmFbMF0uaWQucmVwbGFjZSgvKFteQS1aYS16MC05Xy1dKS9nLFwiXFxcXFxcXFwkMVwiKSxpbnB1dDphLHNlbGVjdGVkRGF5OjAsc2VsZWN0ZWRNb250aDowLHNlbGVjdGVkWWVhcjowLGRyYXdNb250aDowLGRyYXdZZWFyOjAsaW5saW5lOmIsZHBEaXY6IWI/dGhpcy5kcERpdjpkKCc8ZGl2IGNsYXNzPVwiJyt0aGlzLl9pbmxpbmVDbGFzcysnIHVpLWRhdGVwaWNrZXIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWhlbHBlci1jbGVhcmZpeCB1aS1jb3JuZXItYWxsXCI+PC9kaXY+Jyl9fSxcbl9jb25uZWN0RGF0ZXBpY2tlcjpmdW5jdGlvbihhLGIpe3ZhciBjPWQoYSk7Yi5hcHBlbmQ9ZChbXSk7Yi50cmlnZ2VyPWQoW10pO2lmKCFjLmhhc0NsYXNzKHRoaXMubWFya2VyQ2xhc3NOYW1lKSl7dGhpcy5fYXR0YWNobWVudHMoYyxiKTtjLmFkZENsYXNzKHRoaXMubWFya2VyQ2xhc3NOYW1lKS5rZXlkb3duKHRoaXMuX2RvS2V5RG93bikua2V5cHJlc3ModGhpcy5fZG9LZXlQcmVzcykua2V5dXAodGhpcy5fZG9LZXlVcCkuYmluZChcInNldERhdGEuZGF0ZXBpY2tlclwiLGZ1bmN0aW9uKGUsZixoKXtiLnNldHRpbmdzW2ZdPWh9KS5iaW5kKFwiZ2V0RGF0YS5kYXRlcGlja2VyXCIsZnVuY3Rpb24oZSxmKXtyZXR1cm4gdGhpcy5fZ2V0KGIsZil9KTt0aGlzLl9hdXRvU2l6ZShiKTtkLmRhdGEoYSxcImRhdGVwaWNrZXJcIixiKX19LF9hdHRhY2htZW50czpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuX2dldChiLFwiYXBwZW5kVGV4dFwiKSxlPXRoaXMuX2dldChiLFwiaXNSVExcIik7Yi5hcHBlbmQmJlxuYi5hcHBlbmQucmVtb3ZlKCk7aWYoYyl7Yi5hcHBlbmQ9ZCgnPHNwYW4gY2xhc3M9XCInK3RoaXMuX2FwcGVuZENsYXNzKydcIj4nK2MrXCI8L3NwYW4+XCIpO2FbZT9cImJlZm9yZVwiOlwiYWZ0ZXJcIl0oYi5hcHBlbmQpfWEudW5iaW5kKFwiZm9jdXNcIix0aGlzLl9zaG93RGF0ZXBpY2tlcik7Yi50cmlnZ2VyJiZiLnRyaWdnZXIucmVtb3ZlKCk7Yz10aGlzLl9nZXQoYixcInNob3dPblwiKTtpZihjPT1cImZvY3VzXCJ8fGM9PVwiYm90aFwiKWEuZm9jdXModGhpcy5fc2hvd0RhdGVwaWNrZXIpO2lmKGM9PVwiYnV0dG9uXCJ8fGM9PVwiYm90aFwiKXtjPXRoaXMuX2dldChiLFwiYnV0dG9uVGV4dFwiKTt2YXIgZj10aGlzLl9nZXQoYixcImJ1dHRvbkltYWdlXCIpO2IudHJpZ2dlcj1kKHRoaXMuX2dldChiLFwiYnV0dG9uSW1hZ2VPbmx5XCIpP2QoXCI8aW1nLz5cIikuYWRkQ2xhc3ModGhpcy5fdHJpZ2dlckNsYXNzKS5hdHRyKHtzcmM6ZixhbHQ6Yyx0aXRsZTpjfSk6ZCgnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCI+PC9idXR0b24+JykuYWRkQ2xhc3ModGhpcy5fdHJpZ2dlckNsYXNzKS5odG1sKGY9PVxuXCJcIj9jOmQoXCI8aW1nLz5cIikuYXR0cih7c3JjOmYsYWx0OmMsdGl0bGU6Y30pKSk7YVtlP1wiYmVmb3JlXCI6XCJhZnRlclwiXShiLnRyaWdnZXIpO2IudHJpZ2dlci5jbGljayhmdW5jdGlvbigpe2QuZGF0ZXBpY2tlci5fZGF0ZXBpY2tlclNob3dpbmcmJmQuZGF0ZXBpY2tlci5fbGFzdElucHV0PT1hWzBdP2QuZGF0ZXBpY2tlci5faGlkZURhdGVwaWNrZXIoKTpkLmRhdGVwaWNrZXIuX3Nob3dEYXRlcGlja2VyKGFbMF0pO3JldHVybiBmYWxzZX0pfX0sX2F1dG9TaXplOmZ1bmN0aW9uKGEpe2lmKHRoaXMuX2dldChhLFwiYXV0b1NpemVcIikmJiFhLmlubGluZSl7dmFyIGI9bmV3IERhdGUoMjAwOSwxMSwyMCksYz10aGlzLl9nZXQoYSxcImRhdGVGb3JtYXRcIik7aWYoYy5tYXRjaCgvW0RNXS8pKXt2YXIgZT1mdW5jdGlvbihmKXtmb3IodmFyIGg9MCxpPTAsZz0wO2c8Zi5sZW5ndGg7ZysrKWlmKGZbZ10ubGVuZ3RoPmgpe2g9ZltnXS5sZW5ndGg7aT1nfXJldHVybiBpfTtiLnNldE1vbnRoKGUodGhpcy5fZ2V0KGEsXG5jLm1hdGNoKC9NTS8pP1wibW9udGhOYW1lc1wiOlwibW9udGhOYW1lc1Nob3J0XCIpKSk7Yi5zZXREYXRlKGUodGhpcy5fZ2V0KGEsYy5tYXRjaCgvREQvKT9cImRheU5hbWVzXCI6XCJkYXlOYW1lc1Nob3J0XCIpKSsyMC1iLmdldERheSgpKX1hLmlucHV0LmF0dHIoXCJzaXplXCIsdGhpcy5fZm9ybWF0RGF0ZShhLGIpLmxlbmd0aCl9fSxfaW5saW5lRGF0ZXBpY2tlcjpmdW5jdGlvbihhLGIpe3ZhciBjPWQoYSk7aWYoIWMuaGFzQ2xhc3ModGhpcy5tYXJrZXJDbGFzc05hbWUpKXtjLmFkZENsYXNzKHRoaXMubWFya2VyQ2xhc3NOYW1lKS5hcHBlbmQoYi5kcERpdikuYmluZChcInNldERhdGEuZGF0ZXBpY2tlclwiLGZ1bmN0aW9uKGUsZixoKXtiLnNldHRpbmdzW2ZdPWh9KS5iaW5kKFwiZ2V0RGF0YS5kYXRlcGlja2VyXCIsZnVuY3Rpb24oZSxmKXtyZXR1cm4gdGhpcy5fZ2V0KGIsZil9KTtkLmRhdGEoYSxcImRhdGVwaWNrZXJcIixiKTt0aGlzLl9zZXREYXRlKGIsdGhpcy5fZ2V0RGVmYXVsdERhdGUoYiksXG50cnVlKTt0aGlzLl91cGRhdGVEYXRlcGlja2VyKGIpO3RoaXMuX3VwZGF0ZUFsdGVybmF0ZShiKTtiLmRwRGl2LnNob3coKX19LF9kaWFsb2dEYXRlcGlja2VyOmZ1bmN0aW9uKGEsYixjLGUsZil7YT10aGlzLl9kaWFsb2dJbnN0O2lmKCFhKXt0aGlzLnV1aWQrPTE7dGhpcy5fZGlhbG9nSW5wdXQ9ZCgnPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCInKyhcImRwXCIrdGhpcy51dWlkKSsnXCIgc3R5bGU9XCJwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogLTEwMHB4OyB3aWR0aDogMHB4OyB6LWluZGV4OiAtMTA7XCIvPicpO3RoaXMuX2RpYWxvZ0lucHV0LmtleWRvd24odGhpcy5fZG9LZXlEb3duKTtkKFwiYm9keVwiKS5hcHBlbmQodGhpcy5fZGlhbG9nSW5wdXQpO2E9dGhpcy5fZGlhbG9nSW5zdD10aGlzLl9uZXdJbnN0KHRoaXMuX2RpYWxvZ0lucHV0LGZhbHNlKTthLnNldHRpbmdzPXt9O2QuZGF0YSh0aGlzLl9kaWFsb2dJbnB1dFswXSxcImRhdGVwaWNrZXJcIixhKX1GKGEuc2V0dGluZ3MsZXx8e30pO1xuYj1iJiZiLmNvbnN0cnVjdG9yPT1EYXRlP3RoaXMuX2Zvcm1hdERhdGUoYSxiKTpiO3RoaXMuX2RpYWxvZ0lucHV0LnZhbChiKTt0aGlzLl9wb3M9Zj9mLmxlbmd0aD9mOltmLnBhZ2VYLGYucGFnZVldOm51bGw7aWYoIXRoaXMuX3Bvcyl0aGlzLl9wb3M9W2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aC8yLTEwMCsoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnR8fGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCksZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodC8yLTE1MCsoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcHx8ZG9jdW1lbnQuYm9keS5zY3JvbGxUb3ApXTt0aGlzLl9kaWFsb2dJbnB1dC5jc3MoXCJsZWZ0XCIsdGhpcy5fcG9zWzBdKzIwK1wicHhcIikuY3NzKFwidG9wXCIsdGhpcy5fcG9zWzFdK1wicHhcIik7YS5zZXR0aW5ncy5vblNlbGVjdD1jO3RoaXMuX2luRGlhbG9nPXRydWU7dGhpcy5kcERpdi5hZGRDbGFzcyh0aGlzLl9kaWFsb2dDbGFzcyk7XG50aGlzLl9zaG93RGF0ZXBpY2tlcih0aGlzLl9kaWFsb2dJbnB1dFswXSk7ZC5ibG9ja1VJJiZkLmJsb2NrVUkodGhpcy5kcERpdik7ZC5kYXRhKHRoaXMuX2RpYWxvZ0lucHV0WzBdLFwiZGF0ZXBpY2tlclwiLGEpO3JldHVybiB0aGlzfSxfZGVzdHJveURhdGVwaWNrZXI6ZnVuY3Rpb24oYSl7dmFyIGI9ZChhKSxjPWQuZGF0YShhLFwiZGF0ZXBpY2tlclwiKTtpZihiLmhhc0NsYXNzKHRoaXMubWFya2VyQ2xhc3NOYW1lKSl7dmFyIGU9YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO2QucmVtb3ZlRGF0YShhLFwiZGF0ZXBpY2tlclwiKTtpZihlPT1cImlucHV0XCIpe2MuYXBwZW5kLnJlbW92ZSgpO2MudHJpZ2dlci5yZW1vdmUoKTtiLnJlbW92ZUNsYXNzKHRoaXMubWFya2VyQ2xhc3NOYW1lKS51bmJpbmQoXCJmb2N1c1wiLHRoaXMuX3Nob3dEYXRlcGlja2VyKS51bmJpbmQoXCJrZXlkb3duXCIsdGhpcy5fZG9LZXlEb3duKS51bmJpbmQoXCJrZXlwcmVzc1wiLHRoaXMuX2RvS2V5UHJlc3MpLnVuYmluZChcImtleXVwXCIsXG50aGlzLl9kb0tleVVwKX1lbHNlIGlmKGU9PVwiZGl2XCJ8fGU9PVwic3BhblwiKWIucmVtb3ZlQ2xhc3ModGhpcy5tYXJrZXJDbGFzc05hbWUpLmVtcHR5KCl9fSxfZW5hYmxlRGF0ZXBpY2tlcjpmdW5jdGlvbihhKXt2YXIgYj1kKGEpLGM9ZC5kYXRhKGEsXCJkYXRlcGlja2VyXCIpO2lmKGIuaGFzQ2xhc3ModGhpcy5tYXJrZXJDbGFzc05hbWUpKXt2YXIgZT1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7aWYoZT09XCJpbnB1dFwiKXthLmRpc2FibGVkPWZhbHNlO2MudHJpZ2dlci5maWx0ZXIoXCJidXR0b25cIikuZWFjaChmdW5jdGlvbigpe3RoaXMuZGlzYWJsZWQ9ZmFsc2V9KS5lbmQoKS5maWx0ZXIoXCJpbWdcIikuY3NzKHtvcGFjaXR5OlwiMS4wXCIsY3Vyc29yOlwiXCJ9KX1lbHNlIGlmKGU9PVwiZGl2XCJ8fGU9PVwic3BhblwiKWIuY2hpbGRyZW4oXCIuXCIrdGhpcy5faW5saW5lQ2xhc3MpLmNoaWxkcmVuKCkucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiKTt0aGlzLl9kaXNhYmxlZElucHV0cz1kLm1hcCh0aGlzLl9kaXNhYmxlZElucHV0cyxcbmZ1bmN0aW9uKGYpe3JldHVybiBmPT1hP251bGw6Zn0pfX0sX2Rpc2FibGVEYXRlcGlja2VyOmZ1bmN0aW9uKGEpe3ZhciBiPWQoYSksYz1kLmRhdGEoYSxcImRhdGVwaWNrZXJcIik7aWYoYi5oYXNDbGFzcyh0aGlzLm1hcmtlckNsYXNzTmFtZSkpe3ZhciBlPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtpZihlPT1cImlucHV0XCIpe2EuZGlzYWJsZWQ9dHJ1ZTtjLnRyaWdnZXIuZmlsdGVyKFwiYnV0dG9uXCIpLmVhY2goZnVuY3Rpb24oKXt0aGlzLmRpc2FibGVkPXRydWV9KS5lbmQoKS5maWx0ZXIoXCJpbWdcIikuY3NzKHtvcGFjaXR5OlwiMC41XCIsY3Vyc29yOlwiZGVmYXVsdFwifSl9ZWxzZSBpZihlPT1cImRpdlwifHxlPT1cInNwYW5cIiliLmNoaWxkcmVuKFwiLlwiK3RoaXMuX2lubGluZUNsYXNzKS5jaGlsZHJlbigpLmFkZENsYXNzKFwidWktc3RhdGUtZGlzYWJsZWRcIik7dGhpcy5fZGlzYWJsZWRJbnB1dHM9ZC5tYXAodGhpcy5fZGlzYWJsZWRJbnB1dHMsZnVuY3Rpb24oZil7cmV0dXJuIGY9PWE/bnVsbDpcbmZ9KTt0aGlzLl9kaXNhYmxlZElucHV0c1t0aGlzLl9kaXNhYmxlZElucHV0cy5sZW5ndGhdPWF9fSxfaXNEaXNhYmxlZERhdGVwaWNrZXI6ZnVuY3Rpb24oYSl7aWYoIWEpcmV0dXJuIGZhbHNlO2Zvcih2YXIgYj0wO2I8dGhpcy5fZGlzYWJsZWRJbnB1dHMubGVuZ3RoO2IrKylpZih0aGlzLl9kaXNhYmxlZElucHV0c1tiXT09YSlyZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2V9LF9nZXRJbnN0OmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gZC5kYXRhKGEsXCJkYXRlcGlja2VyXCIpfWNhdGNoKGIpe3Rocm93XCJNaXNzaW5nIGluc3RhbmNlIGRhdGEgZm9yIHRoaXMgZGF0ZXBpY2tlclwiO319LF9vcHRpb25EYXRlcGlja2VyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZT10aGlzLl9nZXRJbnN0KGEpO2lmKGFyZ3VtZW50cy5sZW5ndGg9PTImJnR5cGVvZiBiPT1cInN0cmluZ1wiKXJldHVybiBiPT1cImRlZmF1bHRzXCI/ZC5leHRlbmQoe30sZC5kYXRlcGlja2VyLl9kZWZhdWx0cyk6ZT9iPT1cImFsbFwiP2QuZXh0ZW5kKHt9LFxuZS5zZXR0aW5ncyk6dGhpcy5fZ2V0KGUsYik6bnVsbDt2YXIgZj1ifHx7fTtpZih0eXBlb2YgYj09XCJzdHJpbmdcIil7Zj17fTtmW2JdPWN9aWYoZSl7dGhpcy5fY3VySW5zdD09ZSYmdGhpcy5faGlkZURhdGVwaWNrZXIoKTt2YXIgaD10aGlzLl9nZXREYXRlRGF0ZXBpY2tlcihhLHRydWUpLGk9dGhpcy5fZ2V0TWluTWF4RGF0ZShlLFwibWluXCIpLGc9dGhpcy5fZ2V0TWluTWF4RGF0ZShlLFwibWF4XCIpO0YoZS5zZXR0aW5ncyxmKTtpZihpIT09bnVsbCYmZi5kYXRlRm9ybWF0IT09QSYmZi5taW5EYXRlPT09QSllLnNldHRpbmdzLm1pbkRhdGU9dGhpcy5fZm9ybWF0RGF0ZShlLGkpO2lmKGchPT1udWxsJiZmLmRhdGVGb3JtYXQhPT1BJiZmLm1heERhdGU9PT1BKWUuc2V0dGluZ3MubWF4RGF0ZT10aGlzLl9mb3JtYXREYXRlKGUsZyk7dGhpcy5fYXR0YWNobWVudHMoZChhKSxlKTt0aGlzLl9hdXRvU2l6ZShlKTt0aGlzLl9zZXREYXRlRGF0ZXBpY2tlcihhLGgpO3RoaXMuX3VwZGF0ZURhdGVwaWNrZXIoZSl9fSxcbl9jaGFuZ2VEYXRlcGlja2VyOmZ1bmN0aW9uKGEsYixjKXt0aGlzLl9vcHRpb25EYXRlcGlja2VyKGEsYixjKX0sX3JlZnJlc2hEYXRlcGlja2VyOmZ1bmN0aW9uKGEpeyhhPXRoaXMuX2dldEluc3QoYSkpJiZ0aGlzLl91cGRhdGVEYXRlcGlja2VyKGEpfSxfc2V0RGF0ZURhdGVwaWNrZXI6ZnVuY3Rpb24oYSxiKXtpZihhPXRoaXMuX2dldEluc3QoYSkpe3RoaXMuX3NldERhdGUoYSxiKTt0aGlzLl91cGRhdGVEYXRlcGlja2VyKGEpO3RoaXMuX3VwZGF0ZUFsdGVybmF0ZShhKX19LF9nZXREYXRlRGF0ZXBpY2tlcjpmdW5jdGlvbihhLGIpeyhhPXRoaXMuX2dldEluc3QoYSkpJiYhYS5pbmxpbmUmJnRoaXMuX3NldERhdGVGcm9tRmllbGQoYSxiKTtyZXR1cm4gYT90aGlzLl9nZXREYXRlKGEpOm51bGx9LF9kb0tleURvd246ZnVuY3Rpb24oYSl7dmFyIGI9ZC5kYXRlcGlja2VyLl9nZXRJbnN0KGEudGFyZ2V0KSxjPXRydWUsZT1iLmRwRGl2LmlzKFwiLnVpLWRhdGVwaWNrZXItcnRsXCIpO1xuYi5fa2V5RXZlbnQ9dHJ1ZTtpZihkLmRhdGVwaWNrZXIuX2RhdGVwaWNrZXJTaG93aW5nKXN3aXRjaChhLmtleUNvZGUpe2Nhc2UgOTpkLmRhdGVwaWNrZXIuX2hpZGVEYXRlcGlja2VyKCk7Yz1mYWxzZTticmVhaztjYXNlIDEzOmM9ZChcInRkLlwiK2QuZGF0ZXBpY2tlci5fZGF5T3ZlckNsYXNzK1wiOm5vdCguXCIrZC5kYXRlcGlja2VyLl9jdXJyZW50Q2xhc3MrXCIpXCIsYi5kcERpdik7Y1swXT9kLmRhdGVwaWNrZXIuX3NlbGVjdERheShhLnRhcmdldCxiLnNlbGVjdGVkTW9udGgsYi5zZWxlY3RlZFllYXIsY1swXSk6ZC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpO3JldHVybiBmYWxzZTtjYXNlIDI3OmQuZGF0ZXBpY2tlci5faGlkZURhdGVwaWNrZXIoKTticmVhaztjYXNlIDMzOmQuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZShhLnRhcmdldCxhLmN0cmxLZXk/LWQuZGF0ZXBpY2tlci5fZ2V0KGIsXCJzdGVwQmlnTW9udGhzXCIpOi1kLmRhdGVwaWNrZXIuX2dldChiLFwic3RlcE1vbnRoc1wiKSxcblwiTVwiKTticmVhaztjYXNlIDM0OmQuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZShhLnRhcmdldCxhLmN0cmxLZXk/K2QuZGF0ZXBpY2tlci5fZ2V0KGIsXCJzdGVwQmlnTW9udGhzXCIpOitkLmRhdGVwaWNrZXIuX2dldChiLFwic3RlcE1vbnRoc1wiKSxcIk1cIik7YnJlYWs7Y2FzZSAzNTppZihhLmN0cmxLZXl8fGEubWV0YUtleSlkLmRhdGVwaWNrZXIuX2NsZWFyRGF0ZShhLnRhcmdldCk7Yz1hLmN0cmxLZXl8fGEubWV0YUtleTticmVhaztjYXNlIDM2OmlmKGEuY3RybEtleXx8YS5tZXRhS2V5KWQuZGF0ZXBpY2tlci5fZ290b1RvZGF5KGEudGFyZ2V0KTtjPWEuY3RybEtleXx8YS5tZXRhS2V5O2JyZWFrO2Nhc2UgMzc6aWYoYS5jdHJsS2V5fHxhLm1ldGFLZXkpZC5kYXRlcGlja2VyLl9hZGp1c3REYXRlKGEudGFyZ2V0LGU/KzE6LTEsXCJEXCIpO2M9YS5jdHJsS2V5fHxhLm1ldGFLZXk7aWYoYS5vcmlnaW5hbEV2ZW50LmFsdEtleSlkLmRhdGVwaWNrZXIuX2FkanVzdERhdGUoYS50YXJnZXQsYS5jdHJsS2V5P1xuLWQuZGF0ZXBpY2tlci5fZ2V0KGIsXCJzdGVwQmlnTW9udGhzXCIpOi1kLmRhdGVwaWNrZXIuX2dldChiLFwic3RlcE1vbnRoc1wiKSxcIk1cIik7YnJlYWs7Y2FzZSAzODppZihhLmN0cmxLZXl8fGEubWV0YUtleSlkLmRhdGVwaWNrZXIuX2FkanVzdERhdGUoYS50YXJnZXQsLTcsXCJEXCIpO2M9YS5jdHJsS2V5fHxhLm1ldGFLZXk7YnJlYWs7Y2FzZSAzOTppZihhLmN0cmxLZXl8fGEubWV0YUtleSlkLmRhdGVwaWNrZXIuX2FkanVzdERhdGUoYS50YXJnZXQsZT8tMTorMSxcIkRcIik7Yz1hLmN0cmxLZXl8fGEubWV0YUtleTtpZihhLm9yaWdpbmFsRXZlbnQuYWx0S2V5KWQuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZShhLnRhcmdldCxhLmN0cmxLZXk/K2QuZGF0ZXBpY2tlci5fZ2V0KGIsXCJzdGVwQmlnTW9udGhzXCIpOitkLmRhdGVwaWNrZXIuX2dldChiLFwic3RlcE1vbnRoc1wiKSxcIk1cIik7YnJlYWs7Y2FzZSA0MDppZihhLmN0cmxLZXl8fGEubWV0YUtleSlkLmRhdGVwaWNrZXIuX2FkanVzdERhdGUoYS50YXJnZXQsXG4rNyxcIkRcIik7Yz1hLmN0cmxLZXl8fGEubWV0YUtleTticmVhaztkZWZhdWx0OmM9ZmFsc2V9ZWxzZSBpZihhLmtleUNvZGU9PTM2JiZhLmN0cmxLZXkpZC5kYXRlcGlja2VyLl9zaG93RGF0ZXBpY2tlcih0aGlzKTtlbHNlIGM9ZmFsc2U7aWYoYyl7YS5wcmV2ZW50RGVmYXVsdCgpO2Euc3RvcFByb3BhZ2F0aW9uKCl9fSxfZG9LZXlQcmVzczpmdW5jdGlvbihhKXt2YXIgYj1kLmRhdGVwaWNrZXIuX2dldEluc3QoYS50YXJnZXQpO2lmKGQuZGF0ZXBpY2tlci5fZ2V0KGIsXCJjb25zdHJhaW5JbnB1dFwiKSl7Yj1kLmRhdGVwaWNrZXIuX3Bvc3NpYmxlQ2hhcnMoZC5kYXRlcGlja2VyLl9nZXQoYixcImRhdGVGb3JtYXRcIikpO3ZhciBjPVN0cmluZy5mcm9tQ2hhckNvZGUoYS5jaGFyQ29kZT09QT9hLmtleUNvZGU6YS5jaGFyQ29kZSk7cmV0dXJuIGEuY3RybEtleXx8YS5tZXRhS2V5fHxjPFwiIFwifHwhYnx8Yi5pbmRleE9mKGMpPi0xfX0sX2RvS2V5VXA6ZnVuY3Rpb24oYSl7YT1kLmRhdGVwaWNrZXIuX2dldEluc3QoYS50YXJnZXQpO1xuaWYoYS5pbnB1dC52YWwoKSE9YS5sYXN0VmFsKXRyeXtpZihkLmRhdGVwaWNrZXIucGFyc2VEYXRlKGQuZGF0ZXBpY2tlci5fZ2V0KGEsXCJkYXRlRm9ybWF0XCIpLGEuaW5wdXQ/YS5pbnB1dC52YWwoKTpudWxsLGQuZGF0ZXBpY2tlci5fZ2V0Rm9ybWF0Q29uZmlnKGEpKSl7ZC5kYXRlcGlja2VyLl9zZXREYXRlRnJvbUZpZWxkKGEpO2QuZGF0ZXBpY2tlci5fdXBkYXRlQWx0ZXJuYXRlKGEpO2QuZGF0ZXBpY2tlci5fdXBkYXRlRGF0ZXBpY2tlcihhKX19Y2F0Y2goYil7ZC5kYXRlcGlja2VyLmxvZyhiKX1yZXR1cm4gdHJ1ZX0sX3Nob3dEYXRlcGlja2VyOmZ1bmN0aW9uKGEpe2E9YS50YXJnZXR8fGE7aWYoYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIT1cImlucHV0XCIpYT1kKFwiaW5wdXRcIixhLnBhcmVudE5vZGUpWzBdO2lmKCEoZC5kYXRlcGlja2VyLl9pc0Rpc2FibGVkRGF0ZXBpY2tlcihhKXx8ZC5kYXRlcGlja2VyLl9sYXN0SW5wdXQ9PWEpKXt2YXIgYj1kLmRhdGVwaWNrZXIuX2dldEluc3QoYSk7XG5kLmRhdGVwaWNrZXIuX2N1ckluc3QmJmQuZGF0ZXBpY2tlci5fY3VySW5zdCE9YiYmZC5kYXRlcGlja2VyLl9jdXJJbnN0LmRwRGl2LnN0b3AodHJ1ZSx0cnVlKTt2YXIgYz1kLmRhdGVwaWNrZXIuX2dldChiLFwiYmVmb3JlU2hvd1wiKTtGKGIuc2V0dGluZ3MsYz9jLmFwcGx5KGEsW2EsYl0pOnt9KTtiLmxhc3RWYWw9bnVsbDtkLmRhdGVwaWNrZXIuX2xhc3RJbnB1dD1hO2QuZGF0ZXBpY2tlci5fc2V0RGF0ZUZyb21GaWVsZChiKTtpZihkLmRhdGVwaWNrZXIuX2luRGlhbG9nKWEudmFsdWU9XCJcIjtpZighZC5kYXRlcGlja2VyLl9wb3Mpe2QuZGF0ZXBpY2tlci5fcG9zPWQuZGF0ZXBpY2tlci5fZmluZFBvcyhhKTtkLmRhdGVwaWNrZXIuX3Bvc1sxXSs9YS5vZmZzZXRIZWlnaHR9dmFyIGU9ZmFsc2U7ZChhKS5wYXJlbnRzKCkuZWFjaChmdW5jdGlvbigpe2V8PWQodGhpcykuY3NzKFwicG9zaXRpb25cIik9PVwiZml4ZWRcIjtyZXR1cm4hZX0pO2lmKGUmJmQuYnJvd3Nlci5vcGVyYSl7ZC5kYXRlcGlja2VyLl9wb3NbMF0tPVxuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQ7ZC5kYXRlcGlja2VyLl9wb3NbMV0tPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3B9Yz17bGVmdDpkLmRhdGVwaWNrZXIuX3Bvc1swXSx0b3A6ZC5kYXRlcGlja2VyLl9wb3NbMV19O2QuZGF0ZXBpY2tlci5fcG9zPW51bGw7Yi5kcERpdi5lbXB0eSgpO2IuZHBEaXYuY3NzKHtwb3NpdGlvbjpcImFic29sdXRlXCIsZGlzcGxheTpcImJsb2NrXCIsdG9wOlwiLTEwMDBweFwifSk7ZC5kYXRlcGlja2VyLl91cGRhdGVEYXRlcGlja2VyKGIpO2M9ZC5kYXRlcGlja2VyLl9jaGVja09mZnNldChiLGMsZSk7Yi5kcERpdi5jc3Moe3Bvc2l0aW9uOmQuZGF0ZXBpY2tlci5faW5EaWFsb2cmJmQuYmxvY2tVST9cInN0YXRpY1wiOmU/XCJmaXhlZFwiOlwiYWJzb2x1dGVcIixkaXNwbGF5Olwibm9uZVwiLGxlZnQ6Yy5sZWZ0K1wicHhcIix0b3A6Yy50b3ArXCJweFwifSk7aWYoIWIuaW5saW5lKXtjPWQuZGF0ZXBpY2tlci5fZ2V0KGIsXCJzaG93QW5pbVwiKTtcbnZhciBmPWQuZGF0ZXBpY2tlci5fZ2V0KGIsXCJkdXJhdGlvblwiKSxoPWZ1bmN0aW9uKCl7ZC5kYXRlcGlja2VyLl9kYXRlcGlja2VyU2hvd2luZz10cnVlO3ZhciBpPWIuZHBEaXYuZmluZChcImlmcmFtZS51aS1kYXRlcGlja2VyLWNvdmVyXCIpO2lmKGkubGVuZ3RoKXt2YXIgZz1kLmRhdGVwaWNrZXIuX2dldEJvcmRlcnMoYi5kcERpdik7aS5jc3Moe2xlZnQ6LWdbMF0sdG9wOi1nWzFdLHdpZHRoOmIuZHBEaXYub3V0ZXJXaWR0aCgpLGhlaWdodDpiLmRwRGl2Lm91dGVySGVpZ2h0KCl9KX19O2IuZHBEaXYuekluZGV4KGQoYSkuekluZGV4KCkrMSk7ZC5lZmZlY3RzJiZkLmVmZmVjdHNbY10/Yi5kcERpdi5zaG93KGMsZC5kYXRlcGlja2VyLl9nZXQoYixcInNob3dPcHRpb25zXCIpLGYsaCk6Yi5kcERpdltjfHxcInNob3dcIl0oYz9mOm51bGwsaCk7aWYoIWN8fCFmKWgoKTtiLmlucHV0LmlzKFwiOnZpc2libGVcIikmJiFiLmlucHV0LmlzKFwiOmRpc2FibGVkXCIpJiZiLmlucHV0LmZvY3VzKCk7ZC5kYXRlcGlja2VyLl9jdXJJbnN0PVxuYn19fSxfdXBkYXRlRGF0ZXBpY2tlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGM9ZC5kYXRlcGlja2VyLl9nZXRCb3JkZXJzKGEuZHBEaXYpO2EuZHBEaXYuZW1wdHkoKS5hcHBlbmQodGhpcy5fZ2VuZXJhdGVIVE1MKGEpKTt2YXIgZT1hLmRwRGl2LmZpbmQoXCJpZnJhbWUudWktZGF0ZXBpY2tlci1jb3ZlclwiKTtlLmxlbmd0aCYmZS5jc3Moe2xlZnQ6LWNbMF0sdG9wOi1jWzFdLHdpZHRoOmEuZHBEaXYub3V0ZXJXaWR0aCgpLGhlaWdodDphLmRwRGl2Lm91dGVySGVpZ2h0KCl9KTthLmRwRGl2LmZpbmQoXCJidXR0b24sIC51aS1kYXRlcGlja2VyLXByZXYsIC51aS1kYXRlcGlja2VyLW5leHQsIC51aS1kYXRlcGlja2VyLWNhbGVuZGFyIHRkIGFcIikuYmluZChcIm1vdXNlb3V0XCIsZnVuY3Rpb24oKXtkKHRoaXMpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7dGhpcy5jbGFzc05hbWUuaW5kZXhPZihcInVpLWRhdGVwaWNrZXItcHJldlwiKSE9LTEmJmQodGhpcykucmVtb3ZlQ2xhc3MoXCJ1aS1kYXRlcGlja2VyLXByZXYtaG92ZXJcIik7XG50aGlzLmNsYXNzTmFtZS5pbmRleE9mKFwidWktZGF0ZXBpY2tlci1uZXh0XCIpIT0tMSYmZCh0aGlzKS5yZW1vdmVDbGFzcyhcInVpLWRhdGVwaWNrZXItbmV4dC1ob3ZlclwiKX0pLmJpbmQoXCJtb3VzZW92ZXJcIixmdW5jdGlvbigpe2lmKCFiLl9pc0Rpc2FibGVkRGF0ZXBpY2tlcihhLmlubGluZT9hLmRwRGl2LnBhcmVudCgpWzBdOmEuaW5wdXRbMF0pKXtkKHRoaXMpLnBhcmVudHMoXCIudWktZGF0ZXBpY2tlci1jYWxlbmRhclwiKS5maW5kKFwiYVwiKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpO2QodGhpcykuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1ob3ZlclwiKTt0aGlzLmNsYXNzTmFtZS5pbmRleE9mKFwidWktZGF0ZXBpY2tlci1wcmV2XCIpIT0tMSYmZCh0aGlzKS5hZGRDbGFzcyhcInVpLWRhdGVwaWNrZXItcHJldi1ob3ZlclwiKTt0aGlzLmNsYXNzTmFtZS5pbmRleE9mKFwidWktZGF0ZXBpY2tlci1uZXh0XCIpIT0tMSYmZCh0aGlzKS5hZGRDbGFzcyhcInVpLWRhdGVwaWNrZXItbmV4dC1ob3ZlclwiKX19KS5lbmQoKS5maW5kKFwiLlwiK1xudGhpcy5fZGF5T3ZlckNsYXNzK1wiIGFcIikudHJpZ2dlcihcIm1vdXNlb3ZlclwiKS5lbmQoKTtjPXRoaXMuX2dldE51bWJlck9mTW9udGhzKGEpO2U9Y1sxXTtlPjE/YS5kcERpdi5hZGRDbGFzcyhcInVpLWRhdGVwaWNrZXItbXVsdGktXCIrZSkuY3NzKFwid2lkdGhcIiwxNyplK1wiZW1cIik6YS5kcERpdi5yZW1vdmVDbGFzcyhcInVpLWRhdGVwaWNrZXItbXVsdGktMiB1aS1kYXRlcGlja2VyLW11bHRpLTMgdWktZGF0ZXBpY2tlci1tdWx0aS00XCIpLndpZHRoKFwiXCIpO2EuZHBEaXZbKGNbMF0hPTF8fGNbMV0hPTE/XCJhZGRcIjpcInJlbW92ZVwiKStcIkNsYXNzXCJdKFwidWktZGF0ZXBpY2tlci1tdWx0aVwiKTthLmRwRGl2Wyh0aGlzLl9nZXQoYSxcImlzUlRMXCIpP1wiYWRkXCI6XCJyZW1vdmVcIikrXCJDbGFzc1wiXShcInVpLWRhdGVwaWNrZXItcnRsXCIpO2E9PWQuZGF0ZXBpY2tlci5fY3VySW5zdCYmZC5kYXRlcGlja2VyLl9kYXRlcGlja2VyU2hvd2luZyYmYS5pbnB1dCYmYS5pbnB1dC5pcyhcIjp2aXNpYmxlXCIpJiYhYS5pbnB1dC5pcyhcIjpkaXNhYmxlZFwiKSYmXG5hLmlucHV0WzBdIT1kb2N1bWVudC5hY3RpdmVFbGVtZW50JiZhLmlucHV0LmZvY3VzKCk7aWYoYS55ZWFyc2h0bWwpe3ZhciBmPWEueWVhcnNodG1sO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtmPT09YS55ZWFyc2h0bWwmJmEuZHBEaXYuZmluZChcInNlbGVjdC51aS1kYXRlcGlja2VyLXllYXI6Zmlyc3RcIikucmVwbGFjZVdpdGgoYS55ZWFyc2h0bWwpO2Y9YS55ZWFyc2h0bWw9bnVsbH0sMCl9fSxfZ2V0Qm9yZGVyczpmdW5jdGlvbihhKXt2YXIgYj1mdW5jdGlvbihjKXtyZXR1cm57dGhpbjoxLG1lZGl1bToyLHRoaWNrOjN9W2NdfHxjfTtyZXR1cm5bcGFyc2VGbG9hdChiKGEuY3NzKFwiYm9yZGVyLWxlZnQtd2lkdGhcIikpKSxwYXJzZUZsb2F0KGIoYS5jc3MoXCJib3JkZXItdG9wLXdpZHRoXCIpKSldfSxfY2hlY2tPZmZzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBlPWEuZHBEaXYub3V0ZXJXaWR0aCgpLGY9YS5kcERpdi5vdXRlckhlaWdodCgpLGg9YS5pbnB1dD9hLmlucHV0Lm91dGVyV2lkdGgoKTpcbjAsaT1hLmlucHV0P2EuaW5wdXQub3V0ZXJIZWlnaHQoKTowLGc9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoK2QoZG9jdW1lbnQpLnNjcm9sbExlZnQoKSxqPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQrZChkb2N1bWVudCkuc2Nyb2xsVG9wKCk7Yi5sZWZ0LT10aGlzLl9nZXQoYSxcImlzUlRMXCIpP2UtaDowO2IubGVmdC09YyYmYi5sZWZ0PT1hLmlucHV0Lm9mZnNldCgpLmxlZnQ/ZChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpOjA7Yi50b3AtPWMmJmIudG9wPT1hLmlucHV0Lm9mZnNldCgpLnRvcCtpP2QoZG9jdW1lbnQpLnNjcm9sbFRvcCgpOjA7Yi5sZWZ0LT1NYXRoLm1pbihiLmxlZnQsYi5sZWZ0K2U+ZyYmZz5lP01hdGguYWJzKGIubGVmdCtlLWcpOjApO2IudG9wLT1NYXRoLm1pbihiLnRvcCxiLnRvcCtmPmomJmo+Zj9NYXRoLmFicyhmK2kpOjApO3JldHVybiBifSxfZmluZFBvczpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5fZ2V0KHRoaXMuX2dldEluc3QoYSksXG5cImlzUlRMXCIpO2EmJihhLnR5cGU9PVwiaGlkZGVuXCJ8fGEubm9kZVR5cGUhPTF8fGQuZXhwci5maWx0ZXJzLmhpZGRlbihhKSk7KWE9YVtiP1wicHJldmlvdXNTaWJsaW5nXCI6XCJuZXh0U2libGluZ1wiXTthPWQoYSkub2Zmc2V0KCk7cmV0dXJuW2EubGVmdCxhLnRvcF19LF9oaWRlRGF0ZXBpY2tlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLl9jdXJJbnN0O2lmKCEoIWJ8fGEmJmIhPWQuZGF0YShhLFwiZGF0ZXBpY2tlclwiKSkpaWYodGhpcy5fZGF0ZXBpY2tlclNob3dpbmcpe2E9dGhpcy5fZ2V0KGIsXCJzaG93QW5pbVwiKTt2YXIgYz10aGlzLl9nZXQoYixcImR1cmF0aW9uXCIpLGU9ZnVuY3Rpb24oKXtkLmRhdGVwaWNrZXIuX3RpZHlEaWFsb2coYik7dGhpcy5fY3VySW5zdD1udWxsfTtkLmVmZmVjdHMmJmQuZWZmZWN0c1thXT9iLmRwRGl2LmhpZGUoYSxkLmRhdGVwaWNrZXIuX2dldChiLFwic2hvd09wdGlvbnNcIiksYyxlKTpiLmRwRGl2W2E9PVwic2xpZGVEb3duXCI/XCJzbGlkZVVwXCI6YT09XCJmYWRlSW5cIj9cblwiZmFkZU91dFwiOlwiaGlkZVwiXShhP2M6bnVsbCxlKTthfHxlKCk7aWYoYT10aGlzLl9nZXQoYixcIm9uQ2xvc2VcIikpYS5hcHBseShiLmlucHV0P2IuaW5wdXRbMF06bnVsbCxbYi5pbnB1dD9iLmlucHV0LnZhbCgpOlwiXCIsYl0pO3RoaXMuX2RhdGVwaWNrZXJTaG93aW5nPWZhbHNlO3RoaXMuX2xhc3RJbnB1dD1udWxsO2lmKHRoaXMuX2luRGlhbG9nKXt0aGlzLl9kaWFsb2dJbnB1dC5jc3Moe3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixsZWZ0OlwiMFwiLHRvcDpcIi0xMDBweFwifSk7aWYoZC5ibG9ja1VJKXtkLnVuYmxvY2tVSSgpO2QoXCJib2R5XCIpLmFwcGVuZCh0aGlzLmRwRGl2KX19dGhpcy5faW5EaWFsb2c9ZmFsc2V9fSxfdGlkeURpYWxvZzpmdW5jdGlvbihhKXthLmRwRGl2LnJlbW92ZUNsYXNzKHRoaXMuX2RpYWxvZ0NsYXNzKS51bmJpbmQoXCIudWktZGF0ZXBpY2tlci1jYWxlbmRhclwiKX0sX2NoZWNrRXh0ZXJuYWxDbGljazpmdW5jdGlvbihhKXtpZihkLmRhdGVwaWNrZXIuX2N1ckluc3Qpe2E9XG5kKGEudGFyZ2V0KTthWzBdLmlkIT1kLmRhdGVwaWNrZXIuX21haW5EaXZJZCYmYS5wYXJlbnRzKFwiI1wiK2QuZGF0ZXBpY2tlci5fbWFpbkRpdklkKS5sZW5ndGg9PTAmJiFhLmhhc0NsYXNzKGQuZGF0ZXBpY2tlci5tYXJrZXJDbGFzc05hbWUpJiYhYS5oYXNDbGFzcyhkLmRhdGVwaWNrZXIuX3RyaWdnZXJDbGFzcykmJmQuZGF0ZXBpY2tlci5fZGF0ZXBpY2tlclNob3dpbmcmJiEoZC5kYXRlcGlja2VyLl9pbkRpYWxvZyYmZC5ibG9ja1VJKSYmZC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpfX0sX2FkanVzdERhdGU6ZnVuY3Rpb24oYSxiLGMpe2E9ZChhKTt2YXIgZT10aGlzLl9nZXRJbnN0KGFbMF0pO2lmKCF0aGlzLl9pc0Rpc2FibGVkRGF0ZXBpY2tlcihhWzBdKSl7dGhpcy5fYWRqdXN0SW5zdERhdGUoZSxiKyhjPT1cIk1cIj90aGlzLl9nZXQoZSxcInNob3dDdXJyZW50QXRQb3NcIik6MCksYyk7dGhpcy5fdXBkYXRlRGF0ZXBpY2tlcihlKX19LF9nb3RvVG9kYXk6ZnVuY3Rpb24oYSl7YT1cbmQoYSk7dmFyIGI9dGhpcy5fZ2V0SW5zdChhWzBdKTtpZih0aGlzLl9nZXQoYixcImdvdG9DdXJyZW50XCIpJiZiLmN1cnJlbnREYXkpe2Iuc2VsZWN0ZWREYXk9Yi5jdXJyZW50RGF5O2IuZHJhd01vbnRoPWIuc2VsZWN0ZWRNb250aD1iLmN1cnJlbnRNb250aDtiLmRyYXdZZWFyPWIuc2VsZWN0ZWRZZWFyPWIuY3VycmVudFllYXJ9ZWxzZXt2YXIgYz1uZXcgRGF0ZTtiLnNlbGVjdGVkRGF5PWMuZ2V0RGF0ZSgpO2IuZHJhd01vbnRoPWIuc2VsZWN0ZWRNb250aD1jLmdldE1vbnRoKCk7Yi5kcmF3WWVhcj1iLnNlbGVjdGVkWWVhcj1jLmdldEZ1bGxZZWFyKCl9dGhpcy5fbm90aWZ5Q2hhbmdlKGIpO3RoaXMuX2FkanVzdERhdGUoYSl9LF9zZWxlY3RNb250aFllYXI6ZnVuY3Rpb24oYSxiLGMpe2E9ZChhKTt2YXIgZT10aGlzLl9nZXRJbnN0KGFbMF0pO2UuX3NlbGVjdGluZ01vbnRoWWVhcj1mYWxzZTtlW1wic2VsZWN0ZWRcIisoYz09XCJNXCI/XCJNb250aFwiOlwiWWVhclwiKV09ZVtcImRyYXdcIisoYz09XG5cIk1cIj9cIk1vbnRoXCI6XCJZZWFyXCIpXT1wYXJzZUludChiLm9wdGlvbnNbYi5zZWxlY3RlZEluZGV4XS52YWx1ZSwxMCk7dGhpcy5fbm90aWZ5Q2hhbmdlKGUpO3RoaXMuX2FkanVzdERhdGUoYSl9LF9jbGlja01vbnRoWWVhcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLl9nZXRJbnN0KGQoYSlbMF0pO2IuaW5wdXQmJmIuX3NlbGVjdGluZ01vbnRoWWVhciYmc2V0VGltZW91dChmdW5jdGlvbigpe2IuaW5wdXQuZm9jdXMoKX0sMCk7Yi5fc2VsZWN0aW5nTW9udGhZZWFyPSFiLl9zZWxlY3RpbmdNb250aFllYXJ9LF9zZWxlY3REYXk6ZnVuY3Rpb24oYSxiLGMsZSl7dmFyIGY9ZChhKTtpZighKGQoZSkuaGFzQ2xhc3ModGhpcy5fdW5zZWxlY3RhYmxlQ2xhc3MpfHx0aGlzLl9pc0Rpc2FibGVkRGF0ZXBpY2tlcihmWzBdKSkpe2Y9dGhpcy5fZ2V0SW5zdChmWzBdKTtmLnNlbGVjdGVkRGF5PWYuY3VycmVudERheT1kKFwiYVwiLGUpLmh0bWwoKTtmLnNlbGVjdGVkTW9udGg9Zi5jdXJyZW50TW9udGg9XG5iO2Yuc2VsZWN0ZWRZZWFyPWYuY3VycmVudFllYXI9Yzt0aGlzLl9zZWxlY3REYXRlKGEsdGhpcy5fZm9ybWF0RGF0ZShmLGYuY3VycmVudERheSxmLmN1cnJlbnRNb250aCxmLmN1cnJlbnRZZWFyKSl9fSxfY2xlYXJEYXRlOmZ1bmN0aW9uKGEpe2E9ZChhKTt0aGlzLl9nZXRJbnN0KGFbMF0pO3RoaXMuX3NlbGVjdERhdGUoYSxcIlwiKX0sX3NlbGVjdERhdGU6ZnVuY3Rpb24oYSxiKXthPXRoaXMuX2dldEluc3QoZChhKVswXSk7Yj1iIT1udWxsP2I6dGhpcy5fZm9ybWF0RGF0ZShhKTthLmlucHV0JiZhLmlucHV0LnZhbChiKTt0aGlzLl91cGRhdGVBbHRlcm5hdGUoYSk7dmFyIGM9dGhpcy5fZ2V0KGEsXCJvblNlbGVjdFwiKTtpZihjKWMuYXBwbHkoYS5pbnB1dD9hLmlucHV0WzBdOm51bGwsW2IsYV0pO2Vsc2UgYS5pbnB1dCYmYS5pbnB1dC50cmlnZ2VyKFwiY2hhbmdlXCIpO2lmKGEuaW5saW5lKXRoaXMuX3VwZGF0ZURhdGVwaWNrZXIoYSk7ZWxzZXt0aGlzLl9oaWRlRGF0ZXBpY2tlcigpO1xudGhpcy5fbGFzdElucHV0PWEuaW5wdXRbMF07dHlwZW9mIGEuaW5wdXRbMF0hPVwib2JqZWN0XCImJmEuaW5wdXQuZm9jdXMoKTt0aGlzLl9sYXN0SW5wdXQ9bnVsbH19LF91cGRhdGVBbHRlcm5hdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5fZ2V0KGEsXCJhbHRGaWVsZFwiKTtpZihiKXt2YXIgYz10aGlzLl9nZXQoYSxcImFsdEZvcm1hdFwiKXx8dGhpcy5fZ2V0KGEsXCJkYXRlRm9ybWF0XCIpLGU9dGhpcy5fZ2V0RGF0ZShhKSxmPXRoaXMuZm9ybWF0RGF0ZShjLGUsdGhpcy5fZ2V0Rm9ybWF0Q29uZmlnKGEpKTtkKGIpLmVhY2goZnVuY3Rpb24oKXtkKHRoaXMpLnZhbChmKX0pfX0sbm9XZWVrZW5kczpmdW5jdGlvbihhKXthPWEuZ2V0RGF5KCk7cmV0dXJuW2E+MCYmYTw2LFwiXCJdfSxpc284NjAxV2VlazpmdW5jdGlvbihhKXthPW5ldyBEYXRlKGEuZ2V0VGltZSgpKTthLnNldERhdGUoYS5nZXREYXRlKCkrNC0oYS5nZXREYXkoKXx8NykpO3ZhciBiPWEuZ2V0VGltZSgpO2Euc2V0TW9udGgoMCk7XG5hLnNldERhdGUoMSk7cmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yb3VuZCgoYi1hKS84NjRFNSkvNykrMX0scGFyc2VEYXRlOmZ1bmN0aW9uKGEsYixjKXtpZihhPT1udWxsfHxiPT1udWxsKXRocm93XCJJbnZhbGlkIGFyZ3VtZW50c1wiO2I9dHlwZW9mIGI9PVwib2JqZWN0XCI/Yi50b1N0cmluZygpOmIrXCJcIjtpZihiPT1cIlwiKXJldHVybiBudWxsO3ZhciBlPShjP2Muc2hvcnRZZWFyQ3V0b2ZmOm51bGwpfHx0aGlzLl9kZWZhdWx0cy5zaG9ydFllYXJDdXRvZmY7ZT10eXBlb2YgZSE9XCJzdHJpbmdcIj9lOihuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKSUxMDArcGFyc2VJbnQoZSwxMCk7Zm9yKHZhciBmPShjP2MuZGF5TmFtZXNTaG9ydDpudWxsKXx8dGhpcy5fZGVmYXVsdHMuZGF5TmFtZXNTaG9ydCxoPShjP2MuZGF5TmFtZXM6bnVsbCl8fHRoaXMuX2RlZmF1bHRzLmRheU5hbWVzLGk9KGM/Yy5tb250aE5hbWVzU2hvcnQ6bnVsbCl8fHRoaXMuX2RlZmF1bHRzLm1vbnRoTmFtZXNTaG9ydCxnPShjP1xuYy5tb250aE5hbWVzOm51bGwpfHx0aGlzLl9kZWZhdWx0cy5tb250aE5hbWVzLGo9Yz0tMSxsPS0xLHU9LTEsaz1mYWxzZSxvPWZ1bmN0aW9uKHApeyhwPXorMTxhLmxlbmd0aCYmYS5jaGFyQXQoeisxKT09cCkmJnorKztyZXR1cm4gcH0sbT1mdW5jdGlvbihwKXt2YXIgdj1vKHApO3A9bmV3IFJlZ0V4cChcIl5cXFxcZHsxLFwiKyhwPT1cIkBcIj8xNDpwPT1cIiFcIj8yMDpwPT1cInlcIiYmdj80OnA9PVwib1wiPzM6MikrXCJ9XCIpO3A9Yi5zdWJzdHJpbmcocykubWF0Y2gocCk7aWYoIXApdGhyb3dcIk1pc3NpbmcgbnVtYmVyIGF0IHBvc2l0aW9uIFwiK3M7cys9cFswXS5sZW5ndGg7cmV0dXJuIHBhcnNlSW50KHBbMF0sMTApfSxuPWZ1bmN0aW9uKHAsdixIKXtwPW8ocCk/SDp2O2Zvcih2PTA7djxwLmxlbmd0aDt2KyspaWYoYi5zdWJzdHIocyxwW3ZdLmxlbmd0aCkudG9Mb3dlckNhc2UoKT09cFt2XS50b0xvd2VyQ2FzZSgpKXtzKz1wW3ZdLmxlbmd0aDtyZXR1cm4gdisxfXRocm93XCJVbmtub3duIG5hbWUgYXQgcG9zaXRpb24gXCIrXG5zO30scj1mdW5jdGlvbigpe2lmKGIuY2hhckF0KHMpIT1hLmNoYXJBdCh6KSl0aHJvd1wiVW5leHBlY3RlZCBsaXRlcmFsIGF0IHBvc2l0aW9uIFwiK3M7cysrfSxzPTAsej0wO3o8YS5sZW5ndGg7eisrKWlmKGspaWYoYS5jaGFyQXQoeik9PVwiJ1wiJiYhbyhcIidcIikpaz1mYWxzZTtlbHNlIHIoKTtlbHNlIHN3aXRjaChhLmNoYXJBdCh6KSl7Y2FzZSBcImRcIjpsPW0oXCJkXCIpO2JyZWFrO2Nhc2UgXCJEXCI6bihcIkRcIixmLGgpO2JyZWFrO2Nhc2UgXCJvXCI6dT1tKFwib1wiKTticmVhaztjYXNlIFwibVwiOmo9bShcIm1cIik7YnJlYWs7Y2FzZSBcIk1cIjpqPW4oXCJNXCIsaSxnKTticmVhaztjYXNlIFwieVwiOmM9bShcInlcIik7YnJlYWs7Y2FzZSBcIkBcIjp2YXIgdz1uZXcgRGF0ZShtKFwiQFwiKSk7Yz13LmdldEZ1bGxZZWFyKCk7aj13LmdldE1vbnRoKCkrMTtsPXcuZ2V0RGF0ZSgpO2JyZWFrO2Nhc2UgXCIhXCI6dz1uZXcgRGF0ZSgobShcIiFcIiktdGhpcy5fdGlja3NUbzE5NzApLzFFNCk7Yz13LmdldEZ1bGxZZWFyKCk7aj13LmdldE1vbnRoKCkrXG4xO2w9dy5nZXREYXRlKCk7YnJlYWs7Y2FzZSBcIidcIjppZihvKFwiJ1wiKSlyKCk7ZWxzZSBrPXRydWU7YnJlYWs7ZGVmYXVsdDpyKCl9aWYoYz09LTEpYz0obmV3IERhdGUpLmdldEZ1bGxZZWFyKCk7ZWxzZSBpZihjPDEwMCljKz0obmV3IERhdGUpLmdldEZ1bGxZZWFyKCktKG5ldyBEYXRlKS5nZXRGdWxsWWVhcigpJTEwMCsoYzw9ZT8wOi0xMDApO2lmKHU+LTEpe2o9MTtsPXU7ZG97ZT10aGlzLl9nZXREYXlzSW5Nb250aChjLGotMSk7aWYobDw9ZSlicmVhaztqKys7bC09ZX13aGlsZSgxKX13PXRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKGMsai0xLGwpKTtpZih3LmdldEZ1bGxZZWFyKCkhPWN8fHcuZ2V0TW9udGgoKSsxIT1qfHx3LmdldERhdGUoKSE9bCl0aHJvd1wiSW52YWxpZCBkYXRlXCI7cmV0dXJuIHd9LEFUT006XCJ5eS1tbS1kZFwiLENPT0tJRTpcIkQsIGRkIE0geXlcIixJU09fODYwMTpcInl5LW1tLWRkXCIsUkZDXzgyMjpcIkQsIGQgTSB5XCIsUkZDXzg1MDpcIkRELCBkZC1NLXlcIixcblJGQ18xMDM2OlwiRCwgZCBNIHlcIixSRkNfMTEyMzpcIkQsIGQgTSB5eVwiLFJGQ18yODIyOlwiRCwgZCBNIHl5XCIsUlNTOlwiRCwgZCBNIHlcIixUSUNLUzpcIiFcIixUSU1FU1RBTVA6XCJAXCIsVzNDOlwieXktbW0tZGRcIixfdGlja3NUbzE5NzA6KDcxODY4NStNYXRoLmZsb29yKDQ5Mi41KS1NYXRoLmZsb29yKDE5LjcpK01hdGguZmxvb3IoNC45MjUpKSoyNCo2MCo2MCoxRTcsZm9ybWF0RGF0ZTpmdW5jdGlvbihhLGIsYyl7aWYoIWIpcmV0dXJuXCJcIjt2YXIgZT0oYz9jLmRheU5hbWVzU2hvcnQ6bnVsbCl8fHRoaXMuX2RlZmF1bHRzLmRheU5hbWVzU2hvcnQsZj0oYz9jLmRheU5hbWVzOm51bGwpfHx0aGlzLl9kZWZhdWx0cy5kYXlOYW1lcyxoPShjP2MubW9udGhOYW1lc1Nob3J0Om51bGwpfHx0aGlzLl9kZWZhdWx0cy5tb250aE5hbWVzU2hvcnQ7Yz0oYz9jLm1vbnRoTmFtZXM6bnVsbCl8fHRoaXMuX2RlZmF1bHRzLm1vbnRoTmFtZXM7dmFyIGk9ZnVuY3Rpb24obyl7KG89aysxPGEubGVuZ3RoJiZcbmEuY2hhckF0KGsrMSk9PW8pJiZrKys7cmV0dXJuIG99LGc9ZnVuY3Rpb24obyxtLG4pe209XCJcIittO2lmKGkobykpZm9yKDttLmxlbmd0aDxuOyltPVwiMFwiK207cmV0dXJuIG19LGo9ZnVuY3Rpb24obyxtLG4scil7cmV0dXJuIGkobyk/clttXTpuW21dfSxsPVwiXCIsdT1mYWxzZTtpZihiKWZvcih2YXIgaz0wO2s8YS5sZW5ndGg7aysrKWlmKHUpaWYoYS5jaGFyQXQoayk9PVwiJ1wiJiYhaShcIidcIikpdT1mYWxzZTtlbHNlIGwrPWEuY2hhckF0KGspO2Vsc2Ugc3dpdGNoKGEuY2hhckF0KGspKXtjYXNlIFwiZFwiOmwrPWcoXCJkXCIsYi5nZXREYXRlKCksMik7YnJlYWs7Y2FzZSBcIkRcIjpsKz1qKFwiRFwiLGIuZ2V0RGF5KCksZSxmKTticmVhaztjYXNlIFwib1wiOmwrPWcoXCJvXCIsKGIuZ2V0VGltZSgpLShuZXcgRGF0ZShiLmdldEZ1bGxZZWFyKCksMCwwKSkuZ2V0VGltZSgpKS84NjRFNSwzKTticmVhaztjYXNlIFwibVwiOmwrPWcoXCJtXCIsYi5nZXRNb250aCgpKzEsMik7YnJlYWs7Y2FzZSBcIk1cIjpsKz1qKFwiTVwiLFxuYi5nZXRNb250aCgpLGgsYyk7YnJlYWs7Y2FzZSBcInlcIjpsKz1pKFwieVwiKT9iLmdldEZ1bGxZZWFyKCk6KGIuZ2V0WWVhcigpJTEwMDwxMD9cIjBcIjpcIlwiKStiLmdldFllYXIoKSUxMDA7YnJlYWs7Y2FzZSBcIkBcIjpsKz1iLmdldFRpbWUoKTticmVhaztjYXNlIFwiIVwiOmwrPWIuZ2V0VGltZSgpKjFFNCt0aGlzLl90aWNrc1RvMTk3MDticmVhaztjYXNlIFwiJ1wiOmlmKGkoXCInXCIpKWwrPVwiJ1wiO2Vsc2UgdT10cnVlO2JyZWFrO2RlZmF1bHQ6bCs9YS5jaGFyQXQoayl9cmV0dXJuIGx9LF9wb3NzaWJsZUNoYXJzOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1cIlwiLGM9ZmFsc2UsZT1mdW5jdGlvbihoKXsoaD1mKzE8YS5sZW5ndGgmJmEuY2hhckF0KGYrMSk9PWgpJiZmKys7cmV0dXJuIGh9LGY9MDtmPGEubGVuZ3RoO2YrKylpZihjKWlmKGEuY2hhckF0KGYpPT1cIidcIiYmIWUoXCInXCIpKWM9ZmFsc2U7ZWxzZSBiKz1hLmNoYXJBdChmKTtlbHNlIHN3aXRjaChhLmNoYXJBdChmKSl7Y2FzZSBcImRcIjpjYXNlIFwibVwiOmNhc2UgXCJ5XCI6Y2FzZSBcIkBcIjpiKz1cblwiMDEyMzQ1Njc4OVwiO2JyZWFrO2Nhc2UgXCJEXCI6Y2FzZSBcIk1cIjpyZXR1cm4gbnVsbDtjYXNlIFwiJ1wiOmlmKGUoXCInXCIpKWIrPVwiJ1wiO2Vsc2UgYz10cnVlO2JyZWFrO2RlZmF1bHQ6Yis9YS5jaGFyQXQoZil9cmV0dXJuIGJ9LF9nZXQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5zZXR0aW5nc1tiXSE9PUE/YS5zZXR0aW5nc1tiXTp0aGlzLl9kZWZhdWx0c1tiXX0sX3NldERhdGVGcm9tRmllbGQ6ZnVuY3Rpb24oYSxiKXtpZihhLmlucHV0LnZhbCgpIT1hLmxhc3RWYWwpe3ZhciBjPXRoaXMuX2dldChhLFwiZGF0ZUZvcm1hdFwiKSxlPWEubGFzdFZhbD1hLmlucHV0P2EuaW5wdXQudmFsKCk6bnVsbCxmLGg7Zj1oPXRoaXMuX2dldERlZmF1bHREYXRlKGEpO3ZhciBpPXRoaXMuX2dldEZvcm1hdENvbmZpZyhhKTt0cnl7Zj10aGlzLnBhcnNlRGF0ZShjLGUsaSl8fGh9Y2F0Y2goZyl7dGhpcy5sb2coZyk7ZT1iP1wiXCI6ZX1hLnNlbGVjdGVkRGF5PWYuZ2V0RGF0ZSgpO2EuZHJhd01vbnRoPWEuc2VsZWN0ZWRNb250aD1cbmYuZ2V0TW9udGgoKTthLmRyYXdZZWFyPWEuc2VsZWN0ZWRZZWFyPWYuZ2V0RnVsbFllYXIoKTthLmN1cnJlbnREYXk9ZT9mLmdldERhdGUoKTowO2EuY3VycmVudE1vbnRoPWU/Zi5nZXRNb250aCgpOjA7YS5jdXJyZW50WWVhcj1lP2YuZ2V0RnVsbFllYXIoKTowO3RoaXMuX2FkanVzdEluc3REYXRlKGEpfX0sX2dldERlZmF1bHREYXRlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLl9yZXN0cmljdE1pbk1heChhLHRoaXMuX2RldGVybWluZURhdGUoYSx0aGlzLl9nZXQoYSxcImRlZmF1bHREYXRlXCIpLG5ldyBEYXRlKSl9LF9kZXRlcm1pbmVEYXRlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZT1mdW5jdGlvbihoKXt2YXIgaT1uZXcgRGF0ZTtpLnNldERhdGUoaS5nZXREYXRlKCkraCk7cmV0dXJuIGl9LGY9ZnVuY3Rpb24oaCl7dHJ5e3JldHVybiBkLmRhdGVwaWNrZXIucGFyc2VEYXRlKGQuZGF0ZXBpY2tlci5fZ2V0KGEsXCJkYXRlRm9ybWF0XCIpLGgsZC5kYXRlcGlja2VyLl9nZXRGb3JtYXRDb25maWcoYSkpfWNhdGNoKGkpe312YXIgZz1cbihoLnRvTG93ZXJDYXNlKCkubWF0Y2goL15jLyk/ZC5kYXRlcGlja2VyLl9nZXREYXRlKGEpOm51bGwpfHxuZXcgRGF0ZSxqPWcuZ2V0RnVsbFllYXIoKSxsPWcuZ2V0TW9udGgoKTtnPWcuZ2V0RGF0ZSgpO2Zvcih2YXIgdT0vKFsrLV0/WzAtOV0rKVxccyooZHxEfHd8V3xtfE18eXxZKT8vZyxrPXUuZXhlYyhoKTtrOyl7c3dpdGNoKGtbMl18fFwiZFwiKXtjYXNlIFwiZFwiOmNhc2UgXCJEXCI6Zys9cGFyc2VJbnQoa1sxXSwxMCk7YnJlYWs7Y2FzZSBcIndcIjpjYXNlIFwiV1wiOmcrPXBhcnNlSW50KGtbMV0sMTApKjc7YnJlYWs7Y2FzZSBcIm1cIjpjYXNlIFwiTVwiOmwrPXBhcnNlSW50KGtbMV0sMTApO2c9TWF0aC5taW4oZyxkLmRhdGVwaWNrZXIuX2dldERheXNJbk1vbnRoKGosbCkpO2JyZWFrO2Nhc2UgXCJ5XCI6Y2FzZSBcIllcIjpqKz1wYXJzZUludChrWzFdLDEwKTtnPU1hdGgubWluKGcsZC5kYXRlcGlja2VyLl9nZXREYXlzSW5Nb250aChqLGwpKTticmVha31rPXUuZXhlYyhoKX1yZXR1cm4gbmV3IERhdGUoaixcbmwsZyl9O2lmKGI9KGI9Yj09bnVsbHx8Yj09PVwiXCI/Yzp0eXBlb2YgYj09XCJzdHJpbmdcIj9mKGIpOnR5cGVvZiBiPT1cIm51bWJlclwiP2lzTmFOKGIpP2M6ZShiKTpuZXcgRGF0ZShiLmdldFRpbWUoKSkpJiZiLnRvU3RyaW5nKCk9PVwiSW52YWxpZCBEYXRlXCI/YzpiKXtiLnNldEhvdXJzKDApO2Iuc2V0TWludXRlcygwKTtiLnNldFNlY29uZHMoMCk7Yi5zZXRNaWxsaXNlY29uZHMoMCl9cmV0dXJuIHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KGIpfSxfZGF5bGlnaHRTYXZpbmdBZGp1c3Q6ZnVuY3Rpb24oYSl7aWYoIWEpcmV0dXJuIG51bGw7YS5zZXRIb3VycyhhLmdldEhvdXJzKCk+MTI/YS5nZXRIb3VycygpKzI6MCk7cmV0dXJuIGF9LF9zZXREYXRlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZT0hYixmPWEuc2VsZWN0ZWRNb250aCxoPWEuc2VsZWN0ZWRZZWFyO2I9dGhpcy5fcmVzdHJpY3RNaW5NYXgoYSx0aGlzLl9kZXRlcm1pbmVEYXRlKGEsYixuZXcgRGF0ZSkpO2Euc2VsZWN0ZWREYXk9XG5hLmN1cnJlbnREYXk9Yi5nZXREYXRlKCk7YS5kcmF3TW9udGg9YS5zZWxlY3RlZE1vbnRoPWEuY3VycmVudE1vbnRoPWIuZ2V0TW9udGgoKTthLmRyYXdZZWFyPWEuc2VsZWN0ZWRZZWFyPWEuY3VycmVudFllYXI9Yi5nZXRGdWxsWWVhcigpO2lmKChmIT1hLnNlbGVjdGVkTW9udGh8fGghPWEuc2VsZWN0ZWRZZWFyKSYmIWMpdGhpcy5fbm90aWZ5Q2hhbmdlKGEpO3RoaXMuX2FkanVzdEluc3REYXRlKGEpO2lmKGEuaW5wdXQpYS5pbnB1dC52YWwoZT9cIlwiOnRoaXMuX2Zvcm1hdERhdGUoYSkpfSxfZ2V0RGF0ZTpmdW5jdGlvbihhKXtyZXR1cm4hYS5jdXJyZW50WWVhcnx8YS5pbnB1dCYmYS5pbnB1dC52YWwoKT09XCJcIj9udWxsOnRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKGEuY3VycmVudFllYXIsYS5jdXJyZW50TW9udGgsYS5jdXJyZW50RGF5KSl9LF9nZW5lcmF0ZUhUTUw6ZnVuY3Rpb24oYSl7dmFyIGI9bmV3IERhdGU7Yj10aGlzLl9kYXlsaWdodFNhdmluZ0FkanVzdChuZXcgRGF0ZShiLmdldEZ1bGxZZWFyKCksXG5iLmdldE1vbnRoKCksYi5nZXREYXRlKCkpKTt2YXIgYz10aGlzLl9nZXQoYSxcImlzUlRMXCIpLGU9dGhpcy5fZ2V0KGEsXCJzaG93QnV0dG9uUGFuZWxcIiksZj10aGlzLl9nZXQoYSxcImhpZGVJZk5vUHJldk5leHRcIiksaD10aGlzLl9nZXQoYSxcIm5hdmlnYXRpb25Bc0RhdGVGb3JtYXRcIiksaT10aGlzLl9nZXROdW1iZXJPZk1vbnRocyhhKSxnPXRoaXMuX2dldChhLFwic2hvd0N1cnJlbnRBdFBvc1wiKSxqPXRoaXMuX2dldChhLFwic3RlcE1vbnRoc1wiKSxsPWlbMF0hPTF8fGlbMV0hPTEsdT10aGlzLl9kYXlsaWdodFNhdmluZ0FkanVzdCghYS5jdXJyZW50RGF5P25ldyBEYXRlKDk5OTksOSw5KTpuZXcgRGF0ZShhLmN1cnJlbnRZZWFyLGEuY3VycmVudE1vbnRoLGEuY3VycmVudERheSkpLGs9dGhpcy5fZ2V0TWluTWF4RGF0ZShhLFwibWluXCIpLG89dGhpcy5fZ2V0TWluTWF4RGF0ZShhLFwibWF4XCIpO2c9YS5kcmF3TW9udGgtZzt2YXIgbT1hLmRyYXdZZWFyO2lmKGc8MCl7Zys9MTI7bS0tfWlmKG8pe3ZhciBuPVxudGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUoby5nZXRGdWxsWWVhcigpLG8uZ2V0TW9udGgoKS1pWzBdKmlbMV0rMSxvLmdldERhdGUoKSkpO2ZvcihuPWsmJm48az9rOm47dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUobSxnLDEpKT5uOyl7Zy0tO2lmKGc8MCl7Zz0xMTttLS19fX1hLmRyYXdNb250aD1nO2EuZHJhd1llYXI9bTtuPXRoaXMuX2dldChhLFwicHJldlRleHRcIik7bj0haD9uOnRoaXMuZm9ybWF0RGF0ZShuLHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKG0sZy1qLDEpKSx0aGlzLl9nZXRGb3JtYXRDb25maWcoYSkpO249dGhpcy5fY2FuQWRqdXN0TW9udGgoYSwtMSxtLGcpPyc8YSBjbGFzcz1cInVpLWRhdGVwaWNrZXItcHJldiB1aS1jb3JuZXItYWxsXCIgb25jbGljaz1cIkRQX2pRdWVyeV8nK3krXCIuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZSgnI1wiK2EuaWQrXCInLCAtXCIraitcIiwgJ00nKTtcXFwiIHRpdGxlPVxcXCJcIituKydcIj48c3BhbiBjbGFzcz1cInVpLWljb24gdWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtJytcbihjP1wiZVwiOlwid1wiKSsnXCI+JytuK1wiPC9zcGFuPjwvYT5cIjpmP1wiXCI6JzxhIGNsYXNzPVwidWktZGF0ZXBpY2tlci1wcmV2IHVpLWNvcm5lci1hbGwgdWktc3RhdGUtZGlzYWJsZWRcIiB0aXRsZT1cIicrbisnXCI+PHNwYW4gY2xhc3M9XCJ1aS1pY29uIHVpLWljb24tY2lyY2xlLXRyaWFuZ2xlLScrKGM/XCJlXCI6XCJ3XCIpKydcIj4nK24rXCI8L3NwYW4+PC9hPlwiO3ZhciByPXRoaXMuX2dldChhLFwibmV4dFRleHRcIik7cj0haD9yOnRoaXMuZm9ybWF0RGF0ZShyLHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKG0sZytqLDEpKSx0aGlzLl9nZXRGb3JtYXRDb25maWcoYSkpO2Y9dGhpcy5fY2FuQWRqdXN0TW9udGgoYSwrMSxtLGcpPyc8YSBjbGFzcz1cInVpLWRhdGVwaWNrZXItbmV4dCB1aS1jb3JuZXItYWxsXCIgb25jbGljaz1cIkRQX2pRdWVyeV8nK3krXCIuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZSgnI1wiK2EuaWQrXCInLCArXCIraitcIiwgJ00nKTtcXFwiIHRpdGxlPVxcXCJcIityKydcIj48c3BhbiBjbGFzcz1cInVpLWljb24gdWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtJytcbihjP1wid1wiOlwiZVwiKSsnXCI+JytyK1wiPC9zcGFuPjwvYT5cIjpmP1wiXCI6JzxhIGNsYXNzPVwidWktZGF0ZXBpY2tlci1uZXh0IHVpLWNvcm5lci1hbGwgdWktc3RhdGUtZGlzYWJsZWRcIiB0aXRsZT1cIicrcisnXCI+PHNwYW4gY2xhc3M9XCJ1aS1pY29uIHVpLWljb24tY2lyY2xlLXRyaWFuZ2xlLScrKGM/XCJ3XCI6XCJlXCIpKydcIj4nK3IrXCI8L3NwYW4+PC9hPlwiO2o9dGhpcy5fZ2V0KGEsXCJjdXJyZW50VGV4dFwiKTtyPXRoaXMuX2dldChhLFwiZ290b0N1cnJlbnRcIikmJmEuY3VycmVudERheT91OmI7aj0haD9qOnRoaXMuZm9ybWF0RGF0ZShqLHIsdGhpcy5fZ2V0Rm9ybWF0Q29uZmlnKGEpKTtoPSFhLmlubGluZT8nPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJ1aS1kYXRlcGlja2VyLWNsb3NlIHVpLXN0YXRlLWRlZmF1bHQgdWktcHJpb3JpdHktcHJpbWFyeSB1aS1jb3JuZXItYWxsXCIgb25jbGljaz1cIkRQX2pRdWVyeV8nK3krJy5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpO1wiPicrdGhpcy5fZ2V0KGEsXG5cImNsb3NlVGV4dFwiKStcIjwvYnV0dG9uPlwiOlwiXCI7ZT1lPyc8ZGl2IGNsYXNzPVwidWktZGF0ZXBpY2tlci1idXR0b25wYW5lIHVpLXdpZGdldC1jb250ZW50XCI+JysoYz9oOlwiXCIpKyh0aGlzLl9pc0luUmFuZ2UoYSxyKT8nPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJ1aS1kYXRlcGlja2VyLWN1cnJlbnQgdWktc3RhdGUtZGVmYXVsdCB1aS1wcmlvcml0eS1zZWNvbmRhcnkgdWktY29ybmVyLWFsbFwiIG9uY2xpY2s9XCJEUF9qUXVlcnlfJyt5K1wiLmRhdGVwaWNrZXIuX2dvdG9Ub2RheSgnI1wiK2EuaWQrXCInKTtcXFwiPlwiK2orXCI8L2J1dHRvbj5cIjpcIlwiKSsoYz9cIlwiOmgpK1wiPC9kaXY+XCI6XCJcIjtoPXBhcnNlSW50KHRoaXMuX2dldChhLFwiZmlyc3REYXlcIiksMTApO2g9aXNOYU4oaCk/MDpoO2o9dGhpcy5fZ2V0KGEsXCJzaG93V2Vla1wiKTtyPXRoaXMuX2dldChhLFwiZGF5TmFtZXNcIik7dGhpcy5fZ2V0KGEsXCJkYXlOYW1lc1Nob3J0XCIpO3ZhciBzPXRoaXMuX2dldChhLFwiZGF5TmFtZXNNaW5cIiksej1cbnRoaXMuX2dldChhLFwibW9udGhOYW1lc1wiKSx3PXRoaXMuX2dldChhLFwibW9udGhOYW1lc1Nob3J0XCIpLHA9dGhpcy5fZ2V0KGEsXCJiZWZvcmVTaG93RGF5XCIpLHY9dGhpcy5fZ2V0KGEsXCJzaG93T3RoZXJNb250aHNcIiksSD10aGlzLl9nZXQoYSxcInNlbGVjdE90aGVyTW9udGhzXCIpO3RoaXMuX2dldChhLFwiY2FsY3VsYXRlV2Vla1wiKTtmb3IodmFyIEw9dGhpcy5fZ2V0RGVmYXVsdERhdGUoYSksST1cIlwiLEQ9MDtEPGlbMF07RCsrKXtmb3IodmFyIE09XCJcIixFPTA7RTxpWzFdO0UrKyl7dmFyIE49dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUobSxnLGEuc2VsZWN0ZWREYXkpKSx0PVwiIHVpLWNvcm5lci1hbGxcIix4PVwiXCI7aWYobCl7eCs9JzxkaXYgY2xhc3M9XCJ1aS1kYXRlcGlja2VyLWdyb3VwJztpZihpWzFdPjEpc3dpdGNoKEUpe2Nhc2UgMDp4Kz1cIiB1aS1kYXRlcGlja2VyLWdyb3VwLWZpcnN0XCI7dD1cIiB1aS1jb3JuZXItXCIrKGM/XCJyaWdodFwiOlwibGVmdFwiKTticmVhaztjYXNlIGlbMV0tXG4xOngrPVwiIHVpLWRhdGVwaWNrZXItZ3JvdXAtbGFzdFwiO3Q9XCIgdWktY29ybmVyLVwiKyhjP1wibGVmdFwiOlwicmlnaHRcIik7YnJlYWs7ZGVmYXVsdDp4Kz1cIiB1aS1kYXRlcGlja2VyLWdyb3VwLW1pZGRsZVwiO3Q9XCJcIjticmVha314Kz0nXCI+J314Kz0nPGRpdiBjbGFzcz1cInVpLWRhdGVwaWNrZXItaGVhZGVyIHVpLXdpZGdldC1oZWFkZXIgdWktaGVscGVyLWNsZWFyZml4Jyt0KydcIj4nKygvYWxsfGxlZnQvLnRlc3QodCkmJkQ9PTA/Yz9mOm46XCJcIikrKC9hbGx8cmlnaHQvLnRlc3QodCkmJkQ9PTA/Yz9uOmY6XCJcIikrdGhpcy5fZ2VuZXJhdGVNb250aFllYXJIZWFkZXIoYSxnLG0sayxvLEQ+MHx8RT4wLHosdykrJzwvZGl2Pjx0YWJsZSBjbGFzcz1cInVpLWRhdGVwaWNrZXItY2FsZW5kYXJcIj48dGhlYWQ+PHRyPic7dmFyIEI9aj8nPHRoIGNsYXNzPVwidWktZGF0ZXBpY2tlci13ZWVrLWNvbFwiPicrdGhpcy5fZ2V0KGEsXCJ3ZWVrSGVhZGVyXCIpK1wiPC90aD5cIjpcIlwiO2Zvcih0PTA7dDw3O3QrKyl7dmFyIHE9XG4odCtoKSU3O0IrPVwiPHRoXCIrKCh0K2grNiklNz49NT8nIGNsYXNzPVwidWktZGF0ZXBpY2tlci13ZWVrLWVuZFwiJzpcIlwiKSsnPjxzcGFuIHRpdGxlPVwiJytyW3FdKydcIj4nK3NbcV0rXCI8L3NwYW4+PC90aD5cIn14Kz1CK1wiPC90cj48L3RoZWFkPjx0Ym9keT5cIjtCPXRoaXMuX2dldERheXNJbk1vbnRoKG0sZyk7aWYobT09YS5zZWxlY3RlZFllYXImJmc9PWEuc2VsZWN0ZWRNb250aClhLnNlbGVjdGVkRGF5PU1hdGgubWluKGEuc2VsZWN0ZWREYXksQik7dD0odGhpcy5fZ2V0Rmlyc3REYXlPZk1vbnRoKG0sZyktaCs3KSU3O0I9bD82Ok1hdGguY2VpbCgodCtCKS83KTtxPXRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKG0sZywxLXQpKTtmb3IodmFyIE89MDtPPEI7TysrKXt4Kz1cIjx0cj5cIjt2YXIgUD0haj9cIlwiOic8dGQgY2xhc3M9XCJ1aS1kYXRlcGlja2VyLXdlZWstY29sXCI+Jyt0aGlzLl9nZXQoYSxcImNhbGN1bGF0ZVdlZWtcIikocSkrXCI8L3RkPlwiO2Zvcih0PTA7dDw3O3QrKyl7dmFyIEc9XG5wP3AuYXBwbHkoYS5pbnB1dD9hLmlucHV0WzBdOm51bGwsW3FdKTpbdHJ1ZSxcIlwiXSxDPXEuZ2V0TW9udGgoKSE9ZyxKPUMmJiFIfHwhR1swXXx8ayYmcTxrfHxvJiZxPm87UCs9Jzx0ZCBjbGFzcz1cIicrKCh0K2grNiklNz49NT9cIiB1aS1kYXRlcGlja2VyLXdlZWstZW5kXCI6XCJcIikrKEM/XCIgdWktZGF0ZXBpY2tlci1vdGhlci1tb250aFwiOlwiXCIpKyhxLmdldFRpbWUoKT09Ti5nZXRUaW1lKCkmJmc9PWEuc2VsZWN0ZWRNb250aCYmYS5fa2V5RXZlbnR8fEwuZ2V0VGltZSgpPT1xLmdldFRpbWUoKSYmTC5nZXRUaW1lKCk9PU4uZ2V0VGltZSgpP1wiIFwiK3RoaXMuX2RheU92ZXJDbGFzczpcIlwiKSsoSj9cIiBcIit0aGlzLl91bnNlbGVjdGFibGVDbGFzcytcIiB1aS1zdGF0ZS1kaXNhYmxlZFwiOlwiXCIpKyhDJiYhdj9cIlwiOlwiIFwiK0dbMV0rKHEuZ2V0VGltZSgpPT11LmdldFRpbWUoKT9cIiBcIit0aGlzLl9jdXJyZW50Q2xhc3M6XCJcIikrKHEuZ2V0VGltZSgpPT1iLmdldFRpbWUoKT9cIiB1aS1kYXRlcGlja2VyLXRvZGF5XCI6XG5cIlwiKSkrJ1wiJysoKCFDfHx2KSYmR1syXT8nIHRpdGxlPVwiJytHWzJdKydcIic6XCJcIikrKEo/XCJcIjonIG9uY2xpY2s9XCJEUF9qUXVlcnlfJyt5K1wiLmRhdGVwaWNrZXIuX3NlbGVjdERheSgnI1wiK2EuaWQrXCInLFwiK3EuZ2V0TW9udGgoKStcIixcIitxLmdldEZ1bGxZZWFyKCkrJywgdGhpcyk7cmV0dXJuIGZhbHNlO1wiJykrXCI+XCIrKEMmJiF2P1wiJiN4YTA7XCI6Sj8nPHNwYW4gY2xhc3M9XCJ1aS1zdGF0ZS1kZWZhdWx0XCI+JytxLmdldERhdGUoKStcIjwvc3Bhbj5cIjonPGEgY2xhc3M9XCJ1aS1zdGF0ZS1kZWZhdWx0JysocS5nZXRUaW1lKCk9PWIuZ2V0VGltZSgpP1wiIHVpLXN0YXRlLWhpZ2hsaWdodFwiOlwiXCIpKyhxLmdldFRpbWUoKT09dS5nZXRUaW1lKCk/XCIgdWktc3RhdGUtYWN0aXZlXCI6XCJcIikrKEM/XCIgdWktcHJpb3JpdHktc2Vjb25kYXJ5XCI6XCJcIikrJ1wiIGhyZWY9XCIjXCI+JytxLmdldERhdGUoKStcIjwvYT5cIikrXCI8L3RkPlwiO3Euc2V0RGF0ZShxLmdldERhdGUoKSsxKTtxPXRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KHEpfXgrPVxuUCtcIjwvdHI+XCJ9ZysrO2lmKGc+MTEpe2c9MDttKyt9eCs9XCI8L3Rib2R5PjwvdGFibGU+XCIrKGw/XCI8L2Rpdj5cIisoaVswXT4wJiZFPT1pWzFdLTE/JzxkaXYgY2xhc3M9XCJ1aS1kYXRlcGlja2VyLXJvdy1icmVha1wiPjwvZGl2Pic6XCJcIik6XCJcIik7TSs9eH1JKz1NfUkrPWUrKGQuYnJvd3Nlci5tc2llJiZwYXJzZUludChkLmJyb3dzZXIudmVyc2lvbiwxMCk8NyYmIWEuaW5saW5lPyc8aWZyYW1lIHNyYz1cImphdmFzY3JpcHQ6ZmFsc2U7XCIgY2xhc3M9XCJ1aS1kYXRlcGlja2VyLWNvdmVyXCIgZnJhbWVib3JkZXI9XCIwXCI+PC9pZnJhbWU+JzpcIlwiKTthLl9rZXlFdmVudD1mYWxzZTtyZXR1cm4gSX0sX2dlbmVyYXRlTW9udGhZZWFySGVhZGVyOmZ1bmN0aW9uKGEsYixjLGUsZixoLGksZyl7dmFyIGo9dGhpcy5fZ2V0KGEsXCJjaGFuZ2VNb250aFwiKSxsPXRoaXMuX2dldChhLFwiY2hhbmdlWWVhclwiKSx1PXRoaXMuX2dldChhLFwic2hvd01vbnRoQWZ0ZXJZZWFyXCIpLGs9JzxkaXYgY2xhc3M9XCJ1aS1kYXRlcGlja2VyLXRpdGxlXCI+Jyxcbm89XCJcIjtpZihofHwhailvKz0nPHNwYW4gY2xhc3M9XCJ1aS1kYXRlcGlja2VyLW1vbnRoXCI+JytpW2JdK1wiPC9zcGFuPlwiO2Vsc2V7aT1lJiZlLmdldEZ1bGxZZWFyKCk9PWM7dmFyIG09ZiYmZi5nZXRGdWxsWWVhcigpPT1jO28rPSc8c2VsZWN0IGNsYXNzPVwidWktZGF0ZXBpY2tlci1tb250aFwiIG9uY2hhbmdlPVwiRFBfalF1ZXJ5XycreStcIi5kYXRlcGlja2VyLl9zZWxlY3RNb250aFllYXIoJyNcIithLmlkK1wiJywgdGhpcywgJ00nKTtcXFwiIG9uY2xpY2s9XFxcIkRQX2pRdWVyeV9cIit5K1wiLmRhdGVwaWNrZXIuX2NsaWNrTW9udGhZZWFyKCcjXCIrYS5pZCtcIicpO1xcXCI+XCI7Zm9yKHZhciBuPTA7bjwxMjtuKyspaWYoKCFpfHxuPj1lLmdldE1vbnRoKCkpJiYoIW18fG48PWYuZ2V0TW9udGgoKSkpbys9JzxvcHRpb24gdmFsdWU9XCInK24rJ1wiJysobj09Yj8nIHNlbGVjdGVkPVwic2VsZWN0ZWRcIic6XCJcIikrXCI+XCIrZ1tuXStcIjwvb3B0aW9uPlwiO28rPVwiPC9zZWxlY3Q+XCJ9dXx8KGsrPW8rKGh8fCEoaiYmXG5sKT9cIiYjeGEwO1wiOlwiXCIpKTthLnllYXJzaHRtbD1cIlwiO2lmKGh8fCFsKWsrPSc8c3BhbiBjbGFzcz1cInVpLWRhdGVwaWNrZXIteWVhclwiPicrYytcIjwvc3Bhbj5cIjtlbHNle2c9dGhpcy5fZ2V0KGEsXCJ5ZWFyUmFuZ2VcIikuc3BsaXQoXCI6XCIpO3ZhciByPShuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKTtpPWZ1bmN0aW9uKHMpe3M9cy5tYXRjaCgvY1srLV0uKi8pP2MrcGFyc2VJbnQocy5zdWJzdHJpbmcoMSksMTApOnMubWF0Y2goL1srLV0uKi8pP3IrcGFyc2VJbnQocywxMCk6cGFyc2VJbnQocywxMCk7cmV0dXJuIGlzTmFOKHMpP3I6c307Yj1pKGdbMF0pO2c9TWF0aC5tYXgoYixpKGdbMV18fFwiXCIpKTtiPWU/TWF0aC5tYXgoYixlLmdldEZ1bGxZZWFyKCkpOmI7Zz1mP01hdGgubWluKGcsZi5nZXRGdWxsWWVhcigpKTpnO2ZvcihhLnllYXJzaHRtbCs9JzxzZWxlY3QgY2xhc3M9XCJ1aS1kYXRlcGlja2VyLXllYXJcIiBvbmNoYW5nZT1cIkRQX2pRdWVyeV8nK3krXCIuZGF0ZXBpY2tlci5fc2VsZWN0TW9udGhZZWFyKCcjXCIrXG5hLmlkK1wiJywgdGhpcywgJ1knKTtcXFwiIG9uY2xpY2s9XFxcIkRQX2pRdWVyeV9cIit5K1wiLmRhdGVwaWNrZXIuX2NsaWNrTW9udGhZZWFyKCcjXCIrYS5pZCtcIicpO1xcXCI+XCI7Yjw9ZztiKyspYS55ZWFyc2h0bWwrPSc8b3B0aW9uIHZhbHVlPVwiJytiKydcIicrKGI9PWM/JyBzZWxlY3RlZD1cInNlbGVjdGVkXCInOlwiXCIpK1wiPlwiK2IrXCI8L29wdGlvbj5cIjthLnllYXJzaHRtbCs9XCI8L3NlbGVjdD5cIjtpZihkLmJyb3dzZXIubW96aWxsYSlrKz0nPHNlbGVjdCBjbGFzcz1cInVpLWRhdGVwaWNrZXIteWVhclwiPjxvcHRpb24gdmFsdWU9XCInK2MrJ1wiIHNlbGVjdGVkPVwic2VsZWN0ZWRcIj4nK2MrXCI8L29wdGlvbj48L3NlbGVjdD5cIjtlbHNle2srPWEueWVhcnNodG1sO2EueWVhcnNodG1sPW51bGx9fWsrPXRoaXMuX2dldChhLFwieWVhclN1ZmZpeFwiKTtpZih1KWsrPShofHwhKGomJmwpP1wiJiN4YTA7XCI6XCJcIikrbztrKz1cIjwvZGl2PlwiO3JldHVybiBrfSxfYWRqdXN0SW5zdERhdGU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBlPVxuYS5kcmF3WWVhcisoYz09XCJZXCI/YjowKSxmPWEuZHJhd01vbnRoKyhjPT1cIk1cIj9iOjApO2I9TWF0aC5taW4oYS5zZWxlY3RlZERheSx0aGlzLl9nZXREYXlzSW5Nb250aChlLGYpKSsoYz09XCJEXCI/YjowKTtlPXRoaXMuX3Jlc3RyaWN0TWluTWF4KGEsdGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUoZSxmLGIpKSk7YS5zZWxlY3RlZERheT1lLmdldERhdGUoKTthLmRyYXdNb250aD1hLnNlbGVjdGVkTW9udGg9ZS5nZXRNb250aCgpO2EuZHJhd1llYXI9YS5zZWxlY3RlZFllYXI9ZS5nZXRGdWxsWWVhcigpO2lmKGM9PVwiTVwifHxjPT1cIllcIil0aGlzLl9ub3RpZnlDaGFuZ2UoYSl9LF9yZXN0cmljdE1pbk1heDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuX2dldE1pbk1heERhdGUoYSxcIm1pblwiKTthPXRoaXMuX2dldE1pbk1heERhdGUoYSxcIm1heFwiKTtiPWMmJmI8Yz9jOmI7cmV0dXJuIGI9YSYmYj5hP2E6Yn0sX25vdGlmeUNoYW5nZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLl9nZXQoYSxcblwib25DaGFuZ2VNb250aFllYXJcIik7aWYoYiliLmFwcGx5KGEuaW5wdXQ/YS5pbnB1dFswXTpudWxsLFthLnNlbGVjdGVkWWVhcixhLnNlbGVjdGVkTW9udGgrMSxhXSl9LF9nZXROdW1iZXJPZk1vbnRoczpmdW5jdGlvbihhKXthPXRoaXMuX2dldChhLFwibnVtYmVyT2ZNb250aHNcIik7cmV0dXJuIGE9PW51bGw/WzEsMV06dHlwZW9mIGE9PVwibnVtYmVyXCI/WzEsYV06YX0sX2dldE1pbk1heERhdGU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5fZGV0ZXJtaW5lRGF0ZShhLHRoaXMuX2dldChhLGIrXCJEYXRlXCIpLG51bGwpfSxfZ2V0RGF5c0luTW9udGg6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gMzItdGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUoYSxiLDMyKSkuZ2V0RGF0ZSgpfSxfZ2V0Rmlyc3REYXlPZk1vbnRoOmZ1bmN0aW9uKGEsYil7cmV0dXJuKG5ldyBEYXRlKGEsYiwxKSkuZ2V0RGF5KCl9LF9jYW5BZGp1c3RNb250aDpmdW5jdGlvbihhLGIsYyxlKXt2YXIgZj10aGlzLl9nZXROdW1iZXJPZk1vbnRocyhhKTtcbmM9dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUoYyxlKyhiPDA/YjpmWzBdKmZbMV0pLDEpKTtiPDAmJmMuc2V0RGF0ZSh0aGlzLl9nZXREYXlzSW5Nb250aChjLmdldEZ1bGxZZWFyKCksYy5nZXRNb250aCgpKSk7cmV0dXJuIHRoaXMuX2lzSW5SYW5nZShhLGMpfSxfaXNJblJhbmdlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5fZ2V0TWluTWF4RGF0ZShhLFwibWluXCIpO2E9dGhpcy5fZ2V0TWluTWF4RGF0ZShhLFwibWF4XCIpO3JldHVybighY3x8Yi5nZXRUaW1lKCk+PWMuZ2V0VGltZSgpKSYmKCFhfHxiLmdldFRpbWUoKTw9YS5nZXRUaW1lKCkpfSxfZ2V0Rm9ybWF0Q29uZmlnOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuX2dldChhLFwic2hvcnRZZWFyQ3V0b2ZmXCIpO2I9dHlwZW9mIGIhPVwic3RyaW5nXCI/YjoobmV3IERhdGUpLmdldEZ1bGxZZWFyKCklMTAwK3BhcnNlSW50KGIsMTApO3JldHVybntzaG9ydFllYXJDdXRvZmY6YixkYXlOYW1lc1Nob3J0OnRoaXMuX2dldChhLFxuXCJkYXlOYW1lc1Nob3J0XCIpLGRheU5hbWVzOnRoaXMuX2dldChhLFwiZGF5TmFtZXNcIiksbW9udGhOYW1lc1Nob3J0OnRoaXMuX2dldChhLFwibW9udGhOYW1lc1Nob3J0XCIpLG1vbnRoTmFtZXM6dGhpcy5fZ2V0KGEsXCJtb250aE5hbWVzXCIpfX0sX2Zvcm1hdERhdGU6ZnVuY3Rpb24oYSxiLGMsZSl7aWYoIWIpe2EuY3VycmVudERheT1hLnNlbGVjdGVkRGF5O2EuY3VycmVudE1vbnRoPWEuc2VsZWN0ZWRNb250aDthLmN1cnJlbnRZZWFyPWEuc2VsZWN0ZWRZZWFyfWI9Yj90eXBlb2YgYj09XCJvYmplY3RcIj9iOnRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKGUsYyxiKSk6dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUoYS5jdXJyZW50WWVhcixhLmN1cnJlbnRNb250aCxhLmN1cnJlbnREYXkpKTtyZXR1cm4gdGhpcy5mb3JtYXREYXRlKHRoaXMuX2dldChhLFwiZGF0ZUZvcm1hdFwiKSxiLHRoaXMuX2dldEZvcm1hdENvbmZpZyhhKSl9fSk7ZC5mbi5kYXRlcGlja2VyPVxuZnVuY3Rpb24oYSl7aWYoIXRoaXMubGVuZ3RoKXJldHVybiB0aGlzO2lmKCFkLmRhdGVwaWNrZXIuaW5pdGlhbGl6ZWQpe2QoZG9jdW1lbnQpLm1vdXNlZG93bihkLmRhdGVwaWNrZXIuX2NoZWNrRXh0ZXJuYWxDbGljaykuZmluZChcImJvZHlcIikuYXBwZW5kKGQuZGF0ZXBpY2tlci5kcERpdik7ZC5kYXRlcGlja2VyLmluaXRpYWxpemVkPXRydWV9dmFyIGI9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO2lmKHR5cGVvZiBhPT1cInN0cmluZ1wiJiYoYT09XCJpc0Rpc2FibGVkXCJ8fGE9PVwiZ2V0RGF0ZVwifHxhPT1cIndpZGdldFwiKSlyZXR1cm4gZC5kYXRlcGlja2VyW1wiX1wiK2ErXCJEYXRlcGlja2VyXCJdLmFwcGx5KGQuZGF0ZXBpY2tlcixbdGhpc1swXV0uY29uY2F0KGIpKTtpZihhPT1cIm9wdGlvblwiJiZhcmd1bWVudHMubGVuZ3RoPT0yJiZ0eXBlb2YgYXJndW1lbnRzWzFdPT1cInN0cmluZ1wiKXJldHVybiBkLmRhdGVwaWNrZXJbXCJfXCIrYStcIkRhdGVwaWNrZXJcIl0uYXBwbHkoZC5kYXRlcGlja2VyLFxuW3RoaXNbMF1dLmNvbmNhdChiKSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3R5cGVvZiBhPT1cInN0cmluZ1wiP2QuZGF0ZXBpY2tlcltcIl9cIithK1wiRGF0ZXBpY2tlclwiXS5hcHBseShkLmRhdGVwaWNrZXIsW3RoaXNdLmNvbmNhdChiKSk6ZC5kYXRlcGlja2VyLl9hdHRhY2hEYXRlcGlja2VyKHRoaXMsYSl9KX07ZC5kYXRlcGlja2VyPW5ldyBLO2QuZGF0ZXBpY2tlci5pbml0aWFsaXplZD1mYWxzZTtkLmRhdGVwaWNrZXIudXVpZD0obmV3IERhdGUpLmdldFRpbWUoKTtkLmRhdGVwaWNrZXIudmVyc2lvbj1cIjEuOC4xMVwiO3dpbmRvd1tcIkRQX2pRdWVyeV9cIit5XT1kfSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgUHJvZ3Jlc3NiYXIgMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvUHJvZ3Jlc3NiYXJcbiAqXG4gKiBEZXBlbmRzOlxuICogICBqcXVlcnkudWkuY29yZS5qc1xuICogICBqcXVlcnkudWkud2lkZ2V0LmpzXG4gKi9cbihmdW5jdGlvbihiLGQpe2Iud2lkZ2V0KFwidWkucHJvZ3Jlc3NiYXJcIix7b3B0aW9uczp7dmFsdWU6MCxtYXg6MTAwfSxtaW46MCxfY3JlYXRlOmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktcHJvZ3Jlc3NiYXIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGxcIikuYXR0cih7cm9sZTpcInByb2dyZXNzYmFyXCIsXCJhcmlhLXZhbHVlbWluXCI6dGhpcy5taW4sXCJhcmlhLXZhbHVlbWF4XCI6dGhpcy5vcHRpb25zLm1heCxcImFyaWEtdmFsdWVub3dcIjp0aGlzLl92YWx1ZSgpfSk7dGhpcy52YWx1ZURpdj1iKFwiPGRpdiBjbGFzcz0ndWktcHJvZ3Jlc3NiYXItdmFsdWUgdWktd2lkZ2V0LWhlYWRlciB1aS1jb3JuZXItbGVmdCc+PC9kaXY+XCIpLmFwcGVuZFRvKHRoaXMuZWxlbWVudCk7dGhpcy5vbGRWYWx1ZT10aGlzLl92YWx1ZSgpO3RoaXMuX3JlZnJlc2hWYWx1ZSgpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKFwidWktcHJvZ3Jlc3NiYXIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGxcIikucmVtb3ZlQXR0cihcInJvbGVcIikucmVtb3ZlQXR0cihcImFyaWEtdmFsdWVtaW5cIikucmVtb3ZlQXR0cihcImFyaWEtdmFsdWVtYXhcIikucmVtb3ZlQXR0cihcImFyaWEtdmFsdWVub3dcIik7XG50aGlzLnZhbHVlRGl2LnJlbW92ZSgpO2IuV2lkZ2V0LnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sdmFsdWU6ZnVuY3Rpb24oYSl7aWYoYT09PWQpcmV0dXJuIHRoaXMuX3ZhbHVlKCk7dGhpcy5fc2V0T3B0aW9uKFwidmFsdWVcIixhKTtyZXR1cm4gdGhpc30sX3NldE9wdGlvbjpmdW5jdGlvbihhLGMpe2lmKGE9PT1cInZhbHVlXCIpe3RoaXMub3B0aW9ucy52YWx1ZT1jO3RoaXMuX3JlZnJlc2hWYWx1ZSgpO3RoaXMuX3ZhbHVlKCk9PT10aGlzLm9wdGlvbnMubWF4JiZ0aGlzLl90cmlnZ2VyKFwiY29tcGxldGVcIil9Yi5XaWRnZXQucHJvdG90eXBlLl9zZXRPcHRpb24uYXBwbHkodGhpcyxhcmd1bWVudHMpfSxfdmFsdWU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMudmFsdWU7aWYodHlwZW9mIGEhPT1cIm51bWJlclwiKWE9MDtyZXR1cm4gTWF0aC5taW4odGhpcy5vcHRpb25zLm1heCxNYXRoLm1heCh0aGlzLm1pbixhKSl9LF9wZXJjZW50YWdlOmZ1bmN0aW9uKCl7cmV0dXJuIDEwMCpcbnRoaXMuX3ZhbHVlKCkvdGhpcy5vcHRpb25zLm1heH0sX3JlZnJlc2hWYWx1ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMudmFsdWUoKSxjPXRoaXMuX3BlcmNlbnRhZ2UoKTtpZih0aGlzLm9sZFZhbHVlIT09YSl7dGhpcy5vbGRWYWx1ZT1hO3RoaXMuX3RyaWdnZXIoXCJjaGFuZ2VcIil9dGhpcy52YWx1ZURpdi50b2dnbGVDbGFzcyhcInVpLWNvcm5lci1yaWdodFwiLGE9PT10aGlzLm9wdGlvbnMubWF4KS53aWR0aChjLnRvRml4ZWQoMCkrXCIlXCIpO3RoaXMuZWxlbWVudC5hdHRyKFwiYXJpYS12YWx1ZW5vd1wiLGEpfX0pO2IuZXh0ZW5kKGIudWkucHJvZ3Jlc3NiYXIse3ZlcnNpb246XCIxLjguMTFcIn0pfSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgRWZmZWN0cyAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXG4gKlxuICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9FZmZlY3RzL1xuICovXG5qUXVlcnkuZWZmZWN0c3x8ZnVuY3Rpb24oZixqKXtmdW5jdGlvbiBuKGMpe3ZhciBhO2lmKGMmJmMuY29uc3RydWN0b3I9PUFycmF5JiZjLmxlbmd0aD09MylyZXR1cm4gYztpZihhPS9yZ2JcXChcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKlxcKS8uZXhlYyhjKSlyZXR1cm5bcGFyc2VJbnQoYVsxXSwxMCkscGFyc2VJbnQoYVsyXSwxMCkscGFyc2VJbnQoYVszXSwxMCldO2lmKGE9L3JnYlxcKFxccyooWzAtOV0rKD86XFwuWzAtOV0rKT8pXFwlXFxzKixcXHMqKFswLTldKyg/OlxcLlswLTldKyk/KVxcJVxccyosXFxzKihbMC05XSsoPzpcXC5bMC05XSspPylcXCVcXHMqXFwpLy5leGVjKGMpKXJldHVybltwYXJzZUZsb2F0KGFbMV0pKjIuNTUscGFyc2VGbG9hdChhWzJdKSoyLjU1LHBhcnNlRmxvYXQoYVszXSkqMi41NV07aWYoYT0vIyhbYS1mQS1GMC05XXsyfSkoW2EtZkEtRjAtOV17Mn0pKFthLWZBLUYwLTldezJ9KS8uZXhlYyhjKSlyZXR1cm5bcGFyc2VJbnQoYVsxXSxcbjE2KSxwYXJzZUludChhWzJdLDE2KSxwYXJzZUludChhWzNdLDE2KV07aWYoYT0vIyhbYS1mQS1GMC05XSkoW2EtZkEtRjAtOV0pKFthLWZBLUYwLTldKS8uZXhlYyhjKSlyZXR1cm5bcGFyc2VJbnQoYVsxXSthWzFdLDE2KSxwYXJzZUludChhWzJdK2FbMl0sMTYpLHBhcnNlSW50KGFbM10rYVszXSwxNildO2lmKC9yZ2JhXFwoMCwgMCwgMCwgMFxcKS8uZXhlYyhjKSlyZXR1cm4gby50cmFuc3BhcmVudDtyZXR1cm4gb1tmLnRyaW0oYykudG9Mb3dlckNhc2UoKV19ZnVuY3Rpb24gcyhjLGEpe3ZhciBiO2Rve2I9Zi5jdXJDU1MoYyxhKTtpZihiIT1cIlwiJiZiIT1cInRyYW5zcGFyZW50XCJ8fGYubm9kZU5hbWUoYyxcImJvZHlcIikpYnJlYWs7YT1cImJhY2tncm91bmRDb2xvclwifXdoaWxlKGM9Yy5wYXJlbnROb2RlKTtyZXR1cm4gbihiKX1mdW5jdGlvbiBwKCl7dmFyIGM9ZG9jdW1lbnQuZGVmYXVsdFZpZXc/ZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLG51bGwpOnRoaXMuY3VycmVudFN0eWxlLFxuYT17fSxiLGQ7aWYoYyYmYy5sZW5ndGgmJmNbMF0mJmNbY1swXV0pZm9yKHZhciBlPWMubGVuZ3RoO2UtLTspe2I9Y1tlXTtpZih0eXBlb2YgY1tiXT09XCJzdHJpbmdcIil7ZD1iLnJlcGxhY2UoL1xcLShcXHcpL2csZnVuY3Rpb24oZyxoKXtyZXR1cm4gaC50b1VwcGVyQ2FzZSgpfSk7YVtkXT1jW2JdfX1lbHNlIGZvcihiIGluIGMpaWYodHlwZW9mIGNbYl09PT1cInN0cmluZ1wiKWFbYl09Y1tiXTtyZXR1cm4gYX1mdW5jdGlvbiBxKGMpe3ZhciBhLGI7Zm9yKGEgaW4gYyl7Yj1jW2FdO2lmKGI9PW51bGx8fGYuaXNGdW5jdGlvbihiKXx8YSBpbiB0fHwvc2Nyb2xsYmFyLy50ZXN0KGEpfHwhL2NvbG9yL2kudGVzdChhKSYmaXNOYU4ocGFyc2VGbG9hdChiKSkpZGVsZXRlIGNbYV19cmV0dXJuIGN9ZnVuY3Rpb24gdShjLGEpe3ZhciBiPXtfOjB9LGQ7Zm9yKGQgaW4gYSlpZihjW2RdIT1hW2RdKWJbZF09YVtkXTtyZXR1cm4gYn1mdW5jdGlvbiBrKGMsYSxiLGQpe2lmKHR5cGVvZiBjPT1cIm9iamVjdFwiKXtkPVxuYTtiPW51bGw7YT1jO2M9YS5lZmZlY3R9aWYoZi5pc0Z1bmN0aW9uKGEpKXtkPWE7Yj1udWxsO2E9e319aWYodHlwZW9mIGE9PVwibnVtYmVyXCJ8fGYuZnguc3BlZWRzW2FdKXtkPWI7Yj1hO2E9e319aWYoZi5pc0Z1bmN0aW9uKGIpKXtkPWI7Yj1udWxsfWE9YXx8e307Yj1ifHxhLmR1cmF0aW9uO2I9Zi5meC5vZmY/MDp0eXBlb2YgYj09XCJudW1iZXJcIj9iOmIgaW4gZi5meC5zcGVlZHM/Zi5meC5zcGVlZHNbYl06Zi5meC5zcGVlZHMuX2RlZmF1bHQ7ZD1kfHxhLmNvbXBsZXRlO3JldHVybltjLGEsYixkXX1mdW5jdGlvbiBtKGMpe2lmKCFjfHx0eXBlb2YgYz09PVwibnVtYmVyXCJ8fGYuZnguc3BlZWRzW2NdKXJldHVybiB0cnVlO2lmKHR5cGVvZiBjPT09XCJzdHJpbmdcIiYmIWYuZWZmZWN0c1tjXSlyZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2V9Zi5lZmZlY3RzPXt9O2YuZWFjaChbXCJiYWNrZ3JvdW5kQ29sb3JcIixcImJvcmRlckJvdHRvbUNvbG9yXCIsXCJib3JkZXJMZWZ0Q29sb3JcIixcImJvcmRlclJpZ2h0Q29sb3JcIixcblwiYm9yZGVyVG9wQ29sb3JcIixcImJvcmRlckNvbG9yXCIsXCJjb2xvclwiLFwib3V0bGluZUNvbG9yXCJdLGZ1bmN0aW9uKGMsYSl7Zi5meC5zdGVwW2FdPWZ1bmN0aW9uKGIpe2lmKCFiLmNvbG9ySW5pdCl7Yi5zdGFydD1zKGIuZWxlbSxhKTtiLmVuZD1uKGIuZW5kKTtiLmNvbG9ySW5pdD10cnVlfWIuZWxlbS5zdHlsZVthXT1cInJnYihcIitNYXRoLm1heChNYXRoLm1pbihwYXJzZUludChiLnBvcyooYi5lbmRbMF0tYi5zdGFydFswXSkrYi5zdGFydFswXSwxMCksMjU1KSwwKStcIixcIitNYXRoLm1heChNYXRoLm1pbihwYXJzZUludChiLnBvcyooYi5lbmRbMV0tYi5zdGFydFsxXSkrYi5zdGFydFsxXSwxMCksMjU1KSwwKStcIixcIitNYXRoLm1heChNYXRoLm1pbihwYXJzZUludChiLnBvcyooYi5lbmRbMl0tYi5zdGFydFsyXSkrYi5zdGFydFsyXSwxMCksMjU1KSwwKStcIilcIn19KTt2YXIgbz17YXF1YTpbMCwyNTUsMjU1XSxhenVyZTpbMjQwLDI1NSwyNTVdLGJlaWdlOlsyNDUsMjQ1LDIyMF0sYmxhY2s6WzAsXG4wLDBdLGJsdWU6WzAsMCwyNTVdLGJyb3duOlsxNjUsNDIsNDJdLGN5YW46WzAsMjU1LDI1NV0sZGFya2JsdWU6WzAsMCwxMzldLGRhcmtjeWFuOlswLDEzOSwxMzldLGRhcmtncmV5OlsxNjksMTY5LDE2OV0sZGFya2dyZWVuOlswLDEwMCwwXSxkYXJra2hha2k6WzE4OSwxODMsMTA3XSxkYXJrbWFnZW50YTpbMTM5LDAsMTM5XSxkYXJrb2xpdmVncmVlbjpbODUsMTA3LDQ3XSxkYXJrb3JhbmdlOlsyNTUsMTQwLDBdLGRhcmtvcmNoaWQ6WzE1Myw1MCwyMDRdLGRhcmtyZWQ6WzEzOSwwLDBdLGRhcmtzYWxtb246WzIzMywxNTAsMTIyXSxkYXJrdmlvbGV0OlsxNDgsMCwyMTFdLGZ1Y2hzaWE6WzI1NSwwLDI1NV0sZ29sZDpbMjU1LDIxNSwwXSxncmVlbjpbMCwxMjgsMF0saW5kaWdvOls3NSwwLDEzMF0sa2hha2k6WzI0MCwyMzAsMTQwXSxsaWdodGJsdWU6WzE3MywyMTYsMjMwXSxsaWdodGN5YW46WzIyNCwyNTUsMjU1XSxsaWdodGdyZWVuOlsxNDQsMjM4LDE0NF0sbGlnaHRncmV5OlsyMTEsXG4yMTEsMjExXSxsaWdodHBpbms6WzI1NSwxODIsMTkzXSxsaWdodHllbGxvdzpbMjU1LDI1NSwyMjRdLGxpbWU6WzAsMjU1LDBdLG1hZ2VudGE6WzI1NSwwLDI1NV0sbWFyb29uOlsxMjgsMCwwXSxuYXZ5OlswLDAsMTI4XSxvbGl2ZTpbMTI4LDEyOCwwXSxvcmFuZ2U6WzI1NSwxNjUsMF0scGluazpbMjU1LDE5MiwyMDNdLHB1cnBsZTpbMTI4LDAsMTI4XSx2aW9sZXQ6WzEyOCwwLDEyOF0scmVkOlsyNTUsMCwwXSxzaWx2ZXI6WzE5MiwxOTIsMTkyXSx3aGl0ZTpbMjU1LDI1NSwyNTVdLHllbGxvdzpbMjU1LDI1NSwwXSx0cmFuc3BhcmVudDpbMjU1LDI1NSwyNTVdfSxyPVtcImFkZFwiLFwicmVtb3ZlXCIsXCJ0b2dnbGVcIl0sdD17Ym9yZGVyOjEsYm9yZGVyQm90dG9tOjEsYm9yZGVyQ29sb3I6MSxib3JkZXJMZWZ0OjEsYm9yZGVyUmlnaHQ6MSxib3JkZXJUb3A6MSxib3JkZXJXaWR0aDoxLG1hcmdpbjoxLHBhZGRpbmc6MX07Zi5lZmZlY3RzLmFuaW1hdGVDbGFzcz1mdW5jdGlvbihjLGEsYixcbmQpe2lmKGYuaXNGdW5jdGlvbihiKSl7ZD1iO2I9bnVsbH1yZXR1cm4gdGhpcy5xdWV1ZShcImZ4XCIsZnVuY3Rpb24oKXt2YXIgZT1mKHRoaXMpLGc9ZS5hdHRyKFwic3R5bGVcIil8fFwiIFwiLGg9cShwLmNhbGwodGhpcykpLGwsdj1lLmF0dHIoXCJjbGFzc05hbWVcIik7Zi5lYWNoKHIsZnVuY3Rpb24odyxpKXtjW2ldJiZlW2krXCJDbGFzc1wiXShjW2ldKX0pO2w9cShwLmNhbGwodGhpcykpO2UuYXR0cihcImNsYXNzTmFtZVwiLHYpO2UuYW5pbWF0ZSh1KGgsbCksYSxiLGZ1bmN0aW9uKCl7Zi5lYWNoKHIsZnVuY3Rpb24odyxpKXtjW2ldJiZlW2krXCJDbGFzc1wiXShjW2ldKX0pO2lmKHR5cGVvZiBlLmF0dHIoXCJzdHlsZVwiKT09XCJvYmplY3RcIil7ZS5hdHRyKFwic3R5bGVcIikuY3NzVGV4dD1cIlwiO2UuYXR0cihcInN0eWxlXCIpLmNzc1RleHQ9Z31lbHNlIGUuYXR0cihcInN0eWxlXCIsZyk7ZCYmZC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KTtoPWYucXVldWUodGhpcyk7bD1oLnNwbGljZShoLmxlbmd0aC0xLDEpWzBdO1xuaC5zcGxpY2UoMSwwLGwpO2YuZGVxdWV1ZSh0aGlzKX0pfTtmLmZuLmV4dGVuZCh7X2FkZENsYXNzOmYuZm4uYWRkQ2xhc3MsYWRkQ2xhc3M6ZnVuY3Rpb24oYyxhLGIsZCl7cmV0dXJuIGE/Zi5lZmZlY3RzLmFuaW1hdGVDbGFzcy5hcHBseSh0aGlzLFt7YWRkOmN9LGEsYixkXSk6dGhpcy5fYWRkQ2xhc3MoYyl9LF9yZW1vdmVDbGFzczpmLmZuLnJlbW92ZUNsYXNzLHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGMsYSxiLGQpe3JldHVybiBhP2YuZWZmZWN0cy5hbmltYXRlQ2xhc3MuYXBwbHkodGhpcyxbe3JlbW92ZTpjfSxhLGIsZF0pOnRoaXMuX3JlbW92ZUNsYXNzKGMpfSxfdG9nZ2xlQ2xhc3M6Zi5mbi50b2dnbGVDbGFzcyx0b2dnbGVDbGFzczpmdW5jdGlvbihjLGEsYixkLGUpe3JldHVybiB0eXBlb2YgYT09XCJib29sZWFuXCJ8fGE9PT1qP2I/Zi5lZmZlY3RzLmFuaW1hdGVDbGFzcy5hcHBseSh0aGlzLFthP3thZGQ6Y306e3JlbW92ZTpjfSxiLGQsZV0pOnRoaXMuX3RvZ2dsZUNsYXNzKGMsXG5hKTpmLmVmZmVjdHMuYW5pbWF0ZUNsYXNzLmFwcGx5KHRoaXMsW3t0b2dnbGU6Y30sYSxiLGRdKX0sc3dpdGNoQ2xhc3M6ZnVuY3Rpb24oYyxhLGIsZCxlKXtyZXR1cm4gZi5lZmZlY3RzLmFuaW1hdGVDbGFzcy5hcHBseSh0aGlzLFt7YWRkOmEscmVtb3ZlOmN9LGIsZCxlXSl9fSk7Zi5leHRlbmQoZi5lZmZlY3RzLHt2ZXJzaW9uOlwiMS44LjExXCIsc2F2ZTpmdW5jdGlvbihjLGEpe2Zvcih2YXIgYj0wO2I8YS5sZW5ndGg7YisrKWFbYl0hPT1udWxsJiZjLmRhdGEoXCJlYy5zdG9yYWdlLlwiK2FbYl0sY1swXS5zdHlsZVthW2JdXSl9LHJlc3RvcmU6ZnVuY3Rpb24oYyxhKXtmb3IodmFyIGI9MDtiPGEubGVuZ3RoO2IrKylhW2JdIT09bnVsbCYmYy5jc3MoYVtiXSxjLmRhdGEoXCJlYy5zdG9yYWdlLlwiK2FbYl0pKX0sc2V0TW9kZTpmdW5jdGlvbihjLGEpe2lmKGE9PVwidG9nZ2xlXCIpYT1jLmlzKFwiOmhpZGRlblwiKT9cInNob3dcIjpcImhpZGVcIjtyZXR1cm4gYX0sZ2V0QmFzZWxpbmU6ZnVuY3Rpb24oYyxcbmEpe3ZhciBiO3N3aXRjaChjWzBdKXtjYXNlIFwidG9wXCI6Yj0wO2JyZWFrO2Nhc2UgXCJtaWRkbGVcIjpiPTAuNTticmVhaztjYXNlIFwiYm90dG9tXCI6Yj0xO2JyZWFrO2RlZmF1bHQ6Yj1jWzBdL2EuaGVpZ2h0fXN3aXRjaChjWzFdKXtjYXNlIFwibGVmdFwiOmM9MDticmVhaztjYXNlIFwiY2VudGVyXCI6Yz0wLjU7YnJlYWs7Y2FzZSBcInJpZ2h0XCI6Yz0xO2JyZWFrO2RlZmF1bHQ6Yz1jWzFdL2Eud2lkdGh9cmV0dXJue3g6Yyx5OmJ9fSxjcmVhdGVXcmFwcGVyOmZ1bmN0aW9uKGMpe2lmKGMucGFyZW50KCkuaXMoXCIudWktZWZmZWN0cy13cmFwcGVyXCIpKXJldHVybiBjLnBhcmVudCgpO3ZhciBhPXt3aWR0aDpjLm91dGVyV2lkdGgodHJ1ZSksaGVpZ2h0OmMub3V0ZXJIZWlnaHQodHJ1ZSksXCJmbG9hdFwiOmMuY3NzKFwiZmxvYXRcIil9LGI9ZihcIjxkaXY+PC9kaXY+XCIpLmFkZENsYXNzKFwidWktZWZmZWN0cy13cmFwcGVyXCIpLmNzcyh7Zm9udFNpemU6XCIxMDAlXCIsYmFja2dyb3VuZDpcInRyYW5zcGFyZW50XCIsXG5ib3JkZXI6XCJub25lXCIsbWFyZ2luOjAscGFkZGluZzowfSk7Yy53cmFwKGIpO2I9Yy5wYXJlbnQoKTtpZihjLmNzcyhcInBvc2l0aW9uXCIpPT1cInN0YXRpY1wiKXtiLmNzcyh7cG9zaXRpb246XCJyZWxhdGl2ZVwifSk7Yy5jc3Moe3Bvc2l0aW9uOlwicmVsYXRpdmVcIn0pfWVsc2V7Zi5leHRlbmQoYSx7cG9zaXRpb246Yy5jc3MoXCJwb3NpdGlvblwiKSx6SW5kZXg6Yy5jc3MoXCJ6LWluZGV4XCIpfSk7Zi5lYWNoKFtcInRvcFwiLFwibGVmdFwiLFwiYm90dG9tXCIsXCJyaWdodFwiXSxmdW5jdGlvbihkLGUpe2FbZV09Yy5jc3MoZSk7aWYoaXNOYU4ocGFyc2VJbnQoYVtlXSwxMCkpKWFbZV09XCJhdXRvXCJ9KTtjLmNzcyh7cG9zaXRpb246XCJyZWxhdGl2ZVwiLHRvcDowLGxlZnQ6MCxyaWdodDpcImF1dG9cIixib3R0b206XCJhdXRvXCJ9KX1yZXR1cm4gYi5jc3MoYSkuc2hvdygpfSxyZW1vdmVXcmFwcGVyOmZ1bmN0aW9uKGMpe2lmKGMucGFyZW50KCkuaXMoXCIudWktZWZmZWN0cy13cmFwcGVyXCIpKXJldHVybiBjLnBhcmVudCgpLnJlcGxhY2VXaXRoKGMpO1xucmV0dXJuIGN9LHNldFRyYW5zaXRpb246ZnVuY3Rpb24oYyxhLGIsZCl7ZD1kfHx7fTtmLmVhY2goYSxmdW5jdGlvbihlLGcpe3VuaXQ9Yy5jc3NVbml0KGcpO2lmKHVuaXRbMF0+MClkW2ddPXVuaXRbMF0qYit1bml0WzFdfSk7cmV0dXJuIGR9fSk7Zi5mbi5leHRlbmQoe2VmZmVjdDpmdW5jdGlvbihjKXt2YXIgYT1rLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxiPXtvcHRpb25zOmFbMV0sZHVyYXRpb246YVsyXSxjYWxsYmFjazphWzNdfTthPWIub3B0aW9ucy5tb2RlO3ZhciBkPWYuZWZmZWN0c1tjXTtpZihmLmZ4Lm9mZnx8IWQpcmV0dXJuIGE/dGhpc1thXShiLmR1cmF0aW9uLGIuY2FsbGJhY2spOnRoaXMuZWFjaChmdW5jdGlvbigpe2IuY2FsbGJhY2smJmIuY2FsbGJhY2suY2FsbCh0aGlzKX0pO3JldHVybiBkLmNhbGwodGhpcyxiKX0sX3Nob3c6Zi5mbi5zaG93LHNob3c6ZnVuY3Rpb24oYyl7aWYobShjKSlyZXR1cm4gdGhpcy5fc2hvdy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XG5lbHNle3ZhciBhPWsuYXBwbHkodGhpcyxhcmd1bWVudHMpO2FbMV0ubW9kZT1cInNob3dcIjtyZXR1cm4gdGhpcy5lZmZlY3QuYXBwbHkodGhpcyxhKX19LF9oaWRlOmYuZm4uaGlkZSxoaWRlOmZ1bmN0aW9uKGMpe2lmKG0oYykpcmV0dXJuIHRoaXMuX2hpZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO2Vsc2V7dmFyIGE9ay5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YVsxXS5tb2RlPVwiaGlkZVwiO3JldHVybiB0aGlzLmVmZmVjdC5hcHBseSh0aGlzLGEpfX0sX190b2dnbGU6Zi5mbi50b2dnbGUsdG9nZ2xlOmZ1bmN0aW9uKGMpe2lmKG0oYyl8fHR5cGVvZiBjPT09XCJib29sZWFuXCJ8fGYuaXNGdW5jdGlvbihjKSlyZXR1cm4gdGhpcy5fX3RvZ2dsZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7ZWxzZXt2YXIgYT1rLmFwcGx5KHRoaXMsYXJndW1lbnRzKTthWzFdLm1vZGU9XCJ0b2dnbGVcIjtyZXR1cm4gdGhpcy5lZmZlY3QuYXBwbHkodGhpcyxhKX19LGNzc1VuaXQ6ZnVuY3Rpb24oYyl7dmFyIGE9dGhpcy5jc3MoYyksXG5iPVtdO2YuZWFjaChbXCJlbVwiLFwicHhcIixcIiVcIixcInB0XCJdLGZ1bmN0aW9uKGQsZSl7aWYoYS5pbmRleE9mKGUpPjApYj1bcGFyc2VGbG9hdChhKSxlXX0pO3JldHVybiBifX0pO2YuZWFzaW5nLmpzd2luZz1mLmVhc2luZy5zd2luZztmLmV4dGVuZChmLmVhc2luZyx7ZGVmOlwiZWFzZU91dFF1YWRcIixzd2luZzpmdW5jdGlvbihjLGEsYixkLGUpe3JldHVybiBmLmVhc2luZ1tmLmVhc2luZy5kZWZdKGMsYSxiLGQsZSl9LGVhc2VJblF1YWQ6ZnVuY3Rpb24oYyxhLGIsZCxlKXtyZXR1cm4gZCooYS89ZSkqYStifSxlYXNlT3V0UXVhZDpmdW5jdGlvbihjLGEsYixkLGUpe3JldHVybi1kKihhLz1lKSooYS0yKStifSxlYXNlSW5PdXRRdWFkOmZ1bmN0aW9uKGMsYSxiLGQsZSl7aWYoKGEvPWUvMik8MSlyZXR1cm4gZC8yKmEqYStiO3JldHVybi1kLzIqKC0tYSooYS0yKS0xKStifSxlYXNlSW5DdWJpYzpmdW5jdGlvbihjLGEsYixkLGUpe3JldHVybiBkKihhLz1lKSphKmErYn0sZWFzZU91dEN1YmljOmZ1bmN0aW9uKGMsXG5hLGIsZCxlKXtyZXR1cm4gZCooKGE9YS9lLTEpKmEqYSsxKStifSxlYXNlSW5PdXRDdWJpYzpmdW5jdGlvbihjLGEsYixkLGUpe2lmKChhLz1lLzIpPDEpcmV0dXJuIGQvMiphKmEqYStiO3JldHVybiBkLzIqKChhLT0yKSphKmErMikrYn0sZWFzZUluUXVhcnQ6ZnVuY3Rpb24oYyxhLGIsZCxlKXtyZXR1cm4gZCooYS89ZSkqYSphKmErYn0sZWFzZU91dFF1YXJ0OmZ1bmN0aW9uKGMsYSxiLGQsZSl7cmV0dXJuLWQqKChhPWEvZS0xKSphKmEqYS0xKStifSxlYXNlSW5PdXRRdWFydDpmdW5jdGlvbihjLGEsYixkLGUpe2lmKChhLz1lLzIpPDEpcmV0dXJuIGQvMiphKmEqYSphK2I7cmV0dXJuLWQvMiooKGEtPTIpKmEqYSphLTIpK2J9LGVhc2VJblF1aW50OmZ1bmN0aW9uKGMsYSxiLGQsZSl7cmV0dXJuIGQqKGEvPWUpKmEqYSphKmErYn0sZWFzZU91dFF1aW50OmZ1bmN0aW9uKGMsYSxiLGQsZSl7cmV0dXJuIGQqKChhPWEvZS0xKSphKmEqYSphKzEpK2J9LGVhc2VJbk91dFF1aW50OmZ1bmN0aW9uKGMsXG5hLGIsZCxlKXtpZigoYS89ZS8yKTwxKXJldHVybiBkLzIqYSphKmEqYSphK2I7cmV0dXJuIGQvMiooKGEtPTIpKmEqYSphKmErMikrYn0sZWFzZUluU2luZTpmdW5jdGlvbihjLGEsYixkLGUpe3JldHVybi1kKk1hdGguY29zKGEvZSooTWF0aC5QSS8yKSkrZCtifSxlYXNlT3V0U2luZTpmdW5jdGlvbihjLGEsYixkLGUpe3JldHVybiBkKk1hdGguc2luKGEvZSooTWF0aC5QSS8yKSkrYn0sZWFzZUluT3V0U2luZTpmdW5jdGlvbihjLGEsYixkLGUpe3JldHVybi1kLzIqKE1hdGguY29zKE1hdGguUEkqYS9lKS0xKStifSxlYXNlSW5FeHBvOmZ1bmN0aW9uKGMsYSxiLGQsZSl7cmV0dXJuIGE9PTA/YjpkKk1hdGgucG93KDIsMTAqKGEvZS0xKSkrYn0sZWFzZU91dEV4cG86ZnVuY3Rpb24oYyxhLGIsZCxlKXtyZXR1cm4gYT09ZT9iK2Q6ZCooLU1hdGgucG93KDIsLTEwKmEvZSkrMSkrYn0sZWFzZUluT3V0RXhwbzpmdW5jdGlvbihjLGEsYixkLGUpe2lmKGE9PTApcmV0dXJuIGI7aWYoYT09XG5lKXJldHVybiBiK2Q7aWYoKGEvPWUvMik8MSlyZXR1cm4gZC8yKk1hdGgucG93KDIsMTAqKGEtMSkpK2I7cmV0dXJuIGQvMiooLU1hdGgucG93KDIsLTEwKi0tYSkrMikrYn0sZWFzZUluQ2lyYzpmdW5jdGlvbihjLGEsYixkLGUpe3JldHVybi1kKihNYXRoLnNxcnQoMS0oYS89ZSkqYSktMSkrYn0sZWFzZU91dENpcmM6ZnVuY3Rpb24oYyxhLGIsZCxlKXtyZXR1cm4gZCpNYXRoLnNxcnQoMS0oYT1hL2UtMSkqYSkrYn0sZWFzZUluT3V0Q2lyYzpmdW5jdGlvbihjLGEsYixkLGUpe2lmKChhLz1lLzIpPDEpcmV0dXJuLWQvMiooTWF0aC5zcXJ0KDEtYSphKS0xKStiO3JldHVybiBkLzIqKE1hdGguc3FydCgxLShhLT0yKSphKSsxKStifSxlYXNlSW5FbGFzdGljOmZ1bmN0aW9uKGMsYSxiLGQsZSl7Yz0xLjcwMTU4O3ZhciBnPTAsaD1kO2lmKGE9PTApcmV0dXJuIGI7aWYoKGEvPWUpPT0xKXJldHVybiBiK2Q7Z3x8KGc9ZSowLjMpO2lmKGg8TWF0aC5hYnMoZCkpe2g9ZDtjPWcvNH1lbHNlIGM9XG5nLygyKk1hdGguUEkpKk1hdGguYXNpbihkL2gpO3JldHVybi0oaCpNYXRoLnBvdygyLDEwKihhLT0xKSkqTWF0aC5zaW4oKGEqZS1jKSoyKk1hdGguUEkvZykpK2J9LGVhc2VPdXRFbGFzdGljOmZ1bmN0aW9uKGMsYSxiLGQsZSl7Yz0xLjcwMTU4O3ZhciBnPTAsaD1kO2lmKGE9PTApcmV0dXJuIGI7aWYoKGEvPWUpPT0xKXJldHVybiBiK2Q7Z3x8KGc9ZSowLjMpO2lmKGg8TWF0aC5hYnMoZCkpe2g9ZDtjPWcvNH1lbHNlIGM9Zy8oMipNYXRoLlBJKSpNYXRoLmFzaW4oZC9oKTtyZXR1cm4gaCpNYXRoLnBvdygyLC0xMCphKSpNYXRoLnNpbigoYSplLWMpKjIqTWF0aC5QSS9nKStkK2J9LGVhc2VJbk91dEVsYXN0aWM6ZnVuY3Rpb24oYyxhLGIsZCxlKXtjPTEuNzAxNTg7dmFyIGc9MCxoPWQ7aWYoYT09MClyZXR1cm4gYjtpZigoYS89ZS8yKT09MilyZXR1cm4gYitkO2d8fChnPWUqMC4zKjEuNSk7aWYoaDxNYXRoLmFicyhkKSl7aD1kO2M9Zy80fWVsc2UgYz1nLygyKk1hdGguUEkpKk1hdGguYXNpbihkL1xuaCk7aWYoYTwxKXJldHVybi0wLjUqaCpNYXRoLnBvdygyLDEwKihhLT0xKSkqTWF0aC5zaW4oKGEqZS1jKSoyKk1hdGguUEkvZykrYjtyZXR1cm4gaCpNYXRoLnBvdygyLC0xMCooYS09MSkpKk1hdGguc2luKChhKmUtYykqMipNYXRoLlBJL2cpKjAuNStkK2J9LGVhc2VJbkJhY2s6ZnVuY3Rpb24oYyxhLGIsZCxlLGcpe2lmKGc9PWopZz0xLjcwMTU4O3JldHVybiBkKihhLz1lKSphKigoZysxKSphLWcpK2J9LGVhc2VPdXRCYWNrOmZ1bmN0aW9uKGMsYSxiLGQsZSxnKXtpZihnPT1qKWc9MS43MDE1ODtyZXR1cm4gZCooKGE9YS9lLTEpKmEqKChnKzEpKmErZykrMSkrYn0sZWFzZUluT3V0QmFjazpmdW5jdGlvbihjLGEsYixkLGUsZyl7aWYoZz09ailnPTEuNzAxNTg7aWYoKGEvPWUvMik8MSlyZXR1cm4gZC8yKmEqYSooKChnKj0xLjUyNSkrMSkqYS1nKStiO3JldHVybiBkLzIqKChhLT0yKSphKigoKGcqPTEuNTI1KSsxKSphK2cpKzIpK2J9LGVhc2VJbkJvdW5jZTpmdW5jdGlvbihjLFxuYSxiLGQsZSl7cmV0dXJuIGQtZi5lYXNpbmcuZWFzZU91dEJvdW5jZShjLGUtYSwwLGQsZSkrYn0sZWFzZU91dEJvdW5jZTpmdW5jdGlvbihjLGEsYixkLGUpe3JldHVybihhLz1lKTwxLzIuNzU/ZCo3LjU2MjUqYSphK2I6YTwyLzIuNzU/ZCooNy41NjI1KihhLT0xLjUvMi43NSkqYSswLjc1KStiOmE8Mi41LzIuNzU/ZCooNy41NjI1KihhLT0yLjI1LzIuNzUpKmErMC45Mzc1KStiOmQqKDcuNTYyNSooYS09Mi42MjUvMi43NSkqYSswLjk4NDM3NSkrYn0sZWFzZUluT3V0Qm91bmNlOmZ1bmN0aW9uKGMsYSxiLGQsZSl7aWYoYTxlLzIpcmV0dXJuIGYuZWFzaW5nLmVhc2VJbkJvdW5jZShjLGEqMiwwLGQsZSkqMC41K2I7cmV0dXJuIGYuZWFzaW5nLmVhc2VPdXRCb3VuY2UoYyxhKjItZSwwLGQsZSkqMC41K2QqMC41K2J9fSl9KGpRdWVyeSk7XG47LypcbiAqIE5vdGU6IFdoaWxlIE1pY3Jvc29mdCBpcyBub3QgdGhlIGF1dGhvciBvZiB0aGlzIGZpbGUsIE1pY3Jvc29mdCBpc1xuICogb2ZmZXJpbmcgeW91IGEgbGljZW5zZSBzdWJqZWN0IHRvIHRoZSB0ZXJtcyBvZiB0aGUgTWljcm9zb2Z0IFNvZnR3YXJlXG4gKiBMaWNlbnNlIFRlcm1zIGZvciBNaWNyb3NvZnQgQVNQLk5FVCBNb2RlbCBWaWV3IENvbnRyb2xsZXIgMy5cbiAqIE1pY3Jvc29mdCByZXNlcnZlcyBhbGwgb3RoZXIgcmlnaHRzLiBUaGUgbm90aWNlcyBiZWxvdyBhcmUgcHJvdmlkZWRcbiAqIGZvciBpbmZvcm1hdGlvbmFsIHB1cnBvc2VzIG9ubHkgYW5kIGFyZSBub3QgdGhlIGxpY2Vuc2UgdGVybXMgdW5kZXJcbiAqIHdoaWNoIE1pY3Jvc29mdCBkaXN0cmlidXRlZCB0aGlzIGZpbGUuXG4gKlxuICogalF1ZXJ5IFVJIEVmZmVjdHMgQmxpbmQgMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvRWZmZWN0cy9CbGluZFxuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LmVmZmVjdHMuY29yZS5qc1xuICovXG4oZnVuY3Rpb24oYil7Yi5lZmZlY3RzLmJsaW5kPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLnF1ZXVlKGZ1bmN0aW9uKCl7dmFyIGE9Yih0aGlzKSxnPVtcInBvc2l0aW9uXCIsXCJ0b3BcIixcImJvdHRvbVwiLFwibGVmdFwiLFwicmlnaHRcIl0sZj1iLmVmZmVjdHMuc2V0TW9kZShhLGMub3B0aW9ucy5tb2RlfHxcImhpZGVcIiksZD1jLm9wdGlvbnMuZGlyZWN0aW9ufHxcInZlcnRpY2FsXCI7Yi5lZmZlY3RzLnNhdmUoYSxnKTthLnNob3coKTt2YXIgZT1iLmVmZmVjdHMuY3JlYXRlV3JhcHBlcihhKS5jc3Moe292ZXJmbG93OlwiaGlkZGVuXCJ9KSxoPWQ9PVwidmVydGljYWxcIj9cImhlaWdodFwiOlwid2lkdGhcIjtkPWQ9PVwidmVydGljYWxcIj9lLmhlaWdodCgpOmUud2lkdGgoKTtmPT1cInNob3dcIiYmZS5jc3MoaCwwKTt2YXIgaT17fTtpW2hdPWY9PVwic2hvd1wiP2Q6MDtlLmFuaW1hdGUoaSxjLmR1cmF0aW9uLGMub3B0aW9ucy5lYXNpbmcsZnVuY3Rpb24oKXtmPT1cImhpZGVcIiYmYS5oaWRlKCk7Yi5lZmZlY3RzLnJlc3RvcmUoYSxcbmcpO2IuZWZmZWN0cy5yZW1vdmVXcmFwcGVyKGEpO2MuY2FsbGJhY2smJmMuY2FsbGJhY2suYXBwbHkoYVswXSxhcmd1bWVudHMpO2EuZGVxdWV1ZSgpfSl9KX19KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBFZmZlY3RzIEJvdW5jZSAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXG4gKlxuICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9FZmZlY3RzL0JvdW5jZVxuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LmVmZmVjdHMuY29yZS5qc1xuICovXG4oZnVuY3Rpb24oZSl7ZS5lZmZlY3RzLmJvdW5jZT1mdW5jdGlvbihiKXtyZXR1cm4gdGhpcy5xdWV1ZShmdW5jdGlvbigpe3ZhciBhPWUodGhpcyksbD1bXCJwb3NpdGlvblwiLFwidG9wXCIsXCJib3R0b21cIixcImxlZnRcIixcInJpZ2h0XCJdLGg9ZS5lZmZlY3RzLnNldE1vZGUoYSxiLm9wdGlvbnMubW9kZXx8XCJlZmZlY3RcIiksZD1iLm9wdGlvbnMuZGlyZWN0aW9ufHxcInVwXCIsYz1iLm9wdGlvbnMuZGlzdGFuY2V8fDIwLG09Yi5vcHRpb25zLnRpbWVzfHw1LGk9Yi5kdXJhdGlvbnx8MjUwOy9zaG93fGhpZGUvLnRlc3QoaCkmJmwucHVzaChcIm9wYWNpdHlcIik7ZS5lZmZlY3RzLnNhdmUoYSxsKTthLnNob3coKTtlLmVmZmVjdHMuY3JlYXRlV3JhcHBlcihhKTt2YXIgZj1kPT1cInVwXCJ8fGQ9PVwiZG93blwiP1widG9wXCI6XCJsZWZ0XCI7ZD1kPT1cInVwXCJ8fGQ9PVwibGVmdFwiP1wicG9zXCI6XCJuZWdcIjtjPWIub3B0aW9ucy5kaXN0YW5jZXx8KGY9PVwidG9wXCI/YS5vdXRlckhlaWdodCh7bWFyZ2luOnRydWV9KS8zOmEub3V0ZXJXaWR0aCh7bWFyZ2luOnRydWV9KS9cbjMpO2lmKGg9PVwic2hvd1wiKWEuY3NzKFwib3BhY2l0eVwiLDApLmNzcyhmLGQ9PVwicG9zXCI/LWM6Yyk7aWYoaD09XCJoaWRlXCIpYy89bSoyO2ghPVwiaGlkZVwiJiZtLS07aWYoaD09XCJzaG93XCIpe3ZhciBnPXtvcGFjaXR5OjF9O2dbZl09KGQ9PVwicG9zXCI/XCIrPVwiOlwiLT1cIikrYzthLmFuaW1hdGUoZyxpLzIsYi5vcHRpb25zLmVhc2luZyk7Yy89MjttLS19Zm9yKGc9MDtnPG07ZysrKXt2YXIgaj17fSxrPXt9O2pbZl09KGQ9PVwicG9zXCI/XCItPVwiOlwiKz1cIikrYztrW2ZdPShkPT1cInBvc1wiP1wiKz1cIjpcIi09XCIpK2M7YS5hbmltYXRlKGosaS8yLGIub3B0aW9ucy5lYXNpbmcpLmFuaW1hdGUoayxpLzIsYi5vcHRpb25zLmVhc2luZyk7Yz1oPT1cImhpZGVcIj9jKjI6Yy8yfWlmKGg9PVwiaGlkZVwiKXtnPXtvcGFjaXR5OjB9O2dbZl09KGQ9PVwicG9zXCI/XCItPVwiOlwiKz1cIikrYzthLmFuaW1hdGUoZyxpLzIsYi5vcHRpb25zLmVhc2luZyxmdW5jdGlvbigpe2EuaGlkZSgpO2UuZWZmZWN0cy5yZXN0b3JlKGEsbCk7ZS5lZmZlY3RzLnJlbW92ZVdyYXBwZXIoYSk7XG5iLmNhbGxiYWNrJiZiLmNhbGxiYWNrLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pfWVsc2V7aj17fTtrPXt9O2pbZl09KGQ9PVwicG9zXCI/XCItPVwiOlwiKz1cIikrYztrW2ZdPShkPT1cInBvc1wiP1wiKz1cIjpcIi09XCIpK2M7YS5hbmltYXRlKGosaS8yLGIub3B0aW9ucy5lYXNpbmcpLmFuaW1hdGUoayxpLzIsYi5vcHRpb25zLmVhc2luZyxmdW5jdGlvbigpe2UuZWZmZWN0cy5yZXN0b3JlKGEsbCk7ZS5lZmZlY3RzLnJlbW92ZVdyYXBwZXIoYSk7Yi5jYWxsYmFjayYmYi5jYWxsYmFjay5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KX1hLnF1ZXVlKFwiZnhcIixmdW5jdGlvbigpe2EuZGVxdWV1ZSgpfSk7YS5kZXF1ZXVlKCl9KX19KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBFZmZlY3RzIENsaXAgMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvRWZmZWN0cy9DbGlwXG4gKlxuICogRGVwZW5kczpcbiAqXHRqcXVlcnkuZWZmZWN0cy5jb3JlLmpzXG4gKi9cbihmdW5jdGlvbihiKXtiLmVmZmVjdHMuY2xpcD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5xdWV1ZShmdW5jdGlvbigpe3ZhciBhPWIodGhpcyksaT1bXCJwb3NpdGlvblwiLFwidG9wXCIsXCJib3R0b21cIixcImxlZnRcIixcInJpZ2h0XCIsXCJoZWlnaHRcIixcIndpZHRoXCJdLGY9Yi5lZmZlY3RzLnNldE1vZGUoYSxlLm9wdGlvbnMubW9kZXx8XCJoaWRlXCIpLGM9ZS5vcHRpb25zLmRpcmVjdGlvbnx8XCJ2ZXJ0aWNhbFwiO2IuZWZmZWN0cy5zYXZlKGEsaSk7YS5zaG93KCk7dmFyIGQ9Yi5lZmZlY3RzLmNyZWF0ZVdyYXBwZXIoYSkuY3NzKHtvdmVyZmxvdzpcImhpZGRlblwifSk7ZD1hWzBdLnRhZ05hbWU9PVwiSU1HXCI/ZDphO3ZhciBnPXtzaXplOmM9PVwidmVydGljYWxcIj9cImhlaWdodFwiOlwid2lkdGhcIixwb3NpdGlvbjpjPT1cInZlcnRpY2FsXCI/XCJ0b3BcIjpcImxlZnRcIn07Yz1jPT1cInZlcnRpY2FsXCI/ZC5oZWlnaHQoKTpkLndpZHRoKCk7aWYoZj09XCJzaG93XCIpe2QuY3NzKGcuc2l6ZSwwKTtkLmNzcyhnLnBvc2l0aW9uLFxuYy8yKX12YXIgaD17fTtoW2cuc2l6ZV09Zj09XCJzaG93XCI/YzowO2hbZy5wb3NpdGlvbl09Zj09XCJzaG93XCI/MDpjLzI7ZC5hbmltYXRlKGgse3F1ZXVlOmZhbHNlLGR1cmF0aW9uOmUuZHVyYXRpb24sZWFzaW5nOmUub3B0aW9ucy5lYXNpbmcsY29tcGxldGU6ZnVuY3Rpb24oKXtmPT1cImhpZGVcIiYmYS5oaWRlKCk7Yi5lZmZlY3RzLnJlc3RvcmUoYSxpKTtiLmVmZmVjdHMucmVtb3ZlV3JhcHBlcihhKTtlLmNhbGxiYWNrJiZlLmNhbGxiYWNrLmFwcGx5KGFbMF0sYXJndW1lbnRzKTthLmRlcXVldWUoKX19KX0pfX0pKGpRdWVyeSk7XG47LypcbiAqIE5vdGU6IFdoaWxlIE1pY3Jvc29mdCBpcyBub3QgdGhlIGF1dGhvciBvZiB0aGlzIGZpbGUsIE1pY3Jvc29mdCBpc1xuICogb2ZmZXJpbmcgeW91IGEgbGljZW5zZSBzdWJqZWN0IHRvIHRoZSB0ZXJtcyBvZiB0aGUgTWljcm9zb2Z0IFNvZnR3YXJlXG4gKiBMaWNlbnNlIFRlcm1zIGZvciBNaWNyb3NvZnQgQVNQLk5FVCBNb2RlbCBWaWV3IENvbnRyb2xsZXIgMy5cbiAqIE1pY3Jvc29mdCByZXNlcnZlcyBhbGwgb3RoZXIgcmlnaHRzLiBUaGUgbm90aWNlcyBiZWxvdyBhcmUgcHJvdmlkZWRcbiAqIGZvciBpbmZvcm1hdGlvbmFsIHB1cnBvc2VzIG9ubHkgYW5kIGFyZSBub3QgdGhlIGxpY2Vuc2UgdGVybXMgdW5kZXJcbiAqIHdoaWNoIE1pY3Jvc29mdCBkaXN0cmlidXRlZCB0aGlzIGZpbGUuXG4gKlxuICogalF1ZXJ5IFVJIEVmZmVjdHMgRHJvcCAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXG4gKlxuICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9FZmZlY3RzL0Ryb3BcbiAqXG4gKiBEZXBlbmRzOlxuICpcdGpxdWVyeS5lZmZlY3RzLmNvcmUuanNcbiAqL1xuKGZ1bmN0aW9uKGMpe2MuZWZmZWN0cy5kcm9wPWZ1bmN0aW9uKGQpe3JldHVybiB0aGlzLnF1ZXVlKGZ1bmN0aW9uKCl7dmFyIGE9Yyh0aGlzKSxoPVtcInBvc2l0aW9uXCIsXCJ0b3BcIixcImJvdHRvbVwiLFwibGVmdFwiLFwicmlnaHRcIixcIm9wYWNpdHlcIl0sZT1jLmVmZmVjdHMuc2V0TW9kZShhLGQub3B0aW9ucy5tb2RlfHxcImhpZGVcIiksYj1kLm9wdGlvbnMuZGlyZWN0aW9ufHxcImxlZnRcIjtjLmVmZmVjdHMuc2F2ZShhLGgpO2Euc2hvdygpO2MuZWZmZWN0cy5jcmVhdGVXcmFwcGVyKGEpO3ZhciBmPWI9PVwidXBcInx8Yj09XCJkb3duXCI/XCJ0b3BcIjpcImxlZnRcIjtiPWI9PVwidXBcInx8Yj09XCJsZWZ0XCI/XCJwb3NcIjpcIm5lZ1wiO3ZhciBnPWQub3B0aW9ucy5kaXN0YW5jZXx8KGY9PVwidG9wXCI/YS5vdXRlckhlaWdodCh7bWFyZ2luOnRydWV9KS8yOmEub3V0ZXJXaWR0aCh7bWFyZ2luOnRydWV9KS8yKTtpZihlPT1cInNob3dcIilhLmNzcyhcIm9wYWNpdHlcIiwwKS5jc3MoZixiPT1cInBvc1wiPy1nOmcpO3ZhciBpPXtvcGFjaXR5OmU9PVxuXCJzaG93XCI/MTowfTtpW2ZdPShlPT1cInNob3dcIj9iPT1cInBvc1wiP1wiKz1cIjpcIi09XCI6Yj09XCJwb3NcIj9cIi09XCI6XCIrPVwiKStnO2EuYW5pbWF0ZShpLHtxdWV1ZTpmYWxzZSxkdXJhdGlvbjpkLmR1cmF0aW9uLGVhc2luZzpkLm9wdGlvbnMuZWFzaW5nLGNvbXBsZXRlOmZ1bmN0aW9uKCl7ZT09XCJoaWRlXCImJmEuaGlkZSgpO2MuZWZmZWN0cy5yZXN0b3JlKGEsaCk7Yy5lZmZlY3RzLnJlbW92ZVdyYXBwZXIoYSk7ZC5jYWxsYmFjayYmZC5jYWxsYmFjay5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YS5kZXF1ZXVlKCl9fSl9KX19KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBFZmZlY3RzIEV4cGxvZGUgMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvRWZmZWN0cy9FeHBsb2RlXG4gKlxuICogRGVwZW5kczpcbiAqXHRqcXVlcnkuZWZmZWN0cy5jb3JlLmpzXG4gKi9cbihmdW5jdGlvbihqKXtqLmVmZmVjdHMuZXhwbG9kZT1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShmdW5jdGlvbigpe3ZhciBjPWEub3B0aW9ucy5waWVjZXM/TWF0aC5yb3VuZChNYXRoLnNxcnQoYS5vcHRpb25zLnBpZWNlcykpOjMsZD1hLm9wdGlvbnMucGllY2VzP01hdGgucm91bmQoTWF0aC5zcXJ0KGEub3B0aW9ucy5waWVjZXMpKTozO2Eub3B0aW9ucy5tb2RlPWEub3B0aW9ucy5tb2RlPT1cInRvZ2dsZVwiP2oodGhpcykuaXMoXCI6dmlzaWJsZVwiKT9cImhpZGVcIjpcInNob3dcIjphLm9wdGlvbnMubW9kZTt2YXIgYj1qKHRoaXMpLnNob3coKS5jc3MoXCJ2aXNpYmlsaXR5XCIsXCJoaWRkZW5cIiksZz1iLm9mZnNldCgpO2cudG9wLT1wYXJzZUludChiLmNzcyhcIm1hcmdpblRvcFwiKSwxMCl8fDA7Zy5sZWZ0LT1wYXJzZUludChiLmNzcyhcIm1hcmdpbkxlZnRcIiksMTApfHwwO2Zvcih2YXIgaD1iLm91dGVyV2lkdGgodHJ1ZSksaT1iLm91dGVySGVpZ2h0KHRydWUpLGU9MDtlPGM7ZSsrKWZvcih2YXIgZj1cbjA7ZjxkO2YrKyliLmNsb25lKCkuYXBwZW5kVG8oXCJib2R5XCIpLndyYXAoXCI8ZGl2PjwvZGl2PlwiKS5jc3Moe3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix2aXNpYmlsaXR5OlwidmlzaWJsZVwiLGxlZnQ6LWYqKGgvZCksdG9wOi1lKihpL2MpfSkucGFyZW50KCkuYWRkQ2xhc3MoXCJ1aS1lZmZlY3RzLWV4cGxvZGVcIikuY3NzKHtwb3NpdGlvbjpcImFic29sdXRlXCIsb3ZlcmZsb3c6XCJoaWRkZW5cIix3aWR0aDpoL2QsaGVpZ2h0OmkvYyxsZWZ0OmcubGVmdCtmKihoL2QpKyhhLm9wdGlvbnMubW9kZT09XCJzaG93XCI/KGYtTWF0aC5mbG9vcihkLzIpKSooaC9kKTowKSx0b3A6Zy50b3ArZSooaS9jKSsoYS5vcHRpb25zLm1vZGU9PVwic2hvd1wiPyhlLU1hdGguZmxvb3IoYy8yKSkqKGkvYyk6MCksb3BhY2l0eTphLm9wdGlvbnMubW9kZT09XCJzaG93XCI/MDoxfSkuYW5pbWF0ZSh7bGVmdDpnLmxlZnQrZiooaC9kKSsoYS5vcHRpb25zLm1vZGU9PVwic2hvd1wiPzA6KGYtTWF0aC5mbG9vcihkLzIpKSooaC9kKSksdG9wOmcudG9wK1xuZSooaS9jKSsoYS5vcHRpb25zLm1vZGU9PVwic2hvd1wiPzA6KGUtTWF0aC5mbG9vcihjLzIpKSooaS9jKSksb3BhY2l0eTphLm9wdGlvbnMubW9kZT09XCJzaG93XCI/MTowfSxhLmR1cmF0aW9ufHw1MDApO3NldFRpbWVvdXQoZnVuY3Rpb24oKXthLm9wdGlvbnMubW9kZT09XCJzaG93XCI/Yi5jc3Moe3Zpc2liaWxpdHk6XCJ2aXNpYmxlXCJ9KTpiLmNzcyh7dmlzaWJpbGl0eTpcInZpc2libGVcIn0pLmhpZGUoKTthLmNhbGxiYWNrJiZhLmNhbGxiYWNrLmFwcGx5KGJbMF0pO2IuZGVxdWV1ZSgpO2ooXCJkaXYudWktZWZmZWN0cy1leHBsb2RlXCIpLnJlbW92ZSgpfSxhLmR1cmF0aW9ufHw1MDApfSl9fSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgRWZmZWN0cyBGYWRlIDEuOC4xMVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL0VmZmVjdHMvRmFkZVxuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LmVmZmVjdHMuY29yZS5qc1xuICovXG4oZnVuY3Rpb24oYil7Yi5lZmZlY3RzLmZhZGU9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucXVldWUoZnVuY3Rpb24oKXt2YXIgYz1iKHRoaXMpLGQ9Yi5lZmZlY3RzLnNldE1vZGUoYyxhLm9wdGlvbnMubW9kZXx8XCJoaWRlXCIpO2MuYW5pbWF0ZSh7b3BhY2l0eTpkfSx7cXVldWU6ZmFsc2UsZHVyYXRpb246YS5kdXJhdGlvbixlYXNpbmc6YS5vcHRpb25zLmVhc2luZyxjb21wbGV0ZTpmdW5jdGlvbigpe2EuY2FsbGJhY2smJmEuY2FsbGJhY2suYXBwbHkodGhpcyxhcmd1bWVudHMpO2MuZGVxdWV1ZSgpfX0pfSl9fSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgRWZmZWN0cyBGb2xkIDEuOC4xMVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL0VmZmVjdHMvRm9sZFxuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LmVmZmVjdHMuY29yZS5qc1xuICovXG4oZnVuY3Rpb24oYyl7Yy5lZmZlY3RzLmZvbGQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucXVldWUoZnVuY3Rpb24oKXt2YXIgYj1jKHRoaXMpLGo9W1wicG9zaXRpb25cIixcInRvcFwiLFwiYm90dG9tXCIsXCJsZWZ0XCIsXCJyaWdodFwiXSxkPWMuZWZmZWN0cy5zZXRNb2RlKGIsYS5vcHRpb25zLm1vZGV8fFwiaGlkZVwiKSxnPWEub3B0aW9ucy5zaXplfHwxNSxoPSEhYS5vcHRpb25zLmhvcml6Rmlyc3Qsaz1hLmR1cmF0aW9uP2EuZHVyYXRpb24vMjpjLmZ4LnNwZWVkcy5fZGVmYXVsdC8yO2MuZWZmZWN0cy5zYXZlKGIsaik7Yi5zaG93KCk7dmFyIGU9Yy5lZmZlY3RzLmNyZWF0ZVdyYXBwZXIoYikuY3NzKHtvdmVyZmxvdzpcImhpZGRlblwifSksZj1kPT1cInNob3dcIiE9aCxsPWY/W1wid2lkdGhcIixcImhlaWdodFwiXTpbXCJoZWlnaHRcIixcIndpZHRoXCJdO2Y9Zj9bZS53aWR0aCgpLGUuaGVpZ2h0KCldOltlLmhlaWdodCgpLGUud2lkdGgoKV07dmFyIGk9LyhbMC05XSspJS8uZXhlYyhnKTtpZihpKWc9cGFyc2VJbnQoaVsxXSxcbjEwKS8xMDAqZltkPT1cImhpZGVcIj8wOjFdO2lmKGQ9PVwic2hvd1wiKWUuY3NzKGg/e2hlaWdodDowLHdpZHRoOmd9OntoZWlnaHQ6Zyx3aWR0aDowfSk7aD17fTtpPXt9O2hbbFswXV09ZD09XCJzaG93XCI/ZlswXTpnO2lbbFsxXV09ZD09XCJzaG93XCI/ZlsxXTowO2UuYW5pbWF0ZShoLGssYS5vcHRpb25zLmVhc2luZykuYW5pbWF0ZShpLGssYS5vcHRpb25zLmVhc2luZyxmdW5jdGlvbigpe2Q9PVwiaGlkZVwiJiZiLmhpZGUoKTtjLmVmZmVjdHMucmVzdG9yZShiLGopO2MuZWZmZWN0cy5yZW1vdmVXcmFwcGVyKGIpO2EuY2FsbGJhY2smJmEuY2FsbGJhY2suYXBwbHkoYlswXSxhcmd1bWVudHMpO2IuZGVxdWV1ZSgpfSl9KX19KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBFZmZlY3RzIEhpZ2hsaWdodCAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXG4gKlxuICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9FZmZlY3RzL0hpZ2hsaWdodFxuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LmVmZmVjdHMuY29yZS5qc1xuICovXG4oZnVuY3Rpb24oYil7Yi5lZmZlY3RzLmhpZ2hsaWdodD1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5xdWV1ZShmdW5jdGlvbigpe3ZhciBhPWIodGhpcyksZT1bXCJiYWNrZ3JvdW5kSW1hZ2VcIixcImJhY2tncm91bmRDb2xvclwiLFwib3BhY2l0eVwiXSxkPWIuZWZmZWN0cy5zZXRNb2RlKGEsYy5vcHRpb25zLm1vZGV8fFwic2hvd1wiKSxmPXtiYWNrZ3JvdW5kQ29sb3I6YS5jc3MoXCJiYWNrZ3JvdW5kQ29sb3JcIil9O2lmKGQ9PVwiaGlkZVwiKWYub3BhY2l0eT0wO2IuZWZmZWN0cy5zYXZlKGEsZSk7YS5zaG93KCkuY3NzKHtiYWNrZ3JvdW5kSW1hZ2U6XCJub25lXCIsYmFja2dyb3VuZENvbG9yOmMub3B0aW9ucy5jb2xvcnx8XCIjZmZmZjk5XCJ9KS5hbmltYXRlKGYse3F1ZXVlOmZhbHNlLGR1cmF0aW9uOmMuZHVyYXRpb24sZWFzaW5nOmMub3B0aW9ucy5lYXNpbmcsY29tcGxldGU6ZnVuY3Rpb24oKXtkPT1cImhpZGVcIiYmYS5oaWRlKCk7Yi5lZmZlY3RzLnJlc3RvcmUoYSxlKTtkPT1cInNob3dcIiYmIWIuc3VwcG9ydC5vcGFjaXR5JiZcbnRoaXMuc3R5bGUucmVtb3ZlQXR0cmlidXRlKFwiZmlsdGVyXCIpO2MuY2FsbGJhY2smJmMuY2FsbGJhY2suYXBwbHkodGhpcyxhcmd1bWVudHMpO2EuZGVxdWV1ZSgpfX0pfSl9fSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgRWZmZWN0cyBQdWxzYXRlIDEuOC4xMVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL0VmZmVjdHMvUHVsc2F0ZVxuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LmVmZmVjdHMuY29yZS5qc1xuICovXG4oZnVuY3Rpb24oZCl7ZC5lZmZlY3RzLnB1bHNhdGU9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucXVldWUoZnVuY3Rpb24oKXt2YXIgYj1kKHRoaXMpLGM9ZC5lZmZlY3RzLnNldE1vZGUoYixhLm9wdGlvbnMubW9kZXx8XCJzaG93XCIpO3RpbWVzPShhLm9wdGlvbnMudGltZXN8fDUpKjItMTtkdXJhdGlvbj1hLmR1cmF0aW9uP2EuZHVyYXRpb24vMjpkLmZ4LnNwZWVkcy5fZGVmYXVsdC8yO2lzVmlzaWJsZT1iLmlzKFwiOnZpc2libGVcIik7YW5pbWF0ZVRvPTA7aWYoIWlzVmlzaWJsZSl7Yi5jc3MoXCJvcGFjaXR5XCIsMCkuc2hvdygpO2FuaW1hdGVUbz0xfWlmKGM9PVwiaGlkZVwiJiZpc1Zpc2libGV8fGM9PVwic2hvd1wiJiYhaXNWaXNpYmxlKXRpbWVzLS07Zm9yKGM9MDtjPHRpbWVzO2MrKyl7Yi5hbmltYXRlKHtvcGFjaXR5OmFuaW1hdGVUb30sZHVyYXRpb24sYS5vcHRpb25zLmVhc2luZyk7YW5pbWF0ZVRvPShhbmltYXRlVG8rMSklMn1iLmFuaW1hdGUoe29wYWNpdHk6YW5pbWF0ZVRvfSxkdXJhdGlvbixcbmEub3B0aW9ucy5lYXNpbmcsZnVuY3Rpb24oKXthbmltYXRlVG89PTAmJmIuaGlkZSgpO2EuY2FsbGJhY2smJmEuY2FsbGJhY2suYXBwbHkodGhpcyxhcmd1bWVudHMpfSk7Yi5xdWV1ZShcImZ4XCIsZnVuY3Rpb24oKXtiLmRlcXVldWUoKX0pLmRlcXVldWUoKX0pfX0pKGpRdWVyeSk7XG47LypcbiAqIE5vdGU6IFdoaWxlIE1pY3Jvc29mdCBpcyBub3QgdGhlIGF1dGhvciBvZiB0aGlzIGZpbGUsIE1pY3Jvc29mdCBpc1xuICogb2ZmZXJpbmcgeW91IGEgbGljZW5zZSBzdWJqZWN0IHRvIHRoZSB0ZXJtcyBvZiB0aGUgTWljcm9zb2Z0IFNvZnR3YXJlXG4gKiBMaWNlbnNlIFRlcm1zIGZvciBNaWNyb3NvZnQgQVNQLk5FVCBNb2RlbCBWaWV3IENvbnRyb2xsZXIgMy5cbiAqIE1pY3Jvc29mdCByZXNlcnZlcyBhbGwgb3RoZXIgcmlnaHRzLiBUaGUgbm90aWNlcyBiZWxvdyBhcmUgcHJvdmlkZWRcbiAqIGZvciBpbmZvcm1hdGlvbmFsIHB1cnBvc2VzIG9ubHkgYW5kIGFyZSBub3QgdGhlIGxpY2Vuc2UgdGVybXMgdW5kZXJcbiAqIHdoaWNoIE1pY3Jvc29mdCBkaXN0cmlidXRlZCB0aGlzIGZpbGUuXG4gKlxuICogalF1ZXJ5IFVJIEVmZmVjdHMgU2NhbGUgMS44LjExXG4gKlxuICogQ29weXJpZ2h0IDIwMTEsIEFVVEhPUlMudHh0IChodHRwOi8vanF1ZXJ5dWkuY29tL2Fib3V0KVxuICpcbiAqIGh0dHA6Ly9kb2NzLmpxdWVyeS5jb20vVUkvRWZmZWN0cy9TY2FsZVxuICpcbiAqIERlcGVuZHM6XG4gKlx0anF1ZXJ5LmVmZmVjdHMuY29yZS5qc1xuICovXG4oZnVuY3Rpb24oYyl7Yy5lZmZlY3RzLnB1ZmY9ZnVuY3Rpb24oYil7cmV0dXJuIHRoaXMucXVldWUoZnVuY3Rpb24oKXt2YXIgYT1jKHRoaXMpLGU9Yy5lZmZlY3RzLnNldE1vZGUoYSxiLm9wdGlvbnMubW9kZXx8XCJoaWRlXCIpLGc9cGFyc2VJbnQoYi5vcHRpb25zLnBlcmNlbnQsMTApfHwxNTAsaD1nLzEwMCxpPXtoZWlnaHQ6YS5oZWlnaHQoKSx3aWR0aDphLndpZHRoKCl9O2MuZXh0ZW5kKGIub3B0aW9ucyx7ZmFkZTp0cnVlLG1vZGU6ZSxwZXJjZW50OmU9PVwiaGlkZVwiP2c6MTAwLGZyb206ZT09XCJoaWRlXCI/aTp7aGVpZ2h0OmkuaGVpZ2h0Kmgsd2lkdGg6aS53aWR0aCpofX0pO2EuZWZmZWN0KFwic2NhbGVcIixiLm9wdGlvbnMsYi5kdXJhdGlvbixiLmNhbGxiYWNrKTthLmRlcXVldWUoKX0pfTtjLmVmZmVjdHMuc2NhbGU9ZnVuY3Rpb24oYil7cmV0dXJuIHRoaXMucXVldWUoZnVuY3Rpb24oKXt2YXIgYT1jKHRoaXMpLGU9Yy5leHRlbmQodHJ1ZSx7fSxiLm9wdGlvbnMpLGc9Yy5lZmZlY3RzLnNldE1vZGUoYSxcbmIub3B0aW9ucy5tb2RlfHxcImVmZmVjdFwiKSxoPXBhcnNlSW50KGIub3B0aW9ucy5wZXJjZW50LDEwKXx8KHBhcnNlSW50KGIub3B0aW9ucy5wZXJjZW50LDEwKT09MD8wOmc9PVwiaGlkZVwiPzA6MTAwKSxpPWIub3B0aW9ucy5kaXJlY3Rpb258fFwiYm90aFwiLGY9Yi5vcHRpb25zLm9yaWdpbjtpZihnIT1cImVmZmVjdFwiKXtlLm9yaWdpbj1mfHxbXCJtaWRkbGVcIixcImNlbnRlclwiXTtlLnJlc3RvcmU9dHJ1ZX1mPXtoZWlnaHQ6YS5oZWlnaHQoKSx3aWR0aDphLndpZHRoKCl9O2EuZnJvbT1iLm9wdGlvbnMuZnJvbXx8KGc9PVwic2hvd1wiP3toZWlnaHQ6MCx3aWR0aDowfTpmKTtoPXt5OmkhPVwiaG9yaXpvbnRhbFwiP2gvMTAwOjEseDppIT1cInZlcnRpY2FsXCI/aC8xMDA6MX07YS50bz17aGVpZ2h0OmYuaGVpZ2h0KmgueSx3aWR0aDpmLndpZHRoKmgueH07aWYoYi5vcHRpb25zLmZhZGUpe2lmKGc9PVwic2hvd1wiKXthLmZyb20ub3BhY2l0eT0wO2EudG8ub3BhY2l0eT0xfWlmKGc9PVwiaGlkZVwiKXthLmZyb20ub3BhY2l0eT1cbjE7YS50by5vcGFjaXR5PTB9fWUuZnJvbT1hLmZyb207ZS50bz1hLnRvO2UubW9kZT1nO2EuZWZmZWN0KFwic2l6ZVwiLGUsYi5kdXJhdGlvbixiLmNhbGxiYWNrKTthLmRlcXVldWUoKX0pfTtjLmVmZmVjdHMuc2l6ZT1mdW5jdGlvbihiKXtyZXR1cm4gdGhpcy5xdWV1ZShmdW5jdGlvbigpe3ZhciBhPWModGhpcyksZT1bXCJwb3NpdGlvblwiLFwidG9wXCIsXCJib3R0b21cIixcImxlZnRcIixcInJpZ2h0XCIsXCJ3aWR0aFwiLFwiaGVpZ2h0XCIsXCJvdmVyZmxvd1wiLFwib3BhY2l0eVwiXSxnPVtcInBvc2l0aW9uXCIsXCJ0b3BcIixcImJvdHRvbVwiLFwibGVmdFwiLFwicmlnaHRcIixcIm92ZXJmbG93XCIsXCJvcGFjaXR5XCJdLGg9W1wid2lkdGhcIixcImhlaWdodFwiLFwib3ZlcmZsb3dcIl0saT1bXCJmb250U2l6ZVwiXSxmPVtcImJvcmRlclRvcFdpZHRoXCIsXCJib3JkZXJCb3R0b21XaWR0aFwiLFwicGFkZGluZ1RvcFwiLFwicGFkZGluZ0JvdHRvbVwiXSxrPVtcImJvcmRlckxlZnRXaWR0aFwiLFwiYm9yZGVyUmlnaHRXaWR0aFwiLFwicGFkZGluZ0xlZnRcIixcInBhZGRpbmdSaWdodFwiXSxcbnA9Yy5lZmZlY3RzLnNldE1vZGUoYSxiLm9wdGlvbnMubW9kZXx8XCJlZmZlY3RcIiksbj1iLm9wdGlvbnMucmVzdG9yZXx8ZmFsc2UsbT1iLm9wdGlvbnMuc2NhbGV8fFwiYm90aFwiLGw9Yi5vcHRpb25zLm9yaWdpbixqPXtoZWlnaHQ6YS5oZWlnaHQoKSx3aWR0aDphLndpZHRoKCl9O2EuZnJvbT1iLm9wdGlvbnMuZnJvbXx8ajthLnRvPWIub3B0aW9ucy50b3x8ajtpZihsKXtsPWMuZWZmZWN0cy5nZXRCYXNlbGluZShsLGopO2EuZnJvbS50b3A9KGouaGVpZ2h0LWEuZnJvbS5oZWlnaHQpKmwueTthLmZyb20ubGVmdD0oai53aWR0aC1hLmZyb20ud2lkdGgpKmwueDthLnRvLnRvcD0oai5oZWlnaHQtYS50by5oZWlnaHQpKmwueTthLnRvLmxlZnQ9KGoud2lkdGgtYS50by53aWR0aCkqbC54fXZhciBkPXtmcm9tOnt5OmEuZnJvbS5oZWlnaHQvai5oZWlnaHQseDphLmZyb20ud2lkdGgvai53aWR0aH0sdG86e3k6YS50by5oZWlnaHQvai5oZWlnaHQseDphLnRvLndpZHRoL2oud2lkdGh9fTtcbmlmKG09PVwiYm94XCJ8fG09PVwiYm90aFwiKXtpZihkLmZyb20ueSE9ZC50by55KXtlPWUuY29uY2F0KGYpO2EuZnJvbT1jLmVmZmVjdHMuc2V0VHJhbnNpdGlvbihhLGYsZC5mcm9tLnksYS5mcm9tKTthLnRvPWMuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKGEsZixkLnRvLnksYS50byl9aWYoZC5mcm9tLnghPWQudG8ueCl7ZT1lLmNvbmNhdChrKTthLmZyb209Yy5lZmZlY3RzLnNldFRyYW5zaXRpb24oYSxrLGQuZnJvbS54LGEuZnJvbSk7YS50bz1jLmVmZmVjdHMuc2V0VHJhbnNpdGlvbihhLGssZC50by54LGEudG8pfX1pZihtPT1cImNvbnRlbnRcInx8bT09XCJib3RoXCIpaWYoZC5mcm9tLnkhPWQudG8ueSl7ZT1lLmNvbmNhdChpKTthLmZyb209Yy5lZmZlY3RzLnNldFRyYW5zaXRpb24oYSxpLGQuZnJvbS55LGEuZnJvbSk7YS50bz1jLmVmZmVjdHMuc2V0VHJhbnNpdGlvbihhLGksZC50by55LGEudG8pfWMuZWZmZWN0cy5zYXZlKGEsbj9lOmcpO2Euc2hvdygpO2MuZWZmZWN0cy5jcmVhdGVXcmFwcGVyKGEpO1xuYS5jc3MoXCJvdmVyZmxvd1wiLFwiaGlkZGVuXCIpLmNzcyhhLmZyb20pO2lmKG09PVwiY29udGVudFwifHxtPT1cImJvdGhcIil7Zj1mLmNvbmNhdChbXCJtYXJnaW5Ub3BcIixcIm1hcmdpbkJvdHRvbVwiXSkuY29uY2F0KGkpO2s9ay5jb25jYXQoW1wibWFyZ2luTGVmdFwiLFwibWFyZ2luUmlnaHRcIl0pO2g9ZS5jb25jYXQoZikuY29uY2F0KGspO2EuZmluZChcIipbd2lkdGhdXCIpLmVhY2goZnVuY3Rpb24oKXtjaGlsZD1jKHRoaXMpO24mJmMuZWZmZWN0cy5zYXZlKGNoaWxkLGgpO3ZhciBvPXtoZWlnaHQ6Y2hpbGQuaGVpZ2h0KCksd2lkdGg6Y2hpbGQud2lkdGgoKX07Y2hpbGQuZnJvbT17aGVpZ2h0Om8uaGVpZ2h0KmQuZnJvbS55LHdpZHRoOm8ud2lkdGgqZC5mcm9tLnh9O2NoaWxkLnRvPXtoZWlnaHQ6by5oZWlnaHQqZC50by55LHdpZHRoOm8ud2lkdGgqZC50by54fTtpZihkLmZyb20ueSE9ZC50by55KXtjaGlsZC5mcm9tPWMuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKGNoaWxkLGYsZC5mcm9tLnksY2hpbGQuZnJvbSk7XG5jaGlsZC50bz1jLmVmZmVjdHMuc2V0VHJhbnNpdGlvbihjaGlsZCxmLGQudG8ueSxjaGlsZC50byl9aWYoZC5mcm9tLnghPWQudG8ueCl7Y2hpbGQuZnJvbT1jLmVmZmVjdHMuc2V0VHJhbnNpdGlvbihjaGlsZCxrLGQuZnJvbS54LGNoaWxkLmZyb20pO2NoaWxkLnRvPWMuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKGNoaWxkLGssZC50by54LGNoaWxkLnRvKX1jaGlsZC5jc3MoY2hpbGQuZnJvbSk7Y2hpbGQuYW5pbWF0ZShjaGlsZC50byxiLmR1cmF0aW9uLGIub3B0aW9ucy5lYXNpbmcsZnVuY3Rpb24oKXtuJiZjLmVmZmVjdHMucmVzdG9yZShjaGlsZCxoKX0pfSl9YS5hbmltYXRlKGEudG8se3F1ZXVlOmZhbHNlLGR1cmF0aW9uOmIuZHVyYXRpb24sZWFzaW5nOmIub3B0aW9ucy5lYXNpbmcsY29tcGxldGU6ZnVuY3Rpb24oKXthLnRvLm9wYWNpdHk9PT0wJiZhLmNzcyhcIm9wYWNpdHlcIixhLmZyb20ub3BhY2l0eSk7cD09XCJoaWRlXCImJmEuaGlkZSgpO2MuZWZmZWN0cy5yZXN0b3JlKGEsXG5uP2U6Zyk7Yy5lZmZlY3RzLnJlbW92ZVdyYXBwZXIoYSk7Yi5jYWxsYmFjayYmYi5jYWxsYmFjay5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YS5kZXF1ZXVlKCl9fSl9KX19KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBFZmZlY3RzIFNoYWtlIDEuOC4xMVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL0VmZmVjdHMvU2hha2VcbiAqXG4gKiBEZXBlbmRzOlxuICpcdGpxdWVyeS5lZmZlY3RzLmNvcmUuanNcbiAqL1xuKGZ1bmN0aW9uKGQpe2QuZWZmZWN0cy5zaGFrZT1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShmdW5jdGlvbigpe3ZhciBiPWQodGhpcyksaj1bXCJwb3NpdGlvblwiLFwidG9wXCIsXCJib3R0b21cIixcImxlZnRcIixcInJpZ2h0XCJdO2QuZWZmZWN0cy5zZXRNb2RlKGIsYS5vcHRpb25zLm1vZGV8fFwiZWZmZWN0XCIpO3ZhciBjPWEub3B0aW9ucy5kaXJlY3Rpb258fFwibGVmdFwiLGU9YS5vcHRpb25zLmRpc3RhbmNlfHwyMCxsPWEub3B0aW9ucy50aW1lc3x8MyxmPWEuZHVyYXRpb258fGEub3B0aW9ucy5kdXJhdGlvbnx8MTQwO2QuZWZmZWN0cy5zYXZlKGIsaik7Yi5zaG93KCk7ZC5lZmZlY3RzLmNyZWF0ZVdyYXBwZXIoYik7dmFyIGc9Yz09XCJ1cFwifHxjPT1cImRvd25cIj9cInRvcFwiOlwibGVmdFwiLGg9Yz09XCJ1cFwifHxjPT1cImxlZnRcIj9cInBvc1wiOlwibmVnXCI7Yz17fTt2YXIgaT17fSxrPXt9O2NbZ109KGg9PVwicG9zXCI/XCItPVwiOlwiKz1cIikrZTtpW2ddPShoPT1cInBvc1wiP1wiKz1cIjpcIi09XCIpK2UqMjtrW2ddPVxuKGg9PVwicG9zXCI/XCItPVwiOlwiKz1cIikrZSoyO2IuYW5pbWF0ZShjLGYsYS5vcHRpb25zLmVhc2luZyk7Zm9yKGU9MTtlPGw7ZSsrKWIuYW5pbWF0ZShpLGYsYS5vcHRpb25zLmVhc2luZykuYW5pbWF0ZShrLGYsYS5vcHRpb25zLmVhc2luZyk7Yi5hbmltYXRlKGksZixhLm9wdGlvbnMuZWFzaW5nKS5hbmltYXRlKGMsZi8yLGEub3B0aW9ucy5lYXNpbmcsZnVuY3Rpb24oKXtkLmVmZmVjdHMucmVzdG9yZShiLGopO2QuZWZmZWN0cy5yZW1vdmVXcmFwcGVyKGIpO2EuY2FsbGJhY2smJmEuY2FsbGJhY2suYXBwbHkodGhpcyxhcmd1bWVudHMpfSk7Yi5xdWV1ZShcImZ4XCIsZnVuY3Rpb24oKXtiLmRlcXVldWUoKX0pO2IuZGVxdWV1ZSgpfSl9fSkoalF1ZXJ5KTtcbjsvKlxuICogTm90ZTogV2hpbGUgTWljcm9zb2Z0IGlzIG5vdCB0aGUgYXV0aG9yIG9mIHRoaXMgZmlsZSwgTWljcm9zb2Z0IGlzXG4gKiBvZmZlcmluZyB5b3UgYSBsaWNlbnNlIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNaWNyb3NvZnQgU29mdHdhcmVcbiAqIExpY2Vuc2UgVGVybXMgZm9yIE1pY3Jvc29mdCBBU1AuTkVUIE1vZGVsIFZpZXcgQ29udHJvbGxlciAzLlxuICogTWljcm9zb2Z0IHJlc2VydmVzIGFsbCBvdGhlciByaWdodHMuIFRoZSBub3RpY2VzIGJlbG93IGFyZSBwcm92aWRlZFxuICogZm9yIGluZm9ybWF0aW9uYWwgcHVycG9zZXMgb25seSBhbmQgYXJlIG5vdCB0aGUgbGljZW5zZSB0ZXJtcyB1bmRlclxuICogd2hpY2ggTWljcm9zb2Z0IGRpc3RyaWJ1dGVkIHRoaXMgZmlsZS5cbiAqXG4gKiBqUXVlcnkgVUkgRWZmZWN0cyBTbGlkZSAxLjguMTFcbiAqXG4gKiBDb3B5cmlnaHQgMjAxMSwgQVVUSE9SUy50eHQgKGh0dHA6Ly9qcXVlcnl1aS5jb20vYWJvdXQpXG4gKlxuICogaHR0cDovL2RvY3MuanF1ZXJ5LmNvbS9VSS9FZmZlY3RzL1NsaWRlXG4gKlxuICogRGVwZW5kczpcbiAqXHRqcXVlcnkuZWZmZWN0cy5jb3JlLmpzXG4gKi9cbihmdW5jdGlvbihjKXtjLmVmZmVjdHMuc2xpZGU9ZnVuY3Rpb24oZCl7cmV0dXJuIHRoaXMucXVldWUoZnVuY3Rpb24oKXt2YXIgYT1jKHRoaXMpLGg9W1wicG9zaXRpb25cIixcInRvcFwiLFwiYm90dG9tXCIsXCJsZWZ0XCIsXCJyaWdodFwiXSxmPWMuZWZmZWN0cy5zZXRNb2RlKGEsZC5vcHRpb25zLm1vZGV8fFwic2hvd1wiKSxiPWQub3B0aW9ucy5kaXJlY3Rpb258fFwibGVmdFwiO2MuZWZmZWN0cy5zYXZlKGEsaCk7YS5zaG93KCk7Yy5lZmZlY3RzLmNyZWF0ZVdyYXBwZXIoYSkuY3NzKHtvdmVyZmxvdzpcImhpZGRlblwifSk7dmFyIGc9Yj09XCJ1cFwifHxiPT1cImRvd25cIj9cInRvcFwiOlwibGVmdFwiO2I9Yj09XCJ1cFwifHxiPT1cImxlZnRcIj9cInBvc1wiOlwibmVnXCI7dmFyIGU9ZC5vcHRpb25zLmRpc3RhbmNlfHwoZz09XCJ0b3BcIj9hLm91dGVySGVpZ2h0KHttYXJnaW46dHJ1ZX0pOmEub3V0ZXJXaWR0aCh7bWFyZ2luOnRydWV9KSk7aWYoZj09XCJzaG93XCIpYS5jc3MoZyxiPT1cInBvc1wiP2lzTmFOKGUpP1wiLVwiK2U6LWU6ZSk7XG52YXIgaT17fTtpW2ddPShmPT1cInNob3dcIj9iPT1cInBvc1wiP1wiKz1cIjpcIi09XCI6Yj09XCJwb3NcIj9cIi09XCI6XCIrPVwiKStlO2EuYW5pbWF0ZShpLHtxdWV1ZTpmYWxzZSxkdXJhdGlvbjpkLmR1cmF0aW9uLGVhc2luZzpkLm9wdGlvbnMuZWFzaW5nLGNvbXBsZXRlOmZ1bmN0aW9uKCl7Zj09XCJoaWRlXCImJmEuaGlkZSgpO2MuZWZmZWN0cy5yZXN0b3JlKGEsaCk7Yy5lZmZlY3RzLnJlbW92ZVdyYXBwZXIoYSk7ZC5jYWxsYmFjayYmZC5jYWxsYmFjay5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YS5kZXF1ZXVlKCl9fSl9KX19KShqUXVlcnkpO1xuOy8qXG4gKiBOb3RlOiBXaGlsZSBNaWNyb3NvZnQgaXMgbm90IHRoZSBhdXRob3Igb2YgdGhpcyBmaWxlLCBNaWNyb3NvZnQgaXNcbiAqIG9mZmVyaW5nIHlvdSBhIGxpY2Vuc2Ugc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1pY3Jvc29mdCBTb2Z0d2FyZVxuICogTGljZW5zZSBUZXJtcyBmb3IgTWljcm9zb2Z0IEFTUC5ORVQgTW9kZWwgVmlldyBDb250cm9sbGVyIDMuXG4gKiBNaWNyb3NvZnQgcmVzZXJ2ZXMgYWxsIG90aGVyIHJpZ2h0cy4gVGhlIG5vdGljZXMgYmVsb3cgYXJlIHByb3ZpZGVkXG4gKiBmb3IgaW5mb3JtYXRpb25hbCBwdXJwb3NlcyBvbmx5IGFuZCBhcmUgbm90IHRoZSBsaWNlbnNlIHRlcm1zIHVuZGVyXG4gKiB3aGljaCBNaWNyb3NvZnQgZGlzdHJpYnV0ZWQgdGhpcyBmaWxlLlxuICpcbiAqIGpRdWVyeSBVSSBFZmZlY3RzIFRyYW5zZmVyIDEuOC4xMVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBBVVRIT1JTLnR4dCAoaHR0cDovL2pxdWVyeXVpLmNvbS9hYm91dClcbiAqXG4gKiBodHRwOi8vZG9jcy5qcXVlcnkuY29tL1VJL0VmZmVjdHMvVHJhbnNmZXJcbiAqXG4gKiBEZXBlbmRzOlxuICpcdGpxdWVyeS5lZmZlY3RzLmNvcmUuanNcbiAqL1xuKGZ1bmN0aW9uKGUpe2UuZWZmZWN0cy50cmFuc2Zlcj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShmdW5jdGlvbigpe3ZhciBiPWUodGhpcyksYz1lKGEub3B0aW9ucy50byksZD1jLm9mZnNldCgpO2M9e3RvcDpkLnRvcCxsZWZ0OmQubGVmdCxoZWlnaHQ6Yy5pbm5lckhlaWdodCgpLHdpZHRoOmMuaW5uZXJXaWR0aCgpfTtkPWIub2Zmc2V0KCk7dmFyIGY9ZSgnPGRpdiBjbGFzcz1cInVpLWVmZmVjdHMtdHJhbnNmZXJcIj48L2Rpdj4nKS5hcHBlbmRUbyhkb2N1bWVudC5ib2R5KS5hZGRDbGFzcyhhLm9wdGlvbnMuY2xhc3NOYW1lKS5jc3Moe3RvcDpkLnRvcCxsZWZ0OmQubGVmdCxoZWlnaHQ6Yi5pbm5lckhlaWdodCgpLHdpZHRoOmIuaW5uZXJXaWR0aCgpLHBvc2l0aW9uOlwiYWJzb2x1dGVcIn0pLmFuaW1hdGUoYyxhLmR1cmF0aW9uLGEub3B0aW9ucy5lYXNpbmcsZnVuY3Rpb24oKXtmLnJlbW92ZSgpO2EuY2FsbGJhY2smJmEuY2FsbGJhY2suYXBwbHkoYlswXSxhcmd1bWVudHMpO1xuYi5kZXF1ZXVlKCl9KX0pfX0pKGpRdWVyeSk7XG47IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxyXG4gKiBAY2xhc3MgZWxGaW5kZXIgLSBmaWxlIG1hbmFnZXIgZm9yIHdlYlxyXG4gKlxyXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxyXG4gKiovXHJcbndpbmRvdy5lbEZpbmRlciA9IGZ1bmN0aW9uKG5vZGUsIG9wdHMpIHtcclxuICAgIHRoaXMudGltZSgnbG9hZCcpO1xyXG5cclxuICAgIHZhciBzZWxmID0gdGhpcyxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBOb2RlIG9uIHdoaWNoIGVsZmluZGVyIGNyZWF0aW5nXHJcblx0XHQgKlxyXG5cdFx0ICogQHR5cGUgalF1ZXJ5XHJcblx0XHQgKiovXHJcbiAgICAgICAgbm9kZSA9ICQobm9kZSksXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogU3RvcmUgbm9kZSBjb250ZW50cy5cclxuXHRcdCAqXHJcblx0XHQgKiBAc2VlIHRoaXMuZGVzdHJveVxyXG5cdFx0ICogQHR5cGUgalF1ZXJ5XHJcblx0XHQgKiovXHJcbiAgICAgICAgcHJldkNvbnRlbnQgPSAkKCc8ZGl2Lz4nKS5hcHBlbmQobm9kZS5jb250ZW50cygpKSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBTdG9yZSBub2RlIGlubGluZSBzdHlsZXNcclxuXHRcdCAqXHJcblx0XHQgKiBAc2VlIHRoaXMuZGVzdHJveVxyXG5cdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHQgKiovXHJcbiAgICAgICAgcHJldlN0eWxlID0gbm9kZS5hdHRyKCdzdHlsZScpLFxyXG5cclxuICAgICAgICAvKipcclxuXHRcdCAqIEluc3RhbmNlIElELiBSZXF1aXJlZCB0byBnZXQvc2V0IGNvb2tpZVxyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0ICoqL1xyXG4gICAgICAgIGlkID0gbm9kZS5hdHRyKCdpZCcpIHx8ICcnLFxyXG5cclxuICAgICAgICAvKipcclxuXHRcdCAqIEV2ZW50cyBuYW1lc3BhY2VcclxuXHRcdCAqXHJcblx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdCAqKi9cclxuICAgICAgICBuYW1lc3BhY2UgPSAnZWxmaW5kZXItJyArIChpZCB8fCBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKCkuc3Vic3RyKDIsIDcpKSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBNb3VzZWRvd24gZXZlbnRcclxuXHRcdCAqXHJcblx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdCAqKi9cclxuICAgICAgICBtb3VzZWRvd24gPSAnbW91c2Vkb3duLicgKyBuYW1lc3BhY2UsXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogS2V5ZG93biBldmVudFxyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0ICoqL1xyXG4gICAgICAgIGtleWRvd24gPSAna2V5ZG93bi4nICsgbmFtZXNwYWNlLFxyXG5cclxuICAgICAgICAvKipcclxuXHRcdCAqIEtleXByZXNzIGV2ZW50XHJcblx0XHQgKlxyXG5cdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHQgKiovXHJcbiAgICAgICAga2V5cHJlc3MgPSAna2V5cHJlc3MuJyArIG5hbWVzcGFjZSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBJcyBzaG9ydGN1dHMvY29tbWFuZHMgZW5hYmxlZFxyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIEJvb2xlYW5cclxuXHRcdCAqKi9cclxuICAgICAgICBlbmFibGVkID0gdHJ1ZSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBTdG9yZSBlbmFibGVkIHZhbHVlIGJlZm9yZSBhamF4IHJlcXVpZXN0XHJcblx0XHQgKlxyXG5cdFx0ICogQHR5cGUgQm9vbGVhblxyXG5cdFx0ICoqL1xyXG4gICAgICAgIHByZXZFbmFibGVkID0gdHJ1ZSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBMaXN0IG9mIGJ1aWxkLWluIGV2ZW50cyB3aGljaCBtYXBwZWQgaW50byBtZXRob2RzIHdpdGggc2FtZSBuYW1lc1xyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIEFycmF5XHJcblx0XHQgKiovXHJcbiAgICAgICAgZXZlbnRzID0gWydlbmFibGUnLCAnZGlzYWJsZScsICdsb2FkJywgJ29wZW4nLCAncmVsb2FkJywgJ3NlbGVjdCcsICdhZGQnLCAncmVtb3ZlJywgJ2NoYW5nZScsICdkYmxjbGljaycsICdnZXRmaWxlJywgJ2xvY2tmaWxlcycsICd1bmxvY2tmaWxlcycsICdkcmFnc3RhcnQnLCAnZHJhZ3N0b3AnXSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBSdWxlcyB0byB2YWxpZGF0ZSBkYXRhIGZyb20gYmFja2VuZFxyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIE9iamVjdFxyXG5cdFx0ICoqL1xyXG4gICAgICAgIHJ1bGVzID0ge30sXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogQ3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSBoYXNoXHJcblx0XHQgKlxyXG5cdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHQgKiovXHJcbiAgICAgICAgY3dkID0gJycsXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogQ3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSBvcHRpb25zXHJcblx0XHQgKlxyXG5cdFx0ICogQHR5cGUgT2JqZWN0XHJcblx0XHQgKiovXHJcbiAgICAgICAgY3dkT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgcGF0aDogJycsXHJcbiAgICAgICAgICAgIHVybDogJycsXHJcbiAgICAgICAgICAgIHRtYlVybDogJycsXHJcbiAgICAgICAgICAgIGRpc2FibGVkOiBbXSxcclxuICAgICAgICAgICAgc2VwYXJhdG9yOiAnLycsXHJcbiAgICAgICAgICAgIGFyY2hpdmVzOiBbXSxcclxuICAgICAgICAgICAgZXh0cmFjdDogW10sXHJcbiAgICAgICAgICAgIGNvcHlPdmVyd3JpdGU6IHRydWUsXHJcbiAgICAgICAgICAgIHRtYjogZmFsc2UgLy8gb2xkIEFQSVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogRmlsZXMvZGlycyBjYWNoZVxyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIE9iamVjdFxyXG5cdFx0ICoqL1xyXG4gICAgICAgIGZpbGVzID0ge30sXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogU2VsZWN0ZWQgZmlsZXMgaGFzaGVzXHJcblx0XHQgKlxyXG5cdFx0ICogQHR5cGUgQXJyYXlcclxuXHRcdCAqKi9cclxuICAgICAgICBzZWxlY3RlZCA9IFtdLFxyXG5cclxuICAgICAgICAvKipcclxuXHRcdCAqIEV2ZW50cyBsaXN0ZW5lcnNcclxuXHRcdCAqXHJcblx0XHQgKiBAdHlwZSBPYmplY3RcclxuXHRcdCAqKi9cclxuICAgICAgICBsaXN0ZW5lcnMgPSB7fSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBTaG9ydGN1dHNcclxuXHRcdCAqXHJcblx0XHQgKiBAdHlwZSBPYmplY3RcclxuXHRcdCAqKi9cclxuICAgICAgICBzaG9ydGN1dHMgPSB7fSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBCdWZmZXIgZm9yIGNvcGllZCBmaWxlc1xyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIEFycmF5XHJcblx0XHQgKiovXHJcbiAgICAgICAgY2xpcGJvYXJkID0gW10sXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogQ29waWVkL2N1dGVkIGZpbGVzIGhhc2hlc1xyXG5cdFx0ICogUHJldmVudCBmcm9tIHJlbW92ZSBpdHMgZnJvbSBjYWNoZS5cclxuXHRcdCAqIFJlcXVpcmVkIGZvciBkaXNwYWx5IGNvcnJlY3QgZmlsZXMgbmFtZXMgaW4gZXJyb3IgbWVzc2FnZXNcclxuXHRcdCAqXHJcblx0XHQgKiBAdHlwZSBBcnJheVxyXG5cdFx0ICoqL1xyXG4gICAgICAgIHJlbWVtYmVyID0gW10sXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogUXVldWUgZm9yICdvcGVuJyByZXF1ZXN0c1xyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIEFycmF5XHJcblx0XHQgKiovXHJcbiAgICAgICAgcXVldWUgPSBbXSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBOZXQgZHJpdmVycyBuYW1lc1xyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIEFycmF5XHJcblx0XHQgKiovXHJcbiAgICAgICAgbmV0RHJpdmVycyA9IFtdLFxyXG5cclxuICAgICAgICAvKipcclxuXHRcdCAqIENvbW1hbmRzIHByb3RvdHlwZVxyXG5cdFx0ICpcclxuXHRcdCAqIEB0eXBlIE9iamVjdFxyXG5cdFx0ICoqL1xyXG4gICAgICAgIGJhc2UgPSBuZXcgc2VsZi5jb21tYW5kKHNlbGYpLFxyXG5cclxuICAgICAgICAvKipcclxuXHRcdCAqIGVsRmluZGVyIG5vZGUgd2lkdGhcclxuXHRcdCAqXHJcblx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdCAqIEBkZWZhdWx0IFwiYXV0b1wiXHJcblx0XHQgKiovXHJcbiAgICAgICAgd2lkdGggPSAnYXV0bycsXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogZWxGaW5kZXIgbm9kZSBoZWlnaHRcclxuXHRcdCAqXHJcblx0XHQgKiBAdHlwZSBOdW1iZXJcclxuXHRcdCAqIEBkZWZhdWx0IDQwMFxyXG5cdFx0ICoqL1xyXG4gICAgICAgIGhlaWdodCA9IDQwMCxcclxuXHJcbiAgICAgICAgYmVlcGVyID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpKS5oaWRlKCkuYXBwZW5kVG8oJ2JvZHknKVswXSxcclxuXHJcbiAgICAgICAgc3luY0ludGVydmFsLFxyXG5cclxuICAgICAgICBvcGVuID0gZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5pbml0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbml0IC0gcmVzZXQgY2FjaGVcclxuICAgICAgICAgICAgICAgIGZpbGVzID0ge307XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgb25seSBmaWxlcyBmcm9tIHByZXYgY3dkXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIGZpbGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVzLmhhc093blByb3BlcnR5KGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIGZpbGVzW2ldLm1pbWUgIT0gJ2RpcmVjdG9yeSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgZmlsZXNbaV0ucGhhc2ggPT0gY3dkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICYmICQuaW5BcnJheShpLCByZW1lbWJlcikgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBmaWxlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGN3ZCA9IGRhdGEuY3dkLmhhc2g7XHJcbiAgICAgICAgICAgIGNhY2hlKGRhdGEuZmlsZXMpO1xyXG4gICAgICAgICAgICBpZiAoIWZpbGVzW2N3ZF0pIHtcclxuICAgICAgICAgICAgICAgIGNhY2hlKFtkYXRhLmN3ZF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYubGFzdERpcihjd2QpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdFx0ICogU3RvcmUgaW5mbyBhYm91dCBmaWxlcy9kaXJzIGluIFwiZmlsZXNcIiBvYmplY3QuXHJcblx0XHQgKlxyXG5cdFx0ICogQHBhcmFtICBBcnJheSAgZmlsZXNcclxuXHRcdCAqIEByZXR1cm4gdm9pZFxyXG5cdFx0ICoqL1xyXG4gICAgICAgIGNhY2hlID0gZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgbCA9IGRhdGEubGVuZ3RoLCBmO1xyXG5cclxuICAgICAgICAgICAgd2hpbGUgKGwtLSkge1xyXG4gICAgICAgICAgICAgICAgZiA9IGRhdGFbbF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZi5uYW1lICYmIGYuaGFzaCAmJiBmLm1pbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWYucGhhc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSAndm9sdW1lXycgKyBmLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpMTggPSBzZWxmLmkxOG4obmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSAhPSBpMTgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuaTE4ID0gaTE4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVzW2YuaGFzaF0gPSBmO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBFeGVjIHNob3J0Y3V0XHJcblx0XHQgKlxyXG5cdFx0ICogQHBhcmFtICBqUXVlcnkuRXZlbnQgIGtleWRvd24va2V5cHJlc3MgZXZlbnRcclxuXHRcdCAqIEByZXR1cm4gdm9pZFxyXG5cdFx0ICovXHJcbiAgICAgICAgZXhlY1Nob3J0Y3V0ID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgY29kZSA9IGUua2V5Q29kZSxcclxuICAgICAgICAgICAgICAgIGN0cmxLZXkgPSAhIShlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChlbmFibGVkKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJC5lYWNoKHNob3J0Y3V0cywgZnVuY3Rpb24oaSwgc2hvcnRjdXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2hvcnRjdXQudHlwZSA9PSBlLnR5cGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgc2hvcnRjdXQua2V5Q29kZSA9PSBjb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHNob3J0Y3V0LnNoaWZ0S2V5ID09IGUuc2hpZnRLZXlcclxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgc2hvcnRjdXQuY3RybEtleSA9PSBjdHJsS2V5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHNob3J0Y3V0LmFsdEtleSA9PSBlLmFsdEtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3J0Y3V0LmNhbGxiYWNrKGUsIHNlbGYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRlYnVnKCdzaG9ydGN1dC1leGVjJywgaSArICcgOiAnICsgc2hvcnRjdXQuZGVzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHByZXZlbnQgdGFiIG91dCBvZiBlbGZpbmRlclxyXG4gICAgICAgICAgICAgICAgaWYgKGNvZGUgPT0gOSAmJiAhJChlLnRhcmdldCkuaXMoJzppbnB1dCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKCksXHJcbiAgICAgICAgdXRjLFxyXG4gICAgICAgIGkxOG47XHJcblxyXG5cclxuICAgIC8qKlxyXG5cdCAqIFByb3RvY29sIHZlcnNpb25cclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqKi9cclxuICAgIHRoaXMuYXBpID0gbnVsbDtcclxuXHJcbiAgICAvKipcclxuXHQgKiBlbEZpbmRlciB1c2UgbmV3IGFwaVxyXG5cdCAqXHJcblx0ICogQHR5cGUgQm9vbGVhblxyXG5cdCAqKi9cclxuICAgIHRoaXMubmV3QVBJID0gZmFsc2U7XHJcblxyXG4gICAgLyoqXHJcblx0ICogZWxGaW5kZXIgdXNlIG9sZCBhcGlcclxuXHQgKlxyXG5cdCAqIEB0eXBlIEJvb2xlYW5cclxuXHQgKiovXHJcbiAgICB0aGlzLm9sZEFQSSA9IGZhbHNlO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIFVzZXIgb3MuIFJlcXVpcmVkIHRvIGJpbmQgbmF0aXZlIHNob3J0Y3V0cyBmb3Igb3Blbi9yZW5hbWVcclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqKi9cclxuICAgIHRoaXMuT1MgPSBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ01hYycpICE9PSAtMSA/ICdtYWMnIDogbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdXaW4nKSAhPT0gLTEgPyAnd2luJyA6ICdvdGhlcic7XHJcblxyXG4gICAgLyoqXHJcblx0ICogVXNlciBicm93c2VyIFVBLlxyXG5cdCAqIGpRdWVyeS5icm93c2VyOiB2ZXJzaW9uIGRlcHJlY2F0ZWQ6IDEuMywgcmVtb3ZlZDogMS45XHJcblx0ICpcclxuXHQgKiBAdHlwZSBPYmplY3RcclxuXHQgKiovXHJcbiAgICB0aGlzLlVBID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB3ZWJraXQ7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgd2Via2l0ID0gIWRvY3VtZW50LnVuaXF1ZUlEICYmICF3aW5kb3cub3BlcmEgJiYgIXdpbmRvdy5zaWRlYmFyICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UgJiYgdHlwZW9mIHdpbmRvdy5vcmllbnRhdGlvbiA9PSBcInVuZGVmaW5lZFwiO1xyXG4gICAgICAgIH0gY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgIHdlYmtpdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB3aW5kb3cuY29uc29sZSAmJiB3aW5kb3cuY29uc29sZS5sb2cgJiYgd2luZG93LmNvbnNvbGUubG9nKGV4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgLy8gQnJvd3NlciBJRSA8PSBJRSA2XHJcbiAgICAgICAgICAgIGx0SUU2OiB0eXBlb2Ygd2luZG93LmFkZEV2ZW50TGlzdGVuZXIgPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLm1heEhlaWdodCA9PSBcInVuZGVmaW5lZFwiLFxyXG4gICAgICAgICAgICAvLyBCcm93c2VyIElFIDw9IElFIDdcclxuICAgICAgICAgICAgbHRJRTc6IHR5cGVvZiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciA9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsID09IFwidW5kZWZpbmVkXCIsXHJcbiAgICAgICAgICAgIC8vIEJyb3dzZXIgSUUgPD0gSUUgOFxyXG4gICAgICAgICAgICBsdElFODogdHlwZW9mIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyID09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgPT0gXCJ1bmRlZmluZWRcIixcclxuICAgICAgICAgICAgSUU6IGRvY3VtZW50LnVuaXF1ZUlELFxyXG4gICAgICAgICAgICBGaXJlZm94OiB3aW5kb3cuc2lkZWJhcixcclxuICAgICAgICAgICAgT3BlcmE6IHdpbmRvdy5vcGVyYSxcclxuICAgICAgICAgICAgV2Via2l0OiB3ZWJraXQsXHJcbiAgICAgICAgICAgIENocm9tZTogd2Via2l0ICYmIHdpbmRvdy5jaHJvbWUsXHJcbiAgICAgICAgICAgIFNhZmFyaTogd2Via2l0ICYmICF3aW5kb3cuY2hyb21lLFxyXG4gICAgICAgICAgICBNb2JpbGU6IHR5cGVvZiB3aW5kb3cub3JpZW50YXRpb24gIT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgIH07XHJcbiAgICB9KSgpO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIENvbmZpZ3VyYXRpb24gb3B0aW9uc1xyXG5cdCAqXHJcblx0ICogQHR5cGUgT2JqZWN0XHJcblx0ICoqL1xyXG4gICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQodHJ1ZSwge30sIHRoaXMuX29wdGlvbnMsIG9wdHMgfHwge30pO1xyXG5cclxuICAgIGlmIChvcHRzLnVpKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnVpID0gb3B0cy51aTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAob3B0cy5jb21tYW5kcykge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy5jb21tYW5kcyA9IG9wdHMuY29tbWFuZHM7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG9wdHMudWlPcHRpb25zICYmIG9wdHMudWlPcHRpb25zLnRvb2xiYXIpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMudWlPcHRpb25zLnRvb2xiYXIgPSBvcHRzLnVpT3B0aW9ucy50b29sYmFyO1xyXG4gICAgfVxyXG5cclxuICAgIC8vRm9yIGNvbHVtbnNcclxuICAgIGlmIChvcHRzLnVpT3B0aW9ucyAmJiBvcHRzLnVpT3B0aW9ucy5jd2QgJiYgb3B0cy51aU9wdGlvbnMuY3dkLmxpc3RWaWV3ICYmIG9wdHMudWlPcHRpb25zLmN3ZC5saXN0Vmlldy5jb2x1bW5zKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnVpT3B0aW9ucy5jd2QubGlzdFZpZXcuY29sdW1ucyA9IG9wdHMudWlPcHRpb25zLmN3ZC5saXN0Vmlldy5jb2x1bW5zO1xyXG4gICAgfVxyXG4gICAgaWYgKG9wdHMudWlPcHRpb25zICYmIG9wdHMudWlPcHRpb25zLmN3ZCAmJiBvcHRzLnVpT3B0aW9ucy5jd2QubGlzdFZpZXcgJiYgb3B0cy51aU9wdGlvbnMuY3dkLmxpc3RWaWV3LmNvbHVtbnNDdXN0b21OYW1lKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnVpT3B0aW9ucy5jd2QubGlzdFZpZXcuY29sdW1uc0N1c3RvbU5hbWUgPSBvcHRzLnVpT3B0aW9ucy5jd2QubGlzdFZpZXcuY29sdW1uc0N1c3RvbU5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgJC5leHRlbmQodGhpcy5vcHRpb25zLmNvbnRleHRtZW51LCBvcHRzLmNvbnRleHRtZW51KTtcclxuXHJcblxyXG4gICAgLyoqXHJcblx0ICogQWpheCByZXF1ZXN0IHR5cGVcclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqIEBkZWZhdWx0IFwiZ2V0XCJcclxuXHQgKiovXHJcbiAgICB0aGlzLnJlcXVlc3RUeXBlID0gL14oZ2V0fHBvc3QpJC9pLnRlc3QodGhpcy5vcHRpb25zLnJlcXVlc3RUeXBlKSA/IHRoaXMub3B0aW9ucy5yZXF1ZXN0VHlwZS50b0xvd2VyQ2FzZSgpIDogJ2dldCcsXHJcblxyXG4gICAgICAgIC8qKlxyXG5cdCAqIEFueSBkYXRhIHRvIHNlbmQgYWNyb3NzIGV2ZXJ5IGFqYXggcmVxdWVzdFxyXG5cdCAqXHJcblx0ICogQHR5cGUgT2JqZWN0XHJcblx0ICogQGRlZmF1bHQge31cclxuXHQgKiovXHJcbiAgICAgICAgdGhpcy5jdXN0b21EYXRhID0gJC5pc1BsYWluT2JqZWN0KHRoaXMub3B0aW9ucy5jdXN0b21EYXRhKSA/IHRoaXMub3B0aW9ucy5jdXN0b21EYXRhIDoge307XHJcblxyXG4gICAgLyoqXHJcblx0ICogSUQuIFJlcXVpcmVkIHRvIGNyZWF0ZSB1bmlxdWUgY29va2llIG5hbWVcclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqKi9cclxuICAgIHRoaXMuaWQgPSBpZDtcclxuXHJcbiAgICAvKipcclxuXHQgKiBVUkwgdG8gdXBsb2FkIGZpbGVzXHJcblx0ICpcclxuXHQgKiBAdHlwZSBTdHJpbmdcclxuXHQgKiovXHJcbiAgICB0aGlzLnVwbG9hZFVSTCA9IG9wdHMudXJsVXBsb2FkIHx8IG9wdHMudXJsO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIEV2ZW50cyBuYW1lc3BhY2VcclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqKi9cclxuICAgIHRoaXMubmFtZXNwYWNlID0gbmFtZXNwYWNlO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIEludGVyZmFjZSBsYW5ndWFnZVxyXG5cdCAqXHJcblx0ICogQHR5cGUgU3RyaW5nXHJcblx0ICogQGRlZmF1bHQgXCJlblwiXHJcblx0ICoqL1xyXG4gICAgdGhpcy5sYW5nID0gdGhpcy5pMThbdGhpcy5vcHRpb25zLmxhbmddICYmIHRoaXMuaTE4W3RoaXMub3B0aW9ucy5sYW5nXS5tZXNzYWdlcyA/IHRoaXMub3B0aW9ucy5sYW5nIDogJ2VuJztcclxuXHJcbiAgICBpMThuID0gdGhpcy5sYW5nID09ICdlbidcclxuICAgICAgICA/IHRoaXMuaTE4WydlbiddXHJcbiAgICAgICAgOiAkLmV4dGVuZCh0cnVlLCB7fSwgdGhpcy5pMThbJ2VuJ10sIHRoaXMuaTE4W3RoaXMubGFuZ10pO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIEludGVyZmFjZSBkaXJlY3Rpb25cclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqIEBkZWZhdWx0IFwibHRyXCJcclxuXHQgKiovXHJcbiAgICB0aGlzLmRpcmVjdGlvbiA9IGkxOG4uZGlyZWN0aW9uO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIGkxOCBtZXNzYWdlc1xyXG5cdCAqXHJcblx0ICogQHR5cGUgT2JqZWN0XHJcblx0ICoqL1xyXG4gICAgdGhpcy5tZXNzYWdlcyA9IGkxOG4ubWVzc2FnZXM7XHJcblxyXG4gICAgLyoqXHJcblx0ICogRGF0ZS90aW1lIGZvcm1hdFxyXG5cdCAqXHJcblx0ICogQHR5cGUgU3RyaW5nXHJcblx0ICogQGRlZmF1bHQgXCJtLmQuWVwiXHJcblx0ICoqL1xyXG4gICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5vcHRpb25zLmRhdGVGb3JtYXQgfHwgaTE4bi5kYXRlRm9ybWF0O1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIERhdGUgZm9ybWF0IGxpa2UgXCJZZXN0ZXJkYXkgMTA6MjA6MTJcIlxyXG5cdCAqXHJcblx0ICogQHR5cGUgU3RyaW5nXHJcblx0ICogQGRlZmF1bHQgXCJ7ZGF5fSB7dGltZX1cIlxyXG5cdCAqKi9cclxuICAgIHRoaXMuZmFuY3lGb3JtYXQgPSB0aGlzLm9wdGlvbnMuZmFuY3lEYXRlRm9ybWF0IHx8IGkxOG4uZmFuY3lEYXRlRm9ybWF0O1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIFRvZGF5IHRpbWVzdGFtcFxyXG5cdCAqXHJcblx0ICogQHR5cGUgTnVtYmVyXHJcblx0ICoqL1xyXG4gICAgdGhpcy50b2RheSA9IChuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSwgZGF0ZS5nZXREYXRlKCkpKS5nZXRUaW1lKCkgLyAxMDAwO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIFllc3RlcmRheSB0aW1lc3RhbXBcclxuXHQgKlxyXG5cdCAqIEB0eXBlIE51bWJlclxyXG5cdCAqKi9cclxuICAgIHRoaXMueWVzdGVyZGF5ID0gdGhpcy50b2RheSAtIDg2NDAwO1xyXG5cclxuICAgIHV0YyA9IHRoaXMub3B0aW9ucy5VVENEYXRlID8gJ1VUQycgOiAnJztcclxuXHJcbiAgICB0aGlzLmdldEhvdXJzID0gJ2dldCcgKyB1dGMgKyAnSG91cnMnO1xyXG4gICAgdGhpcy5nZXRNaW51dGVzID0gJ2dldCcgKyB1dGMgKyAnTWludXRlcyc7XHJcbiAgICB0aGlzLmdldFNlY29uZHMgPSAnZ2V0JyArIHV0YyArICdTZWNvbmRzJztcclxuICAgIHRoaXMuZ2V0RGF0ZSA9ICdnZXQnICsgdXRjICsgJ0RhdGUnO1xyXG4gICAgdGhpcy5nZXREYXkgPSAnZ2V0JyArIHV0YyArICdEYXknO1xyXG4gICAgdGhpcy5nZXRNb250aCA9ICdnZXQnICsgdXRjICsgJ01vbnRoJztcclxuICAgIHRoaXMuZ2V0RnVsbFllYXIgPSAnZ2V0JyArIHV0YyArICdGdWxsWWVhcic7XHJcblxyXG4gICAgLyoqXHJcblx0ICogQ3NzIGNsYXNzZXMgXHJcblx0ICpcclxuXHQgKiBAdHlwZSBTdHJpbmdcclxuXHQgKiovXHJcbiAgICB0aGlzLmNzc0NsYXNzID0gJ3VpLWhlbHBlci1yZXNldCB1aS1oZWxwZXItY2xlYXJmaXggdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwgZWxmaW5kZXIgZWxmaW5kZXItJyArICh0aGlzLmRpcmVjdGlvbiA9PSAncnRsJyA/ICdydGwnIDogJ2x0cicpICsgJyAnICsgdGhpcy5vcHRpb25zLmNzc0NsYXNzO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIE1ldGhvZCB0byBzdG9yZS9mZXRjaCBkYXRhXHJcblx0ICpcclxuXHQgKiBAdHlwZSBGdW5jdGlvblxyXG5cdCAqKi9cclxuICAgIHRoaXMuc3RvcmFnZSA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ2xvY2FsU3RvcmFnZScgaW4gd2luZG93ICYmIHdpbmRvd1snbG9jYWxTdG9yYWdlJ10gIT09IG51bGwgPyBzZWxmLmxvY2FsU3RvcmFnZSA6IHNlbGYuY29va2llO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNlbGYuY29va2llO1xyXG4gICAgICAgIH1cclxuICAgIH0pKCk7XHJcblxyXG4gICAgdGhpcy52aWV3VHlwZSA9IHRoaXMuc3RvcmFnZSgndmlldycpIHx8IHRoaXMub3B0aW9ucy5kZWZhdWx0VmlldyB8fCAnaWNvbnMnO1xyXG5cclxuICAgIHRoaXMuc29ydFR5cGUgPSB0aGlzLnN0b3JhZ2UoJ3NvcnRUeXBlJykgfHwgdGhpcy5vcHRpb25zLnNvcnRUeXBlIHx8ICduYW1lJztcclxuXHJcbiAgICB0aGlzLnNvcnRPcmRlciA9IHRoaXMuc3RvcmFnZSgnc29ydE9yZGVyJykgfHwgdGhpcy5vcHRpb25zLnNvcnRPcmRlciB8fCAnYXNjJztcclxuXHJcbiAgICB0aGlzLnNvcnRTdGlja0ZvbGRlcnMgPSB0aGlzLnN0b3JhZ2UoJ3NvcnRTdGlja0ZvbGRlcnMnKTtcclxuXHJcbiAgICBpZiAodGhpcy5zb3J0U3RpY2tGb2xkZXJzID09PSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5zb3J0U3RpY2tGb2xkZXJzID0gISF0aGlzLm9wdGlvbnMuc29ydFN0aWNrRm9sZGVycztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5zb3J0U3RpY2tGb2xkZXJzID0gISF0aGlzLnNvcnRTdGlja0ZvbGRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5zb3J0UnVsZXMgPSAkLmV4dGVuZCh0cnVlLCB7fSwgdGhpcy5fc29ydFJ1bGVzLCB0aGlzLm9wdGlvbnMuc29ydHNSdWxlcyk7XHJcblxyXG4gICAgJC5lYWNoKHRoaXMuc29ydFJ1bGVzLCBmdW5jdGlvbihuYW1lLCBtZXRob2QpIHtcclxuICAgICAgICBpZiAodHlwZW9mIG1ldGhvZCAhPSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBzZWxmLnNvcnRSdWxlc1tuYW1lXTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmNvbXBhcmUgPSAkLnByb3h5KHRoaXMuY29tcGFyZSwgdGhpcyk7XHJcblxyXG4gICAgLyoqXHJcblx0ICogRGVsYXkgaW4gbXMgYmVmb3JlIG9wZW4gbm90aWZpY2F0aW9uIGRpYWxvZ1xyXG5cdCAqXHJcblx0ICogQHR5cGUgTnVtYmVyXHJcblx0ICogQGRlZmF1bHQgNTAwXHJcblx0ICoqL1xyXG4gICAgdGhpcy5ub3RpZnlEZWxheSA9IHRoaXMub3B0aW9ucy5ub3RpZnlEZWxheSA+IDAgPyBwYXJzZUludCh0aGlzLm9wdGlvbnMubm90aWZ5RGVsYXkpIDogNTAwO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIEJhc2UgZHJhZ2dhYmxlIG9wdGlvbnNcclxuXHQgKlxyXG5cdCAqIEB0eXBlIE9iamVjdFxyXG5cdCAqKi9cclxuICAgIHRoaXMuZHJhZ2dhYmxlID0ge1xyXG4gICAgICAgIGFwcGVuZFRvOiAnYm9keScsXHJcbiAgICAgICAgYWRkQ2xhc3NlczogdHJ1ZSxcclxuICAgICAgICBkZWxheTogMzAsXHJcbiAgICAgICAgZGlzdGFuY2U6IDgsXHJcbiAgICAgICAgcmV2ZXJ0OiB0cnVlLFxyXG4gICAgICAgIHJlZnJlc2hQb3NpdGlvbnM6IHRydWUsXHJcbiAgICAgICAgY3Vyc29yOiAnbW92ZScsXHJcbiAgICAgICAgY3Vyc29yQXQ6IHsgbGVmdDogNTAsIHRvcDogNDcgfSxcclxuICAgICAgICBkcmFnOiBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICBpZiAoIXVpLmhlbHBlci5kYXRhKCdsb2NrZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgdWkuaGVscGVyLnRvZ2dsZUNsYXNzKCdlbGZpbmRlci1kcmFnLWhlbHBlci1wbHVzJywgZS5zaGlmdEtleSB8fCBlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRzID0gJC5tYXAodWkuaGVscGVyLmRhdGEoJ2ZpbGVzJykgfHwgW10sIGZ1bmN0aW9uKGgpIHsgcmV0dXJuIGggfHwgbnVsbDsgfSksXHJcbiAgICAgICAgICAgICAgICBjbnQsXHJcbiAgICAgICAgICAgICAgICBoO1xyXG4gICAgICAgICAgICBjbnQgPSB0YXJnZXRzLmxlbmd0aDtcclxuICAgICAgICAgICAgd2hpbGUgKGNudC0tKSB7XHJcbiAgICAgICAgICAgICAgICBoID0gdGFyZ2V0c1tjbnRdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVzW2hdLmxvY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHVpLmhlbHBlci5hZGRDbGFzcygnZWxmaW5kZXItZHJhZy1oZWxwZXItcGx1cycpLmRhdGEoJ2xvY2tlZCcsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzdG9wOiBmdW5jdGlvbigpIHsgc2VsZi50cmlnZ2VyKCdmb2N1cycpLnRyaWdnZXIoJ2RyYWdzdG9wJyk7IH0sXHJcbiAgICAgICAgaGVscGVyOiBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMuaWQgPyAkKHRoaXMpIDogJCh0aGlzKS5wYXJlbnRzKCdbaWRdOmZpcnN0JyksXHJcbiAgICAgICAgICAgICAgICBoZWxwZXIgPSAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItZHJhZy1oZWxwZXJcIj48c3BhbiBjbGFzcz1cImVsZmluZGVyLWRyYWctaGVscGVyLWljb24tcGx1c1wiLz48L2Rpdj4nKSxcclxuICAgICAgICAgICAgICAgIGljb24gPSBmdW5jdGlvbihtaW1lKSB7IHJldHVybiAnPGRpdiBjbGFzcz1cImVsZmluZGVyLWN3ZC1pY29uICcgKyBzZWxmLm1pbWUyY2xhc3MobWltZSkgKyAnIHVpLWNvcm5lci1hbGxcIi8+JzsgfSxcclxuICAgICAgICAgICAgICAgIGhhc2hlcyxcclxuICAgICAgICAgICAgICAgIGw7XHJcblxyXG4gICAgICAgICAgICBzZWxmLnRyaWdnZXIoJ2RyYWdzdGFydCcsIHsgdGFyZ2V0OiBlbGVtZW50WzBdLCBvcmlnaW5hbEV2ZW50OiBlIH0pO1xyXG5cclxuICAgICAgICAgICAgaGFzaGVzID0gZWxlbWVudC5pcygnLicgKyBzZWxmLnJlcygnY2xhc3MnLCAnY3dkZmlsZScpKVxyXG4gICAgICAgICAgICAgICAgPyBzZWxmLnNlbGVjdGVkKClcclxuICAgICAgICAgICAgICAgIDogW3NlbGYubmF2SWQySGFzaChlbGVtZW50LmF0dHIoJ2lkJykpXTtcclxuXHJcbiAgICAgICAgICAgIGhlbHBlci5hcHBlbmQoaWNvbihmaWxlc1toYXNoZXNbMF1dLm1pbWUpKS5kYXRhKCdmaWxlcycsIGhhc2hlcykuZGF0YSgnbG9ja2VkJywgZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgaWYgKChsID0gaGFzaGVzLmxlbmd0aCkgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBoZWxwZXIuYXBwZW5kKGljb24oZmlsZXNbaGFzaGVzW2wgLSAxXV0ubWltZSkgKyAnPHNwYW4gY2xhc3M9XCJlbGZpbmRlci1kcmFnLW51bVwiPicgKyBsICsgJzwvc3Bhbj4nKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGhlbHBlcjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIEJhc2UgZHJvcHBhYmxlIG9wdGlvbnNcclxuXHQgKlxyXG5cdCAqIEB0eXBlIE9iamVjdFxyXG5cdCAqKi9cclxuICAgIHRoaXMuZHJvcHBhYmxlID0ge1xyXG4gICAgICAgIC8vIGdyZWVkeSAgICAgOiB0cnVlLFxyXG4gICAgICAgIHRvbGVyYW5jZTogJ3BvaW50ZXInLFxyXG4gICAgICAgIGFjY2VwdDogJy5lbGZpbmRlci1jd2QtZmlsZS13cmFwcGVyLC5lbGZpbmRlci1uYXZiYXItZGlyLC5lbGZpbmRlci1jd2QtZmlsZScsXHJcbiAgICAgICAgaG92ZXJDbGFzczogdGhpcy5yZXMoJ2NsYXNzJywgJ2Fkcm9wcGFibGUnKSxcclxuICAgICAgICBkcm9wOiBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICB2YXIgZHN0ID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgICAgIHRhcmdldHMgPSAkLm1hcCh1aS5oZWxwZXIuZGF0YSgnZmlsZXMnKSB8fCBbXSwgZnVuY3Rpb24oaCkgeyByZXR1cm4gaCB8fCBudWxsOyB9KSxcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFtdLFxyXG4gICAgICAgICAgICAgICAgYyA9ICdjbGFzcycsXHJcbiAgICAgICAgICAgICAgICBjbnQsXHJcbiAgICAgICAgICAgICAgICBoYXNoLFxyXG4gICAgICAgICAgICAgICAgaSxcclxuICAgICAgICAgICAgICAgIGg7XHJcblxyXG4gICAgICAgICAgICBpZiAoZHN0LmlzKCcuJyArIHNlbGYucmVzKGMsICdjd2QnKSkpIHtcclxuICAgICAgICAgICAgICAgIGhhc2ggPSBjd2Q7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZHN0LmlzKCcuJyArIHNlbGYucmVzKGMsICdjd2RmaWxlJykpKSB7XHJcbiAgICAgICAgICAgICAgICBoYXNoID0gZHN0LmF0dHIoJ2lkJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZHN0LmlzKCcuJyArIHNlbGYucmVzKGMsICduYXZkaXInKSkpIHtcclxuICAgICAgICAgICAgICAgIGhhc2ggPSBzZWxmLm5hdklkMkhhc2goZHN0LmF0dHIoJ2lkJykpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbnQgPSB0YXJnZXRzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgIHdoaWxlIChjbnQtLSkge1xyXG4gICAgICAgICAgICAgICAgaCA9IHRhcmdldHNbY250XTtcclxuICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBkcm9wIGludG8gaXRzZWxmIG9yIGluIG93biBsb2NhdGlvblxyXG4gICAgICAgICAgICAgICAgaCAhPSBoYXNoICYmIGZpbGVzW2hdLnBoYXNoICE9IGhhc2ggJiYgcmVzdWx0LnB1c2goaCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB1aS5oZWxwZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jbGlwYm9hcmQocmVzdWx0LCAhKGUuY3RybEtleSB8fCBlLnNoaWZ0S2V5IHx8IGUubWV0YUtleSB8fCB1aS5oZWxwZXIuZGF0YSgnbG9ja2VkJykpKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuZXhlYygncGFzdGUnLCBoYXNoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYudHJpZ2dlcignZHJvcCcsIHsgZmlsZXM6IHRhcmdldHMgfSk7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuXHQgKiBSZXR1cm4gdHJ1ZSBpZiBmaWxlbWFuYWdlciBpcyBhY3RpdmVcclxuXHQgKlxyXG5cdCAqIEByZXR1cm4gQm9vbGVhblxyXG5cdCAqKi9cclxuICAgIHRoaXMuZW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBub2RlLmlzKCc6dmlzaWJsZScpICYmIGVuYWJsZWQ7XHJcbiAgICB9OyAvKipcclxuXHQgKiBSZXR1cm4gdHJ1ZSBpZiBmaWxlbWFuYWdlciBpcyB2aXNpYmxlXHJcblx0ICpcclxuXHQgKiBAcmV0dXJuIEJvb2xlYW5cclxuXHQgKiovXHJcbiAgICB0aGlzLnZpc2libGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gbm9kZS5pcygnOnZpc2libGUnKTtcclxuICAgIH07IC8qKlxyXG5cdCAqIFJldHVybiByb290IGRpciBoYXNoIGZvciBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5XHJcblx0ICogXHJcblx0ICogQHJldHVybiBTdHJpbmdcclxuXHQgKi9cclxuICAgIHRoaXMucm9vdCA9IGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICB2YXIgZGlyID0gZmlsZXNbaGFzaCB8fCBjd2RdLCBpO1xyXG5cclxuICAgICAgICB3aGlsZSAoZGlyICYmIGRpci5waGFzaCkge1xyXG4gICAgICAgICAgICBkaXIgPSBmaWxlc1tkaXIucGhhc2hdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGlyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkaXIuaGFzaDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHdoaWxlIChpIGluIGZpbGVzICYmIGZpbGVzLmhhc093blByb3BlcnR5KGkpKSB7XHJcbiAgICAgICAgICAgIGRpciA9IGZpbGVzW2ldO1xyXG4gICAgICAgICAgICBpZiAoIWRpci5waGFzaCAmJiAhZGlyLm1pbWUgPT0gJ2RpcmVjdG9yeScgJiYgZGlyLnJlYWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkaXIuaGFzaDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfTsgLyoqXHJcblx0ICogUmV0dXJuIGN1cnJlbnQgd29ya2luZyBkaXJlY3RvcnkgaW5mb1xyXG5cdCAqIFxyXG5cdCAqIEByZXR1cm4gT2JqZWN0XHJcblx0ICovXHJcbiAgICB0aGlzLmN3ZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBmaWxlc1tjd2RdIHx8IHt9O1xyXG4gICAgfTsgLyoqXHJcblx0ICogUmV0dXJuIHJlcXVpcmVkIGN3ZCBvcHRpb25cclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIFN0cmluZyAgb3B0aW9uIG5hbWVcclxuXHQgKiBAcmV0dXJuIG1peGVkXHJcblx0ICovXHJcbiAgICB0aGlzLm9wdGlvbiA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICByZXR1cm4gY3dkT3B0aW9uc1tuYW1lXSB8fCAnJztcclxuICAgIH07IC8qKlxyXG5cdCAqIFJldHVybiBmaWxlIGRhdGEgZnJvbSBjdXJyZW50IGRpciBvciB0cmVlIGJ5IGl0J3MgaGFzaFxyXG5cdCAqIFxyXG5cdCAqIEBwYXJhbSAgU3RyaW5nICBmaWxlIGhhc2hcclxuXHQgKiBAcmV0dXJuIE9iamVjdFxyXG5cdCAqL1xyXG4gICAgdGhpcy5maWxlID0gZnVuY3Rpb24oaGFzaCkge1xyXG4gICAgICAgIHJldHVybiBmaWxlc1toYXNoXTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcblx0ICogUmV0dXJuIGFsbCBjYWNoZWQgZmlsZXNcclxuXHQgKiBcclxuXHQgKiBAcmV0dXJuIEFycmF5XHJcblx0ICovXHJcbiAgICB0aGlzLmZpbGVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuICQuZXh0ZW5kKHRydWUsIHt9LCBmaWxlcyk7XHJcbiAgICB9OyAvKipcclxuXHQgKiBSZXR1cm4gbGlzdCBvZiBmaWxlIHBhcmVudHMgaGFzaGVzIGluY2x1ZGUgZmlsZSBoYXNoXHJcblx0ICogXHJcblx0ICogQHBhcmFtICBTdHJpbmcgIGZpbGUgaGFzaFxyXG5cdCAqIEByZXR1cm4gQXJyYXlcclxuXHQgKi9cclxuICAgIHRoaXMucGFyZW50cyA9IGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICB2YXIgcGFyZW50cyA9IFtdLFxyXG4gICAgICAgICAgICBkaXI7XHJcblxyXG4gICAgICAgIHdoaWxlICgoZGlyID0gdGhpcy5maWxlKGhhc2gpKSkge1xyXG4gICAgICAgICAgICBwYXJlbnRzLnVuc2hpZnQoZGlyLmhhc2gpO1xyXG4gICAgICAgICAgICBoYXNoID0gZGlyLnBoYXNoO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGFyZW50cztcclxuICAgIH07XHJcbiAgICB0aGlzLnBhdGgyYXJyYXkgPSBmdW5jdGlvbihoYXNoLCBpMTgpIHtcclxuICAgICAgICB2YXIgZmlsZSxcclxuICAgICAgICAgICAgcGF0aCA9IFtdO1xyXG5cclxuICAgICAgICB3aGlsZSAoaGFzaCAmJiAoZmlsZSA9IGZpbGVzW2hhc2hdKSAmJiBmaWxlLmhhc2gpIHtcclxuICAgICAgICAgICAgcGF0aC51bnNoaWZ0KGkxOCAmJiBmaWxlLmkxOCA/IGZpbGUuaTE4IDogZmlsZS5uYW1lKTtcclxuICAgICAgICAgICAgaGFzaCA9IGZpbGUucGhhc2g7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH07IC8qKlxyXG5cdCAqIFJldHVybiBmaWxlIHBhdGhcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIE9iamVjdCAgZmlsZVxyXG5cdCAqIEByZXR1cm4gU3RyaW5nXHJcblx0ICovXHJcbiAgICB0aGlzLnBhdGggPSBmdW5jdGlvbihoYXNoLCBpMTgpIHtcclxuICAgICAgICByZXR1cm4gZmlsZXNbaGFzaF0gJiYgZmlsZXNbaGFzaF0ucGF0aFxyXG4gICAgICAgICAgICA/IGZpbGVzW2hhc2hdLnBhdGhcclxuICAgICAgICAgICAgOiB0aGlzLnBhdGgyYXJyYXkoaGFzaCwgaTE4KS5qb2luKGN3ZE9wdGlvbnMuc2VwYXJhdG9yKTtcclxuICAgIH07IC8qKlxyXG5cdCAqIFJldHVybiBmaWxlIHVybCBpZiBzZXRcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIE9iamVjdCAgZmlsZVxyXG5cdCAqIEByZXR1cm4gU3RyaW5nXHJcblx0ICovXHJcbiAgICB0aGlzLnVybCA9IGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICB2YXIgZmlsZSA9IGZpbGVzW2hhc2hdO1xyXG5cclxuICAgICAgICBpZiAoIWZpbGUgfHwgIWZpbGUucmVhZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZmlsZS51cmwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbGUudXJsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGN3ZE9wdGlvbnMudXJsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjd2RPcHRpb25zLnVybCArICQubWFwKHRoaXMucGF0aDJhcnJheShoYXNoKSwgZnVuY3Rpb24obikgeyByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KG4pOyB9KS5zbGljZSgxKS5qb2luKCcvJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgcGFyYW1zID0gJC5leHRlbmQoe30sIHRoaXMuY3VzdG9tRGF0YSwge1xyXG4gICAgICAgICAgICBjbWQ6ICdmaWxlJyxcclxuICAgICAgICAgICAgdGFyZ2V0OiBmaWxlLmhhc2hcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAodGhpcy5vbGRBUEkpIHtcclxuICAgICAgICAgICAgcGFyYW1zLmNtZCA9ICdvcGVuJztcclxuICAgICAgICAgICAgcGFyYW1zLmN1cnJlbnQgPSBmaWxlLnBoYXNoO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLnVybCArICh0aGlzLm9wdGlvbnMudXJsLmluZGV4T2YoJz8nKSA9PT0gLTEgPyAnPycgOiAnJicpICsgJC5wYXJhbShwYXJhbXMsIHRydWUpO1xyXG4gICAgfTsgLyoqXHJcblx0ICogUmV0dXJuIHRodW1ibmFpbCB1cmxcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIFN0cmluZyAgZmlsZSBoYXNoXHJcblx0ICogQHJldHVybiBTdHJpbmdcclxuXHQgKi9cclxuICAgIHRoaXMudG1iID0gZnVuY3Rpb24oaGFzaCkge1xyXG4gICAgICAgIHZhciBmaWxlID0gZmlsZXNbaGFzaF0sXHJcbiAgICAgICAgICAgIHVybCA9IGZpbGUgJiYgZmlsZS50bWIgJiYgZmlsZS50bWIgIT0gMSA/IGN3ZE9wdGlvbnNbJ3RtYlVybCddICsgZmlsZS50bWIgOiAnJztcclxuXHJcbiAgICAgICAgaWYgKHVybCAmJiAodGhpcy5VQS5PcGVyYSB8fCB0aGlzLlVBLklFKSkge1xyXG4gICAgICAgICAgICB1cmwgKz0gJz9fPScgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVybDtcclxuICAgIH07IC8qKlxyXG5cdCAqIFJldHVybiBzZWxlY3RlZCBmaWxlcyBoYXNoZXNcclxuXHQgKlxyXG5cdCAqIEByZXR1cm4gQXJyYXlcclxuXHQgKiovXHJcbiAgICB0aGlzLnNlbGVjdGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkLnNsaWNlKDApO1xyXG4gICAgfTsgLyoqXHJcblx0ICogUmV0dXJuIHNlbGVjdGVkIGZpbGVzIGluZm9cclxuXHQgKiBcclxuXHQgKiBAcmV0dXJuIEFycmF5XHJcblx0ICovXHJcbiAgICB0aGlzLnNlbGVjdGVkRmlsZXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gJC5tYXAoc2VsZWN0ZWQsIGZ1bmN0aW9uKGhhc2gpIHsgcmV0dXJuIGZpbGVzW2hhc2hdID8gJC5leHRlbmQoe30sIGZpbGVzW2hhc2hdKSA6IG51bGw7IH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuXHQgKiBSZXR1cm4gdHJ1ZSBpZiBmaWxlIHdpdGggcmVxdWlyZWQgbmFtZSBleGlzdHNpbiByZXF1aXJlZCBmb2xkZXJcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIFN0cmluZyAgZmlsZSBuYW1lXHJcblx0ICogQHBhcmFtICBTdHJpbmcgIHBhcmVudCBmb2xkZXIgaGFzaFxyXG5cdCAqIEByZXR1cm4gQm9vbGVhblxyXG5cdCAqL1xyXG4gICAgdGhpcy5maWxlQnlOYW1lID0gZnVuY3Rpb24obmFtZSwgcGhhc2gpIHtcclxuICAgICAgICB2YXIgaGFzaDtcclxuXHJcbiAgICAgICAgZm9yIChoYXNoIGluIGZpbGVzKSB7XHJcbiAgICAgICAgICAgIGlmIChmaWxlcy5oYXNPd25Qcm9wZXJ0eShoYXNoKSAmJiBmaWxlc1toYXNoXS5waGFzaCA9PSBwaGFzaCAmJiBmaWxlc1toYXNoXS5uYW1lID09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlc1toYXNoXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcblx0ICogVmFsaWQgZGF0YSBmb3IgcmVxdWlyZWQgY29tbWFuZCBiYXNlZCBvbiBydWxlc1xyXG5cdCAqIFxyXG5cdCAqIEBwYXJhbSAgU3RyaW5nICBjb21tYW5kIG5hbWVcclxuXHQgKiBAcGFyYW0gIE9iamVjdCAgY2FtbWFuZCdzIGRhdGFcclxuXHQgKiBAcmV0dXJuIEJvb2xlYW5cclxuXHQgKi9cclxuICAgIHRoaXMudmFsaWRSZXNwb25zZSA9IGZ1bmN0aW9uKGNtZCwgZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBkYXRhLmVycm9yIHx8IHRoaXMucnVsZXNbdGhpcy5ydWxlc1tjbWRdID8gY21kIDogJ2RlZmF1bHRzJ10oZGF0YSk7XHJcbiAgICB9OyAvKipcclxuXHQgKiBQcm9jY2VzcyBhamF4IHJlcXVlc3QuXHJcblx0ICogRmlyZWQgZXZlbnRzIDpcclxuXHQgKiBAZXhhbXBsZVxyXG5cdCAqIEByZXR1cm4gJC5EZWZlcnJlZFxyXG5cdCAqL1xyXG4gICAgdGhpcy5yZXF1ZXN0ID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgbyA9IHRoaXMub3B0aW9ucyxcclxuICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKSxcclxuICAgICAgICAgICAgLy8gcmVxdWVzdCBkYXRhXHJcbiAgICAgICAgICAgIGRhdGEgPSAkLmV4dGVuZCh7fSwgby5jdXN0b21EYXRhLCB7IG1pbWVzOiBvLm9ubHlNaW1lcyB9LCBvcHRpb25zLmRhdGEgfHwgb3B0aW9ucyksXHJcbiAgICAgICAgICAgIC8vIGNvbW1hbmQgbmFtZVxyXG4gICAgICAgICAgICBjbWQgPSBkYXRhLmNtZCxcclxuICAgICAgICAgICAgLy8gY2FsbCBkZWZhdWx0IGZhaWwgY2FsbGJhY2sgKGRpc3BsYXkgZXJyb3IgZGlhbG9nKSA/XHJcbiAgICAgICAgICAgIGRlZmZhaWwgPSAhKG9wdGlvbnMucHJldmVudERlZmF1bHQgfHwgb3B0aW9ucy5wcmV2ZW50RmFpbCksXHJcbiAgICAgICAgICAgIC8vIGNhbGwgZGVmYXVsdCBzdWNjZXNzIGNhbGxiYWNrID9cclxuICAgICAgICAgICAgZGVmZG9uZSA9ICEob3B0aW9ucy5wcmV2ZW50RGVmYXVsdCB8fCBvcHRpb25zLnByZXZlbnREb25lKSxcclxuICAgICAgICAgICAgLy8gb3B0aW9ucyBmb3Igbm90aWZ5IGRpYWxvZ1xyXG4gICAgICAgICAgICBub3RpZnkgPSAkLmV4dGVuZCh7fSwgb3B0aW9ucy5ub3RpZnkpLFxyXG4gICAgICAgICAgICAvLyBkbyBub3Qgbm9ybWFsaXplIGRhdGEgLSByZXR1cm4gYXMgaXNcclxuICAgICAgICAgICAgcmF3ID0gISFvcHRpb25zLnJhdyxcclxuICAgICAgICAgICAgLy8gc3luYyBmaWxlcyBvbiByZXF1ZXN0IGZhaWxcclxuICAgICAgICAgICAgc3luY09uRmFpbCA9IG9wdGlvbnMuc3luY09uRmFpbCxcclxuICAgICAgICAgICAgLy8gb3BlbiBub3RpZnkgZGlhbG9nIHRpbWVvdXRcdFx0XHJcbiAgICAgICAgICAgIHRpbWVvdXQsXHJcbiAgICAgICAgICAgIC8vIHJlcXVlc3Qgb3B0aW9uc1xyXG4gICAgICAgICAgICBvcHRpb25zID0gJC5leHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiBvLnVybCxcclxuICAgICAgICAgICAgICAgIGFzeW5jOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogdGhpcy5yZXF1ZXN0VHlwZSxcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAvLyB0aW1lb3V0ICA6IDEwMCxcclxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFcclxuICAgICAgICAgICAgfSwgb3B0aW9ucy5vcHRpb25zIHx8IHt9KSxcclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIERlZmF1bHQgc3VjY2VzcyBoYW5kbGVyLiBcclxuXHRcdFx0ICogQ2FsbCBkZWZhdWx0IGRhdGEgaGFuZGxlcnMgYW5kIGZpcmUgZXZlbnQgd2l0aCBjb21tYW5kIG5hbWUuXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEBwYXJhbSBPYmplY3QgIG5vcm1hbGl6ZWQgcmVzcG9uc2UgZGF0YVxyXG5cdFx0XHQgKiBAcmV0dXJuIHZvaWRcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBkb25lID0gZnVuY3Rpb24oZGF0YSkge1xyXG5cclxuICAgICAgICAgICAgICAgIGRhdGEud2FybmluZyAmJiBzZWxmLmVycm9yKGRhdGEud2FybmluZyk7XHJcblxyXG4gICAgICAgICAgICAgICAgY21kID09ICdvcGVuJyAmJiBvcGVuKCQuZXh0ZW5kKHRydWUsIHt9LCBkYXRhKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZmlyZSBzb21lIGV2ZW50IHRvIHVwZGF0ZSBjYWNoZS91aVxyXG4gICAgICAgICAgICAgICAgZGF0YS5yZW1vdmVkICYmIGRhdGEucmVtb3ZlZC5sZW5ndGggJiYgc2VsZi5yZW1vdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBkYXRhLmFkZGVkICYmIGRhdGEuYWRkZWQubGVuZ3RoICYmIHNlbGYuYWRkKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgZGF0YS5jaGFuZ2VkICYmIGRhdGEuY2hhbmdlZC5sZW5ndGggJiYgc2VsZi5jaGFuZ2UoZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZmlyZSBldmVudCB3aXRoIGNvbW1hbmQgbmFtZVxyXG4gICAgICAgICAgICAgICAgc2VsZi50cmlnZ2VyKGNtZCwgZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZm9yY2UgdXBkYXRlIGNvbnRlbnRcclxuICAgICAgICAgICAgICAgIGRhdGEuc3luYyAmJiBzZWxmLnN5bmMoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIFJlcXVlc3QgZXJyb3IgaGFuZGxlci4gUmVqZWN0IGRmcmQgd2l0aCBjb3JyZWN0IGVycm9yIG1lc3NhZ2UuXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEBwYXJhbSBqcXhociAgcmVxdWVzdCBvYmplY3RcclxuXHRcdFx0ICogQHBhcmFtIFN0cmluZyByZXF1ZXN0IHN0YXR1c1xyXG5cdFx0XHQgKiBAcmV0dXJuIHZvaWRcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBlcnJvciA9IGZ1bmN0aW9uKHhociwgc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3I7XHJcblxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChzdGF0dXMpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2Fib3J0JzpcclxuICAgICAgICAgICAgICAgICAgICBlcnJvciA9IHhoci5xdWlldCA/ICcnIDogWydlcnJDb25uZWN0JywgJ2VyckFib3J0J107XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0aW1lb3V0JzpcclxuICAgICAgICAgICAgICAgICAgICBlcnJvciA9IFsnZXJyQ29ubmVjdCcsICdlcnJUaW1lb3V0J107XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdwYXJzZXJlcnJvcic6XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBbJ2VyclJlc3BvbnNlJywgJ2VyckRhdGFOb3RKU09OJ107XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09IDQwMykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IFsnZXJyQ29ubmVjdCcsICdlcnJBY2Nlc3MnXTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHhoci5zdGF0dXMgPT0gNDA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gWydlcnJDb25uZWN0JywgJ2Vyck5vdEZvdW5kJ107XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAnZXJyQ29ubmVjdCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yLCB4aHIsIHN0YXR1cyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBSZXF1ZXN0IHN1Y2Nlc3MgaGFuZGxlci4gVmFsaWQgcmVzcG9uc2UgZGF0YSBhbmQgcmVqZWN0L3Jlc29sdmUgZGZyZC5cclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHBhcmFtIE9iamVjdCAgcmVzcG9uc2UgZGF0YVxyXG5cdFx0XHQgKiBAcGFyYW0gU3RyaW5nIHJlcXVlc3Qgc3RhdHVzXHJcblx0XHRcdCAqIEByZXR1cm4gdm9pZFxyXG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIHN1Y2Nlc3MgPSBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJhdykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlc29sdmUocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoWydlcnJSZXNwb25zZScsICdlcnJEYXRhRW1wdHknXSwgeGhyKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoISQuaXNQbGFpbk9iamVjdChyZXNwb25zZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoWydlcnJSZXNwb25zZScsICdlcnJEYXRhTm90SlNPTiddLCB4aHIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZWR1cmwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaXNNb2RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudC5NYXN0ZXIgJiYgcGFyZW50Lk1hc3Rlci5nb1VybCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5NYXN0ZXIuZ29VcmwocmVzcG9uc2UucmVkdXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcmVzcG9uc2UucmVkdXJsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UubG9nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlICYmIHdpbmRvdy5jb25zb2xlLmxvZyAmJiB3aW5kb3cuY29uc29sZS5sb2cocmVzcG9uc2UubG9nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KHJlc3BvbnNlLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KHJlc3BvbnNlLmVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNlbGYudmFsaWRSZXNwb25zZShjbWQsIHJlc3BvbnNlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgnZXJyUmVzcG9uc2UnLCB4aHIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5ub3JtYWxpemUocmVzcG9uc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghc2VsZi5hcGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFwaSA9IHJlc3BvbnNlLmFwaSB8fCAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubmV3QVBJID0gc2VsZi5hcGkgPj0gMjtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLm9sZEFQSSA9ICFzZWxmLm5ld0FQSTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIGN3ZE9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgY3dkT3B0aW9ucywgcmVzcG9uc2Uub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm5ldERyaXZlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLm5ldERyaXZlcnMgPSByZXNwb25zZS5uZXREcml2ZXJzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGRmcmQucmVzb2x2ZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZS5kZWJ1ZyAmJiBzZWxmLmRlYnVnKCdiYWNrZW5kLWRlYnVnJywgcmVzcG9uc2UuZGVidWcpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB4aHIsXHJcbiAgICAgICAgICAgIF94aHI7XHJcblxyXG4gICAgICAgIGRlZmRvbmUgJiYgZGZyZC5kb25lKGRvbmUpO1xyXG4gICAgICAgIGRmcmQuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGRlZmZhaWwgPyBzZWxmLmVycm9yKGVycm9yKSA6IHNlbGYuZGVidWcoJ2Vycm9yJywgc2VsZi5pMThuKGVycm9yKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoIWNtZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoJ2VyckNtZFJlcScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHN5bmNPbkZhaWwpIHtcclxuICAgICAgICAgICAgZGZyZC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvciAmJiBzZWxmLnN5bmMoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobm90aWZ5LnR5cGUgJiYgbm90aWZ5LmNudCkge1xyXG4gICAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYubm90aWZ5KG5vdGlmeSk7XHJcbiAgICAgICAgICAgICAgICBkZnJkLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RpZnkuY250ID0gLShwYXJzZUludChub3RpZnkuY250KSB8fCAwKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLm5vdGlmeShub3RpZnkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sIHNlbGYubm90aWZ5RGVsYXkpO1xyXG4gICAgICAgICAgICBkZnJkLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBxdWlldCBhYm9ydCBub3QgY29tcGxldGVkIFwib3BlblwiIHJlcXVlc3RzXHJcbiAgICAgICAgaWYgKGNtZCA9PSAnb3BlbicpIHtcclxuICAgICAgICAgICAgd2hpbGUgKChfeGhyID0gcXVldWUucG9wKCkpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3hoci5zdGF0ZSgpID09ICdwZW5kaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgIF94aHIucXVpZXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIF94aHIuYWJvcnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZGVsZXRlIG9wdGlvbnMucHJldmVudEZhaWw7XHJcbiAgICAgICAgeGhyID0gdGhpcy50cmFuc3BvcnQuc2VuZChvcHRpb25zKS5mYWlsKGVycm9yKS5kb25lKHN1Y2Nlc3MpO1xyXG5cclxuICAgICAgICAvLyB0aGlzLnRyYW5zcG9ydC5zZW5kKG9wdGlvbnMpXHJcblxyXG4gICAgICAgIC8vIGFkZCBcIm9wZW5cIiB4aHIgaW50byBxdWV1ZVxyXG4gICAgICAgIGlmIChjbWQgPT0gJ29wZW4nKSB7XHJcbiAgICAgICAgICAgIHF1ZXVlLnVuc2hpZnQoeGhyKTtcclxuICAgICAgICAgICAgZGZyZC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmR4ID0gJC5pbkFycmF5KHhociwgcXVldWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIG5keCAhPT0gLTEgJiYgcXVldWUuc3BsaWNlKG5keCwgMSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGRmcmQ7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIENvbXBhcmUgY3VycmVudCBmaWxlcyBjYWNoZSB3aXRoIG5ldyBmaWxlcyBhbmQgcmV0dXJuIGRpZmZcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIEFycmF5ICBuZXcgZmlsZXNcclxuXHQgKiBAcmV0dXJuIE9iamVjdFxyXG5cdCAqL1xyXG4gICAgdGhpcy5kaWZmID0gZnVuY3Rpb24oaW5jb21pbmcpIHtcclxuICAgICAgICB2YXIgcmF3ID0ge30sXHJcbiAgICAgICAgICAgIGFkZGVkID0gW10sXHJcbiAgICAgICAgICAgIHJlbW92ZWQgPSBbXSxcclxuICAgICAgICAgICAgY2hhbmdlZCA9IFtdLFxyXG4gICAgICAgICAgICBpc0NoYW5nZWQgPSBmdW5jdGlvbihoYXNoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbCA9IGNoYW5nZWQubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgICAgIHdoaWxlIChsLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlZFtsXS5oYXNoID09IGhhc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAkLmVhY2goaW5jb21pbmcsIGZ1bmN0aW9uKGksIGYpIHtcclxuICAgICAgICAgICAgcmF3W2YuaGFzaF0gPSBmO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBmaW5kIHJlbW92ZWRcclxuICAgICAgICAkLmVhY2goZmlsZXMsIGZ1bmN0aW9uKGhhc2gsIGYpIHtcclxuICAgICAgICAgICAgIXJhd1toYXNoXSAmJiByZW1vdmVkLnB1c2goaGFzaCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGNvbXBhcmUgZmlsZXNcclxuICAgICAgICAkLmVhY2gocmF3LCBmdW5jdGlvbihoYXNoLCBmaWxlKSB7XHJcbiAgICAgICAgICAgIHZhciBvcmlnaW4gPSBmaWxlc1toYXNoXTtcclxuXHJcbiAgICAgICAgICAgIGlmICghb3JpZ2luKSB7XHJcbiAgICAgICAgICAgICAgICBhZGRlZC5wdXNoKGZpbGUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGZpbGUsIGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZVtwcm9wXSAhPSBvcmlnaW5bcHJvcF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlZC5wdXNoKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gcGFyZW50cyBvZiByZW1vdmVkIGRpcnMgbWFyayBhcyBjaGFuZ2VkIChyZXF1aXJlZCBmb3IgdHJlZSBjb3JyZWN0IHdvcmspXHJcbiAgICAgICAgJC5lYWNoKHJlbW92ZWQsIGZ1bmN0aW9uKGksIGhhc2gpIHtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSBmaWxlc1toYXNoXSxcclxuICAgICAgICAgICAgICAgIHBoYXNoID0gZmlsZS5waGFzaDtcclxuXHJcbiAgICAgICAgICAgIGlmIChwaGFzaFxyXG4gICAgICAgICAgICAgICAgJiYgZmlsZS5taW1lID09ICdkaXJlY3RvcnknXHJcbiAgICAgICAgICAgICAgICAmJiAkLmluQXJyYXkocGhhc2gsIHJlbW92ZWQpID09PSAtMVxyXG4gICAgICAgICAgICAgICAgJiYgcmF3W3BoYXNoXVxyXG4gICAgICAgICAgICAgICAgJiYgIWlzQ2hhbmdlZChwaGFzaCkpIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZWQucHVzaChyYXdbcGhhc2hdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBhZGRlZDogYWRkZWQsXHJcbiAgICAgICAgICAgIHJlbW92ZWQ6IHJlbW92ZWQsXHJcbiAgICAgICAgICAgIGNoYW5nZWQ6IGNoYW5nZWRcclxuICAgICAgICB9O1xyXG4gICAgfTsgLyoqXHJcblx0ICogU3luYyBjb250ZW50XHJcblx0ICogXHJcblx0ICogQHJldHVybiBqUXVlcnkuRGVmZXJyZWRcclxuXHQgKi9cclxuICAgIHRoaXMuc3luYyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKS5kb25lKGZ1bmN0aW9uKCkgeyBzZWxmLnRyaWdnZXIoJ3N5bmMnKTsgfSksXHJcbiAgICAgICAgICAgIG9wdHMxID0ge1xyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdvcGVuJywgaW5pdDogMSwgdGFyZ2V0OiBjd2QsIHRyZWU6IHRoaXMudWkudHJlZSA/IDEgOiAwIH0sXHJcbiAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogdHJ1ZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcHRzMiA9IHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAndHJlZScsIHRhcmdldDogKGN3ZCA9PSB0aGlzLnJvb3QoKSkgPyBjd2QgOiB0aGlzLmZpbGUoY3dkKS5waGFzaCB9LFxyXG4gICAgICAgICAgICAgICAgcHJldmVudERlZmF1bHQ6IHRydWVcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJC53aGVuKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0KG9wdHMxKSxcclxuICAgICAgICAgICAgICAgIHRoaXMucmVxdWVzdChvcHRzMilcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgZXJyb3IgJiYgc2VsZi5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogJ29wZW4nLCB0YXJnZXQ6IHNlbGYubGFzdERpcignJyksIHRyZWU6IDEsIGluaXQ6IDEgfSxcclxuICAgICAgICAgICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ29wZW4nLCBjbnQ6IDEsIGhpZGVDbnQ6IHRydWUgfSxcclxuICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKG9kYXRhLCBwZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRpZmYgPSBzZWxmLmRpZmYob2RhdGEuZmlsZXMuY29uY2F0KHBkYXRhICYmIHBkYXRhLnRyZWUgPyBwZGF0YS50cmVlIDogW10pKTtcclxuXHJcbiAgICAgICAgICAgICAgICBkaWZmLmFkZGVkLnB1c2gob2RhdGEuY3dkKTtcclxuICAgICAgICAgICAgICAgIGRpZmYucmVtb3ZlZC5sZW5ndGggJiYgc2VsZi5yZW1vdmUoZGlmZik7XHJcbiAgICAgICAgICAgICAgICBkaWZmLmFkZGVkLmxlbmd0aCAmJiBzZWxmLmFkZChkaWZmKTtcclxuICAgICAgICAgICAgICAgIGRpZmYuY2hhbmdlZC5sZW5ndGggJiYgc2VsZi5jaGFuZ2UoZGlmZik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZXNvbHZlKGRpZmYpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGRmcmQ7XHJcbiAgICB9O1xyXG4gICAgdGhpcy51cGxvYWQgPSBmdW5jdGlvbihmaWxlcywgbm90VXBsb2FkLCBkdWJsaWNhdGVJbmRleGVzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNwb3J0LnVwbG9hZChmaWxlcywgdGhpcywgbm90VXBsb2FkLCBkdWJsaWNhdGVJbmRleGVzKTtcclxuICAgIH07IC8qKlxyXG5cdCAqIEF0dGFjaCBsaXN0ZW5lciB0byBldmVudHNcclxuXHQgKiBUbyBiaW5kIHRvIG11bHRpcGx5IGV2ZW50cyBhdCBvbmNlLCBzZXBhcmF0ZSBldmVudHMgbmFtZXMgYnkgc3BhY2VcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIFN0cmluZyAgZXZlbnQocykgbmFtZShzKVxyXG5cdCAqIEBwYXJhbSAgT2JqZWN0ICBldmVudCBoYW5kbGVyXHJcblx0ICogQHJldHVybiBlbEZpbmRlclxyXG5cdCAqL1xyXG4gICAgdGhpcy5iaW5kID0gZnVuY3Rpb24oZXZlbnQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIGk7XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgKGNhbGxiYWNrKSA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGV2ZW50ID0gKCcnICsgZXZlbnQpLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBldmVudC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxpc3RlbmVyc1tldmVudFtpXV0gPT09IHZvaWQgKDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJzW2V2ZW50W2ldXSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGlzdGVuZXJzW2V2ZW50W2ldXS5wdXNoKGNhbGxiYWNrKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcblx0ICogUmVtb3ZlIGV2ZW50IGxpc3RlbmVyIGlmIGV4aXN0c1xyXG5cdCAqXHJcblx0ICogQHBhcmFtICBTdHJpbmcgICAgZXZlbnQgbmFtZVxyXG5cdCAqIEBwYXJhbSAgRnVuY3Rpb24gIGNhbGxiYWNrXHJcblx0ICogQHJldHVybiBlbEZpbmRlclxyXG5cdCAqL1xyXG4gICAgdGhpcy51bmJpbmQgPSBmdW5jdGlvbihldmVudCwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgbCA9IGxpc3RlbmVyc1soJycgKyBldmVudCkudG9Mb3dlckNhc2UoKV0gfHwgW10sXHJcbiAgICAgICAgICAgIGkgPSBsLmluZGV4T2YoY2FsbGJhY2spO1xyXG5cclxuICAgICAgICBpID4gLTEgJiYgbC5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgLy9kZWxldGUgY2FsbGJhY2s7IC8vIG5lZWQgdGhpcz9cclxuICAgICAgICBjYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIEZpcmUgZXZlbnQgLSBzZW5kIG5vdGlmaWNhdGlvbiB0byBhbGwgZXZlbnQgbGlzdGVuZXJzXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gIFN0cmluZyAgIGV2ZW50IHR5cGVcclxuXHQgKiBAcGFyYW0gIE9iamVjdCAgIGRhdGEgdG8gc2VuZCBhY3Jvc3MgZXZlbnRcclxuXHQgKiBAcmV0dXJuIGVsRmluZGVyXHJcblx0ICovXHJcbiAgICB0aGlzLnRyaWdnZXIgPSBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgIHZhciBldmVudCA9IGV2ZW50LnRvTG93ZXJDYXNlKCksXHJcbiAgICAgICAgICAgIGhhbmRsZXJzID0gbGlzdGVuZXJzW2V2ZW50XSB8fCBbXSxcclxuICAgICAgICAgICAgaSxcclxuICAgICAgICAgICAgajtcclxuXHJcbiAgICAgICAgdGhpcy5kZWJ1ZygnZXZlbnQtJyArIGV2ZW50LCBkYXRhKTtcclxuICAgICAgICBpZiAoaGFuZGxlcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGV2ZW50ID0gJC5FdmVudChldmVudCk7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaGFuZGxlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIC8vIHRvIGF2b2lkIGRhdGEgbW9kaWZpY2F0aW9ucy4gcmVtZW1iZXIgYWJvdXQgXCJzaGFyaW5nXCIgcGFzc2luZyBhcmd1bWVudHMgaW4ganMgOikgXHJcbiAgICAgICAgICAgICAgICBldmVudC5kYXRhID0gJC5leHRlbmQodHJ1ZSwge30sIGRhdGEpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhbmRsZXJzW2ldKGV2ZW50LCB0aGlzKSA9PT0gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgfHwgZXZlbnQuaXNEZWZhdWx0UHJldmVudGVkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZygnZXZlbnQtc3RvcGVkJywgZXZlbnQudHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUgJiYgd2luZG93LmNvbnNvbGUubG9nICYmIHdpbmRvdy5jb25zb2xlLmxvZyhleCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTsgLyoqXHJcblx0ICogQmluZCBrZXlib3JkIHNob3J0Y3V0IHRvIGtleWRvd24gZXZlbnRcclxuXHQgKlxyXG5cdCAqIEBleGFtcGxlXHJcblx0ICogICAgZWxmaW5kZXIuc2hvcnRjdXQoeyBcclxuXHQgKiAgICAgICBwYXR0ZXJuIDogJ2N0cmwrYScsIFxyXG5cdCAqICAgICAgIGRlc2NyaXB0aW9uIDogJ1NlbGVjdCBhbGwgZmlsZXMnLCBcclxuXHQgKiAgICAgICBjYWxsYmFjayA6IGZ1bmN0aW9uKGUpIHsgLi4uIH0sIFxyXG5cdCAqICAgICAgIGtleXByZXNzIDogdHJ1ZXxmYWxzZSAoYmluZCB0byBrZXlwcmVzcyBpbnN0ZWFkIG9mIGtleWRvd24pIFxyXG5cdCAqICAgIH0pXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gIE9iamVjdCAgc2hvcnRjdXQgY29uZmlnXHJcblx0ICogQHJldHVybiBlbEZpbmRlclxyXG5cdCAqL1xyXG4gICAgdGhpcy5zaG9ydGN1dCA9IGZ1bmN0aW9uKHMpIHtcclxuICAgICAgICB2YXIgcGF0dGVybnMsIHBhdHRlcm4sIGNvZGUsIGksIHBhcnRzO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmFsbG93U2hvcnRjdXRzICYmIHMucGF0dGVybiAmJiAkLmlzRnVuY3Rpb24ocy5jYWxsYmFjaykpIHtcclxuICAgICAgICAgICAgcGF0dGVybnMgPSBzLnBhdHRlcm4udG9VcHBlckNhc2UoKS5zcGxpdCgvXFxzKy8pO1xyXG5cclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBhdHRlcm5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBwYXR0ZXJuID0gcGF0dGVybnNbaV07XHJcbiAgICAgICAgICAgICAgICBwYXJ0cyA9IHBhdHRlcm4uc3BsaXQoJysnKTtcclxuICAgICAgICAgICAgICAgIGNvZGUgPSAoY29kZSA9IHBhcnRzLnBvcCgpKS5sZW5ndGggPT0gMVxyXG4gICAgICAgICAgICAgICAgICAgID8gY29kZSA+IDAgPyBjb2RlIDogY29kZS5jaGFyQ29kZUF0KDApXHJcbiAgICAgICAgICAgICAgICAgICAgOiAkLnVpLmtleUNvZGVbY29kZV07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGNvZGUgJiYgIXNob3J0Y3V0c1twYXR0ZXJuXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNob3J0Y3V0c1twYXR0ZXJuXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5Q29kZTogY29kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWx0S2V5OiAkLmluQXJyYXkoJ0FMVCcsIHBhcnRzKSAhPSAtMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3RybEtleTogJC5pbkFycmF5KCdDVFJMJywgcGFydHMpICE9IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGlmdEtleTogJC5pbkFycmF5KCdTSElGVCcsIHBhcnRzKSAhPSAtMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogcy50eXBlIHx8ICdrZXlkb3duJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IHMuY2FsbGJhY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBzLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuOiBwYXR0ZXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07IC8qKlxyXG5cdCAqIFJlZ2lzdGVyZWQgc2hvcnRjdXRzXHJcblx0ICpcclxuXHQgKiBAdHlwZSBPYmplY3RcclxuXHQgKiovXHJcbiAgICB0aGlzLnNob3J0Y3V0cyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciByZXQgPSBbXTtcclxuXHJcbiAgICAgICAgJC5lYWNoKHNob3J0Y3V0cywgZnVuY3Rpb24oaSwgcykge1xyXG4gICAgICAgICAgICByZXQucHVzaChbcy5wYXR0ZXJuLCBzZWxmLmkxOG4ocy5kZXNjcmlwdGlvbildKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuXHQgKiBHZXQvc2V0IGNsaXBib2FyZCBjb250ZW50LlxyXG5cdCAqIFJldHVybiBuZXcgY2xpcGJvYXJkIGNvbnRlbnQuXHJcblx0ICpcclxuXHQgKiBAZXhhbXBsZVxyXG5cdCAqICAgdGhpcy5jbGlwYm9hcmQoW10pIC0gY2xlYW4gY2xpcGJvYXJkXHJcblx0ICogICB0aGlzLmNsaXBib2FyZChbey4uLn0sIHsuLi59XSwgdHJ1ZSkgLSBwdXQgMiBmaWxlcyBpbiBjbGlwYm9hcmQgYW5kIG1hcmsgaXQgYXMgY3V0dGVkXHJcblx0ICogXHJcblx0ICogQHBhcmFtICBBcnJheSAgICBuZXcgZmlsZXMgaGFzaGVzXHJcblx0ICogQHBhcmFtICBCb29sZWFuICBjdXQgZmlsZXM/XHJcblx0ICogQHJldHVybiBBcnJheVxyXG5cdCAqL1xyXG4gICAgdGhpcy5jbGlwYm9hcmQgPSBmdW5jdGlvbihoYXNoZXMsIGN1dCkge1xyXG4gICAgICAgIHZhciBtYXAgPSBmdW5jdGlvbigpIHsgcmV0dXJuICQubWFwKGNsaXBib2FyZCwgZnVuY3Rpb24oZikgeyByZXR1cm4gZi5oYXNoOyB9KTsgfTtcclxuICAgICAgICBpZiAoaGFzaGVzICE9PSB2b2lkICgwKSkge1xyXG4gICAgICAgICAgICBjbGlwYm9hcmQubGVuZ3RoICYmIHRoaXMudHJpZ2dlcigndW5sb2NrZmlsZXMnLCB7IGZpbGVzOiBtYXAoKSB9KTtcclxuICAgICAgICAgICAgcmVtZW1iZXIgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGNsaXBib2FyZCA9ICQubWFwKGhhc2hlcyB8fCBbXSwgZnVuY3Rpb24oaGFzaCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZpbGUgPSBmaWxlc1toYXNoXTtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJlbWVtYmVyLnB1c2goaGFzaCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6IGhhc2gsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBoYXNoOiBmaWxlLnBoYXNoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBmaWxlLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbWU6IGZpbGUubWltZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZDogZmlsZS5yZWFkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NrZWQ6IGZpbGUubG9ja2VkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXQ6ICEhY3V0XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2VjbGlwYm9hcmQnLCB7IGNsaXBib2FyZDogY2xpcGJvYXJkLnNsaWNlKDAsIGNsaXBib2FyZC5sZW5ndGgpIH0pO1xyXG4gICAgICAgICAgICBjdXQgJiYgdGhpcy50cmlnZ2VyKCdsb2NrZmlsZXMnLCB7IGZpbGVzOiBtYXAoKSB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHJldHVybiBjb3B5IG9mIGNsaXBib2FyZCBpbnN0ZWFkIG9mIHJlZnJlbmNlXHJcbiAgICAgICAgcmV0dXJuIGNsaXBib2FyZC5zbGljZSgwLCBjbGlwYm9hcmQubGVuZ3RoKTtcclxuICAgIH07IC8qKlxyXG5cdCAqIFJldHVybiB0cnVlIGlmIGNvbW1hbmQgZW5hYmxlZFxyXG5cdCAqIFxyXG5cdCAqIEBwYXJhbSAgU3RyaW5nICBjb21tYW5kIG5hbWVcclxuXHQgKiBAcmV0dXJuIEJvb2xlYW5cclxuXHQgKi9cclxuICAgIHRoaXMuaXNDb21tYW5kRW5hYmxlZCA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY29tbWFuZHNbbmFtZV0gPyAkLmluQXJyYXkobmFtZSwgY3dkT3B0aW9ucy5kaXNhYmxlZCkgPT09IC0xIDogZmFsc2U7XHJcbiAgICB9OyAvKipcclxuXHQgKiBFeGVjIGNvbW1hbmQgYW5kIHJldHVybiByZXN1bHQ7XHJcblx0ICpcclxuXHQgKiBAcGFyYW0gIFN0cmluZyAgICAgICAgIGNvbW1hbmQgbmFtZVxyXG5cdCAqIEBwYXJhbSAgU3RyaW5nfEFycmF5ICAgdXN1YWx5IGZpbGVzIGhhc2hlc1xyXG5cdCAqIEBwYXJhbSAgU3RyaW5nfEFycmF5ICAgY29tbWFuZCBvcHRpb25zXHJcblx0ICogQHJldHVybiAkLkRlZmVycmVkXHJcblx0ICovXHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihjbWQsIGZpbGVzLCBvcHRzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbW1hbmRzW2NtZF0gJiYgdGhpcy5pc0NvbW1hbmRFbmFibGVkKGNtZClcclxuICAgICAgICAgICAgPyB0aGlzLl9jb21tYW5kc1tjbWRdLmV4ZWMoZmlsZXMsIG9wdHMpXHJcbiAgICAgICAgICAgIDogJC5EZWZlcnJlZCgpLnJlamVjdCgnTm8gc3VjaCBjb21tYW5kJyk7XHJcbiAgICB9OyAvKipcclxuXHQgKiBDcmVhdGUgYW5kIHJldHVybiBkaWFsb2cuXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gIFN0cmluZ3xET01FbGVtZW50ICBkaWFsb2cgY29udGVudFxyXG5cdCAqIEBwYXJhbSAgT2JqZWN0ICAgICAgICAgICAgIGRpYWxvZyBvcHRpb25zXHJcblx0ICogQHJldHVybiBqUXVlcnlcclxuXHQgKi9cclxuICAgIHRoaXMuZGlhbG9nID0gZnVuY3Rpb24oY29udGVudCwgb3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiAkKCc8ZGl2Lz4nKS5hcHBlbmQoY29udGVudCkuYXBwZW5kVG8obm9kZSkuZWxmaW5kZXJjcnlwdHhkaWFsb2cob3B0aW9ucyk7XHJcbiAgICAgICAgLy9yZXR1cm4gJCgnPGRpdi8+JykuYXBwZW5kKGNvbnRlbnQpLmFwcGVuZFRvKG5vZGUpLmVsZmluZGVyZGlhbG9nKG9wdGlvbnMpO1xyXG4gICAgfTsgLyoqXHJcblx0ICogUmV0dXJuIFVJIHdpZGdldCBvciBub2RlXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gIFN0cmluZyAgdWkgbmFtZVxyXG5cdCAqIEByZXR1cm4galF1ZXJ5XHJcblx0ICovXHJcbiAgICB0aGlzLmdldFVJID0gZnVuY3Rpb24odWkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy51aVt1aV0gfHwgbm9kZTtcclxuICAgIH07XHJcbiAgICB0aGlzLmNvbW1hbmQgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIG5hbWUgPT09IHZvaWQgKDApID8gdGhpcy5fY29tbWFuZHMgOiB0aGlzLl9jb21tYW5kc1tuYW1lXTtcclxuICAgIH07IC8qKlxyXG5cdCAqIFJlc2l6ZSBlbGZpbmRlciBub2RlXHJcblx0ICogXHJcblx0ICogQHBhcmFtICBTdHJpbmd8TnVtYmVyICB3aWR0aFxyXG5cdCAqIEBwYXJhbSAgTnVtYmVyICAgICAgICAgaGVpZ2h0XHJcblx0ICogQHJldHVybiB2b2lkXHJcblx0ICovXHJcbiAgICB0aGlzLnJlc2l6ZSA9IGZ1bmN0aW9uKHcsIGgpIHtcclxuICAgICAgICBub2RlLmNzcygnd2lkdGgnLCB3KS5oZWlnaHQoaCkudHJpZ2dlcigncmVzaXplJyk7XHJcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdyZXNpemUnLCB7XHJcbiAgICAgICAgICAgIHdpZHRoOiBub2RlLndpZHRoKCksXHJcbiAgICAgICAgICAgIGhlaWdodDogbm9kZS5oZWlnaHQoKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTsgLyoqXHJcblx0ICogUmVzdG9yZSBlbGZpbmRlciBub2RlIHNpemVcclxuXHQgKiBcclxuXHQgKiBAcmV0dXJuIGVsRmluZGVyXHJcblx0ICovXHJcbiAgICB0aGlzLnJlc3RvcmVTaXplID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5yZXNpemUod2lkdGgsIGhlaWdodCk7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbm9kZS5zaG93KCk7XHJcbiAgICAgICAgdGhpcy5lbmFibGUoKS50cmlnZ2VyKCdzaG93Jyk7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5oaWRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5kaXNhYmxlKCkudHJpZ2dlcignaGlkZScpO1xyXG4gICAgICAgIG5vZGUuaGlkZSgpO1xyXG4gICAgfTsgLyoqXHJcblx0ICogRGVzdHJveSB0aGlzIGVsRmluZGVyIGluc3RhbmNlXHJcblx0ICpcclxuXHQgKiBAcmV0dXJuIHZvaWRcclxuXHQgKiovXHJcbiAgICB0aGlzLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAobm9kZSAmJiBub2RlWzBdLmVsZmluZGVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignZGVzdHJveScpLmRpc2FibGUoKTtcclxuICAgICAgICAgICAgbGlzdGVuZXJzID0ge307XHJcbiAgICAgICAgICAgIHNob3J0Y3V0cyA9IHt9O1xyXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5hZGQobm9kZSkudW5iaW5kKCcuJyArIHRoaXMubmFtZXNwYWNlKTtcclxuICAgICAgICAgICAgc2VsZi50cmlnZ2VyID0gZnVuY3Rpb24oKSB7fTtcclxuICAgICAgICAgICAgbm9kZS5jaGlsZHJlbigpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBub2RlLmFwcGVuZChwcmV2Q29udGVudC5jb250ZW50cygpKS5yZW1vdmVDbGFzcyh0aGlzLmNzc0NsYXNzKS5hdHRyKCdzdHlsZScsIHByZXZTdHlsZSk7XHJcbiAgICAgICAgICAgIG5vZGVbMF0uZWxmaW5kZXIgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoc3luY0ludGVydmFsKSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHN5bmNJbnRlcnZhbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9OyAvKioqKioqKioqKioqKiAgaW5pdCBzdHVmZnMgICoqKioqKioqKioqKioqKiovXHJcblxyXG4gICAgLy8gY2hlY2sganF1ZXJ5IHVpXHJcbiAgICBpZiAoISgkLmZuLnNlbGVjdGFibGUgJiYgJC5mbi5kcmFnZ2FibGUgJiYgJC5mbi5kcm9wcGFibGUpKSB7XHJcbiAgICAgICAgcmV0dXJuIGFsZXJ0KHRoaXMuaTE4bignZXJySnF1aScpKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBjaGVjayBub2RlXHJcbiAgICBpZiAoIW5vZGUubGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGFsZXJ0KHRoaXMuaTE4bignZXJyTm9kZScpKTtcclxuICAgIH1cclxuICAgIC8vIGNoZWNrIGNvbm5lY3RvciB1cmxcclxuICAgIGlmICghdGhpcy5vcHRpb25zLnVybCkge1xyXG4gICAgICAgIHJldHVybiBhbGVydCh0aGlzLmkxOG4oJ2VyclVSTCcpKTtcclxuICAgIH1cclxuXHJcbiAgICAkLmV4dGVuZCgkLnVpLmtleUNvZGUsIHtcclxuICAgICAgICAnRjEnOiAxMTIsXHJcbiAgICAgICAgJ0YyJzogMTEzLFxyXG4gICAgICAgICdGMyc6IDExNCxcclxuICAgICAgICAnRjQnOiAxMTUsXHJcbiAgICAgICAgJ0Y1JzogMTE2LFxyXG4gICAgICAgICdGNic6IDExNyxcclxuICAgICAgICAnRjcnOiAxMTgsXHJcbiAgICAgICAgJ0Y4JzogMTE5LFxyXG4gICAgICAgICdGOSc6IDEyMFxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5kcmFnVXBsb2FkID0gZmFsc2U7XHJcbiAgICB0aGlzLnhoclVwbG9hZCA9ICh0eXBlb2YgWE1MSHR0cFJlcXVlc3RVcGxvYWQgIT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIFhNTEh0dHBSZXF1ZXN0RXZlbnRUYXJnZXQgIT0gJ3VuZGVmaW5lZCcpICYmIHR5cGVvZiBGaWxlICE9ICd1bmRlZmluZWQnICYmIHR5cGVvZiBGb3JtRGF0YSAhPSAndW5kZWZpbmVkJztcclxuXHJcbiAgICAvLyBjb25maWd1cmUgdHJhbnNwb3J0IG9iamVjdFxyXG4gICAgdGhpcy50cmFuc3BvcnQgPSB7fTtcclxuICAgIGlmICh0eXBlb2YgKHRoaXMub3B0aW9ucy50cmFuc3BvcnQpID09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgdGhpcy50cmFuc3BvcnQgPSB0aGlzLm9wdGlvbnMudHJhbnNwb3J0O1xyXG4gICAgICAgIGlmICh0eXBlb2YgKHRoaXMudHJhbnNwb3J0LmluaXQpID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgdGhpcy50cmFuc3BvcnQuaW5pdCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHR5cGVvZiAodGhpcy50cmFuc3BvcnQuc2VuZCkgIT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIHRoaXMudHJhbnNwb3J0LnNlbmQgPSBmdW5jdGlvbihvcHRzKSB7IHJldHVybiAkLmFqYXgob3B0cyk7IH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMudHJhbnNwb3J0LnVwbG9hZCA9PSAnaWZyYW1lJykge1xyXG4gICAgICAgIHRoaXMudHJhbnNwb3J0LnVwbG9hZCA9ICQucHJveHkodGhpcy51cGxvYWRzLmlmcmFtZSwgdGhpcyk7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiAodGhpcy50cmFuc3BvcnQudXBsb2FkKSA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgdGhpcy5kcmFnVXBsb2FkID0gISF0aGlzLm9wdGlvbnMuZHJhZ1VwbG9hZEFsbG93O1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLnhoclVwbG9hZCAmJiAhIXRoaXMub3B0aW9ucy5kcmFnVXBsb2FkQWxsb3cpIHtcclxuICAgICAgICB0aGlzLnRyYW5zcG9ydC51cGxvYWQgPSAkLnByb3h5KHRoaXMudXBsb2Fkcy54aHIsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuZHJhZ1VwbG9hZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudHJhbnNwb3J0LnVwbG9hZCA9ICQucHJveHkodGhpcy51cGxvYWRzLmlmcmFtZSwgdGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcblx0ICogQWxpYXMgZm9yIHRoaXMudHJpZ2dlcignZXJyb3InLCB7ZXJyb3IgOiAnbWVzc2FnZSd9KVxyXG5cdCAqXHJcblx0ICogQHBhcmFtICBTdHJpbmcgIGVycm9yIG1lc3NhZ2VcclxuXHQgKiBAcmV0dXJuIGVsRmluZGVyXHJcblx0ICoqL1xyXG4gICAgdGhpcy5lcnJvciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBhcmcgPSBhcmd1bWVudHNbMF07XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPT0gMSAmJiB0eXBlb2YgKGFyZykgPT0gJ2Z1bmN0aW9uJ1xyXG4gICAgICAgICAgICA/IHNlbGYuYmluZCgnZXJyb3InLCBhcmcpXHJcbiAgICAgICAgICAgIDogc2VsZi50cmlnZ2VyKCdlcnJvcicsIHsgZXJyb3I6IGFyZyB9KTtcclxuICAgIH07IC8vIGNyZWF0ZSBiaW5kL3RyaWdnZXIgYWxpYXNlcyBmb3IgYnVpbGQtaW4gZXZlbnRzXHJcbiAgICAkLmVhY2goWydlbmFibGUnLCAnZGlzYWJsZScsICdsb2FkJywgJ29wZW4nLCAncmVsb2FkJywgJ3NlbGVjdCcsICdhZGQnLCAncmVtb3ZlJywgJ2NoYW5nZScsICdkYmxjbGljaycsICdnZXRmaWxlJywgJ2xvY2tmaWxlcycsICd1bmxvY2tmaWxlcycsICdkcmFnc3RhcnQnLCAnZHJhZ3N0b3AnLCAnc2VhcmNoJywgJ3NlYXJjaGVuZCcsICd2aWV3Y2hhbmdlJ10sIGZ1bmN0aW9uKGksIG5hbWUpIHtcclxuICAgICAgICBzZWxmW25hbWVdID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhcmcgPSBhcmd1bWVudHNbMF07XHJcbiAgICAgICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09IDEgJiYgdHlwZW9mIChhcmcpID09ICdmdW5jdGlvbidcclxuICAgICAgICAgICAgICAgID8gc2VsZi5iaW5kKG5hbWUsIGFyZylcclxuICAgICAgICAgICAgICAgIDogc2VsZi50cmlnZ2VyKG5hbWUsICQuaXNQbGFpbk9iamVjdChhcmcpID8gYXJnIDoge30pO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBiaW5kIGNvcmUgZXZlbnQgaGFuZGxlcnNcclxuICAgIHRoaXNcclxuICAgICAgICAuZW5hYmxlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoIWVuYWJsZWQgJiYgc2VsZi52aXNpYmxlKCkgJiYgc2VsZi51aS5vdmVybGF5LmlzKCc6aGlkZGVuJykpIHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJCgndGV4YXJlYTpmb2N1cywgaW5wdXQ6Zm9jdXMsIGJ1dHRvbicpLmJsdXIoKTtcclxuICAgICAgICAgICAgICAgIG5vZGUucmVtb3ZlQ2xhc3MoJ2VsZmluZGVyLWRpc2FibGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5kaXNhYmxlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBwcmV2RW5hYmxlZCA9IGVuYWJsZWQ7XHJcbiAgICAgICAgICAgIGVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgbm9kZS5hZGRDbGFzcygnZWxmaW5kZXItZGlzYWJsZWQnKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vcGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxlY3RlZCA9IFtdO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnNlbGVjdChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkID0gJC5tYXAoZS5kYXRhLnNlbGVjdGVkIHx8IGUuZGF0YS52YWx1ZSB8fCBbXSwgZnVuY3Rpb24oaGFzaCkgeyByZXR1cm4gZmlsZXNbaGFzaF0gPyBoYXNoIDogbnVsbDsgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgb3B0cyA9IHtcclxuICAgICAgICAgICAgICAgIGNzc0NsYXNzOiAnZWxmaW5kZXItZGlhbG9nLWVycm9yJyxcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBzZWxmLmkxOG4oc2VsZi5pMThuKCdlcnJvcicpKSxcclxuICAgICAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBkZXN0cm95T25DbG9zZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHt9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBvcHRzLmJ1dHRvbnNbc2VsZi5pMThuKHNlbGYuaTE4bignYnRuQ2xvc2UnKSldID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAvLyQodGhpcykuZWxmaW5kZXJkaWFsb2coJ2Nsb3NlJyk7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmVsZmluZGVyY3J5cHR4ZGlhbG9nKCdjbG9zZScpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgc2VsZi5kaWFsb2coJzxkaXYgY2xhc3M9XCJlcnJvclwiPjxzcGFuPicgKyBzZWxmLmkxOG4oZS5kYXRhLmVycm9yKSArICc8L3NwYW4+PC9kaXY+PC9kaXY+Jywgb3B0cyk7XHJcbiAgICAgICAgICAgIC8vc2VsZi5kaWFsb2coJzxzcGFuIGNsYXNzPVwiZWxmaW5kZXItZGlhbG9nLWljb24gZWxmaW5kZXItZGlhbG9nLWljb24tZXJyb3JcIi8+JytzZWxmLmkxOG4oZS5kYXRhLmVycm9yKSwgb3B0cyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuYmluZCgndHJlZSBwYXJlbnRzJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBjYWNoZShlLmRhdGEudHJlZSB8fCBbXSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuYmluZCgndG1iJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAkLmVhY2goZS5kYXRhLmltYWdlcyB8fCBbXSwgZnVuY3Rpb24oaGFzaCwgdG1iKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsZXNbaGFzaF0pIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWxlc1toYXNoXS50bWIgPSB0bWI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmFkZChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIGNhY2hlKGUuZGF0YS5hZGRlZCB8fCBbXSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2hhbmdlKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgJC5lYWNoKGUuZGF0YS5jaGFuZ2VkIHx8IFtdLCBmdW5jdGlvbihpLCBmaWxlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaGFzaCA9IGZpbGUuaGFzaDtcclxuICAgICAgICAgICAgICAgIGlmICgoZmlsZXNbaGFzaF0ud2lkdGggJiYgIWZpbGUud2lkdGgpIHx8IChmaWxlc1toYXNoXS5oZWlnaHQgJiYgIWZpbGUuaGVpZ2h0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVzW2hhc2hdLndpZHRoID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVzW2hhc2hdLmhlaWdodCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZpbGVzW2hhc2hdID0gZmlsZXNbaGFzaF0gPyAkLmV4dGVuZChmaWxlc1toYXNoXSwgZmlsZSkgOiBmaWxlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5yZW1vdmUoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZCA9IGUuZGF0YS5yZW1vdmVkIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgbCA9IHJlbW92ZWQubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgcm0gPSBmdW5jdGlvbihoYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGUgPSBmaWxlc1toYXNoXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZS5taW1lID09ICdkaXJlY3RvcnknICYmIGZpbGUuZGlycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGZpbGVzLCBmdW5jdGlvbihoLCBmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5waGFzaCA9PSBoYXNoICYmIHJtKGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGZpbGVzW2hhc2hdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB3aGlsZSAobC0tKSB7XHJcbiAgICAgICAgICAgICAgICBybShyZW1vdmVkW2xdKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5iaW5kKCdzZWFyY2gnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIGNhY2hlKGUuZGF0YS5maWxlcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuYmluZCgncm0nLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciBwbGF5ID0gYmVlcGVyLmNhblBsYXlUeXBlICYmIGJlZXBlci5jYW5QbGF5VHlwZSgnYXVkaW8vd2F2OyBjb2RlY3M9XCIxXCInKTtcclxuXHJcbiAgICAgICAgICAgIHBsYXkgJiYgcGxheSAhPSAnJyAmJiBwbGF5ICE9ICdubycgJiYgJChiZWVwZXIpLmh0bWwoJzxzb3VyY2Ugc3JjPVwiLi9zb3VuZHMvcm0ud2F2XCIgdHlwZT1cImF1ZGlvL3dhdlwiPicpWzBdLnBsYXkoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAvLyBiaW5kIGV4dGVybmFsIGV2ZW50IGhhbmRsZXJzXHJcbiAgICAkLmVhY2godGhpcy5vcHRpb25zLmhhbmRsZXJzLCBmdW5jdGlvbihldmVudCwgY2FsbGJhY2spIHtcclxuICAgICAgICBzZWxmLmJpbmQoZXZlbnQsIGNhbGxiYWNrKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIEhpc3Rvcnkgb2JqZWN0LiBTdG9yZSB2aXNpdGVkIGZvbGRlcnNcclxuXHQgKlxyXG5cdCAqIEB0eXBlIE9iamVjdFxyXG5cdCAqKi9cclxuICAgIHRoaXMuaGlzdG9yeSA9IG5ldyB0aGlzLmhpc3RvcnkodGhpcyk7XHJcblxyXG4gICAgLy8gaW4gZ2V0RmlsZUNhbGxiYWNrIHNldCAtIGNoYW5nZSBkZWZhdWx0IGFjdGlvbnMgb24gZG91YmxlIGNsaWNrL2VudGVyL2N0cmwrZW50ZXJcclxuICAgIGlmICh0eXBlb2YgKHRoaXMub3B0aW9ucy5nZXRGaWxlQ2FsbGJhY2spID09ICdmdW5jdGlvbicgJiYgdGhpcy5jb21tYW5kcy5nZXRmaWxlKSB7XHJcbiAgICAgICAgdGhpcy5iaW5kKCdkYmxjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBzZWxmLmV4ZWMoJ2dldGZpbGUnKS5mYWlsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5leGVjKCdvcGVuJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2hvcnRjdXQoe1xyXG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ2VudGVyJyxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmkxOG4oJ2NtZGdldGZpbGUnKSxcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHsgc2VsZi5leGVjKCdnZXRmaWxlJykuZmFpbChmdW5jdGlvbigpIHsgc2VsZi5leGVjKHNlbGYuT1MgPT0gJ21hYycgPyAncmVuYW1lJyA6ICdvcGVuJyk7IH0pOyB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zaG9ydGN1dCh7XHJcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnY3RybCtlbnRlcicsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5pMThuKHRoaXMuT1MgPT0gJ21hYycgPyAnY21kcmVuYW1lJyA6ICdjbWRvcGVuJyksXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7IHNlbGYuZXhlYyhzZWxmLk9TID09ICdtYWMnID8gJ3JlbmFtZScgOiAnb3BlbicpOyB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuXHQgKiBMb2FkZWQgY29tbWFuZHNcclxuXHQgKlxyXG5cdCAqIEB0eXBlIE9iamVjdFxyXG5cdCAqKi9cclxuICAgIHRoaXMuX2NvbW1hbmRzID0ge307XHJcblxyXG4gICAgaWYgKCEkLmlzQXJyYXkodGhpcy5vcHRpb25zLmNvbW1hbmRzKSkge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy5jb21tYW5kcyA9IFtdO1xyXG4gICAgfVxyXG4gICAgLy8gY2hlY2sgcmVxdWlyZWQgY29tbWFuZHNcclxuICAgICQuZWFjaChbJ29wZW4nLCAncmVsb2FkJywgJ2JhY2snLCAnZm9yd2FyZCcsICd1cCcsICdob21lJywgJ2luZm8nLCAncXVpY2tsb29rJywgJ2dldGZpbGUnLCAnaGVscCddLCBmdW5jdGlvbihpLCBjbWQpIHtcclxuICAgICAgICAkLmluQXJyYXkoY21kLCBzZWxmLm9wdGlvbnMuY29tbWFuZHMpID09PSAtMSAmJiBzZWxmLm9wdGlvbnMuY29tbWFuZHMucHVzaChjbWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gbG9hZCBjb21tYW5kc1xyXG4gICAgJC5lYWNoKHRoaXMub3B0aW9ucy5jb21tYW5kcywgZnVuY3Rpb24oaSwgbmFtZSkge1xyXG4gICAgICAgIHZhciBjbWQgPSBzZWxmLmNvbW1hbmRzW25hbWVdO1xyXG4gICAgICAgIGlmICgkLmlzRnVuY3Rpb24oY21kKSAmJiAhc2VsZi5fY29tbWFuZHNbbmFtZV0pIHtcclxuICAgICAgICAgICAgY21kLnByb3RvdHlwZSA9IGJhc2U7XHJcbiAgICAgICAgICAgIHNlbGYuX2NvbW1hbmRzW25hbWVdID0gbmV3IGNtZCgpO1xyXG4gICAgICAgICAgICBzZWxmLl9jb21tYW5kc1tuYW1lXS5zZXR1cChuYW1lLCBzZWxmLm9wdGlvbnMuY29tbWFuZHNPcHRpb25zW25hbWVdIHx8IHt9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBwcmVwYXJlIG5vZGVcclxuICAgIG5vZGUuYWRkQ2xhc3ModGhpcy5jc3NDbGFzcylcclxuICAgICAgICAuYmluZChtb3VzZWRvd24sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAhZW5hYmxlZCAmJiBzZWxmLmVuYWJsZSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIFVJIG5vZGVzXHJcblx0ICpcclxuXHQgKiBAdHlwZSBPYmplY3RcclxuXHQgKiovXHJcbiAgICB0aGlzLnVpID0ge1xyXG4gICAgICAgIC8vIGNvbnRhaW5lciBmb3IgbmF2IHBhbmVsIGFuZCBjdXJyZW50IGZvbGRlciBjb250YWluZXJcclxuICAgICAgICB3b3Jrem9uZTogJCgnPGRpdi8+JykuYXBwZW5kVG8obm9kZSkuZWxmaW5kZXJ3b3Jrem9uZSh0aGlzKSxcclxuICAgICAgICAvLyBjb250YWluZXIgZm9yIGZvbGRlcnMgdHJlZSAvIHBsYWNlc1xyXG4gICAgICAgIG5hdmJhcjogJCgnPGRpdi8+JykuYXBwZW5kVG8obm9kZSkuZWxmaW5kZXJuYXZiYXIodGhpcywgdGhpcy5vcHRpb25zLnVpT3B0aW9ucy5uYXZiYXIgfHwge30pLFxyXG4gICAgICAgIC8vIGNvbnRleHRtZW51XHJcbiAgICAgICAgY29udGV4dG1lbnU6ICQoJzxkaXYvPicpLmFwcGVuZFRvKG5vZGUpLmVsZmluZGVyY29udGV4dG1lbnUodGhpcyksXHJcbiAgICAgICAgLy8gb3ZlcmxheVxyXG4gICAgICAgIG92ZXJsYXk6ICQoJzxkaXYvPicpLmFwcGVuZFRvKG5vZGUpLmVsZmluZGVyb3ZlcmxheSh7XHJcbiAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uKCkgeyBzZWxmLmRpc2FibGUoKTsgfSxcclxuICAgICAgICAgICAgaGlkZTogZnVuY3Rpb24oKSB7IHByZXZFbmFibGVkICYmIHNlbGYuZW5hYmxlKCk7IH1cclxuICAgICAgICB9KSxcclxuICAgICAgICAvLyBjdXJyZW50IGZvbGRlciBjb250YWluZXJcclxuICAgICAgICBjd2Q6ICQoJzxkaXYvPicpLmFwcGVuZFRvKG5vZGUpLmVsZmluZGVyY3dkKHRoaXMsIHRoaXMub3B0aW9ucy51aU9wdGlvbnMuY3dkIHx8IHt9KSxcclxuICAgICAgICAvLyBub3RpZmljYXRpb24gZGlhbG9nIHdpbmRvd1xyXG4gICAgICAgIG5vdGlmeTogdGhpcy5kaWFsb2coJycsIHtcclxuICAgICAgICAgICAgY3NzQ2xhc3M6ICdlbGZpbmRlci1kaWFsb2ctbm90aWZ5JyxcclxuICAgICAgICAgICAgcG9zaXRpb246IHsgdG9wOiAnMTJweCcsIHJpZ2h0OiAnMTJweCcgfSxcclxuICAgICAgICAgICAgcmVzaXphYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgYXV0b09wZW46IGZhbHNlLFxyXG4gICAgICAgICAgICB0aXRsZTogJyZuYnNwOycsXHJcbiAgICAgICAgICAgIHdpZHRoOiAyODBcclxuICAgICAgICB9KSxcclxuICAgICAgICBzdGF0dXNiYXI6ICQoJzxkaXYgY2xhc3M9XCJ1aS13aWRnZXQtaGVhZGVyIHVpLWhlbHBlci1jbGVhcmZpeCB1aS1jb3JuZXItYm90dG9tIGVsZmluZGVyLXN0YXR1c2JhclwiLz4nKS5oaWRlKCkuYXBwZW5kVG8obm9kZSlcclxuICAgIH07IC8vIGxvYWQgcmVxdWlyZWQgdWlcclxuICAgICQuZWFjaCh0aGlzLm9wdGlvbnMudWkgfHwgW10sIGZ1bmN0aW9uKGksIHVpKSB7XHJcbiAgICAgICAgdmFyIG5hbWUgPSAnZWxmaW5kZXInICsgdWksXHJcbiAgICAgICAgICAgIG9wdHMgPSBzZWxmLm9wdGlvbnMudWlPcHRpb25zW3VpXSB8fCB7fTtcclxuXHJcbiAgICAgICAgaWYgKCFzZWxmLnVpW3VpXSAmJiAkLmZuW25hbWVdKSB7XHJcbiAgICAgICAgICAgIHNlbGYudWlbdWldID0gJCgnPCcgKyAob3B0cy50YWcgfHwgJ2RpdicpICsgJy8+JykuYXBwZW5kVG8obm9kZSlbbmFtZV0oc2VsZiwgb3B0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG5cclxuLy8gc3RvcmUgaW5zdGFuY2UgaW4gbm9kZVxyXG4gICAgbm9kZVswXS5lbGZpbmRlciA9IHRoaXM7XHJcblxyXG4gICAgLy8gbWFrZSBub2RlIHJlc2l6YWJsZVxyXG4gICAgdGhpcy5vcHRpb25zLnJlc2l6YWJsZVxyXG4gICAgICAgICYmICQuZm4ucmVzaXphYmxlXHJcbiAgICAgICAgJiYgbm9kZS5yZXNpemFibGUoe1xyXG4gICAgICAgICAgICBoYW5kbGVzOiAnc2UnLFxyXG4gICAgICAgICAgICBtaW5XaWR0aDogMzAwLFxyXG4gICAgICAgICAgICBtaW5IZWlnaHQ6IDIwMFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIGlmICh0aGlzLm9wdGlvbnMud2lkdGgpIHtcclxuICAgICAgICB3aWR0aCA9IHRoaXMub3B0aW9ucy53aWR0aDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5vcHRpb25zLmhlaWdodCkge1xyXG4gICAgICAgIGhlaWdodCA9IHBhcnNlSW50KHRoaXMub3B0aW9ucy5oZWlnaHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHVwZGF0ZSBzaXplXHRcclxuICAgIHNlbGYucmVzaXplKHdpZHRoLCBoZWlnaHQpO1xyXG5cclxuICAgIC8vIGF0dGFjaCBldmVudHMgdG8gZG9jdW1lbnRcclxuICAgICQoZG9jdW1lbnQpXHJcbiAgICAgICAgLy8gZGlzYWJsZSBlbGZpbmRlciBvbiBjbGljayBvdXRzaWRlIGVsZmluZGVyXHJcbiAgICAgICAgLmJpbmQoJ2NsaWNrLicgKyB0aGlzLm5hbWVzcGFjZSwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAvL2VuYWJsZWQgJiYgISQoZS50YXJnZXQpLmNsb3Nlc3Qobm9kZSkubGVuZ3RoICYmIHNlbGYuZGlzYWJsZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gZXhlYyBzaG9ydGN1dHNcclxuICAgICAgICAuYmluZChrZXlkb3duICsgJyAnICsga2V5cHJlc3MsIGV4ZWNTaG9ydGN1dCk7XHJcblxyXG4gICAgLy8gYXR0YWNoIGV2ZW50cyB0byB3aW5kb3dcclxuICAgIHNlbGYub3B0aW9ucy51c2VCcm93c2VySGlzdG9yeSAmJiAkKHdpbmRvdylcclxuICAgICAgICAub24oJ3BvcHN0YXRlJywgZnVuY3Rpb24oZXYpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGV2Lm9yaWdpbmFsRXZlbnQuc3RhdGUgJiYgZXYub3JpZ2luYWxFdmVudC5zdGF0ZS50aGFzaDtcclxuICAgICAgICAgICAgdGFyZ2V0ICYmICEkLmlzRW1wdHlPYmplY3Qoc2VsZi5maWxlcygpKSAmJiBzZWxmLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdvcGVuJywgdGFyZ2V0OiB0YXJnZXQsIG9uaGlzdG9yeTogMSB9LFxyXG4gICAgICAgICAgICAgICAgbm90aWZ5OiB7IHR5cGU6ICdvcGVuJywgY250OiAxLCBoaWRlQ250OiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICBzeW5jT25GYWlsOiB0cnVlXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIHZhciBvcGVuRGF0YSA9IHsgY21kOiAnb3BlbicsIHRhcmdldDogc2VsZi5zdGFydERpcigpLCBpbml0OiAxLCB0cmVlOiB0aGlzLnVpLnRyZWUgPyAxIDogMCwgaXNSZWNlaXZlZE1haWw6IDAsIGlzTW9kYWw6IHNlbGYuR2V0TW9kYWxTdGF0dXMoKSB9O1xyXG4gICAgaWYgKHNlbGYuR2V0UmVjZWl2ZWRNYWlsSWQoKSkge1xyXG4gICAgICAgIG9wZW5EYXRhLmlzUmVjZWl2ZWRNYWlsID0gMTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBzZW5kIGluaXRpYWwgcmVxdWVzdCBhbmQgc3RhcnQgdG8gcHJheSA+XzxcclxuICAgIHRoaXMudHJpZ2dlcignaW5pdCcpXHJcbiAgICAgICAgLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICBkYXRhOiBvcGVuRGF0YSxcclxuICAgICAgICAgICAgcHJldmVudERvbmU6IHRydWUsXHJcbiAgICAgICAgICAgIG5vdGlmeTogeyB0eXBlOiAnb3BlbicsIGNudDogMSwgaGlkZUNudDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICBmcmVlemU6IHRydWVcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLnRyaWdnZXIoJ2ZhaWwnKS5kaXNhYmxlKCkubGFzdERpcignJyk7XHJcbiAgICAgICAgICAgIGxpc3RlbmVycyA9IHt9O1xyXG4gICAgICAgICAgICBzaG9ydGN1dHMgPSB7fTtcclxuICAgICAgICAgICAgJChkb2N1bWVudCkuYWRkKG5vZGUpLnVuYmluZCgnLicgKyB0aGlzLm5hbWVzcGFjZSk7XHJcbiAgICAgICAgICAgIHNlbGYudHJpZ2dlciA9IGZ1bmN0aW9uKCkge307XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYubG9hZCgpLmRlYnVnKCdhcGknLCBzZWxmLmFwaSk7XHJcbiAgICAgICAgICAgIGRhdGEgPSAkLmV4dGVuZCh0cnVlLCB7fSwgZGF0YSk7XHJcbiAgICAgICAgICAgIG9wZW4oZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYudHJpZ2dlcignb3BlbicsIGRhdGEpO1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5HZXRSZWNlaXZlZE1haWxJZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnRyaWdnZXIoJ3JlY2VpdmVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAvLyB1cGRhdGUgdWkncyBzaXplIGFmdGVyIGluaXRcclxuICAgIHRoaXMub25lKCdsb2FkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbm9kZS50cmlnZ2VyKCdyZXNpemUnKTtcclxuICAgICAgICBpZiAoc2VsZi5vcHRpb25zLnN5bmMgPiAxMDAwKSB7XHJcbiAgICAgICAgICAgIHN5bmNJbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zeW5jKCk7XHJcbiAgICAgICAgICAgIH0sIHNlbGYub3B0aW9ucy5zeW5jKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5vbmUoJ2ZpbHRlcicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBmaWxlcyA9IHt9O1xyXG4gICAgICAgIGN3ZCA9IGUuZGF0YS5jd2QuaGFzaDtcclxuICAgICAgICBjYWNoZShlLmRhdGEuZmlsZXMpO1xyXG4gICAgICAgIGlmICghZmlsZXNbY3dkXSkge1xyXG4gICAgICAgICAgICBjYWNoZShbZS5kYXRhLmN3ZF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLmxhc3REaXIoY3dkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIHNlbGYudGltZUVuZCgnbG9hZCcpOyBcclxufTtcclxuXHJcbmZ1bmN0aW9uIHFzKGtleSkge1xyXG4gICAga2V5ID0ga2V5LnJlcGxhY2UoL1sqKz9eJC5cXFtcXF17fSgpfFxcXFxcXC9dL2csIFwiXFxcXCQmXCIpOyAvLyBlc2NhcGUgUmVnRXggbWV0YSBjaGFyc1xyXG4gICAgdmFyIG1hdGNoID0gbG9jYXRpb24uc2VhcmNoLm1hdGNoKG5ldyBSZWdFeHAoXCJbPyZdXCIgKyBrZXkgKyBcIj0oW14mXSspKCZ8JClcIikpO1xyXG4gICAgcmV0dXJuIG1hdGNoICYmIGRlY29kZVVSSUNvbXBvbmVudChtYXRjaFsxXS5yZXBsYWNlKC9cXCsvZywgXCIgXCIpKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFByb3RvdHlwZVxyXG4gKiBcclxuICogQHR5cGUgIE9iamVjdFxyXG4gKi9cclxuZWxGaW5kZXIucHJvdG90eXBlID0ge1xyXG4gICAgZ2V0RXh0ZW5zaW9uOiBmdW5jdGlvbihmaWxlbmFtZSkge1xyXG4gICAgICAgIHJldHVybiAoL1suXS8uZXhlYyhmaWxlbmFtZSkpID8gL1teLl0rJC8uZXhlYyhmaWxlbmFtZSkgOiB1bmRlZmluZWQ7XHJcbiAgICB9LFxyXG5cclxuICAgIGlzTW9kYWw6IGZhbHNlLFxyXG5cclxuICAgIGJsb2NrTXVsdGlTZWxlY3Rpb246IGZhbHNlLFxyXG5cclxuICAgIE1hc3RlclVybDogJy9tYXN0ZXIvaW5kZXgnLFxyXG5cclxuICAgIHJlczogZnVuY3Rpb24odHlwZSwgaWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXNvdXJjZXNbdHlwZV0gJiYgdGhpcy5yZXNvdXJjZXNbdHlwZV1baWRdO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBJbnRlcm5hdGlvbmFsaXphdGlvbiBvYmplY3RcclxuXHQgKiBcclxuXHQgKiBAdHlwZSAgT2JqZWN0XHJcblx0ICovXHJcbiAgICBpMTg6IHtcclxuICAgICAgICBlbjoge1xyXG4gICAgICAgICAgICB0cmFuc2xhdG9yOiAnJyxcclxuICAgICAgICAgICAgbGFuZ3VhZ2U6ICdFbmdsaXNoJyxcclxuICAgICAgICAgICAgZGlyZWN0aW9uOiAnbHRyJyxcclxuICAgICAgICAgICAgZGF0ZUZvcm1hdDogJ2QubS5ZIEg6aScsXHJcbiAgICAgICAgICAgIGZhbmN5RGF0ZUZvcm1hdDogJyQxIEg6aScsXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzOiB7fVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbW9udGhzOiBbJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXSxcclxuICAgICAgICBtb250aHNTaG9ydDogWydKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWF5JywgJ0p1bicsICdKdWwnLCAnQXVnJywgJ1NlcCcsICdPY3QnLCAnTm92JywgJ0RlYyddLFxyXG5cclxuICAgICAgICBkYXlzOiBbJ1N1bmRheScsICdNb25kYXknLCAnVHVlc2RheScsICdXZWRuZXNkYXknLCAnVGh1cnNkYXknLCAnRnJpZGF5JywgJ1NhdHVyZGF5J10sXHJcbiAgICAgICAgZGF5c1Nob3J0OiBbJ1N1bicsICdNb24nLCAnVHVlJywgJ1dlZCcsICdUaHUnLCAnRnJpJywgJ1NhdCddXHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIEZpbGUgbWltZXR5cGUgdG8ga2luZCBtYXBwaW5nXHJcblx0ICogXHJcblx0ICogQHR5cGUgIE9iamVjdFxyXG5cdCAqL1xyXG4gICAga2luZHM6IHtcclxuICAgICAgICAndW5rbm93bic6ICdVbmtub3duJyxcclxuICAgICAgICAnZGlyZWN0b3J5JzogJ0ZvbGRlcicsXHJcbiAgICAgICAgJ3N5bWxpbmsnOiAnQWxpYXMnLFxyXG4gICAgICAgICdzeW1saW5rLWJyb2tlbic6ICdBbGlhc0Jyb2tlbicsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3gtZW1wdHknOiAnVGV4dFBsYWluJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vcG9zdHNjcmlwdCc6ICdQb3N0c2NyaXB0JyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm1zLW9mZmljZSc6ICdNc09mZmljZScsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5tcy13b3JkJzogJ01zV29yZCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL21zd29yZCc6ICdNc1dvcmQnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudCc6ICdNc1dvcmQnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQubXMtd29yZC5kb2N1bWVudC5tYWNyb0VuYWJsZWQuMTInOiAnTXNXb3JkJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LndvcmRwcm9jZXNzaW5nbWwudGVtcGxhdGUnOiAnTXNXb3JkJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm1zLXdvcmQudGVtcGxhdGUubWFjcm9FbmFibGVkLjEyJzogJ01zV29yZCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3gtZG9jeCc6ICdNc1dvcmQnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC5zaGVldCc6ICdNc0V4Y2VsJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsJzogJ01zRXhjZWwnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwuc2hlZXQubWFjcm9FbmFibGVkLjEyJzogJ01zRXhjZWwnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC50ZW1wbGF0ZSc6ICdNc0V4Y2VsJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsLnRlbXBsYXRlLm1hY3JvRW5hYmxlZC4xMic6ICdNc0V4Y2VsJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsLnNoZWV0LmJpbmFyeS5tYWNyb0VuYWJsZWQuMTInOiAnTXNFeGNlbCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbC5hZGRpbi5tYWNyb0VuYWJsZWQuMTInOiAnTXNFeGNlbCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1wb3dlcnBvaW50JzogJ01zUFAnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQucHJlc2VudGF0aW9ubWwucHJlc2VudGF0aW9uJzogJ01zUFAnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQubXMtcG93ZXJwb2ludC5wcmVzZW50YXRpb24ubWFjcm9FbmFibGVkLjEyJzogJ01zUFAnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQucHJlc2VudGF0aW9ubWwuc2xpZGVzaG93JzogJ01zUFAnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQubXMtcG93ZXJwb2ludC5zbGlkZXNob3cubWFjcm9FbmFibGVkLjEyJzogJ01zUFAnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQucHJlc2VudGF0aW9ubWwudGVtcGxhdGUnOiAnTXNQUCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1wb3dlcnBvaW50LnRlbXBsYXRlLm1hY3JvRW5hYmxlZC4xMic6ICdNc1BQJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm1zLXBvd2VycG9pbnQuYWRkaW4ubWFjcm9FbmFibGVkLjEyJzogJ01zUFAnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQucHJlc2VudGF0aW9ubWwuc2xpZGUnOiAnTXNQUCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1wb3dlcnBvaW50LnNsaWRlLm1hY3JvRW5hYmxlZC4xMic6ICdNc1BQJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vcGRmJzogJ1BERicsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3htbCc6ICdYTUwnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LnRleHQnOiAnT08nLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LnRleHQtdGVtcGxhdGUnOiAnT08nLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LnRleHQtd2ViJzogJ09PJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm9hc2lzLm9wZW5kb2N1bWVudC50ZXh0LW1hc3Rlcic6ICdPTycsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5vYXNpcy5vcGVuZG9jdW1lbnQuZ3JhcGhpY3MnOiAnT08nLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LmdyYXBoaWNzLXRlbXBsYXRlJzogJ09PJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm9hc2lzLm9wZW5kb2N1bWVudC5wcmVzZW50YXRpb24nOiAnT08nLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LnByZXNlbnRhdGlvbi10ZW1wbGF0ZSc6ICdPTycsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5vYXNpcy5vcGVuZG9jdW1lbnQuc3ByZWFkc2hlZXQnOiAnT08nLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LnNwcmVhZHNoZWV0LXRlbXBsYXRlJzogJ09PJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm9hc2lzLm9wZW5kb2N1bWVudC5jaGFydCc6ICdPTycsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5vYXNpcy5vcGVuZG9jdW1lbnQuZm9ybXVsYSc6ICdPTycsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5vYXNpcy5vcGVuZG9jdW1lbnQuZGF0YWJhc2UnOiAnT08nLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LmltYWdlJzogJ09PJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vdm5kLm9wZW5vZmZpY2VvcmcuZXh0ZW5zaW9uJzogJ09PJyxcclxuICAgICAgICAnYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2gnOiAnQXBwRmxhc2gnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi9mbGFzaC12aWRlbyc6ICdGbGFzaFZpZGVvJyxcclxuICAgICAgICAnYXBwbGljYXRpb24veC1iaXR0b3JyZW50JzogJ1RvcnJlbnQnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JzogJ0pTJyxcclxuICAgICAgICAnYXBwbGljYXRpb24vcnRmJzogJ1JURicsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3J0ZmQnOiAnUlRGJyxcclxuICAgICAgICAnYXBwbGljYXRpb24veC1mb250LXR0Zic6ICdUVEYnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94LWZvbnQtb3RmJzogJ09URicsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3gtcnBtJzogJ1JQTScsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3gtd2ViLWNvbmZpZyc6ICdUZXh0UGxhaW4nLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94aHRtbCt4bWwnOiAnSFRNTCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL2RvY2Jvb2sreG1sJzogJ0RPQ0JPT0snLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94LWF3ayc6ICdBV0snLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94LWd6aXAnOiAnR1pJUCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3gtYnppcDInOiAnQlpJUCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ppcCc6ICdaSVAnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94LXppcCc6ICdaSVAnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94LXJhcic6ICdSQVInLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94LXRhcic6ICdUQVInLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94LTd6LWNvbXByZXNzZWQnOiAnN3onLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94LWNvbXByZXNzZWQtdGFyJzogJ2FyY2hpdmUnLFxyXG4gICAgICAgICdhcHBsaWNhdGlvbi94LWFyY2hpdmUnOiAnYXJjaGl2ZScsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3gtamFyJzogJ0pBUicsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3ZuZC5zdW4ueG1sLndyaXRlci50ZW1wbGF0ZSc6ICdTVFcnLFxyXG4gICAgICAgICd0ZXh0L3BsYWluJzogJ1RleHRQbGFpbicsXHJcbiAgICAgICAgJ3RleHQveC1waHAnOiAnUEhQJyxcclxuICAgICAgICAndGV4dC9odG1sJzogJ0hUTUwnLFxyXG4gICAgICAgICd0ZXh0L2phdmFzY3JpcHQnOiAnSlMnLFxyXG4gICAgICAgICd0ZXh0L2Nzcyc6ICdDU1MnLFxyXG4gICAgICAgICd0ZXh0L3J0Zic6ICdSVEYnLFxyXG4gICAgICAgICd0ZXh0L3J0ZmQnOiAnUlRGJyxcclxuICAgICAgICAndGV4dC94LWMnOiAnQycsXHJcbiAgICAgICAgJ3RleHQveC1jc3JjJzogJ0MnLFxyXG4gICAgICAgICd0ZXh0L3gtY2hkcic6ICdDSGVhZGVyJyxcclxuICAgICAgICAndGV4dC94LWMrKyc6ICdDUFAnLFxyXG4gICAgICAgICd0ZXh0L3gtYysrc3JjJzogJ0NQUCcsXHJcbiAgICAgICAgJ3RleHQveC1jKytoZHInOiAnQ1BQSGVhZGVyJyxcclxuICAgICAgICAndGV4dC94LXNoZWxsc2NyaXB0JzogJ1NoZWxsJyxcclxuICAgICAgICAnYXBwbGljYXRpb24veC1jc2gnOiAnU2hlbGwnLFxyXG4gICAgICAgICd0ZXh0L3gtcHl0aG9uJzogJ1B5dGhvbicsXHJcbiAgICAgICAgJ3RleHQveC1qYXZhJzogJ0phdmEnLFxyXG4gICAgICAgICd0ZXh0L3gtamF2YS1zb3VyY2UnOiAnSmF2YScsXHJcbiAgICAgICAgJ3RleHQveC1ydWJ5JzogJ1J1YnknLFxyXG4gICAgICAgICd0ZXh0L3gtcGVybCc6ICdQZXJsJyxcclxuICAgICAgICAndGV4dC94LXNxbCc6ICdTUUwnLFxyXG4gICAgICAgICd0ZXh0L3htbCc6ICdYTUwnLFxyXG4gICAgICAgICd0ZXh0L3gtY29tbWEtc2VwYXJhdGVkLXZhbHVlcyc6ICdDU1YnLFxyXG4gICAgICAgICdpbWFnZS94LW1zLWJtcCc6ICdCTVAnLFxyXG4gICAgICAgICdpbWFnZS9qcGVnJzogJ0pQRUcnLFxyXG4gICAgICAgICdpbWFnZS9naWYnOiAnR0lGJyxcclxuICAgICAgICAnaW1hZ2UvcG5nJzogJ1BORycsXHJcbiAgICAgICAgJ2ltYWdlL3RpZmYnOiAnVElGRicsXHJcbiAgICAgICAgJ2ltYWdlL3gtdGFyZ2EnOiAnVEdBJyxcclxuICAgICAgICAnaW1hZ2Uvdm5kLmFkb2JlLnBob3Rvc2hvcCc6ICdQU0QnLFxyXG4gICAgICAgICdpbWFnZS94Ym0nOiAnWEJJVE1BUCcsXHJcbiAgICAgICAgJ2ltYWdlL3B4bSc6ICdQWE0nLFxyXG4gICAgICAgICdpbWFnZS94LWljbic6ICdJQ09OJyxcclxuICAgICAgICAnaW1hZ2UveC1pY29uJzogJ0lDT04nLFxyXG4gICAgICAgICdpbWFnZS94LWNyMic6ICdDUjInLFxyXG4gICAgICAgICdpbWFnZS9ibXAnOiAnQk1QJyxcclxuICAgICAgICAnaW1hZ2UveC1waWMnOiAnUElDJyxcclxuICAgICAgICAnaW1hZ2UveC1jZHInOiAnQ0RSJyxcclxuICAgICAgICAnYXVkaW8vbXBlZyc6ICdBdWRpb01QRUcnLFxyXG4gICAgICAgICdhdWRpby9taWRpJzogJ0F1ZGlvTUlESScsXHJcbiAgICAgICAgJ2F1ZGlvL29nZyc6ICdBdWRpb09HRycsXHJcbiAgICAgICAgJ2F1ZGlvL21wNCc6ICdBdWRpb01QRUc0JyxcclxuICAgICAgICAnYXVkaW8veC1tNGEnOiAnQXVkaW9NUEVHNCcsXHJcbiAgICAgICAgJ2F1ZGlvL3dhdic6ICdBdWRpb1dBVicsXHJcbiAgICAgICAgJ2F1ZGlvL3gtd2F2ZSc6ICdXQVZFJyxcclxuICAgICAgICAnYXVkaW8veC1tNHInOiAnTTRSJyxcclxuICAgICAgICAnYXVkaW8veC1hYWMnOiAnQUFDJyxcclxuICAgICAgICAnYXVkaW8veC13bWEnOiAnV01BJyxcclxuICAgICAgICAnYXVkaW8veC1tcDInOiAnTVAyJyxcclxuICAgICAgICAnYXVkaW8veC1kbHMnOiAnRExTJyxcclxuICAgICAgICAnYXVkaW8veC1tNGInOiAnTTRCJyxcclxuICAgICAgICAnYXVkaW8veC13YXYnOiAnV0FWJyxcclxuICAgICAgICAnYXVkaW8veC1tcDEnOiAnTVAxJyxcclxuICAgICAgICAnYXVkaW8veC1tcDMtcGxheWxpc3QnOiAnQXVkaW9QbGF5bGlzdCcsXHJcbiAgICAgICAgJ3ZpZGVvL3gtZHYnOiAnVmlkZW9EVicsXHJcbiAgICAgICAgJ3ZpZGVvL21wNCc6ICdWaWRlb01QRUc0JyxcclxuICAgICAgICAndmlkZW8vbXBlZyc6ICdWaWRlb01QRUcnLFxyXG4gICAgICAgICd2aWRlby94LW1zdmlkZW8nOiAnVmlkZW9BVkknLFxyXG4gICAgICAgICd2aWRlby9xdWlja3RpbWUnOiAnVmlkZW9NT1YnLFxyXG4gICAgICAgICd2aWRlby94LW1zLXdtdic6ICdWaWRlb1dNJyxcclxuICAgICAgICAndmlkZW8veC1mbHYnOiAnVmlkZW9GbGFzaCcsXHJcbiAgICAgICAgJ3ZpZGVvL3gtbWF0cm9za2EnOiAnVmlkZW9NS1YnLFxyXG4gICAgICAgICd2aWRlby9vZ2cnOiAnVmlkZW9PR0cnLFxyXG4gICAgICAgICd2aWRlby8zZ3BwJzogJzNHUCcsXHJcbiAgICAgICAgJ3ZpZGVvL3gtbXA0JzogJ01QNCcsXHJcbiAgICAgICAgJ3ZpZGVvL3gtbXMtYXNmJzogJ0FTRicsXHJcbiAgICAgICAgJ3ZpZGVvL3gtYW12JzogJ0FNVicsXHJcbiAgICAgICAgJ3ZpZGVvL3gtYWFmJzogJ0FBRicsXHJcbiAgICAgICAgJ3ZpZGVvL3gtbXBlZzQnOiAnTVBFRzQnLFxyXG4gICAgICAgICd2aWRlby94LXh2aWQnOiAnWFZJRCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3BncC1zaWduYXR1cmUnOiAnU2lnbicsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL2NyeXB0JzogJ0NyeXB0JyxcclxuICAgICAgICAnYXBwbGljYXRpb24vc2lnbmNyeXB0JzogJ1NpZ25DcnlwdCcsXHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL3gteDUwOS1jYS1jZXJ0JzogJ0NlcnQnXHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIEFqYXggcmVxdWVzdCBkYXRhIHZhbGlkYXRpb24gcnVsZXNcclxuXHQgKiBcclxuXHQgKiBAdHlwZSAgT2JqZWN0XHJcblx0ICovXHJcbiAgICBydWxlczoge1xyXG4gICAgICAgIGRlZmF1bHRzOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmICghZGF0YVxyXG4gICAgICAgICAgICAgICAgfHwgKGRhdGEuYWRkZWQgJiYgISQuaXNBcnJheShkYXRhLmFkZGVkKSlcclxuICAgICAgICAgICAgICAgIHx8IChkYXRhLnJlbW92ZWQgJiYgISQuaXNBcnJheShkYXRhLnJlbW92ZWQpKVxyXG4gICAgICAgICAgICAgICAgfHwgKGRhdGEuY2hhbmdlZCAmJiAhJC5pc0FycmF5KGRhdGEuY2hhbmdlZCkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvcGVuOiBmdW5jdGlvbihkYXRhKSB7IHJldHVybiBkYXRhICYmIGRhdGEuY3dkICYmIGRhdGEuZmlsZXMgJiYgJC5pc1BsYWluT2JqZWN0KGRhdGEuY3dkKSAmJiAkLmlzQXJyYXkoZGF0YS5maWxlcyk7IH0sXHJcbiAgICAgICAgdHJlZTogZnVuY3Rpb24oZGF0YSkgeyByZXR1cm4gZGF0YSAmJiBkYXRhLnRyZWUgJiYgJC5pc0FycmF5KGRhdGEudHJlZSk7IH0sXHJcbiAgICAgICAgcGFyZW50czogZnVuY3Rpb24oZGF0YSkgeyByZXR1cm4gZGF0YSAmJiBkYXRhLnRyZWUgJiYgJC5pc0FycmF5KGRhdGEudHJlZSk7IH0sXHJcbiAgICAgICAgdG1iOiBmdW5jdGlvbihkYXRhKSB7IHJldHVybiBkYXRhICYmIGRhdGEuaW1hZ2VzICYmICgkLmlzUGxhaW5PYmplY3QoZGF0YS5pbWFnZXMpIHx8ICQuaXNBcnJheShkYXRhLmltYWdlcykpOyB9LFxyXG4gICAgICAgIHVwbG9hZDogZnVuY3Rpb24oZGF0YSkgeyByZXR1cm4gZGF0YSAmJiAoJC5pc1BsYWluT2JqZWN0KGRhdGEuYWRkZWQpIHx8ICQuaXNBcnJheShkYXRhLmFkZGVkKSk7IH0sXHJcbiAgICAgICAgc2VhcmNoOiBmdW5jdGlvbihkYXRhKSB7IHJldHVybiBkYXRhICYmIGRhdGEuZmlsZXMgJiYgJC5pc0FycmF5KGRhdGEuZmlsZXMpOyB9XHJcbiAgICB9LFxyXG5cclxuXHJcbi8qKlxyXG5cdCAqIENvbW1hbmRzIGNvc3RydWN0b3JzXHJcblx0ICpcclxuXHQgKiBAdHlwZSBPYmplY3RcclxuXHQgKi9cclxuICAgIGNvbW1hbmRzOiB7fSxcclxuXHJcbiAgICBwYXJzZVVwbG9hZERhdGE6IGZ1bmN0aW9uKHRleHQpIHtcclxuICAgICAgICB2YXIgZGF0YTtcclxuXHJcbiAgICAgICAgaWYgKCEkLnRyaW0odGV4dCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgZXJyb3I6IFsnZXJyUmVzcG9uc2UnLCAnZXJyRGF0YUVtcHR5J10gfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSAkLnBhcnNlSlNPTih0ZXh0KTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGVycm9yOiBbJ2VyclJlc3BvbnNlJywgJ2VyckRhdGFOb3RKU09OJ10gfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy52YWxpZFJlc3BvbnNlKCd1cGxvYWQnLCBkYXRhKSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBlcnJvcjogWydlcnJSZXNwb25zZSddIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRhdGEgPSB0aGlzLm5vcm1hbGl6ZShkYXRhKTtcclxuICAgICAgICBkYXRhLnJlbW92ZWQgPSAkLm1hcChkYXRhLmFkZGVkIHx8IFtdLCBmdW5jdGlvbihmKSB7IHJldHVybiBmLmhhc2g7IH0pO1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgaWZyYW1lQ250OiAwLFxyXG5cclxuICAgIHVwbG9hZHM6IHtcclxuICAgICAgICAvLyB1cGxvYWQgdHJhbnNwb3J0IHVzaW5nIGlmcmFtZVxyXG4gICAgICAgIGlmcmFtZTogZnVuY3Rpb24oZGF0YSwgZm0pIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSBmbSA/IGZtIDogdGhpcyxcclxuICAgICAgICAgICAgICAgIGlucHV0ID0gZGF0YS5pbnB1dCxcclxuICAgICAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciAmJiBzZWxmLmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS53YXJuaW5nICYmIHNlbGYuZXJyb3IoZGF0YS53YXJuaW5nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5yZW1vdmVkICYmIHNlbGYucmVtb3ZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmFkZGVkICYmIHNlbGYuYWRkKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmNoYW5nZWQgJiYgc2VsZi5jaGFuZ2UoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudHJpZ2dlcigndXBsb2FkJywgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3luYyAmJiBzZWxmLnN5bmMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIG5hbWUgPSAnaWZyYW1lLScgKyBzZWxmLm5hbWVzcGFjZSArICgrK3NlbGYuaWZyYW1lQ250KSxcclxuICAgICAgICAgICAgICAgIGZvcm0gPSAkKCc8Zm9ybSBhY3Rpb249XCInICsgc2VsZi51cGxvYWRVUkwgKyAnXCIgbWV0aG9kPVwicG9zdFwiIGVuY3R5cGU9XCJtdWx0aXBhcnQvZm9ybS1kYXRhXCIgZW5jb2Rpbmc9XCJtdWx0aXBhcnQvZm9ybS1kYXRhXCIgdGFyZ2V0PVwiJyArIG5hbWUgKyAnXCIgc3R5bGU9XCJkaXNwbGF5Om5vbmVcIj48aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJjbWRcIiB2YWx1ZT1cInVwbG9hZFwiIC8+PC9mb3JtPicpLFxyXG4gICAgICAgICAgICAgICAgbXNpZSA9IHRoaXMuVUEuSUUsXHJcbiAgICAgICAgICAgICAgICAvLyBjbGVhciB0aW1lb3V0cywgY2xvc2Ugbm90aWZpY2F0aW9uIGRpYWxvZywgcmVtb3ZlIGZvcm0vaWZyYW1lXHJcbiAgICAgICAgICAgICAgICBvbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBhYm9ydHRvICYmIGNsZWFyVGltZW91dChhYm9ydHRvKTtcclxuICAgICAgICAgICAgICAgICAgICBub3RpZnl0byAmJiBjbGVhclRpbWVvdXQobm90aWZ5dG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmeSAmJiBzZWxmLm5vdGlmeSh7IHR5cGU6ICd1cGxvYWQnLCBjbnQ6IC1jbnQgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zaWUgJiYgJCgnPGlmcmFtZSBzcmM9XCJqYXZhc2NyaXB0OmZhbHNlO1wiLz4nKS5hcHBlbmRUbyhmb3JtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgaWZyYW1lID0gJCgnPGlmcmFtZSBzcmM9XCInICsgKG1zaWUgPyAnamF2YXNjcmlwdDpmYWxzZTsnIDogJ2Fib3V0OmJsYW5rJykgKyAnXCIgbmFtZT1cIicgKyBuYW1lICsgJ1wiIHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7bGVmdDotMTAwMHB4O3RvcDotMTAwMHB4XCIgLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5iaW5kKCdsb2FkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmcmFtZS51bmJpbmQoJ2xvYWQnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmJpbmQoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHNlbGYucGFyc2VVcGxvYWREYXRhKGlmcmFtZS5jb250ZW50cygpLnRleHQoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZXJyb3IgPyBkZnJkLnJlamVjdChkYXRhLmVycm9yKSA6IGRmcmQucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm90aWZ5IGRpYWxvZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpZnl0byA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZnkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ub3RpZnkoeyB0eXBlOiAndXBsb2FkJywgY250OiBjbnQgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHNlbGYub3B0aW9ucy5ub3RpZnlEZWxheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbXVsYXRlIGFib3J0IG9uIHRpbWVvdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5pZnJhbWVUaW1lb3V0ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnR0byA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25sb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoW2Vycm9ycy5jb25uZWN0LCBlcnJvcnMudGltZW91dF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgc2VsZi5vcHRpb25zLmlmcmFtZVRpbWVvdXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnN1Ym1pdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgY250LFxyXG4gICAgICAgICAgICAgICAgbm90aWZ5LFxyXG4gICAgICAgICAgICAgICAgbm90aWZ5dG8sXHJcbiAgICAgICAgICAgICAgICBhYm9ydHRvO1xyXG5cclxuICAgICAgICAgICAgaWYgKGlucHV0ICYmICQoaW5wdXQpLmlzKCc6ZmlsZScpICYmICQoaW5wdXQpLnZhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtLmFwcGVuZChpbnB1dCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY250ID0gaW5wdXQuZmlsZXMgPyBpbnB1dC5maWxlcy5sZW5ndGggOiAxO1xyXG5cclxuICAgICAgICAgICAgZm9ybS5hcHBlbmQoJzxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cIicgKyAoc2VsZi5uZXdBUEkgPyAndGFyZ2V0JyA6ICdjdXJyZW50JykgKyAnXCIgdmFsdWU9XCInICsgc2VsZi5jd2QoKS5oYXNoICsgJ1wiLz4nKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgnPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiaHRtbFwiIHZhbHVlPVwiMVwiLz4nKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgkKGlucHV0KS5hdHRyKCduYW1lJywgJ3VwbG9hZFtdJykpO1xyXG5cclxuICAgICAgICAgICAgJC5lYWNoKHNlbGYub3B0aW9ucy5vbmx5TWltZXMgfHwgW10sIGZ1bmN0aW9uKGksIG1pbWUpIHtcclxuICAgICAgICAgICAgICAgIGZvcm0uYXBwZW5kKCc8aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJtaW1lc1tdXCIgdmFsdWU9XCInICsgbWltZSArICdcIi8+Jyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJC5lYWNoKHNlbGYub3B0aW9ucy5jdXN0b21EYXRhLCBmdW5jdGlvbihrZXksIHZhbCkge1xyXG4gICAgICAgICAgICAgICAgZm9ybS5hcHBlbmQoJzxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cIicgKyBrZXkgKyAnXCIgdmFsdWU9XCInICsgdmFsICsgJ1wiLz4nKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBmb3JtLmFwcGVuZFRvKCdib2R5Jyk7XHJcbiAgICAgICAgICAgIGlmcmFtZS5hcHBlbmRUbygnYm9keScpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvLyB1cGxvYWQgdHJhbnNwb3J0IHVzaW5nIFhNTEh0dHBSZXF1ZXN0XHJcbiAgICAgICAgLy9cdHhociA6IGZ1bmN0aW9uKGRhdGEsIGZtLG5vdFVwbG9hZEZpbGVzSW5kZXgpIHsgXHJcbiAgICAgICAgLy9cdFx0dmFyIHNlbGYgICA9IGZtID8gZm0gOiB0aGlzLFxyXG4gICAgICAgIC8vXHRcdFx0ZGZyZCAgID0gJC5EZWZlcnJlZCgpXHJcbiAgICAgICAgLy9cdFx0XHRcdC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgLy9cdFx0XHRcdFx0ZXJyb3IgJiYgc2VsZi5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgLy9cdFx0XHRcdH0pXHJcbiAgICAgICAgLy9cdFx0XHRcdC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAvL1x0XHRcdFx0XHRkYXRhLndhcm5pbmcgJiYgc2VsZi5lcnJvcihkYXRhLndhcm5pbmcpO1xyXG4gICAgICAgIC8vXHRcdFx0XHRcdGRhdGEucmVtb3ZlZCAmJiBzZWxmLnJlbW92ZShkYXRhKTtcclxuICAgICAgICAvL1x0XHRcdFx0XHRkYXRhLmFkZGVkICAgJiYgc2VsZi5hZGQoZGF0YSk7XHJcbiAgICAgICAgLy9cdFx0XHRcdFx0ZGF0YS5jaGFuZ2VkICYmIHNlbGYuY2hhbmdlKGRhdGEpO1xyXG4gICAgICAgIC8vIFx0XHRcdFx0XHRzZWxmLnRyaWdnZXIoJ3VwbG9hZCcsIGRhdGEpO1xyXG4gICAgICAgIC8vXHRcdFx0XHRcdGRhdGEuc3luYyAmJiBzZWxmLnN5bmMoKTtcclxuICAgICAgICAvL1x0XHRcdFx0fSlcclxuICAgICAgICAvL1x0XHRcdFx0LmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAvL1x0XHRcdFx0XHRub3RpZnl0byAmJiBjbGVhclRpbWVvdXQobm90aWZ5dG8pO1xyXG4gICAgICAgIC8vXHRcdFx0XHRcdG5vdGlmeSAmJiBzZWxmLm5vdGlmeSh7dHlwZSA6ICd1cGxvYWQnLCBjbnQgOiAtY250LCBwcm9ncmVzcyA6IDEwMCpjbnR9KTtcclxuICAgICAgICAvL1x0XHRcdFx0fSksXHJcbiAgICAgICAgLy9cdFx0XHR4aHIgICAgICAgICA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpLFxyXG4gICAgICAgIC8vXHRcdFx0Zm9ybURhdGEgICAgPSBuZXcgRm9ybURhdGEoKSxcclxuICAgICAgICAvL1x0XHRcdGZpbGVzICAgICAgID0gZGF0YS5pbnB1dCA/IGRhdGEuaW5wdXQuZmlsZXMgOiBkYXRhLmZpbGVzLCBcclxuICAgICAgICAvL1x0XHRcdGNudCAgICAgICAgID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgIC8vXHRcdFx0bG9hZGVkICAgICAgPSA1LFxyXG4gICAgICAgIC8vXHRcdFx0bm90aWZ5ICAgICAgPSBmYWxzZSxcclxuICAgICAgICAvL1x0XHRcdHN0YXJ0Tm90aWZ5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy9cdFx0XHRcdHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vXHRcdFx0XHRcdG5vdGlmeSA9IHRydWU7XHJcbiAgICAgICAgLy9cdFx0XHRcdFx0c2VsZi5ub3RpZnkoe3R5cGUgOiAndXBsb2FkJywgY250IDogY250LCBwcm9ncmVzcyA6IGxvYWRlZCpjbnR9KTtcclxuICAgICAgICAvL1x0XHRcdFx0fSwgc2VsZi5vcHRpb25zLm5vdGlmeURlbGF5KTtcclxuICAgICAgICAvL1x0XHRcdH0sXHJcbiAgICAgICAgLy9cdFx0XHRub3RpZnl0bztcclxuXHJcbiAgICAgICAgLy9cdFx0aWYgKCFjbnQpIHtcclxuICAgICAgICAvL1x0XHRcdHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIC8vXHRcdH1cclxuXHJcbiAgICAgICAgLy9cdFx0eGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy9cdFx0XHRkZnJkLnJlamVjdCgnZXJyQ29ubmVjdCcpO1xyXG4gICAgICAgIC8vXHRcdH0sIGZhbHNlKTtcclxuXHJcbiAgICAgICAgLy9cdFx0eGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy9cdFx0XHRkZnJkLnJlamVjdChbJ2VyckNvbm5lY3QnLCAnZXJyQWJvcnQnXSk7XHJcbiAgICAgICAgLy9cdFx0fSwgZmFsc2UpO1xyXG5cclxuICAgICAgICAvL1x0XHR4aHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vXHRcdFx0dmFyIHN0YXR1cyA9IHhoci5zdGF0dXMsIGRhdGE7XHJcblxyXG4gICAgICAgIC8vXHRcdFx0aWYgKHN0YXR1cyA+IDUwMCkge1xyXG4gICAgICAgIC8vXHRcdFx0XHRyZXR1cm4gZGZyZC5yZWplY3QoJ2VyclJlc3BvbnNlJyk7XHJcbiAgICAgICAgLy9cdFx0XHR9XHJcbiAgICAgICAgLy9cdFx0XHRpZiAoc3RhdHVzICE9IDIwMCkge1xyXG4gICAgICAgIC8vXHRcdFx0XHRyZXR1cm4gZGZyZC5yZWplY3QoJ2VyckNvbm5lY3QnKTtcclxuICAgICAgICAvL1x0XHRcdH1cclxuICAgICAgICAvL1x0XHRcdGlmICh4aHIucmVhZHlTdGF0ZSAhPSA0KSB7XHJcbiAgICAgICAgLy9cdFx0XHRcdHJldHVybiBkZnJkLnJlamVjdChbJ2VyckNvbm5lY3QnLCAnZXJyVGltZW91dCddKTsgLy8gYW0gaSByaWdodD9cclxuICAgICAgICAvL1x0XHRcdH1cclxuICAgICAgICAvL1x0XHRcdGlmICgheGhyLnJlc3BvbnNlVGV4dCkge1xyXG4gICAgICAgIC8vXHRcdFx0XHRyZXR1cm4gZGZyZC5yZWplY3QoWydlcnJSZXNwb25zZScsICdlcnJEYXRhRW1wdHknXSk7XHJcbiAgICAgICAgLy9cdFx0XHR9XHJcblxyXG4gICAgICAgIC8vXHRcdFx0ZGF0YSA9IHNlbGYucGFyc2VVcGxvYWREYXRhKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgIC8vXHRcdFx0aWYgKGRhdGEucmVkdXJsKSB7XHJcbiAgICAgICAgLy9cdFx0XHQgICAgaWYgKHNlbGYuaXNNb2RhbCkge1xyXG4gICAgICAgIC8vXHRcdFx0ICAgICAgICBpZiAocGFyZW50Lk1hc3RlciAmJiBwYXJlbnQuTWFzdGVyLmdvVXJsKSB7XHJcbiAgICAgICAgLy9cdFx0XHQgICAgICAgICAgICBwYXJlbnQuTWFzdGVyLmdvVXJsKGRhdGEucmVkdXJsKTtcclxuICAgICAgICAvL1x0XHRcdCAgICAgICAgfVxyXG4gICAgICAgIC8vXHRcdFx0ICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9cdFx0XHQgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gZGF0YS5yZWR1cmw7XHJcbiAgICAgICAgLy9cdFx0XHQgICAgfVxyXG4gICAgICAgIC8vXHRcdFx0ICAgIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgLy9cdFx0XHR9ZWxzZSBkYXRhLmVycm9yID8gZGZyZC5yZWplY3QoZGF0YS5lcnJvcikgOiBkZnJkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgLy9cdFx0fSwgZmFsc2UpO1xyXG5cclxuICAgICAgICAvL1x0XHR4aHIudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIC8vXHRcdFx0dmFyIHByZXYgPSBsb2FkZWQsIGN1cnI7XHJcblxyXG4gICAgICAgIC8vXHRcdFx0aWYgKGUubGVuZ3RoQ29tcHV0YWJsZSkge1xyXG5cclxuICAgICAgICAvL1x0XHRcdFx0Y3VyciA9IHBhcnNlSW50KGUubG9hZGVkKjEwMCAvIGUudG90YWwpO1xyXG5cclxuICAgICAgICAvL1x0XHRcdFx0Ly8gdG8gYXZvaWQgc3RyYW5nZSBidWcgaW4gc2FmYXJpIChub3QgaW4gY2hyb21lKSB3aXRoIGRyYWcmZHJvcC5cclxuICAgICAgICAvL1x0XHRcdFx0Ly8gYnVnOiBtYWNvcyBmaW5kZXIgb3BlbmVkIGluIGFueSBmb2xkZXIsXHJcbiAgICAgICAgLy9cdFx0XHRcdC8vIHJlc2V0IHNhZmFyaSBjYWNoZSAob3B0aW9uK2NvbW1hbmQrZSksIHJlbG9hZCBlbGZpbmRlciBwYWdlLFxyXG4gICAgICAgIC8vXHRcdFx0XHQvLyBkcm9wIGZpbGUgZnJvbSBmaW5kZXJcclxuICAgICAgICAvL1x0XHRcdFx0Ly8gb24gZmlyc3QgYXR0ZW1wdCByZXF1ZXN0IHN0YXJ0cyAocHJvZ3Jlc3MgY2FsbGJhY2sgY2FsbGVkIG9uZXMpIGJ1dCBuZXZlciBlbmRzLlxyXG4gICAgICAgIC8vXHRcdFx0XHQvLyBhbnkgbmV4dCBkcm9wIC0gc3VjY2Vzc2Z1bGwuXHJcbiAgICAgICAgLy9cdFx0XHRcdGlmIChjdXJyID4gMCAmJiAhbm90aWZ5dG8pIHtcclxuICAgICAgICAvL1x0XHRcdFx0XHRub3RpZnl0byA9IHN0YXJ0Tm90aWZ5KCk7XHJcbiAgICAgICAgLy9cdFx0XHRcdH1cclxuXHJcbiAgICAgICAgLy9cdFx0XHRcdGlmIChjdXJyIC0gcHJldiA+IDQpIHtcclxuICAgICAgICAvL1x0XHRcdFx0XHRsb2FkZWQgPSBjdXJyO1xyXG4gICAgICAgIC8vXHRcdFx0XHRcdG5vdGlmeSAmJiBzZWxmLm5vdGlmeSh7dHlwZSA6ICd1cGxvYWQnLCBjbnQgOiAwLCBwcm9ncmVzcyA6IChsb2FkZWQgLSBwcmV2KSpjbnR9KTtcclxuICAgICAgICAvL1x0XHRcdFx0fVxyXG4gICAgICAgIC8vXHRcdFx0fVxyXG4gICAgICAgIC8vXHRcdH0sIGZhbHNlKTtcclxuXHJcblxyXG4gICAgICAgIC8vXHRcdHhoci5vcGVuKCdQT1NUJywgc2VsZi51cGxvYWRVUkwsIHRydWUpO1xyXG4gICAgICAgIC8vXHRcdGZvcm1EYXRhLmFwcGVuZCgnY21kJywgJ3VwbG9hZCcpO1xyXG4gICAgICAgIC8vXHRcdC8vZm9ybURhdGEuYXBwZW5kKCdub3RVcGxvYWRGaWxlc0luZGV4Jywgbm90VXBsb2FkRmlsZXNJbmRleCk7XHJcbiAgICAgICAgLy9cdFx0Zm9ybURhdGEuYXBwZW5kKHNlbGYubmV3QVBJID8gJ3RhcmdldCcgOiAnY3VycmVudCcsIHNlbGYuY3dkKCkuaGFzaCk7XHJcbiAgICAgICAgLy9cdFx0JC5lYWNoKHNlbGYub3B0aW9ucy5jdXN0b21EYXRhLCBmdW5jdGlvbihrZXksIHZhbCkge1xyXG4gICAgICAgIC8vXHRcdFx0Zm9ybURhdGEuYXBwZW5kKGtleSwgdmFsKTtcclxuICAgICAgICAvL1x0XHR9KTtcclxuICAgICAgICAvL1x0XHQkLmVhY2goc2VsZi5vcHRpb25zLm9ubHlNaW1lcywgZnVuY3Rpb24oaSwgbWltZSkge1xyXG4gICAgICAgIC8vXHRcdFx0Zm9ybURhdGEuYXBwZW5kKCdtaW1lc1snK2krJ10nLCBtaW1lKTtcclxuICAgICAgICAvL1x0XHR9KTtcclxuXHJcbiAgICAgICAgLy9cdFx0JC5lYWNoKGZpbGVzLCBmdW5jdGlvbihpLCBmaWxlKSB7XHJcbiAgICAgICAgLy9cdFx0XHRmb3JtRGF0YS5hcHBlbmQoJ3VwbG9hZFtdJywgZmlsZSk7XHJcbiAgICAgICAgLy9cdFx0fSk7XHJcblxyXG4gICAgICAgIC8vXHRcdHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL1x0XHRcdGlmICh4aHIucmVhZHlTdGF0ZSA9PSA0ICYmIHhoci5zdGF0dXMgPT0gMCkge1xyXG4gICAgICAgIC8vXHRcdFx0XHQvLyBmZiBidWcgd2hpbGUgc2VuZCB6ZXJvIHNpemVkIGZpbGVcclxuICAgICAgICAvL1x0XHRcdFx0Ly8gZm9yIHNhZmFyaSAtIHNlbmQgZGlyZWN0b3J5XHJcbiAgICAgICAgLy9cdFx0XHRcdGRmcmQucmVqZWN0KFsnZXJyQ29ubmVjdCcsICdlcnJBYm9ydCddKTtcclxuICAgICAgICAvL1x0XHRcdH1cclxuICAgICAgICAvL1x0XHR9XHJcblxyXG4gICAgICAgIC8vXHRcdHhoci5zZW5kKGZvcm1EYXRhKTtcclxuXHJcbiAgICAgICAgLy9cdFx0aWYgKCF0aGlzLlVBLlNhZmFyaSB8fCAhZGF0YS5maWxlcykge1xyXG4gICAgICAgIC8vXHRcdFx0bm90aWZ5dG8gPSBzdGFydE5vdGlmeSgpO1xyXG4gICAgICAgIC8vXHRcdH1cclxuXHJcbiAgICAgICAgLy9cdFx0cmV0dXJuIGRmcmQ7XHJcbiAgICAgICAgLy9cdH1cclxuICAgICAgICAvL30sXHJcbiAgICAgICAgeGhyOiBmdW5jdGlvbihkYXRhLCBmbSwgbm90VXBsb2FkRmlsZXNJbmRleCwgZHVibGljYXRlSW5kZXhlcykge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IGZtID8gZm0gOiB0aGlzLFxyXG4gICAgICAgICAgICAgICAgZmlsZXMgPSBkYXRhLmlucHV0ID8gZGF0YS5pbnB1dC5maWxlcyA6IGRhdGEuZmlsZXMsXHJcbiAgICAgICAgICAgICAgICBjbnQgPSBmaWxlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICBub3RpZnkgPSBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGFkZFdpdGhOZXdJbmRleCA9IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgc3RhcnROb3RpZnkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZ5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ub3RpZnkoeyB0eXBlOiAndXBsb2FkJywgY250OiAxIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIHNlbGYub3B0aW9ucy5ub3RpZnlEZWxheSk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbm90aWZ5dG87XHJcblxyXG4gICAgICAgICAgICBpZiAoIWNudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY250OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZnJkID0gJC5EZWZlcnJlZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgJiYgc2VsZi5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEud2FybmluZyAmJiBzZWxmLmVycm9yKGRhdGEud2FybmluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucmVtb3ZlZCAmJiBzZWxmLnJlbW92ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5hZGRlZCAmJiBzZWxmLmFkZChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5jaGFuZ2VkICYmIHNlbGYuY2hhbmdlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRyaWdnZXIoJ3VwbG9hZCcsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnN5bmMgJiYgc2VsZi5zeW5jKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpZnl0byAmJiBjbGVhclRpbWVvdXQobm90aWZ5dG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpZnkgJiYgc2VsZi5ub3RpZnkoeyB0eXBlOiAndXBsb2FkJywgY250OiAtMSB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChkdWJsaWNhdGVJbmRleGVzICYmICQuaW5BcnJheShpLCBkdWJsaWNhdGVJbmRleGVzKSAhPSAtMSlcclxuICAgICAgICAgICAgICAgICAgICBhZGRXaXRoTmV3SW5kZXggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIGFkZFdpdGhOZXdJbmRleCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vdFVwbG9hZEZpbGVzSW5kZXggJiYgbm90VXBsb2FkRmlsZXNJbmRleC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShpLnRvU3RyaW5nKCksIG5vdFVwbG9hZEZpbGVzSW5kZXgpID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZHN0YXJ0KGZpbGVzW2ldLCBmbSwgZGZyZCwgYWRkV2l0aE5ld0luZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLlVBLlNhZmFyaSB8fCAhZGF0YS5maWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZ5dG8gPSBzdGFydE5vdGlmeSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRzdGFydChmaWxlc1tpXSwgZm0sIGRmcmQsIGFkZFdpdGhOZXdJbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLlVBLlNhZmFyaSB8fCAhZGF0YS5maWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpZnl0byA9IHN0YXJ0Tm90aWZ5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBsb2Fkc3RhcnQ6IGZ1bmN0aW9uKGZpbGUsIGZtLCBkZnJkLCBhZGRXaXRoTmV3SW5kZXgpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IGZtID8gZm0gOiB0aGlzLFxyXG4gICAgICAgICAgICB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKSxcclxuICAgICAgICAgICAgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuXHJcbiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGRmcmQucmVqZWN0KCdlcnJDb25uZWN0Jyk7XHJcbiAgICAgICAgfSwgZmFsc2UpO1xyXG5cclxuICAgICAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgZGZyZC5yZWplY3QoWydlcnJDb25uZWN0JywgJ2VyckFib3J0J10pO1xyXG4gICAgICAgIH0sIGZhbHNlKTtcclxuXHJcbiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHN0YXR1cyA9IHhoci5zdGF0dXMsIGRhdGE7XHJcblxyXG4gICAgICAgICAgICBpZiAoc3RhdHVzID4gNTAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoJ2VyclJlc3BvbnNlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHN0YXR1cyAhPSAyMDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgnZXJyQ29ubmVjdCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSAhPSA0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoWydlcnJDb25uZWN0JywgJ2VyclRpbWVvdXQnXSk7IC8vIGFtIGkgcmlnaHQ/XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF4aHIucmVzcG9uc2VUZXh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoWydlcnJSZXNwb25zZScsICdlcnJEYXRhRW1wdHknXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRhdGEgPSBzZWxmLnBhcnNlVXBsb2FkRGF0YSh4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICAgICAgaWYgKGRhdGEucmVkdXJsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5pc01vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudC5NYXN0ZXIgJiYgcGFyZW50Lk1hc3Rlci5nb1VybCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuTWFzdGVyLmdvVXJsKGRhdGEucmVkdXJsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gZGF0YS5yZWR1cmw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgICAgICB9IGVsc2UgZGF0YS5lcnJvciA/IGRmcmQucmVqZWN0KGRhdGEuZXJyb3IpIDogZGZyZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgIH0sIGZhbHNlKTtcclxuXHJcbiAgICAgICAgeGhyLm9wZW4oJ1BPU1QnLCBzZWxmLnVwbG9hZFVSTCwgdHJ1ZSk7XHJcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdjbWQnLCAndXBsb2FkJyk7XHJcblxyXG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZChzZWxmLm5ld0FQSSA/ICd0YXJnZXQnIDogJ2N1cnJlbnQnLCBzZWxmLmN3ZCgpLmhhc2gpO1xyXG4gICAgICAgICQuZWFjaChzZWxmLm9wdGlvbnMuY3VzdG9tRGF0YSwgZnVuY3Rpb24oa2V5LCB2YWwpIHtcclxuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKGtleSwgdmFsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkLmVhY2goc2VsZi5vcHRpb25zLm9ubHlNaW1lcywgZnVuY3Rpb24oaSwgbWltZSkge1xyXG4gICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ21pbWVzWycgKyBpICsgJ10nLCBtaW1lKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2FkZFdpdGhOZXdJbmRleCcsIGFkZFdpdGhOZXdJbmRleCA/IGFkZFdpdGhOZXdJbmRleCA6IGZhbHNlKTtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3VwbG9hZFtdJywgZmlsZSk7XHJcblxyXG4gICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09IDQgJiYgeGhyLnN0YXR1cyA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBmZiBidWcgd2hpbGUgc2VuZCB6ZXJvIHNpemVkIGZpbGVcclxuICAgICAgICAgICAgICAgIC8vIGZvciBzYWZhcmkgLSBzZW5kIGRpcmVjdG9yeVxyXG4gICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoWydlcnJDb25uZWN0JywgJ2VyckFib3J0J10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgeGhyLnNlbmQoZm9ybURhdGEpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBCaW5kIGNhbGxiYWNrIHRvIGV2ZW50KHMpIFRoZSBjYWxsYmFjayBpcyBleGVjdXRlZCBhdCBtb3N0IG9uY2UgcGVyIGV2ZW50LlxyXG5cdCAqIFRvIGJpbmQgdG8gbXVsdGlwbHkgZXZlbnRzIGF0IG9uY2UsIHNlcGFyYXRlIGV2ZW50cyBuYW1lcyBieSBzcGFjZVxyXG5cdCAqXHJcblx0ICogQHBhcmFtICBTdHJpbmcgICAgZXZlbnQgbmFtZVxyXG5cdCAqIEBwYXJhbSAgRnVuY3Rpb24gIGNhbGxiYWNrXHJcblx0ICogQHJldHVybiBlbEZpbmRlclxyXG5cdCAqL1xyXG4gICAgb25lOiBmdW5jdGlvbihldmVudCwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXMsXHJcbiAgICAgICAgICAgIGggPSAkLnByb3h5KGNhbGxiYWNrLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgc2VsZi51bmJpbmQoZXZlbnQudHlwZSwgaCk7IH0sIDMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJpbmQoZXZlbnQsIGgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBTZXQvZ2V0IGRhdGEgaW50by9mcm9tIGxvY2FsU3RvcmFnZVxyXG5cdCAqXHJcblx0ICogQHBhcmFtICBTdHJpbmcgICAgICAga2V5XHJcblx0ICogQHBhcmFtICBTdHJpbmd8dm9pZCAgdmFsdWVcclxuXHQgKiBAcmV0dXJuIFN0cmluZ1xyXG5cdCAqL1xyXG4gICAgbG9jYWxTdG9yYWdlOiBmdW5jdGlvbihrZXksIHZhbCkge1xyXG4gICAgICAgIHZhciBzID0gd2luZG93LmxvY2FsU3RvcmFnZTtcclxuXHJcbiAgICAgICAga2V5ID0gJ2VsZmluZGVyLScgKyBrZXkgKyB0aGlzLmlkO1xyXG5cclxuICAgICAgICBpZiAodmFsID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW1vdmUnLCBrZXkpO1xyXG4gICAgICAgICAgICByZXR1cm4gcy5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodmFsICE9PSB2b2lkICgwKSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgcy5zZXRJdGVtKGtleSwgdmFsKTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgcy5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgcy5zZXRJdGVtKGtleSwgdmFsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHMuZ2V0SXRlbShrZXkpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBHZXQvc2V0IGNvb2tpZVxyXG5cdCAqXHJcblx0ICogQHBhcmFtICBTdHJpbmcgICAgICAgY29va2llIG5hbWVcclxuXHQgKiBAcGFyYW0gIFN0cmluZ3x2b2lkICBjb29raWUgdmFsdWVcclxuXHQgKiBAcmV0dXJuIFN0cmluZ1xyXG5cdCAqL1xyXG4gICAgY29va2llOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBkLCBvLCBjLCBpO1xyXG5cclxuICAgICAgICBuYW1lID0gJ2VsZmluZGVyLScgKyBuYW1lICsgdGhpcy5pZDtcclxuXHJcbiAgICAgICAgaWYgKHZhbHVlID09PSB2b2lkICgwKSkge1xyXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQuY29va2llICYmIGRvY3VtZW50LmNvb2tpZSAhPSAnJykge1xyXG4gICAgICAgICAgICAgICAgYyA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpO1xyXG4gICAgICAgICAgICAgICAgbmFtZSArPSAnPSc7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNbaV0gPSAkLnRyaW0oY1tpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNbaV0uc3Vic3RyaW5nKDAsIG5hbWUubGVuZ3RoKSA9PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoY1tpXS5zdWJzdHJpbmcobmFtZS5sZW5ndGgpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbyA9ICQuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnMuY29va2llKTtcclxuICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdmFsdWUgPSAnJztcclxuICAgICAgICAgICAgby5leHBpcmVzID0gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgKG8uZXhwaXJlcykgPT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgZCA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICAgIGQuc2V0VGltZShkLmdldFRpbWUoKSArIChvLmV4cGlyZXMgKiA4NjQwMDAwMCkpO1xyXG4gICAgICAgICAgICBvLmV4cGlyZXMgPSBkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICc7IGV4cGlyZXM9JyArIG8uZXhwaXJlcy50b1VUQ1N0cmluZygpICsgKG8ucGF0aCA/ICc7IHBhdGg9JyArIG8ucGF0aCA6ICcnKSArIChvLmRvbWFpbiA/ICc7IGRvbWFpbj0nICsgby5kb21haW4gOiAnJykgKyAoby5zZWN1cmUgPyAnOyBzZWN1cmUnIDogJycpO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcblx0ICogR2V0IHN0YXJ0IGRpcmVjdG9yeSAoYnkgbG9jYXRpb24uaGFzaCBvciBsYXN0IG9wZW5lZCBkaXJlY3RvcnkpXHJcblx0ICogXHJcblx0ICogQHJldHVybiBTdHJpbmdcclxuXHQgKi9cclxuICAgIHN0YXJ0RGlyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgbG9jSGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xyXG4gICAgICAgIGlmIChsb2NIYXNoICYmIGxvY0hhc2gubWF0Y2goL14jZWxmXy8pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsb2NIYXNoLnJlcGxhY2UoL14jZWxmXy8sICcnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sYXN0RGlyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBHZXRSZWNlaXZlZE1haWxJZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICAgICAgICB2YXIgbSA9IGhyZWYubWF0Y2goJ2ZpbGVHcm91cFNlbmRJZD0oW0EtRmEtZjAtOS1dKiknKTtcclxuICAgICAgICBpZiAobSAmJiBtLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1bMV07XHJcbiAgICAgICAgfSBlbHNlIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9LFxyXG4gICAgR2V0TW9kYWxTdGF0dXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgdmFyIG0gPSBocmVmLm1hdGNoKCdpc21vZGFsJyk7XHJcbiAgICAgICAgaWYgKG0gJiYgbS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIH0gZWxzZSByZXR1cm4gMDtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcblx0ICogR2V0L3NldCBsYXN0IG9wZW5lZCBkaXJlY3RvcnlcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIFN0cmluZ3x1bmRlZmluZWQgIGRpciBoYXNoXHJcblx0ICogQHJldHVybiBTdHJpbmdcclxuXHQgKi9cclxuICAgIGxhc3REaXI6IGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLnJlbWVtYmVyTGFzdERpciA/IHRoaXMuc3RvcmFnZSgnbGFzdGRpcicsIGhhc2gpIDogJyc7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIE5vZGUgZm9yIGVzY2FwZSBodG1sIGVudGl0aWVzIGluIHRleHRzXHJcblx0ICogXHJcblx0ICogQHR5cGUgalF1ZXJ5XHJcblx0ICovXHJcbiAgICBfbm9kZTogJCgnPHNwYW4vPicpLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIFJlcGxhY2Ugbm90IGh0bWwtc2FmZSBzeW1ib2xzIHRvIGh0bWwgZW50aXRpZXNcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIFN0cmluZyAgdGV4dCB0byBlc2NhcGVcclxuXHQgKiBAcmV0dXJuIFN0cmluZ1xyXG5cdCAqL1xyXG4gICAgZXNjYXBlOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX25vZGUudGV4dChuYW1lKS5odG1sKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIENsZWFudXAgYWpheCBkYXRhLlxyXG5cdCAqIEZvciBvbGQgYXBpIGNvbnZlcnQgZGF0YSBpbnRvIG5ldyBhcGkgZm9ybWF0XHJcblx0ICogXHJcblx0ICogQHBhcmFtICBTdHJpbmcgIGNvbW1hbmQgbmFtZVxyXG5cdCAqIEBwYXJhbSAgT2JqZWN0ICBkYXRhIGZyb20gYmFja2VuZFxyXG5cdCAqIEByZXR1cm4gT2JqZWN0XHJcblx0ICovXHJcbiAgICBub3JtYWxpemU6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICB2YXIgZmlsdGVyID0gZnVuY3Rpb24oZmlsZSkge1xyXG5cclxuICAgICAgICAgICAgaWYgKGZpbGUgJiYgZmlsZS5oYXNoICYmIGZpbGUubmFtZSAmJiBmaWxlLm1pbWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlLm1pbWUgPT0gJ2FwcGxpY2F0aW9uL3gtZW1wdHknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZS5taW1lID0gJ3RleHQvcGxhaW4nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIHJldHVybiBmaWxlICYmIGZpbGUuaGFzaCAmJiBmaWxlLm5hbWUgJiYgZmlsZS5taW1lID8gZmlsZSA6IG51bGw7XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG4gICAgICAgIGlmIChkYXRhLmZpbGVzKSB7XHJcbiAgICAgICAgICAgIGRhdGEuZmlsZXMgPSAkLm1hcChkYXRhLmZpbGVzLCBmaWx0ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGF0YS50cmVlKSB7XHJcbiAgICAgICAgICAgIGRhdGEudHJlZSA9ICQubWFwKGRhdGEudHJlZSwgZmlsdGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGRhdGEuYWRkZWQpIHtcclxuICAgICAgICAgICAgZGF0YS5hZGRlZCA9ICQubWFwKGRhdGEuYWRkZWQsIGZpbHRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhLmNoYW5nZWQpIHtcclxuICAgICAgICAgICAgZGF0YS5jaGFuZ2VkID0gJC5tYXAoZGF0YS5jaGFuZ2VkLCBmaWx0ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGF0YS5hcGkpIHtcclxuICAgICAgICAgICAgZGF0YS5pbml0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIFVwZGF0ZSBzb3J0IG9wdGlvbnNcclxuXHQgKlxyXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBzb3J0IHR5cGVcclxuXHQgKiBAcGFyYW0ge1N0cmluZ30gc29ydCBvcmRlclxyXG5cdCAqIEBwYXJhbSB7Qm9vbGVhbn0gc2hvdyBmb2xkZXIgZmlyc3RcclxuXHQgKi9cclxuICAgIHNldFNvcnQ6IGZ1bmN0aW9uKHR5cGUsIG9yZGVyLCBzdGlja0ZvbGRlcnMpIHtcclxuICAgICAgICB0aGlzLnN0b3JhZ2UoJ3NvcnRUeXBlJywgKHRoaXMuc29ydFR5cGUgPSB0aGlzLnNvcnRSdWxlc1t0eXBlXSA/IHR5cGUgOiAnbmFtZScpKTtcclxuICAgICAgICB0aGlzLnN0b3JhZ2UoJ3NvcnRPcmRlcicsICh0aGlzLnNvcnRPcmRlciA9IC9hc2N8ZGVzYy8udGVzdChvcmRlcikgPyBvcmRlciA6ICdhc2MnKSk7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlKCdzb3J0U3RpY2tGb2xkZXJzJywgKHRoaXMuc29ydFN0aWNrRm9sZGVycyA9ICEhc3RpY2tGb2xkZXJzKSA/IDEgOiAnJyk7XHJcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdzb3J0Y2hhbmdlJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb3J0UnVsZXM6IHtcclxuICAgICAgICBuYW1lOiBmdW5jdGlvbihmaWxlMSwgZmlsZTIpIHsgcmV0dXJuIGZpbGUxLm5hbWUudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKGZpbGUyLm5hbWUudG9Mb3dlckNhc2UoKSk7IH0sXHJcbiAgICAgICAgc2l6ZTogZnVuY3Rpb24oZmlsZTEsIGZpbGUyKSB7XHJcbiAgICAgICAgICAgIHZhciBzaXplMSA9IHBhcnNlSW50KGZpbGUxLnNpemUpIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBzaXplMiA9IHBhcnNlSW50KGZpbGUyLnNpemUpIHx8IDA7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc2l6ZTEgPT0gc2l6ZTIgPyAwIDogc2l6ZTEgPiBzaXplMiA/IDEgOiAtMTtcclxuICAgICAgICAgICAgcmV0dXJuIChwYXJzZUludChmaWxlMS5zaXplKSB8fCAwKSA+IChwYXJzZUludChmaWxlMi5zaXplKSB8fCAwKSA/IDEgOiAtMTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGtpbmQ6IGZ1bmN0aW9uKGZpbGUxLCBmaWxlMikgeyByZXR1cm4gZmlsZTEubWltZS5sb2NhbGVDb21wYXJlKGZpbGUyLm1pbWUpOyB9LFxyXG4gICAgICAgIGRhdGU6IGZ1bmN0aW9uKGZpbGUxLCBmaWxlMikge1xyXG4gICAgICAgICAgICB2YXIgZGF0ZTEgPSBmaWxlMS50cyB8fCBmaWxlMS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTIgPSBmaWxlMi50cyB8fCBmaWxlMi5kYXRlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGRhdGUxID09IGRhdGUyID8gMCA6IGRhdGUxID4gZGF0ZTIgPyAxIDogLTE7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBDb21wYXJlIGZpbGVzIGJhc2VkIG9uIGVsRmluZGVyLnNvcnRcclxuXHQgKlxyXG5cdCAqIEBwYXJhbSAgT2JqZWN0ICBmaWxlXHJcblx0ICogQHBhcmFtICBPYmplY3QgIGZpbGVcclxuXHQgKiBAcmV0dXJuIE51bWJlclxyXG5cdCAqL1xyXG4gICAgY29tcGFyZTogZnVuY3Rpb24oZmlsZTEsIGZpbGUyKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxyXG4gICAgICAgICAgICB0eXBlID0gc2VsZi5zb3J0VHlwZSxcclxuICAgICAgICAgICAgYXNjID0gc2VsZi5zb3J0T3JkZXIgPT0gJ2FzYycsXHJcbiAgICAgICAgICAgIHN0aWNrID0gc2VsZi5zb3J0U3RpY2tGb2xkZXJzLFxyXG4gICAgICAgICAgICBydWxlcyA9IHNlbGYuc29ydFJ1bGVzLFxyXG4gICAgICAgICAgICBzb3J0ID0gcnVsZXNbdHlwZV0sXHJcbiAgICAgICAgICAgIGQxID0gZmlsZTEubWltZSA9PSAnZGlyZWN0b3J5JyxcclxuICAgICAgICAgICAgZDIgPSBmaWxlMi5taW1lID09ICdkaXJlY3RvcnknLFxyXG4gICAgICAgICAgICByZXM7XHJcblxyXG4gICAgICAgIGlmIChzdGljaykge1xyXG4gICAgICAgICAgICBpZiAoZDEgJiYgIWQyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWQxICYmIGQyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVzID0gYXNjID8gc29ydChmaWxlMSwgZmlsZTIpIDogc29ydChmaWxlMiwgZmlsZTEpO1xyXG5cclxuICAgICAgICByZXR1cm4gdHlwZSAhPSAnbmFtZScgJiYgcmVzID09IDBcclxuICAgICAgICAgICAgPyByZXMgPSBhc2MgPyBydWxlcy5uYW1lKGZpbGUxLCBmaWxlMikgOiBydWxlcy5uYW1lKGZpbGUyLCBmaWxlMSlcclxuICAgICAgICAgICAgOiByZXM7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIFNvcnQgZmlsZXMgYmFzZWQgb24gY29uZmlnXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gIEFycmF5ICBmaWxlc1xyXG5cdCAqIEByZXR1cm4gQXJyYXlcclxuXHQgKi9cclxuICAgIHNvcnRGaWxlczogZnVuY3Rpb24oZmlsZXMpIHtcclxuICAgICAgICByZXR1cm4gZmlsZXMuc29ydCh0aGlzLmNvbXBhcmUpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBPcGVuIG5vdGlmaWNhdGlvbiBkaWFsb2cgXHJcblx0ICogYW5kIGFwcGVuZC91cGRhdGUgbWVzc2FnZSBmb3IgcmVxdWlyZWQgbm90aWZpY2F0aW9uIHR5cGUuXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gIE9iamVjdCAgb3B0aW9uc1xyXG5cdCAqIEBleGFtcGxlICBcclxuXHQgKiB0aGlzLm5vdGlmeSh7XHJcblx0ICogICAgdHlwZSA6ICdjb3B5JyxcclxuXHQgKiAgICBtc2cgOiAnQ29weSBmaWxlcycsIC8vIG5vdCByZXF1aXJlZCBmb3Iga25vd24gdHlwZXMgQHNlZSB0aGlzLm5vdGlmeVR5cGVcclxuXHQgKiAgICBjbnQgOiAzLFxyXG5cdCAqICAgIGhpZGVDbnQgOiBmYWxzZSwgLy8gdHJ1ZSBmb3Igbm90IHNob3cgY291bnRcclxuXHQgKiAgICBwcm9ncmVzcyA6IDEwIC8vIHByb2dyZXNzIGJhciBwZXJjZW50cyAodXNlIGNudCA6IDAgdG8gdXBkYXRlIHByb2dyZXNzIGJhcilcclxuXHQgKiB9KVxyXG5cdCAqIEByZXR1cm4gZWxGaW5kZXJcclxuXHQgKi9cclxuICAgIG5vdGlmeTogZnVuY3Rpb24ob3B0cykge1xyXG5cclxuICAgICAgICB2YXIgdHlwZSA9IG9wdHMudHlwZSxcclxuICAgICAgICAgICAgbXNnID0gdGhpcy5tZXNzYWdlc1snbnRmJyArIHR5cGVdID8gdGhpcy5pMThuKCdudGYnICsgdHlwZSkgOiB0aGlzLmkxOG4oJ250ZnNtdGgnKSxcclxuICAgICAgICAgICAgbmRpYWxvZyA9IHRoaXMudWkubm90aWZ5LFxyXG4gICAgICAgICAgICBub3RpZnkgPSBuZGlhbG9nLmNoaWxkcmVuKCcuZWxmaW5kZXItbm90aWZ5LScgKyB0eXBlKSxcclxuICAgICAgICAgICAgbnRwbCA9ICc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItbm90aWZ5IGVsZmluZGVyLW5vdGlmeS17dHlwZX1cIj48c3BhbiBjbGFzcz1cImVsZmluZGVyLWRpYWxvZy1pY29uIGVsZmluZGVyLWRpYWxvZy1pY29uLXt0eXBlfVwiLz4gPGRpdiBjbGFzcz1cImVsZmluZGVyLW5vdGlmeS1wcm9ncmVzc2JhclwiPjxkaXYgY2xhc3M9XCJlbGZpbmRlci1ub3RpZnktcHJvZ3Jlc3NcIi8+PC9kaXY+PHNwYW4gY2xhc3M9XCJlbGZpbmRlci1ub3RpZnktbXNnXCI+e21zZ308L3NwYW4+IDxzcGFuIGNsYXNzPVwiZWxmaW5kZXItbm90aWZ5LWNudFwiLz48L2Rpdj4nLFxyXG4gICAgICAgICAgICBkZWx0YSA9IG9wdHMuY250LFxyXG4gICAgICAgICAgICBwcm9ncmVzcyA9IG9wdHMucHJvZ3Jlc3MgPj0gMCAmJiBvcHRzLnByb2dyZXNzIDw9IDEwMCA/IG9wdHMucHJvZ3Jlc3MgOiAwLFxyXG4gICAgICAgICAgICBjbnQsXHJcbiAgICAgICAgICAgIHRvdGFsLFxyXG4gICAgICAgICAgICBwcmM7XHJcblxyXG4gICAgICAgIGlmICghdHlwZSB8fCB0eXBlID09ICdhZGQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmICghbm90aWZ5Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICBub3RpZnkgPSAkKG50cGwucmVwbGFjZSgvXFx7dHlwZVxcfS9nLCB0eXBlKS5yZXBsYWNlKC9cXHttc2dcXH0vZywgbXNnKSlcclxuICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhuZGlhbG9nKVxyXG4gICAgICAgICAgICAgICAgLmRhdGEoJ2NudCcsIDApO1xyXG5cclxuICAgICAgICAgICAgaWYgKHByb2dyZXNzKSB7XHJcbiAgICAgICAgICAgICAgICBub3RpZnkuZGF0YSh7IHByb2dyZXNzOiAwLCB0b3RhbDogMCB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY250ID0gZGVsdGEgKyBwYXJzZUludChub3RpZnkuZGF0YSgnY250JykpO1xyXG5cclxuICAgICAgICBpZiAoY250ID4gMCkge1xyXG4gICAgICAgICAgICAhb3B0cy5oaWRlQ250ICYmIG5vdGlmeS5jaGlsZHJlbignLmVsZmluZGVyLW5vdGlmeS1jbnQnKS50ZXh0KCcoJyArIGNudCArICcpJyk7XHJcbiAgICAgICAgICAgIG5kaWFsb2cuaXMoJzpoaWRkZW4nKSAmJiBuZGlhbG9nLmVsZmluZGVyY3J5cHR4ZGlhbG9nKCdvcGVuJyk7IC8vIG5kaWFsb2cuZWxmaW5kZXJkaWFsb2coJ29wZW4nKTtcclxuICAgICAgICAgICAgbm90aWZ5LmRhdGEoJ2NudCcsIGNudCk7XHJcblxyXG4gICAgICAgICAgICBpZiAocHJvZ3Jlc3MgPCAxMDBcclxuICAgICAgICAgICAgICAgICYmICh0b3RhbCA9IG5vdGlmeS5kYXRhKCd0b3RhbCcpKSA+PSAwXHJcbiAgICAgICAgICAgICAgICAmJiAocHJjID0gbm90aWZ5LmRhdGEoJ3Byb2dyZXNzJykpID49IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgICB0b3RhbCA9IGRlbHRhICsgcGFyc2VJbnQobm90aWZ5LmRhdGEoJ3RvdGFsJykpO1xyXG4gICAgICAgICAgICAgICAgcHJjID0gcHJvZ3Jlc3MgKyBwcmM7XHJcbiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IHBhcnNlSW50KHByYyAvIHRvdGFsKTtcclxuICAgICAgICAgICAgICAgIG5vdGlmeS5kYXRhKHsgcHJvZ3Jlc3M6IHByYywgdG90YWw6IHRvdGFsIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIG5kaWFsb2cuZmluZCgnLmVsZmluZGVyLW5vdGlmeS1wcm9ncmVzcycpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogKHByb2dyZXNzIDwgMTAwID8gcHJvZ3Jlc3MgOiAxMDApICsgJyUnXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMjApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG5vdGlmeS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgIW5kaWFsb2cuY2hpbGRyZW4oKS5sZW5ndGggJiYgbmRpYWxvZy5lbGZpbmRlcmNyeXB0eGRpYWxvZygnY2xvc2UnKTsgLy9uZGlhbG9nLmVsZmluZGVyZGlhbG9nKCdjbG9zZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIE9wZW4gY29uZmlybWF0aW9uIGRpYWxvZyBcclxuXHQgKlxyXG5cdCAqIEBwYXJhbSAgT2JqZWN0ICBvcHRpb25zXHJcblx0ICogQGV4YW1wbGUgIFxyXG5cdCAqIHRoaXMuY29uZmlybSh7XHJcblx0ICogICAgdGl0bGUgOiAnUmVtb3ZlIGZpbGVzJyxcclxuXHQgKiAgICB0ZXh0ICA6ICdIZXJlIGlzIHF1ZXN0aW9uIHRleHQnLFxyXG5cdCAqICAgIGFjY2VwdCA6IHsgIC8vIGFjY2VwdCBjYWxsYmFjayAtIHJlcXVpcmVkXHJcblx0ICogICAgICBsYWJlbCA6ICdDb250aW51ZScsXHJcblx0ICogICAgICBjYWxsYmFjayA6IGZ1bmN0aW9uKGFwcGx5VG9BbGwpIHsgZm0ubG9nKCdPaycpIH1cclxuXHQgKiAgICB9LFxyXG5cdCAqICAgIGNhbmNlbCA6IHsgLy8gY2FuY2VsIGNhbGxiYWNrIC0gcmVxdWlyZWRcclxuXHQgKiAgICAgIGxhYmVsIDogJ0NhbmNlbCcsXHJcblx0ICogICAgICBjYWxsYmFjayA6IGZ1bmN0aW9uKCkgeyBmbS5sb2coJ0NhbmNlbCcpfVxyXG5cdCAqICAgIH0sXHJcblx0ICogICAgcmVqZWN0IDogeyAvLyByZWplY3QgY2FsbGJhY2sgLSBvcHRpb25hbGx5XHJcblx0ICogICAgICBsYWJlbCA6ICdObycsXHJcblx0ICogICAgICBjYWxsYmFjayA6IGZ1bmN0aW9uKGFwcGx5VG9BbGwpIHsgZm0ubG9nKCdObycpfVxyXG5cdCAqICAgfSxcclxuXHQgKiAgIGFsbCA6IHRydWUgIC8vIGRpc3BsYXkgY2hlY2tib3ggXCJBcHBseSB0byBhbGxcIlxyXG5cdCAqIH0pXHJcblx0ICogQHJldHVybiBlbEZpbmRlclxyXG5cdCAqL1xyXG4gICAgY29uZmlybTogZnVuY3Rpb24ob3B0cykge1xyXG4gICAgICAgIHZhciBjb21wbGV0ZSA9IGZhbHNlLFxyXG4gICAgICAgICAgICBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgY3NzQ2xhc3M6ICdlbGZpbmRlci1kaWFsb2ctY29uZmlybScsXHJcbiAgICAgICAgICAgICAgICBtb2RhbDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy5pMThuKG9wdHMudGl0bGUgfHwgJ2NvbmZpcm1SZXEnKSxcclxuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHt9LFxyXG4gICAgICAgICAgICAgICAgY2xvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICFjb21wbGV0ZSAmJiBvcHRzLmNhbmNlbC5jYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vJCh0aGlzKS5lbGZpbmRlcmRpYWxvZygnZGVzdHJveScpO1xyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZWxmaW5kZXJjcnlwdHhkaWFsb2coJ2Rlc3Ryb3knKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYXBwbHkgPSB0aGlzLmkxOG4oJ2FwbGx5QWxsJyksXHJcbiAgICAgICAgICAgIGxhYmVsLFxyXG4gICAgICAgICAgICBjaGVja2JveDtcclxuXHJcblxyXG4gICAgICAgIGlmIChvcHRzLnJlamVjdCkge1xyXG4gICAgICAgICAgICBvcHRpb25zLmJ1dHRvbnNbdGhpcy5pMThuKG9wdHMucmVqZWN0LmxhYmVsKV0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGIgPSAkKHRoaXMpLmZpbmQoJ2lucHV0W3R5cGU9Y2hlY2tib3hdJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWxsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hiICYmIGNoYi5wcm9wKCdjaGVja2VkJykpIGFsbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBvcHRzLnJlamVjdC5jYWxsYmFjayghIShhbGwpKTtcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIC8vJCh0aGlzKS5lbGZpbmRlcmRpYWxvZygnY2xvc2UnKTtcclxuICAgICAgICAgICAgICAgICQodGhpcykuZWxmaW5kZXJjcnlwdHhkaWFsb2coJ2Nsb3NlJyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBvcHRpb25zLmJ1dHRvbnNbdGhpcy5pMThuKG9wdHMuYWNjZXB0LmxhYmVsKV0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGNoYiA9ICQodGhpcykuZmluZCgnaW5wdXRbdHlwZT1jaGVja2JveF0nKTtcclxuICAgICAgICAgICAgdmFyIGFsbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoY2hiICYmIGNoYi5wcm9wKCdjaGVja2VkJykpIGFsbCA9IHRydWU7XHJcbiAgICAgICAgICAgIG9wdHMuYWNjZXB0LmNhbGxiYWNrKCEhKGFsbCkpO1xyXG4gICAgICAgICAgICBjb21wbGV0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vJCh0aGlzKS5lbGZpbmRlcmRpYWxvZygnY2xvc2UnKVxyXG4gICAgICAgICAgICAkKHRoaXMpLmVsZmluZGVyY3J5cHR4ZGlhbG9nKCdjbG9zZScpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIG9wdGlvbnMuYnV0dG9uc1t0aGlzLmkxOG4ob3B0cy5jYW5jZWwubGFiZWwpXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyQodGhpcykuZWxmaW5kZXJkaWFsb2coJ2Nsb3NlJylcclxuICAgICAgICAgICAgJCh0aGlzKS5lbGZpbmRlcmNyeXB0eGRpYWxvZygnY2xvc2UnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAob3B0cy5hbGwpIHtcclxuICAgICAgICAgICAgaWYgKG9wdHMucmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBvcHRpb25zLndpZHRoID0gMzcwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wdGlvbnMuY3JlYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAvL2NoZWNrYm94ID0gJCgnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIC8+Jyk7XHJcbiAgICAgICAgICAgICAgICAvLyQodGhpcykubmV4dCgpLmNoaWxkcmVuKCkuYmVmb3JlKCQoJzxsYWJlbD4nK2FwcGx5Kyc8L2xhYmVsPicpLnByZXBlbmQoY2hlY2tib3gpKTtcclxuICAgICAgICAgICAgICAgIHZhciBjaGVja2JveGZvcmJsb2NrID0gJCgnPHNwYW4gY2xhc3M9XCJidXR0b24tY2hlY2tib3ggYm9vdHN0cmFwLWNoZWNrYm94XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBhdXRvY29tcGxldGU9XCJvZmZcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiaWNvbiBjYi1pY29uLWNoZWNrIHNxdWFyZVwiIHN0eWxlPVwiZGlzcGxheTogbm9uZTtcIj48L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiaWNvbiBjYi1pY29uLWNoZWNrLWVtcHR5IHNxdWFyZVwiPjwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPC9zcGFuPicpLmJpbmQoJ2hvdmVyJywgZnVuY3Rpb24oKSB7ICQodGhpcykudG9nZ2xlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7IH0pOztcclxuXHJcbiAgICAgICAgICAgICAgICBjaGVja2JveGZvcmJsb2NrLmZpbmQoJ2lucHV0W3R5cGU9Y2hlY2tib3hdJylcclxuICAgICAgICAgICAgICAgICAgICAuYmluZCgnY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwciA9ICQodGhpcykucGFyZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGJveCA9ICQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGJveC5pcygnOmNoZWNrZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHIuZmluZCgnLmNiLWljb24tY2hlY2snKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwci5maW5kKCcuY2ItaWNvbi1jaGVjay1lbXB0eScpLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYm94LnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByLmZpbmQoJy5jYi1pY29uLWNoZWNrJykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHIuZmluZCgnLmNiLWljb24tY2hlY2stZW1wdHknKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGJveC5wcm9wKFwiY2hlY2tlZFwiLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRpdiA9ICQoJzxkaXYgc3R5bGU9XCJjdXJzb3I6cG9pbnRlcjsgbWFyZ2luOiAtMTNweCAwIDE1cHggNzVweFwiPicgKyBhcHBseSArICc8L2Rpdj4nKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hiID0gJCh0aGlzKS5maW5kKCdpbnB1dFt0eXBlPWNoZWNrYm94XScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYi5jaGFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIH0pLnByZXBlbmQoY2hlY2tib3hmb3JibG9jayk7XHJcblxyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hZnRlcigkKCc8ZGl2Lz4nKS5hcHBlbmQoZGl2KSk7XHJcbiAgICAgICAgICAgIH07IC8vb3B0aW9ucy5vcGVuID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vXHR2YXIgcGFuZSA9ICQodGhpcykubmV4dCgpLFxyXG4gICAgICAgICAgICAvL1x0XHR3aWR0aCA9IHBhcnNlSW50KHBhbmUuY2hpbGRyZW4oJzpmaXJzdCcpLm91dGVyV2lkdGgoKSArIHBhbmUuY2hpbGRyZW4oJzpsYXN0Jykub3V0ZXJXaWR0aCgpKTtcclxuXHJcbiAgICAgICAgICAgIC8vXHRpZiAod2lkdGggPiBwYXJzZUludChwYW5lLndpZHRoKCkpKSB7XHJcbiAgICAgICAgICAgIC8vXHRcdCQodGhpcykuY2xvc2VzdCgnLmVsZmluZGVyLWRpYWxvZycpLndpZHRoKHdpZHRoKzMwKTtcclxuICAgICAgICAgICAgLy9cdH1cclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL3JldHVybiB0aGlzLmRpYWxvZygnPHNwYW4gY2xhc3M9XCJlbGZpbmRlci1kaWFsb2ctaWNvbiBlbGZpbmRlci1kaWFsb2ctaWNvbi1jb25maXJtXCIvPicgKyB0aGlzLmkxOG4ob3B0cy50ZXh0KSwgb3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlhbG9nKCc8ZGl2IGNsYXNzPVwid2FybmluZ1wiPjxzcGFuPicgKyB0aGlzLmkxOG4ob3B0cy50ZXh0KSArICc8L3NwYW4+PC9kaXY+PC9kaXY+Jywgb3B0aW9ucyk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIENyZWF0ZSB1bmlxdWUgZmlsZSBuYW1lIGluIHJlcXVpcmVkIGRpclxyXG5cdCAqIFxyXG5cdCAqIEBwYXJhbSAgU3RyaW5nICBmaWxlIG5hbWVcclxuXHQgKiBAcGFyYW0gIFN0cmluZyAgcGFyZW50IGRpciBoYXNoXHJcblx0ICogQHJldHVybiBTdHJpbmdcclxuXHQgKi9cclxuICAgIHVuaXF1ZU5hbWU6IGZ1bmN0aW9uKHByZWZpeCwgcGhhc2gpIHtcclxuICAgICAgICB2YXIgaSA9IDAsIGV4dCA9ICcnLCBwLCBuYW1lO1xyXG5cclxuICAgICAgICBwcmVmaXggPSB0aGlzLmkxOG4ocHJlZml4KTtcclxuICAgICAgICBwaGFzaCA9IHBoYXNoIHx8IHRoaXMuY3dkKCkuaGFzaDtcclxuXHJcbiAgICAgICAgaWYgKChwID0gcHJlZml4LmluZGV4T2YoJy50eHQnKSkgIT0gLTEpIHtcclxuICAgICAgICAgICAgZXh0ID0gJy50eHQnO1xyXG4gICAgICAgICAgICBwcmVmaXggPSBwcmVmaXguc3Vic3RyKDAsIHApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbmFtZSA9IHByZWZpeCArIGV4dDtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmZpbGVCeU5hbWUobmFtZSwgcGhhc2gpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICB3aGlsZSAoaSA8IDEwMDAwKSB7XHJcbiAgICAgICAgICAgIG5hbWUgPSBwcmVmaXggKyAnICcgKyAoKytpKSArIGV4dDtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmZpbGVCeU5hbWUobmFtZSwgcGhhc2gpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcHJlZml4ICsgTWF0aC5yYW5kb20oKSArIGV4dDtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcblx0ICogUmV0dXJuIG1lc3NhZ2UgdHJhbnNsYXRlZCBvbnRvIGN1cnJlbnQgbGFuZ3VhZ2VcclxuXHQgKlxyXG5cdCAqIEBwYXJhbSAgU3RyaW5nfEFycmF5ICBtZXNzYWdlW3NdXHJcblx0ICogQHJldHVybiBTdHJpbmdcclxuXHQgKiovXHJcbiAgICBpMThuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXMsXHJcbiAgICAgICAgICAgIG1lc3NhZ2VzID0gdGhpcy5tZXNzYWdlcyxcclxuICAgICAgICAgICAgaW5wdXQgPSBbXSxcclxuICAgICAgICAgICAgaWdub3JlID0gW10sXHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBmdW5jdGlvbihtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmlsZTtcclxuICAgICAgICAgICAgICAgIGlmIChtLmluZGV4T2YoJyMnKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgoZmlsZSA9IHNlbGYuZmlsZShtLnN1YnN0cigxKSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWxlLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGksXHJcbiAgICAgICAgICAgIGosXHJcbiAgICAgICAgICAgIG07XHJcblxyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbSA9IGFyZ3VtZW50c1tpXTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbSA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgaW5wdXQucHVzaChtZXNzYWdlKG0pKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICgkLmlzQXJyYXkobSkpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBtLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtW2pdID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnB1c2gobWVzc2FnZShtW2pdKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgLy8gZG9udCB0cmFuc2xhdGUgcGxhY2Vob2xkZXJzXHJcbiAgICAgICAgICAgIGlmICgkLmluQXJyYXkoaSwgaWdub3JlKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG0gPSBpbnB1dFtpXTtcclxuICAgICAgICAgICAgLy8gdHJhbnNsYXRlIG1lc3NhZ2VcclxuICAgICAgICAgICAgbSA9IG1lc3NhZ2VzW21dIHx8IG07XHJcbiAgICAgICAgICAgIC8vIHJlcGxhY2UgcGxhY2Vob2xkZXJzIGluIG1lc3NhZ2VcclxuICAgICAgICAgICAgbSA9IG0ucmVwbGFjZSgvXFwkKFxcZCspL2csIGZ1bmN0aW9uKG1hdGNoLCBwbGFjZWhvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSBpICsgcGFyc2VJbnQocGxhY2Vob2xkZXIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlaG9sZGVyID4gMCAmJiBpbnB1dFtwbGFjZWhvbGRlcl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZ25vcmUucHVzaChwbGFjZWhvbGRlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXRbcGxhY2Vob2xkZXJdIHx8ICcnO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlucHV0W2ldID0gbTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAkLm1hcChpbnB1dCwgZnVuY3Rpb24obSwgaSkgeyByZXR1cm4gJC5pbkFycmF5KGksIGlnbm9yZSkgPT09IC0xID8gbSA6IG51bGw7IH0pLmpvaW4oJzxicj4nKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcblx0ICogQ29udmVydCBtaW1ldHlwZSBpbnRvIGNzcyBjbGFzc2VzXHJcblx0ICogXHJcblx0ICogQHBhcmFtICBTdHJpbmcgIGZpbGUgbWltZXR5cGVcclxuXHQgKiBAcmV0dXJuIFN0cmluZ1xyXG5cdCAqL1xyXG4gICAgbWltZTJjbGFzczogZnVuY3Rpb24obWltZSkge1xyXG4gICAgICAgIHZhciBwcmVmaXggPSAnZWxmaW5kZXItY3dkLWljb24tJztcclxuXHJcbiAgICAgICAgbWltZSA9IG1pbWUuc3BsaXQoJy8nKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHByZWZpeCArIG1pbWVbMF0gKyAobWltZVswXSAhPSAnaW1hZ2UnICYmIG1pbWVbMV0gPyAnICcgKyBwcmVmaXggKyBtaW1lWzFdLnJlcGxhY2UoLyhcXC58XFwrKS9nLCAnLScpIDogJycpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBSZXR1cm4gbG9jYWxpemVkIGtpbmQgb2YgZmlsZVxyXG5cdCAqIFxyXG5cdCAqIEBwYXJhbSAgT2JqZWN0fFN0cmluZyAgZmlsZSBvciBmaWxlIG1pbWV0eXBlXHJcblx0ICogQHJldHVybiBTdHJpbmdcclxuXHQgKi9cclxuICAgIG1pbWUya2luZDogZnVuY3Rpb24oZikge1xyXG4gICAgICAgIHZhciBtaW1lID0gdHlwZW9mIChmKSA9PSAnb2JqZWN0JyA/IGYubWltZSA6IGYsIGtpbmQ7XHJcblxyXG4gICAgICAgIGlmIChmLmFsaWFzKSB7XHJcbiAgICAgICAgICAgIGtpbmQgPSAnQWxpYXMnO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5raW5kc1ttaW1lXSkge1xyXG4gICAgICAgICAgICBraW5kID0gdGhpcy5raW5kc1ttaW1lXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAobWltZS5pbmRleE9mKCd0ZXh0JykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGtpbmQgPSAnVGV4dCc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWltZS5pbmRleE9mKCdpbWFnZScpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBraW5kID0gJ0ltYWdlJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChtaW1lLmluZGV4T2YoJ2F1ZGlvJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGtpbmQgPSAnQXVkaW8nO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1pbWUuaW5kZXhPZigndmlkZW8nKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAga2luZCA9ICdWaWRlbyc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWltZS5pbmRleE9mKCdhcHBsaWNhdGlvbicpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBraW5kID0gJ0FwcCc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBraW5kID0gbWltZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZXNbJ2tpbmQnICsga2luZF0gPyB0aGlzLmkxOG4oJ2tpbmQnICsga2luZCkgOiBtaW1lO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBSZXR1cm4gbG9jYWxpemVkIGRhdGVcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIE9iamVjdCAgZmlsZSBvYmplY3RcclxuXHQgKiBAcmV0dXJuIFN0cmluZ1xyXG5cdCAqL1xyXG4gICAgZm9ybWF0RGF0ZTogZnVuY3Rpb24oZmlsZSwgdHMpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXMsXHJcbiAgICAgICAgICAgIHRzID0gdHMgfHwgZmlsZS50cyxcclxuICAgICAgICAgICAgaTE4ID0gc2VsZi5pMTgsXHJcbiAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgIGZvcm1hdCxcclxuICAgICAgICAgICAgb3V0cHV0LFxyXG4gICAgICAgICAgICBkLFxyXG4gICAgICAgICAgICBkdyxcclxuICAgICAgICAgICAgbSxcclxuICAgICAgICAgICAgeSxcclxuICAgICAgICAgICAgaCxcclxuICAgICAgICAgICAgZyxcclxuICAgICAgICAgICAgaSxcclxuICAgICAgICAgICAgcztcclxuXHJcbiAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5jbGllbnRGb3JtYXREYXRlICYmIHRzID4gMCkge1xyXG5cclxuICAgICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKHRzICogMTAwMCk7XHJcblxyXG4gICAgICAgICAgICBoID0gZGF0ZVtzZWxmLmdldEhvdXJzXSgpO1xyXG4gICAgICAgICAgICBnID0gaCA+IDEyID8gaCAtIDEyIDogaDtcclxuICAgICAgICAgICAgaSA9IGRhdGVbc2VsZi5nZXRNaW51dGVzXSgpO1xyXG4gICAgICAgICAgICBzID0gZGF0ZVtzZWxmLmdldFNlY29uZHNdKCk7XHJcbiAgICAgICAgICAgIGQgPSBkYXRlW3NlbGYuZ2V0RGF0ZV0oKTtcclxuICAgICAgICAgICAgZHcgPSBkYXRlW3NlbGYuZ2V0RGF5XSgpO1xyXG4gICAgICAgICAgICBtID0gZGF0ZVtzZWxmLmdldE1vbnRoXSgpICsgMTtcclxuICAgICAgICAgICAgeSA9IGRhdGVbc2VsZi5nZXRGdWxsWWVhcl0oKTtcclxuXHJcbiAgICAgICAgICAgIC8vZm9ybWF0ID0gdHMgPj0gdGhpcy55ZXN0ZXJkYXkgXHJcbiAgICAgICAgICAgIC8vXHQ/IHRoaXMuZmFuY3lGb3JtYXQgXHJcbiAgICAgICAgICAgIC8vXHQ6IHRoaXMuZGF0ZUZvcm1hdDtcclxuICAgICAgICAgICAgZm9ybWF0ID0gdGhpcy5kYXRlRm9ybWF0O1xyXG5cclxuICAgICAgICAgICAgb3V0cHV0ID0gZm9ybWF0LnJlcGxhY2UoL1thLXpdL2dpLCBmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAodmFsKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZCA+IDkgPyBkIDogJzAnICsgZDtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2onOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnRCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuaTE4bihpMTguZGF5c1Nob3J0W2R3XSk7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdsJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5pMThuKGkxOC5kYXlzW2R3XSk7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbSA+IDkgPyBtIDogJzAnICsgbTtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ24nOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnTSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuaTE4bihpMTgubW9udGhzU2hvcnRbbSAtIDFdKTtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0YnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmkxOG4oaTE4Lm1vbnRoc1ttIC0gMV0pO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHk7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd5JzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCcnICsgeSkuc3Vic3RyKDIpO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnSCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGggPiA5ID8gaCA6ICcwJyArIGg7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdHJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaDtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2cnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBnO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnaCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGcgPiA5ID8gZyA6ICcwJyArIGc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdhJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaCA+IDEyID8gJ3BtJyA6ICdhbSc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdBJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaCA+IDEyID8gJ1BNJyA6ICdBTSc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdpJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSA+IDkgPyBpIDogJzAnICsgaTtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3MnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzID4gOSA/IHMgOiAnMCcgKyBzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvL3JldHVybiB0cyA+PSB0aGlzLnllc3RlcmRheVxyXG4gICAgICAgICAgICAvL1x0PyBvdXRwdXQucmVwbGFjZSgnJDEnLCB0aGlzLmkxOG4odHMgPj0gdGhpcy50b2RheSA/ICdUb2RheScgOiAnWWVzdGVyZGF5JykpXHJcbiAgICAgICAgICAgIC8vXHQ6IG91dHB1dDtcclxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmIChmaWxlLmRhdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbGUuZGF0ZS5yZXBsYWNlKC8oW2Etel0rKVxccy9pLCBmdW5jdGlvbihhMSwgYTIpIHsgcmV0dXJuIHNlbGYuaTE4bihhMikgKyAnICc7IH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHNlbGYuaTE4bignZGF0ZVVua25vd24nKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcblx0ICogUmV0dXJuIGNzcyBjbGFzcyBtYXJrcyBmaWxlIHBlcm1pc3Npb25zXHJcblx0ICogXHJcblx0ICogQHBhcmFtICBPYmplY3QgIGZpbGUgXHJcblx0ICogQHJldHVybiBTdHJpbmdcclxuXHQgKi9cclxuICAgIHBlcm1zMmNsYXNzOiBmdW5jdGlvbihvKSB7XHJcbiAgICAgICAgdmFyIGMgPSAnJztcclxuXHJcbiAgICAgICAgaWYgKCFvLnJlYWQgJiYgIW8ud3JpdGUpIHtcclxuICAgICAgICAgICAgYyA9ICdlbGZpbmRlci1uYSc7XHJcbiAgICAgICAgfSBlbHNlIGlmICghby5yZWFkKSB7XHJcbiAgICAgICAgICAgIGMgPSAnZWxmaW5kZXItd28nO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIW8ud3JpdGUpIHtcclxuICAgICAgICAgICAgYyA9ICdlbGZpbmRlci1ybyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBSZXR1cm4gbG9jYWxpemVkIHN0cmluZyB3aXRoIGZpbGUgcGVybWlzc2lvbnNcclxuXHQgKiBcclxuXHQgKiBAcGFyYW0gIE9iamVjdCAgZmlsZVxyXG5cdCAqIEByZXR1cm4gU3RyaW5nXHJcblx0ICovXHJcbiAgICBmb3JtYXRQZXJtaXNzaW9uczogZnVuY3Rpb24oZikge1xyXG4gICAgICAgIHZhciBwID0gW107XHJcblxyXG4gICAgICAgIGYucmVhZCAmJiBwLnB1c2godGhpcy5pMThuKCdyZWFkJykpO1xyXG4gICAgICAgIGYud3JpdGUgJiYgcC5wdXNoKHRoaXMuaTE4bignd3JpdGUnKSk7XHJcblxyXG4gICAgICAgIHJldHVybiBwLmxlbmd0aCA/IHAuam9pbignICcgKyB0aGlzLmkxOG4oJ2FuZCcpICsgJyAnKSA6IHRoaXMuaTE4bignbm9hY2Nlc3MnKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcblx0ICogUmV0dXJuIGZvcm1hdGVkIGZpbGUgc2l6ZVxyXG5cdCAqIFxyXG5cdCAqIEBwYXJhbSAgTnVtYmVyICBmaWxlIHNpemVcclxuXHQgKiBAcmV0dXJuIFN0cmluZ1xyXG5cdCAqL1xyXG4gICAgZm9ybWF0U2l6ZTogZnVuY3Rpb24ocykge1xyXG4gICAgICAgIHZhciBuID0gMSwgdSA9ICdieXRlJztcclxuXHJcbiAgICAgICAgaWYgKHMgPT0gJ3Vua25vd24nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmkxOG4oJ3Vua25vd24nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChzID4gMTA3Mzc0MTgyNCkge1xyXG4gICAgICAgICAgICBuID0gMTA3Mzc0MTgyNDtcclxuICAgICAgICAgICAgdSA9ICdHQic7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzID4gMTA0ODU3Nikge1xyXG4gICAgICAgICAgICBuID0gMTA0ODU3NjtcclxuICAgICAgICAgICAgdSA9ICdNQic7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzID4gMTAyNCkge1xyXG4gICAgICAgICAgICBuID0gMTAyNDtcclxuICAgICAgICAgICAgdSA9ICdLQic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHMgPSBzIC8gbjtcclxuICAgICAgICByZXR1cm4gKHMgPiAwID8gbiA+PSAxMDQ4NTc2ID8gcy50b0ZpeGVkKDIpIDogTWF0aC5yb3VuZChzKSA6IDApICsgJyAnICsgdTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIG5hdkhhc2gySWQ6IGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICByZXR1cm4gJ25hdi0nICsgaGFzaDtcclxuICAgIH0sXHJcblxyXG4gICAgbmF2SWQySGFzaDogZnVuY3Rpb24oaWQpIHtcclxuICAgICAgICByZXR1cm4gdHlwZW9mIChpZCkgPT0gJ3N0cmluZycgPyBpZC5zdWJzdHIoNCkgOiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgbG9nOiBmdW5jdGlvbihtKSB7XHJcbiAgICAgICAgd2luZG93LmNvbnNvbGUgJiYgd2luZG93LmNvbnNvbGUubG9nICYmIHdpbmRvdy5jb25zb2xlLmxvZyhtKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0sXHJcblxyXG4gICAgZGVidWc6IGZ1bmN0aW9uKHR5cGUsIG0pIHtcclxuICAgICAgICB2YXIgZCA9IHRoaXMub3B0aW9ucy5kZWJ1ZztcclxuXHJcbiAgICAgICAgaWYgKGQgPT0gJ2FsbCcgfHwgZCA9PT0gdHJ1ZSB8fCAoJC5pc0FycmF5KGQpICYmICQuaW5BcnJheSh0eXBlLCBkKSAhPSAtMSkpIHtcclxuICAgICAgICAgICAgd2luZG93LmNvbnNvbGUgJiYgd2luZG93LmNvbnNvbGUubG9nICYmIHdpbmRvdy5jb25zb2xlLmxvZygnZWxmaW5kZXIgZGVidWc6IFsnICsgdHlwZSArICddIFsnICsgdGhpcy5pZCArICddJywgbSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSxcclxuICAgIHRpbWU6IGZ1bmN0aW9uKGwpIHsgd2luZG93LmNvbnNvbGUgJiYgd2luZG93LmNvbnNvbGUudGltZSAmJiB3aW5kb3cuY29uc29sZS50aW1lKGwpOyB9LFxyXG4gICAgdGltZUVuZDogZnVuY3Rpb24obCkgeyB3aW5kb3cuY29uc29sZSAmJiB3aW5kb3cuY29uc29sZS50aW1lRW5kICYmIHdpbmRvdy5jb25zb2xlLnRpbWVFbmQobCk7IH1cclxuXHJcblxyXG59OyIsIi8qKlxuICogQXBwbGljYXRpb24gdmVyc2lvblxuICpcbiAqIEB0eXBlIFN0cmluZ1xuICoqL1xyXG5lbEZpbmRlci5wcm90b3R5cGUudmVyc2lvbiA9ICcyLjAuMic7IiwiJC5mbi5lbGZpbmRlciA9IGZ1bmN0aW9uKG8pIHtcclxuXHJcbiAgICBpZiAobyA9PSAnaW5zdGFuY2UnKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RWxGaW5kZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICB2YXIgY21kID0gdHlwZW9mKG8pID09ICdzdHJpbmcnID8gbyA6ICcnO1xyXG4gICAgICAgIGlmICghdGhpcy5lbGZpbmRlcikge1xyXG4gICAgICAgICAgICBuZXcgZWxGaW5kZXIodGhpcywgdHlwZW9mKG8pID09ICdvYmplY3QnID8gbyA6IHt9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHN3aXRjaCAoY21kKSB7XHJcbiAgICAgICAgY2FzZSAnY2xvc2UnOlxyXG4gICAgICAgIGNhc2UgJ2hpZGUnOlxyXG4gICAgICAgICAgICB0aGlzLmVsZmluZGVyLmhpZGUoKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJ29wZW4nOlxyXG4gICAgICAgIGNhc2UgJ3Nob3cnOlxyXG4gICAgICAgICAgICB0aGlzLmVsZmluZGVyLnNob3coKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UnZGVzdHJveSc6XHJcbiAgICAgICAgICAgIHRoaXMuZWxmaW5kZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgfSk7XHJcbn07XHJcbiQuZm4uZ2V0RWxGaW5kZXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBpbnN0YW5jZTtcclxuXHJcbiAgICB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZWxmaW5kZXIpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UgPSB0aGlzLmVsZmluZGVyO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGluc3RhbmNlO1xyXG59OyIsIlwidXNlIHN0cmljdFwiOyAvKipcbiAqIGVsRmluZGVyIHJlc291cmNlcyByZWdpc3RyeS5cbiAqIFN0b3JlIHNoYXJlZCBkYXRhXG4gKlxuICogQHR5cGUgT2JqZWN0XG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG5lbEZpbmRlci5wcm90b3R5cGUucmVzb3VyY2VzID0ge1xyXG4gICAgJ2NsYXNzJzoge1xyXG4gICAgICAgIGhvdmVyOiAndWktc3RhdGUtaG92ZXInLFxyXG4gICAgICAgIGFjdGl2ZTogJ3VpLXN0YXRlLWFjdGl2ZScsXHJcbiAgICAgICAgZGlzYWJsZWQ6ICd1aS1zdGF0ZS1kaXNhYmxlZCcsXHJcbiAgICAgICAgZHJhZ2dhYmxlOiAndWktZHJhZ2dhYmxlJyxcclxuICAgICAgICBkcm9wcGFibGU6ICd1aS1kcm9wcGFibGUnLFxyXG4gICAgICAgIGFkcm9wcGFibGU6ICdlbGZpbmRlci1kcm9wcGFibGUtYWN0aXZlJyxcclxuICAgICAgICBjd2RmaWxlOiAnZWxmaW5kZXItY3dkLWZpbGUnLFxyXG4gICAgICAgIGN3ZDogJ2VsZmluZGVyLWN3ZCcsXHJcbiAgICAgICAgdHJlZTogJ2VsZmluZGVyLXRyZWUnLFxyXG4gICAgICAgIHRyZWVyb290OiAnZWxmaW5kZXItbmF2YmFyLXJvb3QnLFxyXG4gICAgICAgIG5hdmRpcjogJ2VsZmluZGVyLW5hdmJhci1kaXInLFxyXG4gICAgICAgIG5hdmRpcndyYXA6ICdlbGZpbmRlci1uYXZiYXItZGlyLXdyYXBwZXInLFxyXG4gICAgICAgIG5hdmFycm93OiAnZWxmaW5kZXItbmF2YmFyLWFycm93JyxcclxuICAgICAgICBuYXZzdWJ0cmVlOiAnZWxmaW5kZXItbmF2YmFyLXN1YnRyZWUnLFxyXG4gICAgICAgIG5hdmNvbGxhcHNlOiAnZWxmaW5kZXItbmF2YmFyLWNvbGxhcHNlZCcsXHJcbiAgICAgICAgbmF2ZXhwYW5kOiAnZWxmaW5kZXItbmF2YmFyLWV4cGFuZGVkJyxcclxuICAgICAgICB0cmVlZGlyOiAnZWxmaW5kZXItdHJlZS1kaXInLFxyXG4gICAgICAgIHBsYWNlZGlyOiAnZWxmaW5kZXItcGxhY2UtZGlyJyxcclxuICAgICAgICBzZWFyY2hidG46ICdlbGZpbmRlci1idXR0b24tc2VhcmNoJ1xyXG4gICAgfSxcclxuICAgIHRwbDoge1xyXG4gICAgICAgIHBlcm1zOiAnPHNwYW4gY2xhc3M9XCJlbGZpbmRlci1wZXJtc1wiLz4nLFxyXG4gICAgICAgIHN5bWxpbms6ICc8c3BhbiBjbGFzcz1cImVsZmluZGVyLXN5bWxpbmtcIi8+JyxcclxuICAgICAgICBuYXZpY29uOiAnPHNwYW4gY2xhc3M9XCJlbGZpbmRlci1uYXYtaWNvblwiLz4nLFxyXG4gICAgICAgIG5hdnNwaW5uZXI6ICc8c3BhbiBjbGFzcz1cImVsZmluZGVyLW5hdmJhci1zcGlubmVyXCIvPicsXHJcbiAgICAgICAgbmF2ZGlyOiAnPGRpdiBjbGFzcz1cImVsZmluZGVyLW5hdmJhci13cmFwcGVyXCI+PHNwYW4gaWQ9XCJ7aWR9XCIgdGl0bGU9XCJ7bmFtZX1cIiBjbGFzcz1cInVpLWNvcm5lci1hbGwgZWxmaW5kZXItbmF2YmFyLWRpciB7Y3NzY2xhc3N9XCI+PHNwYW4gY2xhc3M9XCJlbGZpbmRlci1uYXZiYXItYXJyb3dcIi8+PHNwYW4gY2xhc3M9XCJlbGZpbmRlci1uYXZiYXItaWNvblwiLz57c3ltbGlua317cGVybWlzc2lvbnN9e25hbWV9PC9zcGFuPjxkaXYgY2xhc3M9XCJlbGZpbmRlci1uYXZiYXItc3VidHJlZVwiLz48L2Rpdj4nXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBtaW1lczoge1xyXG4gICAgICAgIHRleHQ6IFtcclxuICAgICAgICAgICAgJ2FwcGxpY2F0aW9uL3gtZW1wdHknLFxyXG4gICAgICAgICAgICAnYXBwbGljYXRpb24vamF2YXNjcmlwdCcsXHJcbiAgICAgICAgICAgICdhcHBsaWNhdGlvbi94aHRtbCt4bWwnLFxyXG4gICAgICAgICAgICAnYXVkaW8veC1tcDMtcGxheWxpc3QnLFxyXG4gICAgICAgICAgICAnYXBwbGljYXRpb24veC13ZWItY29uZmlnJyxcclxuICAgICAgICAgICAgJ2FwcGxpY2F0aW9uL2RvY2Jvb2sreG1sJyxcclxuICAgICAgICAgICAgJ2FwcGxpY2F0aW9uL3gtcGhwJyxcclxuICAgICAgICAgICAgJ2FwcGxpY2F0aW9uL3gtcGVybCcsXHJcbiAgICAgICAgICAgICdhcHBsaWNhdGlvbi94LWF3aycsXHJcbiAgICAgICAgICAgICdhcHBsaWNhdGlvbi94LWNvbmZpZycsXHJcbiAgICAgICAgICAgICdhcHBsaWNhdGlvbi94LWNzaCcsXHJcbiAgICAgICAgICAgICdhcHBsaWNhdGlvbi94bWwnXHJcbiAgICAgICAgXVxyXG4gICAgfSxcclxuXHJcbiAgICBtaXhpbjoge1xyXG4gICAgICAgIG1ha2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICAgICAgY21kID0gdGhpcy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgY3dkID0gZm0uZ2V0VUkoJ2N3ZCcpLFxyXG4gICAgICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN3ZC50cmlnZ2VyKCd1bnNlbGVjdGFsbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciAmJiBmbS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm0uZW5hYmxlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBpZCA9ICd0bXBfJyArIHBhcnNlSW50KE1hdGgucmFuZG9tKCkgKiAxMDAwMDApLFxyXG4gICAgICAgICAgICAgICAgcGhhc2ggPSBmbS5jd2QoKS5oYXNoLFxyXG4gICAgICAgICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICBmaWxlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc2g6IGlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGZtLnVuaXF1ZU5hbWUodGhpcy5wcmVmaXgpLFxyXG4gICAgICAgICAgICAgICAgICAgIG1pbWU6IHRoaXMubWltZSxcclxuICAgICAgICAgICAgICAgICAgICByZWFkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6ICdUb2RheSAnICsgZGF0ZS5nZXRIb3VycygpICsgJzonICsgZGF0ZS5nZXRNaW51dGVzKClcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBub2RlID0gY3dkLnRyaWdnZXIoJ2NyZWF0ZS4nICsgZm0ubmFtZXNwYWNlLCBmaWxlKS5maW5kKCcjJyArIGlkKSxcclxuICAgICAgICAgICAgICAgIGlucHV0ID0gJCgnPGlucHV0IHR5cGU9XCJ0ZXh0XCIvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmtleWRvd24oZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAkLnVpLmtleUNvZGUuRVNDQVBFKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAkLnVpLmtleUNvZGUuRU5URVIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmJsdXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLm1vdXNlZG93bihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuYmx1cihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSAkLnRyaW0oaW5wdXQudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gaW5wdXQucGFyZW50KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50Lmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgnZXJySW52TmFtZUNyJyArIChmaWxlLm1pbWUgPT0gXCJkaXJlY3RvcnlcIiA/ICdEaXInIDogJycpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lLm1hdGNoKFwiW1xcL3xcXFxcfFxcOnxcXCp8XFxcInxcXDx8XFw+fFxcI3xcXHxcXCRdXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCdlcnJJbnZTeW0nICsgKGZpbGUubWltZSA9PSBcImRpcmVjdG9yeVwiID8gJ0RpcicgOiAnJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUubGVuZ3RoID4gMTAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCdlcnJJbnZOYW1lU2l6ZScgKyAoZmlsZS5taW1lID09IFwiZGlyZWN0b3J5XCIgPyAnRGlyJyA6ICcnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZtLmZpbGVCeU5hbWUobmFtZSwgcGhhc2gpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KFsnZXJyRXhpc3RzJywgbmFtZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUubWltZSAhPSBcImRpcmVjdG9yeVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4dE5ldyA9IGZtLmdldEV4dGVuc2lvbihuYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXh0T2xkID0gZm0uZ2V0RXh0ZW5zaW9uKGZpbGUubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFleHROZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCdlcnJJbnZOYW1lQ3InKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWVXaXRvdXRleHQgPSBuYW1lLnNwbGl0KCcuJylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVXaXRvdXRleHQgPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoJ2Vyckludk5hbWVDcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuaHRtbChmbS5lc2NhcGUobmFtZSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZtLmxvY2tmaWxlcyh7IGZpbGVzOiBbaWRdIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogY21kLCBuYW1lOiBuYW1lLCB0YXJnZXQ6IHBoYXNoIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmeTogeyB0eXBlOiBjbWQsIGNudDogMSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RmFpbDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3luY09uRmFpbDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZnJkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCgpIHx8ICFub2RlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZtLmRpc2FibGUoKTtcclxuICAgICAgICAgICAgbm9kZS5maW5kKCcuZWxmaW5kZXItY3dkLWZpbGVuYW1lJykuZW1wdHkoJycpLmFwcGVuZChpbnB1dC52YWwoZmlsZS5uYW1lKSk7XHJcbiAgICAgICAgICAgIGlucHV0LnNlbGVjdCgpLmZvY3VzKCk7XHJcbiAgICAgICAgICAgIGlucHV0WzBdLnNldFNlbGVjdGlvblJhbmdlICYmIGlucHV0WzBdLnNldFNlbGVjdGlvblJhbmdlKDAsIGZpbGUubmFtZS5yZXBsYWNlKC9cXC4uKyQvLCAnJykubGVuZ3RoKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkO1xyXG5cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxufTsiLCIvKipcclxuICogRGVmYXVsdCBlbEZpbmRlciBjb25maWdcclxuICpcclxuICogQHR5cGUgIE9iamVjdFxyXG4gKiBAYXV0b3IgRG1pdHJ5IChkaW8pIExldmFzaG92XHJcbiAqL1xyXG5lbEZpbmRlci5wcm90b3R5cGUuX29wdGlvbnMgPSB7XHJcbiAgICAvKipcclxuXHQgKiBDb25uZWN0b3IgdXJsLiBSZXF1aXJlZCFcclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqL1xyXG4gICAgdXJsOiAnJyxcclxuXHJcbiAgICAvKipcclxuXHQgKiBBamF4IHJlcXVlc3QgdHlwZS5cclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqIEBkZWZhdWx0IFwiZ2V0XCJcclxuXHQgKi9cclxuICAgIHJlcXVlc3RUeXBlOiAnZ2V0JyxcclxuXHJcbiAgICAvKipcclxuXHQgKiBUcmFuc3BvcnQgdG8gc2VuZCByZXF1ZXN0IHRvIGJhY2tlbmQuXHJcblx0ICogUmVxdWlyZWQgZm9yIGZ1dHVyZSBleHRlbnNpb25zIHVzaW5nIHdlYnNvY2tldHMvd2ViZGF2IGV0Yy5cclxuXHQgKiBNdXN0IGJlIGFuIG9iamVjdCB3aXRoIFwic2VuZFwiIG1ldGhvZC5cclxuXHQgKiB0cmFuc3BvcnQuc2VuZCBtdXN0IHJldHVybiAkLkRlZmVycmVkKCkgb2JqZWN0XHJcblx0ICpcclxuXHQgKiBAdHlwZSBPYmplY3RcclxuXHQgKiBAZGVmYXVsdCBudWxsXHJcblx0ICogQGV4YW1wbGVcclxuXHQgKiAgdHJhbnNwb3J0IDoge1xyXG5cdCAqICAgIGluaXQgOiBmdW5jdGlvbihlbGZpbmRlckluc3RhbmNlKSB7IH0sXHJcblx0ICogICAgc2VuZCA6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuXHQgKiAgICAgIHZhciBkZnJkID0gJC5EZWZlcnJlZCgpO1xyXG5cdCAqICAgICAgLy8gY29ubmVjdCB0byBiYWNrZW5kIC4uLlxyXG5cdCAqICAgICAgcmV0dXJuIGRmcmQ7XHJcblx0ICogICAgfSxcclxuXHQgKiAgICB1cGxvYWQgOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0ICogICAgICB2YXIgZGZyZCA9ICQuRGVmZXJyZWQoKTtcclxuXHQgKiAgICAgIC8vIHVwbG9hZCAuLi5cclxuXHQgKiAgICAgIHJldHVybiBkZnJkO1xyXG5cdCAqICAgIH1cclxuXHQgKiAgICBcclxuXHQgKiAgfVxyXG5cdCAqKi9cclxuICAgIHRyYW5zcG9ydDoge30sXHJcblxyXG4gICAgLyoqXHJcblx0ICogVVJMIHRvIHVwbG9hZCBmaWxlIHRvLlxyXG5cdCAqIElmIG5vdCBzZXQgLSBjb25uZWN0b3IgVVJMIHdpbGwgYmUgdXNlZFxyXG5cdCAqXHJcblx0ICogQHR5cGUgU3RyaW5nXHJcblx0ICogQGRlZmF1bHQgICcnXHJcblx0ICovXHJcbiAgICB1cmxVcGxvYWQ6ICcnLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIEFsbG93IHRvIGRyYWcgYW5kIGRyb3AgdG8gdXBsb2FkIGZpbGVzXHJcblx0ICpcclxuXHQgKiBAdHlwZSBCb29sZWFufFN0cmluZ1xyXG5cdCAqIEBkZWZhdWx0ICAnYXV0bydcclxuXHQgKi9cclxuICAgIGRyYWdVcGxvYWRBbGxvdzogJ2F1dG8nLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIFRpbWVvdXQgZm9yIHVwbG9hZCB1c2luZyBpZnJhbWVcclxuXHQgKlxyXG5cdCAqIEB0eXBlIE51bWJlclxyXG5cdCAqIEBkZWZhdWx0ICAwIC0gbm8gdGltZW91dFxyXG5cdCAqL1xyXG4gICAgaWZyYW1lVGltZW91dDogMCxcclxuXHJcbiAgICAvKipcclxuXHQgKiBEYXRhIHRvIGFwcGVuZCB0byBhbGwgcmVxdWVzdHMgYW5kIHRvIHVwbG9hZCBmaWxlc1xyXG5cdCAqXHJcblx0ICogQHR5cGUgT2JqZWN0XHJcblx0ICogQGRlZmF1bHQgIHt9XHJcblx0ICovXHJcbiAgICBjdXN0b21EYXRhOiB7fSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBFdmVudCBsaXN0ZW5lcnMgdG8gYmluZCBvbiBlbEZpbmRlciBpbml0XHJcblx0ICpcclxuXHQgKiBAdHlwZSBPYmplY3RcclxuXHQgKiBAZGVmYXVsdCAge31cclxuXHQgKi9cclxuICAgIGhhbmRsZXJzOiB7fSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBJbnRlcmZhY2UgbGFuZ3VhZ2VcclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqIEBkZWZhdWx0IFwiZW5cIlxyXG5cdCAqL1xyXG4gICAgbGFuZzogJ2VuJyxcclxuXHJcbiAgICAvKipcclxuXHQgKiBBZGRpdGlvbmFsIGNzcyBjbGFzcyBmb3IgZmlsZW1hbmFnZXIgbm9kZS5cclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqL1xyXG4gICAgY3NzQ2xhc3M6ICcnLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIEFjdGl2ZSBjb21tYW5kcyBsaXN0XHJcblx0ICogSWYgc29tZSByZXF1aXJlZCBjb21tYW5kcyB3aWxsIGJlIG1pc3NlZCBoZXJlLCBlbEZpbmRlciB3aWxsIGFkZCBpdHNcclxuXHQgKlxyXG5cdCAqIEB0eXBlIEFycmF5XHJcblx0ICovXHJcbiAgICBjb21tYW5kczogW1xyXG4gICAgICAgICdvcGVuJywgJ3JlbG9hZCcsICdob21lJywgJ3VwJywgJ2JhY2snLCAnZm9yd2FyZCcsICdnZXRmaWxlJywgJ3F1aWNrbG9vaycsXHJcbiAgICAgICAgJ2Rvd25sb2FkJywgJ3JtJywgJ2R1cGxpY2F0ZScsICdyZW5hbWUnLCAnbWtkaXInLCAnbWtmaWxlJywgJ3VwbG9hZCcsICdjb3B5JyxcclxuICAgICAgICAnY3V0JywgJ3Bhc3RlJywgJ2VkaXQnLCAnZXh0cmFjdCcsICdhcmNoaXZlJywgJ3NlYXJjaCcsICdpbmZvJywgJ3ZpZXcnLCAnaGVscCcsICdyZXNpemUnLCAnc29ydCcsICduZXRtb3VudCdcclxuICAgIF0sXHJcblxyXG4gICAgLyoqXHJcblx0ICogQ29tbWFuZHMgb3B0aW9ucy5cclxuXHQgKlxyXG5cdCAqIEB0eXBlIE9iamVjdFxyXG5cdCAqKi9cclxuICAgIGNvbW1hbmRzT3B0aW9uczoge1xyXG4gICAgICAgIC8vIFwiZ2V0ZmlsZVwiIGNvbW1hbmQgb3B0aW9ucy5cclxuICAgICAgICBnZXRmaWxlOiB7XHJcbiAgICAgICAgICAgIG9ubHlVUkw6IGZhbHNlLFxyXG4gICAgICAgICAgICAvLyBhbGxvdyB0byByZXR1cm4gbXVsdGlwbGUgZmlsZXMgaW5mb1xyXG4gICAgICAgICAgICBtdWx0aXBsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIC8vIGFsbG93IHRvIHJldHVybiBmaWxlcnMgaW5mb1xyXG4gICAgICAgICAgICBmb2xkZXJzOiBmYWxzZSxcclxuICAgICAgICAgICAgLy8gYWN0aW9uIGFmdGVyIGNhbGxiYWNrIChcIlwiL1wiY2xvc2VcIi9cImRlc3Ryb3lcIilcclxuICAgICAgICAgICAgb25jb21wbGV0ZTogJydcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIFwidXBsb2FkXCIgY29tbWFuZCBvcHRpb25zLlxyXG4gICAgICAgIHVwbG9hZDoge1xyXG4gICAgICAgICAgICB1aTogJ3VwbG9hZGJ1dHRvbidcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIFwicXVpY2tsb29rXCIgY29tbWFuZCBvcHRpb25zLlxyXG4gICAgICAgIHF1aWNrbG9vazoge1xyXG4gICAgICAgICAgICBhdXRvcGxheTogdHJ1ZSxcclxuICAgICAgICAgICAganBsYXllcjogJ2V4dGVuc2lvbnMvanBsYXllcidcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIFwicXVpY2tsb29rXCIgY29tbWFuZCBvcHRpb25zLlxyXG4gICAgICAgIGVkaXQ6IHtcclxuICAgICAgICAgICAgLy8gbGlzdCBvZiBhbGxvd2VkIG1pbWV0eXBlcyB0byBlZGl0XHJcbiAgICAgICAgICAgIC8vIGlmIGVtcHR5IC0gYW55IHRleHQgZmlsZXMgY2FuIGJlIGVkaXRlZFxyXG4gICAgICAgICAgICBtaW1lczogW10sXHJcbiAgICAgICAgICAgIC8vIGVkaXQgZmlsZXMgaW4gd3lzaXN5ZydzXHJcbiAgICAgICAgICAgIGVkaXRvcnM6IFtcclxuICAgICAgICAgICAgICAgIC8vIHtcclxuICAgICAgICAgICAgICAgIC8vIFx0LyoqXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqIGZpbGVzIG1pbWV0eXBlcyBhbGxvd2VkIHRvIGVkaXQgaW4gY3VycmVudCB3eXNpc3lnXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqIEB0eXBlICBBcnJheVxyXG4gICAgICAgICAgICAgICAgLy8gXHQgKi9cclxuICAgICAgICAgICAgICAgIC8vIFx0bWltZXMgOiBbJ3RleHQvaHRtbCddLCBcclxuICAgICAgICAgICAgICAgIC8vIFx0LyoqXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqIENhbGxlZCB3aGVuIFwiZWRpdFwiIGRpYWxvZyBsb2FkZWQuXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqIFBsYWNlIHRvIGluaXQgd3lzaXN5Zy5cclxuICAgICAgICAgICAgICAgIC8vIFx0ICogQ2FuIHJldHVybiB3eXNpc3lnIGluc3RhbmNlXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqIEBwYXJhbSAgRE9NRWxlbWVudCAgdGV4dGFyZWEgbm9kZVxyXG4gICAgICAgICAgICAgICAgLy8gXHQgKiBAcmV0dXJuIE9iamVjdFxyXG4gICAgICAgICAgICAgICAgLy8gXHQgKi9cclxuICAgICAgICAgICAgICAgIC8vIFx0bG9hZCA6IGZ1bmN0aW9uKHRleHRhcmVhKSB7IH0sXHJcbiAgICAgICAgICAgICAgICAvLyBcdC8qKlxyXG4gICAgICAgICAgICAgICAgLy8gXHQgKiBDYWxsZWQgYmVmb3JlIFwiZWRpdFwiIGRpYWxvZyBjbG9zZWQuXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqIFBsYWNlIHRvIGRlc3Ryb3kgd3lzaXN5ZyBpbnN0YW5jZS5cclxuICAgICAgICAgICAgICAgIC8vIFx0ICpcclxuICAgICAgICAgICAgICAgIC8vIFx0ICogQHBhcmFtICBET01FbGVtZW50ICB0ZXh0YXJlYSBub2RlXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqIEBwYXJhbSAgT2JqZWN0ICAgICAgd3lzaXN5ZyBpbnN0YW5jZSAoaWYgd2FzIHJldHVybmVkIGJ5IFwibG9hZFwiIGNhbGxiYWNrKVxyXG4gICAgICAgICAgICAgICAgLy8gXHQgKiBAcmV0dXJuIHZvaWRcclxuICAgICAgICAgICAgICAgIC8vIFx0ICovXHJcbiAgICAgICAgICAgICAgICAvLyBcdGNsb3NlIDogZnVuY3Rpb24odGV4dGFyZWEsIGluc3RhbmNlKSB7IH0sXHJcbiAgICAgICAgICAgICAgICAvLyBcdC8qKlxyXG4gICAgICAgICAgICAgICAgLy8gXHQgKiBDYWxsZWQgYmVmb3JlIGZpbGUgY29udGVudCBzZW5kIHRvIGJhY2tlbmQuXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqIFBsYWNlIHRvIHVwZGF0ZSB0ZXh0YXJlYSBjb250ZW50IGlmIG5lZWRlZC5cclxuICAgICAgICAgICAgICAgIC8vIFx0ICpcclxuICAgICAgICAgICAgICAgIC8vIFx0ICogQHBhcmFtICBET01FbGVtZW50ICB0ZXh0YXJlYSBub2RlXHJcbiAgICAgICAgICAgICAgICAvLyBcdCAqIEBwYXJhbSAgT2JqZWN0ICAgICAgd3lzaXN5ZyBpbnN0YW5jZSAoaWYgd2FzIHJldHVybmVkIGJ5IFwibG9hZFwiIGNhbGxiYWNrKVxyXG4gICAgICAgICAgICAgICAgLy8gXHQgKiBAcmV0dXJuIHZvaWRcclxuICAgICAgICAgICAgICAgIC8vIFx0ICovXHJcbiAgICAgICAgICAgICAgICAvLyBcdHNhdmUgOiBmdW5jdGlvbih0ZXh0YXJlYSwgZWRpdG9yKSB7fVxyXG4gICAgICAgICAgICAgICAgLy8gXHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIFwiaW5mb1wiIGNvbW1hbmQgb3B0aW9ucy5cclxuICAgICAgICBpbmZvOiB7IG51bGxVcmxEaXJMaW5rU2VsZjogdHJ1ZSB9LFxyXG5cclxuXHJcbiAgICAgICAgaGVscDogeyB2aWV3OiBbJ2Fib3V0JywgJ3Nob3J0Y3V0cycsICdoZWxwJ10gfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBDYWxsYmFjayBmb3IgXCJnZXRmaWxlXCIgY29tbWFuZHMuXHJcblx0ICogUmVxdWlyZWQgdG8gdXNlIGVsRmluZGVyIHdpdGggV1lTSVdZRyBlZGl0b3JzIGV0Yy4uXHJcblx0ICpcclxuXHQgKiBAdHlwZSBGdW5jdGlvblxyXG5cdCAqIEBkZWZhdWx0IG51bGwgKGNvbW1hbmQgbm90IGFjdGl2ZSlcclxuXHQgKi9cclxuICAgIGdldEZpbGVDYWxsYmFjazogbnVsbCxcclxuXHJcbiAgICAvKipcclxuXHQgKiBEZWZhdWx0IGRpcmVjdG9yeSB2aWV3LiBpY29ucy9saXN0XHJcblx0ICpcclxuXHQgKiBAdHlwZSBTdHJpbmdcclxuXHQgKiBAZGVmYXVsdCBcImljb25zXCJcclxuXHQgKi9cclxuICAgIGRlZmF1bHRWaWV3OiAnaWNvbnMnLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIFVJIHBsdWdpbnMgdG8gbG9hZC5cclxuXHQgKiBDdXJyZW50IGRpciB1aSBhbmQgZGlhbG9ncyBsb2FkcyBhbHdheXMuXHJcblx0ICogSGVyZSBzZXQgbm90IHJlcXVpcmVkIHBsdWdpbnMgYXMgZm9sZGVycyB0cmVlL3Rvb2xiYXIvc3RhdHVzYmFyIGV0Yy5cclxuXHQgKlxyXG5cdCAqIEB0eXBlIEFycmF5XHJcblx0ICogQGRlZmF1bHQgWyd0b29sYmFyJywgJ3RyZWUnLCAncGF0aCcsICdzdGF0J11cclxuXHQgKiBAZnVsbCBbJ3Rvb2xiYXInLCAncGxhY2VzJywgJ3RyZWUnLCAncGF0aCcsICdzdGF0J11cclxuXHQgKi9cclxuICAgIHVpOiBbJ3Rvb2xiYXInLCAndHJlZScsICdwYXRoJywgJ3N0YXQnXSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBTb21lIFVJIHBsdWdpbnMgb3B0aW9ucy5cclxuXHQgKiBAdHlwZSBPYmplY3RcclxuXHQgKi9cclxuICAgIHVpT3B0aW9uczoge1xyXG4gICAgICAgIC8vIHRvb2xiYXIgY29uZmlndXJhdGlvblxyXG4gICAgICAgIHRvb2xiYXI6IFtcclxuICAgICAgICAgICAgWydiYWNrJywgJ2ZvcndhcmQnXSxcclxuICAgICAgICAgICAgWyduZXRtb3VudCddLFxyXG4gICAgICAgICAgICAvLyBbJ3JlbG9hZCddLFxyXG4gICAgICAgICAgICAvLyBbJ2hvbWUnLCAndXAnXSxcclxuICAgICAgICAgICAgWydta2RpcicsICdta2ZpbGUnLCAndXBsb2FkJ10sXHJcbiAgICAgICAgICAgIFsnb3BlbicsICdkb3dubG9hZCcsICdnZXRmaWxlJ10sXHJcbiAgICAgICAgICAgIFsnaW5mbyddLFxyXG4gICAgICAgICAgICBbJ3F1aWNrbG9vayddLFxyXG4gICAgICAgICAgICBbJ2NvcHknLCAnY3V0JywgJ3Bhc3RlJ10sXHJcbiAgICAgICAgICAgIFsncm0nXSxcclxuICAgICAgICAgICAgWydkdXBsaWNhdGUnLCAncmVuYW1lJywgJ2VkaXQnLCAncmVzaXplJ10sXHJcbiAgICAgICAgICAgIFsnZXh0cmFjdCcsICdhcmNoaXZlJ10sXHJcbiAgICAgICAgICAgIFsnc2VhcmNoJ10sXHJcbiAgICAgICAgICAgIFsndmlldycsICdzb3J0J10sXHJcbiAgICAgICAgICAgIFsnaGVscCddXHJcbiAgICAgICAgXSxcclxuICAgICAgICAvLyBkaXJlY3RvcmllcyB0cmVlIG9wdGlvbnNcclxuICAgICAgICB0cmVlOiB7XHJcbiAgICAgICAgICAgIC8vIGV4cGFuZCBjdXJyZW50IHJvb3Qgb24gaW5pdFxyXG4gICAgICAgICAgICBvcGVuUm9vdE9uTG9hZDogdHJ1ZSxcclxuICAgICAgICAgICAgLy8gYXV0byBsb2FkIGN1cnJlbnQgZGlyIHBhcmVudHNcclxuICAgICAgICAgICAgc3luY1RyZWU6IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIG5hdmJhciBvcHRpb25zXHJcbiAgICAgICAgbmF2YmFyOiB7XHJcbiAgICAgICAgICAgIG1pbldpZHRoOiAxNTAsXHJcbiAgICAgICAgICAgIG1heFdpZHRoOiA1MDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGN3ZDoge1xyXG4gICAgICAgICAgICAvLyBkaXNwbGF5IHBhcmVudCBmb2xkZXIgd2l0aCBcIi4uXCIgbmFtZSA6KVxyXG4gICAgICAgICAgICBvbGRTY2hvb2w6IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBEaXNwbGF5IG9ubHkgcmVxdWlyZWQgZmlsZXMgYnkgdHlwZXNcclxuXHQgKlxyXG5cdCAqIEB0eXBlIEFycmF5XHJcblx0ICogQGRlZmF1bHQgW11cclxuXHQgKiBAZXhhbXBsZVxyXG5cdCAqICBvbmx5TWltZXMgOiBbXCJpbWFnZVwiXSAtIGRpc3BsYXkgYWxsIGltYWdlc1xyXG5cdCAqICBvbmx5TWltZXMgOiBbXCJpbWFnZS9wbmdcIiwgXCJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaFwiXSAtIGRpc3BsYXkgcG5nIGFuZCBmbGFzaFxyXG5cdCAqL1xyXG4gICAgb25seU1pbWVzOiBbXSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBDdXN0b20gZmlsZXMgc29ydCBydWxlcy5cclxuXHQgKiBBbGwgZGVmYXVsdCBydWxlcyAobmFtZS9zaXplL2tpbmQvZGF0ZSkgc2V0IGluIGVsRmluZGVyLl9zb3J0UnVsZXNcclxuXHQgKlxyXG5cdCAqIEB0eXBlIHtPYmplY3R9XHJcblx0ICogQGV4YW1wbGVcclxuXHQgKiBzb3J0UnVsZXMgOiB7XHJcblx0ICogICBuYW1lIDogZnVuY3Rpb24oZmlsZTEsIGZpbGUyKSB7IHJldHVybiBmaWxlMS5uYW1lLnRvTG93ZXJDYXNlKCkubG9jYWxlQ29tcGFyZShmaWxlMi5uYW1lLnRvTG93ZXJDYXNlKCkpOyB9XHJcblx0ICogfVxyXG5cdCAqL1xyXG4gICAgc29ydFJ1bGVzOiB7fSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBEZWZhdWx0IHNvcnQgdHlwZS5cclxuXHQgKlxyXG5cdCAqIEB0eXBlIHtTdHJpbmd9XHJcblx0ICovXHJcbiAgICBzb3J0VHlwZTogJ25hbWUnLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIERlZmF1bHQgc29ydCBvcmRlci5cclxuXHQgKlxyXG5cdCAqIEB0eXBlIHtTdHJpbmd9XHJcblx0ICogQGRlZmF1bHQgXCJhc2NcIlxyXG5cdCAqL1xyXG4gICAgc29ydE9yZGVyOiAnYXNjJyxcclxuXHJcbiAgICAvKipcclxuXHQgKiBEaXNwbGF5IGZvbGRlcnMgZmlyc3Q/XHJcblx0ICpcclxuXHQgKiBAdHlwZSB7Qm9vbGVhbn1cclxuXHQgKiBAZGVmYXVsdCB0cnVlXHJcblx0ICovXHJcbiAgICBzb3J0U3RpY2tGb2xkZXJzOiB0cnVlLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIElmIHRydWUgLSBlbEZpbmRlciB3aWxsIGZvcm1hdGluZyBkYXRlcyBpdHNlbGYsIFxyXG5cdCAqIG90aGVyd2lzZSAtIGJhY2tlbmQgZGF0ZSB3aWxsIGJlIHVzZWQuXHJcblx0ICpcclxuXHQgKiBAdHlwZSBCb29sZWFuXHJcblx0ICovXHJcbiAgICBjbGllbnRGb3JtYXREYXRlOiB0cnVlLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIFNob3cgVVRDIGRhdGVzLlxyXG5cdCAqIFJlcXVpcmVkIHNldCBjbGllbnRGb3JtYXREYXRlIHRvIHRydWVcclxuXHQgKlxyXG5cdCAqIEB0eXBlIEJvb2xlYW5cclxuXHQgKi9cclxuICAgIFVUQ0RhdGU6IGZhbHNlLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIEZpbGUgbW9kaWZpY2F0aW9uIGRhdGV0aW1lIGZvcm1hdC5cclxuXHQgKiBWYWx1ZSBmcm9tIHNlbGVjdGVkIGxhbmd1YWdlIGRhdGEgIGlzIHVzZWQgYnkgZGVmYXVsdC5cclxuXHQgKiBTZXQgZm9ybWF0IGhlcmUgdG8gb3ZlcndyaXRlIGl0LlxyXG5cdCAqXHJcblx0ICogQHR5cGUgU3RyaW5nXHJcblx0ICogQGRlZmF1bHQgIFwiXCJcclxuXHQgKi9cclxuICAgIGRhdGVGb3JtYXQ6ICcnLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIEZpbGUgbW9kaWZpY2F0aW9uIGRhdGV0aW1lIGZvcm1hdCBpbiBmb3JtIFwiWWVzdGVyZGF5IDEyOjIzOjAxXCIuXHJcblx0ICogVmFsdWUgZnJvbSBzZWxlY3RlZCBsYW5ndWFnZSBkYXRhIGlzIHVzZWQgYnkgZGVmYXVsdC5cclxuXHQgKiBTZXQgZm9ybWF0IGhlcmUgdG8gb3ZlcndyaXRlIGl0LlxyXG5cdCAqIFVzZSAkMSBmb3IgXCJUb2RheVwiL1wiWWVzdGVyZGF5XCIgcGxhY2Vob2xkZXJcclxuXHQgKlxyXG5cdCAqIEB0eXBlIFN0cmluZ1xyXG5cdCAqIEBkZWZhdWx0ICBcIlwiXHJcblx0ICogQGV4YW1wbGUgXCIkMSBIOm06aVwiXHJcblx0ICovXHJcbiAgICBmYW5jeURhdGVGb3JtYXQ6ICcnLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIGVsRmluZGVyIHdpZHRoXHJcblx0ICpcclxuXHQgKiBAdHlwZSBTdHJpbmd8TnVtYmVyXHJcblx0ICogQGRlZmF1bHQgIFwiYXV0b1wiXHJcblx0ICovXHJcbiAgICB3aWR0aDogJ2F1dG8nLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIGVsRmluZGVyIGhlaWdodFxyXG5cdCAqXHJcblx0ICogQHR5cGUgTnVtYmVyXHJcblx0ICogQGRlZmF1bHQgIFwiYXV0b1wiXHJcblx0ICovXHJcbiAgICBoZWlnaHQ6IDQwMCxcclxuXHJcbiAgICAvKipcclxuXHQgKiBNYWtlIGVsRmluZGVyIHJlc2l6YWJsZSBpZiBqcXVlcnkgdWkgcmVzaXphYmxlIGF2YWlsYWJsZVxyXG5cdCAqXHJcblx0ICogQHR5cGUgQm9vbGVhblxyXG5cdCAqIEBkZWZhdWx0ICB0cnVlXHJcblx0ICovXHJcbiAgICByZXNpemFibGU6IHRydWUsXHJcblxyXG4gICAgLyoqXHJcblx0ICogVGltZW91dCBiZWZvcmUgb3BlbiBub3RpZmljYXRpb25zIGRpYWxvZ3NcclxuXHQgKlxyXG5cdCAqIEB0eXBlIE51bWJlclxyXG5cdCAqIEBkZWZhdWx0ICA1MDAgKC41IHNlYylcclxuXHQgKi9cclxuICAgIG5vdGlmeURlbGF5OiA1MDAsXHJcblxyXG4gICAgLyoqXHJcblx0ICogQWxsb3cgc2hvcnRjdXRzXHJcblx0ICpcclxuXHQgKiBAdHlwZSBCb29sZWFuXHJcblx0ICogQGRlZmF1bHQgIHRydWVcclxuXHQgKi9cclxuICAgIGFsbG93U2hvcnRjdXRzOiB0cnVlLFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIFJlbWViZXIgbGFzdCBvcGVuZWQgZGlyIHRvIG9wZW4gaXQgYWZ0ZXIgcmVsb2FkIG9yIGluIG5leHQgc2Vzc2lvblxyXG5cdCAqXHJcblx0ICogQHR5cGUgQm9vbGVhblxyXG5cdCAqIEBkZWZhdWx0ICB0cnVlXHJcblx0ICovXHJcbiAgICByZW1lbWJlckxhc3REaXI6IHRydWUsXHJcblxyXG4gICAgLyoqXHJcblx0ICogVXNlIGJyb3dzZXIgbmF0aXZlIGhpc3Rvcnkgd2l0aCBzdXBwb3J0ZWQgYnJvd3NlcnNcclxuXHQgKlxyXG5cdCAqIEB0eXBlIEJvb2xlYW5cclxuXHQgKiBAZGVmYXVsdCAgdHJ1ZVxyXG5cdCAqL1xyXG4gICAgdXNlQnJvd3Nlckhpc3Rvcnk6IHRydWUsXHJcblxyXG4gICAgLyoqXHJcblx0ICogTGF6eSBsb2FkIGNvbmZpZy5cclxuXHQgKiBIb3cgbWFueSBmaWxlcyBkaXNwbGF5IGF0IG9uY2U/XHJcblx0ICpcclxuXHQgKiBAdHlwZSBOdW1iZXJcclxuXHQgKiBAZGVmYXVsdCAgNTBcclxuXHQgKi9cclxuICAgIHNob3dGaWxlczogMzAsXHJcblxyXG4gICAgLyoqXHJcblx0ICogTGF6eSBsb2FkIGNvbmZpZy5cclxuXHQgKiBEaXN0YW5jZSBpbiBweCB0byBjd2QgYm90dG9tIGVkZ2UgdG8gc3RhcnQgZGlzcGxheSBmaWxlc1xyXG5cdCAqXHJcblx0ICogQHR5cGUgTnVtYmVyXHJcblx0ICogQGRlZmF1bHQgIDUwXHJcblx0ICovXHJcbiAgICBzaG93VGhyZXNob2xkOiA1MCxcclxuXHJcbiAgICAvKipcclxuXHQgKiBBZGRpdGlvbmFsIHJ1bGUgdG8gdmFsaWQgbmV3IGZpbGUgbmFtZS5cclxuXHQgKiBCeSBkZWZhdWx0IG5vdCBhbGxvd2VkIGVtcHR5IG5hbWVzIG9yICcuLidcclxuXHQgKlxyXG5cdCAqIEB0eXBlIGZhbHNlfFJlZ0V4cHxmdW5jdGlvblxyXG5cdCAqIEBkZWZhdWx0ICBmYWxzZVxyXG5cdCAqIEBleGFtcGxlXHJcblx0ICogIGRpc2FibGUgbmFtZXMgd2l0aCBzcGFjZXM6XHJcblx0ICogIHZhbGlkTmFtZSA6IC9eW15cXHNdJC9cclxuXHQgKi9cclxuICAgIHZhbGlkTmFtZTogZmFsc2UsXHJcblxyXG4gICAgLyoqXHJcblx0ICogU3luYyBjb250ZW50IGludGVydmFsXHJcblx0ICogQHR5cGUgTnVtYmVyXHJcblx0ICogQGRlZmF1bHQgIDAgKGRvIG5vdCBzeW5jKVxyXG5cdCAqL1xyXG4gICAgc3luYzogMCxcclxuXHJcbiAgICAvKipcclxuXHQgKiBIb3cgbWFueSB0aHVtYm5haWxzIGNyZWF0ZSBpbiBvbmUgcmVxdWVzdFxyXG5cdCAqXHJcblx0ICogQHR5cGUgTnVtYmVyXHJcblx0ICogQGRlZmF1bHQgIDVcclxuXHQgKi9cclxuICAgIGxvYWRUbWJzOiA1LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIENvb2tpZSBvcHRpb24gZm9yIGJyb3dzZXJzZG9lcyBub3Qgc3VwcG90IGxvY2FsU3RvcmFnZVxyXG5cdCAqXHJcblx0ICogQHR5cGUgT2JqZWN0XHJcblx0ICovXHJcbiAgICBjb29raWU6IHtcclxuICAgICAgICBleHBpcmVzOiAzMCxcclxuICAgICAgICBkb21haW46ICcnLFxyXG4gICAgICAgIHBhdGg6ICcvJyxcclxuICAgICAgICBzZWN1cmU6IGZhbHNlXHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG5cdCAqIENvbnRleHRtZW51IGNvbmZpZ1xyXG5cdCAqXHJcblx0ICogQHR5cGUgT2JqZWN0XHJcblx0ICovXHJcbiAgICBjb250ZXh0bWVudToge1xyXG4gICAgICAgIC8vIG5hdmJhcmZvbGRlciBtZW51XHJcbiAgICAgICAgbmF2YmFyOiBbJ29wZW4nLCAnfCcsICdjb3B5JywgJ2N1dCcsICdwYXN0ZScsICdkdXBsaWNhdGUnLCAnfCcsICdybScsICd8JywgJ2luZm8nXSxcclxuICAgICAgICAvLyBjdXJyZW50IGRpcmVjdG9yeSBtZW51XHJcbiAgICAgICAgY3dkOiBbJ3JlbG9hZCcsICdiYWNrJywgJ3wnLCAndXBsb2FkJywgJ21rZGlyJywgJ21rZmlsZScsICdwYXN0ZScsICd8JywgJ3NvcnQnLCAnfCcsICdpbmZvJ10sXHJcbiAgICAgICAgLy8gY3VycmVudCBkaXJlY3RvcnkgZmlsZSBtZW51XHJcbiAgICAgICAgZmlsZXM6IFsnZ2V0ZmlsZScsICd8JywgJ29wZW4nLCAncXVpY2tsb29rJywgJ3wnLCAnZG93bmxvYWQnLCAnfCcsICdjb3B5JywgJ2N1dCcsICdwYXN0ZScsICdkdXBsaWNhdGUnLCAnfCcsICdybScsICd8JywgJ2VkaXQnLCAncmVuYW1lJywgJ3Jlc2l6ZScsICd8JywgJ2FyY2hpdmUnLCAnZXh0cmFjdCcsICd8JywgJ2luZm8nXVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuXHQgKiBEZWJ1ZyBjb25maWdcclxuXHQgKlxyXG5cdCAqIEB0eXBlIEFycmF5fEJvb2xlYW5cclxuXHQgKi9cclxuICAgIC8vIGRlYnVnIDogdHJ1ZVxyXG4gICAgZGVidWc6IFsnZXJyb3InLCAnd2FybmluZycsICdldmVudC1kZXN0cm95J11cclxufSIsIi8qKlxuICogQGNsYXNzIGVsRmluZGVyLmhpc3RvcnlcbiAqIFN0b3JlIHZpc2l0ZWQgZm9sZGVyc1xuICogYW5kIHByb3ZpZGUgXCJiYWNrXCIgYW5kIFwiZm9yd2FyZFwiIG1ldGhvZHNcbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5oaXN0b3J5ID0gZnVuY3Rpb24oZm0pIHtcclxuICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICAvKipcblx0XHQgKiBVcGRhdGUgaGlzdG9yeSBvbiBcIm9wZW5cIiBldmVudD9cblx0XHQgKlxuXHRcdCAqIEB0eXBlIEJvb2xlYW5cblx0XHQgKi9cclxuICAgICAgICB1cGRhdGUgPSB0cnVlLFxyXG4gICAgICAgIC8qKlxuXHRcdCAqIERpcmVjdG9yaWVzIGhhc2hlcyBzdG9yYWdlXG5cdFx0ICpcblx0XHQgKiBAdHlwZSBBcnJheVxuXHRcdCAqL1xyXG4gICAgICAgIGhpc3RvcnkgPSBbXSxcclxuICAgICAgICAvKipcblx0XHQgKiBDdXJyZW50IGRpcmVjdG9yeSBpbmRleCBpbiBoaXN0b3J5XG5cdFx0ICpcblx0XHQgKiBAdHlwZSBOdW1iZXJcblx0XHQgKi9cclxuICAgICAgICBjdXJyZW50LFxyXG4gICAgICAgIC8qKlxuXHRcdCAqIENsZWFyIGhpc3Rvcnlcblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdCAqL1xyXG4gICAgICAgIHJlc2V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGhpc3RvcnkgPSBbZm0uY3dkKCkuaGFzaF07XHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSAwO1xyXG4gICAgICAgICAgICB1cGRhdGUgPSB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXG5cdFx0ICogQnJvd3NlciBuYXRpdmUgaGlzdG9yeSBvYmplY3Rcblx0XHQgKi9cclxuICAgICAgICBuYXRpdmVIaXN0b3J5ID0gKGZtLm9wdGlvbnMudXNlQnJvd3Nlckhpc3RvcnkgJiYgd2luZG93Lmhpc3RvcnkgJiYgd2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKSA/IHdpbmRvdy5oaXN0b3J5IDogbnVsbCxcclxuICAgICAgICAvKipcblx0XHQgKiBPcGVuIHByZXYvbmV4dCBmb2xkZXJcblx0XHQgKlxuXHRcdCAqIEBCb29sZW4gIG9wZW4gbmV4dCBmb2xkZXI/XG5cdFx0ICogQHJldHVybiBqUXVlcnkuRGVmZXJyZWRcblx0XHQgKi9cclxuICAgICAgICBnbyA9IGZ1bmN0aW9uKGZ3ZCkge1xyXG4gICAgICAgICAgICBpZiAoKGZ3ZCAmJiBzZWxmLmNhbkZvcndhcmQoKSkgfHwgKCFmd2QgJiYgc2VsZi5jYW5CYWNrKCkpKSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmbS5leGVjKCdvcGVuJywgaGlzdG9yeVtmd2QgPyArK2N1cnJlbnQgOiAtLWN1cnJlbnRdKS5mYWlsKHJlc2V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gJC5EZWZlcnJlZCgpLnJlamVjdCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgLyoqXG5cdCAqIFJldHVybiB0cnVlIGlmIHRoZXJlIGlzIHByZXZpb3VzIHZpc2l0ZWQgZGlyZWN0b3JpZXNcblx0ICpcblx0ICogQHJldHVybiBCb29sZW5cblx0ICovXHJcbiAgICB0aGlzLmNhbkJhY2sgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gY3VycmVudCA+IDA7XHJcbiAgICB9OyAvKipcblx0ICogUmV0dXJuIHRydWUgaWYgY2FuIGdvIGZvcndhcmRcblx0ICpcblx0ICogQHJldHVybiBCb29sZW5cblx0ICovXHJcbiAgICB0aGlzLmNhbkZvcndhcmQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gY3VycmVudCA8IGhpc3RvcnkubGVuZ3RoIC0gMTtcclxuICAgIH07IC8qKlxuXHQgKiBHbyBiYWNrXG5cdCAqXG5cdCAqIEByZXR1cm4gdm9pZFxuXHQgKi9cclxuICAgIHRoaXMuYmFjayA9IGdvO1xyXG5cclxuICAgIC8qKlxuXHQgKiBHbyBmb3J3YXJkXG5cdCAqXG5cdCAqIEByZXR1cm4gdm9pZFxuXHQgKi9cclxuICAgIHRoaXMuZm9yd2FyZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBnbyh0cnVlKTtcclxuICAgIH07IC8vIGJpbmQgdG8gZWxmaW5kZXIgZXZlbnRzXHJcbiAgICBmbS5vcGVuKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdmFyIGwgPSBoaXN0b3J5Lmxlbmd0aCxcclxuICAgICAgICAgICAgICAgIGN3ZCA9IGZtLmN3ZCgpLmhhc2g7XHJcblxyXG4gICAgICAgICAgICBpZiAodXBkYXRlKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ID49IDAgJiYgbCA+IGN1cnJlbnQgKyAxICYmIGhpc3Rvcnkuc3BsaWNlKGN1cnJlbnQgKyAxKTtcclxuICAgICAgICAgICAgICAgIGhpc3RvcnlbaGlzdG9yeS5sZW5ndGggLSAxXSAhPSBjd2QgJiYgaGlzdG9yeS5wdXNoKGN3ZCk7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gaGlzdG9yeS5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHVwZGF0ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICBpZiAobmF0aXZlSGlzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEgbmF0aXZlSGlzdG9yeS5zdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZUhpc3RvcnkucmVwbGFjZVN0YXRlKHsgdGhhc2g6IGN3ZCB9LCBudWxsLCBsb2NhdGlvbi5wYXRobmFtZSArIGxvY2F0aW9uLnNlYXJjaCArICcjZWxmXycgKyBjd2QpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuYXRpdmVIaXN0b3J5LnN0YXRlLnRoYXNoICE9IGN3ZCAmJiBuYXRpdmVIaXN0b3J5LnB1c2hTdGF0ZSh7IHRoYXNoOiBjd2QgfSwgbnVsbCwgbG9jYXRpb24ucGF0aG5hbWUgKyBsb2NhdGlvbi5zZWFyY2ggKyAnI2VsZl8nICsgY3dkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnJlbG9hZChyZXNldCk7XHJcblxyXG59IiwiLyoqXG4gKiBlbEZpbmRlciBjb21tYW5kIHByb3RvdHlwZVxuICpcbiAqIEB0eXBlICBlbEZpbmRlci5jb21tYW5kXG4gKiBAYXV0aG9yICBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqL1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZCA9IGZ1bmN0aW9uKGZtKSB7XHJcblxyXG4gICAgLyoqXG5cdCAqIGVsRmluZGVyIGluc3RhbmNlXG5cdCAqXG5cdCAqIEB0eXBlICBlbEZpbmRlclxuXHQgKi9cclxuICAgIHRoaXMuZm0gPSBmbTtcclxuXHJcbiAgICAvKipcblx0ICogQ29tbWFuZCBuYW1lLCBzYW1lIGFzIGNsYXNzIG5hbWVcblx0ICpcblx0ICogQHR5cGUgIFN0cmluZ1xuXHQgKi9cclxuICAgIHRoaXMubmFtZSA9ICcnO1xyXG5cclxuICAgIC8qKlxuXHQgKiBTaG9ydCBjb21tYW5kIGRlc2NyaXB0aW9uXG5cdCAqXG5cdCAqIEB0eXBlICBTdHJpbmdcblx0ICovXHJcbiAgICB0aGlzLnRpdGxlID0gJyc7XHJcblxyXG4gICAgLyoqXG5cdCAqIEN1cnJlbnQgY29tbWFuZCBzdGF0ZVxuXHQgKlxuXHQgKiBAZXhhbXBsZVxuXHQgKiB0aGlzLnN0YXRlID0gLTE7IC8vIGNvbW1hbmQgZGlzYWJsZWRcblx0ICogdGhpcy5zdGF0ZSA9IDA7ICAvLyBjb21tYW5kIGVuYWJsZWRcblx0ICogdGhpcy5zdGF0ZSA9IDE7ICAvLyBjb21tYW5kIGFjdGl2ZSAoZm9yIGV4YW1wbGUgXCJmdWxsc2NyZWVuXCIgY29tbWFuZCB3aGlsZSBlbGZpbmRlciBpbiBmdWxsc2NyZWVuIG1vZGUpXG5cdCAqIEBkZWZhdWx0IC0xXG5cdCAqIEB0eXBlICBOdW1iZXJcblx0ICovXHJcbiAgICB0aGlzLnN0YXRlID0gLTE7XHJcblxyXG4gICAgLyoqXG5cdCAqIElmIHRydWUsIGNvbW1hbmQgY2FuIG5vdCBiZSBkaXNhYmxlZCBieSBjb25uZWN0b3IuXG5cdCAqIEBzZWUgdGhpcy51cGRhdGUoKVxuXHQgKlxuXHQgKiBAdHlwZSAgQm9vbGVuXG5cdCAqL1xyXG4gICAgdGhpcy5hbHdheXNFbmFibGVkID0gZmFsc2U7XHJcblxyXG4gICAgLyoqXG5cdCAqIElmIHRydWUsIHRoaXMgbWVhbnMgY29tbWFuZCB3YXMgZGlzYWJsZWQgYnkgY29ubmVjdG9yLlxuXHQgKiBAc2VlIHRoaXMudXBkYXRlKClcblx0ICpcblx0ICogQHR5cGUgIEJvb2xlblxuXHQgKi9cclxuICAgIHRoaXMuX2Rpc2FibGVkID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5kaXNhYmxlT25TZWFyY2ggPSBmYWxzZTtcclxuXHJcbiAgICB0aGlzLnVwZGF0ZU9uU2VsZWN0ID0gdHJ1ZTtcclxuXHJcbiAgICAvKipcblx0ICogZWxGaW5kZXIgZXZlbnRzIGRlZmF1bHRzIGhhbmRsZXJzLlxuXHQgKiBJbnNpZGUgaGFuZGxlcnMgXCJ0aGlzXCIgaXMgY3VycmVudCBjb21tYW5kIG9iamVjdFxuXHQgKlxuXHQgKiBAdHlwZSAgT2JqZWN0XG5cdCAqL1xyXG4gICAgdGhpcy5faGFuZGxlcnMgPSB7XHJcbiAgICAgICAgZW5hYmxlOiBmdW5jdGlvbigpIHsgdGhpcy51cGRhdGUodm9pZCgwKSwgdGhpcy52YWx1ZSk7IH0sXHJcbiAgICAgICAgZGlzYWJsZTogZnVuY3Rpb24oKSB7IHRoaXMudXBkYXRlKC0xLCB0aGlzLnZhbHVlKTsgfSxcclxuICAgICAgICAnb3BlbiByZWxvYWQgbG9hZCc6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGlzYWJsZWQgPSAhKHRoaXMuYWx3YXlzRW5hYmxlZCB8fCB0aGlzLmZtLmlzQ29tbWFuZEVuYWJsZWQodGhpcy5uYW1lKSk7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHZvaWQoMCksIHRoaXMudmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXG5cdCAqIGVsRmluZGVyIGV2ZW50cyBoYW5kbGVycy5cblx0ICogSW5zaWRlIGhhbmRsZXJzIFwidGhpc1wiIGlzIGN1cnJlbnQgY29tbWFuZCBvYmplY3Rcblx0ICpcblx0ICogQHR5cGUgIE9iamVjdFxuXHQgKi9cclxuICAgIHRoaXMuaGFuZGxlcnMgPSB7fTsgLyoqXG5cdCAqIFNob3J0Y3V0c1xuXHQgKlxuXHQgKiBAdHlwZSAgQXJyYXlcblx0ICovXHJcbiAgICB0aGlzLnNob3J0Y3V0cyA9IFtdO1xyXG5cclxuICAgIC8qKlxuXHQgKiBDb21tYW5kIG9wdGlvbnNcblx0ICpcblx0ICogQHR5cGUgIE9iamVjdFxuXHQgKi9cclxuICAgIHRoaXMub3B0aW9ucyA9IHsgdWk6ICdidXR0b24nIH07XHJcblxyXG4gICAgLyoqXG5cdCAqIFByZXBhcmUgb2JqZWN0IC1cblx0ICogYmluZCBldmVudHMgYW5kIHNob3J0Y3V0c1xuXHQgKlxuXHQgKiBAcmV0dXJuIHZvaWRcblx0ICovXHJcbiAgICB0aGlzLnNldHVwID0gZnVuY3Rpb24obmFtZSwgb3B0cykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBpLFxyXG4gICAgICAgICAgICBzO1xyXG5cclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMudGl0bGUgPSBmbS5tZXNzYWdlc1snY21kJyArIG5hbWVdID8gZm0uaTE4bignY21kJyArIG5hbWUpIDogbmFtZSxcclxuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIHRoaXMub3B0aW9ucywgb3B0cyk7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSBbXTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudXBkYXRlT25TZWxlY3QpIHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlcnMuc2VsZWN0ID0gZnVuY3Rpb24oKSB7IHRoaXMudXBkYXRlKHZvaWQoMCksIHRoaXMudmFsdWUpOyB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5lYWNoKCQuZXh0ZW5kKHt9LCBzZWxmLl9oYW5kbGVycywgc2VsZi5oYW5kbGVycyksIGZ1bmN0aW9uKGNtZCwgaGFuZGxlcikge1xyXG4gICAgICAgICAgICBmbS5iaW5kKGNtZCwgJC5wcm94eShoYW5kbGVyLCBzZWxmKSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnNob3J0Y3V0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBzID0gdGhpcy5zaG9ydGN1dHNbaV07XHJcbiAgICAgICAgICAgIHMuY2FsbGJhY2sgPSAkLnByb3h5KHMuY2FsbGJhY2sgfHwgZnVuY3Rpb24oKSB7IHRoaXMuZXhlYygpOyB9LCB0aGlzKTtcclxuICAgICAgICAgICAgIXMuZGVzY3JpcHRpb24gJiYgKHMuZGVzY3JpcHRpb24gPSB0aGlzLnRpdGxlKTtcclxuICAgICAgICAgICAgZm0uc2hvcnRjdXQocyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kaXNhYmxlT25TZWFyY2gpIHtcclxuICAgICAgICAgICAgZm0uYmluZCgnc2VhcmNoIHNlYXJjaGVuZCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX2Rpc2FibGVkID0gZS50eXBlID09ICdzZWFyY2gnO1xyXG4gICAgICAgICAgICAgICAgc2VsZi51cGRhdGUodm9pZCgwKSwgc2VsZi52YWx1ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICB9OyAvKipcblx0ICogQ29tbWFuZCBzcGVjaWZpYyBpbml0IHN0dWZmc1xuXHQgKlxuXHQgKiBAcmV0dXJuIHZvaWRcblx0ICovXHJcbiAgICB0aGlzLmluaXQgPSBmdW5jdGlvbigpIHt9OyAvKipcblx0ICogRXhlYyBjb21tYW5kXG5cdCAqXG5cdCAqIEBwYXJhbSAgQXJyYXkgICAgICAgICB0YXJnZXQgZmlsZXMgaGFzaGVzXG5cdCAqIEBwYXJhbSAgQXJyYXl8T2JqZWN0ICBjb21tYW5kIHZhbHVlXG5cdCAqIEByZXR1cm4gJC5EZWZlcnJlZFxuXHQgKi9cclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGZpbGVzLCBvcHRzKSB7XHJcbiAgICAgICAgcmV0dXJuICQuRGVmZXJyZWQoKS5yZWplY3QoKTtcclxuICAgIH07IC8qKlxuXHQgKiBSZXR1cm4gdHJ1ZSBpZiBjb21tYW5kIGRpc2FibGVkLlxuXHQgKlxuXHQgKiBAcmV0dXJuIEJvb2xlblxuXHQgKi9cclxuICAgIHRoaXMuZGlzYWJsZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZSA8IDA7XHJcbiAgICB9OyAvKipcblx0ICogUmV0dXJuIHRydWUgaWYgY29tbWFuZCBlbmFibGVkLlxuXHQgKlxuXHQgKiBAcmV0dXJuIEJvb2xlblxuXHQgKi9cclxuICAgIHRoaXMuZW5hYmxlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnN0YXRlID4gLTE7XHJcbiAgICB9OyAvKipcblx0ICogUmV0dXJuIHRydWUgaWYgY29tbWFuZCBhY3RpdmUuXG5cdCAqXG5cdCAqIEByZXR1cm4gQm9vbGVuXG5cdCAqL1xyXG4gICAgdGhpcy5hY3RpdmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZSA+IDA7XHJcbiAgICB9OyAvKipcblx0ICogUmV0dXJuIGN1cnJlbnQgY29tbWFuZCBzdGF0ZS5cblx0ICogTXVzdCBiZSBvdmVybG9hZGVkIGluIG1vc3QgY29tbWFuZHNcblx0ICpcblx0ICogQHJldHVybiBOdW1iZXJcblx0ICovXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgfTsgLyoqXG5cdCAqIFVwZGF0ZSBjb21tYW5kIHN0YXRlL3ZhbHVlXG5cdCAqIGFuZCByaXplICdjaGFuZ2UnIGV2ZW50IGlmIHNtdGggY2hhbmdlZFxuXHQgKlxuXHQgKiBAcGFyYW0gIE51bWJlciAgbmV3IHN0YXRlIG9yIHVuZGVmaW5lZCB0byBhdXRvIHVwZGF0ZSBzdGF0ZVxuXHQgKiBAcGFyYW0gIG1peGVkICAgbmV3IHZhbHVlXG5cdCAqIEByZXR1cm4gdm9pZFxuXHQgKi9cclxuICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24ocywgdikge1xyXG4gICAgICAgIHZhciBzdGF0ZSA9IHRoaXMuc3RhdGUsXHJcbiAgICAgICAgICAgIHZhbHVlID0gdGhpcy52YWx1ZTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSAtMTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gcyAhPT0gdm9pZCgwKSA/IHMgOiB0aGlzLmdldHN0YXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gdjtcclxuXHJcbiAgICAgICAgaWYgKHN0YXRlICE9IHRoaXMuc3RhdGUgfHwgdmFsdWUgIT0gdGhpcy52YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07IC8qKlxuXHQgKiBCaW5kIGhhbmRsZXIgLyBmaXJlICdjaGFuZ2UnIGV2ZW50LlxuXHQgKlxuXHQgKiBAcGFyYW0gIEZ1bmN0aW9ufHVuZGVmaW5lZCAgZXZlbnQgY2FsbGJhY2tcblx0ICogQHJldHVybiB2b2lkXG5cdCAqL1xyXG4gICAgdGhpcy5jaGFuZ2UgPSBmdW5jdGlvbihjKSB7XHJcbiAgICAgICAgdmFyIGNtZCwgaTtcclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZihjKSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLmxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY21kID0gdGhpcy5saXN0ZW5lcnNbaV07XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNtZCh0aGlzLnN0YXRlLCB0aGlzLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZtLmRlYnVnKCdlcnJvcicsIGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTsgLyoqXG5cdCAqIFdpdGggYXJndW1lbnQgY2hlY2sgZ2l2ZW4gZmlsZXMgaGFzaGVzIGFuZCByZXR1cm4gbGlzdCBvZiBleGlzdGVkIGZpbGVzIGhhc2hlcy5cblx0ICogV2l0aG91dCBhcmd1bWVudCByZXR1cm4gc2VsZWN0ZWQgZmlsZXMgaGFzaGVzLlxuXHQgKlxuXHQgKiBAcGFyYW0gIEFycmF5fFN0cmluZ3x2b2lkICBoYXNoZXNcblx0ICogQHJldHVybiBBcnJheVxuXHQgKi9cclxuICAgIHRoaXMuaGFzaGVzID0gZnVuY3Rpb24oaGFzaGVzKSB7XHJcbiAgICAgICAgcmV0dXJuIGhhc2hlc1xyXG4gICAgICAgICAgICA/ICQubWFwKCQuaXNBcnJheShoYXNoZXMpID8gaGFzaGVzIDogW2hhc2hlc10sIGZ1bmN0aW9uKGhhc2gpIHsgcmV0dXJuIGZtLmZpbGUoaGFzaCkgPyBoYXNoIDogbnVsbDsgfSlcclxuICAgICAgICAgICAgOiBmbS5zZWxlY3RlZCgpO1xyXG4gICAgfTsgLyoqXG5cdCAqIFJldHVybiBvbmx5IGV4aXN0ZWQgZmlsZXMgZnJvbSBnaXZlbiBmaWxzIGhhc2hlcyB8IHNlbGVjdGVkIGZpbGVzXG5cdCAqXG5cdCAqIEBwYXJhbSAgQXJyYXl8U3RyaW5nfHZvaWQgIGhhc2hlc1xuXHQgKiBAcmV0dXJuIEFycmF5XG5cdCAqL1xyXG4gICAgdGhpcy5maWxlcyA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm07XHJcblxyXG4gICAgICAgIHJldHVybiBoYXNoZXNcclxuICAgICAgICAgICAgPyAkLm1hcCgkLmlzQXJyYXkoaGFzaGVzKSA/IGhhc2hlcyA6IFtoYXNoZXNdLCBmdW5jdGlvbihoYXNoKSB7IHJldHVybiBmbS5maWxlKGhhc2gpIHx8IG51bGw7IH0pXHJcbiAgICAgICAgICAgIDogZm0uc2VsZWN0ZWRGaWxlcygpO1xyXG4gICAgfTtcclxufSIsIi8qKlxyXG4gKiBSdXNzaWFuIHRyYW5zbGF0aW9uXHJcbiAqIEBhdXRob3IgRG1pdHJ5IFwiZGlvXCIgTGV2YXNob3YgPGRpb0BzdGQ0Mi5ydT5cclxuICogQHZlcnNpb24gMjAxMS0wNy0xNVxyXG4gKi9cclxuaWYgKGVsRmluZGVyICYmIGVsRmluZGVyLnByb3RvdHlwZSAmJiB0eXBlb2YgKGVsRmluZGVyLnByb3RvdHlwZS5pMTgpID09ICdvYmplY3QnKSB7XHJcbiAgICBlbEZpbmRlci5wcm90b3R5cGUuaTE4LnJ1ID0ge1xyXG4gICAgICAgIHRyYW5zbGF0b3I6ICdEbWl0cnkgXCJkaW9cIiBMZXZhc2hvdiAmbHQ7ZGlvQHN0ZDQyLnJ1Jmd0OycsXHJcbiAgICAgICAgbGFuZ3VhZ2U6ICfQoNGD0YHRgdC60LjQuSDRj9C30YvQuicsXHJcbiAgICAgICAgZGlyZWN0aW9uOiAnbHRyJyxcclxuICAgICAgICBkYXRlRm9ybWF0OiAnZCBNIFkgSDppJyxcclxuICAgICAgICBmYW5jeURhdGVGb3JtYXQ6ICckMSBIOmknLFxyXG4gICAgICAgIG1lc3NhZ2VzOiB7XHJcblxyXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBlcnJvcnMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuICAgICAgICAgICAgJ2Vycm9yJzogJ9CS0L3QuNC80LDQvdC40LUhJyxcclxuICAgICAgICAgICAgJ2Vycm9yRHJvcERpcic6ICfQndC10LLQvtC30LzQvtC20L3QviDQt9Cw0LPRgNGD0LfQuNGC0Ywg0L/QsNC/0LrRgy4nLFxyXG4gICAgICAgICAgICAnZXJyTm90VXBsVGl0bGUnOiAn0J3QtdCy0L7Qt9C80L7QttC90L4g0LfQsNCz0YDRg9C30LjRgtGMINC90LXQutC+0YLQvtGA0YvQtSDRhNCw0LnQu9GLINC/0L4g0YHQu9C10LTRg9GO0YnQuNC8INC/0YDQuNGH0LjQvdCw0Lw6ICcsXHJcbiAgICAgICAgICAgICdlcnJVcGxvYWRNaW5TaXplJzogJ9Cd0LXQstC+0LfQvNC+0LbQvdC+INC30LDQs9GA0YPQt9C40YLRjCDQv9GD0YHRgtC+0Lkg0YTQsNC50LsgKNGA0LDQt9C80LXRgCAwINCx0LDQudGCKSwg0L/QvtC/0YDQvtCx0YPQudGC0LUg0LTQvtCx0LDQstC40YLRjCDQtNGA0YPQs9C+0Lkg0YTQsNC50LsnLFxyXG4gICAgICAgICAgICAnZXJyVXBsb2FkTWF4JzogJ9Cf0YDQtdCy0YvRiNC10L3QviDQvNCw0LrRgdC40LzQsNC70YzQvdC+INC00L7Qv9GD0YHRgtC40LzQvtC1INGH0LjRgdC70L4g0LfQsNCz0YDRg9C20LDQtdC80YvRhSDRhNCw0LnQu9C+0LIsINC/0L7QstGC0L7RgNC40YLQtSDQv9C+0L/Ri9GC0LrRgy4g0JzQsNC60YHQuNC80LDQu9GM0L3QviDQtNC+0L/Rg9GB0YLQuNC80L7QtSDRh9C40YHQu9C+INC+0LTQvdC+0LLRgNC10LzQtdC90L3QviDQt9Cw0LPRgNGD0LbQsNC10LzRi9GFINGE0LDQudC70L7QsiDRgNCw0LLQvdC+IDEw0YLQuCcsXHJcbiAgICAgICAgICAgICdlcnJVcGxvYWRNYXhTaXplJzogJ9Cd0LUg0YPQtNCw0LvQvtGB0Ywg0LfQsNCz0YDRg9C30LjRgtGMINGE0LDQudC7ISDQn9GA0LXQstGL0YjQtdC9INC80LDQutGB0LjQvNCw0LvRjNC90L4g0LTQvtC/0YPRgdGC0LjQvNGL0Lkg0YDQsNC30LzQtdGAINC30LDQs9GA0YPQttCw0LXQvNC+0LPQviDRhNCw0LnQu9CwLCDQv9C+0LLRgtC+0YDQuNGC0LUg0L/QvtC/0YvRgtC60YMuINCc0LDQutGB0LjQvNCw0LvRjNC90L4g0LTQvtC/0YPRgdGC0LjQvNGL0Lkg0YDQsNC30LzQtdGAINGE0LDQudC70LAg0YDQsNCy0LXQvSAyMCDQvNC10LPQsNCx0LDQudGC0LDQvCcsXHJcbiAgICAgICAgICAgICdlcnJJbnZOYW1lQ3InOiAn0JLQvdC40LzQsNC90LjQtSEg0JzQuNC90LjQvNCw0LvRjNC90LDRjyDQtNC70LjQvdCwINC40LzQtdC90Lgg0LTQvtC70LbQvdCwINCx0YvRgtGMINGA0LDQstC90LAg0L7QtNC90L7QvNGDINGB0LjQvNCy0L7Qu9GDLCDQvdC1INGD0YfQuNGC0YvQstCw0Y8g0LTQu9C40L3RgyDRgNCw0YHRiNC40YDQtdC90LjRjywg0L/QvtC/0YDQvtCx0YPQudGC0LUg0LXRidC1INGA0LDQtycsXHJcbiAgICAgICAgICAgICdlcnJJbnZOYW1lQ3JEaXInOiAn0JLQvdC40LzQsNC90LjQtSEg0JzQuNC90LjQvNCw0LvRjNC90LDRjyDQtNC70LjQvdCwINC40LzQtdC90Lgg0LTQvtC70LbQvdCwINCx0YvRgtGMINGA0LDQstC90LAg0L7QtNC90L7QvNGDINGB0LjQvNCy0L7Qu9GDLCDQv9C+0L/RgNC+0LHRg9C50YLQtSDQtdGJ0LUg0YDQsNC3JyxcclxuICAgICAgICAgICAgJ2VyckludlN5bSc6ICfQktC90LjQvNCw0L3QuNC1ISDQpNCw0LnQuyDRgdC+0LTQtdGA0LbQuNGCINC90LXQtNC+0L/Rg9GB0YLQuNC80YvQtSDRgdC40LzQstC+0LvRiyDQsiDQvdCw0LfQstCw0L3QuNC4LiDQlNC70Y8g0LLQstC+0LTQsCDQt9Cw0L/RgNC10YnQtdC90Ysg0YHQuNC80LLQvtC70Ys6IFwiJCAvIFxcIDogKiA/IFwiICsgIyA8ID4gfFwiJyxcclxuICAgICAgICAgICAgJ2VyckludlN5bURpcic6ICfQktC90LjQvNCw0L3QuNC1ISDQn9Cw0L/QutCwINGB0L7QtNC10YDQttC40YIg0L3QtdC00L7Qv9GD0YHRgtC40LzRi9C1INGB0LjQvNCy0L7Qu9GLINCyINC90LDQt9Cy0LDQvdC40LguINCU0LvRjyDQstCy0L7QtNCwINC30LDQv9GA0LXRidC10L3RiyDRgdC40LzQstC+0LvRizogXCIkIC8gXFwgOiAqID8gXCIgKyAjIDwgPiB8XCInLFxyXG4gICAgICAgICAgICAnZXJySW52RXh0RGlmZmVyZW50JzogJ9Cd0LXQu9GM0LfRjyDQuNC30LzQtdC90Y/RgtGMINGA0LDRgdGI0LjRgNC10L3QuNC1JyxcclxuICAgICAgICAgICAgJ2Vyckludk5hbWVTaXplJzogJ9CS0L3QuNC80LDQvdC40LUhINCf0YDQtdCy0YvRiNC10L3QsCDQvNCw0LrRgdC40LzQsNC70YzQvdCw0Y8g0LTQu9C40L3QsCDQuNC80LXQvdC4INGE0LDQudC70LAuINCSINC90LDRgdGC0L7Rj9GJ0LjQuSDQvNC+0LzQtdC90YIg0LzQsNC60YHQuNC80LDQu9GM0L3QsNGPINC00LvQuNC90LAg0LjQvNC10L3QuCDRhNCw0LnQu9CwINC+0LPRgNCw0L3QuNGH0LXQvdCwIDEwMCDRgdC40LzQstC+0LvQsNC80LgnLFxyXG4gICAgICAgICAgICAnZXJySW52TmFtZVNpemVEaXInOiAn0JLQvdC40LzQsNC90LjQtSEg0J/RgNC10LLRi9GI0LXQvdCwINC80LDQutGB0LjQvNCw0LvRjNC90LDRjyDQtNC70LjQvdCwINC40LzQtdC90Lgg0L/QsNC/0LrQuC4g0JIg0L3QsNGB0YLQvtGP0YnQuNC5INC80L7QvNC10L3RgiDQvNCw0LrRgdC40LzQsNC70YzQvdCw0Y8g0LTQu9C40L3QsCDQuNC80LXQvdC4INC/0LDQv9C60Lgg0L7Qs9GA0LDQvdC40YfQtdC90LAgMTAwINGB0LjQvNCy0L7Qu9Cw0LzQuCcsXHJcbiAgICAgICAgICAgIC8vJ2Vyck5hbWVOdWxsJzogJ9CY0LzRjyDRhNCw0LnQu9CwINC90LUg0LzQvtC20LXRgiDRgdC+0YHRgtC+0Y/RgtGMINGC0L7Qu9GM0LrQviDQuNC3INGA0LDRgdGI0LjRgNC10L3QuNGPJyxcclxuICAgICAgICAgICAgJ2VycnJlY2VpdmVkbWFpbCc6ICfQntGI0LjQsdC60LAg0L/RgNC4INC/0L7Qu9GD0YfQtdC90LjQuCDRgdC+0L7QsdGJ0LXQvdC40LknLFxyXG4gICAgICAgICAgICAnZXJyVW5rbm93bic6ICfQndC10LjQt9Cy0LXRgdGC0L3QsNGPINC+0YjQuNCx0LrQsC4nLFxyXG4gICAgICAgICAgICAnZXJyVW5rbm93bkNtZCc6ICfQndC10LjQt9Cy0LXRgdGC0L3QsNGPINC60L7QvNC80LDQvdC00LAuJyxcclxuICAgICAgICAgICAgJ2VyckpxdWknOiAn0J7RgtGB0YPRgtGB0YLQstGD0Y7RgiDQvdC10L7QsdGF0L7QtNC40LzRi9C1INC60L7QvNC/0L7QvdC10L3RgtGLIGpRdWVyeSBVSSAtIHNlbGVjdGFibGUsIGRyYWdnYWJsZSDQuCBkcm9wcGFibGUuJyxcclxuICAgICAgICAgICAgJ2Vyck5vZGUnOiAn0J7RgtGB0YPRgtGB0YLQstGD0LXRgiBET00g0Y3Qu9C10LzQtdC90YIg0LTQu9GPINC40L3QuNGG0LjQsNC70LjQt9Cw0YbQuNC4IGVsRmluZGVyLicsXHJcbiAgICAgICAgICAgICdlcnJVUkwnOiAn0J3QtdC60L7RgNGA0LXQutGC0L3QsNGPINC90LDRgdGC0YDQvtC50LrQsC4g0J3QtdC+0LHRhdC+0LTQuNC80L4g0YPQutCw0LfQsNGC0YwgVVJMINGB0LXRgNCy0LXRgNCwLicsXHJcbiAgICAgICAgICAgICdlcnJBY2Nlc3MnOiAn0JTQvtGB0YLRg9C/INC30LDQv9GA0LXRidC10L0uJyxcclxuICAgICAgICAgICAgJ2VyckNvbm5lY3QnOiAn0J3QtSDRg9C00LDQu9C+0YHRjCDRgdC+0LXQtNC40L3QuNGC0YzRgdGPINGBINGB0LXRgNCy0LXRgNC+0LwuJyxcclxuICAgICAgICAgICAgJ2VyckFib3J0JzogJ9Ch0L7QtdC00LjQvdC10L3QuNC1INC/0YDQtdGA0LLQsNC90L4uJyxcclxuICAgICAgICAgICAgJ2VyclRpbWVvdXQnOiAn0KLQsNC50LzQsNGD0YIg0YHQvtC10LTQuNC90LXQvdC40Y8uJyxcclxuICAgICAgICAgICAgJ2Vyck5vdEZvdW5kJzogJ9Ch0LXRgNCy0LXRgCDQvdC1INC90LDQudC00LXQvS4nLFxyXG4gICAgICAgICAgICAnZXJyUmVzcG9uc2UnOiAn0J3QtdC60L7RgNGA0LXQutGC0L3Ri9C5INC+0YLQstC10YIg0YHQtdGA0LLQtdGA0LAuJyxcclxuICAgICAgICAgICAgJ2VyckNvbmYnOiAn0J3QtdC60L7RgNGA0LXQutGC0L3QsNGPINC90LDRgdGC0YDQvtC50LrQsCDRgdC10YDQstC10YDQsC4nLFxyXG4gICAgICAgICAgICAnZXJySlNPTic6ICfQnNC+0LTRg9C70YwgUEhQIEpTT04g0L3QtSDRg9GB0YLQsNC90L7QstC70LXQvS4nLFxyXG4gICAgICAgICAgICAnZXJyTm9Wb2x1bWVzJzogJ9Ce0YLRgdGD0YLRgdGC0LLRg9GO0YIg0LrQvtGA0L3QtdCy0YvQtSDQtNC40YDQtdC60YLQvtGA0LjQuCDQtNC+0YHRgtGD0L3Ri9C1INC00LvRjyDRh9GC0LXQvdC40Y8uJyxcclxuICAgICAgICAgICAgJ2VyckNtZFBhcmFtcyc6ICfQndC10LrQvtGA0YDQtdC60YLQvdGL0LUg0L/QsNGA0LDQvNC10YLRgNGLINC60L7QvNC80LDQvdC00YsgXCIkMVwiLicsXHJcbiAgICAgICAgICAgICdlcnJEYXRhTm90SlNPTic6ICfQlNCw0L3QvdGL0LUg0L3QtSDRhNC+0YDQvNCw0YLQtSBKU09OLicsXHJcbiAgICAgICAgICAgICdlcnJEYXRhRW1wdHknOiAn0JTQsNC90L3Ri9C1INC+0YLRgdGD0YLRgdGC0LLRg9GO0YIuJyxcclxuICAgICAgICAgICAgJ2VyckNtZFJlcSc6ICfQlNC70Y8g0LfQsNC/0YDQvtGB0LAg0Log0YHQtdGA0LLQtdGA0YMg0L3QtdC+0LHRhdC+0LTQuNC80L4g0YPQutCw0LfQsNGC0Ywg0LjQvNGPINC60L7QvNC80LDQvdC00YsuJyxcclxuICAgICAgICAgICAgJ2Vyck9wZW4nOiAn0J3QtSDRg9C00LDQu9C+0YHRjCDQvtGC0LrRgNGL0YLRjCBcIiQxXCIuJyxcclxuICAgICAgICAgICAgJ2Vyck5vdEZvbGRlcic6ICfQntCx0YrQtdC60YIg0L3QtSDRj9Cy0LvRj9C10YLRgdGPINC/0LDQv9C60L7QuS4nLFxyXG4gICAgICAgICAgICAnZXJyTm90RmlsZSc6ICfQntCx0YrQtdC60YIg0L3QtSDRj9Cy0LvRj9C10YLRgdGPINGE0LDQudC70L7QvC4nLFxyXG4gICAgICAgICAgICAnZXJyUmVhZCc6ICfQntGI0LjQsdC60LAg0YfRgtC10L3QuNGPIFwiJDFcIi4nLFxyXG4gICAgICAgICAgICAnZXJyV3JpdGUnOiAn0J7RiNC40LHQutCwINC30LDQv9C40YHQuCBcIiQxXCIuJyxcclxuICAgICAgICAgICAgJ2VyclBlcm0nOiAn0JTQvtGB0YLRg9C/INC30LDQv9GA0LXRidC10L0uJyxcclxuICAgICAgICAgICAgJ2VyckxvY2tlZCc6ICdcIiQxXCIg0LfQsNGJ0LjRidC10L0g0Lgg0L3QtSDQvNC+0LbQtdGCINCx0YvRgtGMINC/0LXRgNC10LjQvNC10L3QvtCy0LDQvSwg0L/QtdGA0LXQvNC10YnQtdC9INC40LvQuCDRg9C00LDQu9C10L0uJyxcclxuICAgICAgICAgICAgJ2VyckV4aXN0cyc6ICfQkiDQv9Cw0L/QutC1INGD0LbQtSDRgdGD0YnQtdGB0YLQstGD0LXRgiDQvtCx0YrQtdC60YIg0YEg0LjQvNC10L3QtdC8IDxiPlwiJDFcIi48L2I+JyxcclxuICAgICAgICAgICAgJ2Vyckludk5hbWUnOiAn0J3QtdC00L7Qv9GD0YHRgtC40LzQvtC1INC40LzRjyDRhNCw0LnQu9CwLicsXHJcbiAgICAgICAgICAgICdlcnJGb2xkZXJOb3RGb3VuZCc6ICfQn9Cw0L/QutCwINC90LUg0L3QsNC50LTQtdC90LAuJyxcclxuICAgICAgICAgICAgJ2VyckZpbGVOb3RGb3VuZCc6ICfQpNCw0LnQuyDQvdC1INC90LDQudC00LXQvS4nLFxyXG4gICAgICAgICAgICAnZXJyVHJnRm9sZGVyTm90Rm91bmQnOiAn0KbQtdC70LXQstCw0Y8g0L/QsNC/0LrQsCBcIiQxXCIg0L3QtSDQvdCw0LnQtNC10L3QsC4nLFxyXG4gICAgICAgICAgICAnZXJyUG9wdXAnOiAn0JHRgNCw0YPQt9C10YAg0LfQsNCx0LvQvtC60LjRgNC+0LLQsNC7INC+0YLQutGA0YvRgtC40LUg0L3QvtCy0L7Qs9C+INC+0LrQvdCwLiDQp9GC0L7QsdGLINC+0LrRgNGL0YLRjCDRhNCw0LnQuywg0LjQt9C80LXQvdC40YLQtSDQvdCw0YHRgtGA0L7QudC60Lgg0LHRgNCw0YPQt9C10YDQsC4nLFxyXG4gICAgICAgICAgICAnZXJyTWtkaXInOiAn0J7RiNC40LHQutCwINGB0L7Qt9C00LDQvdC40Y8g0L/QsNC/0LrQuCBcIiQxXCIuJyxcclxuICAgICAgICAgICAgJ2Vyck1rZmlsZSc6ICfQntGI0LjQsdC60LAg0YHQvtC30LTQsNC90LjRjyDRhNCw0LnQu9CwIFwiJDFcIi4nLFxyXG4gICAgICAgICAgICAnZXJyUmVuYW1lJzogJ9Ce0YjQuNCx0LrQsCDQv9C10YDQtdC40LzQtdC90L7QstCw0L3QuNGPIFwiJDFcIi4nLFxyXG4gICAgICAgICAgICAnZXJyQ29weUZyb20nOiAn0JrQvtC/0LjRgNC+0LLQsNC90LjQtSDQuNC3INC60L7RgNC90LXQstC+0Lkg0LTQuNGA0LXQutGC0L7RgNC40LggXCIkMVwiINC30LDQv9GA0LXRidC10L3Qvi4nLFxyXG4gICAgICAgICAgICAnZXJyQ29weVRvJzogJ9Ca0L7Qv9C40YDQvtCy0LDQvdC40LUg0LIg0LrQvtGA0L3QtdCy0YPRjiDQtNC40YDQtdC60YLQvtGA0LjRjiBcIiQxXCIg0LfQsNC/0YDQtdGJ0LXQvdC+LicsXHJcbiAgICAgICAgICAgICdlcnJVcGxvYWRDb21tb24nOiAn0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0YTQsNC50LvQvtCyLicsXHJcbiAgICAgICAgICAgICdlcnJVcGxvYWQnOiAn0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60LggXCIkMVwiLicsXHJcbiAgICAgICAgICAgICdlcnJVcGxvYWROb0ZpbGVzJzogJ9Ce0YLRgdGD0YLRgdGC0LLRg9GO0YIg0LfQsNCz0YDRg9C20LXQvdGL0LUg0YTQsNC50LvRiy4nLFxyXG4gICAgICAgICAgICAnZXJyTWF4U2l6ZSc6ICfQn9GA0LXQstGL0YjQtdC9INC00L7Qv9GD0YHRgtC40LzRi9C5INGA0LDQt9C80LXRgCDQt9Cw0LPRgNGD0LbQsNC10LzRi9GFINGE0LDQudC70L7Qsi4nLFxyXG4gICAgICAgICAgICAnZXJyRmlsZU1heFNpemUnOiAn0KDQsNC30LzQtdGAINGE0LDQudC70LAg0L/RgNC10LLRi9GI0LDQtdGCINC00L7Qv9GD0YHRgtC40LzRi9C5LicsXHJcbiAgICAgICAgICAgICdlcnJVcGxvYWRNaW1lJzogJ9Cd0LXQtNC+0L/Rg9GB0YLQuNC80YvQuSDRgtC40L8g0YTQsNC50LvQsC4nLFxyXG4gICAgICAgICAgICAnZXJyVXBsb2FkVHJhbnNmZXInOiAn0J7RiNC40LHQutCwINC/0LXRgNC10LTQsNGH0Lgg0YTQsNC50LvQsCBcIiQxXCIuJyxcclxuICAgICAgICAgICAgJ2VyclNhdmUnOiAn0J7RiNC40LHQutCwINGB0L7RhdGA0LDQvdC10L3QuNGPIFwiJDFcIi4nLFxyXG4gICAgICAgICAgICAnZXJyQ29weSc6ICfQntGI0LjQsdC60LAg0LrQvtC/0LjRgNC+0LLQsNC90LjRjyBcIiQxXCIuJyxcclxuICAgICAgICAgICAgJ2Vyck1vdmUnOiAn0J7RiNC40LHQutCwINC/0LXRgNC10LzQtdGJ0LXQvdC40Y8gXCIkMVwiLicsXHJcbiAgICAgICAgICAgICdlcnJDb3B5SW5JdHNlbGYnOiAn0J3QtdCy0L7Qt9C80L7QttC90L4g0YHQutC+0L/QuNGA0L7QstCw0YLRjCDQv9Cw0L/QutGDIFwiJDFcIiDQsiDRgdCw0LzRgyDRgdC10LHRjy4nLFxyXG4gICAgICAgICAgICAnZXJyUm0nOiAn0J7RiNC40LHQutCwINGD0LTQsNC70LXQvdC40Y8gXCIkMVwiLicsXHJcbiAgICAgICAgICAgICdlcnJFeHRyYWN0JzogJ9Ce0YjQuNCx0LrQsCDQuNC30LLQu9C10YfQtdC90LjRjyDRhNCw0LnQu9C+0LIg0LjQtyDQsNGA0YXQuNCy0LAgXCIkMVwiLicsXHJcbiAgICAgICAgICAgICdlcnJBcmNoaXZlJzogJ9Ce0YjQuNCx0LrQsCDRgdC+0LfQtNCw0L3QuNGPINCw0YDRhdC40LLQsC4nLFxyXG4gICAgICAgICAgICAnZXJyQXJjVHlwZSc6ICfQndC10L/QvtC00LTQtdGA0LbQuNCy0LDQtdC80YvQuSDRgtC40L8g0LDRgNGF0LjQstCwLicsXHJcbiAgICAgICAgICAgICdlcnJOb0FyY2hpdmUnOiAn0KTQsNC50Lsg0L3QtSDRj9Cy0LvRj9C10YLRgdGPINCw0YDRhdC40LLQvtC8INC00L7Qv9GD0YHRgtC40LzQvtCz0L4g0YLQuNC/0LAuJyxcclxuICAgICAgICAgICAgJ2VyckNtZE5vU3VwcG9ydCc6ICfQodC10YDQstC10YAg0L3QtSDQv9C+0LTQtNC10YDQttC40LLQsNC10YIg0Y3RgtGDINC60L7QvNC80LDQvdC00YMuJyxcclxuICAgICAgICAgICAgJ2VyclJlcGxCeUNoaWxkJzogJ9Cd0LXQstC+0LfQvNC+0LbQvdC+INC30LDQvNC10L3QuNGC0Ywg0L/QsNC/0LrRgyBcIiQxXCIg0YHQvtC00LXRgNC20LDRidC40LzRgdGPINCyINC90LXQuSDQvtCx0YrQtdC60YLQvtC8LicsXHJcbiAgICAgICAgICAgICdlcnJBcmNTeW1saW5rcyc6ICfQn9C+INGB0L7QvtCx0YDQsNC20LXQvdC40Y/QvCDQsdC10LfQvtC/0LDRgdC90L7RgdGC0Lgg0LfQsNC/0YDQtdGJ0LXQvdCwINGA0LDRgdC/0LDQutC+0LLQutCwINCw0YDRhdC40LLQvtCyLCDRgdC+0LTQtdGA0LbQsNGJ0LjRhSDRgdGB0YvQu9C60LggKHN5bWxpbmtzKSDQuNC70Lgg0YTQsNC50LvRiyDRgSDQvdC10LTQvtC/0YPRgdGC0LjQvNGL0LzQuCDQuNC80LXQvdCw0LzQuC4nLCAvLyBlZGl0ZWQgMjQuMDYuMjAxMlxyXG4gICAgICAgICAgICAnZXJyQXJjTWF4U2l6ZSc6ICfQoNCw0LfQvNC10YAg0YTQsNC50LvQvtCyINCyINCw0YDRhdC40LLQtSDQv9GA0LXQstGL0YjQsNC10YIg0LzQsNC60YHQuNC80LDQu9GM0L3QviDRgNCw0LfRgNC10YjQtdC90L3Ri9C5LicsXHJcbiAgICAgICAgICAgICdlcnJSZXNpemUnOiAn0J3QtSDRg9C00LDQu9C+0YHRjCDQuNC30LzQtdC90LjRgtGMINGA0LDQt9C80LXRgCBcIiQxXCIuJyxcclxuICAgICAgICAgICAgJ2VyclVzdXBwb3J0VHlwZSc6ICfQndC10L/QvtC00LTQtdGA0LbQuNCy0LDQtdC80YvQuSDRgtC40L8g0YTQsNC50LvQsC4nLFxyXG4gICAgICAgICAgICAnZXJyTm90VVRGOENvbnRlbnQnOiAn0KTQsNC50LsgXCIkMVwiINGB0L7QtNC10YDQttC40YIg0YLQtdC60YHRgiDQsiDQutC+0LTQuNGA0L7QstC60LUg0L7RgtC70LjRh9C90L7QuSDQvtGCIFVURi04INC4INC90LUg0LzQvtC20LXRgiDQsdGL0YLRjCDQvtGC0YDQtdC00LDQutGC0LjRgNC+0LLQsNC9LicsIC8vIGFkZGVkIDkuMTEuMjAxMVxyXG4gICAgICAgICAgICAnZXJyTmV0TW91bnQnOiAn0J3QtSDRg9C00LDQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjCBcIiQxXCIuJywgLy8gYWRkZWQgMTcuMDQuMjAxMlxyXG4gICAgICAgICAgICAnZXJyTmV0TW91bnROb0RyaXZlcic6ICfQndC10L/QvtC00LTQtdGA0LbQuNCy0LDQtdC80YvQuSDQv9GA0L7RgtC+0LrQvtC7LicsIC8vIGFkZGVkIDE3LjA0LjIwMTJcclxuICAgICAgICAgICAgJ2Vyck5ldE1vdW50RmFpbGVkJzogJ9Ce0YjQuNCx0LrQsCDQvNC+0L3RgtC40YDQvtCy0LDQvdC40Y8uJywgLy8gYWRkZWQgMTcuMDQuMjAxMlxyXG4gICAgICAgICAgICAnZXJyTmV0TW91bnRIb3N0UmVxJzogJ0hvc3QgcmVxdWlyZWQuJywgLy8gYWRkZWQgMTguMDQuMjAxMlxyXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBjb21tYW5kcyBuYW1lcyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuICAgICAgICAgICAgJ2NtZGFyY2hpdmUnOiAn0KHQvtC30LTQsNGC0Ywg0LDRgNGF0LjQsicsXHJcbiAgICAgICAgICAgICdjbWRiYWNrJzogJ9Cd0LDQt9Cw0LQnLFxyXG4gICAgICAgICAgICAnY21kY29weSc6ICfQmtC+0L/QuNGA0L7QstCw0YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRjdXQnOiAn0JLRi9GA0LXQt9Cw0YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRkb3dubG9hZCc6ICfQodC60LDRh9Cw0YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRkdXBsaWNhdGUnOiAn0KHQtNC10LvQsNGC0Ywg0LrQvtC/0LjRjicsXHJcbiAgICAgICAgICAgICdjbWRlZGl0JzogJ9Cg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMJyxcclxuICAgICAgICAgICAgJ2NtZGV4dHJhY3QnOiAn0KDQsNGB0L/QsNC60L7QstCw0YLRjCDQsNGA0YXQuNCyJyxcclxuICAgICAgICAgICAgJ2NtZGZvcndhcmQnOiAn0JLQv9C10YDQtdC0JyxcclxuICAgICAgICAgICAgJ2NtZGdldGZpbGUnOiAn0JLRi9Cx0YDQsNGC0YwnLFxyXG4gICAgICAgICAgICAnY21kaGVscCc6ICfQniDQv9GA0L7Qs9GA0LDQvNC80LUnLFxyXG4gICAgICAgICAgICAnY21kaG9tZSc6ICfQlNC+0LzQvtC5JyxcclxuICAgICAgICAgICAgJ2NtZGluZm8nOiAn0KHQstC+0LnRgdGC0LLQsCcsXHJcbiAgICAgICAgICAgICdjbWRta2Rpcic6ICfQndC+0LLQsNGPINC/0LDQv9C60LAnLFxyXG4gICAgICAgICAgICAnY21kbWtmaWxlJzogJ9Cd0L7QstGL0Lkg0YTQsNC50LsnLFxyXG4gICAgICAgICAgICAnY21kb3Blbic6ICfQntGC0LrRgNGL0YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRwYXN0ZSc6ICfQktGB0YLQsNCy0LjRgtGMJyxcclxuICAgICAgICAgICAgJ2NtZHF1aWNrbG9vayc6ICfQkdGL0YHRgtGA0YvQuSDQv9GA0L7RgdC80L7RgtGAJyxcclxuICAgICAgICAgICAgJ2NtZHJlbG9hZCc6ICfQntCx0L3QvtCy0LjRgtGMJyxcclxuICAgICAgICAgICAgJ2NtZHJlbmFtZSc6ICfQn9C10YDQtdC40LzQtdC90L7QstCw0YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRybSc6ICfQo9C00LDQu9C40YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRzZWFyY2gnOiAn0J/QvtC40YHQuicsXHJcbiAgICAgICAgICAgICdjbWR1cCc6ICfQndCw0LLQtdGA0YUnLFxyXG4gICAgICAgICAgICAnY21kdXBsb2FkJzogJ9CU0L7QsdCw0LLQuNGC0Ywg0YTQsNC50LsnLFxyXG4gICAgICAgICAgICAnY21kdmlldyc6ICfQktC40LQnLFxyXG4gICAgICAgICAgICAnY21kcmVzaXplJzogJ9Cg0LDQt9C80LXRgCDQuNC30L7QsdGA0LDQttC10L3QuNGPJyxcclxuICAgICAgICAgICAgJ2NtZHNvcnQnOiAn0KHQvtGA0YLQuNGA0L7QstCw0YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRlbmNyeXB0JzogJ9CX0LDRiNC40YTRgNC+0LLQsNGC0YwnLFxyXG4gICAgICAgICAgICAnY21kZGVjcnlwdCc6ICfQoNCw0YHRiNC40YTRgNC+0LLQsNGC0YwnLFxyXG4gICAgICAgICAgICAnY21kc2lnbic6ICfQn9C+0LTQv9C40YHQsNGC0YwnLFxyXG4gICAgICAgICAgICAnY21kY2hlY2tzaWduJzogJ9Cf0YDQvtCy0LXRgNC40YLRjCDQv9C+0LTQv9C40YHRjCcsXHJcbiAgICAgICAgICAgICdjbWRzZW5kJzogJ9Ce0YLQv9GA0LDQstC40YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRvcGVuc2VuZHBvcHVwJzogJ9Ce0YLQv9GA0LDQstC40YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRkZWNyeXB0YW5kY2hlY2tzaWduJzogJ9Cg0LDRgdGI0LjRhNGA0L7QstCw0YLRjCDQuCDQv9GA0L7QstC10YDQuNGC0Ywg0L/QvtC00L/QuNGB0YwnLFxyXG4gICAgICAgICAgICAnY21kc2lnbmFuZGVuY3J5cHQnOiAn0J/QvtC00L/QuNGB0LDRgtGMINC4INC30LDRiNC40YTRgNC+0LLQsNGC0YwnLFxyXG4gICAgICAgICAgICAnY21kbW9yZSc6ICfQldGJ0LUnLFxyXG4gICAgICAgICAgICAnY21kY3J5cHRpbmZvJzogJ9Cf0L7QtNGA0L7QsdC90LXQtScsXHJcbiAgICAgICAgICAgICdjbWRhZGQnOiAn0JTQvtCx0LDQstC40YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRjYW5jZWwnOiAn0L7RgtC80LXQvdC40YLRjCcsXHJcbiAgICAgICAgICAgICdjbWRjYW5jZWwyJzogJ9Ce0YLQvNC10L3QsCcsXHJcbiAgICAgICAgICAgICdjbWRmaWx0ZXInOiAn0JLRi9Cy0L7QtNC40YLRjDogJyxcclxuICAgICAgICAgICAgJ2NtZG11bHRpcGx5YWRkJzogJysg0JTQvtCx0LDQstC40YLRjCcsXHJcbiAgICAgICAgICAgICdhZGR1cGxvYWQnOiAn0KTQsNC50LsnLFxyXG4gICAgICAgICAgICAnYWRkbWtkaXInOiAn0J/QsNC/0LrRgycsXHJcbiAgICAgICAgICAgICdhZGRwYXN0ZSc6ICfQktGB0YLQsNCy0LjRgtGMINC40Lcg0LHRg9GE0LXRgNCwJyxcclxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIGJ1dHRvbnMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiAgICAgICAgICAgICdidG5DbG9zZSc6ICfQl9Cw0LrRgNGL0YLRjCcsXHJcbiAgICAgICAgICAgICdidG5TYXZlJzogJ9Ch0L7RhdGA0LDQvdC40YLRjCcsXHJcbiAgICAgICAgICAgICdidG5SbSc6ICfQlNCwJyxcclxuICAgICAgICAgICAgJ2J0bkNhbmNlbCc6ICfQntGC0LzQtdC90LAnLFxyXG4gICAgICAgICAgICAnYnRuQXBwbHknOiAn0J/RgNC40LzQtdC90LjRgtGMJyxcclxuICAgICAgICAgICAgJ2J0bk5vJzogJ9Cd0LXRgicsXHJcbiAgICAgICAgICAgICdidG5ZZXMnOiAn0JTQsCcsXHJcbiAgICAgICAgICAgICdidG5Nb3VudCc6ICfQn9C+0LTQutC70Y7Rh9C40YLRjCcsIC8vIGFkZGVkIDE4LjA0LjIwMTJcclxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIG5vdGlmaWNhdGlvbnMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiAgICAgICAgICAgICdudGZvcGVuJzogJ9Ce0YLQutGA0YvRgtC40LUg0L/QsNC/0LrQuCcsXHJcbiAgICAgICAgICAgICdudGZmaWxlJzogJ9Ce0YLQutGA0YvRgtC40LUg0YTQsNC50LvQsCcsXHJcbiAgICAgICAgICAgICdudGZyZWxvYWQnOiAn0J7QsdC90L7QstC70LXQvdC40LUg0YLQtdC60YPRidC10Lkg0L/QsNC/0LrQuCcsXHJcbiAgICAgICAgICAgICdudGZta2Rpcic6ICfQodC+0LfQtNCw0L3QuNC1INC/0LDQv9C60LgnLFxyXG4gICAgICAgICAgICAnbnRmbWtmaWxlJzogJ9Ch0L7Qt9C00LDQvdC40LUg0YTQsNC50LvQsCcsXHJcbiAgICAgICAgICAgICdudGZybSc6ICfQo9C00LDQu9C10L3QuNC1INGE0LDQudC70L7QsicsXHJcbiAgICAgICAgICAgICdudGZjb3B5JzogJ9Ca0L7Qv9C40YDQvtCy0LDQvdC40LUg0YTQsNC50LvQvtCyJyxcclxuICAgICAgICAgICAgJ250Zm1vdmUnOiAn0J/QtdGA0LXQvNC10YnQtdC90LjQtSDRhNCw0LnQu9C+0LInLFxyXG4gICAgICAgICAgICAnbnRmcHJlcGFyZSc6ICfQn9C+0LTQs9C+0YLQvtCy0LrQsCDQuiDQutC+0L/QuNGA0L7QstCw0L3QuNGOJyxcclxuICAgICAgICAgICAgJ250ZnJlbmFtZSc6ICfQn9C10YDQtdC40LzQtdC90L7QstCw0L3QuNC1INGE0LDQudC70L7QsicsXHJcbiAgICAgICAgICAgICdudGZ1cGxvYWQnOiAn0JfQsNCz0YDRg9C30LrQsCDRhNCw0LnQu9C+0LInLFxyXG4gICAgICAgICAgICAnbnRmZG93bmxvYWQnOiAn0KHQutCw0YfQuNCy0LDQvdC40LUg0YTQsNC50LvQvtCyJyxcclxuICAgICAgICAgICAgJ250ZnNhdmUnOiAn0KHQvtGF0YDQsNC90LXQvdC40LUg0YTQsNC50LvQvtCyJyxcclxuICAgICAgICAgICAgJ250ZmFyY2hpdmUnOiAn0KHQvtC30LTQsNC90LjQtSDQsNGA0YXQuNCy0LAnLFxyXG4gICAgICAgICAgICAnbnRmZXh0cmFjdCc6ICfQoNCw0YHQv9Cw0LrQvtCy0LrQsCDQsNGA0YXQuNCy0LAnLFxyXG4gICAgICAgICAgICAnbnRmc2VhcmNoJzogJ9Cf0L7QuNGB0Log0YTQsNC50LvQvtCyJyxcclxuICAgICAgICAgICAgJ250ZnNtdGgnOiAn0J7QsdGA0LDQsdC+0YLQutCwINC30LDQv9GA0L7RgdCwLicsXHJcbiAgICAgICAgICAgICdudGZuZXRtb3VudCc6ICfQnNC+0L3RgtC40YDRg9GOINGB0LXRgtC10LLQvtC5INC00LjRgdC6JywgLy8gYWRkZWQgMTguMDQuMjAxMlxyXG5cclxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBkYXRlcyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgICAgICAgICAnZGF0ZVVua25vd24nOiAn0J3QtdC30LLQtdGB0YLQvdC+JyxcclxuICAgICAgICAgICAgJ1RvZGF5JzogJ9Ch0LXQs9C+0LTQvdGPJyxcclxuICAgICAgICAgICAgJ1llc3RlcmRheSc6ICfQktGH0LXRgNCwJyxcclxuICAgICAgICAgICAgJ0phbic6ICfQr9C90LInLFxyXG4gICAgICAgICAgICAnRmViJzogJ9Ck0LXQsicsXHJcbiAgICAgICAgICAgICdNYXInOiAn0JzQsNGAJyxcclxuICAgICAgICAgICAgJ0Fwcic6ICfQkNC/0YAnLFxyXG4gICAgICAgICAgICAnTWF5JzogJ9Cc0LDQuScsXHJcbiAgICAgICAgICAgICdKdW4nOiAn0JjRjtC90YwnLFxyXG4gICAgICAgICAgICAnSnVsJzogJ9CY0Y7Qu9GMJyxcclxuICAgICAgICAgICAgJ0F1Zyc6ICfQkNCy0LMnLFxyXG4gICAgICAgICAgICAnU2VwJzogJ9Ch0LXQvScsXHJcbiAgICAgICAgICAgICdPY3QnOiAn0J7QutGCJyxcclxuICAgICAgICAgICAgJ05vdic6ICfQndC+0Y8nLFxyXG4gICAgICAgICAgICAnRGVjJzogJ9CU0LXQuicsXHJcbiAgICAgICAgICAgICdKYW51YXJ5JzogJ9Cv0L3QstCw0YDRjCcsXHJcbiAgICAgICAgICAgICdGZWJydWFyeSc6ICfQpNC10LLRgNCw0LvRjCcsXHJcbiAgICAgICAgICAgICdNYXJjaCc6ICfQnNCw0YDRgicsXHJcbiAgICAgICAgICAgICdBcHJpbCc6ICfQkNC/0YDQtdC70YwnLFxyXG4gICAgICAgICAgICAnTWF5JzogJ9Cc0LDQuScsXHJcbiAgICAgICAgICAgICdKdW5lJzogJ9CY0Y7QvdGMJyxcclxuICAgICAgICAgICAgJ0p1bHknOiAn0JjRjtC70YwnLFxyXG4gICAgICAgICAgICAnQXVndXN0JzogJ9CQ0LLQs9GD0YHRgicsXHJcbiAgICAgICAgICAgICdTZXB0ZW1iZXInOiAn0KHQtdC90YLRj9Cx0YDRjCcsXHJcbiAgICAgICAgICAgICdPY3RvYmVyJzogJ9Ce0LrRgtGP0LHRgNGMJyxcclxuICAgICAgICAgICAgJ05vdmVtYmVyJzogJ9Cd0L7Rj9Cx0YDRjCcsXHJcbiAgICAgICAgICAgICdEZWNlbWJlcic6ICfQlNC10LrQsNCx0YDRjCcsXHJcbiAgICAgICAgICAgICdTdW5kYXknOiAn0JLQvtGB0LrRgNC10YHQtdC90YzQtScsXHJcbiAgICAgICAgICAgICdNb25kYXknOiAn0J/QvtC90LXQtNC10LvRjNC90LjQuicsXHJcbiAgICAgICAgICAgICdUdWVzZGF5JzogJ9CS0YLQvtGA0L3QuNC6JyxcclxuICAgICAgICAgICAgJ1dlZG5lc2RheSc6ICfQodGA0LXQtNCwJyxcclxuICAgICAgICAgICAgJ1RodXJzZGF5JzogJ9Cn0LXRgtCy0LXRgNCzJyxcclxuICAgICAgICAgICAgJ0ZyaWRheSc6ICfQn9GP0YLQvdC40YbQsCcsXHJcbiAgICAgICAgICAgICdTYXR1cmRheSc6ICfQodGD0LHQsdC+0YLQsCcsXHJcbiAgICAgICAgICAgICdTdW4nOiAn0JLRgdC6JyxcclxuICAgICAgICAgICAgJ01vbic6ICfQn9C90LQnLFxyXG4gICAgICAgICAgICAnVHVlJzogJ9CS0YLRgCcsXHJcbiAgICAgICAgICAgICdXZWQnOiAn0KHRgNC0JyxcclxuICAgICAgICAgICAgJ1RodSc6ICfQp9GC0LInLFxyXG4gICAgICAgICAgICAnRnJpJzogJ9Cf0YLQvScsXHJcbiAgICAgICAgICAgICdTYXQnOiAn0KHQsdGCJyxcclxuXHJcbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiBzb3J0IHZhcmlhbnRzICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgICAgICAgICAnc29ydG5hbWVEaXJzRmlyc3QnOiAn0L/QviDQuNC80LXQvdC4ICjQv9Cw0L/QutC4INCyINC90LDRh9Cw0LvQtSknLFxyXG4gICAgICAgICAgICAnc29ydGtpbmREaXJzRmlyc3QnOiAn0L/QviDRgtC40L/RgyAo0L/QsNC/0LrQuCDQsiDQvdCw0YfQsNC70LUpJyxcclxuICAgICAgICAgICAgJ3NvcnRzaXplRGlyc0ZpcnN0JzogJ9C/0L4g0YDQsNC30LzQtdGA0YMgKNC/0LDQv9C60Lgg0LIg0L3QsNGH0LDQu9C1KScsXHJcbiAgICAgICAgICAgICdzb3J0ZGF0ZURpcnNGaXJzdCc6ICfQv9C+INC00LDRgtC1ICjQv9Cw0L/QutC4INCyINC90LDRh9Cw0LvQtSknLFxyXG4gICAgICAgICAgICAnc29ydG5hbWUnOiAn0L/QviDQuNC80LXQvdC4JyxcclxuICAgICAgICAgICAgJ3NvcnRraW5kJzogJ9C/0L4g0YLQuNC/0YMnLFxyXG4gICAgICAgICAgICAnc29ydHNpemUnOiAn0L/QviDRgNCw0LfQvNC10YDRgycsXHJcbiAgICAgICAgICAgICdzb3J0ZGF0ZSc6ICfQv9C+INC00LDRgtC1JyxcclxuICAgICAgICAgICAgJ3NvcnRGb2xkZXJzRmlyc3QnOiAn0J/QsNC/0LrQuCDQsiDQvdCw0YfQsNC70LUnLFxyXG5cclxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogbWVzc2FnZXMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuICAgICAgICAgICAgJ2F0dGVudGlvbic6ICfQktC90LjQvNCw0L3QuNC1IScsXHJcbiAgICAgICAgICAgICdyZWNlaXZlZGRpcm5hbWUnOiAn0J/QvtC70YPRh9C10L3QvdGL0LUnLFxyXG4gICAgICAgICAgICAnZ29tYXN0ZXInOiAn0J/QtdGA0LXQudGC0Lgg0Log0LzQsNGB0YLQtdGA0YMnLFxyXG4gICAgICAgICAgICAncmVjZWl2ZWRtYWlsaGVhZGVyJzogJ9CR0YvQu9C4INC/0L7Qu9GD0YfQtdC90Ysg0YHQu9C10LTRg9GO0YnQuNC1INGE0LDQudC70Ys6ICcsXHJcbiAgICAgICAgICAgICdzZW5kb3RoZXJlbWFpbCc6ICfQntGC0L/RgNCw0LLQuNGC0Ywg0YTQsNC50LvRiyDQvdCwINC00YDRg9Cz0L7QuSBFLW1haWwnLFxyXG4gICAgICAgICAgICAnc2VuZGVtYWlsc3VjY2Vzcyc6ICfQpNCw0LnQu9GLINGD0YHQv9C10YjQvdC+INC+0YLQv9GA0LDQstC70LXQvdGLJyxcclxuICAgICAgICAgICAgJ3NlbmRlbWFpbGVycm9yJzogJ9Ce0YjQuNCx0LrQsCDQv9GA0Lgg0L7RgtC/0YDQsNCy0LrQtSDRhNCw0LnQu9C+0LInLFxyXG4gICAgICAgICAgICAnYWRkcmVzc2Jvb2snOiAn0JDQtNGA0LXRgdC90LDRjyDQutC90LjQs9CwJyxcclxuICAgICAgICAgICAgJ2FkZHJlc3Nib29rZW1wdHknOiAn0JDQtNGA0LXRgdC90LDRjyDQutC90LjQs9CwINC/0YPRgdGC0LAuJyxcclxuICAgICAgICAgICAgJ3NlbGVjdCc6ICfQktGL0LHRgNCw0YLRjCcsXHJcbiAgICAgICAgICAgICdub3RlbWFpbCc6ICfQndC10LLQsNC70LjQtNC90YvQuSBFLW1haWwnLFxyXG4gICAgICAgICAgICAnc2VuZGVtYWlsbWVzc2FnZSc6ICfQktCy0LXQtNC40YLQtSBFLW1haWwsINC90LAg0LrQvtGC0L7RgNGL0Lkg0LLRiyDQv9C70LDQvdC40YDRg9C10YLQtSDQvtGC0L/RgNCw0LLQuNGC0Ywg0YTQsNC50Ls6JyxcclxuICAgICAgICAgICAgJ3NlbmRmaWxlJzogJ9Ce0YLQv9GA0LDQstC60LAg0YTQsNC50LvQvtCyJyxcclxuICAgICAgICAgICAgJ3RpbWVzJzogJ9GA0LDQtycsXHJcbiAgICAgICAgICAgICdub3RmaWxlc2ZvcmZpbHRlcic6ICfQndC4INC+0LTQuNC9INGE0LDQudC7INC90LUg0YHQvtC+0YLQstC10YLRgdGC0LLRg9C10YIg0LLRi9Cx0YDQsNC90L3QvtC5INGE0LjQu9GM0YLRgNCw0YbQuNC4JyxcclxuICAgICAgICAgICAgJ2ZpbHRlckFsbCc6ICfQktGB0LUnLFxyXG4gICAgICAgICAgICAnZmlsdGVyU2lnbic6ICfQn9C+0LTQv9C40YHQsNC90L3Ri9C1JyxcclxuICAgICAgICAgICAgJ2ZpbHRlckNyeXB0JzogJ9CX0LDRiNC40YTRgNC+0LLQsNC90L3Ri9C1JyxcclxuICAgICAgICAgICAgJ2ZpbHRlck5vdENyeXB0U2lnbic6ICfQndC1INC30LDRiNC40YTRgNC+0LLQsNC90L3Ri9C1INC4INC90LUg0L/QvtC00L/QuNGB0LDQvdC90YvQtScsXHJcbiAgICAgICAgICAgICdjd2RlbXB0eWhlbHAnOiAn0JLRiyDQvNC+0LbQtdGC0LUg0LfQsNCz0YDRg9C30LjRgtGMINGE0LDQudC70YssINC/0LXRgNC10YLQsNGJ0LjQsiDQuNGFINCyINC00LDQvdC90L7QtSDQvtC60L3QviAnLFxyXG4gICAgICAgICAgICAnb3InOiAn0LjQu9C4JyxcclxuICAgICAgICAgICAgJ2N3ZHNlbGVjdGZpbGUnOiAn0LLRi9Cx0YDQsNGC0Ywg0YTQsNC50LvRiyDQsiDQv9GA0L7QstC+0LTQvdC40LrQtScsXHJcbiAgICAgICAgICAgICdsYXN0Y2hhbmdlJzogJ9CU0LDRgtCwINC/0L7RgdC70LXQtNC90LXQs9C+INC40LfQvNC10L3QtdC90LjRjzogJyxcclxuICAgICAgICAgICAgJ3NpemVpbmZvJzogJ9Cg0LDQt9C80LXRgDogJyxcclxuICAgICAgICAgICAgJ2VtcHR5Y3J5cHRpbmZvJzogJ9CU0L7QutGD0LzQtdC90YIg0L3QtSDQv9C+0LTQv9C40YHQsNC9INC4INC90LUg0LfQsNGI0LjRhNGA0L7QstCw0L0nLFxyXG4gICAgICAgICAgICAnY3J5cHRpbmZvbm9jZXJ0JzogJ9CU0L7QutGD0LzQtdC90YIg0L3QtSDRgdC+0LTQtdGA0LbQuNGCINC40L3RhNC+0YDQvNCw0YbQuNGOINC+INC/0L7QtNC/0LjRgdGP0YUnLFxyXG4gICAgICAgICAgICAnaW5mb3NlbCc6ICfQktGL0LHRgNCw0L3QviDRjdC70LXQvNC10L3RgtC+0LI6ICcsXHJcbiAgICAgICAgICAgICdzaWduZWQnOiAn0J/QvtC00L/QuNGB0LDQvSAnLFxyXG4gICAgICAgICAgICAnZW5jcnlwdGVkJzogJ9CX0LDRiNC40YTRgNC+0LLQsNC9JyxcclxuICAgICAgICAgICAgJ2N3ZGVtcHR5JzogJ9Ct0YLQsCDQv9Cw0L/QutCwINC/0YPRgdGC0LAuJyxcclxuICAgICAgICAgICAgJ2NvbmZpcm1SZXEnOiAn0J3QtdC+0LHRhdC+0LTQuNC80L4g0L/QvtC00YLQstC10YDQttC00LXQvdC40LUuJyxcclxuICAgICAgICAgICAgJ2NvbmZpcm1SbSc6ICfQktGL0LHRgNCw0L3QvdGL0LUg0YTQsNC50LvRiyDQsdGD0LTRg9GCINGD0LTQsNC70LXQvdGLLiDQn9GA0L7QtNC+0LvQttC40YLRjD8nLFxyXG4gICAgICAgICAgICAnY29uZmlybVJlcGwnOiAn0JfQsNC80LXQvdC40YLRjCDRgdGC0LDRgNGL0Lkg0YTQsNC50Lsg0L3QvtCy0YvQvD8nLFxyXG4gICAgICAgICAgICAnYXBsbHlBbGwnOiAn0LTQu9GPINCy0YHQtdGFJyxcclxuICAgICAgICAgICAgJ25hbWUnOiAn0JjQvNGPINGE0LDQudC70LAnLFxyXG4gICAgICAgICAgICAnc2l6ZSc6ICfQoNCw0LfQvNC10YAnLFxyXG4gICAgICAgICAgICAncGVybXMnOiAn0JTQvtGB0YLRg9C/JyxcclxuICAgICAgICAgICAgJ21vZGlmeSc6ICfQmNC30LzQtdC90LXQvScsXHJcbiAgICAgICAgICAgICdraW5kJzogJ9Ci0LjQvycsXHJcbiAgICAgICAgICAgICdkYXRlJzogJ9CU0LDRgtCwINC40LfQvNC10L3QtdC90LjRjycsXHJcbiAgICAgICAgICAgICdyZWFkJzogJ9GH0YLQtdC90LjQtScsXHJcbiAgICAgICAgICAgICd3cml0ZSc6ICfQt9Cw0L/QuNGB0YwnLFxyXG4gICAgICAgICAgICAnbm9hY2Nlc3MnOiAn0L3QtdGCINC00L7RgdGC0YPQv9CwJyxcclxuICAgICAgICAgICAgJ2FuZCc6ICfQuCcsXHJcbiAgICAgICAgICAgICd1bmtub3duJzogJ9C90LXQuNC30LLQtdGB0YLQvdC+JyxcclxuICAgICAgICAgICAgJ3NlbGVjdGFsbCc6ICfQktGL0LHRgNCw0YLRjCDQstGB0LUnLFxyXG4gICAgICAgICAgICAnc2VsZWN0ZmlsZXMnOiAn0JLRi9Cx0YDQsNGC0Ywg0YTQsNC50Lso0YspJyxcclxuICAgICAgICAgICAgJ3NlbGVjdGZmaWxlJzogJ9CS0YvQsdGA0LDRgtGMINC/0LXRgNCy0YvQuSDRhNCw0LnQuycsXHJcbiAgICAgICAgICAgICdzZWxlY3RsZmlsZSc6ICfQktGL0LHRgNCw0YLRjCDQv9C+0YHQu9C10LTQvdC40Lkg0YTQsNC50LsnLFxyXG4gICAgICAgICAgICAndmlld2xpc3QnOiAn0JIg0LLQuNC00LUg0YHQv9C40YHQutCwJyxcclxuICAgICAgICAgICAgJ3ZpZXdpY29ucyc6ICfQkiDQstC40LTQtSDQuNC60L7QvdC+0LonLFxyXG4gICAgICAgICAgICAncGxhY2VzJzogJ9CY0LfQsdGA0LDQvdC90L7QtScsXHJcbiAgICAgICAgICAgICdjYWxjJzogJ9Cy0YvRh9C40YHQu9GP0Y4nLFxyXG4gICAgICAgICAgICAncGF0aCc6ICfQn9GD0YLRjCcsXHJcbiAgICAgICAgICAgICdhbGlhc2Zvcic6ICfQo9C60LDQt9GL0LLQsNC10YIg0L3QsCcsXHJcbiAgICAgICAgICAgICdsb2NrZWQnOiAn0JfQsNGJ0LjRgtCwJyxcclxuICAgICAgICAgICAgJ2RpbSc6ICfQoNCw0LfRgNC10YjQtdC90LjQtScsXHJcbiAgICAgICAgICAgICdmaWxlcyc6ICfQpNCw0LnQu9GLJyxcclxuICAgICAgICAgICAgJ2ZvbGRlcnMnOiAn0J/QsNC/0LrQuCcsXHJcbiAgICAgICAgICAgICdpdGVtcyc6ICfQntCx0YrQtdC60YLRiycsXHJcbiAgICAgICAgICAgICd5ZXMnOiAn0LTQsCcsXHJcbiAgICAgICAgICAgICdubyc6ICfQvdC10YInLFxyXG4gICAgICAgICAgICAnbGluayc6ICfQodGB0YvQu9C60LAnLFxyXG4gICAgICAgICAgICAnc2VhcmNyZXN1bHQnOiAn0KDQtdC30YPQu9GM0YLQsNGC0Ysg0L/QvtC40YHQutCwJyxcclxuICAgICAgICAgICAgJ3NlbGVjdGVkJzogJ9Cy0YvQsdGA0LDQvdC+JyxcclxuICAgICAgICAgICAgJ2Fib3V0JzogJ9CeINC/0YDQvtCz0YDQsNC80LzQtScsXHJcbiAgICAgICAgICAgICdzaG9ydGN1dHMnOiAn0JPQvtGA0Y/Rh9C40LUg0LrQu9Cw0LLQuNGI0LgnLFxyXG4gICAgICAgICAgICAnaGVscCc6ICfQn9C+0LzQvtGJ0YwnLFxyXG4gICAgICAgICAgICAnd2ViZm0nOiAn0KTQsNC50LvQvtCy0YvQuSDQvNC10L3QtdC00LbQtdGAINC00LvRjyB3ZWInLFxyXG4gICAgICAgICAgICAndmVyJzogJ9CS0LXRgNGB0LjRjycsXHJcbiAgICAgICAgICAgICdwcm90b2NvbHZlcic6ICfQstC10YDRgdC40Y8g0L/RgNC+0YLQvtC60L7Qu9CwJyxcclxuICAgICAgICAgICAgJ2hvbWVwYWdlJzogJ9Ch0LDQudGCINC/0YDQvtC10LrRgtCwJyxcclxuICAgICAgICAgICAgJ2RvY3MnOiAn0JTQvtC60YPQvNC10L3RgtCw0YbQuNGPJyxcclxuICAgICAgICAgICAgJ2dpdGh1Yic6ICdGb3JrIHVzIG9uIEdpdGh1YicsXHJcbiAgICAgICAgICAgICd0d2l0dGVyJzogJ0ZvbGxvdyB1cyBpbiB0d2l0dGVyJyxcclxuICAgICAgICAgICAgJ2ZhY2Vib29rJzogJ0pvaW4gdXMgb24gZmFjZWJvb2snLFxyXG4gICAgICAgICAgICAndGVhbSc6ICfQkNCy0YLQvtGA0YsnLFxyXG4gICAgICAgICAgICAnY2hpZWZkZXYnOiAn0LLQtdC00YPRidC40Lkg0YDQsNC30YDQsNCx0L7RgtGH0LjQuicsXHJcbiAgICAgICAgICAgICdkZXZlbG9wZXInOiAn0YDQsNC30YDQsNCx0L7RgtGH0LjQuicsXHJcbiAgICAgICAgICAgICdjb250cmlidXRvcic6ICfRg9GH0LDRgdGC0L3QuNC6JyxcclxuICAgICAgICAgICAgJ21haW50YWluZXInOiAn0YHQvtC/0YDQvtCy0L7QttC00LXQvdC40LUg0L/RgNC+0LXQutGC0LAnLFxyXG4gICAgICAgICAgICAndHJhbnNsYXRvcic6ICfQv9C10YDQtdCy0L7QtNGH0LjQuicsXHJcbiAgICAgICAgICAgICdpY29ucyc6ICfQmNC60L7QvdC60LgnLFxyXG4gICAgICAgICAgICAnZG9udGZvcmdldCc6ICfQuCDQvdC1INC30LDQsdGD0LTRjNGC0LUg0LLQt9GP0YLRjCDRgdCy0L7RkSDQv9C+0LvQvtGC0LXQvdGG0LUnLFxyXG4gICAgICAgICAgICAnc2hvcnRjdXRzb2YnOiAn0JPQvtGA0Y/Rh9C40LUg0LrQu9Cw0LLQuNGI0Lgg0L7RgtC60LvRjtGH0LXQvdGLJyxcclxuICAgICAgICAgICAgJ2Ryb3BGaWxlcyc6ICfQkdGA0L7RgdC40YLRjCDRhNCw0LnQu9GLJyxcclxuICAgICAgICAgICAgJ29yJzogJ9C40LvQuCcsXHJcbiAgICAgICAgICAgICdzZWxlY3RGb3JVcGxvYWQnOiAn0JLRi9Cx0YDQsNGC0Ywg0YTQsNC50LvRiyDQtNC70Y8g0LfQsNCz0YDRg9C30LrQuCcsXHJcbiAgICAgICAgICAgICdtb3ZlRmlsZXMnOiAn0JLQvdC40LzQsNC90LjQtSEnLFxyXG4gICAgICAgICAgICAnY29weUZpbGVzJzogJ9CS0L3QuNC80LDQvdC40LUhJyxcclxuICAgICAgICAgICAgJ3JtRnJvbVBsYWNlcyc6ICfQo9C00LDQu9C40YLRjCDQuNC3INC40LfQsdGA0LDQvdC90L7Qs9C+JyxcclxuICAgICAgICAgICAgJ3VudGl0bGVkIGZvbGRlcic6ICfQvdC+0LLQsNGPINC/0LDQv9C60LAnLFxyXG4gICAgICAgICAgICAndW50aXRsZWQgZmlsZS50eHQnOiAn0L3QvtCy0YvQuSDRhNCw0LnQuy50eHQnLFxyXG4gICAgICAgICAgICAnYXNwZWN0UmF0aW8nOiAn0KHQvtGF0YDQsNC90Y/RgtGMINC/0YDQvtC/0L7RgNGG0LjQuCcsXHJcbiAgICAgICAgICAgICdzY2FsZSc6ICfQnNCw0YHRiNGC0LDQsScsXHJcbiAgICAgICAgICAgICd3aWR0aCc6ICfQqNC40YDQuNC90LAnLFxyXG4gICAgICAgICAgICAnaGVpZ2h0JzogJ9CS0YvRgdC+0YLQsCcsXHJcbiAgICAgICAgICAgICdyZXNpemUnOiAn0KDQsNC30LzQtdGAJyxcclxuICAgICAgICAgICAgJ2Nyb3AnOiAn0JrQsNC00YDQuNGA0L7QstCw0YLRjCcsXHJcbiAgICAgICAgICAgICdyb3RhdGUnOiAn0J/QvtCy0L7RgNC+0YInLFxyXG4gICAgICAgICAgICAncm90YXRlLWN3JzogJ9Cf0L7QstC+0YDQvtGCINC90LAgOTAg0LPRgNCw0LTRg9GB0L7QsiDQv9C+INGH0LDRgdC+0LLQvtC5INGB0YLRgNC10LvQutC1JyxcclxuICAgICAgICAgICAgJ3JvdGF0ZS1jY3cnOiAn0J/QvtCy0L7RgNC+0YIg0L3QsCA5MCDQs9GA0LDQtNGD0YHQvtCyINC/0YDQvtGC0LjQsiDRh9Cw0YHQvtCy0L7QuSDRgdGC0YDQtdC70LrQtScsXHJcbiAgICAgICAgICAgICdkZWdyZWUnOiAnwrAnLFxyXG4gICAgICAgICAgICAnbmV0TW91bnREaWFsb2dUaXRsZSc6ICfQn9C+0LTQutC70Y7Rh9C40YLRjCDRgdC10YLQtdCy0L7QuSDQtNC40YHQuicsIC8vIGFkZGVkIDE4LjA0LjIwMTJcclxuICAgICAgICAgICAgJ3Byb3RvY29sJzogJ9Cf0YDQvtGC0L7QutC+0LsnLCAvLyBhZGRlZCAxOC4wNC4yMDEyXHJcbiAgICAgICAgICAgICdob3N0JzogJ9Cl0L7RgdGCJywgLy8gYWRkZWQgMTguMDQuMjAxMlxyXG4gICAgICAgICAgICAncG9ydCc6ICfQn9C+0YDRgicsIC8vIGFkZGVkIDE4LjA0LjIwMTJcclxuICAgICAgICAgICAgJ3VzZXInOiAn0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMJywgLy8gYWRkZWQgMTguMDQuMjAxMlxyXG4gICAgICAgICAgICAncGFzcyc6ICfQn9Cw0YDQvtC70YwnLCAvLyBhZGRlZCAxOC4wNC4yMDEyXHJcbiAgICAgICAgICAgICdhdHRlbnRpb25UaGVSZXN0cmljdGlvbic6ICfQktC90LjQvNCw0L3QuNC1IScsIC8vIGFkZGVkIDI4LjEwLjIwMTRcclxuICAgICAgICAgICAgJ25vTW9yZVRoaXJ0eUZpbGVzJzogJ9Ce0LTQvdC+0LLRgNC10LzQtdC90L3QviDQvNC+0LbQtdGCINCx0YvRgtGMINC+0YLQv9GA0LDQstC70LXQvdC+INC90LUg0LHQvtC70LXQtSAzMNGC0Lgg0YTQsNC50LvQvtCyJywgLy8gYWRkZWQgMjguMTAuMjAxNFxyXG5cclxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogbWltZXR5cGVzICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiAgICAgICAgICAgICdraW5kVW5rbm93bic6ICfQndC10LjQt9Cy0LXRgdGC0L3Ri9C5JyxcclxuICAgICAgICAgICAgJ2tpbmRGb2xkZXInOiAn0J/QsNC/0LrQsCcsXHJcbiAgICAgICAgICAgICdraW5kQWxpYXMnOiAn0KHRgdGL0LvQutCwJyxcclxuICAgICAgICAgICAgJ2tpbmRBbGlhc0Jyb2tlbic6ICfQkdC40YLQsNGPINGB0YHRi9C70LrQsCcsXHJcbiAgICAgICAgICAgIC8vIGFwcGxpY2F0aW9uc1xyXG4gICAgICAgICAgICAna2luZFNpZ24nOiAn0J/QvtC00L/QuNGB0LDQvdC90YvQuSDQtNC+0LrRg9C80LXQvdGCJyxcclxuICAgICAgICAgICAgJ2tpbmRDcnlwdCc6ICfQl9Cw0YjQuNGE0YDQvtCy0LDQvdC90YvQuSDQtNC+0LrRg9C80LXQvdGCJyxcclxuICAgICAgICAgICAgJ2tpbmRTaWduQ3J5cHQnOiAn0JfQsNGI0LjRhNGA0L7QstCw0L3QvdGL0Lkg0Lgg0L/QvtC00L/QuNGB0LDQvdC90YvQuSDQtNC+0LrRg9C80LXQvdGCJyxcclxuICAgICAgICAgICAgJ2tpbmRDZXJ0JzogJ9Ck0LDQudC7INGB0LXRgNGC0LjRhNC40LrQsNGC0LAnLFxyXG4gICAgICAgICAgICAna2luZEFwcCc6ICfQn9GA0LjQu9C+0LbQtdC90LjQtScsXHJcbiAgICAgICAgICAgICdraW5kUG9zdHNjcmlwdCc6ICfQlNC+0LrRg9C80LXQvdGCIFBvc3RzY3JpcHQnLFxyXG4gICAgICAgICAgICAna2luZE1zT2ZmaWNlJzogJ9CU0L7QutGD0LzQtdC90YIgTWljcm9zb2Z0IE9mZmljZScsXHJcbiAgICAgICAgICAgICdraW5kTXNXb3JkJzogJ9CU0L7QutGD0LzQtdC90YIgTWljcm9zb2Z0IFdvcmQnLFxyXG4gICAgICAgICAgICAvLydraW5kTXNFeGNlbCcgICAgIDogJ9CU0L7QutGD0LzQtdC90YIgTWljcm9zb2Z0IEV4Y2VsJyxcclxuICAgICAgICAgICAgJ2tpbmRNc0V4Y2VsJzogJ9Ce0YTQuNGB0L3Ri9C5INC00L7QutGD0LzQtdC90YInLFxyXG4gICAgICAgICAgICAvLydraW5kTXNQUCcgICAgICAgIDogJ9Cf0YDQtdC30LXQvdGC0LDRhtC40Y8gTWljcm9zb2Z0IFBvd2VycG9pbnQnLFxyXG4gICAgICAgICAgICAna2luZE1zUFAnOiAn0J7RhNC40YHQvdGL0Lkg0LTQvtC60YPQvNC10L3RgicsXHJcbiAgICAgICAgICAgIC8vJ2tpbmRPTycgICAgICAgICAgOiAn0JTQvtC60YPQvNC10L3RgiBPcGVuIE9mZmljZScsXHJcbiAgICAgICAgICAgICdraW5kT08nOiAn0J7RhNC40YHQvdGL0Lkg0LTQvtC60YPQvNC10L3RgicsXHJcbiAgICAgICAgICAgICdraW5kQXBwRmxhc2gnOiAn0J/RgNC40LvQvtC20LXQvdC40LUgRmxhc2gnLFxyXG4gICAgICAgICAgICAna2luZFBERic6ICfQlNC+0LrRg9C80LXQvdGCIFBERicsXHJcbiAgICAgICAgICAgICdraW5kVG9ycmVudCc6ICfQpNCw0LnQuyBCaXR0b3JyZW50JyxcclxuICAgICAgICAgICAgJ2tpbmQ3eic6ICfQkNGA0YXQuNCyIDd6JyxcclxuICAgICAgICAgICAgJ2tpbmRUQVInOiAn0JDRgNGF0LjQsiBUQVInLFxyXG4gICAgICAgICAgICAna2luZEdaSVAnOiAn0JDRgNGF0LjQsiBHWklQJyxcclxuICAgICAgICAgICAgJ2tpbmRCWklQJzogJ9CQ0YDRhdC40LIgQlpJUCcsXHJcbiAgICAgICAgICAgICdraW5kWklQJzogJ9CQ0YDRhdC40LIgWklQJyxcclxuICAgICAgICAgICAgJ2tpbmRSQVInOiAn0JDRgNGF0LjQsiBSQVInLFxyXG4gICAgICAgICAgICAna2luZEpBUic6ICfQpNCw0LnQuyBKYXZhIEpBUicsXHJcbiAgICAgICAgICAgICdraW5kVFRGJzogJ9Co0YDQuNGE0YIgVHJ1ZSBUeXBlJyxcclxuICAgICAgICAgICAgJ2tpbmRPVEYnOiAn0KjRgNC40YTRgiBPcGVuIFR5cGUnLFxyXG4gICAgICAgICAgICAna2luZFJQTSc6ICfQn9Cw0LrQtdGCIFJQTScsXHJcbiAgICAgICAgICAgICdraW5kYXJjaGl2ZSc6ICfQkNGA0YXQuNCyJyxcclxuICAgICAgICAgICAgLy8na2luZFNUVycgICAgICAgICA6ICfQotC10LrRgdGC0L7QstGL0Lkg0LTQvtC60YPQvNC10L3RgicsXHJcbiAgICAgICAgICAgICdraW5kU1RXJzogJ9Ce0YTQuNGB0L3Ri9C5INC00L7QutGD0LzQtdC90YInLFxyXG4gICAgICAgICAgICAvLyB0ZXh0c1xyXG4gICAgICAgICAgICAna2luZFRleHQnOiAn0KLQtdC60YHRgtC+0LLRi9C5INC00L7QutGD0LzQtdC90YInLFxyXG4gICAgICAgICAgICAna2luZFRleHRQbGFpbic6ICfQn9GA0L7RgdGC0L7QuSDRgtC10LrRgdGCJyxcclxuICAgICAgICAgICAgJ2tpbmRQSFAnOiAn0JjRgdGF0L7QtNC90LjQuiBQSFAnLFxyXG4gICAgICAgICAgICAna2luZENTUyc6ICfQotCw0LHQu9C40YbRiyDRgdGC0LjQu9C10LkgQ1NTJyxcclxuICAgICAgICAgICAgJ2tpbmRIVE1MJzogJ9CU0L7QutGD0LzQtdC90YIgSFRNTCcsXHJcbiAgICAgICAgICAgICdraW5kSlMnOiAn0JjRgdGF0L7QtNC90LjQuiBKYXZhc2NyaXB0JyxcclxuICAgICAgICAgICAgLy8na2luZFJURicgICAgICAgICA6ICdSaWNoIFRleHQgRm9ybWF0JyxcclxuICAgICAgICAgICAgJ2tpbmRSVEYnOiAn0J7RhNC40YHQvdGL0Lkg0LTQvtC60YPQvNC10L3RgicsXHJcbiAgICAgICAgICAgICdraW5kQyc6ICfQmNGB0YXQvtC00L3QuNC6IEMnLFxyXG4gICAgICAgICAgICAna2luZENIZWFkZXInOiAn0JfQsNCz0L7Qu9C+0LLQvtGH0L3Ri9C5INGE0LDQudC7IEMnLFxyXG4gICAgICAgICAgICAna2luZENQUCc6ICfQmNGB0YXQvtC00L3QuNC6IEMrKycsXHJcbiAgICAgICAgICAgICdraW5kQ1BQSGVhZGVyJzogJ9CX0LDQs9C+0LvQvtCy0L7Rh9C90YvQuSDRhNCw0LnQuyBDKysnLFxyXG4gICAgICAgICAgICAna2luZFNoZWxsJzogJ1VuaXggc2hlbGwgc2NyaXB0JyxcclxuICAgICAgICAgICAgJ2tpbmRQeXRob24nOiAn0JjRgdGF0L7QtNC90LjQuiBQeXRob24nLFxyXG4gICAgICAgICAgICAna2luZEphdmEnOiAn0JjRgdGF0L7QtNC90LjQuiBKYXZhJyxcclxuICAgICAgICAgICAgJ2tpbmRSdWJ5JzogJ9CY0YHRhdC+0LTQvdC40LogUnVieScsXHJcbiAgICAgICAgICAgICdraW5kUGVybCc6ICfQmNGB0YXQvtC00L3QuNC6IFBlcmwnLFxyXG4gICAgICAgICAgICAna2luZFNRTCc6ICfQmNGB0YXQvtC00L3QuNC6IFNRTCcsXHJcbiAgICAgICAgICAgICdraW5kWE1MJzogJ9CU0L7QutGD0LzQtdC90YIgWE1MJyxcclxuICAgICAgICAgICAgJ2tpbmRBV0snOiAn0JjRgdGF0L7QtNC90LjQuiBBV0snLFxyXG4gICAgICAgICAgICAna2luZENTVic6ICfQotC10LrRgdGCINGBINGA0LDQt9C00LXQu9C40YLQtdC70Y/QvNC4JyxcclxuICAgICAgICAgICAgJ2tpbmRET0NCT09LJzogJ9CU0L7QutGD0LzQtdC90YIgRG9jYm9vayBYTUwnLFxyXG4gICAgICAgICAgICAvLyBpbWFnZXNcclxuICAgICAgICAgICAgJ2tpbmRJbWFnZSc6ICfQmNC30L7QsdGA0LDQttC10L3QuNC1JyxcclxuICAgICAgICAgICAgJ2tpbmRCTVAnOiAn0JjQt9C+0LHRgNCw0LbQtdC90LjQtSBCTVAnLFxyXG4gICAgICAgICAgICAna2luZEpQRUcnOiAn0JjQt9C+0LHRgNCw0LbQtdC90LjQtSBKUEVHJyxcclxuICAgICAgICAgICAgJ2tpbmRHSUYnOiAn0JjQt9C+0LHRgNCw0LbQtdC90LjQtSBHSUYnLFxyXG4gICAgICAgICAgICAna2luZFBORyc6ICfQmNC30L7QsdGA0LDQttC10L3QuNC1IFBORycsXHJcbiAgICAgICAgICAgICdraW5kVElGRic6ICfQmNC30L7QsdGA0LDQttC10L3QuNC1IFRJRkYnLFxyXG4gICAgICAgICAgICAna2luZFRHQSc6ICfQmNC30L7QsdGA0LDQttC10L3QuNC1IFRHQScsXHJcbiAgICAgICAgICAgICdraW5kUFNEJzogJ9CY0LfQvtCx0YDQsNC20LXQvdC40LUgQWRvYmUgUGhvdG9zaG9wJyxcclxuICAgICAgICAgICAgJ2tpbmRYQklUTUFQJzogJ9CY0LfQvtCx0YDQsNC20LXQvdC40LUgWCBiaXRtYXAnLFxyXG4gICAgICAgICAgICAna2luZFBYTSc6ICfQmNC30L7QsdGA0LDQttC10L3QuNC1IFBpeGVsbWF0b3InLFxyXG4gICAgICAgICAgICAna2luZElDT04nOiAn0JjQt9C+0LHRgNCw0LbQtdC90LjQtSBJQ09OJyxcclxuICAgICAgICAgICAgJ2tpbmRDUjInOiAn0JjQt9C+0LHRgNCw0LbQtdC90LjQtSBDUjInLFxyXG4gICAgICAgICAgICAna2luZFBJQyc6ICfQmNC30L7QsdGA0LDQttC10L3QuNC1IFBJQycsXHJcbiAgICAgICAgICAgICdraW5kQ0RSJzogJ9CY0LfQvtCx0YDQsNC20LXQvdC40LUgQ0RSJyxcclxuICAgICAgICAgICAgLy8gbWVkaWFcclxuICAgICAgICAgICAgJ2tpbmRBdWRpbyc6ICfQkNGD0LTQuNC+INGE0LDQudC7JyxcclxuICAgICAgICAgICAgJ2tpbmRBdWRpb01QRUcnOiAn0JDRg9C00LjQviBNUEVHJyxcclxuICAgICAgICAgICAgJ2tpbmRBdWRpb01QRUc0JzogJ9CQ0YPQtNC40L4gTVBFRy00JyxcclxuICAgICAgICAgICAgJ2tpbmRBdWRpb01JREknOiAn0JDRg9C00LjQviBNSURJJyxcclxuICAgICAgICAgICAgJ2tpbmRBdWRpb09HRyc6ICfQkNGD0LTQuNC+IE9nZyBWb3JiaXMnLFxyXG4gICAgICAgICAgICAna2luZEF1ZGlvV0FWJzogJ9CQ0YPQtNC40L4gV0FWJyxcclxuICAgICAgICAgICAgJ2tpbmRXQVZFJzogJ9CQ0YPQtNC40L4gV0FWRScsXHJcbiAgICAgICAgICAgICdraW5kTTRSJzogJ9CQ0YPQtNC40L4gTTRSJyxcclxuICAgICAgICAgICAgJ2tpbmRBQUMnOiAn0JDRg9C00LjQviBBQUMnLFxyXG4gICAgICAgICAgICAna2luZFdNQSc6ICfQkNGD0LTQuNC+IFdNQScsXHJcbiAgICAgICAgICAgICdraW5kTVAyJzogJ9CQ0YPQtNC40L4gTVAyJyxcclxuICAgICAgICAgICAgJ2tpbmRETFMnOiAn0JDRg9C00LjQviBETFMnLFxyXG4gICAgICAgICAgICAna2luZE00Qic6ICfQkNGD0LTQuNC+IE00QicsXHJcbiAgICAgICAgICAgICdraW5kV0FWJzogJ9CQ0YPQtNC40L4gV0FWJyxcclxuICAgICAgICAgICAgJ2tpbmRNUDEnOiAn0JDRg9C00LjQviBNUDEnLFxyXG4gICAgICAgICAgICAnQXVkaW9QbGF5bGlzdCc6ICfQn9C70LXQudC70LjRgdGCIE1QMycsXHJcbiAgICAgICAgICAgICdraW5kVmlkZW8nOiAn0JLQuNC00LXQviDRhNCw0LnQuycsXHJcbiAgICAgICAgICAgICdraW5kRmxhc2hWaWRlbyc6ICfQktC40LTQtdC+IEZMVicsXHJcbiAgICAgICAgICAgICdraW5kM0dQJzogJ9CS0LjQtNC10L4gM0dQJyxcclxuICAgICAgICAgICAgJ2tpbmRNUDQnOiAn0JLQuNC00LXQviBNUDQnLFxyXG4gICAgICAgICAgICAna2luZEFTRic6ICfQktC40LTQtdC+IEFTRicsXHJcbiAgICAgICAgICAgICdraW5kQU1WJzogJ9CS0LjQtNC10L4gQU1WJyxcclxuICAgICAgICAgICAgJ2tpbmRBQUYnOiAn0JLQuNC00LXQviBBQUYnLFxyXG4gICAgICAgICAgICAna2luZE1QRUc0JzogJ9CS0LjQtNC10L4gTVBFRzQnLFxyXG4gICAgICAgICAgICAna2luZFhWSUQnOiAn0JLQuNC00LXQviBYVklEJyxcclxuICAgICAgICAgICAgJ2tpbmRWaWRlb0RWJzogJ9CS0LjQtNC10L4gRFYnLFxyXG4gICAgICAgICAgICAna2luZFZpZGVvTVBFRyc6ICfQktC40LTQtdC+IE1QRUcnLFxyXG4gICAgICAgICAgICAna2luZFZpZGVvTVBFRzQnOiAn0JLQuNC00LXQviBNUEVHLTQnLFxyXG4gICAgICAgICAgICAna2luZFZpZGVvQVZJJzogJ9CS0LjQtNC10L4gQVZJJyxcclxuICAgICAgICAgICAgJ2tpbmRWaWRlb01PVic6ICfQktC40LTQtdC+IFF1aWNrIFRpbWUnLFxyXG4gICAgICAgICAgICAna2luZFZpZGVvV00nOiAn0JLQuNC00LXQviBXaW5kb3dzIE1lZGlhJyxcclxuICAgICAgICAgICAgJ2tpbmRWaWRlb0ZsYXNoJzogJ9CS0LjQtNC10L4gRmxhc2gnLFxyXG4gICAgICAgICAgICAna2luZFZpZGVvTUtWJzogJ9CS0LjQtNC10L4gTWF0cm9za2EnLFxyXG4gICAgICAgICAgICAna2luZFZpZGVvT0dHJzogJ9CS0LjQtNC10L4gT2dnJyxcclxuICAgICAgICAgICAgJ3ZvbHVtZV9maWxlcyc6ICfQpNCw0LnQu9GLICdcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxuICogZWxGaW5kZXIgdHJhbnNwb3J0IHRvIHN1cHBvcnQgb2xkIHByb3RvY29sLlxuICpcbiAqIEBleGFtcGxlXG4gKiAkKCdzZWxlY3RvcicpLmVsZmluZGVyKHtcbiAqICAgLi4uLiBcbiAqICAgdHJhbnNwb3J0IDogbmV3IGVsRmluZGVyU3VwcG9ydFZlcjEoKVxuICogfSlcbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG53aW5kb3cuZWxGaW5kZXJTdXBwb3J0VmVyMSA9IGZ1bmN0aW9uKHVwbG9hZCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIHRoaXMudXBsb2FkID0gdXBsb2FkIHx8ICdhdXRvJztcclxuXHJcbiAgICB0aGlzLmluaXQgPSBmdW5jdGlvbihmbSkge1xyXG4gICAgICAgIHRoaXMuZm0gPSBmbTtcclxuICAgICAgICB0aGlzLmZtLnBhcnNlVXBsb2FkRGF0YSA9IGZ1bmN0aW9uKHRleHQpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGE7XHJcblxyXG4gICAgICAgICAgICBpZiAoISQudHJpbSh0ZXh0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgZXJyb3I6IFsnZXJyUmVzcG9uc2UnLCAnZXJyRGF0YUVtcHR5J10gfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGRhdGEgPSAkLnBhcnNlSlNPTih0ZXh0KTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgZXJyb3I6IFsnZXJyUmVzcG9uc2UnLCAnZXJyRGF0YU5vdEpTT04nXSB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc2VsZi5ub3JtYWxpemUoJ3VwbG9hZCcsIGRhdGEpO1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZW5kID0gZnVuY3Rpb24ob3B0cykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBkZnJkID0gJC5EZWZlcnJlZCgpLFxyXG4gICAgICAgICAgICBjbWQgPSBvcHRzLmRhdGEuY21kLFxyXG4gICAgICAgICAgICBhcmdzID0gW10sXHJcbiAgICAgICAgICAgIF9vcHRzID0ge30sXHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIHhocjtcclxuXHJcbiAgICAgICAgZGZyZC5hYm9ydCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB4aHIuc3RhdGUoKSA9PSAncGVuZGluZycgJiYgeGhyLmFib3J0KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBzd2l0Y2ggKGNtZCkge1xyXG4gICAgICAgIGNhc2UgJ29wZW4nOlxyXG4gICAgICAgICAgICBvcHRzLmRhdGEudHJlZSA9IDE7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3BhcmVudHMnOlxyXG4gICAgICAgIGNhc2UgJ3RyZWUnOlxyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZXNvbHZlKHsgdHJlZTogW10gfSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2dldCc6XHJcbiAgICAgICAgICAgIG9wdHMuZGF0YS5jbWQgPSAncmVhZCc7XHJcbiAgICAgICAgICAgIG9wdHMuZGF0YS5jdXJyZW50ID0gZm0uZmlsZShvcHRzLmRhdGEudGFyZ2V0KS5waGFzaDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncHV0JzpcclxuICAgICAgICAgICAgb3B0cy5kYXRhLmNtZCA9ICdlZGl0JztcclxuICAgICAgICAgICAgb3B0cy5kYXRhLmN1cnJlbnQgPSBmbS5maWxlKG9wdHMuZGF0YS50YXJnZXQpLnBoYXNoO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdhcmNoaXZlJzpcclxuICAgICAgICBjYXNlICdybSc6XHJcbiAgICAgICAgICAgIG9wdHMuZGF0YS5jdXJyZW50ID0gZm0uZmlsZShvcHRzLmRhdGEudGFyZ2V0c1swXSkucGhhc2g7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2V4dHJhY3QnOlxyXG4gICAgICAgIGNhc2UgJ3JlbmFtZSc6XHJcbiAgICAgICAgY2FzZSAncmVzaXplJzpcclxuICAgICAgICAgICAgb3B0cy5kYXRhLmN1cnJlbnQgPSBmbS5maWxlKG9wdHMuZGF0YS50YXJnZXQpLnBoYXNoO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdkdXBsaWNhdGUnOlxyXG4gICAgICAgICAgICBfb3B0cyA9ICQuZXh0ZW5kKHRydWUsIHt9LCBvcHRzKTtcclxuXHJcbiAgICAgICAgICAgICQuZWFjaChvcHRzLmRhdGEudGFyZ2V0cywgZnVuY3Rpb24oaSwgaGFzaCkge1xyXG4gICAgICAgICAgICAgICAgJC5hamF4KCQuZXh0ZW5kKF9vcHRzLCB7IGRhdGE6IHsgY21kOiAnZHVwbGljYXRlJywgdGFyZ2V0OiBoYXNoLCBjdXJyZW50OiBmbS5maWxlKGhhc2gpLnBoYXNoIH0gfSkpXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZtLmVycm9yKGZtLnJlcygnZXJyb3InLCAnY29ubmVjdCcpKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHNlbGYubm9ybWFsaXplKCdkdXBsaWNhdGUnLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZtLmVycm9yKGRhdGEuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuYWRkZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZtLnRyaWdnZXIoJ2FkZCcsIHsgYWRkZWQ6IGRhdGEuYWRkZWQgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlc29sdmUoe30pO1xyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgY2FzZSAnbWtkaXInOlxyXG4gICAgICAgIGNhc2UgJ21rZmlsZSc6XHJcbiAgICAgICAgICAgIG9wdHMuZGF0YS5jdXJyZW50ID0gb3B0cy5kYXRhLnRhcmdldDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAncGFzdGUnOlxyXG4gICAgICAgICAgICBvcHRzLmRhdGEuY3VycmVudCA9IG9wdHMuZGF0YS5kc3Q7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlICdzaXplJzpcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVzb2x2ZSh7IGVycm9yOiBmbS5yZXMoJ2Vycm9yJywgJ2NtZHN1cHBvcnQnKSB9KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnc2VhcmNoJzpcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVzb2x2ZSh7IGVycm9yOiBmbS5yZXMoJ2Vycm9yJywgJ2NtZHN1cHBvcnQnKSB9KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjbWQgPSBvcHRzLmRhdGEuY21kXHJcblxyXG4gICAgICAgIHhociA9ICQuYWpheChvcHRzKVxyXG4gICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZG9uZShmdW5jdGlvbihyYXcpIHtcclxuICAgICAgICAgICAgICAgIGRhdGEgPSBzZWxmLm5vcm1hbGl6ZShjbWQsIHJhdyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gY21kICE9ICdvcGVuJyAmJiBzZWxmLmZtLmxvZyhkYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY21kID09ICdwYXN0ZScgJiYgIWRhdGEuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbS5zeW5jKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGZyZC5yZXNvbHZlKHt9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGZyZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZGZyZDtcclxuXHJcbiAgICAgICAgcmV0dXJuICQuYWpheChvcHRzKTtcclxuICAgIH07IC8vIGZpeCBvbGQgY29ubmVjdG9ycyBlcnJvcnMgbWVzc2FnZXMgYXMgcG9zc2libGVcclxuICAgIC8vIHRoaXMuZXJyb3JzID0ge1xyXG4gICAgLy8gXHQnVW5rbm93biBjb21tYW5kJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdVbmtub3duIGNvbW1hbmQuJyxcclxuICAgIC8vIFx0J0ludmFsaWQgYmFja2VuZCBjb25maWd1cmF0aW9uJyAgICAgICAgICAgICAgICAgICAgOiAnSW52YWxpZCBiYWNrZW5kIGNvbmZpZ3VyYXRpb24uJyxcclxuICAgIC8vIFx0J0FjY2VzcyBkZW5pZWQnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnQWNjZXNzIGRlbmllZC4nLFxyXG4gICAgLy8gXHQnUEhQIEpTT04gbW9kdWxlIG5vdCBpbnN0YWxsZWQnICAgICAgICAgICAgICAgICAgICA6ICdQSFAgSlNPTiBtb2R1bGUgbm90IGluc3RhbGxlZC4nLFxyXG4gICAgLy8gXHQnRmlsZSBub3QgZm91bmQnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdGaWxlIG5vdCBmb3VuZC4nLFxyXG4gICAgLy8gXHQnSW52YWxpZCBuYW1lJyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdJbnZhbGlkIGZpbGUgbmFtZS4nLFxyXG4gICAgLy8gXHQnRmlsZSBvciBmb2xkZXIgd2l0aCB0aGUgc2FtZSBuYW1lIGFscmVhZHkgZXhpc3RzJyA6ICdGaWxlIG5hbWVkIFwiJDFcIiBhbHJlYWR5IGV4aXN0cyBpbiB0aGlzIGxvY2F0aW9uLicsXHJcbiAgICAvLyBcdCdOb3QgYWxsb3dlZCBmaWxlIHR5cGUnICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogJ05vdCBhbGxvd2VkIGZpbGUgdHlwZS4nLFxyXG4gICAgLy8gXHQnRmlsZSBleGNlZWRzIHRoZSBtYXhpbXVtIGFsbG93ZWQgZmlsZXNpemUnICAgICAgICA6ICdGaWxlIGV4Y2VlZHMgbWF4aW11bSBhbGxvd2VkIHNpemUuJyxcclxuICAgIC8vIFx0J1VuYWJsZSB0byBjb3B5IGludG8gaXRzZWxmJyAgICAgICAgICAgICAgICAgICAgICAgOiAnVW5hYmxlIHRvIGNvcHkgXCIkMVwiIGludG8gaXRzZWxmLicsXHJcbiAgICAvLyBcdCdVbmFibGUgdG8gY3JlYXRlIGFyY2hpdmUnICAgICAgICAgICAgICAgICAgICAgICAgIDogJ1VuYWJsZSB0byBjcmVhdGUgYXJjaGl2ZS4nLFxyXG4gICAgLy8gXHQnVW5hYmxlIHRvIGV4dHJhY3QgZmlsZXMgZnJvbSBhcmNoaXZlJyAgICAgICAgICAgICA6ICdVbmFibGUgdG8gZXh0cmFjdCBmaWxlcyBmcm9tIFwiJDFcIi4nXHJcbiAgICAvLyB9XHJcblxyXG4gICAgdGhpcy5ub3JtYWxpemUgPSBmdW5jdGlvbihjbWQsIGRhdGEpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXMsXHJcbiAgICAgICAgICAgIGZpbGVzID0ge30sXHJcbiAgICAgICAgICAgIGZpbHRlciA9IGZ1bmN0aW9uKGZpbGUpIHsgcmV0dXJuIGZpbGUgJiYgZmlsZS5oYXNoICYmIGZpbGUubmFtZSAmJiBmaWxlLm1pbWUgPyBmaWxlIDogbnVsbDsgfSxcclxuICAgICAgICAgICAgcGhhc2g7XHJcblxyXG4gICAgICAgIGlmICgoY21kID09ICd0bWInIHx8IGNtZCA9PSAnZ2V0JykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBpZiAoZGF0YS5lcnJvcikge1xyXG4gICAgICAgIC8vIFx0JC5lYWNoKGRhdGEuZXJyb3IsIGZ1bmN0aW9uKGksIG1zZykge1xyXG4gICAgICAgIC8vIFx0XHRpZiAoc2VsZi5lcnJvcnNbbXNnXSkge1xyXG4gICAgICAgIC8vIFx0XHRcdGRhdGEuZXJyb3JbaV0gPSBzZWxmLmVycm9yc1ttc2ddO1xyXG4gICAgICAgIC8vIFx0XHR9XHJcbiAgICAgICAgLy8gXHR9KTtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIGlmIChjbWQgPT0gJ3VwbG9hZCcgJiYgZGF0YS5lcnJvciAmJiBkYXRhLmN3ZCkge1xyXG4gICAgICAgICAgICBkYXRhLndhcm5pbmcgPSAkLmV4dGVuZCh7fSwgZGF0YS5lcnJvcik7XHJcbiAgICAgICAgICAgIGRhdGEuZXJyb3IgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAoZGF0YS5lcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjbWQgPT0gJ3B1dCcpIHtcclxuXHJcbiAgICAgICAgICAgIHBoYXNoID0gdGhpcy5mbS5maWxlKGRhdGEudGFyZ2V0Lmhhc2gpLnBoYXNoO1xyXG4gICAgICAgICAgICByZXR1cm4geyBjaGFuZ2VkOiBbdGhpcy5ub3JtYWxpemVGaWxlKGRhdGEudGFyZ2V0LCBwaGFzaCldIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwaGFzaCA9IGRhdGEuY3dkLmhhc2g7XHJcblxyXG4gICAgICAgIGlmIChkYXRhLnRyZWUpIHtcclxuICAgICAgICAgICAgJC5lYWNoKHRoaXMubm9ybWFsaXplVHJlZShkYXRhLnRyZWUpLCBmdW5jdGlvbihpLCBmaWxlKSB7XHJcbiAgICAgICAgICAgICAgICBmaWxlc1tmaWxlLmhhc2hdID0gZmlsZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkLmVhY2goZGF0YS5jZGMgfHwgW10sIGZ1bmN0aW9uKGksIGZpbGUpIHtcclxuICAgICAgICAgICAgdmFyIGhhc2ggPSBmaWxlLmhhc2g7XHJcblxyXG4gICAgICAgICAgICBpZiAoZmlsZXNbaGFzaF0pIHtcclxuICAgICAgICAgICAgICAgIGZpbGVzW2hhc2hdLmRhdGUgPSBmaWxlLmRhdGU7XHJcbiAgICAgICAgICAgICAgICBmaWxlc1toYXNoXS5sb2NrZWQgPSBmaWxlLmhhc2ggPT0gcGhhc2ggPyB0cnVlIDogZmlsZS5ybSA9PT0gdm9pZCgwKSA/IGZhbHNlIDogIWZpbGUucm07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmaWxlc1toYXNoXSA9IHNlbGYubm9ybWFsaXplRmlsZShmaWxlLCBwaGFzaCwgZGF0YS50bWIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghZGF0YS50cmVlKSB7XHJcbiAgICAgICAgICAgICQuZWFjaCh0aGlzLmZtLmZpbGVzKCksIGZ1bmN0aW9uKGhhc2gsIGZpbGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghZmlsZXNbaGFzaF0gJiYgZmlsZS5waGFzaCAhPSBwaGFzaCAmJiBmaWxlLm1pbWUgPT0gJ2RpcmVjdG9yeScpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWxlc1toYXNoXSA9IGZpbGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNtZCA9PSAnb3BlbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGN3ZDogZmlsZXNbcGhhc2hdIHx8IHRoaXMubm9ybWFsaXplRmlsZShkYXRhLmN3ZCksXHJcbiAgICAgICAgICAgICAgICBmaWxlczogJC5tYXAoZmlsZXMsIGZ1bmN0aW9uKGYpIHsgcmV0dXJuIGY7IH0pLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczogc2VsZi5ub3JtYWxpemVPcHRpb25zKGRhdGEpLFxyXG4gICAgICAgICAgICAgICAgaW5pdDogISFkYXRhLnBhcmFtcyxcclxuICAgICAgICAgICAgICAgIGRlYnVnOiBkYXRhLmRlYnVnXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgcmV0dXJuICQuZXh0ZW5kKHtcclxuICAgICAgICAgICAgY3VycmVudDogZGF0YS5jd2QuaGFzaCxcclxuICAgICAgICAgICAgZXJyb3I6IGRhdGEuZXJyb3IsXHJcbiAgICAgICAgICAgIHdhcm5pbmc6IGRhdGEud2FybmluZyxcclxuICAgICAgICAgICAgb3B0aW9uczogeyB0bWI6ICEhZGF0YS50bWIgfVxyXG4gICAgICAgIH0sIHRoaXMuZm0uZGlmZigkLm1hcChmaWxlcywgZmlsdGVyKSkpO1xyXG5cclxuICAgIH07IC8qKlxuXHQgKiBDb252ZXJ0IG9sZCBhcGkgdHJlZSBpbnRvIHBsYWluIGFycmF5IG9mIGRpcnNcblx0ICpcblx0ICogQHBhcmFtICBPYmplY3QgIHJvb3QgZGlyXG5cdCAqIEByZXR1cm4gQXJyYXlcblx0ICovXHJcbiAgICB0aGlzLm5vcm1hbGl6ZVRyZWUgPSBmdW5jdGlvbihyb290KSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxyXG4gICAgICAgICAgICByZXN1bHQgPSBbXSxcclxuICAgICAgICAgICAgdHJhdmVyc2UgPSBmdW5jdGlvbihkaXJzLCBwaGFzaCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGksIGRpcjtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZGlycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpciA9IGRpcnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goc2VsZi5ub3JtYWxpemVGaWxlKGRpciwgcGhhc2gpKTtcclxuICAgICAgICAgICAgICAgICAgICBkaXIuZGlycy5sZW5ndGggJiYgdHJhdmVyc2UoZGlyLmRpcnMsIGRpci5oYXNoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdHJhdmVyc2UoW3Jvb3RdKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07IC8qKlxuXHQgKiBDb252ZXJ0IGZpbGUgaW5mbyBmcm9tIG9sZCBhcGkgZm9ybWF0IGludG8gbmV3IG9uZVxuXHQgKlxuXHQgKiBAcGFyYW0gIE9iamVjdCAgZmlsZVxuXHQgKiBAcGFyYW0gIFN0cmluZyAgcGFyZW50IGRpciBoYXNoXG5cdCAqIEByZXR1cm4gT2JqZWN0XG5cdCAqL1xyXG4gICAgdGhpcy5ub3JtYWxpemVGaWxlID0gZnVuY3Rpb24oZmlsZSwgcGhhc2gsIHRtYikge1xyXG4gICAgICAgIHZhciBtaW1lID0gZmlsZS5taW1lIHx8ICdkaXJlY3RvcnknLFxyXG4gICAgICAgICAgICBzaXplID0gbWltZSA9PSAnZGlyZWN0b3J5JyAmJiAhZmlsZS5saW5rVG8gPyAwIDogZmlsZS5zaXplLFxyXG4gICAgICAgICAgICBpbmZvID0ge1xyXG4gICAgICAgICAgICAgICAgdXJsOiBmaWxlLnVybCxcclxuICAgICAgICAgICAgICAgIGhhc2g6IGZpbGUuaGFzaCxcclxuICAgICAgICAgICAgICAgIHBoYXNoOiBwaGFzaCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGZpbGUubmFtZSxcclxuICAgICAgICAgICAgICAgIG1pbWU6IG1pbWUsXHJcbiAgICAgICAgICAgICAgICBkYXRlOiBmaWxlLmRhdGUgfHwgJ3Vua25vd24nLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogc2l6ZSxcclxuICAgICAgICAgICAgICAgIHJlYWQ6IGZpbGUucmVhZCxcclxuICAgICAgICAgICAgICAgIHdyaXRlOiBmaWxlLndyaXRlLFxyXG4gICAgICAgICAgICAgICAgbG9ja2VkOiAhcGhhc2ggPyB0cnVlIDogZmlsZS5ybSA9PT0gdm9pZCgwKSA/IGZhbHNlIDogIWZpbGUucm1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKGZpbGUubWltZSA9PSAnYXBwbGljYXRpb24veC1lbXB0eScpIHtcclxuICAgICAgICAgICAgaW5mby5taW1lID0gJ3RleHQvcGxhaW4nO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZmlsZS5saW5rVG8pIHtcclxuICAgICAgICAgICAgaW5mby5hbGlhcyA9IGZpbGUubGlua1RvO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGZpbGUubGlua1RvKSB7XHJcbiAgICAgICAgICAgIGluZm8ubGlua1RvID0gZmlsZS5saW5rVG87XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZmlsZS50bWIpIHtcclxuICAgICAgICAgICAgaW5mby50bWIgPSBmaWxlLnRtYjtcclxuICAgICAgICB9IGVsc2UgaWYgKGluZm8ubWltZS5pbmRleE9mKCdpbWFnZS8nKSA9PT0gMCAmJiB0bWIpIHtcclxuICAgICAgICAgICAgaW5mby50bWIgPSAxO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChmaWxlLmRpcnMgJiYgZmlsZS5kaXJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpbmZvLmRpcnMgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZmlsZS5kaW0pIHtcclxuICAgICAgICAgICAgaW5mby5kaW0gPSBmaWxlLmRpbTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZpbGUucmVzaXplKSB7XHJcbiAgICAgICAgICAgIGluZm8ucmVzaXplID0gZmlsZS5yZXNpemU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbmZvO1xyXG4gICAgfTtcclxuICAgIHRoaXMubm9ybWFsaXplT3B0aW9ucyA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICB2YXIgb3B0cyA9IHtcclxuICAgICAgICAgICAgcGF0aDogZGF0YS5jd2QucmVsLFxyXG4gICAgICAgICAgICBkaXNhYmxlZDogZGF0YS5kaXNhYmxlZCB8fCBbXSxcclxuICAgICAgICAgICAgdG1iOiAhIWRhdGEudG1iLFxyXG4gICAgICAgICAgICBjb3B5T3ZlcndyaXRlOiB0cnVlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKGRhdGEucGFyYW1zKSB7XHJcbiAgICAgICAgICAgIG9wdHMuYXBpID0gMTtcclxuICAgICAgICAgICAgb3B0cy51cmwgPSBkYXRhLnBhcmFtcy51cmw7XHJcbiAgICAgICAgICAgIG9wdHMuYXJjaGl2ZXJzID0ge1xyXG4gICAgICAgICAgICAgICAgY3JlYXRlOiBkYXRhLnBhcmFtcy5hcmNoaXZlcyB8fCBbXSxcclxuICAgICAgICAgICAgICAgIGV4dHJhY3Q6IGRhdGEucGFyYW1zLmV4dHJhY3QgfHwgW11cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvcHRzLnBhdGguaW5kZXhPZignLycpICE9PSAtMSkge1xyXG4gICAgICAgICAgICBvcHRzLnNlcGFyYXRvciA9ICcvJztcclxuICAgICAgICB9IGVsc2UgaWYgKG9wdHMucGF0aC5pbmRleE9mKCdcXFxcJykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIG9wdHMuc2VwYXJhdG9yID0gJ1xcXFwnO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb3B0cztcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxuICogQGNsYXNzIGRpYWxvZ2VsZmluZGVyIC0gb3BlbiBlbEZpbmRlciBpbiBkaWFsb2cgd2luZG93XG4gKlxuICogQHBhcmFtICBPYmplY3QgIGVsRmluZGVyIG9wdGlvbnMgd2l0aCBkaWFsb2cgb3B0aW9uc1xuICogQGV4YW1wbGVcbiAqICQoc2VsZWN0b3IpLmRpYWxvZ2VsZmluZGVyKHtcbiAqICAgICAvLyBzb21lIGVsZmluZGVyIG9wdGlvbnNcbiAqICAgICB0aXRsZSAgICAgICAgICA6ICdNeSBmaWxlcycsIC8vIGRpYWxvZyB0aXRsZSwgZGVmYXVsdCA9IFwiRmlsZXNcIlxuICogICAgIHdpZHRoICAgICAgICAgIDogODUwLCAgICAgICAgLy8gZGlhbG9nIHdpZHRoLCBkZWZhdWx0IDg0MFxuICogICAgIGF1dG9PcGVuICAgICAgIDogZmFsc2UsICAgICAgLy8gaWYgZmFsc2UgLSBkaWFsb2cgd2lsbCBub3QgYmUgb3BlbmVkIGFmdGVyIGluaXQsIGRlZmF1bHQgPSB0cnVlXG4gKiAgICAgZGVzdHJveU9uQ2xvc2UgOiB0cnVlICAgICAgICAvLyBkZXN0cm95IGVsRmluZGVyIG9uIGNsb3NlIGRpYWxvZywgZGVmYXVsdCA9IGZhbHNlXG4gKiB9KVxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqKi9cclxuJC5mbi5kaWFsb2dlbGZpbmRlciA9IGZ1bmN0aW9uKG9wdHMpIHtcclxuICAgIHZhciBwb3NpdGlvbiA9ICdlbGZpbmRlclBvc2l0aW9uJyxcclxuICAgICAgICBkZXN0cm95ID0gJ2VsZmluZGVyRGVzdHJveU9uQ2xvc2UnO1xyXG5cclxuICAgIHRoaXMubm90KCcuZWxmaW5kZXInKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cclxuXHJcbiAgICAgICAgdmFyIGRvYyA9ICQoZG9jdW1lbnQpLFxyXG4gICAgICAgICAgICB0b29sYmFyID0gJCgnPGRpdiBjbGFzcz1cInVpLXdpZGdldC1oZWFkZXIgZGlhbG9nZWxmaW5kZXItZHJhZyB1aS1jb3JuZXItdG9wXCI+JyArIChvcHRzLnRpdGxlIHx8ICdGaWxlcycpICsgJzwvZGl2PicpLFxyXG4gICAgICAgICAgICBidXR0b24gPSAkKCc8YSBocmVmPVwiI1wiIGNsYXNzPVwiZGlhbG9nZWxmaW5kZXItZHJhZy1jbG9zZSB1aS1jb3JuZXItYWxsXCI+PHNwYW4gY2xhc3M9XCJ1aS1pY29uIHVpLWljb24tY2xvc2V0aGlja1wiLz48L2E+JylcclxuICAgICAgICAgICAgICAgIC5hcHBlbmRUbyh0b29sYmFyKVxyXG4gICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUuZGlhbG9nZWxmaW5kZXIoJ2Nsb3NlJyk7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgbm9kZSA9ICQodGhpcykuYWRkQ2xhc3MoJ2RpYWxvZ2VsZmluZGVyJylcclxuICAgICAgICAgICAgICAgIC5jc3MoJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJylcclxuICAgICAgICAgICAgICAgIC5oaWRlKClcclxuICAgICAgICAgICAgICAgIC5hcHBlbmRUbygnYm9keScpXHJcbiAgICAgICAgICAgICAgICAuZHJhZ2dhYmxlKHtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICcuZGlhbG9nZWxmaW5kZXItZHJhZycsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbm1lbnQ6ICd3aW5kb3cnXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmVsZmluZGVyKG9wdHMpXHJcbiAgICAgICAgICAgICAgICAucHJlcGVuZCh0b29sYmFyKSxcclxuICAgICAgICAgICAgZWxmaW5kZXIgPSBub2RlLmVsZmluZGVyKCdpbnN0YW5jZScpO1xyXG5cclxuXHJcbiAgICAgICAgbm9kZS53aWR0aChwYXJzZUludChub2RlLndpZHRoKCkpIHx8IDg0MCkgLy8gZml4IHdpZHRoIGlmIHNldCB0byBcImF1dG9cIlxyXG4gICAgICAgICAgICAuZGF0YShkZXN0cm95LCAhIW9wdHMuZGVzdHJveU9uQ2xvc2UpXHJcbiAgICAgICAgICAgIC5maW5kKCcuZWxmaW5kZXItdG9vbGJhcicpLnJlbW92ZUNsYXNzKCd1aS1jb3JuZXItdG9wJyk7XHJcblxyXG4gICAgICAgIG9wdHMucG9zaXRpb24gJiYgbm9kZS5kYXRhKHBvc2l0aW9uLCBvcHRzLnBvc2l0aW9uKTtcclxuXHJcbiAgICAgICAgb3B0cy5hdXRvT3BlbiAhPT0gZmFsc2UgJiYgJCh0aGlzKS5kaWFsb2dlbGZpbmRlcignb3BlbicpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChvcHRzID09ICdvcGVuJykge1xyXG4gICAgICAgIHZhciBub2RlID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgcG9zID0gbm9kZS5kYXRhKHBvc2l0aW9uKSB8fCB7XHJcbiAgICAgICAgICAgICAgICB0b3A6IHBhcnNlSW50KCQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpICsgKCQod2luZG93KS5oZWlnaHQoKSA8IG5vZGUuaGVpZ2h0KCkgPyAyIDogKCQod2luZG93KS5oZWlnaHQoKSAtIG5vZGUuaGVpZ2h0KCkpIC8gMikpLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogcGFyc2VJbnQoJChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpICsgKCQod2luZG93KS53aWR0aCgpIDwgbm9kZS53aWR0aCgpID8gMiA6ICgkKHdpbmRvdykud2lkdGgoKSAtIG5vZGUud2lkdGgoKSkgLyAyKSlcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgemluZGV4ID0gMTAwO1xyXG5cclxuICAgICAgICBpZiAobm9kZS5pcygnOmhpZGRlbicpKSB7XHJcblxyXG4gICAgICAgICAgICAkKCdib2R5JykuZmluZCgnOnZpc2libGUnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSwgejtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcyAhPT0gbm9kZVswXSAmJiAkdGhpcy5jc3MoJ3Bvc2l0aW9uJykgPT0gJ2Fic29sdXRlJyAmJiAoeiA9IHBhcnNlSW50KCR0aGlzLnpJbmRleCgpKSkgPiB6aW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICB6aW5kZXggPSB6ICsgMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBub2RlLnpJbmRleCh6aW5kZXgpLmNzcyhwb3MpLnNob3coKS50cmlnZ2VyKCdyZXNpemUnKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8vIGZpeCByZXNpemUgaWNvbiBwb3NpdGlvbiBhbmQgbWFrZSBlbGZpbmRlciBhY3RpdmVcclxuICAgICAgICAgICAgICAgIG5vZGUudHJpZ2dlcigncmVzaXplJykubW91c2Vkb3duKCk7XHJcbiAgICAgICAgICAgIH0sIDIwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChvcHRzID09ICdjbG9zZScpIHtcclxuICAgICAgICB2YXIgbm9kZSA9ICQodGhpcyk7XHJcblxyXG4gICAgICAgIGlmIChub2RlLmlzKCc6dmlzaWJsZScpKSB7XHJcbiAgICAgICAgICAgICEhbm9kZS5kYXRhKGRlc3Ryb3kpXHJcbiAgICAgICAgICAgICAgICA/IG5vZGUuZWxmaW5kZXIoJ2Rlc3Ryb3knKS5yZW1vdmUoKVxyXG4gICAgICAgICAgICAgICAgOiBub2RlLmVsZmluZGVyKCdjbG9zZScpO1xyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAob3B0cyA9PSAnaW5zdGFuY2UnKSB7XHJcbiAgICAgICAgcmV0dXJuICQodGhpcykuZ2V0RWxGaW5kZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcztcclxufTsiLCJcbiQuZm4uZWxmaW5kZXJvdmVybGF5ID0gZnVuY3Rpb24ob3B0cykge1xyXG5cclxuICAgIHRoaXMuZmlsdGVyKCc6bm90KC5lbGZpbmRlci1vdmVybGF5KScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgb3B0cyA9ICQuZXh0ZW5kKHt9LCBvcHRzKTtcclxuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCd1aS13aWRnZXQtb3ZlcmxheSBlbGZpbmRlci1vdmVybGF5JylcclxuICAgICAgICAgICAgLmhpZGUoKVxyXG4gICAgICAgICAgICAubW91c2Vkb3duKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5kYXRhKHtcclxuICAgICAgICAgICAgICAgIGNudDogMCxcclxuICAgICAgICAgICAgICAgIHNob3c6IHR5cGVvZihvcHRzLnNob3cpID09ICdmdW5jdGlvbicgPyBvcHRzLnNob3cgOiBmdW5jdGlvbigpIHt9LFxyXG4gICAgICAgICAgICAgICAgaGlkZTogdHlwZW9mKG9wdHMuaGlkZSkgPT0gJ2Z1bmN0aW9uJyA/IG9wdHMuaGlkZSA6IGZ1bmN0aW9uKCkge31cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAob3B0cyA9PSAnc2hvdycpIHtcclxuICAgICAgICB2YXIgbyA9IHRoaXMuZXEoMCksXHJcbiAgICAgICAgICAgIGNudCA9IG8uZGF0YSgnY250JykgKyAxLFxyXG4gICAgICAgICAgICBzaG93ID0gby5kYXRhKCdzaG93Jyk7XHJcblxyXG4gICAgICAgIG8uZGF0YSgnY250JywgY250KTtcclxuXHJcbiAgICAgICAgaWYgKG8uaXMoJzpoaWRkZW4nKSkge1xyXG4gICAgICAgICAgICBvLnpJbmRleChvLnBhcmVudCgpLnpJbmRleCgpICsgMSk7XHJcbiAgICAgICAgICAgIG8uc2hvdygpO1xyXG4gICAgICAgICAgICBzaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChvcHRzID09ICdoaWRlJykge1xyXG4gICAgICAgIHZhciBvID0gdGhpcy5lcSgwKSxcclxuICAgICAgICAgICAgY250ID0gby5kYXRhKCdjbnQnKSAtIDEsXHJcbiAgICAgICAgICAgIGhpZGUgPSBvLmRhdGEoJ2hpZGUnKTtcclxuXHJcbiAgICAgICAgby5kYXRhKCdjbnQnLCBjbnQpO1xyXG5cclxuICAgICAgICBpZiAoY250ID09IDAgJiYgby5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICAgICAgICBvLmhpZGUoKTtcclxuICAgICAgICAgICAgaGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcztcclxufSIsIlwidXNlIHN0cmljdFwiO1xyXG4vKipcbiAqIEBjbGFzcyBlbGZpbmRlcndvcmt6b25lIC0gZWxGaW5kZXIgY29udGFpbmVyIGZvciBuYXYgYW5kIGN1cnJlbnQgZGlyZWN0b3J5XG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG4kLmZuLmVsZmluZGVyd29ya3pvbmUgPSBmdW5jdGlvbihmbSkge1xyXG4gICAgdmFyIGNsID0gJ2VsZmluZGVyLXdvcmt6b25lJztcclxuXHJcbiAgICB0aGlzLm5vdCgnLicgKyBjbCkuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgd3ogPSAkKHRoaXMpLmFkZENsYXNzKGNsKSxcclxuICAgICAgICAgICAgd2RlbHRhID0gd3oub3V0ZXJIZWlnaHQodHJ1ZSkgLSB3ei5oZWlnaHQoKSxcclxuICAgICAgICAgICAgcGFyZW50ID0gd3oucGFyZW50KCk7XHJcblxyXG4gICAgICAgIHBhcmVudC5hZGQod2luZG93KS5iaW5kKCdyZXNpemUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHBhcmVudC5oZWlnaHQoKSArIDIwOyAvLyArMjBweCBzaG93IGJvdHRvbSBzY3JvbGxiYXIgYXJyb3cgW3JhaWwtc11cclxuXHJcbiAgICAgICAgICAgIHBhcmVudC5jaGlsZHJlbignOnZpc2libGU6bm90KC4nICsgY2wgKyAnKScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2ggPSAkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjaC5jc3MoJ3Bvc2l0aW9uJykgIT0gJ2Fic29sdXRlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCAtPSBjaC5vdXRlckhlaWdodCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB3ei5oZWlnaHQoaGVpZ2h0IC0gd2RlbHRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07IiwiLyoqXG4gKiBAY2xhc3MgZWxmaW5kZXJuYXYgLSBlbEZpbmRlciBjb250YWluZXIgZm9yIGRpcmV0b3JpZXMgdHJlZSBhbmQgcGxhY2VzXG4gKlxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqKi9cclxuJC5mbi5lbGZpbmRlcm5hdmJhciA9IGZ1bmN0aW9uKGZtLCBvcHRzKSB7XHJcblxyXG4gICAgdGhpcy5ub3QoJy5lbGZpbmRlci1uYXZiYXInKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBuYXYgPSAkKHRoaXMpLmFkZENsYXNzKCd1aS1zdGF0ZS1kZWZhdWx0IGVsZmluZGVyLW5hdmJhcicpLFxyXG4gICAgICAgICAgICBwYXJlbnQgPSBuYXYucGFyZW50KClcclxuICAgICAgICAgICAgICAgIC5yZXNpemUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmF2LmhlaWdodCh3ei5oZWlnaHQoKSAtIGRlbHRhKTtcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICB3eiA9IHBhcmVudC5jaGlsZHJlbignLmVsZmluZGVyLXdvcmt6b25lJykuYXBwZW5kKG5hdiksXHJcbiAgICAgICAgICAgIGRlbHRhID0gbmF2Lm91dGVySGVpZ2h0KCkgLSBuYXYuaGVpZ2h0KCksXHJcbiAgICAgICAgICAgIGx0ciA9IGZtLmRpcmVjdGlvbiA9PSAnbHRyJyxcclxuICAgICAgICAgICAgaGFuZGxlO1xyXG5cclxuXHJcbiAgICAgICAgaWYgKCQuZm4ucmVzaXphYmxlICYmIG9wdHMucmVzaXphYmxlKSB7XHJcbiAgICAgICAgICAgIGhhbmRsZSA9IG5hdi5yZXNpemFibGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXM6IGx0ciA/ICdlJyA6ICd3JyxcclxuICAgICAgICAgICAgICAgICAgICBtaW5XaWR0aDogb3B0cy5taW5XaWR0aCB8fCAxNTAsXHJcbiAgICAgICAgICAgICAgICAgICAgbWF4V2lkdGg6IG9wdHMubWF4V2lkdGggfHwgNTAwXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmJpbmQoJ3Jlc2l6ZSBzY3JvbGwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gKGZtLlVBLk9wZXJhICYmIG5hdi5zY3JvbGxMZWZ0KCkpID8gMjAgOiAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHBhcnNlSW50KG5hdi5zY3JvbGxUb3AoKSkgKyAncHgnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBsdHIgPyAnYXV0bycgOiBwYXJzZUludChuYXYuc2Nyb2xsTGVmdCgpICsgb2Zmc2V0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IGx0ciA/IHBhcnNlSW50KG5hdi5zY3JvbGxMZWZ0KCkgLSBvZmZzZXQpICogLTEgOiAnYXV0bydcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZmluZCgnLnVpLXJlc2l6YWJsZS1oYW5kbGUnKS56SW5kZXgobmF2LnpJbmRleCgpICsgMTApO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFsdHIpIHtcclxuICAgICAgICAgICAgICAgIG5hdi5yZXNpemUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmF2LmNzcygnbGVmdCcsIG51bGwpLmNzcygncmlnaHQnLCAwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmbS5vbmUoJ29wZW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmF2LnRyaWdnZXIoJ3Jlc2l6ZScpO1xyXG4gICAgICAgICAgICAgICAgfSwgMTUwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxuICogQGNsYXNzICBlbEZpbmRlciBkaWFsb2dcbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG4kLmZuLmVsZmluZGVyZGlhbG9nID0gZnVuY3Rpb24ob3B0cykge1xyXG4gICAgdmFyIGRpYWxvZztcclxuXHJcbiAgICBpZiAodHlwZW9mKG9wdHMpID09ICdzdHJpbmcnICYmIChkaWFsb2cgPSB0aGlzLmNsb3Nlc3QoJy51aS1kaWFsb2cnKSkubGVuZ3RoKSB7XHJcbiAgICAgICAgaWYgKG9wdHMgPT0gJ29wZW4nKSB7XHJcbiAgICAgICAgICAgIGRpYWxvZy5jc3MoJ2Rpc3BsYXknKSA9PSAnbm9uZScgJiYgZGlhbG9nLmZhZGVJbigxMjAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZGlhbG9nLnRyaWdnZXIoJ29wZW4nKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChvcHRzID09ICdjbG9zZScpIHtcclxuICAgICAgICAgICAgZGlhbG9nLmNzcygnZGlzcGxheScpICE9ICdub25lJyAmJiBkaWFsb2cuaGlkZSgpLnRyaWdnZXIoJ2Nsb3NlJyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChvcHRzID09ICdkZXN0cm95Jykge1xyXG4gICAgICAgICAgICBkaWFsb2cuaGlkZSgpLnJlbW92ZSgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAob3B0cyA9PSAndG9Ub3AnKSB7XHJcbiAgICAgICAgICAgIGRpYWxvZy50cmlnZ2VyKCd0b3RvcCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvcHRzID0gJC5leHRlbmQoe30sICQuZm4uZWxmaW5kZXJkaWFsb2cuZGVmYXVsdHMsIG9wdHMpO1xyXG5cclxuICAgIHRoaXMuZmlsdGVyKCc6bm90KC51aS1kaWFsb2ctY29udGVudCknKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gJCh0aGlzKS5hZGRDbGFzcygndWktZGlhbG9nLWNvbnRlbnQgdWktd2lkZ2V0LWNvbnRlbnQnKSxcclxuICAgICAgICAgICAgcGFyZW50ID0gc2VsZi5wYXJlbnQoKSxcclxuICAgICAgICAgICAgY2xhY3RpdmUgPSAnZWxmaW5kZXItZGlhbG9nLWFjdGl2ZScsXHJcbiAgICAgICAgICAgIGNsZGlhbG9nID0gJ2VsZmluZGVyLWRpYWxvZycsXHJcbiAgICAgICAgICAgIGNsbm90aWZ5ID0gJ2VsZmluZGVyLWRpYWxvZy1ub3RpZnknLFxyXG4gICAgICAgICAgICBjbGhvdmVyID0gJ3VpLXN0YXRlLWhvdmVyJyxcclxuICAgICAgICAgICAgaWQgPSBwYXJzZUludChNYXRoLnJhbmRvbSgpICogMTAwMDAwMCksXHJcbiAgICAgICAgICAgIG92ZXJsYXkgPSBwYXJlbnQuY2hpbGRyZW4oJy5lbGZpbmRlci1vdmVybGF5JyksXHJcbiAgICAgICAgICAgIGJ1dHRvbnNldCA9ICQoJzxkaXYgY2xhc3M9XCJ1aS1kaWFsb2ctYnV0dG9uc2V0XCIvPicpLFxyXG4gICAgICAgICAgICBidXR0b25wYW5lID0gJCgnPGRpdiBjbGFzcz1cIiB1aS1oZWxwZXItY2xlYXJmaXggdWktZGlhbG9nLWJ1dHRvbnBhbmUgdWktd2lkZ2V0LWNvbnRlbnRcIi8+JylcclxuICAgICAgICAgICAgICAgIC5hcHBlbmQoYnV0dG9uc2V0KSxcclxuXHJcbiAgICAgICAgICAgIGRpYWxvZyA9ICQoJzxkaXYgY2xhc3M9XCJ1aS1kaWFsb2cgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwgdWktZHJhZ2dhYmxlIHN0ZDQyLWRpYWxvZyAgJyArIGNsZGlhbG9nICsgJyAnICsgb3B0cy5jc3NDbGFzcyArICdcIi8+JylcclxuICAgICAgICAgICAgICAgIC5oaWRlKClcclxuICAgICAgICAgICAgICAgIC5hcHBlbmQoc2VsZilcclxuICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhwYXJlbnQpXHJcbiAgICAgICAgICAgICAgICAuZHJhZ2dhYmxlKHtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICcudWktZGlhbG9nLXRpdGxlYmFyJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250YWlubWVudDogJ2RvY3VtZW50J1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBvcHRzLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogb3B0cy5oZWlnaHRcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubW91c2Vkb3duKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5tb3VzZWRvd24oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkaWFsb2cuaXMoJy4nICsgY2xhY3RpdmUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5maW5kKCcuJyArIGNsZGlhbG9nICsgJzp2aXNpYmxlJykucmVtb3ZlQ2xhc3MoY2xhY3RpdmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2cuYWRkQ2xhc3MoY2xhY3RpdmUpLnpJbmRleChtYXhaSW5kZXgoKSArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuYmluZCgnb3BlbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpYWxvZy50cmlnZ2VyKCd0b3RvcCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZihvcHRzLm9wZW4pID09ICdmdW5jdGlvbicgJiYgJC5wcm94eShvcHRzLm9wZW4sIHNlbGZbMF0pKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZGlhbG9nLmlzKCcuJyArIGNsbm90aWZ5KSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmZpbmQoJy4nICsgY2xkaWFsb2cgKyAnOnZpc2libGUnKS5ub3QoJy4nICsgY2xub3RpZnkpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9ICQodGhpcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gcGFyc2VJbnQoZC5jc3MoJ3RvcCcpKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gcGFyc2VJbnQoZC5jc3MoJ2xlZnQnKSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RvcCA9IHBhcnNlSW50KGRpYWxvZy5jc3MoJ3RvcCcpKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbGVmdCA9IHBhcnNlSW50KGRpYWxvZy5jc3MoJ2xlZnQnKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRbMF0gIT0gZGlhbG9nWzBdICYmICh0b3AgPT0gX3RvcCB8fCBsZWZ0ID09IF9sZWZ0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpYWxvZy5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICh0b3AgKyAxMCkgKyAncHgnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAobGVmdCArIDEwKSArICdweCdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5iaW5kKCdjbG9zZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkaWFsb2dzID0gcGFyZW50LmZpbmQoJy5lbGZpbmRlci1kaWFsb2c6dmlzaWJsZScpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB6ID0gbWF4WkluZGV4KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZGF0YSgnbW9kYWwnKSAmJiBvdmVybGF5LmVsZmluZGVyb3ZlcmxheSgnaGlkZScpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZm9jdXMgdG8gbmV4dCBkaWFsb2dcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGlhbG9ncy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9ncy5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQuekluZGV4KCkgPj0geikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQudHJpZ2dlcigndG90b3AnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJldHVybiBmb2N1cyB0byBwYXJlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5tb3VzZWRvd24oKS5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihvcHRzLmNsb3NlKSA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQucHJveHkob3B0cy5jbG9zZSwgc2VsZlswXSkoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9wdHMuZGVzdHJveU9uQ2xvc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlhbG9nLmhpZGUoKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmJpbmQoJ3RvdG9wJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5tb3VzZWRvd24oKS5maW5kKCcudWktYnV0dG9uOmZpcnN0JykuZm9jdXMoKS5lbmQoKS5maW5kKCc6dGV4dDpmaXJzdCcpLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5kYXRhKCdtb2RhbCcpICYmIG92ZXJsYXkuZWxmaW5kZXJvdmVybGF5KCdzaG93Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmxheS56SW5kZXgoJCh0aGlzKS56SW5kZXgoKSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmRhdGEoeyBtb2RhbDogb3B0cy5tb2RhbCB9KSxcclxuICAgICAgICAgICAgbWF4WkluZGV4ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgeiA9IHBhcmVudC56SW5kZXgoKSArIDEwO1xyXG4gICAgICAgICAgICAgICAgcGFyZW50LmZpbmQoJy4nICsgY2xkaWFsb2cgKyAnOnZpc2libGUnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBfejtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcyAhPSBkaWFsb2dbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3ogPSAkKHRoaXMpLnpJbmRleCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3ogPiB6KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6ID0gX3o7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB6O1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0b3A7XHJcblxyXG4gICAgICAgIGlmICghb3B0cy5wb3NpdGlvbikge1xyXG4gICAgICAgICAgICB0b3AgPSBwYXJzZUludCgocGFyZW50LmhlaWdodCgpIC0gZGlhbG9nLm91dGVySGVpZ2h0KCkpIC8gMiAtIDQyKTtcclxuICAgICAgICAgICAgb3B0cy5wb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgIHRvcDogKHRvcCA+IDAgPyB0b3AgOiAwKSArICdweCcsXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiBwYXJzZUludCgocGFyZW50LndpZHRoKCkgLSBkaWFsb2cub3V0ZXJXaWR0aCgpKSAvIDIpICsgJ3B4J1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZGlhbG9nLmNzcyhvcHRzLnBvc2l0aW9uKTtcclxuXHJcbiAgICAgICAgaWYgKG9wdHMuY2xvc2VPbkVzY2FwZSkge1xyXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5iaW5kKCdrZXl1cC4nICsgaWQsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gJC51aS5rZXlDb2RlLkVTQ0FQRSAmJiBkaWFsb2cuaXMoJy4nICsgY2xhY3RpdmUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5lbGZpbmRlcmRpYWxvZygnY2xvc2UnKTtcclxuICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS51bmJpbmQoJ2tleXVwLicgKyBpZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkaWFsb2cucHJlcGVuZChcclxuICAgICAgICAgICAgJCgnPGRpdiBjbGFzcz1cInVpLWRpYWxvZy10aXRsZWJhciB1aS13aWRnZXQtaGVhZGVyIHVpLWNvcm5lci1hbGwgdWktaGVscGVyLWNsZWFyZml4XCI+JyArIG9wdHMudGl0bGUgKyAnPC9kaXY+JylcclxuICAgICAgICAgICAgLnByZXBlbmQoJCgnPGEgaHJlZj1cIiNcIiBjbGFzcz1cInVpLWRpYWxvZy10aXRsZWJhci1jbG9zZSB1aS1jb3JuZXItYWxsXCI+PHNwYW4gY2xhc3M9XCJ1aS1pY29uIHVpLWljb24tY2xvc2V0aGlja1wiLz48L2E+JylcclxuICAgICAgICAgICAgICAgIC5tb3VzZWRvd24oZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmVsZmluZGVyZGlhbG9nKCdjbG9zZScpO1xyXG4gICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgKTtcclxuXHJcblxyXG4gICAgICAgICQuZWFjaChvcHRzLmJ1dHRvbnMsIGZ1bmN0aW9uKG5hbWUsIGNiKSB7XHJcbiAgICAgICAgICAgIHZhciBidXR0b24gPSAkKCc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cInVpLWJ1dHRvbiB1aS13aWRnZXQgdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsIHVpLWJ1dHRvbi10ZXh0LW9ubHlcIj48c3BhbiBjbGFzcz1cInVpLWJ1dHRvbi10ZXh0XCI+JyArIG5hbWUgKyAnPC9zcGFuPjwvYnV0dG9uPicpXHJcbiAgICAgICAgICAgICAgICAuY2xpY2soJC5wcm94eShjYiwgc2VsZlswXSkpXHJcbiAgICAgICAgICAgICAgICAuaG92ZXIoZnVuY3Rpb24oZSkgeyAkKHRoaXMpW2UudHlwZSA9PSAnbW91c2VlbnRlcicgPyAnZm9jdXMnIDogJ2JsdXInXSgpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmZvY3VzKGZ1bmN0aW9uKCkgeyAkKHRoaXMpLmFkZENsYXNzKGNsaG92ZXIpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmJsdXIoZnVuY3Rpb24oKSB7ICQodGhpcykucmVtb3ZlQ2xhc3MoY2xob3Zlcik7IH0pXHJcbiAgICAgICAgICAgICAgICAua2V5ZG93bihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gJC51aS5rZXlDb2RlLkVOVEVSKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAkLnVpLmtleUNvZGUuVEFCKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQgPSAkKHRoaXMpLm5leHQoJy51aS1idXR0b24nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dC5sZW5ndGggPyBuZXh0LmZvY3VzKCkgOiAkKHRoaXMpLnBhcmVudCgpLmNoaWxkcmVuKCcudWktYnV0dG9uOmZpcnN0JykuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYnV0dG9uc2V0LmFwcGVuZChidXR0b24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGJ1dHRvbnNldC5jaGlsZHJlbigpLmxlbmd0aCAmJiBkaWFsb2cuYXBwZW5kKGJ1dHRvbnBhbmUpO1xyXG4gICAgICAgIGlmIChvcHRzLnJlc2l6YWJsZSAmJiAkLmZuLnJlc2l6YWJsZSkge1xyXG4gICAgICAgICAgICBkaWFsb2cucmVzaXphYmxlKHtcclxuICAgICAgICAgICAgICAgIG1pbldpZHRoOiBvcHRzLm1pbldpZHRoLFxyXG4gICAgICAgICAgICAgICAgbWluSGVpZ2h0OiBvcHRzLm1pbkhlaWdodCxcclxuICAgICAgICAgICAgICAgIGFsc29SZXNpemU6IHRoaXNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0eXBlb2Yob3B0cy5jcmVhdGUpID09ICdmdW5jdGlvbicgJiYgJC5wcm94eShvcHRzLmNyZWF0ZSwgdGhpcykoKTtcclxuXHJcbiAgICAgICAgb3B0cy5hdXRvT3BlbiAmJiBzZWxmLmVsZmluZGVyZGlhbG9nKCdvcGVuJyk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07XHJcbiQuZm4uZWxmaW5kZXJkaWFsb2cuZGVmYXVsdHMgPSB7XHJcbiAgICBjc3NDbGFzczogJycsXHJcbiAgICB0aXRsZTogJycsXHJcbiAgICBtb2RhbDogZmFsc2UsXHJcbiAgICByZXNpemFibGU6IHRydWUsXHJcbiAgICBhdXRvT3BlbjogdHJ1ZSxcclxuICAgIGNsb3NlT25Fc2NhcGU6IHRydWUsXHJcbiAgICBkZXN0cm95T25DbG9zZTogZmFsc2UsXHJcbiAgICBidXR0b25zOiB7fSxcclxuICAgIHBvc2l0aW9uOiBudWxsLFxyXG4gICAgd2lkdGg6IDMyMCxcclxuICAgIGhlaWdodDogJ2F1dG8nLFxyXG4gICAgbWluV2lkdGg6IDIwMCxcclxuICAgIG1pbkhlaWdodDogMTEwXHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxyXG4gKiBAY2xhc3MgIGVsRmluZGVyIGZvbGRlcnMgdHJlZVxyXG4gKlxyXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxyXG4gKiovXHJcbiQuZm4uZWxmaW5kZXJ0cmVlID0gZnVuY3Rpb24oZm0sIG9wdHMpIHtcclxuICAgIHZhciB0cmVlY2xhc3MgPSBmbS5yZXMoJ2NsYXNzJywgJ3RyZWUnKTtcclxuXHJcbiAgICB0aGlzLm5vdCgnLicgKyB0cmVlY2xhc3MpLmVhY2goZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIHZhciBjID0gJ2NsYXNzJyxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBSb290IGRpcmVjdG9yeSBjbGFzcyBuYW1lXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgcm9vdCA9IGZtLnJlcyhjLCAndHJlZXJvb3QnKSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBPcGVuIHJvb3QgZGlyIGlmIG5vdCBvcGVuZWQgeWV0XHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIEJvb2xlYW5cclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIG9wZW5Sb290ID0gb3B0cy5vcGVuUm9vdE9uTG9hZCxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBTdWJ0cmVlIGNsYXNzIG5hbWVcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBzdWJ0cmVlID0gZm0ucmVzKGMsICduYXZzdWJ0cmVlJyksXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogRGlyZWN0b3J5IGNsYXNzIG5hbWVcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBuYXZkaXIgPSBmbS5yZXMoYywgJ3RyZWVkaXInKSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBDb2xsYXBzZWQgYXJyb3cgY2xhc3MgbmFtZVxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIGNvbGxhcHNlZCA9IGZtLnJlcyhjLCAnbmF2Y29sbGFwc2UnKSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBFeHBhbmRlZCBhcnJvdyBjbGFzcyBuYW1lXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgZXhwYW5kZWQgPSBmbS5yZXMoYywgJ25hdmV4cGFuZCcpLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIENsYXNzIG5hbWUgdG8gbWFyayBhcnJvdyBmb3IgZGlyZWN0b3J5IHdpdGggYWxyZWFkeSBsb2FkZWQgY2hpbGRyZW5cclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBsb2FkZWQgPSAnZWxmaW5kZXItc3VidHJlZS1sb2FkZWQnLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIEFycmF3IGNsYXNzIG5hbWVcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBhcnJvdyA9IGZtLnJlcyhjLCAnbmF2YXJyb3cnKSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBDdXJyZW50IGRpcmVjdG9yeSBjbGFzcyBuYW1lXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgYWN0aXZlID0gZm0ucmVzKGMsICdhY3RpdmUnKSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBEcm9wcGFibGUgZGlycyBkcm9wb3ZlciBjbGFzc1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIGRyb3BvdmVyID0gZm0ucmVzKGMsICdhZHJvcHBhYmxlJyksXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogSG92ZXIgY2xhc3MgbmFtZVxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIGhvdmVyID0gZm0ucmVzKGMsICdob3ZlcicpLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIERpc2FibGVkIGRpciBjbGFzcyBuYW1lXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgZGlzYWJsZWQgPSBmbS5yZXMoYywgJ2Rpc2FibGVkJyksXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogRHJhZ2dhYmxlIGRpciBjbGFzcyBuYW1lXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgZHJhZ2dhYmxlID0gZm0ucmVzKGMsICdkcmFnZ2FibGUnKSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBEcm9wcGFibGUgZGlyICBjbGFzcyBuYW1lXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgZHJvcHBhYmxlID0gZm0ucmVzKGMsICdkcm9wcGFibGUnKSxcclxuXHJcbiAgICAgICAgICAgIGluc2lkZU5hdmJhciA9IGZ1bmN0aW9uKHgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsZWZ0ID0gbmF2YmFyLm9mZnNldCgpLmxlZnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxlZnQgPD0geCAmJiB4IDw9IGxlZnQgKyBuYXZiYXIud2lkdGgoKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGRyb3AgPSBmbS5kcm9wcGFibGUuZHJvcCxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBEcm9wcGFibGUgb3B0aW9uc1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBPYmplY3RcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIGRyb3BwYWJsZW9wdHMgPSAkLmV4dGVuZCh0cnVlLCB7fSwgZm0uZHJvcHBhYmxlLCB7XHJcbiAgICAgICAgICAgICAgICAvLyBzaG93IHN1YmZvbGRlcnMgb24gZHJvcG92ZXJcclxuICAgICAgICAgICAgICAgIG92ZXI6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9ICQodGhpcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsID0gaG92ZXIgKyAnICcgKyBkcm9wb3ZlcjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluc2lkZU5hdmJhcihlLmNsaWVudFgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuYWRkQ2xhc3MoY2wpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluay5pcygnLicgKyBjb2xsYXBzZWQgKyAnOm5vdCguJyArIGV4cGFuZGVkICsgJyknKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLmlzKCcuJyArIGRyb3BvdmVyKSAmJiBsaW5rLmNoaWxkcmVuKCcuJyArIGFycm93KS5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsucmVtb3ZlQ2xhc3MoY2wpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvdXQ6IGZ1bmN0aW9uKCkgeyAkKHRoaXMpLnJlbW92ZUNsYXNzKGhvdmVyICsgJyAnICsgZHJvcG92ZXIpOyB9LFxyXG4gICAgICAgICAgICAgICAgZHJvcDogZnVuY3Rpb24oZSwgdWkpIHsgaW5zaWRlTmF2YmFyKGUuY2xpZW50WCkgJiYgZHJvcC5jYWxsKHRoaXMsIGUsIHVpKTsgfVxyXG4gICAgICAgICAgICB9KSxcclxuXHJcbiAgICAgICAgICAgIHNwaW5uZXIgPSAkKGZtLnJlcygndHBsJywgJ25hdnNwaW5uZXInKSksXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogRGlyZWN0b3J5IGh0bWwgdGVtcGxhdGVcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICB0cGwgPSBmbS5yZXMoJ3RwbCcsICduYXZkaXInKSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBQZXJtaXNzaW9ucyBtYXJrZXIgaHRtbCB0ZW1wbGF0ZVxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIHB0cGwgPSBmbS5yZXMoJ3RwbCcsICdwZXJtcycpLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIFN5bWxpbmsgbWFya2VyIGh0bWwgdGVtcGxhdGVcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBzdHBsID0gZm0ucmVzKCd0cGwnLCAnc3ltbGluaycpLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIEh0bWwgdGVtcGxhdGUgcmVwbGFjZW1lbnQgbWV0aG9kc1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBPYmplY3RcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIHJlcGxhY2UgPSB7XHJcbiAgICAgICAgICAgICAgICBpZDogZnVuY3Rpb24oZGlyKSB7IHJldHVybiBmbS5uYXZIYXNoMklkKGRpci5oYXNoKTsgfSxcclxuICAgICAgICAgICAgICAgIGNzc2NsYXNzOiBmdW5jdGlvbihkaXIpIHsgcmV0dXJuIChkaXIucGhhc2ggPyAnJyA6IHJvb3QpICsgJyAnICsgbmF2ZGlyICsgJyAnICsgZm0ucGVybXMyY2xhc3MoZGlyKSArICcgJyArIChkaXIuZGlycyAmJiAhZGlyLmxpbmsgPyBjb2xsYXBzZWQgOiAnJyk7IH0sXHJcbiAgICAgICAgICAgICAgICBwZXJtaXNzaW9uczogZnVuY3Rpb24oZGlyKSB7IHJldHVybiAhZGlyLnJlYWQgfHwgIWRpci53cml0ZSA/IHB0cGwgOiAnJzsgfSxcclxuICAgICAgICAgICAgICAgIHN5bWxpbms6IGZ1bmN0aW9uKGRpcikgeyByZXR1cm4gZGlyLmFsaWFzID8gc3RwbCA6ICcnOyB9XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogUmV0dXJuIGh0bWwgZm9yIGdpdmVuIGRpclxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAcGFyYW0gIE9iamVjdCAgZGlyZWN0b3J5XHJcblx0XHRcdCAqIEByZXR1cm4gU3RyaW5nXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBpdGVtaHRtbCA9IGZ1bmN0aW9uKGRpcikge1xyXG4gICAgICAgICAgICAgICAgZGlyLm5hbWUgPSBmbS5lc2NhcGUoZGlyLmkxOCB8fCBkaXIubmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRwbC5yZXBsYWNlKC8oPzpcXHsoW2Etel0rKVxcfSkvaWcsIGZ1bmN0aW9uKG0sIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkaXJba2V5XSB8fCAocmVwbGFjZVtrZXldID8gcmVwbGFjZVtrZXldKGRpcikgOiAnJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBSZXR1cm4gb25seSBkaXJzIGZyb20gZmlsZXMgbGlzdFxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAcGFyYW0gIEFycmF5ICBmaWxlcyBsaXN0XHJcblx0XHRcdCAqIEByZXR1cm4gQXJyYXlcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIGZpbHRlciA9IGZ1bmN0aW9uKGZpbGVzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJC5tYXAoZmlsZXMgfHwgW10sIGZ1bmN0aW9uKGYpIHsgcmV0dXJuIGYubWltZSA9PSAnZGlyZWN0b3J5JyA/IGYgOiBudWxsOyB9KTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBGaW5kIHBhcmVudCBzdWJ0cmVlIGZvciByZXF1aXJlZCBkaXJlY3RvcnlcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHBhcmFtICBTdHJpbmcgIGRpciBoYXNoXHJcblx0XHRcdCAqIEByZXR1cm4galF1ZXJ5XHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBmaW5kU3VidHJlZSA9IGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBoYXNoID8gdHJlZS5maW5kKCcjJyArIGZtLm5hdkhhc2gySWQoaGFzaCkpLm5leHQoJy4nICsgc3VidHJlZSkgOiB0cmVlO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIEZpbmQgZGlyZWN0b3J5ICh3cmFwcGVyKSBpbiByZXF1aXJlZCBub2RlXHJcblx0XHRcdCAqIGJlZm9yZSB3aGljaCB3ZSBjYW4gaW5zZXJ0IG5ldyBkaXJlY3RvcnlcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHBhcmFtICBqUXVlcnkgIHBhcmVudCBkaXJlY3RvcnlcclxuXHRcdFx0ICogQHBhcmFtICBPYmplY3QgIG5ldyBkaXJlY3RvcnlcclxuXHRcdFx0ICogQHJldHVybiBqUXVlcnlcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIGZpbmRTaWJsaW5nID0gZnVuY3Rpb24oc3VidHJlZSwgZGlyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IHN1YnRyZWUuY2hpbGRyZW4oJzpmaXJzdCcpLFxyXG4gICAgICAgICAgICAgICAgICAgIGluZm87XHJcblxyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG5vZGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IGZtLmZpbGUoZm0ubmF2SWQySGFzaChub2RlLmNoaWxkcmVuKCdbaWRdJykuYXR0cignaWQnKSkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoKGluZm8gPSBmbS5maWxlKGZtLm5hdklkMkhhc2gobm9kZS5jaGlsZHJlbignW2lkXScpLmF0dHIoJ2lkJykpKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgZGlyLm5hbWUudG9Mb3dlckNhc2UoKS5sb2NhbGVDb21wYXJlKGluZm8ubmFtZS50b0xvd2VyQ2FzZSgpKSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLm5leHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiAkKCcnKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBBZGQgbmV3IGRpcnMgaW4gdHJlZVxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAcGFyYW0gIEFycmF5ICBkaXJzIGxpc3RcclxuXHRcdFx0ICogQHJldHVybiB2b2lkXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICB1cGRhdGVUcmVlID0gZnVuY3Rpb24oZGlycykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IGRpcnMubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIG9ycGhhbnMgPSBbXSxcclxuICAgICAgICAgICAgICAgICAgICBpID0gZGlycy5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgICAgZGlyLFxyXG4gICAgICAgICAgICAgICAgICAgIGh0bWwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHNpYmxpbmc7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3RWb2wgPSB0cnVlOyAvLyBjaGVjayBmb3IgbmV0bW91bnQgdm9sdW1lXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlyID0gZGlyc1tpXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRyZWUuZmluZCgnIycgKyBmbS5uYXZIYXNoMklkKGRpci5oYXNoKSkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChwYXJlbnQgPSBmaW5kU3VidHJlZShkaXIucGhhc2gpKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGl0ZW1odG1sKGRpcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXIucGhhc2ggJiYgKHNpYmxpbmcgPSBmaW5kU2libGluZyhwYXJlbnQsIGRpcikpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2libGluZy5iZWZvcmUoaHRtbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRbZmlyc3RWb2wgfHwgZGlyLnBoYXNoID8gJ2FwcGVuZCcgOiAncHJlcGVuZCddKGh0bWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RWb2wgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ycGhhbnMucHVzaChkaXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAob3JwaGFucy5sZW5ndGggJiYgb3JwaGFucy5sZW5ndGggPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlVHJlZShvcnBoYW5zKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICQoJy5lbGZpbmRlci1jd2QnKS5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVEcm9wcGFibGUoKTtcclxuICAgICAgICAgICAgICAgIH0sIDEwKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogTWFyayBjdXJyZW50IGRpcmVjdG9yeSBhcyBhY3RpdmVcclxuXHRcdFx0ICogSWYgY3VycmVudCBkaXJlY3RvcnkgaXMgbm90IGluIHRyZWUgLSBsb2FkIGl0IGFuZCBpdHMgcGFyZW50c1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAcGFyYW0ge0Jvb2xlYW59IGRvIG5vdCByZWN1cnNpdmUgY2FsbFxyXG5cdFx0XHQgKiBAcmV0dXJuIHZvaWRcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIHN5bmMgPSBmdW5jdGlvbihzdG9wUmVjKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3dkID0gZm0uY3dkKCkuaGFzaCxcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gdHJlZS5maW5kKCcjJyArIGZtLm5hdkhhc2gySWQoY3dkKSksXHJcbiAgICAgICAgICAgICAgICAgICAgcm9vdE5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGlyO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChvcGVuUm9vdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJvb3ROb2RlID0gdHJlZS5maW5kKCcjJyArIGZtLm5hdkhhc2gySWQoZm0ucm9vdCgpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcm9vdE5vZGUuaXMoJy4nICsgbG9hZGVkKSAmJiByb290Tm9kZS5hZGRDbGFzcyhleHBhbmRlZCkubmV4dCgnLicgKyBzdWJ0cmVlKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgb3BlblJvb3QgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnQuaXMoJy4nICsgYWN0aXZlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyZWUuZmluZCgnLicgKyBuYXZkaXIgKyAnLicgKyBhY3RpdmUpLnJlbW92ZUNsYXNzKGFjdGl2ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudC5hZGRDbGFzcyhhY3RpdmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChvcHRzLnN5bmNUcmVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50LnBhcmVudHNVbnRpbCgnLicgKyByb290KS5maWx0ZXIoJy4nICsgc3VidHJlZSkuc2hvdygpLnByZXYoJy4nICsgbmF2ZGlyKS5hZGRDbGFzcyhleHBhbmRlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmbS5uZXdBUEkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlyID0gZm0uZmlsZShjd2QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlyICYmIGRpci5waGFzaCAmJiB0cmVlLmZpbmQoJyMnICsgZm0ubmF2SGFzaDJJZChkaXIucGhhc2gpKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRyZWUoW2Rpcl0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5bmMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogJ3BhcmVudHMnLCB0YXJnZXQ6IGN3ZCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZlbnRGYWlsOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXJzID0gZmlsdGVyKGRhdGEudHJlZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlVHJlZShkaXJzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVBcnJvd3MoZGlycywgbG9hZGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjd2QgPT0gZm0uY3dkKCkuaGFzaCAmJiBzeW5jKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBNYWtlIHdyaXRhYmxlIGFuZCBub3Qgcm9vdCBkaXJzIGRyb3BwYWJsZVxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAcmV0dXJuIHZvaWRcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIHVwZGF0ZURyb3BwYWJsZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdHJlZS5maW5kKCcuJyArIG5hdmRpciArICc6bm90KC4nICsgZHJvcHBhYmxlICsgJywuZWxmaW5kZXItcm8sLmVsZmluZGVyLW5hKScpLmRyb3BwYWJsZShkcm9wcGFibGVvcHRzKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBDaGVjayByZXF1aXJlZCBmb2xkZXJzIGZvciBzdWJmb2xkZXJzIGFuZCB1cGRhdGUgYXJyb3cgY2xhc3Nlc1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAcGFyYW0gIEFycmF5ICBmb2xkZXJzIHRvIGNoZWNrXHJcblx0XHRcdCAqIEBwYXJhbSAgU3RyaW5nIGNzcyBjbGFzcyBcclxuXHRcdFx0ICogQHJldHVybiB2b2lkXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICB1cGRhdGVBcnJvd3MgPSBmdW5jdGlvbihkaXJzLCBjbHMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWwgPSBjbHMgPT0gbG9hZGVkXHJcbiAgICAgICAgICAgICAgICAgICAgPyAnLicgKyBjb2xsYXBzZWQgKyAnOm5vdCguJyArIGxvYWRlZCArICcpJ1xyXG4gICAgICAgICAgICAgICAgICAgIDogJzpub3QoLicgKyBjb2xsYXBzZWQgKyAnKSc7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8vdHJlZS5maW5kKCcuJytzdWJ0cmVlKyc6aGFzKCopJykucHJldignOm5vdCguJytjb2xsYXBzZWQrJyknKS5hZGRDbGFzcyhjb2xsYXBzZWQpXHJcblxyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGRpcnMsIGZ1bmN0aW9uKGksIGRpcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyZWUuZmluZCgnIycgKyBmbS5uYXZIYXNoMklkKGRpci5waGFzaCkgKyBzZWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24oKSB7IHJldHVybiAkKHRoaXMpLm5leHQoJy4nICsgc3VidHJlZSkuY2hpbGRyZW4oKS5sZW5ndGggPiAwOyB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoY2xzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuXHJcbi8qKlxyXG5cdFx0XHQgKiBOYXZpZ2F0aW9uIHRyZWVcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgSlF1ZXJ5XHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICB0cmVlID0gJCh0aGlzKS5hZGRDbGFzcyh0cmVlY2xhc3MpXHJcbiAgICAgICAgICAgICAgICAvLyBtYWtlIGRpcnMgZHJhZ2dhYmxlIGFuZCB0b2dnbGUgaG92ZXIgY2xhc3NcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZSgnLicgKyBuYXZkaXIsICdob3ZlcicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9ICQodGhpcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudGVyID0gZS50eXBlID09ICdtb3VzZWVudGVyJztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFsaW5rLmlzKCcuJyArIGRyb3BvdmVyICsgJyAsLicgKyBkaXNhYmxlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW50ZXIgJiYgIWxpbmsuaXMoJy4nICsgcm9vdCArICcsLicgKyBkcmFnZ2FibGUgKyAnLC5lbGZpbmRlci1uYSwuZWxmaW5kZXItd28nKSAmJiBsaW5rLmRyYWdnYWJsZShmbS5kcmFnZ2FibGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnRvZ2dsZUNsYXNzKGhvdmVyLCBlbnRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC8vIGFkZC9yZW1vdmUgZHJvcG92ZXIgY3NzIGNsYXNzXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoJy4nICsgbmF2ZGlyLCAnZHJvcG92ZXIgZHJvcG91dCBkcm9wJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcylbZS50eXBlID09ICdkcm9wb3ZlcicgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJ10oZHJvcG92ZXIgKyAnICcgKyBob3Zlcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLy8gb3BlbiBkaXIgb3Igb3BlbiBzdWJmb2xkZXJzIGluIHRyZWVcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZSgnLicgKyBuYXZkaXIsICdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9ICQodGhpcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc2ggPSBmbS5uYXZJZDJIYXNoKGxpbmsuYXR0cignaWQnKSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUgPSBmbS5maWxlKGhhc2gpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmbS50cmlnZ2VyKCdzZWFyY2hlbmQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc2ggIT0gZm0uY3dkKCkuaGFzaCAmJiAhbGluay5pcygnLicgKyBkaXNhYmxlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm0uZXhlYygnb3BlbicsIGZpbGUudGhhc2ggfHwgaGFzaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5rLmlzKCcuJyArIGNvbGxhcHNlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGluay5jaGlsZHJlbignLicgKyBhcnJvdykuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLy8gdG9nZ2xlIHN1YmZvbGRlcnMgaW4gdHJlZVxyXG4gICAgICAgICAgICAgICAgLmRlbGVnYXRlKCcuJyArIG5hdmRpciArICcuJyArIGNvbGxhcHNlZCArICcgLicgKyBhcnJvdywgJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhcnJvdyA9ICQodGhpcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsgPSBhcnJvdy5wYXJlbnQoJy4nICsgbmF2ZGlyKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWUgPSBsaW5rLm5leHQoJy4nICsgc3VidHJlZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsaW5rLmlzKCcuJyArIGxvYWRlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGluay50b2dnbGVDbGFzcyhleHBhbmRlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVlLnNsaWRlVG9nZ2xlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5pbnNlcnRCZWZvcmUoYXJyb3cpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5rLnJlbW92ZUNsYXNzKGNvbGxhcHNlZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbS5yZXF1ZXN0KHsgY21kOiAndHJlZScsIHRhcmdldDogZm0ubmF2SWQySGFzaChsaW5rLmF0dHIoJ2lkJykpIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlVHJlZShmaWx0ZXIoZGF0YS50cmVlKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHJlZS5jaGlsZHJlbigpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rLmFkZENsYXNzKGNvbGxhcHNlZCArICcgJyArIGV4cGFuZGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWUuc2xpZGVEb3duKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5bmMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWx3YXlzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGlubmVyLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuYWRkQ2xhc3MobG9hZGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoJy4nICsgbmF2ZGlyLCAnY29udGV4dG1lbnUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmbS50cmlnZ2VyKCdjb250ZXh0bWVudScsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnbmF2YmFyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RhcmdldHMnOiBbZm0ubmF2SWQySGFzaCgkKHRoaXMpLmF0dHIoJ2lkJykpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3gnOiBlLmNsaWVudFgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd5JzogZS5jbGllbnRZXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgLy8gbW92ZSB0cmVlIGludG8gbmF2YmFyXHJcbiAgICAgICAgICAgIG5hdmJhciA9IGZtLmdldFVJKCduYXZiYXInKS5hcHBlbmQodHJlZSkuc2hvdygpO1xyXG5cclxuICAgICAgICBmbS5vcGVuKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gZS5kYXRhLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpcnMgPSBmaWx0ZXIoZGF0YS5maWxlcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgZGF0YS5pbml0ICYmIHRyZWUuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZGlycy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVUcmVlKGRpcnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUFycm93cyhkaXJzLCBsb2FkZWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3luYygpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAvLyBhZGQgbmV3IGRpcnNcclxuICAgICAgICAgICAgLmFkZChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGlycyA9IGZpbHRlcihlLmRhdGEuYWRkZWQpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChkaXJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRyZWUoZGlycyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQXJyb3dzKGRpcnMsIGNvbGxhcHNlZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBjaGFuZ2VkIGRpcnNcclxuICAgICAgICAgICAgLmNoYW5nZShmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGlycyA9IGZpbHRlcihlLmRhdGEuY2hhbmdlZCksXHJcbiAgICAgICAgICAgICAgICAgICAgbCA9IGRpcnMubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpcixcclxuICAgICAgICAgICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRtcCxcclxuICAgICAgICAgICAgICAgICAgICByZWFsUGFyZW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcVBhcmVudCxcclxuICAgICAgICAgICAgICAgICAgICByZWFsU2libGluZyxcclxuICAgICAgICAgICAgICAgICAgICByZXFTaWJsaW5nLFxyXG4gICAgICAgICAgICAgICAgICAgIGlzRXhwYW5kZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNMb2FkZWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGwtLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpciA9IGRpcnNbbF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChub2RlID0gdHJlZS5maW5kKCcjJyArIGZtLm5hdkhhc2gySWQoZGlyLmhhc2gpKSkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXIucGhhc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWxQYXJlbnQgPSBub2RlLmNsb3Nlc3QoJy4nICsgc3VidHJlZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXFQYXJlbnQgPSBmaW5kU3VidHJlZShkaXIucGhhc2gpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhbFNpYmxpbmcgPSBub2RlLnBhcmVudCgpLm5leHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcVNpYmxpbmcgPSBmaW5kU2libGluZyhyZXFQYXJlbnQsIGRpcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXFQYXJlbnQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcVBhcmVudFswXSAhPT0gcmVhbFBhcmVudFswXSB8fCByZWFsU2libGluZy5nZXQoMCkgIT09IHJlcVNpYmxpbmcuZ2V0KDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxU2libGluZy5sZW5ndGggPyByZXFTaWJsaW5nLmJlZm9yZShub2RlKSA6IHJlcVBhcmVudC5hcHBlbmQobm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNFeHBhbmRlZCA9IG5vZGUuaXMoJy4nICsgZXhwYW5kZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0xvYWRlZCA9IG5vZGUuaXMoJy4nICsgbG9hZGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gJChpdGVtaHRtbChkaXIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5yZXBsYWNlV2l0aCh0bXAuY2hpbGRyZW4oJy4nICsgbmF2ZGlyKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlyLmRpcnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIChpc0V4cGFuZGVkIHx8IGlzTG9hZGVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgKG5vZGUgPSB0cmVlLmZpbmQoJyMnICsgZm0ubmF2SGFzaDJJZChkaXIuaGFzaCkpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgbm9kZS5uZXh0KCcuJyArIHN1YnRyZWUpLmNoaWxkcmVuKCkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0V4cGFuZGVkICYmIG5vZGUuYWRkQ2xhc3MoZXhwYW5kZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNMb2FkZWQgJiYgbm9kZS5hZGRDbGFzcyhsb2FkZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHN5bmMoKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZURyb3BwYWJsZSgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAvLyByZW1vdmUgZGlyc1xyXG4gICAgICAgICAgICAucmVtb3ZlKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkaXJzID0gZS5kYXRhLnJlbW92ZWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbCA9IGRpcnMubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgc3RyZWU7XHJcblxyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGwtLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgobm9kZSA9IHRyZWUuZmluZCgnIycgKyBmbS5uYXZIYXNoMklkKGRpcnNbbF0pKSkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVlID0gbm9kZS5jbG9zZXN0KCcuJyArIHN1YnRyZWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudCgpLmRldGFjaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN0cmVlLmNoaWxkcmVuKCkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJlZS5oaWRlKCkucHJldignLicgKyBuYXZkaXIpLnJlbW92ZUNsYXNzKGNvbGxhcHNlZCArICcgJyArIGV4cGFuZGVkICsgJyAnICsgbG9hZGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gYWRkL3JlbW92ZSBhY3RpdmUgY2xhc3MgZm9yIGN1cnJlbnQgZGlyXHJcbiAgICAgICAgICAgIC5iaW5kKCdzZWFyY2ggc2VhcmNoZW5kJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdHJlZS5maW5kKCcjJyArIGZtLm5hdkhhc2gySWQoZm0uY3dkKCkuaGFzaCkpW2UudHlwZSA9PSAnc2VhcmNoJyA/ICdyZW1vdmVDbGFzcycgOiAnYWRkQ2xhc3MnXShhY3RpdmUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAvLyBsb2NrL3VubG9jayBkaXJzIHdoaWxlIG1vdmluZ1xyXG4gICAgICAgICAgICAuYmluZCgnbG9ja2ZpbGVzIHVubG9ja2ZpbGVzJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxvY2sgPSBlLnR5cGUgPT0gJ2xvY2tmaWxlcycsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0ID0gbG9jayA/ICdkaXNhYmxlJyA6ICdlbmFibGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpcnMgPSAkLm1hcChlLmRhdGEuZmlsZXMgfHwgW10sIGZ1bmN0aW9uKGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpciA9IGZtLmZpbGUoaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkaXIgJiYgZGlyLm1pbWUgPT0gJ2RpcmVjdG9yeScgPyBoIDogbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICQuZWFjaChkaXJzLCBmdW5jdGlvbihpLCBoYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpciA9IHRyZWUuZmluZCgnIycgKyBmbS5uYXZIYXNoMklkKGhhc2gpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpci5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlyLmlzKCcuJyArIGRyYWdnYWJsZSkgJiYgZGlyLmRyYWdnYWJsZShhY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXIuaXMoJy4nICsgZHJvcHBhYmxlKSAmJiBkaXIuZHJvcHBhYmxlKGFjdGl2ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpcltsb2NrID8gJ2FkZENsYXNzJyA6ICdyZW1vdmVDbGFzcyddKGRpc2FibGVkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcztcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuLyoqXHJcbiAqIGVsRmluZGVyIGN1cnJlbnQgd29ya2luZyBkaXJlY3RvcnkgdWkuXHJcbiAqXHJcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XHJcbiAqKi9cclxuJC5mbi5lbGZpbmRlcmN3ZCA9IGZ1bmN0aW9uKGZtLCBvcHRpb25zKSB7XHJcblxyXG4gICAgdGhpcy5ub3QoJy5lbGZpbmRlci1jd2QnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vIGZtLnRpbWUoJ2N3ZExvYWQnKTtcclxuXHJcbiAgICAgICAgdmFyXHJcbiAgICAgICAgICAgIGxpc3QgPSBmbS52aWV3VHlwZSA9PSAnbGlzdCcsXHJcblxyXG4gICAgICAgICAgICBibG9ja011bHRpU2VsZWN0aW9uID0gbG9jYXRpb24uaHJlZi5pbmRleE9mKCdtdWx0aV9zZWxlY3Rpb249ZmFsc2UnKSAhPSAtMSxcclxuXHJcbiAgICAgICAgICAgIHVuZGVmID0gJ3VuZGVmaW5lZCcsXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBTZWxlY3QgZXZlbnQgZnVsbCBuYW1lXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIGV2dFNlbGVjdCA9ICdzZWxlY3QuJyArIGZtLm5hbWVzcGFjZSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBVbnNlbGVjdCBldmVudCBmdWxsIG5hbWVcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgZXZ0VW5zZWxlY3QgPSAndW5zZWxlY3QuJyArIGZtLm5hbWVzcGFjZSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBEaXNhYmxlIGV2ZW50IGZ1bGwgbmFtZVxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBldnREaXNhYmxlID0gJ2Rpc2FibGUuJyArIGZtLm5hbWVzcGFjZSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBEaXNhYmxlIGV2ZW50IGZ1bGwgbmFtZVxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBldnRFbmFibGUgPSAnZW5hYmxlLicgKyBmbS5uYW1lc3BhY2UsXHJcblxyXG4gICAgICAgICAgICBjID0gJ2NsYXNzJyxcclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIEZpbGUgY3NzIGNsYXNzXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIGNsRmlsZSA9IGZtLnJlcyhjLCAnY3dkZmlsZScpLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIFNlbGVjdGVkIGNzcyBjbGFzc1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBmaWxlU2VsZWN0b3IgPSAnLicgKyBjbEZpbGUsXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogU2VsZWN0ZWQgY3NzIGNsYXNzXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIGNsU2VsZWN0ZWQgPSAndWktc2VsZWN0ZWQnLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIERpc2FibGVkIGNzcyBjbGFzc1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBjbERpc2FibGVkID0gZm0ucmVzKGMsICdkaXNhYmxlZCcpLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIERyYWdnYWJsZSBjc3MgY2xhc3NcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgY2xEcmFnZ2FibGUgPSBmbS5yZXMoYywgJ2RyYWdnYWJsZScpLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIERyb3BwYWJsZSBjc3MgY2xhc3NcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgY2xEcm9wcGFibGUgPSBmbS5yZXMoYywgJ2Ryb3BwYWJsZScpLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIEhvdmVyIGNzcyBjbGFzc1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBjbEhvdmVyID0gZm0ucmVzKGMsICdob3ZlcicpLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIEhvdmVyIGNzcyBjbGFzc1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBjbERyb3BBY3RpdmUgPSBmbS5yZXMoYywgJ2Fkcm9wcGFibGUnKSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBDc3MgY2xhc3MgZm9yIHRlbXBvcmFyeSBub2RlcyAoZm9yIG1rZGlyL21rZmlsZSkgY29tbWFuZHNcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgU3RyaW5nXHJcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgY2xUbXAgPSBjbEZpbGUgKyAnLXRtcCcsXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogTnVtYmVyIG9mIHRodW1ibmFpbHMgdG8gbG9hZCBpbiBvbmUgcmVxdWVzdCAobmV3IGFwaSBvbmx5KVxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBOdW1iZXJcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICB0bWJOdW0gPSBmbS5vcHRpb25zLmxvYWRUbWJzID4gMCA/IGZtLm9wdGlvbnMubG9hZFRtYnMgOiA1LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIEN1cnJlbnQgc2VhcmNoIHF1ZXJ5LlxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBTdHJpbmdcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIHF1ZXJ5ID0gJycsXHJcblxyXG4gICAgICAgICAgICBsYXN0U2VhcmNoID0gW10sXHJcblxyXG4gICAgICAgICAgICBsYXN0RmlsdGVyID0gW10sXHJcblxyXG4gICAgICAgICAgICBjdXN0b21Db2xzQnVpbGQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjdXN0b21Db2xzID0gJyc7XHJcbiAgICAgICAgICAgICAgICB2YXIgY29sdW1ucyA9IGZtLm9wdGlvbnMudWlPcHRpb25zLmN3ZC5saXN0Vmlldy5jb2x1bW5zO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2x1bW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tQ29scyArPSAnPHRkIGNsYXNzPVwiJyArIGNvbHVtbnNbaV0gKyAnXCIgdGl0bGU9XCJ7JyArIGNvbHVtbnNbaV0gKyAnfVwiPnsnICsgY29sdW1uc1tpXSArICd9PC90ZD4nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1c3RvbUNvbHM7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBjaGVja2JveGZvcmJsb2NrID0gJzxzcGFuIGNsYXNzPVwiYnV0dG9uLWNoZWNrYm94IGJvb3RzdHJhcC1jaGVja2JveFwiIHN0eWxlPVwie2NoYnN0eWxlfVwiPicgK1xyXG4gICAgICAgICAgICAgICAgJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjbGFzcz1cIntjbGFzc31cIiBhdXRvY29tcGxldGU9XCJvZmZcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJpY29uIGNiLWljb24tY2hlY2sgc3F1YXJlXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPjwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImljb24gY2ItaWNvbi1jaGVjay1lbXB0eSBzcXVhcmVcIj48L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAnPC9zcGFuPicsXHJcbiAgICAgICAgICAgIGNoZWNrYm94ID0gJzxzcGFuIGNsYXNzPVwiYnV0dG9uLWNoZWNrYm94IGJvb3RzdHJhcC1jaGVja2JveFwiIHN0eWxlPVwie2NoYnN0eWxlfVwiPicgK1xyXG4gICAgICAgICAgICAgICAgJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjbGFzcz1cIntjbGFzc31cIiBhdXRvY29tcGxldGU9XCJvZmZcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJpY29uIGNiLWljb24tY2hlY2sgc3F1YXJlXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPjwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImljb24gY2ItaWNvbi1jaGVjay1lbXB0eSBzcXVhcmVcIj48L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAnPC9zcGFuPicsXHJcbiAgICAgICAgICAgIENCYm9keSA9IGNoZWNrYm94LnJlcGxhY2UoJ3tjbGFzc30nLCAnJyksXHJcbiAgICAgICAgICAgIENCaGVhZCA9IGJsb2NrTXVsdGlTZWxlY3Rpb24gPyBjaGVja2JveC5yZXBsYWNlKCd7Y2xhc3N9JywgJ3NlbGVjdEFsbENoQicpLnJlcGxhY2UoJ3tjaGJzdHlsZX0nLCAnZGlzcGxheTogbm9uZTsnKSA6IGNoZWNrYm94LnJlcGxhY2UoJ3tjbGFzc30nLCAnc2VsZWN0QWxsQ2hCJykucmVwbGFjZSgne2NoYnN0eWxlfScsICcnKSxcclxuXHJcbiAgICAgICAgICAgIENCU3F1YXJlQm9keSA9IGNoZWNrYm94Zm9yYmxvY2sucmVwbGFjZSgne2NsYXNzfScsICcnKSxcclxuICAgICAgICAgICAgQ0JTcXVhcmVIZWFkID0gYmxvY2tNdWx0aVNlbGVjdGlvbiA/IGNoZWNrYm94Zm9yYmxvY2sucmVwbGFjZSgne2NsYXNzfScsICdzZWxlY3RBbGxDaEInKS5yZXBsYWNlKCd7Y2hic3R5bGV9JywgJ2Rpc3BsYXk6IG5vbmU7JykgOiBjaGVja2JveGZvcmJsb2NrLnJlcGxhY2UoJ3tjbGFzc30nLCAnc2VsZWN0QWxsQ2hCJykucmVwbGFjZSgne2NoYnN0eWxlfScsICdkaXNwbGF5OiBibG9jazsnKSxcclxuICAgICAgICAgICAgc2VsZWN0QWxsQmxvY2sgPSAnPHRhYmxlIGNsYXNzPVwiaWNvbnMtdGFibGUgdGhlYWRcIj48dGhlYWQ+PHRyIGNsYXNzPVwidWktc3RhdGUtZGVmYXVsdFwiPjx0ZD4nICsgQ0JTcXVhcmVIZWFkICsgJyA8c3BhbiBjbGFzcz1cInNlbGVjdGFsbHRleHRcIj4nICsgZm0uaTE4bignc2VsZWN0YWxsJykgKyAnPC9zcGFuPjwvdGQ+PC90cj48L3RoZWFkPjwvdGFibGU+JyxcclxuXHJcbiAgICAgICAgICAgIGNoYW5nZSA9IGZ1bmN0aW9uKGNoZWNrYm94KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJChjaGVja2JveCkuaXMoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrID0gJChjaGVja2JveCkucGFyZW50KCkuZmluZChcIi5jYi1pY29uLWNoZWNrXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbXB0eSA9ICQoY2hlY2tib3gpLnBhcmVudCgpLmZpbmQoXCIuY2ItaWNvbi1jaGVjay1lbXB0eVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNrYm94LmlzKCc6Y2hlY2tlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW1wdHkuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW1wdHkuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGdldFRhcmdldCA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRhcmc7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IG9iajtcclxuICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldCkgdGFyZyA9IGUudGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZS5zcmNFbGVtZW50KSB0YXJnID0gZS5zcmNFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKHRhcmcubm9kZVR5cGUgPT0gMykgLy8gZGVmZWF0IFNhZmFyaSBidWdcclxuICAgICAgICAgICAgICAgICAgICB0YXJnID0gdGFyZy5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmc7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogRmlsZSB0ZW1wbGF0ZXNcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgT2JqZWN0XHJcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgdGVtcGxhdGVzID0ge1xyXG4gICAgICAgICAgICAgICAgaWNvbjogJzxkaXYgaWQ9XCJ7aGFzaH1cIiBjbGFzcz1cIicgKyBjbEZpbGUgKyAnIHtwZXJtc2NsYXNzfSB7ZGlyY2xhc3N9IHVpLWNvcm5lci1hbGxcIiB0aXRsZT1cInt0b29sdGlwfVwiPicgKyBDQlNxdWFyZUJvZHkgKyAnPGRpdiBjbGFzcz1cImVsZmluZGVyLWN3ZC1maWxlLXdyYXBwZXIgdWktY29ybmVyLWFsbFwiPjxkaXYgY2xhc3M9XCJlbGZpbmRlci1jd2QtaWNvbiB7bWltZX0gdWktY29ybmVyLWFsbFwiIHVuc2VsZWN0YWJsZT1cIm9uXCIge3N0eWxlfS8+e21hcmtlcn08L2Rpdj48ZGl2IGNsYXNzPVwiZWxmaW5kZXItY3dkLWZpbGVuYW1lXCIgdGl0bGU9XCJ7bmFtZX1cIj57bmFtZX08L2Rpdj48L2Rpdj4nLFxyXG4gICAgICAgICAgICAgICAgLy9yb3c6ICc8dHIgaWQ9XCJ7aGFzaH1cIiBjbGFzcz1cIicgKyBjbEZpbGUgKyAnIHtwZXJtc2NsYXNzfSB7ZGlyY2xhc3N9XCIgdGl0bGU9XCJ7dG9vbHRpcH1cIj48dGQ+PGRpdiBjbGFzcz1cImVsZmluZGVyLWN3ZC1maWxlLXdyYXBwZXJcIj48c3BhbiBjbGFzcz1cImVsZmluZGVyLWN3ZC1pY29uIHttaW1lfVwiLz57bWFya2VyfTxzcGFuIGNsYXNzPVwiZWxmaW5kZXItY3dkLWZpbGVuYW1lXCI+e25hbWV9PC9zcGFuPjwvZGl2PjwvdGQ+PHRkPntwZXJtc308L3RkPjx0ZD57ZGF0ZX08L3RkPjx0ZD57c2l6ZX08L3RkPjx0ZD57a2luZH08L3RkPjwvdHI+J1xyXG4gICAgICAgICAgICAgICAgcm93OiAnPHRyIGlkPVwie2hhc2h9XCIgY2xhc3M9XCInICsgY2xGaWxlICsgJyB7cGVybXNjbGFzc30ge2RpcmNsYXNzfVwiID48dGQgY2xhc3M9XCJjaGJcIiA+JyArIENCYm9keSArICc8L3RkPjx0ZCBjbGFzcz1cIm5hbWVcIiB0aXRsZT1cInt0b29sdGlwfVwiPjxkaXYgY2xhc3M9XCJlbGZpbmRlci1jd2QtZmlsZS13cmFwcGVyXCI+PHNwYW4gY2xhc3M9XCJlbGZpbmRlci1jd2QtaWNvbiB7bWltZX1cIi8+e21hcmtlcn08c3BhbiBjbGFzcz1cImVsZmluZGVyLWN3ZC1maWxlbmFtZVwiPntuYW1lfTwvc3Bhbj48L2Rpdj48L3RkPicgKyBjdXN0b21Db2xzQnVpbGQoKSArICc8L3RyPidcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIHBlcm1zVHBsID0gZm0ucmVzKCd0cGwnLCAncGVybXMnKSxcclxuXHJcbiAgICAgICAgICAgIHN5bWxpbmtUcGwgPSBmbS5yZXMoJ3RwbCcsICdzeW1saW5rJyksXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogVGVtcGxhdGUgcGxhY2Vob2xkZXJzIHJlcGxhY2VtZW50IHJ1bGVzXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIE9iamVjdFxyXG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIHJlcGxhY2VtZW50ID0ge1xyXG4gICAgICAgICAgICAgICAgcGVybXNjbGFzczogZnVuY3Rpb24oZikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbS5wZXJtczJjbGFzcyhmKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBwZXJtczogZnVuY3Rpb24oZikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbS5mb3JtYXRQZXJtaXNzaW9ucyhmKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBkaXJjbGFzczogZnVuY3Rpb24oZikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmLm1pbWUgPT0gJ2RpcmVjdG9yeScgPyAnZGlyZWN0b3J5JyA6ICcnO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG1pbWU6IGZ1bmN0aW9uKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm0ubWltZTJjbGFzcyhmLm1pbWUpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6IGZ1bmN0aW9uKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm0uZm9ybWF0U2l6ZShmLnNpemUpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGRhdGU6IGZ1bmN0aW9uKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm0uZm9ybWF0RGF0ZShmKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBraW5kOiBmdW5jdGlvbihmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZtLm1pbWUya2luZChmKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBtYXJrZXI6IGZ1bmN0aW9uKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGYuYWxpYXMgfHwgZi5taW1lID09ICdzeW1saW5rLWJyb2tlbicgPyBzeW1saW5rVHBsIDogJycpICsgKCFmLnJlYWQgfHwgIWYud3JpdGUgPyBwZXJtc1RwbCA6ICcnKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0b29sdGlwOiBmdW5jdGlvbihmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy92YXIgdGl0bGUgPSBmbS5mb3JtYXREYXRlKGYpICsgKGYuc2l6ZSA+IDAgPyAnICgnK2ZtLmZvcm1hdFNpemUoZi5zaXplKSsnKScgOiAnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gZi5uYW1lICsgKGYuc2l6ZSA+IDAgPyAnICgnICsgZm0uZm9ybWF0U2l6ZShmLnNpemUpICsgJyknIDogJycpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmLnRvb2x0aXAgPyBmbS5lc2NhcGUoZi50b29sdGlwKS5yZXBsYWNlKC9cIi9nLCAnJnF1b3Q7JykucmVwbGFjZSgvXFxyL2csICcmIzEzOycpICsgJyYjMTM7JyArIHRpdGxlIDogdGl0bGU7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc3R5bGVmb3Jmb2xkZXI6IGZ1bmN0aW9uKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZi5taW1lID09ICdkaXJlY3RvcnknID8gJ2Rpc3BsYXk6bm9uZTsnIDogJyc7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgY2hic3R5bGU6IGZ1bmN0aW9uKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm0uaXNNb2RhbCAmJiBmLm1pbWUgPT0gJ2RpcmVjdG9yeScgPyAnZGlzcGxheTpub25lOycgOiAnJztcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogUmV0dXJuIGZpbGUgaHRtbFxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAcGFyYW0gIE9iamVjdCAgZmlsZSBpbmZvXHJcblx0XHRcdCAqIEByZXR1cm4gU3RyaW5nXHJcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgaXRlbWh0bWwgPSBmdW5jdGlvbihmKSB7XHJcbiAgICAgICAgICAgICAgICBmLm5hbWUgPSBmbS5lc2NhcGUoZi5uYW1lKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZXNbbGlzdCA/ICdyb3cnIDogJ2ljb24nXVxyXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXHsoW2Etel0rKVxcfS9nLCBmdW5jdGlvbihzLCBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXBsYWNlbWVudFtlXSA/IHJlcGxhY2VtZW50W2VdKGYpIDogKGZbZV0gPyBmW2VdIDogJycpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIEZsYWcuIFJlcXVpcmVkIGZvciBtc2llIHRvIGF2b2lkIHVuc2VsZWN0IGZpbGVzIG9uIGRyYWdzdGFydFxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBCb29sZWFuXHJcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgc2VsZWN0TG9jayA9IGZhbHNlLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIE1vdmUgc2VsZWN0aW9uIHRvIHByZXYvbmV4dCBmaWxlXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEBwYXJhbSBTdHJpbmcgIG1vdmUgZGlyZWN0aW9uXHJcblx0XHRcdCAqIEBwYXJhbSBCb29sZWFuIGFwcGVuZCB0byBjdXJyZW50IHNlbGVjdGlvblxyXG5cdFx0XHQgKiBAcmV0dXJuIHZvaWRcclxuXHRcdFx0ICogQHJpc2Ugc2VsZWN0XHRcdFx0XHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBzZWxlY3QgPSBmdW5jdGlvbihrZXlDb2RlLCBhcHBlbmQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjb2RlID0gJC51aS5rZXlDb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXYgPSBrZXlDb2RlID09IGNvZGUuTEVGVCB8fCBrZXlDb2RlID09IGNvZGUuVVAsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsID0gY3dkLmZpbmQoJ1tpZF0uJyArIGNsU2VsZWN0ZWQpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yID0gcHJldiA/ICdmaXJzdDonIDogJ2xhc3QnLFxyXG4gICAgICAgICAgICAgICAgICAgIHMsXHJcbiAgICAgICAgICAgICAgICAgICAgbixcclxuICAgICAgICAgICAgICAgICAgICBzaWIsXHJcbiAgICAgICAgICAgICAgICAgICAgdG9wLFxyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc2libGluZyhuLCBkaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbltkaXJlY3Rpb24gKyAnQWxsJ10oJ1tpZF06bm90KC4nICsgY2xEaXNhYmxlZCArICcpOm5vdCguZWxmaW5kZXItY3dkLXBhcmVudCk6Zmlyc3QnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHMgPSBzZWwuZmlsdGVyKHByZXYgPyAnOmZpcnN0JyA6ICc6bGFzdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNpYiA9IHNpYmxpbmcocywgcHJldiA/ICdwcmV2JyA6ICduZXh0Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2liLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGVyZSBpcyBubyBzaWJsaW5nIG9uIHJlcXVpcmVkIHNpZGUgLSBkbyBub3QgbW92ZSBzZWxlY3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgbiA9IHM7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaXN0IHx8IGtleUNvZGUgPT0gY29kZS5MRUZUIHx8IGtleUNvZGUgPT0gY29kZS5SSUdIVCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmaW5kIHJlYWwgcHJldm9pdXMgZmlsZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gc2liO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZpbmQgdXAvZG93biBzaWRlIGZpbGUgaW4gaWNvbnMgdmlld1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBzLnBvc2l0aW9uKCkudG9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gcy5wb3NpdGlvbigpLmxlZnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gbi5wcmV2KCdbaWRdJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IHdoaWxlIChuLmxlbmd0aCAmJiAhKG4ucG9zaXRpb24oKS50b3AgPCB0b3AgJiYgbi5wb3NpdGlvbigpLmxlZnQgPD0gbGVmdCkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmlzKCcuJyArIGNsRGlzYWJsZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IHNpYmxpbmcobiwgJ25leHQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gbi5uZXh0KCdbaWRdJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IHdoaWxlIChuLmxlbmd0aCAmJiAhKG4ucG9zaXRpb24oKS50b3AgPiB0b3AgJiYgbi5wb3NpdGlvbigpLmxlZnQgPj0gbGVmdCkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmlzKCcuJyArIGNsRGlzYWJsZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IHNpYmxpbmcobiwgJ3ByZXYnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZXJlIGlzIHJvdyBiZWZvcmUgbGFzdCBvbmUgLSBzZWxlY3QgbGFzdCBmaWxlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2liID0gY3dkLmZpbmQoJ1tpZF06bm90KC4nICsgY2xEaXNhYmxlZCArICcpOmxhc3QnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2liLnBvc2l0aW9uKCkudG9wID4gdG9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBzaWI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vICFhcHBlbmQgJiYgdW5zZWxlY3RBbGwoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlcmUgYXJlIG5vIHNlbGVjdGVkIGZpbGUgLSBzZWxlY3QgZmlyc3QvbGFzdCBvbmVcclxuICAgICAgICAgICAgICAgICAgICBuID0gY3dkLmZpbmQoJ1tpZF06bm90KC4nICsgY2xEaXNhYmxlZCArICcpOm5vdCguZWxmaW5kZXItY3dkLXBhcmVudCk6JyArIChwcmV2ID8gJ2xhc3QnIDogJ2ZpcnN0JykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChuICYmIG4ubGVuZ3RoICYmICFuLmlzKCcuZWxmaW5kZXItY3dkLXBhcmVudCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFwcGVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhcHBlbmQgbmV3IGZpbGVzIHRvIHNlbGVjdGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBzLmFkZChzW3ByZXYgPyAncHJldlVudGlsJyA6ICduZXh0VW50aWwnXSgnIycgKyBuLmF0dHIoJ2lkJykpKS5hZGQobik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW5zZWxlY3Qgc2VsZWN0ZWQgZmlsZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsLnRyaWdnZXIoZXZ0VW5zZWxlY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyBzZWxlY3QgZmlsZShzKVxyXG4gICAgICAgICAgICAgICAgICAgIG4udHJpZ2dlcihldnRTZWxlY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCBpdHMgdmlzaWJsZVxyXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvVmlldyhuLmZpbHRlcihwcmV2ID8gJzpmaXJzdCcgOiAnOmxhc3QnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIGNhY2hlL3ZpZXdcclxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBzZWxlY3RlZEZpbGVzID0gW10sXHJcblxyXG4gICAgICAgICAgICBzZWxlY3RGaWxlID0gZnVuY3Rpb24oaGFzaCkge1xyXG4gICAgICAgICAgICAgICAgY3dkLmZpbmQoJyMnICsgaGFzaCkudHJpZ2dlcihldnRTZWxlY3QpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgc2VsZWN0QWxsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYmxvY2tNdWx0aVNlbGVjdGlvbikgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBoYXNoID0gZm0uY3dkKCkuaGFzaDtcclxuICAgICAgICAgICAgICAgIGN3ZC5wYXJlbnQoKS5maW5kKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0uc2VsZWN0QWxsQ2hCJykucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2UoY3dkLnBhcmVudCgpLmZpbmQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXS5zZWxlY3RBbGxDaEInKSk7XHJcbiAgICAgICAgICAgICAgICBjd2QuZmluZCgnW2lkXTpub3QoLicgKyBjbFNlbGVjdGVkICsgJyk6bm90KC5lbGZpbmRlci1jd2QtcGFyZW50KScpLnRyaWdnZXIoZXZ0U2VsZWN0KTtcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZXMgPSAkLm1hcChmbS5maWxlcygpLCBmdW5jdGlvbihmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZtLmlzTW9kYWwgJiYgZi5taW1lID09ICdkaXJlY3RvcnknID8gbnVsbCA6IGYucGhhc2ggPT0gcGhhc2ggPyBmLmhhc2ggOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyKCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogVW5zZWxlY3QgYWxsIGZpbGVzXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEByZXR1cm4gdm9pZFxyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgdW5zZWxlY3RBbGwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIGN3ZC5wYXJlbnQoKS5maW5kKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0uc2VsZWN0QWxsQ2hCJykucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlKGN3ZC5wYXJlbnQoKS5maW5kKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0uc2VsZWN0QWxsQ2hCJykpO1xyXG4gICAgICAgICAgICAgICAgY3dkLmZpbmQoJ1tpZF0uJyArIGNsU2VsZWN0ZWQpLnRyaWdnZXIoZXZ0VW5zZWxlY3QpO1xyXG4gICAgICAgICAgICAgICAgdHJpZ2dlcigpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIFJldHVybiBzZWxlY3RlZCBmaWxlcyBoYXNoZXMgbGlzdFxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAcmV0dXJuIEFycmF5XHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBzZWxlY3RlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkRmlsZXM7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogRmlyZSBlbGZpbmRlciBcInNlbGVjdFwiIGV2ZW50IGFuZCBwYXNzIHNlbGVjdGVkIGZpbGVzIHRvIGl0XHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEByZXR1cm4gdm9pZFxyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgdHJpZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZm0udHJpZ2dlcignc2VsZWN0JywgeyBzZWxlY3RlZDogc2VsZWN0ZWRGaWxlcyB9KTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBTY3JvbGwgZmlsZSB0byBzZXQgaXQgdmlzaWJsZVxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAcGFyYW0gRE9NRWxlbWVudCAgZmlsZS9kaXIgbm9kZVxyXG5cdFx0XHQgKiBAcmV0dXJuIHZvaWRcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIHNjcm9sbFRvVmlldyA9IGZ1bmN0aW9uKG8pIHtcclxuICAgICAgICAgICAgICAgIHZhciBmdG9wID0gby5wb3NpdGlvbigpLnRvcCxcclxuICAgICAgICAgICAgICAgICAgICBmaGVpZ2h0ID0gby5vdXRlckhlaWdodCh0cnVlKSxcclxuICAgICAgICAgICAgICAgICAgICB3dG9wID0gd3JhcHBlci5zY3JvbGxUb3AoKSxcclxuICAgICAgICAgICAgICAgICAgICB3aGVpZ2h0ID0gd3JhcHBlci5pbm5lckhlaWdodCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmdG9wICsgZmhlaWdodCA+IHd0b3AgKyB3aGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5zY3JvbGxUb3AocGFyc2VJbnQoZnRvcCArIGZoZWlnaHQgLSB3aGVpZ2h0KSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZ0b3AgPCB3dG9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5zY3JvbGxUb3AoZnRvcCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogRmlsZXMgd2UgZ2V0IGZyb20gc2VydmVyIGJ1dCBub3Qgc2hvdyB5ZXRcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHR5cGUgQXJyYXlcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBidWZmZXIgPSBbXSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBSZXR1cm4gaW5kZXggb2YgZWxlbWVudHMgd2l0aCByZXF1aXJlZCBoYXNoIGluIGJ1ZmZlciBcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHBhcmFtIFN0cmluZyAgZmlsZSBoYXNoXHJcblx0XHRcdCAqIEByZXR1cm4gTnVtYmVyXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBpbmRleCA9IGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsID0gYnVmZmVyLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobC0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJ1ZmZlcltsXS5oYXNoID09IGhhc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIFNjcm9sbCBldmVudCBuYW1lXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEB0eXBlIFN0cmluZ1xyXG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIHNjcm9sbEV2ZW50ID0gJ3Njcm9sbC4nICsgZm0ubmFtZXNwYWNlLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIEN3ZCBzY3JvbGwgZXZlbnQgaGFuZGxlci5cclxuXHRcdFx0ICogTGF6eSBsb2FkIC0gYXBwZW5kIHRvIGN3ZCBub3Qgc2hvd24gZmlsZXNcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHJldHVybiB2b2lkXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICByZW5kZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBodG1sID0gW10sXHJcbiAgICAgICAgICAgICAgICAgICAgZGlycyA9IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGx0bWIgPSBbXSxcclxuICAgICAgICAgICAgICAgICAgICBhdG1iID0ge30sXHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdCA9IGN3ZC5maW5kKCdbaWRdOmxhc3QnKSxcclxuICAgICAgICAgICAgICAgICAgICB0b3AgPSAhbGFzdC5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2UgPSBsaXN0ID8gY3dkLmNoaWxkcmVuKCd0YWJsZScpLmNoaWxkcmVuKCd0Ym9keScpIDogY3dkLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVzO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghYnVmZmVyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB3cmFwcGVyLnVuYmluZChzY3JvbGxFdmVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgd2hpbGUgKCghbGFzdC5sZW5ndGggfHwgbGFzdC5wb3NpdGlvbigpLnRvcCA8PSB3cmFwcGVyLmhlaWdodCgpICsgd3JhcHBlci5zY3JvbGxUb3AoKSArIGZtLm9wdGlvbnMuc2hvd1RocmVzaG9sZClcclxuICAgICAgICAgICAgICAgICAgICAmJiAoZmlsZXMgPSBidWZmZXIuc3BsaWNlKDAsIGZtLm9wdGlvbnMuc2hvd0ZpbGVzKSkubGVuZ3RoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGh0bWwgPSAkLm1hcChmaWxlcywgZnVuY3Rpb24oZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZi5oYXNoICYmIGYubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYubWltZSA9PSAnZGlyZWN0b3J5Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpcnMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYudG1iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZi50bWIgPT09IDEgPyBsdG1iLnB1c2goZi5oYXNoKSA6IChhdG1iW2YuaGFzaF0gPSBmLnRtYik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbWh0bWwoZik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlLmFwcGVuZChodG1sLmpvaW4oJycpKTtcclxuICAgICAgICAgICAgICAgICAgICBsYXN0ID0gY3dkLmZpbmQoJ1tpZF06bGFzdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNjcm9sbCB0b3Agb24gZGlyIGxvYWQgdG8gYXZvaWQgc2Nyb2xsIGFmdGVyIHBhZ2UgcmVsb2FkXHJcbiAgICAgICAgICAgICAgICAgICAgdG9wICYmIGN3ZC5zY3JvbGxUb3AoMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGxvYWQvYXR0YWNoIHRodW1ibmFpbHNcclxuICAgICAgICAgICAgICAgIGF0dGFjaFRodW1ibmFpbHMoYXRtYik7XHJcbiAgICAgICAgICAgICAgICBsdG1iLmxlbmd0aCAmJiBsb2FkVGh1bWJuYWlscyhsdG1iKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBtYWtlIGRpcmVjdG9yeSBkcm9wcGFibGVcclxuICAgICAgICAgICAgICAgIGRpcnMgJiYgbWFrZURyb3BwYWJsZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZEZpbGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlLmZpbmQoJ1tpZF06bm90KC4nICsgY2xTZWxlY3RlZCArICcpOm5vdCguZWxmaW5kZXItY3dkLXBhcmVudCknKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSB0aGlzLmlkO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5pbkFycmF5KGlkLCBzZWxlY3RlZEZpbGVzKSAhPT0gLTEgJiYgJCh0aGlzKS50cmlnZ2VyKGV2dFNlbGVjdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIERyb3BwYWJsZSBvcHRpb25zIGZvciBjd2QuXHJcblx0XHRcdCAqIERvIG5vdCBhZGQgY2xhc3Mgb24gY2hpbGRzIGZpbGUgb3ZlclxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBPYmplY3RcclxuXHRcdFx0ICovXHJcbiAgICAgICAgICAgIGRyb3BwYWJsZSA9ICQuZXh0ZW5kKHt9LCBmbS5kcm9wcGFibGUsIHtcclxuICAgICAgICAgICAgICAgIG92ZXI6IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhhc2ggPSBmbS5jd2QoKS5oYXNoO1xyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaCh1aS5oZWxwZXIuZGF0YSgnZmlsZXMnKSwgZnVuY3Rpb24oaSwgaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm0uZmlsZShoKS5waGFzaCA9PSBoYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjd2QucmVtb3ZlQ2xhc3MoY2xEcm9wQWN0aXZlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBNYWtlIGRpcmVjdG9yeSBkcm9wcGFibGVcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHJldHVybiB2b2lkXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBtYWtlRHJvcHBhYmxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN3ZC5maW5kKCcuZGlyZWN0b3J5Om5vdCguJyArIGNsRHJvcHBhYmxlICsgJywuZWxmaW5kZXItbmEsLmVsZmluZGVyLXJvKScpLmRyb3BwYWJsZShmbS5kcm9wcGFibGUpO1xyXG4gICAgICAgICAgICAgICAgfSwgMjApO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIFByZWxvYWQgcmVxdWlyZWQgdGh1bWJuYWlscyBhbmQgb24gbG9hZCBhZGQgY3NzIHRvIGZpbGVzLlxyXG5cdFx0XHQgKiBSZXR1cm4gZmFsc2UgaWYgcmVxdWlyZWQgZmlsZSBpcyBub3QgdmlzaWJsZSB5ZXQgKGluIGJ1ZmZlcikgLVxyXG5cdFx0XHQgKiByZXF1aXJlZCBmb3Igb2xkIGFwaSB0byBzdG9wIGxvYWRpbmcgdGh1bWJuYWlscy5cclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHBhcmFtICBPYmplY3QgIGZpbGUgaGFzaCAtPiB0aHVtYm5haWwgbWFwXHJcblx0XHRcdCAqIEByZXR1cm4gQm9vbGVhblxyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgYXR0YWNoVGh1bWJuYWlscyA9IGZ1bmN0aW9uKGltYWdlcykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IGZtLm9wdGlvbigndG1iVXJsJyksXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0ID0gdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBuZHg7XHJcblxyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGltYWdlcywgZnVuY3Rpb24oaGFzaCwgdG1iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBjd2QuZmluZCgnIycgKyBoYXNoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubGVuZ3RoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24obm9kZSwgdG1iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCc8aW1nLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5sb2FkKGZ1bmN0aW9uKCkgeyBub2RlLmZpbmQoJy5lbGZpbmRlci1jd2QtaWNvbicpLmNzcygnYmFja2dyb3VuZCcsIFwidXJsKCdcIiArIHRtYiArIFwiJykgY2VudGVyIGNlbnRlciBuby1yZXBlYXRcIik7IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3NyYycsIHRtYik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKG5vZGUsIHVybCArIHRtYik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgobmR4ID0gaW5kZXgoaGFzaCkpICE9IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWZmZXJbbmR4XS50bWIgPSB0bWI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogTG9hZCB0aHVtYm5haWxzIGZyb20gYmFja2VuZC5cclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHBhcmFtICBBcnJheXxCb29sZWFuICBmaWxlcyBoYXNoZXMgbGlzdCBmb3IgbmV3IGFwaSB8IHRydWUgZm9yIG9sZCBhcGlcclxuXHRcdFx0ICogQHJldHVybiB2b2lkXHJcblx0XHRcdCAqL1xyXG4gICAgICAgICAgICBsb2FkVGh1bWJuYWlscyA9IGZ1bmN0aW9uKGZpbGVzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdG1icyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmbS5vbGRBUEkpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAndG1iJywgY3VycmVudDogZm0uY3dkKCkuaGFzaCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmVudEZhaWw6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dGFjaFRodW1ibmFpbHMoZGF0YS5pbWFnZXMgfHwgW10pICYmIGRhdGEudG1iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFRodW1ibmFpbHMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRtYnMgPSB0bWJzID0gZmlsZXMuc3BsaWNlKDAsIHRtYk51bSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodG1icy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAndG1iJywgdGFyZ2V0czogdG1icyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmVudEZhaWw6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dGFjaFRodW1ibmFpbHMoZGF0YS5pbWFnZXMgfHwgW10pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFRodW1ibmFpbHMoZmlsZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG5cdFx0XHQgKiBBZGQgbmV3IGZpbGVzIHRvIGN3ZC9idWZmZXJcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHBhcmFtICBBcnJheSAgbmV3IGZpbGVzXHJcblx0XHRcdCAqIEByZXR1cm4gdm9pZFxyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgYWRkID0gZnVuY3Rpb24oZmlsZXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwbGFjZSA9IGxpc3QgPyBjd2QuZmluZCgndGJvZHknKSA6IGN3ZCxcclxuICAgICAgICAgICAgICAgICAgICBsID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgIGx0bWIgPSBbXSxcclxuICAgICAgICAgICAgICAgICAgICBhdG1iID0ge30sXHJcbiAgICAgICAgICAgICAgICAgICAgZGlycyA9IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbmROb2RlID0gZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnRlciA9IGN3ZC5maW5kKCdbaWRdOmZpcnN0JyksIGZpbGUyO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHBvaW50ZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlMiA9IGZtLmZpbGUocG9pbnRlci5hdHRyKCdpZCcpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcG9pbnRlci5pcygnLmVsZmluZGVyLWN3ZC1wYXJlbnQnKSAmJiBmaWxlMiAmJiBmbS5jb21wYXJlKGZpbGUsIGZpbGUyKSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9pbnRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXIgPSBwb2ludGVyLm5leHQoJ1tpZF0nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZmluZEluZGV4ID0gZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IGJ1ZmZlci5sZW5ndGgsIGk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm0uY29tcGFyZShmaWxlLCBidWZmZXJbaV0pIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsIHx8IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZSxcclxuICAgICAgICAgICAgICAgICAgICBoYXNoLFxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgbmR4O1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobC0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZSA9IGZpbGVzW2xdO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc2ggPSBmaWxlLmhhc2g7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjd2QuZmluZCgnIycgKyBoYXNoKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoKG5vZGUgPSBmaW5kTm9kZShmaWxlKSkgJiYgbm9kZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5iZWZvcmUoaXRlbWh0bWwoZmlsZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKG5keCA9IGZpbmRJbmRleChmaWxlKSkgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWZmZXIuc3BsaWNlKG5keCwgMCwgZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2UuYXBwZW5kKGl0ZW1odG1sKGZpbGUpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjd2QuZmluZCgnIycgKyBoYXNoKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUubWltZSA9PSAnZGlyZWN0b3J5Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlycyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZS50bWIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUudG1iID09PSAxID8gbHRtYi5wdXNoKGhhc2gpIDogKGF0bWJbaGFzaF0gPSBmaWxlLnRtYik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY2hlY2tDd2RFbXB0eSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGF0dGFjaFRodW1ibmFpbHMoYXRtYik7XHJcbiAgICAgICAgICAgICAgICBsdG1iLmxlbmd0aCAmJiBsb2FkVGh1bWJuYWlscyhsdG1iKTtcclxuICAgICAgICAgICAgICAgIGRpcnMgJiYgbWFrZURyb3BwYWJsZSgpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIFJlbW92ZSBmaWxlcyBmcm9tIGN3ZC9idWZmZXJcclxuXHRcdFx0ICpcclxuXHRcdFx0ICogQHBhcmFtICBBcnJheSAgZmlsZXMgaGFzaGVzXHJcblx0XHRcdCAqIEByZXR1cm4gdm9pZFxyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgcmVtb3ZlID0gZnVuY3Rpb24oZmlsZXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsID0gZmlsZXMubGVuZ3RoLCBoYXNoLCBuLCBuZHg7XHJcblxyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGwtLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc2ggPSBmaWxlc1tsXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKG4gPSBjd2QuZmluZCgnIycgKyBoYXNoKSkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmRldGFjaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbS5kZWJ1ZygnZXJyb3InLCBlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKG5keCA9IGluZGV4KGhhc2gpKSAhPSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWZmZXIuc3BsaWNlKG5keCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNoZWNrQ3dkRW1wdHkoKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIG1zZyA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IGZtLmkxOG4oJ25hbWUnKSxcclxuICAgICAgICAgICAgICAgIHBlcm06IGZtLmkxOG4oJ3Blcm1zJyksXHJcbiAgICAgICAgICAgICAgICBtb2Q6IGZtLmkxOG4oJ21vZGlmeScpLFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogZm0uaTE4bignc2l6ZScpLFxyXG4gICAgICAgICAgICAgICAga2luZDogZm0uaTE4bigna2luZCcpLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogZm0uaTE4bignZGF0ZScpXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBnZXRTcGFuRm9yU29ydCA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzcGFuID0gJzxzcGFuIGNsYXNzPVwiJyArIG5hbWUgKyAnIGNhcmV0IHVwXCI+PC9zcGFuPic7XHJcbiAgICAgICAgICAgICAgICBpZiAoZm0uc29ydFR5cGUgPT0gbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmbS5zb3J0T3JkZXIgPT0gXCJhc2NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcGFuID0gc3Bhbi5yZXBsYWNlKCcgdXAnLCAnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzcGFuID0gc3Bhbi5yZXBsYWNlKCcgY2FyZXQnLCAnJykucmVwbGFjZSgnIHVwJywgJycpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNwYW47XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBjdXN0b21Db2xzTmFtZUJ1aWxkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3VzdG9tQ29sc05hbWUgPSAnJztcclxuICAgICAgICAgICAgICAgIHZhciBjb2x1bW5zID0gZm0ub3B0aW9ucy51aU9wdGlvbnMuY3dkLmxpc3RWaWV3LmNvbHVtbnM7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwYW4gPSBnZXRTcGFuRm9yU29ydChjb2x1bW5zW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGQgPSAnPHRkIGNsYXNzPVwiJyArIGNvbHVtbnNbaV0gKyAnXCI+JztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZm0ub3B0aW9ucy51aU9wdGlvbnMuY3dkLmxpc3RWaWV3LmNvbHVtbnNDdXN0b21OYW1lW2NvbHVtbnNbaV1dICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tQ29sc05hbWUgKz0gdGQgKyBmbS5vcHRpb25zLnVpT3B0aW9ucy5jd2QubGlzdFZpZXcuY29sdW1uc0N1c3RvbU5hbWVbY29sdW1uc1tpXV0gKyBzcGFuICsgJzwvdGQ+JztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21Db2xzTmFtZSArPSB0ZCArIG1zZ1tjb2x1bW5zW2ldXSArIHNwYW4gKyAnPC90ZD4nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBjdXN0b21Db2xzTmFtZTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGNoZWNrQ3dkRW1wdHkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjb20sXHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLFxyXG4gICAgICAgICAgICAgICAgICAgIGxpbmssXHJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2UgPSBsaXN0ID8gY3dkLmNoaWxkcmVuKCd0YWJsZScpLmNoaWxkcmVuKCd0Ym9keScpIDogY3dkO1xyXG4gICAgICAgICAgICAgICAgY3dkLmZpbmQoXCIuZW1wdHlmb2xkZXJcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICBjd2QuZmluZChcIi5ub2ZpbGVzXCIpLnJlbW92ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICgoY29tID0gZm0uX2NvbW1hbmRzWydmaWx0ZXInXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGxhY2UuaXMoJzplbXB0eScpICYmIGNvbS5maWx0ZXJTdGF0ZSAhPSAnQWxsJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsdGVyZGl2ID0gJzxkaXYgY2xhc3M9XCJub2ZpbGVzIGFsaWduY2VudGVyXCI+PGltZyBzcmM9XCIuLi9Db250ZW50L2VsZmluZGVyL2ltZy9ub2ZpbGVzLnBuZ1wiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxwPicgKyBmbS5pMThuKCdub3RmaWxlc2ZvcmZpbHRlcicpICsgJzwvcD4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjd2QuYXBwZW5kKGZpbHRlcmRpdik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHBsYWNlLmlzKCc6ZW1wdHknKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkaXYgPSAkKCc8ZGl2IGNsYXNzPVwiZW1wdHlmb2xkZXIgYWxpZ25jZW50ZXJcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3JjPVwiLi4vQ29udGVudC9lbGZpbmRlci9pbWcvZW1wdHlmb2xkZXIucG5nXCI+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8aDY+JyArIGZtLmkxOG4oJ2N3ZGVtcHR5JykgKyAnPC9oNj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxwPicgKyBmbS5pMThuKCdjd2RlbXB0eWhlbHAnKSArIGZtLmkxOG4oJ29yJykgKyAnPC9wPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgoY29tID0gZm0uX2NvbW1hbmRzWyd1cGxvYWQnXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uID0gJ2VsZmluZGVyJyArIGNvbS5vcHRpb25zLnVpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJC5mbltidXR0b25dKSBsaW5rID0gJCgnPGRpdi8+JylbYnV0dG9uXShjb20sIHRydWUsIGZtLmkxOG4oJ2N3ZHNlbGVjdGZpbGUnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpdi5maW5kKFwicFwiKS5hcHBlbmQobGluayk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkaXIgPSBmbS5jd2QoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGlyLnZvbHVtZUlkID09IFwidjBfXCIgJiYgZGlyLm5hbWUgPT0gZm0uaTE4bigncmVjZWl2ZWRkaXJuYW1lJykpIGRpdi5maW5kKFwicFwiKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBjd2QuYXBwZW5kKGRpdik7XHJcbiAgICAgICAgICAgICAgICAgICAgY3dkLnBhcmVudCgpLmNoaWxkcmVuKCd0YWJsZS50aGVhZCcpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWN3ZC5wYXJlbnQoKS5jaGlsZHJlbigndGFibGUudGhlYWQnKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoZWFkID0gJzx0YWJsZSBjbGFzcz1cInRoZWFkXCI+PHRoZWFkPjx0ciBjbGFzcz1cInVpLXN0YXRlLWRlZmF1bHRcIj48dGQgY2xhc3M9XCJjaGJcIj4nICsgQ0JoZWFkICsgJzwvdGQ+PHRkIGNsYXNzPVwibmFtZVwiPicgKyBmbS5pMThuKCduYW1lJykgKyBnZXRTcGFuRm9yU29ydCgnbmFtZScpICsgJzwvdGQ+JyArIGN1c3RvbUNvbHNOYW1lQnVpbGQoKSArICc8L3RyPjwvdGhlYWQ+PC90YWJsZT4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3dkLnBhcmVudCgpLnByZXBlbmQodGhlYWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3dkLnBhcmVudCgpLnByZXBlbmQoc2VsZWN0QWxsQmxvY2spO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIi5zZWxlY3RhbGx0ZXh0XCIpLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYiA9ICQoZ2V0VGFyZ2V0KGUpKS5wYXJlbnQoKS5maW5kKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0uc2VsZWN0QWxsQ2hCJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNiICYmIGNiLmlzKCc6Y2hlY2tlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2VsZWN0QWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0QWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuXHRcdFx0ICogVXBkYXRlIGRpcmVjdG9yeSBjb250ZW50XHJcblx0XHRcdCAqXHJcblx0XHRcdCAqIEBwYXJhbSAgQXJyYXkgIGZpbGVzXHJcblx0XHRcdCAqIEByZXR1cm4gdm9pZFxyXG5cdFx0XHQgKi9cclxuICAgICAgICAgICAgY29udGVudCA9IGZ1bmN0aW9uKGZpbGVzLCBhbnkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwaGFzaCA9IGZtLmN3ZCgpLmhhc2g7XHJcbiAgICAgICAgICAgICAgICB1bnNlbGVjdEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0byBhdm9pZCBwcm9ibGVtIHdpdGggZHJhZ2dhYmxlXHJcbiAgICAgICAgICAgICAgICAgICAgY3dkLmNoaWxkcmVuKCd0YWJsZSwnICsgZmlsZVNlbGVjdG9yKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBjd2QucGFyZW50KCkuY2hpbGRyZW4oJ3RhYmxlLnRoZWFkJykucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3dkLnBhcmVudCgpLmNoaWxkcmVuKCd0YWJsZS50aGVhZCcpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN3ZC5odG1sKCcnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjd2QucmVtb3ZlQ2xhc3MoJ2VsZmluZGVyLWN3ZC12aWV3LWljb25zIGVsZmluZGVyLWN3ZC12aWV3LWxpc3QnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnZWxmaW5kZXItY3dkLXZpZXctJyArIChsaXN0ID8gJ2xpc3QnIDogJ2ljb25zJykpO1xyXG5cclxuICAgICAgICAgICAgICAgIHdyYXBwZXJbbGlzdCA/ICdhZGRDbGFzcycgOiAncmVtb3ZlQ2xhc3MnXSgnZWxmaW5kZXItY3dkLXdyYXBwZXItbGlzdCcpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vbGlzdCAmJiBjd2QuaHRtbCgnPHRhYmxlPjx0aGVhZD48dHIgY2xhc3M9XCJ1aS1zdGF0ZS1kZWZhdWx0XCI+PHRkID4nK21zZy5uYW1lKyc8L3RkPjx0ZD4nK21zZy5wZXJtKyc8L3RkPjx0ZD4nK21zZy5tb2QrJzwvdGQ+PHRkPicrbXNnLnNpemUrJzwvdGQ+PHRkPicrbXNnLmtpbmQrJzwvdGQ+PC90cj48L3RoZWFkPjx0Ym9keS8+PC90YWJsZT4nKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGhlYWQgPSAnPHRhYmxlIGNsYXNzPVwidGhlYWRcIj48dGhlYWQ+PHRyIGNsYXNzPVwidWktc3RhdGUtZGVmYXVsdFwiPjx0ZCBjbGFzcz1cImNoYlwiPicgKyBDQmhlYWQgKyAnPC90ZD48dGQgY2xhc3M9XCJuYW1lXCI+JyArIGZtLmkxOG4oJ25hbWUnKSArIGdldFNwYW5Gb3JTb3J0KCduYW1lJykgKyAnPC90ZD4nICsgY3VzdG9tQ29sc05hbWVCdWlsZCgpICsgJzwvdHI+PC90aGVhZD48L3RhYmxlPic7XHJcbiAgICAgICAgICAgICAgICBsaXN0ICYmIGN3ZC5odG1sKCc8dGFibGU+PHRib2R5Lz48L3RhYmxlPicpO1xyXG4gICAgICAgICAgICAgICAgbGlzdCAmJiBjd2QucGFyZW50KCkucHJlcGVuZCh0aGVhZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgYnVmZmVyID0gJC5tYXAoZmlsZXMsIGZ1bmN0aW9uKGYpIHsgcmV0dXJuIGFueSB8fCBmLnBoYXNoID09IHBoYXNoID8gZiA6IG51bGw7IH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFsaXN0ICYmIGJ1ZmZlci5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3dkLnBhcmVudCgpLnByZXBlbmQoc2VsZWN0QWxsQmxvY2spO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIuc2VsZWN0YWxsdGV4dFwiKS5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2IgPSAkKGdldFRhcmdldChlKSkucGFyZW50KCkuZmluZCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdLnNlbGVjdEFsbENoQicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2IgJiYgY2IuaXMoJzpjaGVja2VkJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2VsZWN0QWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGJ1ZmZlciA9IGZtLnNvcnRGaWxlcyhidWZmZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vd3JhcHBlci5iaW5kKHNjcm9sbEV2ZW50LCByZW5kZXIpLnRyaWdnZXIoc2Nyb2xsRXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgY3dkLmJpbmQoc2Nyb2xsRXZlbnQsIHJlbmRlcikudHJpZ2dlcihzY3JvbGxFdmVudCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2hlY2tDd2RFbXB0eSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHBoYXNoID0gZm0uY3dkKCkucGhhc2g7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMub2xkU2Nob29sICYmIHBoYXNoICYmICFxdWVyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSAkLmV4dGVuZCh0cnVlLCB7fSwgZm0uZmlsZShwaGFzaCksIHsgbmFtZTogJy4uJywgbWltZTogJ2RpcmVjdG9yeScgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gJChpdGVtaHRtbChwYXJlbnQpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2VsZmluZGVyLWN3ZC1wYXJlbnQnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYmluZCgnbW91c2Vkb3duIGNsaWNrIG1vdXNldXAgdG91Y2hzdGFydCB0b3VjaG1vdmUgdG91Y2hlbmQgZGJsY2xpY2sgbW91c2VlbnRlcicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vLmJpbmQoJ21vdXNlZG93biBjbGljayBtb3VzZXVwIGRibGNsaWNrIG1vdXNlZW50ZXInLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZGJsY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbS5leGVjKCdvcGVuJywgdGhpcy5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAobGlzdCA/IGN3ZC5maW5kKCd0Ym9keScpIDogY3dkKS5wcmVwZW5kKHBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcblx0XHRcdCAqIENXRCBub2RlIGl0c2VsZlxyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBAdHlwZSBKUXVlcnlcclxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBjd2QgPSAkKHRoaXMpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ3VpLWhlbHBlci1jbGVhcmZpeCBlbGZpbmRlci1jd2QnKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3Vuc2VsZWN0YWJsZScsICdvbicpXHJcbiAgICAgICAgICAgICAgICAvLyBmaXggdWkuc2VsZWN0YWJsZSBidWdzIGFuZCBhZGQgc2hpZnQrY2xpY2sgc3VwcG9ydCBcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZShmaWxlU2VsZWN0b3IsICdjbGljay4nICsgZm0ubmFtZXNwYWNlLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSB0aGlzLmlkID8gJCh0aGlzKSA6ICQodGhpcykucGFyZW50cygnW2lkXTpmaXJzdCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2ID0gcC5wcmV2QWxsKCcuJyArIGNsU2VsZWN0ZWQgKyAnOmZpcnN0JyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQgPSBwLm5leHRBbGwoJy4nICsgY2xTZWxlY3RlZCArICc6Zmlyc3QnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGwgPSBwcmV2Lmxlbmd0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmwgPSBuZXh0Lmxlbmd0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gZ2V0VGFyZ2V0KGUpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJsb2NrTXVsdGlTZWxlY3Rpb24pIHVuc2VsZWN0QWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFibG9ja011bHRpU2VsZWN0aW9uICYmIGUuc2hpZnRLZXkgJiYgKHBsIHx8IG5sKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWIgPSBwbCA/IHAucHJldlVudGlsKCcjJyArIHByZXYuYXR0cignaWQnKSkgOiBwLm5leHRVbnRpbCgnIycgKyBuZXh0LmF0dHIoJ2lkJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWIuYWRkKHApLnRyaWdnZXIoZXZ0U2VsZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8kKHApLmZpbmQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXScpLnByb3AoXCJjaGVja2VkXCIsICFwLmlzKCcuJyArIGNsU2VsZWN0ZWQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9jaGFuZ2UoJChwKS5maW5kKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHAudHJpZ2dlcihwLmlzKCcuJyArIGNsU2VsZWN0ZWQpID8gZXZ0VW5zZWxlY3QgOiBldnRTZWxlY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRhcmdldCkuY2hpbGRyZW4oKS5pcygnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJykgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vJChlLnNyY0VsZW1lbnQpLmlzKCcuYm9vdHN0cmFwLWNoZWNrYm94JykgfHwgJChlLnNyY0VsZW1lbnQpLmlzKCcuYnRuLWxpbmsnKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0YXJnZXQpLmlzKCcuY2ItaWNvbi1jaGVjay1lbXB0eScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAkKHRhcmdldCkuaXMoJy5jYi1pY29uLWNoZWNrJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAudHJpZ2dlcihwLmlzKCcuJyArIGNsU2VsZWN0ZWQpID8gZXZ0VW5zZWxlY3QgOiBldnRTZWxlY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCEkKHRhcmdldCkuaXMoJ2lucHV0W3R5cGU9XCJ0ZXh0XCJdJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmRhdGEoJ3RvdWNoaW5nJykgJiYgcC5pcygnLicgKyBjbFNlbGVjdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuZGF0YSgndG91Y2hpbmcnLCBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbS5kYmxjbGljayh7IGZpbGU6IHRoaXMuaWQgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zZWxlY3RBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zZWxlY3RBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLnRyaWdnZXIocC5pcygnLicgKyBjbFNlbGVjdGVkKSA/IGV2dFVuc2VsZWN0IDogZXZ0U2VsZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcigpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC8vIGNhbGwgZm0ub3BlbigpXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoZmlsZVNlbGVjdG9yLCAnZGJsY2xpY2suJyArIGZtLm5hbWVzcGFjZSwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZtLmRibGNsaWNrKHsgZmlsZTogdGhpcy5pZCB9KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAvLyBmb3IgdG91Y2ggZGV2aWNlXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoZmlsZVNlbGVjdG9yLCAndG91Y2hzdGFydC4nICsgZm0ubmFtZXNwYWNlLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5kYXRhKCd0b3VjaGluZycsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwID0gdGhpcy5pZCA/ICQodGhpcykgOiAkKHRoaXMpLnBhcmVudHMoJ1tpZF06Zmlyc3QnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsID0gcC5wcmV2QWxsKCcuJyArIGNsU2VsZWN0ZWQgKyAnOmZpcnN0JykubGVuZ3RoICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAubmV4dEFsbCgnLicgKyBjbFNlbGVjdGVkICsgJzpmaXJzdCcpLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ2xvbmd0YXAnLCBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBsb25nIHRhcFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwLnRyaWdnZXIocC5pcygnLicgKyBjbFNlbGVjdGVkKSA/IGV2dFVuc2VsZWN0IDogZXZ0U2VsZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsID09IDAgJiYgcC5pcygnLicgKyBjbFNlbGVjdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcC50cmlnZ2VyKCdjbGljaycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmRlbGVnYXRlKGZpbGVTZWxlY3RvciwgJ3RvdWNobW92ZS4nICsgZm0ubmFtZXNwYWNlICsgJyB0b3VjaGVuZC4nICsgZm0ubmFtZXNwYWNlLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KCQodGhpcykuZGF0YSgnbG9uZ3RhcCcpKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAvLyBhdHRhY2ggZHJhZ2dhYmxlXHJcbiAgICAgICAgICAgICAgICAvLy5kZWxlZ2F0ZShmaWxlU2VsZWN0b3IsICdtb3VzZWVudGVyLicrZm0ubmFtZXNwYWNlLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAvL1x0dmFyICR0aGlzID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgICAgIC8vXHRcdHRhcmdldCA9IGxpc3QgPyAkdGhpcyA6ICR0aGlzLmNoaWxkcmVuKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9cdGlmICghJHRoaXMuaXMoJy4nK2NsVG1wKSAmJiAhdGFyZ2V0LmlzKCcuJytjbERyYWdnYWJsZSsnLC4nK2NsRGlzYWJsZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAvL1x0XHR0YXJnZXQuZHJhZ2dhYmxlKGZtLmRyYWdnYWJsZSk7XHJcbiAgICAgICAgICAgICAgICAvL1x0fVxyXG4gICAgICAgICAgICAgICAgLy99KVxyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGhvdmVyIGNsYXNzIHRvIHNlbGVjdGVkIGZpbGVcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZShmaWxlU2VsZWN0b3IsIGV2dFNlbGVjdCwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gJHRoaXMuYXR0cignaWQnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSA9IGZtLmZpbGUoaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZmlsZSB8fCAhKGZpbGUubWltZSA9PSBcImRpcmVjdG9yeVwiICYmIGZtLmlzTW9kYWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2VsZWN0TG9jayAmJiAhJHRoaXMuaXMoJy4nICsgY2xEaXNhYmxlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuZmluZCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJykucHJvcChcImNoZWNrZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2UoJCh0aGlzKS5maW5kKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5hZGRDbGFzcyhjbFNlbGVjdGVkKS5jaGlsZHJlbigpLmFkZENsYXNzKGNsSG92ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShpZCwgc2VsZWN0ZWRGaWxlcykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWxlcy5wdXNoKGlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgaG92ZXIgY2xhc3MgZnJvbSB1bnNlbGVjdGVkIGZpbGVcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZShmaWxlU2VsZWN0b3IsIGV2dFVuc2VsZWN0LCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSAkdGhpcy5hdHRyKCdpZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZHg7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2VsZWN0TG9jaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKGNsU2VsZWN0ZWQpLmNoaWxkcmVuKCkucmVtb3ZlQ2xhc3MoY2xIb3Zlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuZmluZCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJykucHJvcChcImNoZWNrZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2UoJCh0aGlzKS5maW5kKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5keCA9ICQuaW5BcnJheShpZCwgc2VsZWN0ZWRGaWxlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZHggIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZpbGVzLnNwbGljZShuZHgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIGZpbGVzIHdpY2ggcmVtb3Zpbmcgb3IgbW92aW5nXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoZmlsZVNlbGVjdG9yLCBldnREaXNhYmxlLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLnJlbW92ZUNsYXNzKGNsU2VsZWN0ZWQpLmFkZENsYXNzKGNsRGlzYWJsZWQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSAobGlzdCA/ICR0aGlzIDogJHRoaXMuY2hpbGRyZW4oKSkucmVtb3ZlQ2xhc3MoY2xIb3Zlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICQodGFyZ2V0KS5maW5kKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKS5wcm9wKFwiY2hlY2tlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlKCQodGFyZ2V0KS5maW5kKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmlzKCcuJyArIGNsRHJvcHBhYmxlKSAmJiAkdGhpcy5kcm9wcGFibGUoJ2Rpc2FibGUnKTtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuaXMoJy4nICsgY2xEcmFnZ2FibGUpICYmIHRhcmdldC5kcmFnZ2FibGUoJ2Rpc2FibGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAhbGlzdCAmJiB0YXJnZXQucmVtb3ZlQ2xhc3MoY2xEaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLy8gaWYgYW55IGZpbGVzIHdhcyBub3QgcmVtb3ZlZC9tb3ZlZCAtIHVubG9jayBpdHNcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZShmaWxlU2VsZWN0b3IsIGV2dEVuYWJsZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKS5yZW1vdmVDbGFzcyhjbERpc2FibGVkKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gbGlzdCA/ICR0aGlzIDogJHRoaXMuY2hpbGRyZW4oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuaXMoJy4nICsgY2xEcm9wcGFibGUpICYmICR0aGlzLmRyb3BwYWJsZSgnZW5hYmxlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmlzKCcuJyArIGNsRHJhZ2dhYmxlKSAmJiB0YXJnZXQuZHJhZ2dhYmxlKCdlbmFibGUnKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoZmlsZVNlbGVjdG9yLCAnc2Nyb2xsdG92aWV3JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9WaWV3KCQodGhpcykpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZShmaWxlU2VsZWN0b3IsICdtb3VzZWVudGVyLicgKyBmbS5uYW1lc3BhY2UgKyAnIG1vdXNlbGVhdmUuJyArIGZtLm5hbWVzcGFjZSwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZtLnRyaWdnZXIoJ2hvdmVyJywgeyBoYXNoOiAkKHRoaXMpLmF0dHIoJ2lkJyksIHR5cGU6IGUudHlwZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5iaW5kKCdjb250ZXh0bWVudS4nICsgZm0ubmFtZXNwYWNlLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGUgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCcuJyArIGNsRmlsZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZmlsZS5pcygnLicgKyBjbERpc2FibGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWxlLmlzKCcuJyArIGNsU2VsZWN0ZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3dkLnRyaWdnZXIoJ3Vuc2VsZWN0YWxsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zZWxlY3RBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLnRyaWdnZXIoZXZ0U2VsZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbS50cmlnZ2VyKCdjb250ZXh0bWVudScsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdmaWxlcycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RhcmdldHMnOiBmbS5zZWxlY3RlZCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd4JzogZS5jbGllbnRYLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd5JzogZS5jbGllbnRZXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAvLyB1bnNlbGVjdCBhbGwgb24gY3dkIGNsaWNrXHJcbiAgICAgICAgICAgICAgICAuYmluZCgnY2xpY2suJyArIGZtLm5hbWVzcGFjZSwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICFlLnNoaWZ0S2V5ICYmICFlLmN0cmxLZXkgJiYgIWUubWV0YUtleSAmJiB1bnNlbGVjdEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBtYWtlIGZpbGVzIHNlbGVjdGFibGVcclxuICAgICAgICAgICAgICAgIC5zZWxlY3RhYmxlKHtcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IGZpbGVTZWxlY3RvcixcclxuICAgICAgICAgICAgICAgICAgICBzdG9wOiB0cmlnZ2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGRlbGF5OiAyNTAsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IGZ1bmN0aW9uKGUsIHVpKSB7ICQodWkuc2VsZWN0ZWQpLnRyaWdnZXIoZXZ0U2VsZWN0KTsgfSxcclxuICAgICAgICAgICAgICAgICAgICB1bnNlbGVjdGVkOiBmdW5jdGlvbihlLCB1aSkgeyAkKHVpLnVuc2VsZWN0ZWQpLnRyaWdnZXIoZXZ0VW5zZWxlY3QpOyB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLy8gbWFrZSBjd2QgaXRzZWxmIGRyb3BwYWJsZSBmb3IgZm9sZGVycyBmcm9tIG5hdiBwYW5lbFxyXG4gICAgICAgICAgICAgICAgLmRyb3BwYWJsZShkcm9wcGFibGUpXHJcbiAgICAgICAgICAgICAgICAvLyBwcmVwZW5kIGZha2UgZmlsZS9kaXJcclxuICAgICAgICAgICAgICAgIC5iaW5kKCdjcmVhdGUuJyArIGZtLm5hbWVzcGFjZSwgZnVuY3Rpb24oZSwgZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBsaXN0ID8gY3dkLmZpbmQoJ3Rib2R5JykgOiBjd2QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBwYXJlbnQuZmluZCgnLmVsZmluZGVyLWN3ZC1wYXJlbnQnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSA9ICQoaXRlbWh0bWwoZmlsZSkpLmFkZENsYXNzKGNsVG1wKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdW5zZWxlY3RBbGwoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHAubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHAuYWZ0ZXIoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LnByZXBlbmQoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjd2Quc2Nyb2xsVG9wKDApO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC8vIHVuc2VsZWN0IGFsbCBzZWxlY3RlZCBmaWxlc1xyXG4gICAgICAgICAgICAgICAgLmJpbmQoJ3Vuc2VsZWN0YWxsJywgdW5zZWxlY3RBbGwpXHJcbiAgICAgICAgICAgICAgICAuYmluZCgnc2VsZWN0ZmlsZScsIGZ1bmN0aW9uKGUsIGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3dkLmZpbmQoJyMnICsgaWQpLnRyaWdnZXIoZXZ0U2VsZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyKCk7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuXHJcbiAgICAgICAgICAgIHdyYXBwZXIgPSAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItY3dkLXdyYXBwZXJcIi8+JylcclxuICAgICAgICAgICAgICAgIC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGQsIHNvcnQsIHRhcmdldCA9IGdldFRhcmdldChlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJCh0YXJnZXQpLmNoaWxkcmVuKCkuaXMoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXS5zZWxlY3RBbGxDaEInKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISQodGFyZ2V0KS5pcygnOmNoZWNrZWQnKSkgdW5zZWxlY3RBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBzZWxlY3RBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCQodGFyZ2V0KS5pcygnLmJvb3RzdHJhcC1jaGVja2JveCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRkID0gJCh0YXJnZXQpLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJCh0YXJnZXQpLmlzKCcuY2ItaWNvbi1jaGVjay1lbXB0eScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8ICQodGFyZ2V0KS5pcygnLmNiLWljb24tY2hlY2snKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZCA9ICQodGFyZ2V0KS5wYXJlbnQoKS5wYXJlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCQodGFyZ2V0KS5pcygndGQuY2hiJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGQgPSAkKHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkKHRhcmdldCkuaXMoJ3RkJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc29ydCA9IHsgb3JkZXI6IFwiZGVzY1wiLCBzdGljazogdHJ1ZSwgdHlwZTogXCJuYW1lXCIgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwYW4gPSAkKHRhcmdldCkuZmluZCgnc3BhbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNOZWVkU29ydEFzYyA9ICQoc3BhbikuaXMoXCIuY2FyZXRcIikgPyAkKHNwYW4pLmlzKCcudXAnKSA6IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGFyZ2V0KS5wYXJlbnQoKS5maW5kKCdzcGFuLmNhcmV0JykucmVtb3ZlQ2xhc3MoJ3VwJykucmVtb3ZlQ2xhc3MoJ2NhcmV0Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3J0Lm9yZGVyID0gaXNOZWVkU29ydEFzYyA/IFwiYXNjXCIgOiBcImRlc2NcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc29ydC50eXBlID0gJChzcGFuKS5pcygnLmRhdGUnKSA/IFwiZGF0ZVwiIDogJChzcGFuKS5pcygnLmtpbmQnKSA/IFwia2luZFwiIDogXCJuYW1lXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOZWVkU29ydEFzYykgJChzcGFuKS5hZGRDbGFzcygnY2FyZXQnKS5yZW1vdmVDbGFzcygndXAnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAkKHNwYW4pLmFkZENsYXNzKCdjYXJldCcpLmFkZENsYXNzKCd1cCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm0uc2V0U29ydChzb3J0LnR5cGUsIHNvcnQub3JkZXIsIHNvcnQuc3RpY2spO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICFlLnNoaWZ0S2V5ICYmICFlLmN0cmxLZXkgJiYgIWUubWV0YUtleSAmJiB1bnNlbGVjdEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaCA9IHRkLmZpbmQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXS5zZWxlY3RBbGxDaEInKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQoY2gpLmlzKCc6Y2hlY2tlZCcpKSB1bnNlbGVjdEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHNlbGVjdEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuYmluZCgnY29udGV4dG1lbnUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZtLnRyaWdnZXIoJ2NvbnRleHRtZW51Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdjd2QnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAndGFyZ2V0cyc6IFtmbS5jd2QoKS5oYXNoXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3gnOiBlLmNsaWVudFgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd5JzogZS5jbGllbnRZXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuXHJcbiAgICAgICAgICAgIHJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGggPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIHdyYXBwZXIuc2libGluZ3MoJy5lbGZpbmRlci1wYW5lbDp2aXNpYmxlJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBoICs9ICQodGhpcykub3V0ZXJIZWlnaHQodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB3cmFwcGVyLmhlaWdodCh3ei5oZWlnaHQoKSAtIGgpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgLy8gZWxmaW5kZXIgbm9kZVxyXG4gICAgICAgICAgICBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpLnJlc2l6ZShyZXNpemUpLFxyXG4gICAgICAgICAgICAvLyB3b3Jrem9uZSBub2RlXHJcbiAgICAgICAgICAgIHd6ID0gcGFyZW50LmNoaWxkcmVuKCcuZWxmaW5kZXItd29ya3pvbmUnKS5hcHBlbmQod3JhcHBlci5hcHBlbmQodGhpcykpO1xyXG5cclxuXHJcbiAgICAgICAgaWYgKGZtLmRyYWdVcGxvYWQpIHtcclxuICAgICAgICAgICAgd3JhcHBlclswXS5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW50ZXInLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIHdyYXBwZXIuYWRkQ2xhc3MoY2xEcm9wQWN0aXZlKTtcclxuICAgICAgICAgICAgfSwgZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgd3JhcHBlclswXS5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZS50YXJnZXQgPT0gY3dkWzBdICYmIHdyYXBwZXIucmVtb3ZlQ2xhc3MoY2xEcm9wQWN0aXZlKTtcclxuICAgICAgICAgICAgfSwgZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgd3JhcHBlclswXS5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH0sIGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgIHdyYXBwZXJbMF0uYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHdyYXBwZXIucmVtb3ZlQ2xhc3MoY2xEcm9wQWN0aXZlKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaXRlbXMgPSBlLmRhdGFUcmFuc2Zlci5pdGVtcztcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGl0ZW1zW2ldLndlYmtpdEdldEFzRW50cnkoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbSAmJiBpdGVtLmlzRGlyZWN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZtLmVycm9yKCdlcnJvckRyb3BEaXInKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBlLmRhdGFUcmFuc2ZlciAmJiBlLmRhdGFUcmFuc2Zlci5maWxlcyAmJiBlLmRhdGFUcmFuc2Zlci5maWxlcy5sZW5ndGggJiYgZm0uZXhlYygndXBsb2FkJywgeyBmaWxlczogZS5kYXRhVHJhbnNmZXIuZmlsZXMgfSk7IC8vZm0udXBsb2FkKHtmaWxlcyA6IGUuZGF0YVRyYW5zZmVyLmZpbGVzfSk7XHJcbiAgICAgICAgICAgIH0sIGZhbHNlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZtXHJcbiAgICAgICAgICAgIC5iaW5kKCdvcGVuJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgZm0udHJpZ2dlcignZmlsdGVyZW5kJyk7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50KGUuZGF0YS5maWxlcyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5iaW5kKCdzZWFyY2gnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBsYXN0U2VhcmNoID0gZS5kYXRhLmZpbGVzO1xyXG4gICAgICAgICAgICAgICAgY29udGVudChsYXN0U2VhcmNoLCB0cnVlKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmJpbmQoJ3NlYXJjaGVuZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgbGFzdFNlYXJjaCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50KGZtLmZpbGVzKCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYmluZCgnc2VhcmNoc3RhcnQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeSA9IGUuZGF0YS5xdWVyeTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmJpbmQoJ2ZpbHRlcicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIGxhc3RGaWx0ZXIgPSBlLmRhdGEuZmlsZXM7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50KGxhc3RGaWx0ZXIsIHRydWUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYmluZCgnZmlsdGVyZW5kJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBsYXN0RmlsdGVyID0gW107XHJcbiAgICAgICAgICAgICAgICAvL2lmIChxdWVyeSkge1xyXG4gICAgICAgICAgICAgICAgLy9xdWVyeSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgY29udGVudChmbS5maWxlcygpKTtcclxuICAgICAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYmluZCgnZmlsdGVyc3RhcnQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAvL3F1ZXJ5ID0gZS5kYXRhLnF1ZXJ5O1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYmluZCgnc29ydGNoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29udGVudChxdWVyeSA/IGxhc3RTZWFyY2ggOiBsYXN0RmlsdGVyLmxlbmd0aCA+IDAgPyBsYXN0RmlsdGVyIDogZm0uZmlsZXMoKSwgISFxdWVyeSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5iaW5kKCd2aWV3Y2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsID0gZm0uc2VsZWN0ZWQoKSxcclxuICAgICAgICAgICAgICAgICAgICBsID0gZm0uc3RvcmFnZSgndmlldycpID09ICdsaXN0JztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobCAhPSBsaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdCA9IGw7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudChsYXN0RmlsdGVyLmxlbmd0aCA+IDAgPyBsYXN0RmlsdGVyIDogZm0uZmlsZXMoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChzZWwsIGZ1bmN0aW9uKGksIGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RmlsZShoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXNpemUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmFkZChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGhhc2ggPSBmbS5jd2QoKS5oYXNoLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVzID0gcXVlcnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgPyAkLm1hcChlLmRhdGEuYWRkZWQgfHwgW10sIGZ1bmN0aW9uKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmLm5hbWUuaW5kZXhPZihxdWVyeSkgPT09IC0xID8gbnVsbCA6IGY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogJC5tYXAoZS5kYXRhLmFkZGVkIHx8IFtdLCBmdW5jdGlvbihmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZi5waGFzaCA9PSBwaGFzaCA/IGYgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGFkZChmaWxlcyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jaGFuZ2UoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBoYXNoID0gZm0uY3dkKCkuaGFzaCxcclxuICAgICAgICAgICAgICAgICAgICBzZWwgPSBmbS5zZWxlY3RlZCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVzO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChxdWVyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChlLmRhdGEuY2hhbmdlZCB8fCBbXSwgZnVuY3Rpb24oaSwgZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmUoW2ZpbGUuaGFzaF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZS5uYW1lLmluZGV4T2YocXVlcnkpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkKFtmaWxlXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmluQXJyYXkoZmlsZS5oYXNoLCBzZWwpICE9PSAtMSAmJiBzZWxlY3RGaWxlKGZpbGUuaGFzaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCQubWFwKGUuZGF0YS5jaGFuZ2VkIHx8IFtdLCBmdW5jdGlvbihmKSB7IHJldHVybiBmLnBoYXNoID09IHBoYXNoID8gZiA6IG51bGw7IH0pLCBmdW5jdGlvbihpLCBmaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZShbZmlsZS5oYXNoXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZChbZmlsZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmluQXJyYXkoZmlsZS5oYXNoLCBzZWwpICE9PSAtMSAmJiBzZWxlY3RGaWxlKGZpbGUuaGFzaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdHJpZ2dlcigpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAucmVtb3ZlKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZShlLmRhdGEucmVtb3ZlZCB8fCBbXSk7XHJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC8vIGZpeCBjd2QgaGVpZ2h0IGlmIGl0IGxlc3MgdGhlbiB3cmFwcGVyXHJcbiAgICAgICAgICAgIC5iaW5kKCdvcGVuIGFkZCBzZWFyY2ggc2VhcmNoZW5kJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjd2QuY3NzKCdoZWlnaHQnLCAnYXV0bycpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjd2Qub3V0ZXJIZWlnaHQodHJ1ZSkgPCB3cmFwcGVyLmhlaWdodCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3dkLmhlaWdodCh3cmFwcGVyLmhlaWdodCgpIC0gKGN3ZC5vdXRlckhlaWdodCh0cnVlKSAtIGN3ZC5oZWlnaHQoKSkgLSAyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gc2VsZWN0IGRyYWdnZWQgZmlsZSBpZiBubyBzZWxlY3RlZCwgZGlzYWJsZSBzZWxlY3RhYmxlXHJcbiAgICAgICAgICAgIC5kcmFnc3RhcnQoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQoZS5kYXRhLnRhcmdldCksXHJcbiAgICAgICAgICAgICAgICAgICAgb2UgPSBlLmRhdGEub3JpZ2luYWxFdmVudDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmlzKGZpbGVTZWxlY3RvcikpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXQuaXMoJy4nICsgY2xTZWxlY3RlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIShvZS5jdHJsS2V5IHx8IG9lLm1ldGFLZXkgfHwgb2Uuc2hpZnRLZXkpICYmIHVuc2VsZWN0QWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC50cmlnZ2VyKGV2dFNlbGVjdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyaWdnZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY3dkLmRyb3BwYWJsZSgnZGlzYWJsZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGN3ZC5zZWxlY3RhYmxlKCdkaXNhYmxlJykucmVtb3ZlQ2xhc3MoY2xEaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RMb2NrID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gZW5hYmxlIHNlbGVjdGFibGVcclxuICAgICAgICAgICAgLmRyYWdzdG9wKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY3dkLnNlbGVjdGFibGUoJ2VuYWJsZScpLmRyb3BwYWJsZSgnZW5hYmxlJyk7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RMb2NrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5iaW5kKCdsb2NrZmlsZXMgdW5sb2NrZmlsZXMnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnQgPSBlLnR5cGUgPT0gJ2xvY2tmaWxlcycgPyBldnREaXNhYmxlIDogZXZ0RW5hYmxlLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVzID0gZS5kYXRhLmZpbGVzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIGwgPSBmaWxlcy5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGwtLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN3ZC5maW5kKCcjJyArIGZpbGVzW2xdKS50cmlnZ2VyKGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vdHJpZ2dlcigpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAvLyBzZWxlY3QgbmV3IGZpbGVzIGFmdGVyIHNvbWUgYWN0aW9uc1xyXG4gICAgICAgICAgICAuYmluZCgnbWtkaXIgbWtmaWxlIGR1cGxpY2F0ZSB1cGxvYWQgcmVuYW1lIGFyY2hpdmUgZXh0cmFjdCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwaGFzaCA9IGZtLmN3ZCgpLmhhc2gsIGZpbGVzO1xyXG5cclxuICAgICAgICAgICAgICAgIHVuc2VsZWN0QWxsKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGUuZGF0YS5hZGRlZCB8fCBbXSwgZnVuY3Rpb24oaSwgZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGUgJiYgZmlsZS5waGFzaCA9PSBwaGFzaCAmJiBzZWxlY3RGaWxlKGZpbGUuaGFzaCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRyaWdnZXIoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnNob3J0Y3V0KHtcclxuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdjdHJsK2EnLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdzZWxlY3RhbGwnLFxyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6IHNlbGVjdEFsbFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAvLy5zaG9ydGN1dCh7XHJcbiAgICAgICAgICAgIC8vXHRwYXR0ZXJuICAgICA6ICdsZWZ0IHJpZ2h0IHVwIGRvd24gc2hpZnQrbGVmdCBzaGlmdCtyaWdodCBzaGlmdCt1cCBzaGlmdCtkb3duJyxcclxuICAgICAgICAgICAgLy9cdGRlc2NyaXB0aW9uIDogJ3NlbGVjdGZpbGVzJyxcclxuICAgICAgICAgICAgLy9cdHR5cGUgICAgICAgIDogJ2tleWRvd24nICwgLy9mbS5VQS5GaXJlZm94IHx8IGZtLlVBLk9wZXJhID8gJ2tleXByZXNzJyA6ICdrZXlkb3duJyxcclxuICAgICAgICAgICAgLy9cdGNhbGxiYWNrICAgIDogZnVuY3Rpb24oZSkgeyBzZWxlY3QoZS5rZXlDb2RlLCBlLnNoaWZ0S2V5KTsgfVxyXG4gICAgICAgICAgICAvL30pXHJcbiAgICAgICAgICAgIC5zaG9ydGN1dCh7XHJcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnaG9tZScsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ3NlbGVjdGZmaWxlJyxcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdW5zZWxlY3RBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb1ZpZXcoY3dkLmZpbmQoJ1tpZF06Zmlyc3QnKS50cmlnZ2VyKGV2dFNlbGVjdCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnNob3J0Y3V0KHtcclxuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdlbmQnLFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdzZWxlY3RsZmlsZScsXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHVuc2VsZWN0QWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9WaWV3KGN3ZC5maW5kKCdbaWRdOmxhc3QnKS50cmlnZ2VyKGV2dFNlbGVjdCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gZm0udGltZUVuZCgnY3dkTG9hZCcpXHJcblxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxyXG4gKiBAY2xhc3MgIGVsRmluZGVyIHRvb2xiYXJcclxuICpcclxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcclxuICoqL1xyXG4kLmZuLmVsZmluZGVydG9vbGJhciA9IGZ1bmN0aW9uKGZtLCBvcHRzKSB7XHJcbiAgICB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNvbW1hbmRzID0gZm0uX2NvbW1hbmRzLFxyXG4gICAgICAgICAgICBzZWxmLFxyXG4gICAgICAgICAgICBwYW5lbHMgPSBvcHRzIHx8IFtdLFxyXG4gICAgICAgICAgICBsID0gcGFuZWxzLmxlbmd0aCxcclxuICAgICAgICAgICAgaSxcclxuICAgICAgICAgICAgY21kLFxyXG4gICAgICAgICAgICBwYW5lbCxcclxuICAgICAgICAgICAgYnV0dG9uLFxyXG4gICAgICAgICAgICBmaXJzdEIgPSBcInVpLWVsZmluZGVyLWJ1dHRvbi1maXJzdFwiO1xyXG5cclxuICAgICAgICAkKHRoaXMpLmNzcygnaGVpZ2h0JywgJzUwcHgnKTtcclxuXHJcbiAgICAgICAgaWYgKCEkKHRoaXMpLmlzKCcuZWxmaW5kZXItdG9vbGJhcicpKSB7XHJcbiAgICAgICAgICAgIHNlbGYgPSAkKHRoaXMpLmFkZENsYXNzKCd1aS1oZWxwZXItY2xlYXJmaXggdWktd2lkZ2V0LWhlYWRlciB1aS1jb3JuZXItdG9wIGVsZmluZGVyLXRvb2xiYXInKTtcclxuICAgICAgICAgICAgc2VsZi5wcmV2KCkubGVuZ3RoICYmIHNlbGYucGFyZW50KCkucHJlcGVuZCh0aGlzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmID0gJCh0aGlzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNlbGYuZW1wdHkoKTtcclxuICAgICAgICB3aGlsZSAobC0tKSB7XHJcbiAgICAgICAgICAgIGlmIChwYW5lbHNbbF0pIHtcclxuICAgICAgICAgICAgICAgIHBhbmVsID0gJCgnPGRpdiBjbGFzcz1cInVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwgZWxmaW5kZXItYnV0dG9uc2V0XCIvPicpO1xyXG4gICAgICAgICAgICAgICAgaSA9IHBhbmVsc1tsXS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChjbWQgPSBjb21tYW5kc1twYW5lbHNbbF1baV1dKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b24gPSAnZWxmaW5kZXInICsgY21kLm9wdGlvbnMudWk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYW5lbHNbbCAtIDFdID09ICdtdWx0aXBseWFkZCcpIGJ1dHRvbiA9ICdlbGZpbmRlcicgKyAnYmx1ZWJ1dHRvbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZm5bYnV0dG9uXSAmJiBwYW5lbC5wcmVwZW5kKCQoJzxkaXYvPicpW2J1dHRvbl0oY21kKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHBhbmVsc1tsXSAhPSAnbW9yZScpICQocGFuZWwpLmZpbmQoXCIuZWxmaW5kZXItYnV0dG9uLWljb25cIikuY3NzKCdwYWRkaW5nLWxlZnQnLCAnNXB4Jyk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFuZWxzW2xdID09ICdtdWx0aXBseWFkZCcpIHBhbmVsLmFkZENsYXNzKGZpcnN0Qik7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFuZWxzW2xdID09ICdkZWNyeXB0YW5kY2hlY2tzaWduJykgcGFuZWwuZmluZCgnZGl2OmZpcnN0JykuY3NzKCd3aWR0aCcsICcxNTVweCcpO1xyXG4gICAgICAgICAgICAgICAgcGFuZWwuY2hpbGRyZW4oKS5sZW5ndGggJiYgc2VsZi5wcmVwZW5kKHBhbmVsKTtcclxuICAgICAgICAgICAgICAgIHBhbmVsLmNoaWxkcmVuKCc6Z3QoMCknKS5iZWZvcmUoJzxzcGFuIGNsYXNzPVwidWktd2lkZ2V0LWNvbnRlbnQgZWxmaW5kZXItdG9vbGJhci1idXR0b24tc2VwYXJhdG9yXCIvPicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZWxmLmNoaWxkcmVuKCkubGVuZ3RoICYmIHNlbGYuc2hvdygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5zZWxlY3RGaWxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNob3dpbmdCdXR0b25zID0gW1snbXVsdGlwbHlhZGQnXSwgWydwYXN0ZSddLCBbJ2NvcHknXSwgWydwYXN0ZSddLCBbJ3JtJ10sIFsncmVuYW1lJ11dO1xyXG4gICAgICAgIHZhciBkaXIgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZtLnNlbGVjdGVkRmlsZXMoKS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZmlsZSA9IGZtLnNlbGVjdGVkRmlsZXMoKVtpXTtcclxuICAgICAgICAgICAgaWYgKGZpbGUubWltZSA9PSBcImRpcmVjdG9yeVwiKSB7XHJcbiAgICAgICAgICAgICAgICBkaXIgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGRpcikge1xyXG4gICAgICAgICAgICAkKHRoaXMpWydlbGZpbmRlcnRvb2xiYXInXShmbSwgc2hvd2luZ0J1dHRvbnMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQodGhpcylbJ2VsZmluZGVydG9vbGJhciddKGZtLCBmbS5vcHRpb25zLnVpT3B0aW9ucy50b29sYmFyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5vcGVuRm9sZGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGhvdmVyID0gZm0ucmVzKCdjbGFzcycsICdob3ZlcicpLFxyXG4gICAgICAgICAgICBpdGVtID0gJ2VsZmluZGVyLWJ1dHRvbi1tZW51LWl0ZW0nLFxyXG4gICAgICAgICAgICBtZW51ID0gJCgnPGRpdiBjbGFzcz1cInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCBlbGZpbmRlci1idXR0b24tbWVudSB1aS1jb3JuZXItYWxsXCIvPicpXHJcbiAgICAgICAgICAgICAgICAuaGlkZSgpXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoJy4nICsgaXRlbSwgJ2hvdmVyJywgZnVuY3Rpb24oKSB7ICQodGhpcykudG9nZ2xlQ2xhc3MoaG92ZXIpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmRlbGVnYXRlKCcuJyArIGl0ZW0sICdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgZG90ID0gJCgnPGE+Li4uPC9hPicpXHJcbiAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVudS5zbGlkZVRvZ2dsZSgxMDApO1xyXG4gICAgICAgICAgICAgICAgfSksXHJcblxyXG4gICAgICAgICAgICBoaWRlID0gZnVuY3Rpb24oKSB7IG1lbnUuaGlkZSgpOyB9LFxyXG5cclxuICAgICAgICAgICAgYWRkSXRlbSA9IGZ1bmN0aW9uKGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBocmVmID0gJChhKS5hdHRyKCdocmVmJykuc3Vic3RyKDEpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgPSAkKGEpLnRleHQoKTtcclxuICAgICAgICAgICAgICAgIG1lbnUuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICQoJzxkaXYgY2xhc3M9XCInICsgaXRlbSArICdcIiByZWw9XCInICsgaHJlZiArICdcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uLWljb24gZWxmaW5kZXItYnV0dG9uLWljb24tZGlyZWN0b3J5XCIvPicgKyB0ZXh0ICsgJzwvZGl2PicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQodGhpcykuYXR0cigncmVsJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNoID0gJCh0aGlzKS5hdHRyKCdyZWwnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoICE9IGZtLmN3ZCgpLmhhc2ggJiYgZm0uZXhlYygnb3BlbicsIGhhc2gpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoZm0uc2VsZWN0ZWRGaWxlcygpLmxlbmd0aCAhPSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0RmlsZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGF0aCA9ICQoJzxkaXYgY2xhc3M9XCJ1aS1lbGZpbmRlci10b29sYmFyLXBhdGhcIi8+JykuaHRtbCgnJm5ic3A7JylcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZSgnYScsICdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKCdocmVmJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhhc2ggPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKS5zdWJzdHIoMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc2ggIT0gZm0uY3dkKCkuaGFzaCAmJiBmbS5leGVjKCdvcGVuJywgaGFzaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgZGlycyA9IFtdO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGZtLmN3ZCgpLmhhc2gpXHJcbiAgICAgICAgICAgICQuZWFjaChmbS5wYXJlbnRzKGZtLmN3ZCgpLmhhc2gpLCBmdW5jdGlvbihpLCBoYXNoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBmbS5maWxlKGhhc2gpLm5hbWU7XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSAmJiBuYW1lLmxlbmd0aCA+IDIwKSBuYW1lID0gbmFtZS5zdWJzdHJpbmcoMCwgMTkpICsgXCIuLi5cIjtcclxuXHJcbiAgICAgICAgICAgICAgICBkaXJzLnB1c2goJzxhIGhyZWY9XCIjJyArIGhhc2ggKyAnXCI+JyArIG5hbWUgKyAnPC9hPicpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChkaXJzLmxlbmd0aCA+PSA0KSB7XHJcbiAgICAgICAgICAgICAgICBtZW51LmVtcHR5KCk7XHJcbiAgICAgICAgICAgICAgICBtZW51LnpJbmRleCgxMiArIHBhdGguekluZGV4KCkpO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wcmVwZW5kKG1lbnUpO1xyXG4gICAgICAgICAgICAgICAgLy9mb3IgKHZhciBpID0gZGlycy5sZW5ndGggLSAyOyBpID49IDE7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgdmFyIGRpciA9IGRpcnNbaV07XHJcbiAgICAgICAgICAgICAgICAvLyAgICBhZGRJdGVtKGRpcik7XHJcbiAgICAgICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IGRpcnMubGVuZ3RoIC0gMjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpciA9IGRpcnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgYWRkSXRlbShkaXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcGF0aC5wcmVwZW5kKCQoZGlyc1tkaXJzLmxlbmd0aCAtIDFdKS5hZGRDbGFzcygnbGFzdCcpKTtcclxuICAgICAgICAgICAgICAgIHBhdGgucHJlcGVuZCgnPicpO1xyXG4gICAgICAgICAgICAgICAgcGF0aC5wcmVwZW5kKGRvdCk7XHJcbiAgICAgICAgICAgICAgICBwYXRoLnByZXBlbmQoJz4nKTtcclxuICAgICAgICAgICAgICAgIHBhdGgucHJlcGVuZChkaXJzWzBdKTtcclxuXHJcbiAgICAgICAgICAgICAgICBmbS5iaW5kKCdkaXNhYmxlIHNlbGVjdCcsIGhpZGUpLmdldFVJKCkuY2xpY2soaGlkZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoLmh0bWwoZGlycy5qb2luKCcgPiAnKSk7XHJcbiAgICAgICAgICAgICAgICBwYXRoLmZpbmQoJ2E6bGFzdCcpLmFkZENsYXNzKCdsYXN0Jyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICQodGhpcykuZW1wdHkoKTtcclxuICAgICAgICAgICAgdmFyIHNob3dpbmdCdXR0b25zID0gW1snbXVsdGlwbHlhZGQnXSwgWydwYXN0ZSddLCBbJ2ZpbHRlciddXTtcclxuICAgICAgICAgICAgJCh0aGlzKVsnZWxmaW5kZXJ0b29sYmFyJ10oZm0sIHNob3dpbmdCdXR0b25zKTtcclxuXHJcbiAgICAgICAgICAgICQodGhpcykuYXBwZW5kKHBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7IC8qKlxyXG4gKiBAY2xhc3MgIGVsRmluZGVyIHRvb2xiYXIgYnV0dG9uIHdpZGdldC5cclxuICogSWYgY29tbWFuZCBoYXMgdmFyaWFudHMgLSBjcmVhdGUgbWVudVxyXG4gKlxyXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxyXG4gKiovXHJcbiQuZm4uZWxmaW5kZXJidXR0b24gPSBmdW5jdGlvbihjbWQpIHtcclxuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIHZhciBjID0gJ2NsYXNzJyxcclxuICAgICAgICAgICAgZm0gPSBjbWQuZm0sXHJcbiAgICAgICAgICAgIGRpc2FibGVkID0gZm0ucmVzKGMsICdkaXNhYmxlZCcpLFxyXG4gICAgICAgICAgICBhY3RpdmUgPSBmbS5yZXMoYywgJ2FjdGl2ZScpLFxyXG4gICAgICAgICAgICBob3ZlciA9IGZtLnJlcyhjLCAnaG92ZXInKSxcclxuICAgICAgICAgICAgaXRlbSA9ICdlbGZpbmRlci1idXR0b24tbWVudS1pdGVtJyxcclxuICAgICAgICAgICAgc2VsZWN0ZWQgPSAnZWxmaW5kZXItYnV0dG9uLW1lbnUtaXRlbS1zZWxlY3RlZCcsXHJcbiAgICAgICAgICAgIG1lbnUsXHJcbiAgICAgICAgICAgIHRhYmxlID0gJChcIjx0YWJsZT48dHI+PHRkPjwvdGQ+PHRkPjwvdGQ+PC90cj48L3RhYmxlPlwiKS5jc3MoJ2hlaWdodCcsICcxMDAlJyksXHJcbiAgICAgICAgICAgIGJ1dHRvbiA9ICQodGhpcykuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRlZmF1bHQgZWxmaW5kZXItYnV0dG9uJykgLy8uYXBwZW5kKHRhYmxlKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3RpdGxlJywgY21kLnRpdGxlKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJlbGZpbmRlci1idXR0b24taWNvbiBlbGZpbmRlci1idXR0b24taWNvbi0nICsgY21kLm5hbWUgKyAnXCI+PC9zcGFuPicpXHJcbiAgICAgICAgICAgICAgICAuaG92ZXIoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICFidXR0b24uaXMoJy4nICsgZGlzYWJsZWQpICYmIGJ1dHRvbltlLnR5cGUgPT0gJ21vdXNlbGVhdmUnID8gJ3JlbW92ZUNsYXNzJyA6ICdhZGRDbGFzcyddKGhvdmVyKTsgLyoqYnV0dG9uLnRvZ2dsZUNsYXNzKGhvdmVyKTsqL1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jbGljayhmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFidXR0b24uaXMoJy4nICsgZGlzYWJsZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoaG92ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVudSAmJiBjbWQudmFyaWFudHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xvc2Ugb3RoZXIgbWVudXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUuaXMoJzpoaWRkZW4nKSAmJiBjbWQuZm0uZ2V0VUkoKS5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUuc2xpZGVUb2dnbGUoMTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZC5leGVjKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNtZC5uYW1lID09ICdvcGVuc2VuZHBvcHVwJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VXaW5kb3cgPSAnPGRpdiBpZD1cIm1vZGFsXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiIGNsYXNzPVwibWVzc2FnZS13aW5kb3dcIj48ZGl2IGNsYXNzPVwid2luZG93IGFsZXJ0IGVsZmluZGVyLWRpYWxvZyBcIj48ZGl2IGNsYXNzPVwiaGVhZGVyXCI+PGRpdiBjbGFzcz1cImNsb3NlXCI+PC9kaXY+PGgyPicgKyBjbWQuZm0uaTE4LnJ1Lm1lc3NhZ2VzLmF0dGVudGlvblRoZVJlc3RyaWN0aW9uICsgJzwvaDI+PC9kaXY+PGRpdiBjbGFzcz1cImNvbnRlbnRcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBpZD1cIm1lc3NhZ2UtcGFuZWxcIj48ZGl2IGNsYXNzPVwiY29udGVudC1ncm91cCBtZXNzLWJveFwiPjxkaXYgY2xhc3M9XCJpbmZvXCI+PHNwYW4+JyArIGNtZC5mbS5pMTgucnUubWVzc2FnZXMubm9Nb3JlVGhpcnR5RmlsZXMgKyAnPC9zcGFuPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9XCJidG4tZ3JvdXBcIj48ZGl2IGNsYXNzPVwiYnRuIGJ0bi1ncmVlbiBidG4tY2xvc2VcIj4nICsgY21kLmZtLmkxOC5ydS5tZXNzYWdlcy5idG5DbG9zZSArICc8L2Rpdj48L2Rpdj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNlbGZpbmRlcicpLmFmdGVyKG1lc3NhZ2VXaW5kb3cpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI21vZGFsLm1lc3NhZ2Utd2luZG93Jykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI21vZGFsLm1lc3NhZ2Utd2luZG93IC53aW5kb3cgLmhlYWRlciAuY2xvc2UsICNtb2RhbC5tZXNzYWdlLXdpbmRvdyAud2luZG93IC5jb250ZW50ICNtZXNzYWdlLXBhbmVsIC5idG4tY2xvc2UnKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5rZXlkb3duKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDI3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsb3NlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI21vZGFsLm1lc3NhZ2Utd2luZG93JykuaGlkZSgpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICB0ZXh0ID0gJCh0aGlzKS5hcHBlbmQoJzxzcGFuIGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uLXRleHRcIj4nICsgY21kLnRpdGxlICsgJzwvc3Bhbj4nKSxcclxuICAgICAgICAgICAgaGlkZU1lbnUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIG1lbnUuaGlkZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIC8vdGFibGUuZmluZChcInRkOmZpcnN0XCIpLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJlbGZpbmRlci1idXR0b24taWNvbiBlbGZpbmRlci1idXR0b24taWNvbi0nICsgY21kLm5hbWUgKyAnXCI+PC9zcGFuPicpO1xyXG4gICAgICAgIC8vdGFibGUuZmluZChcInRkOmxhc3RcIikuYXBwZW5kKCc8c3BhbiBjbGFzcz1cImVsZmluZGVyLWJ1dHRvbi10ZXh0XCI+JyArIGNtZC50aXRsZSArICc8L3NwYW4+Jyk7XHJcbiAgICAgICAgLy8gaWYgY29tbWFuZCBoYXMgdmFyaWFudHMgY3JlYXRlIG1lbnVcclxuICAgICAgICBpZiAoJC5pc0FycmF5KGNtZC52YXJpYW50cykpIHtcclxuICAgICAgICAgICAgYnV0dG9uLmFkZENsYXNzKCdlbGZpbmRlci1tZW51YnV0dG9uJyk7XHJcblxyXG4gICAgICAgICAgICBtZW51ID0gJCgnPGRpdiBjbGFzcz1cInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCBlbGZpbmRlci1idXR0b24tbWVudSB1aS1jb3JuZXItYWxsXCIvPicpXHJcbiAgICAgICAgICAgICAgICAuaGlkZSgpXHJcbiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oYnV0dG9uKVxyXG4gICAgICAgICAgICAgICAgLnpJbmRleCgxMiArIGJ1dHRvbi56SW5kZXgoKSlcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZSgnLicgKyBpdGVtLCAnaG92ZXInLCBmdW5jdGlvbigpIHsgJCh0aGlzKS50b2dnbGVDbGFzcyhob3Zlcik7IH0pXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoJy4nICsgaXRlbSwgJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVDbGFzcyhob3Zlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgY21kLmV4ZWMoY21kLmZtLnNlbGVjdGVkKCksICQodGhpcykuZGF0YSgndmFsdWUnKSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNtZC5mbS5iaW5kKCdkaXNhYmxlIHNlbGVjdCcsIGhpZGVNZW51KS5nZXRVSSgpLmNsaWNrKGhpZGVNZW51KTtcclxuXHJcbiAgICAgICAgICAgIGNtZC5jaGFuZ2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBtZW51Lmh0bWwoJycpO1xyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGNtZC52YXJpYW50cywgZnVuY3Rpb24oaSwgdmFyaWFudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lbnUuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCInICsgaXRlbSArICdcIj4nICsgdmFyaWFudFsxXSArICc8L2Rpdj4nKS5kYXRhKCd2YWx1ZScsIHZhcmlhbnRbMF0pLmFkZENsYXNzKHZhcmlhbnRbMF0gPT0gY21kLnZhbHVlID8gc2VsZWN0ZWQgOiAnJykpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY21kLmNoYW5nZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjbWQuZGlzYWJsZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVDbGFzcyhhY3RpdmUgKyAnICcgKyBob3ZlcikuYWRkQ2xhc3MoZGlzYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBidXR0b24ucmVtb3ZlQ2xhc3MoZGlzYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbltjbWQuYWN0aXZlKCkgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJ10oYWN0aXZlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNoYW5nZSgpO1xyXG4gICAgfSk7XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbiQuZm4uZWxmaW5kZXJibHVlYnV0dG9uID0gZnVuY3Rpb24oY21kKSB7XHJcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICB2YXIgYyA9ICdjbGFzcycsXHJcbiAgICAgICAgICAgIGZtID0gY21kLmZtLFxyXG4gICAgICAgICAgICBkaXNhYmxlZCA9IGZtLnJlcyhjLCAnZGlzYWJsZWQnKSxcclxuICAgICAgICAgICAgYWN0aXZlID0gZm0ucmVzKGMsICdhY3RpdmUnKSxcclxuICAgICAgICAgICAgaG92ZXIgPSBmbS5yZXMoYywgJ2hvdmVyJyksXHJcbiAgICAgICAgICAgIGl0ZW0gPSAnZWxmaW5kZXItYnV0dG9uLW1lbnUtaXRlbScsXHJcbiAgICAgICAgICAgIHNlbGVjdGVkID0gJ2VsZmluZGVyLWJ1dHRvbi1tZW51LWl0ZW0tc2VsZWN0ZWQnLFxyXG4gICAgICAgICAgICBtZW51LFxyXG4gICAgICAgICAgICBidXR0b24gPSAkKHRoaXMpLmFkZENsYXNzKCd1aS1zdGF0ZS1kZWZhdWx0IGVsZmluZGVyLWJ1dHRvbiBidG4gYnRuLWJsdWUnKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3RpdGxlJywgY21kLnRpdGxlKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJlbGZpbmRlci1idXR0b24taWNvbiBlbGZpbmRlci1idXR0b24taWNvbi0nICsgY21kLm5hbWUgKyAnXCI+PC9zcGFuPicpXHJcbiAgICAgICAgICAgICAgICAuaG92ZXIoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICFidXR0b24uaXMoJy4nICsgZGlzYWJsZWQpICYmIGJ1dHRvbltlLnR5cGUgPT0gJ21vdXNlbGVhdmUnID8gJ3JlbW92ZUNsYXNzJyA6ICdhZGRDbGFzcyddKGhvdmVyKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghYnV0dG9uLmlzKCcuJyArIGRpc2FibGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQuZXhlYygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjbWQuY2hhbmdlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNtZC5kaXNhYmxlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnJlbW92ZUNsYXNzKGFjdGl2ZSArICcgJyArIGhvdmVyKS5hZGRDbGFzcyhkaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVDbGFzcyhkaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uW2NtZC5hY3RpdmUoKSA/ICdhZGRDbGFzcycgOiAncmVtb3ZlQ2xhc3MnXShhY3RpdmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2hhbmdlKCk7XHJcbiAgICB9KTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcbi8qKlxuICogQGNsYXNzICBlbEZpbmRlciB0b29sYmFyJ3MgYnV0dG9uIHRvciB1cGxvYWQgZmlsZVxuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKiovXG4kLmZuLmVsZmluZGVydXBsb2FkYnV0dG9uID0gZnVuY3Rpb24oY21kLCBpc2xpbmssdGV4dCkge1xuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYnV0dG9uO1xuICAgICAgICBjb25zb2xlLmxvZygxKTtcbiAgICAgICAgaWYgKGlzbGluaykgYnV0dG9uID0gJCh0aGlzKS5lbGZpbmRlcmxpbmtidXR0b24oY21kLG51bGwsdGV4dCkudW5iaW5kKCdjbGljaycpO1xuICAgICAgICBlbHNlIGJ1dHRvbiA9ICQodGhpcykuZWxmaW5kZXJidXR0b24oY21kKS51bmJpbmQoJ2NsaWNrJyk7XG5cbiAgICAgICAgdmFyIGZvcm0gPSAkKCc8Zm9ybS8+JykuYXBwZW5kVG8oYnV0dG9uKSxcblx0XHRcdGlucHV0ID0gJCgnPGlucHV0IHR5cGU9XCJmaWxlXCIgbXVsdGlwbGU9XCJ0cnVlXCIvPicpXG5cdFx0XHRcdC5jaGFuZ2UoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIF9pbnB1dCA9ICQodGhpcyk7XG5cdFx0XHRcdFx0aWYgKF9pbnB1dC52YWwoKSkge1xuXHRcdFx0XHRcdFx0Y21kLmV4ZWMoe2lucHV0IDogX2lucHV0LnJlbW92ZSgpWzBdfSk7XG5cdFx0XHRcdFx0XHRpbnB1dC5jbG9uZSh0cnVlKS5hcHBlbmRUbyhmb3JtKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0Zm9ybS5hcHBlbmQoaW5wdXQuY2xvbmUodHJ1ZSkpO1xuXG5cdFx0Y21kLmNoYW5nZShmdW5jdGlvbigpIHtcblx0XHRcdGZvcm1bY21kLmRpc2FibGVkKCkgPyAnaGlkZScgOiAnc2hvdyddKCk7XG5cdFx0fSlcblx0XHQuY2hhbmdlKCk7XG5cdH0pO1xufVxuIiwiXCJ1c2Ugc3RyaWN0XCI7IC8qKlxuICogQGNsYXNzICBlbEZpbmRlciB0b29sYmFyIGJ1dHRvbiB0byBzd2l0Y2ggY3VycmVudCBkaXJlY3Rvcnkgdmlldy5cbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG4kLmZuLmVsZmluZGVydmlld2J1dHRvbiA9IGZ1bmN0aW9uKGNtZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgYnV0dG9uID0gJCh0aGlzKS5lbGZpbmRlcmJ1dHRvbihjbWQpLFxyXG4gICAgICAgICAgICBpY29uID0gYnV0dG9uLmNoaWxkcmVuKCcuZWxmaW5kZXItYnV0dG9uLWljb24nKTtcclxuXHJcbiAgICAgICAgY21kLmNoYW5nZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGljb25zID0gY21kLnZhbHVlID09ICdpY29ucyc7XHJcblxyXG4gICAgICAgICAgICBpY29uLnRvZ2dsZUNsYXNzKCdlbGZpbmRlci1idXR0b24taWNvbi12aWV3LWxpc3QnLCBpY29ucyk7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5hdHRyKCd0aXRsZScsIGNtZC5mbS5pMThuKGljb25zID8gJ3ZpZXdsaXN0JyA6ICd2aWV3aWNvbnMnKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjsgLyoqXG4gKiBAY2xhc3MgIGVsRmluZGVyIHRvb2xiYXIgc2VhcmNoIGJ1dHRvbiB3aWRnZXQuXG4gKlxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqKi9cclxuJC5mbi5lbGZpbmRlcnNlYXJjaGJ1dHRvbiA9IGZ1bmN0aW9uKGNtZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gZmFsc2UsXHJcbiAgICAgICAgICAgIGJ1dHRvbiA9ICQodGhpcykuaGlkZSgpLmFkZENsYXNzKCd1aS13aWRnZXQtY29udGVudCBlbGZpbmRlci1idXR0b24gJyArIGNtZC5mbS5yZXMoJ2NsYXNzJywgJ3NlYXJjaGJ0bicpICsgJycpLFxyXG4gICAgICAgICAgICBzZWFyY2ggPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWwgPSAkLnRyaW0oaW5wdXQudmFsKCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNtZC5leGVjKHZhbCkuZG9uZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNtZC5mbS50cmlnZ2VyKCdzZWFyY2hlbmQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYWJvcnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlucHV0LnZhbCgnJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY21kLmZtLnRyaWdnZXIoJ3NlYXJjaGVuZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBpbnB1dCA9ICQoJzxpbnB1dCB0eXBlPVwidGV4dFwiIHNpemU9XCI0MlwiLz4nKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZFRvKGJ1dHRvbilcclxuICAgICAgICAgICAgICAgIC8vIHRvIGF2b2lkIGZtIHNob3J0Y3V0cyBvbiBhcnJvd3NcclxuICAgICAgICAgICAgICAgIC5rZXlwcmVzcyhmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAua2V5ZG93bihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZS5rZXlDb2RlID09IDEzICYmIHNlYXJjaCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDI3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWJvcnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJCgnPHNwYW4gY2xhc3M9XCJ1aS1pY29uIHVpLWljb24tc2VhcmNoXCIgdGl0bGU9XCInICsgY21kLnRpdGxlICsgJ1wiLz4nKVxyXG4gICAgICAgICAgICAuYXBwZW5kVG8oYnV0dG9uKVxyXG4gICAgICAgICAgICAuY2xpY2soc2VhcmNoKTtcclxuXHJcbiAgICAgICAgJCgnPHNwYW4gY2xhc3M9XCJ1aS1pY29uIHVpLWljb24tY2xvc2VcIi8+JylcclxuICAgICAgICAgICAgLmFwcGVuZFRvKGJ1dHRvbilcclxuICAgICAgICAgICAgLmNsaWNrKGFib3J0KTsgLy8gd2FpdCB3aGVuIGJ1dHRvbiB3aWxsIGJlIGFkZGVkIHRvIERPTVxyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5wYXJlbnQoKS5kZXRhY2goKTtcclxuICAgICAgICAgICAgY21kLmZtLmdldFVJKCd0b29sYmFyJykucHJlcGVuZChidXR0b24uc2hvdygpKTtcclxuICAgICAgICAgICAgLy8gcG9zaXRpb24gaWNvbnMgZm9yIGllN1xyXG4gICAgICAgICAgICBpZiAoY21kLmZtLlVBLmx0SUU3KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaWNvbiA9IGJ1dHRvbi5jaGlsZHJlbihjbWQuZm0uZGlyZWN0aW9uID09ICdsdHInID8gJy51aS1pY29uLWNsb3NlJyA6ICcudWktaWNvbi1zZWFyY2gnKTtcclxuICAgICAgICAgICAgICAgIGljb24uY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICByaWdodDogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogcGFyc2VJbnQoYnV0dG9uLndpZHRoKCkpIC0gaWNvbi5vdXRlcldpZHRoKHRydWUpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDIwMCk7XHJcblxyXG4gICAgICAgIGNtZC5mbVxyXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpbnB1dC51bmJpbmQoJ2tleWRvd24nKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnNlbGVjdChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlucHV0LmJsdXIoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmJpbmQoJ3NlYXJjaGVuZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaW5wdXQudmFsKCcnKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnZpZXdjaGFuZ2UoYWJvcnQpXHJcbiAgICAgICAgICAgIC5zaG9ydGN1dCh7XHJcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnY3RybCtmIGYzJyxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBjbWQudGl0bGUsXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7IGlucHV0LnNlbGVjdCgpLmZvY3VzKCk7IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7IC8qKlxuICogQGNsYXNzICBlbEZpbmRlciB0b29sYmFyIGJ1dHRvbiBtZW51IHdpdGggc29ydCB2YXJpYW50cy5cbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG4kLmZuLmVsZmluZGVyc29ydGJ1dHRvbiA9IGZ1bmN0aW9uKGNtZCkge1xyXG5cclxuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGZtID0gY21kLmZtLFxyXG4gICAgICAgICAgICBuYW1lID0gY21kLm5hbWUsXHJcbiAgICAgICAgICAgIGMgPSAnY2xhc3MnLFxyXG4gICAgICAgICAgICBkaXNhYmxlZCA9IGZtLnJlcyhjLCAnZGlzYWJsZWQnKSxcclxuICAgICAgICAgICAgaG92ZXIgPSBmbS5yZXMoYywgJ2hvdmVyJyksXHJcbiAgICAgICAgICAgIGl0ZW0gPSAnZWxmaW5kZXItYnV0dG9uLW1lbnUtaXRlbScsXHJcbiAgICAgICAgICAgIHNlbGVjdGVkID0gaXRlbSArICctc2VsZWN0ZWQnLFxyXG4gICAgICAgICAgICBhc2MgPSBzZWxlY3RlZCArICctYXNjJyxcclxuICAgICAgICAgICAgZGVzYyA9IHNlbGVjdGVkICsgJy1kZXNjJyxcclxuICAgICAgICAgICAgYnV0dG9uID0gJCh0aGlzKS5hZGRDbGFzcygndWktc3RhdGUtZGVmYXVsdCBlbGZpbmRlci1idXR0b24gZWxmaW5kZXItbWVudWJ1dHRvbiBlbGZpbmVyLWJ1dHRvbi0nICsgbmFtZSlcclxuICAgICAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsIGNtZC50aXRsZSlcclxuICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxzcGFuIGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uLWljb24gZWxmaW5kZXItYnV0dG9uLWljb24tJyArIG5hbWUgKyAnXCIvPicpXHJcbiAgICAgICAgICAgICAgICAuaG92ZXIoZnVuY3Rpb24oZSkgeyAhYnV0dG9uLmlzKCcuJyArIGRpc2FibGVkKSAmJiBidXR0b24udG9nZ2xlQ2xhc3MoaG92ZXIpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWJ1dHRvbi5pcygnLicgKyBkaXNhYmxlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5pcygnOmhpZGRlbicpICYmIGNtZC5mbS5nZXRVSSgpLmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUuc2xpZGVUb2dnbGUoMTAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgbWVudSA9ICQoJzxkaXYgY2xhc3M9XCJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgZWxmaW5kZXItYnV0dG9uLW1lbnUgdWktY29ybmVyLWFsbFwiLz4nKVxyXG4gICAgICAgICAgICAgICAgLmhpZGUoKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZFRvKGJ1dHRvbilcclxuICAgICAgICAgICAgICAgIC56SW5kZXgoMTIgKyBidXR0b24uekluZGV4KCkpXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoJy4nICsgaXRlbSwgJ2hvdmVyJywgZnVuY3Rpb24oKSB7ICQodGhpcykudG9nZ2xlQ2xhc3MoaG92ZXIpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmRlbGVnYXRlKCcuJyArIGl0ZW0sICdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgdXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBtZW51LmNoaWxkcmVuKCc6bm90KDpsYXN0KScpLnJlbW92ZUNsYXNzKHNlbGVjdGVkICsgJyAnICsgYXNjICsgJyAnICsgZGVzYylcclxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKCdbcmVsPVwiJyArIGZtLnNvcnRUeXBlICsgJ1wiXScpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKHNlbGVjdGVkICsgJyAnICsgKGZtLnNvcnRPcmRlciA9PSAnYXNjJyA/IGFzYyA6IGRlc2MpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBtZW51LmNoaWxkcmVuKCc6bGFzdCcpLnRvZ2dsZUNsYXNzKHNlbGVjdGVkLCBmbS5zb3J0U3RpY2tGb2xkZXJzKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgaGlkZSA9IGZ1bmN0aW9uKCkgeyBtZW51LmhpZGUoKTsgfTtcclxuXHJcblxyXG4gICAgICAgICQuZWFjaChmbS5zb3J0UnVsZXMsIGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIG1lbnUuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCInICsgaXRlbSArICdcIiByZWw9XCInICsgbmFtZSArICdcIj48c3BhbiBjbGFzcz1cInVpLWljb24gdWktaWNvbi1hcnJvd3RoaWNrLTEtblwiLz48c3BhbiBjbGFzcz1cInVpLWljb24gdWktaWNvbi1hcnJvd3RoaWNrLTEtc1wiLz4nICsgZm0uaTE4bignc29ydCcgKyBuYW1lKSArICc8L2Rpdj4nKS5kYXRhKCd0eXBlJywgbmFtZSkpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBtZW51LmNoaWxkcmVuKCkuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9ICQodGhpcykuYXR0cigncmVsJyk7XHJcblxyXG4gICAgICAgICAgICBjbWQuZXhlYyhbXSwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcclxuICAgICAgICAgICAgICAgIG9yZGVyOiB0eXBlID09IGZtLnNvcnRUeXBlID8gZm0uc29ydE9yZGVyID09ICdhc2MnID8gJ2Rlc2MnIDogJ2FzYycgOiBmbS5zb3J0T3JkZXIsXHJcbiAgICAgICAgICAgICAgICBzdGljazogZm0uc29ydFN0aWNrRm9sZGVyc1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKCc8ZGl2IGNsYXNzPVwiJyArIGl0ZW0gKyAnICcgKyBpdGVtICsgJy1zZXBhcmF0ZWRcIj48c3BhbiBjbGFzcz1cInVpLWljb24gdWktaWNvbi1jaGVja1wiLz4nICsgZm0uaTE4bignc29ydEZvbGRlcnNGaXJzdCcpICsgJzwvZGl2PicpXHJcbiAgICAgICAgICAgIC5hcHBlbmRUbyhtZW51KVxyXG4gICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjbWQuZXhlYyhbXSwgeyB0eXBlOiBmbS5zb3J0VHlwZSwgb3JkZXI6IGZtLnNvcnRPcmRlciwgc3RpY2s6ICFmbS5zb3J0U3RpY2tGb2xkZXJzIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZm0uYmluZCgnZGlzYWJsZSBzZWxlY3QnLCBoaWRlKS5nZXRVSSgpLmNsaWNrKGhpZGUpO1xyXG5cclxuICAgICAgICBmbS5iaW5kKCdzb3J0Y2hhbmdlJywgdXBkYXRlKTtcclxuXHJcbiAgICAgICAgaWYgKG1lbnUuY2hpbGRyZW4oKS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgIGNtZC5jaGFuZ2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnRvZ2dsZUNsYXNzKGRpc2FibGVkLCBjbWQuZGlzYWJsZWQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNoYW5nZSgpO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBidXR0b24uYWRkQ2xhc3MoZGlzYWJsZWQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuXHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbiQuZm4uZWxmaW5kZXJtb3JlYnV0dG9uID0gZnVuY3Rpb24oY21kKSB7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgZm0gPSBjbWQuZm0sXHJcbiAgICAgICAgICAgIGNvbW1hbmRzID0gZm0uX2NvbW1hbmRzLFxyXG4gICAgICAgICAgICBuYW1lID0gY21kLm5hbWUsXHJcbiAgICAgICAgICAgIGMgPSAnY2xhc3MnLFxyXG4gICAgICAgICAgICBkaXNhYmxlZCA9IGZtLnJlcyhjLCAnZGlzYWJsZWQnKSxcclxuICAgICAgICAgICAgaG92ZXIgPSBmbS5yZXMoYywgJ2hvdmVyJyksXHJcbiAgICAgICAgICAgIGl0ZW0gPSAnZWxmaW5kZXItYnV0dG9uLW1lbnUtaXRlbScsXHJcbiAgICAgICAgICAgIGluY2x1ZGVkQ29tbWFuZHMgPSBbJ2NvcHknLCAncGFzdGUnLCAncm0nLCAncmVuYW1lJywgJ2Rvd25sb2FkJywgJ29wZW5zZW5kcG9wdXAnXSxcclxuXHJcbiAgICAgICAgICAgIGJ1dHRvbiA9ICQodGhpcykuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRlZmF1bHQgZWxmaW5kZXItYnV0dG9uIGVsZmluZGVyLW1lbnVidXR0b24gZWxmaW5lci1idXR0b24tJyArIG5hbWUgKyAnIHVpLWVsZmluZGVyLWJ1dHRvbi1sYXN0JylcclxuICAgICAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsIGNtZC50aXRsZSlcclxuICAgICAgICAgICAgICAgIC5ob3ZlcihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgIWJ1dHRvbi5pcygnLicgKyBkaXNhYmxlZCkgJiYgYnV0dG9uLnRvZ2dsZUNsYXNzKGhvdmVyKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghYnV0dG9uLmlzKCcuJyArIGRpc2FibGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gobWVudS5jaGlsZHJlbigpLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ID0gJCh0aGlzKS5hdHRyKCdyZWwnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoZGlzYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGNvbSA9IGNvbW1hbmRzW3RdKSB8fCBjb20uZ2V0c3RhdGUoKSAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhkaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZW51LmlzKCc6aGlkZGVuJykgJiYgY21kLmZtLmdldFVJKCkuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5zbGlkZVRvZ2dsZSgxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICB0ZXh0ID0gJCh0aGlzKS5hcHBlbmQoJzxzcGFuIGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uLXRleHRcIj4nICsgY21kLnRpdGxlICsgJzwvc3Bhbj4nKSxcclxuICAgICAgICAgICAgaWNvbiA9ICQodGhpcykuYXBwZW5kKCc8c3BhbiBjbGFzcz1cImNhcmV0XCI+PC9zcGFuPicpLFxyXG4gICAgICAgICAgICBtZW51ID0gJCgnPGRpdiBjbGFzcz1cInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCBlbGZpbmRlci1idXR0b24tbWVudSB1aS1jb3JuZXItYWxsXCIvPicpXHJcbiAgICAgICAgICAgICAgICAuaGlkZSgpXHJcbiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oYnV0dG9uKVxyXG4gICAgICAgICAgICAgICAgLnpJbmRleCgxMiArIGJ1dHRvbi56SW5kZXgoKSlcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZSgnLicgKyBpdGVtLCAnaG92ZXInLCBmdW5jdGlvbigpIHsgISQodGhpcykuaXMoJy4nICsgZGlzYWJsZWQpICYmICQodGhpcykudG9nZ2xlQ2xhc3MoaG92ZXIpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmRlbGVnYXRlKCcuJyArIGl0ZW0sICdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuXHJcbiAgICAgICAgICAgIGhpZGUgPSBmdW5jdGlvbigpIHsgbWVudS5oaWRlKCk7IH0sXHJcblxyXG4gICAgICAgICAgICBjbGVhck1lbnUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIG1lbnUudGV4dChcIlwiKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGluaXRNZW51ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkLmVhY2goaW5jbHVkZWRDb21tYW5kcywgZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZW51LmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiJyArIGl0ZW0gKyAnXCIgcmVsPVwiJyArIHZhbHVlICsgJ1wiPjxzcGFuIGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uLWljb24gZWxmaW5kZXItYnV0dG9uLWljb24tJyArIHZhbHVlICsgJ1wiLz48c3BhbiBjbGFzcz1cInVpLWljb24gdWktaWNvbi1hcnJvd3RoaWNrLTEtc1wiLz4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIGZtLmkxOG4oJ2NtZCcgKyB2YWx1ZSkgKyAnPC9kaXY+JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ID0gJCh0aGlzKS5hdHRyKCdyZWwnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICEkKHRoaXMpLmlzKCcuJyArIGRpc2FibGVkKSAmJiBjbWQuZXhlYyh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBhZGRDb21tYW5kID0gZnVuY3Rpb24oY29tTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaW5jbHVkZWRDb21tYW5kcy5wdXNoKGNvbU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgY2xlYXJNZW51KCk7XHJcbiAgICAgICAgICAgICAgICBpbml0TWVudSgpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICBpbml0TWVudSgpO1xyXG4gICAgICAgIGZtLmJpbmQoJ2Rpc2FibGUgc2VsZWN0JywgaGlkZSkuZ2V0VUkoKS5jbGljayhoaWRlKTtcclxuXHJcbiAgICAgICAgaWYgKG1lbnUuY2hpbGRyZW4oKS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgIGNtZC5jaGFuZ2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24udG9nZ2xlQ2xhc3MoZGlzYWJsZWQsIGNtZC5kaXNhYmxlZCgpKTtcclxuICAgICAgICAgICAgfSkuY2hhbmdlKCk7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5hZGRDbGFzcyhkaXNhYmxlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG59OyIsIiQuZm4uZWxmaW5kZXJwYW5lbCA9IGZ1bmN0aW9uKGZtKSB7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgcGFuZWwgPSAkKHRoaXMpLmFkZENsYXNzKCdlbGZpbmRlci1wYW5lbCB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwnKSxcclxuICAgICAgICAgICAgbWFyZ2luID0gJ21hcmdpbi0nICsgKGZtLmRpcmVjdGlvbiA9PSAnbHRyJyA/ICdsZWZ0JyA6ICdyaWdodCcpO1xyXG5cclxuICAgICAgICBmbS5vbmUoJ2xvYWQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciBuYXZiYXIgPSBmbS5nZXRVSSgnbmF2YmFyJyk7XHJcblxyXG4gICAgICAgICAgICBwYW5lbC5jc3MobWFyZ2luLCBwYXJzZUludChuYXZiYXIub3V0ZXJXaWR0aCh0cnVlKSkpO1xyXG4gICAgICAgICAgICBuYXZiYXIuYmluZCgncmVzaXplJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBwYW5lbC5pcygnOnZpc2libGUnKSAmJiBwYW5lbC5jc3MobWFyZ2luLCBwYXJzZUludChuYXZiYXIub3V0ZXJXaWR0aCh0cnVlKSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxuICogQGNsYXNzICBlbEZpbmRlciBjb250ZXh0bWVudVxuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKiovXHJcbiQuZm4uZWxmaW5kZXJjb250ZXh0bWVudSA9IGZ1bmN0aW9uKGZtKSB7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgbWVudSA9ICQodGhpcykuYWRkQ2xhc3MoJ3VpLWhlbHBlci1yZXNldCB1aS13aWRnZXQgdWktc3RhdGUtZGVmYXVsdCB1aS1jb3JuZXItYWxsIGVsZmluZGVyLWNvbnRleHRtZW51IGVsZmluZGVyLWNvbnRleHRtZW51LScgKyBmbS5kaXJlY3Rpb24pXHJcbiAgICAgICAgICAgICAgICAuaGlkZSgpXHJcbiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oJ2JvZHknKVxyXG4gICAgICAgICAgICAgICAgLmRlbGVnYXRlKCcuZWxmaW5kZXItY29udGV4dG1lbnUtaXRlbScsICdtb3VzZWVudGVyIG1vdXNlbGVhdmUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpO1xyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHN1YnBvcyA9IGZtLmRpcmVjdGlvbiA9PSAnbHRyJyA/ICdsZWZ0JyA6ICdyaWdodCcsXHJcbiAgICAgICAgICAgIHR5cGVzID0gJC5leHRlbmQoe30sIGZtLm9wdGlvbnMuY29udGV4dG1lbnUpLFxyXG4gICAgICAgICAgICB0cGwgPSAnPGRpdiBjbGFzcz1cImVsZmluZGVyLWNvbnRleHRtZW51LWl0ZW1cIj48c3BhbiBjbGFzcz1cImVsZmluZGVyLWJ1dHRvbi1pY29uIHtpY29ufSBlbGZpbmRlci1jb250ZXh0bWVudS1pY29uXCIvPjxzcGFuPntsYWJlbH08L3NwYW4+PC9kaXY+JyxcclxuICAgICAgICAgICAgaXRlbSA9IGZ1bmN0aW9uKGxhYmVsLCBpY29uLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICQodHBsLnJlcGxhY2UoJ3tpY29ufScsIGljb24gPyAnZWxmaW5kZXItYnV0dG9uLWljb24tJyArIGljb24gOiAnJykucmVwbGFjZSgne2xhYmVsfScsIGxhYmVsKSlcclxuICAgICAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgb3BlbiA9IGZ1bmN0aW9uKHgsIHkpIHtcclxuICAgICAgICAgICAgICAgIHZhciB3aW4gPSAkKHdpbmRvdyksXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBtZW51Lm91dGVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBtZW51Lm91dGVySGVpZ2h0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgd3dpZHRoID0gd2luLndpZHRoKCksXHJcbiAgICAgICAgICAgICAgICAgICAgd2hlaWdodCA9IHdpbi5oZWlnaHQoKSxcclxuICAgICAgICAgICAgICAgICAgICBzY3JvbGx0b3AgPSB3aW4uc2Nyb2xsVG9wKCksXHJcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsbGVmdCA9IHdpbi5zY3JvbGxMZWZ0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgY3NzID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICh5ICsgaGVpZ2h0IDwgd2hlaWdodCA/IHkgOiB5IC0gaGVpZ2h0ID4gMCA/IHkgLSBoZWlnaHQgOiB5KSArIHNjcm9sbHRvcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogKHggKyB3aWR0aCA8IHd3aWR0aCA/IHggOiB4IC0gd2lkdGgpICsgc2Nyb2xsbGVmdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3otaW5kZXgnOiAxMDAgKyBmbS5nZXRVSSgnd29ya3pvbmUnKS56SW5kZXgoKVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgbWVudS5jc3MoY3NzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zaG93KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY3NzID0geyAnei1pbmRleCc6IGNzc1snei1pbmRleCddICsgMTAgfTtcclxuICAgICAgICAgICAgICAgIGNzc1tzdWJwb3NdID0gcGFyc2VJbnQobWVudS53aWR0aCgpKTtcclxuICAgICAgICAgICAgICAgIG1lbnUuZmluZCgnLmVsZmluZGVyLWNvbnRleHRtZW51LXN1YicpLmNzcyhjc3MpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgY2xvc2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIG1lbnUuaGlkZSgpLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBjcmVhdGUgPSBmdW5jdGlvbih0eXBlLCB0YXJnZXRzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VwID0gZmFsc2U7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICQuZWFjaCh0eXBlc1t0eXBlXSB8fCBbXSwgZnVuY3Rpb24oaSwgbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjbWQsIG5vZGUsIHN1Ym1lbnU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lID09ICd8JyAmJiBzZXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1jb250ZXh0bWVudS1zZXBhcmF0b3JcIi8+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjbWQgPSBmbS5jb21tYW5kKG5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoY21kICYmIGNtZC5nZXRzdGF0ZSh0YXJnZXRzKSAhPSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY21kLnZhcmlhbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNtZC52YXJpYW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gaXRlbShjbWQudGl0bGUsIGNtZC5uYW1lLCBmdW5jdGlvbigpIHt9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJtZW51ID0gJCgnPGRpdiBjbGFzcz1cInVpLWNvcm5lci1hbGwgZWxmaW5kZXItY29udGV4dG1lbnUtc3ViXCIvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZFRvKG5vZGUuYXBwZW5kKCc8c3BhbiBjbGFzcz1cImVsZmluZGVyLWNvbnRleHRtZW51LWFycm93XCIvPicpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmFkZENsYXNzKCdlbGZpbmRlci1jb250ZXh0bWVudS1ncm91cCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhvdmVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJtZW51LnRvZ2dsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGNtZC52YXJpYW50cywgZnVuY3Rpb24oaSwgdmFyaWFudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1lbnUuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItY29udGV4dG1lbnUtaXRlbVwiPjxzcGFuPicgKyB2YXJpYW50WzFdICsgJzwvc3Bhbj48L2Rpdj4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWQuZXhlYyh0YXJnZXRzLCB2YXJpYW50WzBdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGl0ZW0oY21kLnRpdGxlLCBjbWQubmFtZSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWQuZXhlYyh0YXJnZXRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZW51LmFwcGVuZChub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VwID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZUZyb21SYXcgPSBmdW5jdGlvbihyYXcpIHtcclxuICAgICAgICAgICAgICAgICQuZWFjaChyYXcsIGZ1bmN0aW9uKGksIGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEubGFiZWwgJiYgdHlwZW9mIGRhdGEuY2FsbGJhY2sgPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gaXRlbShkYXRhLmxhYmVsLCBkYXRhLmljb24sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUuYXBwZW5kKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICQoZG9jdW1lbnQpLmJpbmQoJ2NsaWNrLicgKyB0aGlzLm5hbWVzcGFjZSwgZnVuY3Rpb24oZSkgeyBjbG9zZSgpOyB9KTtcclxuICAgICAgICBmbS5vbmUoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgZm0uYmluZCgnY29udGV4dG1lbnUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBlLmRhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNsb3NlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnR5cGUgJiYgZGF0YS50YXJnZXRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZShkYXRhLnR5cGUsIGRhdGEudGFyZ2V0cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnJhdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGcm9tUmF3KGRhdGEucmF3KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG1lbnUuY2hpbGRyZW4oKS5sZW5ndGggJiYgb3BlbihkYXRhLngsIGRhdGEueSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm9uZSgnZGVzdHJveScsIGZ1bmN0aW9uKCkgeyBtZW51LnJlbW92ZSgpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmJpbmQoJ2Rpc2FibGUgc2VsZWN0JywgY2xvc2UpXHJcbiAgICAgICAgICAgICAgICAuZ2V0VUkoKS5jbGljayhjbG9zZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG59OyIsIlwidXNlIHN0cmljdFwiO1xyXG4vKipcclxuICogQGNsYXNzIGVsRmluZGVyIHVpXHJcbiAqIERpc3BsYXkgY3VycmVudCBmb2xkZXIgcGF0aCBpbiBzdGF0dXNiYXIuXHJcbiAqIENsaWNrIG9uIGZvbGRlciBuYW1lIGluIHBhdGggLSBvcGVuIGZvbGRlclxyXG4gKlxyXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxyXG4gKiovXHJcbiQuZm4uZWxmaW5kZXJwYXRoID0gZnVuY3Rpb24oZm0pIHtcclxuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHBhdGggPSAkKHRoaXMpLmFkZENsYXNzKCdlbGZpbmRlci1wYXRoJykuaHRtbCgnJm5ic3A7JylcclxuICAgICAgICAgICAgLmRlbGVnYXRlKCdhJywgJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGhhc2ggPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKS5zdWJzdHIoMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgaGFzaCAhPSBmbS5jd2QoKS5oYXNoICYmIGZtLmV4ZWMoJ29wZW4nLCBoYXNoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnByZXBlbmRUbyhmbS5nZXRVSSgnc3RhdHVzYmFyJykuc2hvdygpKTtcclxuICAgICAgICBmbS5iaW5kKCdvcGVuIHNlYXJjaGVuZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRpcnMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICAkLmVhY2goZm0ucGFyZW50cyhmbS5jd2QoKS5oYXNoKSwgZnVuY3Rpb24oaSwgaGFzaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpcnMucHVzaCgnPGEgaHJlZj1cIiMnICsgaGFzaCArICdcIj4nICsgZm0uZXNjYXBlKGZtLmZpbGUoaGFzaCkubmFtZSkgKyAnPC9hPicpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcGF0aC5odG1sKGRpcnMuam9pbihmbS5vcHRpb24oJ3NlcGFyYXRvcicpKSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5iaW5kKCdzZWFyY2gnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHBhdGguaHRtbChmbS5pMThuKCdzZWFyY3Jlc3VsdCcpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuLyoqXG4gKiBAY2xhc3MgZWxGaW5kZXIgdWlcbiAqIERpc3BsYXkgbnVtYmVyIG9mIGZpbGVzL3NlbGVjdGVkIGZpbGVzIGFuZCBpdHMgc2l6ZSBpbiBzdGF0dXNiYXJcbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG4kLmZuLmVsZmluZGVyc3RhdCA9IGZ1bmN0aW9uKGZtKSB7XHJcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzaXplID0gJCh0aGlzKS5hZGRDbGFzcygnZWxmaW5kZXItc3RhdC1zaXplJyksXHJcbiAgICAgICAgICAgIHNlbCA9ICQoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1zdGF0LXNlbGVjdGVkXCIvPicpLFxyXG4gICAgICAgICAgICB0aXRsZXNpemUgPSBmbS5pMThuKCdzaXplJykudG9Mb3dlckNhc2UoKSxcclxuICAgICAgICAgICAgdGl0bGVpdGVtcyA9IGZtLmkxOG4oJ2l0ZW1zJykudG9Mb3dlckNhc2UoKSxcclxuICAgICAgICAgICAgdGl0bGVzZWwgPSBmbS5pMThuKCdzZWxlY3RlZCcpLFxyXG4gICAgICAgICAgICBzZXRzdGF0ID0gZnVuY3Rpb24oZmlsZXMsIGN3ZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHMgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgICQuZWFjaChmaWxlcywgZnVuY3Rpb24oaSwgZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY3dkIHx8IGZpbGUucGhhc2ggPT0gY3dkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcyArPSBwYXJzZUludChmaWxlLnNpemUpIHx8IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBzaXplLmh0bWwodGl0bGVpdGVtcyArICc6ICcgKyBjICsgJywgJyArIHRpdGxlc2l6ZSArICc6ICcgKyBmbS5mb3JtYXRTaXplKHMpKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZm0uZ2V0VUkoJ3N0YXR1c2JhcicpLnByZXBlbmQoc2l6ZSkuYXBwZW5kKHNlbCkuc2hvdygpO1xyXG5cclxuICAgICAgICBmbVxyXG4gICAgICAgICAgICAuYmluZCgnb3BlbiByZWxvYWQgYWRkIHJlbW92ZSBjaGFuZ2Ugc2VhcmNoZW5kJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRzdGF0KGZtLmZpbGVzKCksIGZtLmN3ZCgpLmhhc2gpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc2VhcmNoKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHNldHN0YXQoZS5kYXRhLmZpbGVzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnNlbGVjdChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gMCxcclxuICAgICAgICAgICAgICAgICAgICBjID0gMCxcclxuICAgICAgICAgICAgICAgICAgICBmaWxlcyA9IGZtLnNlbGVjdGVkRmlsZXMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsZXMubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzID0gZmlsZXNbMF0uc2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWwuaHRtbChmbS5lc2NhcGUoZmlsZXNbMF0ubmFtZSkgKyAocyA+IDAgPyAnLCAnICsgZm0uZm9ybWF0U2l6ZShzKSA6ICcnKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkLmVhY2goZmlsZXMsIGZ1bmN0aW9uKGksIGZpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjKys7XHJcbiAgICAgICAgICAgICAgICAgICAgcyArPSBwYXJzZUludChmaWxlLnNpemUpIHx8IDA7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWwuaHRtbChjID8gdGl0bGVzZWwgKyAnOiAnICsgYyArICcsICcgKyB0aXRsZXNpemUgKyAnOiAnICsgZm0uZm9ybWF0U2l6ZShzKSA6ICcmbmJzcDsnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuJC5mbi5lbGZpbmRlcmluZm9iYXIgPSBmdW5jdGlvbihmbSwgb3B0cykge1xyXG4gICAgdGhpcy5ub3QoJy5lbGZpbmRlci1pbmZvYmFyJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgaW5jbHVkZWRDb21tYW5kcyA9IFsncm0nLCAnZG93bmxvYWQnLCAnb3BlbnNlbmRwb3B1cCddLFxyXG4gICAgICAgICAgICBjb21tYW5kcyA9IGZtLl9jb21tYW5kcyxcclxuICAgICAgICAgICAgY29tLFxyXG4gICAgICAgICAgICBidXR0b24sXHJcbiAgICAgICAgICAgIGljb24gPSAkKCc8ZGl2IGNsYXNzPVwic2VsZWN0aWNvXCI+PHNwYW4+PC9zcGFuPjwvZGl2PicpLFxyXG4gICAgICAgICAgICBuYW1lID0gJCgnPGRpdiBjbGFzcz1cInRpdGxlYmxvY2tcIj48ZGl2IGNsYXNzPVwidGl0bGVcIj48L2Rpdj48ZGl2IGNsYXNzPVwicmVuYW1lXCI+PC9kaXY+PC9kaXY+JyksXHJcbiAgICAgICAgICAgIGxhc3RDaGFuZ2UgPSAkKCc8ZGl2IGNsYXNzPVwiZGF0ZWJsb2NrXCI+JyArIGZtLmkxOG4oJ2xhc3RjaGFuZ2UnKSArICc8c3BhbiBjbGFzcz1cImRhdGVzcGFuXCI+PC9zcGFuPjxicj4gJ1xyXG4gICAgICAgICAgICAgICAgKyBmbS5pMThuKCdzaXplaW5mbycpICsgJzxzcGFuIGNsYXNzPVwic2l6ZXNwYW5cIj48L3NwYW4+PGRpdiBjbGFzcz1cImxpbmtcIj48L2Rpdj48L2Rpdj4nKSxcclxuICAgICAgICAgICAgYnV0dG9ucyA9ICQoJzxkaXYgY2xhc3M9XCJzZWxlY3RmdW5jXCI+PGRpdiBjbGFzcz1cInZpc3VhbC1idG4tYm94XCI+PGEgY2xhc3M9XCJ2aXN1YWwtYnRuIGpzLXZpc2F1bGl6ZVwiPjwvYT48L2Rpdj48ZGl2IGNsYXNzPVwidmlldyBsZWZ0XCI+PC9kaXY+PGRpdiBjbGFzcz1cImZ1bmNidXR0b25zIHJpZ2h0XCI+PC9kaXY+PC9kaXY+JyksXHJcbiAgICAgICAgICAgIGNyeXB0SW5mbyA9ICQoJzxkaXYgY2xhc3M9XCJzaWduYXR1cmVcIi8+JyksXHJcblxyXG4gICAgICAgICAgICBpbmZvYmxvY2sgPSAkKCc8ZGl2IGNsYXNzPVwic2VsZWN0aW5mb1wiLz4nKS5hcHBlbmQobmFtZSkuYXBwZW5kKGxhc3RDaGFuZ2UpLmFwcGVuZChidXR0b25zKSxcclxuICAgICAgICAgICAgc2VsYmxvY2sgPSAkKCc8ZGl2IGNsYXNzPVwic2VsZWN0YmxvY2tcIi8+JykuYXBwZW5kKGljb24pLmFwcGVuZChpbmZvYmxvY2spLmFwcGVuZChjcnlwdEluZm8pLmhpZGUoKSxcclxuICAgICAgICAgICAgc2VsZiA9ICQodGhpcykuYWRkQ2xhc3MoJ3VpLXdpZGdldC1oZWFkZXIgdWktaGVscGVyLWNsZWFyZml4IHVpLWNvcm5lci1ib3R0b20gZWxmaW5kZXItaW5mb2JhcicpXHJcbiAgICAgICAgICAgICAgICAuY3NzKCdoZWlnaHQnLCAnMTczcHgnKVxyXG4gICAgICAgICAgICAgICAgLmNzcygnZm9udC1zaXplJywgJzEycHgnKVxyXG4gICAgICAgICAgICAgICAgLnByZXBlbmQoc2VsYmxvY2spO1xyXG5cclxuICAgICAgICAkLmVhY2goaW5jbHVkZWRDb21tYW5kcywgZnVuY3Rpb24oaSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKChjb20gPSBjb21tYW5kc1t2YWx1ZV0pKSB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24gPSAnZWxmaW5kZXInICsgY29tLm9wdGlvbnMudWk7XHJcbiAgICAgICAgICAgICAgICAkLmZuW2J1dHRvbl0gJiYgYnV0dG9ucy5maW5kKFwiLmZ1bmNidXR0b25zXCIpLmFwcGVuZCgkKCc8ZGl2Lz4nKVtidXR0b25dKGNvbSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICgoY29tID0gY29tbWFuZHNbJ2NyeXB0aW5mbyddKSkge1xyXG4gICAgICAgICAgICBidXR0b24gPSAnZWxmaW5kZXInICsgY29tLm9wdGlvbnMudWk7XHJcbiAgICAgICAgICAgICQuZm5bYnV0dG9uXSAmJiBsYXN0Q2hhbmdlLmZpbmQoXCIubGlua1wiKS5wcmVwZW5kKCQoJzxkaXYvPicpW2J1dHRvbl0oY29tKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoKGNvbSA9IGNvbW1hbmRzWydyZW5hbWUnXSkpIHtcclxuICAgICAgICAgICAgYnV0dG9uID0gJ2VsZmluZGVybGlua2J1dHRvbic7XHJcbiAgICAgICAgICAgICQuZm5bYnV0dG9uXSAmJiBuYW1lLmZpbmQoXCIucmVuYW1lXCIpLnByZXBlbmQoJCgnPGRpdi8+JylbYnV0dG9uXShjb20pKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNlbGYucHJldigpLmxlbmd0aCAmJiBzZWxmLnBhcmVudCgpLmFwcGVuZCh0aGlzKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcztcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuLyoqXG4gKiBAY2xhc3MgZWxGaW5kZXIgcGxhY2VzL2Zhdm9yaXRlcyB1aVxuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKiovXHJcbiQuZm4uZWxmaW5kZXJwbGFjZXMgPSBmdW5jdGlvbihmbSwgb3B0cykge1xyXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgZGlycyA9IFtdLFxyXG4gICAgICAgICAgICBjID0gJ2NsYXNzJyxcclxuICAgICAgICAgICAgbmF2ZGlyID0gZm0ucmVzKGMsICduYXZkaXInKSxcclxuICAgICAgICAgICAgY29sbGFwc2VkID0gZm0ucmVzKGMsICduYXZjb2xsYXBzZScpLFxyXG4gICAgICAgICAgICBleHBhbmRlZCA9IGZtLnJlcyhjLCAnbmF2ZXhwYW5kJyksXHJcbiAgICAgICAgICAgIGhvdmVyID0gZm0ucmVzKGMsICdob3ZlcicpLFxyXG4gICAgICAgICAgICBjbHJvb3QgPSBmbS5yZXMoYywgJ3RyZWVyb290JyksXHJcbiAgICAgICAgICAgIHRwbCA9IGZtLnJlcygndHBsJywgJ25hdmRpcicpLFxyXG4gICAgICAgICAgICBwdHBsID0gZm0ucmVzKCd0cGwnLCAncGVybXMnKSxcclxuICAgICAgICAgICAgc3Bpbm5lciA9ICQoZm0ucmVzKCd0cGwnLCAnbmF2c3Bpbm5lcicpKSxcclxuICAgICAgICAgICAgLyoqXG5cdFx0XHQgKiBDb252ZXJ0IHBsYWNlcyBkaXIgbm9kZSBpbnRvIGRpciBoYXNoXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICBTdHJpbmcgIGRpcmVjdG9yeSBpZFxuXHRcdFx0ICogQHJldHVybiBTdHJpbmdcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgaWQyaGFzaCA9IGZ1bmN0aW9uKGlkKSB7IHJldHVybiBpZC5zdWJzdHIoNik7IH0sXHJcbiAgICAgICAgICAgIC8qKlxuXHRcdFx0ICogQ29udmVydCBwbGFjZXMgZGlyIG5vZGUgaW50byBkaXIgaGFzaFxuXHRcdFx0ICpcblx0XHRcdCAqIEBwYXJhbSAgU3RyaW5nICBkaXJlY3RvcnkgaWRcblx0XHRcdCAqIEByZXR1cm4gU3RyaW5nXG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIGhhc2gyaWQgPSBmdW5jdGlvbihoYXNoKSB7IHJldHVybiAncGxhY2UtJyArIGhhc2g7IH0sXHJcblxyXG4gICAgICAgICAgICAvKipcblx0XHRcdCAqIFNhdmUgY3VycmVudCBwbGFjZXMgc3RhdGVcblx0XHRcdCAqXG5cdFx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgc2F2ZSA9IGZ1bmN0aW9uKCkgeyBmbS5zdG9yYWdlKCdwbGFjZXMnLCBkaXJzLmpvaW4oJywnKSk7IH0sXHJcbiAgICAgICAgICAgIC8qKlxuXHRcdFx0ICogUmV0dXJuIG5vZGUgZm9yIGdpdmVuIGRpciBvYmplY3Rcblx0XHRcdCAqXG5cdFx0XHQgKiBAcGFyYW0gIE9iamVjdCAgZGlyZWN0b3J5IG9iamVjdFxuXHRcdFx0ICogQHJldHVybiBqUXVlcnlcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgY3JlYXRlID0gZnVuY3Rpb24oZGlyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJCh0cGwucmVwbGFjZSgvXFx7aWRcXH0vLCBoYXNoMmlkKGRpci5oYXNoKSlcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFx7bmFtZVxcfS8sIGZtLmVzY2FwZShkaXIubmFtZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xce2Nzc2NsYXNzXFx9LywgZm0ucGVybXMyY2xhc3MoZGlyKSlcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFx7cGVybWlzc2lvbnNcXH0vLCAhZGlyLnJlYWQgfHwgIWRpci53cml0ZSA/IHB0cGwgOiAnJylcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFx7c3ltbGlua1xcfS8sICcnKSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIC8qKlxuXHRcdFx0ICogQWRkIG5ldyBub2RlIGludG8gcGxhY2VzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICBPYmplY3QgIGRpcmVjdG9yeSBvYmplY3Rcblx0XHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBhZGQgPSBmdW5jdGlvbihkaXIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBub2RlID0gY3JlYXRlKGRpcik7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHN1YnRyZWUuY2hpbGRyZW4oKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goc3VidHJlZS5jaGlsZHJlbigpLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSAkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpci5uYW1lLmxvY2FsZUNvbXBhcmUoY3VycmVudC5jaGlsZHJlbignLicgKyBuYXZkaXIpLnRleHQoKSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIW5vZGUuaW5zZXJ0QmVmb3JlKGN1cnJlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZGlycy5wdXNoKGRpci5oYXNoKTtcclxuICAgICAgICAgICAgICAgICFub2RlLnBhcmVudCgpLmxlbmd0aCAmJiBzdWJ0cmVlLmFwcGVuZChub2RlKTtcclxuICAgICAgICAgICAgICAgIHJvb3QuYWRkQ2xhc3MoY29sbGFwc2VkKTtcclxuICAgICAgICAgICAgICAgIG5vZGUuZHJhZ2dhYmxlKHtcclxuICAgICAgICAgICAgICAgICAgICBhcHBlbmRUbzogJ2JvZHknLFxyXG4gICAgICAgICAgICAgICAgICAgIHJldmVydDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVscGVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpciA9ICQodGhpcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXIuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcygndWktc3RhdGUtaG92ZXInKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItcGxhY2UtZHJhZyBlbGZpbmRlci0nICsgZm0uZGlyZWN0aW9uICsgJ1wiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChkaXIuY2xvbmUoKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKCdoYXNoJywgaWQyaGFzaChkaXIuY2hpbGRyZW4oJzpmaXJzdCcpLmF0dHIoJ2lkJykpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdGFydDogZnVuY3Rpb24oKSB7ICQodGhpcykuaGlkZSgpOyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSBwbGFjZXMub2Zmc2V0KCkudG9wLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHBsYWNlcy5vZmZzZXQoKS5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBwbGFjZXMud2lkdGgoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IHBsYWNlcy5oZWlnaHQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggPSBlLmNsaWVudFgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ID0gZS5jbGllbnRZO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHggPiBsZWZ0ICYmIHggPCBsZWZ0ICsgd2lkdGggJiYgeSA+IHRvcCAmJiB5IDwgeSArIGhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmUodWkuaGVscGVyLmRhdGEoJ2hhc2gnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgLyoqXG5cdFx0XHQgKiBSZW1vdmUgZGlyIGZyb20gcGxhY2VzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHBhcmFtICBTdHJpbmcgIGRpcmVjdG9yeSBpZFxuXHRcdFx0ICogQHJldHVybiB2b2lkXG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIHJlbW92ZSA9IGZ1bmN0aW9uKGhhc2gpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuZHggPSAkLmluQXJyYXkoaGFzaCwgZGlycyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG5keCAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXJzLnNwbGljZShuZHgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1YnRyZWUuZmluZCgnIycgKyBoYXNoMmlkKGhhc2gpKS5wYXJlbnQoKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAhc3VidHJlZS5jaGlsZHJlbigpLmxlbmd0aCAmJiByb290LnJlbW92ZUNsYXNzKGNvbGxhcHNlZCArICcgJyArIGV4cGFuZGVkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgLyoqXG5cdFx0XHQgKiBSZW1vdmUgYWxsIGRpciBmcm9tIHBsYWNlc1xuXHRcdFx0ICpcblx0XHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICBjbGVhciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgc3VidHJlZS5lbXB0eSgpO1xyXG4gICAgICAgICAgICAgICAgcm9vdC5yZW1vdmVDbGFzcyhjb2xsYXBzZWQgKyAnICcgKyBleHBhbmRlZCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIC8qKlxuXHRcdFx0ICogTm9kZSAtIHdyYXBwZXIgZm9yIHBsYWNlcyByb290XG5cdFx0XHQgKlxuXHRcdFx0ICogQHR5cGUgalF1ZXJ5XG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIHdyYXBwZXIgPSBjcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgaGFzaDogJ3Jvb3QtJyArIGZtLm5hbWVzcGFjZSxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGZtLmkxOG4ob3B0cy5uYW1lLCAncGxhY2VzJyksXHJcbiAgICAgICAgICAgICAgICByZWFkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgd3JpdGU6IHRydWVcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIC8qKlxuXHRcdFx0ICogUGxhY2VzIHJvb3Qgbm9kZVxuXHRcdFx0ICpcblx0XHRcdCAqIEB0eXBlIGpRdWVyeVxuXHRcdFx0ICoqL1xyXG4gICAgICAgICAgICByb290ID0gd3JhcHBlci5jaGlsZHJlbignLicgKyBuYXZkaXIpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoY2xyb290KVxyXG4gICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyb290LmlzKCcuJyArIGNvbGxhcHNlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2VzLnRvZ2dsZUNsYXNzKGV4cGFuZGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3VidHJlZS5zbGlkZVRvZ2dsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbS5zdG9yYWdlKCdwbGFjZXNTdGF0ZScsIHBsYWNlcy5pcygnLicgKyBleHBhbmRlZCkgPyAxIDogMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIC8qKlxuXHRcdFx0ICogQ29udGFpbmVyIGZvciBkaXJzXG5cdFx0XHQgKlxuXHRcdFx0ICogQHR5cGUgalF1ZXJ5XG5cdFx0XHQgKiovXHJcbiAgICAgICAgICAgIHN1YnRyZWUgPSB3cmFwcGVyLmNoaWxkcmVuKCcuJyArIGZtLnJlcyhjLCAnbmF2c3VidHJlZScpKSxcclxuICAgICAgICAgICAgLyoqXG5cdFx0XHQgKiBNYWluIHBsYWNlcyBjb250YWluZXJcblx0XHRcdCAqXG5cdFx0XHQgKiBAdHlwZSBqUXVlcnlcblx0XHRcdCAqKi9cclxuICAgICAgICAgICAgcGxhY2VzID0gJCh0aGlzKS5hZGRDbGFzcyhmbS5yZXMoYywgJ3RyZWUnKSArICcgZWxmaW5kZXItcGxhY2VzIHVpLWNvcm5lci1hbGwnKVxyXG4gICAgICAgICAgICAgICAgLmhpZGUoKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZCh3cmFwcGVyKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZFRvKGZtLmdldFVJKCduYXZiYXInKSlcclxuICAgICAgICAgICAgICAgIC5kZWxlZ2F0ZSgnLicgKyBuYXZkaXIsICdob3ZlcicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmRlbGVnYXRlKCcuJyArIG5hdmRpciwgJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZtLmV4ZWMoJ29wZW4nLCAkKHRoaXMpLmF0dHIoJ2lkJykuc3Vic3RyKDYpKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoJy4nICsgbmF2ZGlyICsgJzpub3QoLicgKyBjbHJvb3QgKyAnKScsICdjb250ZXh0bWVudScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaGFzaCA9ICQodGhpcykuYXR0cignaWQnKS5zdWJzdHIoNik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm0udHJpZ2dlcignY29udGV4dG1lbnUnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhdzogW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBmbS5pMThuKCdybUZyb21QbGFjZXMnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uOiAncm0nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlKGhhc2gpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAneCc6IGUuY2xpZW50WCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3knOiBlLmNsaWVudFlcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZHJvcHBhYmxlKHtcclxuICAgICAgICAgICAgICAgICAgICB0b2xlcmFuY2U6ICdwb2ludGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBhY2NlcHQ6ICcuZWxmaW5kZXItY3dkLWZpbGUtd3JhcHBlciwuZWxmaW5kZXItdHJlZS1kaXIsLmVsZmluZGVyLWN3ZC1maWxlJyxcclxuICAgICAgICAgICAgICAgICAgICBob3ZlckNsYXNzOiBmbS5yZXMoJ2NsYXNzJywgJ2Fkcm9wcGFibGUnKSxcclxuICAgICAgICAgICAgICAgICAgICBkcm9wOiBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzb2x2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2godWkuaGVscGVyLmRhdGEoJ2ZpbGVzJyksIGZ1bmN0aW9uKGksIGhhc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXIgPSBmbS5maWxlKGhhc2gpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXIgJiYgZGlyLm1pbWUgPT0gJ2RpcmVjdG9yeScgJiYgJC5pbkFycmF5KGRpci5oYXNoLCBkaXJzKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGQoZGlyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlICYmIHVpLmhlbHBlci5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAvLyBvbiBmbSBsb2FkIC0gc2hvdyBwbGFjZXMgYW5kIGxvYWQgZmlsZXMgZnJvbSBiYWNrZW5kXHJcbiAgICAgICAgZm0ub25lKCdsb2FkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChmbS5vbGRBUEkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcGxhY2VzLnNob3coKS5wYXJlbnQoKS5zaG93KCk7XHJcblxyXG4gICAgICAgICAgICBkaXJzID0gJC5tYXAoZm0uc3RvcmFnZSgncGxhY2VzJykuc3BsaXQoJywnKSwgZnVuY3Rpb24oaGFzaCkgeyByZXR1cm4gaGFzaCB8fCBudWxsOyB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmIChkaXJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcm9vdC5wcmVwZW5kKHNwaW5uZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogJ2luZm8nLCB0YXJnZXRzOiBkaXJzIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZlbnREZWZhdWx0OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpcnMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGRhdGEuZmlsZXMsIGZ1bmN0aW9uKGksIGZpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUubWltZSA9PSAnZGlyZWN0b3J5JyAmJiBhZGQoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmbS5zdG9yYWdlKCdwbGFjZXNTdGF0ZScpID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcGlubmVyLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgZm0ucmVtb3ZlKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goZS5kYXRhLnJlbW92ZWQsIGZ1bmN0aW9uKGksIGhhc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlKGhhc2gpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNhdmUoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2hhbmdlKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goZS5kYXRhLmNoYW5nZWQsIGZ1bmN0aW9uKGksIGZpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShmaWxlLmhhc2gsIGRpcnMpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlKGZpbGUuaGFzaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLm1pbWUgPT0gJ2RpcmVjdG9yeScgJiYgYWRkKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2F2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5iaW5kKCdzeW5jJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QucHJlcGVuZChzcGlubmVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAnaW5mbycsIHRhcmdldHM6IGRpcnMgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goZGF0YS5maWxlcyB8fCBbXSwgZnVuY3Rpb24oaSwgZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KGZpbGUuaGFzaCwgZGlycykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmUoZmlsZS5oYXNoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwaW5uZXIucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59OyIsIlwidXNlIHN0cmljdFwiO1xyXG4kLmZuLmVsZmluZGVybGlua2J1dHRvbiA9IGZ1bmN0aW9uKGNtZCwgdGh1bWIsIGJ1dHRvbnRleHQpIHtcclxuICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGMgPSAnY2xhc3MnLFxyXG4gICAgICAgICAgICBmbSA9IGNtZC5mbSxcclxuICAgICAgICAgICAgZGlzYWJsZWQgPSBmbS5yZXMoYywgJ2Rpc2FibGVkJyksXHJcbiAgICAgICAgICAgIGFjdGl2ZSA9IGZtLnJlcyhjLCAnYWN0aXZlJyksXHJcbiAgICAgICAgICAgIGhvdmVyID0gZm0ucmVzKGMsICdob3ZlcicpLFxyXG4gICAgICAgICAgICBidXR0b24gPSAkKHRoaXMpLmFkZENsYXNzKCd1aS1zdGF0ZS1kZWZhdWx0IGVsZmluZGVyLWJ1dHRvbiBlbGZpbmRlci1saW5rLWJ1dHRvbicpXHJcbiAgICAgICAgICAgICAgICAuYXR0cigndGl0bGUnLCBidXR0b250ZXh0ID8gYnV0dG9udGV4dC5yZXBsYWNlKC88XFwvP1tePl0rPi9naSwgJycpIDogY21kLnRpdGxlKVxyXG4gICAgICAgICAgICAgICAgLmhvdmVyKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAhYnV0dG9uLmlzKCcuJyArIGRpc2FibGVkKSAmJiBidXR0b25bZS50eXBlID09ICdtb3VzZWxlYXZlJyA/ICdyZW1vdmVDbGFzcycgOiAnYWRkQ2xhc3MnXShob3Zlcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdCA9ICQodGhpcykuYXR0cigncmVsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFidXR0b24uaXMoJy4nICsgZGlzYWJsZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSBjbWQuZXhlYyh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBjbWQuZXhlYygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBsaW5rdGV4dCA9ICc8YSBjbGFzcz1cImVsZmluZGVyLWJ1dHRvbi10ZXh0XCI+e3RleHR9PC9hPic7XHJcbiAgICAgICAgbGlua3RleHQgPSBsaW5rdGV4dC5yZXBsYWNlKCd7dGV4dH0nLCBidXR0b250ZXh0ID8gYnV0dG9udGV4dCA6IGNtZC50aXRsZSk7XHJcbiAgICAgICAgJCh0aGlzKS5hcHBlbmQobGlua3RleHQpO1xyXG4gICAgICAgIGlmICh0aHVtYilidXR0b24uYXR0cigncmVsJywgdGh1bWIpO1xyXG5cclxuICAgICAgICBjbWQuY2hhbmdlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNtZC5kaXNhYmxlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnJlbW92ZUNsYXNzKGFjdGl2ZSArICcgJyArIGhvdmVyKS5hZGRDbGFzcyhkaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVDbGFzcyhkaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uW2NtZC5hY3RpdmUoKSA/ICdhZGRDbGFzcycgOiAncmVtb3ZlQ2xhc3MnXShhY3RpdmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2hhbmdlKCk7XHJcbiAgICB9KTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuJC5mbi5lbGZpbmRlcmZpbHRlcmJ1dHRvbiA9IGZ1bmN0aW9uKGNtZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAvL2lmIChjbWQuZmlsdGVyRm9sZGVyICE9ICcnKSB7XHJcbiAgICAgICAgLy8gICAgY21kLmZpbHRlclN0YXRlID0gY21kLmZpbHRlckZvbGRlciA9PSBjbWQuZm0uY3dkKCkuaGFzaCA/IGNtZC5maWx0ZXJTdGF0ZSA6ICdBbGwnO1xyXG4gICAgICAgIC8vfSBlbHNlIHtcclxuICAgICAgICAvLyAgICBjbWQuZmlsdGVyU3RhdGUgPSAnQWxsJztcclxuICAgICAgICAvL31cclxuXHJcbiAgICAgICAgdmFyIGZtID0gY21kLmZtLFxyXG4gICAgICAgICAgICByZXN1bHQgPSBmYWxzZSxcclxuICAgICAgICAgICAgYyA9ICdjbGFzcycsXHJcbiAgICAgICAgICAgIG5hbWUgPSBjbWQubmFtZSxcclxuICAgICAgICAgICAgZGlzYWJsZWQgPSBmbS5yZXMoYywgJ2Rpc2FibGVkJyksXHJcbiAgICAgICAgICAgIGhvdmVyID0gZm0ucmVzKGMsICdob3ZlcicpLFxyXG4gICAgICAgICAgICBpdGVtID0gJ2VsZmluZGVyLWJ1dHRvbi1tZW51LWl0ZW0nLFxyXG4gICAgICAgICAgICBmaWx0ZXIgPSBmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjbWQuZXhlYyh2YWwpLmRvbmUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNtZC5mbS50cmlnZ2VyKCdmaWx0ZXJlbmQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZmlsdGVycyA9IFsnQWxsJywgJ0NyeXB0JywgJ1NpZ24nLCAnTm90Q3J5cHRTaWduJ10sXHJcbiAgICAgICAgICAgIGFib3J0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY21kLmZtLnRyaWdnZXIoJ2ZpbHRlcmVuZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBidXR0b24gPSAkKHRoaXMpLmFkZENsYXNzKCd1aS1zdGF0ZS1kZWZhdWx0IGVsZmluZGVyLWJ1dHRvbiBlbGZpbmRlci1tZW51YnV0dG9uIGVsZmluZXItYnV0dG9uLScgKyBuYW1lICsgJyB1aS1lbGZpbmRlci1idXR0b24tbGFzdCcpXHJcbiAgICAgICAgICAgICAgICAuYXR0cigndGl0bGUnLCBjbWQudGl0bGUpLFxyXG4gICAgICAgICAgICB0ZXh0ID0gJCgnPGRpdiBjbGFzcz1cImJ0bi1ncm91cCBvcGVuIGVsZmluZGVyLWxpbmstYnV0dG9uXCI+PGEgY2xhc3M9XCJmaWx0ZXJcIj4nICsgZm0uaTE4bignZmlsdGVyJyArIGNtZC5maWx0ZXJTdGF0ZSkgKyAnPC9hPjwvZGl2PicpXHJcbiAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghYnV0dG9uLmlzKCcuJyArIGRpc2FibGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZW51LmlzKCc6aGlkZGVuJykgJiYgY21kLmZtLmdldFVJKCkuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVudS5zbGlkZVRvZ2dsZSgxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oYnV0dG9uKVxyXG4gICAgICAgICAgICAgICAgLmhvdmVyKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAhYnV0dG9uLmlzKCcuJyArIGRpc2FibGVkKSAmJiBidXR0b24udG9nZ2xlQ2xhc3MoaG92ZXIpO1xyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIG10ZXh0ID0gJCgnPGxhYmVsIGNsYXNzPVwibGVmdFwiPicgKyBjbWQudGl0bGUgKyAnPC9sYWJlbD4nKS5hcHBlbmRUbyhidXR0b24pLFxyXG5cclxuICAgICAgICAgICAgbWVudSA9ICQoJzxkaXYgY2xhc3M9XCJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgZWxmaW5kZXItYnV0dG9uLW1lbnUgdWktY29ybmVyLWFsbFwiLz4nKVxyXG4gICAgICAgICAgICAgICAgLmhpZGUoKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZFRvKGJ1dHRvbilcclxuICAgICAgICAgICAgICAgIC56SW5kZXgoMTIgKyBidXR0b24uekluZGV4KCkpXHJcbiAgICAgICAgICAgICAgICAuZGVsZWdhdGUoJy4nICsgaXRlbSwgJ2hvdmVyJywgZnVuY3Rpb24oKSB7ICQodGhpcykudG9nZ2xlQ2xhc3MoaG92ZXIpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmRlbGVnYXRlKCcuJyArIGl0ZW0sICdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgaGlkZSA9IGZ1bmN0aW9uKCkgeyBtZW51LmhpZGUoKTsgfSxcclxuICAgICAgICAgICAgY2xlYXJNZW51ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBtZW51LnRleHQoXCJcIik7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGluaXRNZW51ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkLmVhY2goZmlsdGVycywgZnVuY3Rpb24oaSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZW51LmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiJyArIGl0ZW0gKyAnXCIgcmVsPVwiJyArIHZhbHVlICsgJ1wiPidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgZm0uaTE4bignZmlsdGVyJyArIHZhbHVlKSArICc8L2Rpdj4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSAkKHRoaXMpLmF0dHIoJ3JlbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY21kLmZpbHRlclN0YXRlID0gdDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWQuZmlsdGVyRm9sZGVyID0gZm0uY3dkKCkuaGFzaDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJC5maW5kKCcuYnRuLWdyb3VwIGEuZmlsdGVyJykpLnRleHQoZm0uaTE4bignZmlsdGVyJyArIHQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcih0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgIGluaXRNZW51KCk7XHJcbiAgICAgICAgZm0uYmluZCgnZGlzYWJsZSBzZWxlY3QnLCBoaWRlKS5nZXRVSSgpLmNsaWNrKGhpZGUpO1xyXG5cclxuICAgICAgICBpZiAobWVudS5jaGlsZHJlbigpLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgY21kLmNoYW5nZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGJ1dHRvbi50b2dnbGVDbGFzcyhkaXNhYmxlZCwgY21kLmRpc2FibGVkKCkpO1xyXG4gICAgICAgICAgICB9KS5jaGFuZ2UoKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYnV0dG9uLmFkZENsYXNzKGRpc2FibGVkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNtZC5mbVxyXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAvL2lucHV0LnVuYmluZCgna2V5ZG93bicpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc2VsZWN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgLy9pbnB1dC5ibHVyKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5iaW5kKCdmaWx0ZXJlbmQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNtZC5maWx0ZXJTdGF0ZSA9ICdOb3RDcnlwdFNpZ24nO1xyXG4gICAgICAgICAgICAgICAgJCgnLmJ0bi1ncm91cC5vcGVuLmVsZmluZGVyLWxpbmstYnV0dG9uIGEuZmlsdGVyJykudGV4dChmbS5pMThuKCdmaWx0ZXInICsgJ05vdENyeXB0U2lnbicpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgLy8udmlld2NoYW5nZShhYm9ydCk7XHJcbiAgICB9KTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuJC5mbi5lbGZpbmRlcmNyeXB0eGRpYWxvZyA9IGZ1bmN0aW9uKG9wdHMpIHtcclxuICAgIHZhciBkaWFsb2csIG1vZGFsO1xyXG5cclxuICAgIGlmICh0eXBlb2YgKG9wdHMpID09ICdzdHJpbmcnICYmIChkaWFsb2cgPSB0aGlzLmNsb3Nlc3QoJy53aW5kb3cuYWxlcnQnKSkubGVuZ3RoICYmIChtb2RhbCA9IGRpYWxvZy5wYXJlbnQoJyNtb2RhbCcpKS5sZW5ndGgpIHtcclxuICAgICAgICBpZiAob3B0cyA9PSAnb3BlbicpIHtcclxuICAgICAgICAgICAgbW9kYWwuY3NzKCdkaXNwbGF5JykgPT0gJ25vbmUnICYmIG1vZGFsLmZhZGVJbigxMjAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZGlhbG9nLnRyaWdnZXIoJ29wZW4nKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChvcHRzID09ICdjbG9zZScpIHtcclxuICAgICAgICAgICAgbW9kYWwuY3NzKCdkaXNwbGF5JykgIT0gJ25vbmUnICYmIG1vZGFsLmhpZGUoKSAmJiBkaWFsb2cudHJpZ2dlcignY2xvc2UnKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG9wdHMgPT0gJ2Rlc3Ryb3knKSB7XHJcbiAgICAgICAgICAgIG1vZGFsLmhpZGUoKS5yZW1vdmUoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG9wdHMgPT0gJ3RvVG9wJykge1xyXG4gICAgICAgICAgICAvL21vZGFsLnRyaWdnZXIoJ3RvdG9wJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9wdHMgPSAkLmV4dGVuZCh7fSwgJC5mbi5lbGZpbmRlcmNyeXB0eGRpYWxvZy5kZWZhdWx0cywgb3B0cyk7XHJcblxyXG4gICAgdGhpcy5maWx0ZXIoJzpub3QoLmNvbnRlbnQsIC5jb250ZW50LWdyb3VwKScpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCksXHJcbiAgICAgICAgICAgIHNlbGYgPSAkKCc8ZGl2Lz4nKS5hZGRDbGFzcygnY29udGVudCcpLFxyXG4gICAgICAgICAgICBtZXNzYWdlcGFuID0gJCgnPGRpdiBpZD1cIm1lc3NhZ2UtcGFuZWxcIi8+JykuYXBwZW5kVG8oc2VsZiksXHJcbiAgICAgICAgICAgIGNvbnRnciA9ICQodGhpcykuYWRkQ2xhc3MoXCJjb250ZW50LWdyb3VwIG1lc3MtYm94XCIpLmFwcGVuZFRvKG1lc3NhZ2VwYW4pLFxyXG4gICAgICAgICAgICBtb2RhbCA9ICQoJzxkaXYvPicpLmF0dHIoJ2lkJywgJ21vZGFsJykuaGlkZSgpLmFwcGVuZFRvKHBhcmVudCksXHJcbiAgICAgICAgICAgIGNsYWN0aXZlID0gJ2VsZmluZGVyLWRpYWxvZy1hY3RpdmUnLFxyXG4gICAgICAgICAgICBjbGRpYWxvZyA9ICdlbGZpbmRlci1kaWFsb2cnLFxyXG4gICAgICAgICAgICBjbG5vdGlmeSA9ICdlbGZpbmRlci1kaWFsb2ctbm90aWZ5JyxcclxuICAgICAgICAgICAgY2xob3ZlciA9ICd1aS1zdGF0ZS1ob3ZlcicsXHJcbiAgICAgICAgICAgIGlkID0gcGFyc2VJbnQoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApLFxyXG4gICAgICAgICAgICBidXR0b25zZXQgPSAkKCc8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwXCIvPicpLFxyXG5cclxuICAgICAgICAgICAgZGlhbG9nID0gJCgnPGRpdiBjbGFzcz1cIndpbmRvdyBhbGVydCAnICsgY2xkaWFsb2cgKyAnICcgKyBvcHRzLmNzc0NsYXNzICsgJ1wiLz4nKSAvL3VpLWRpYWxvZyB1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgdWktY29ybmVyLWFsbCB1aS1kcmFnZ2FibGUgc3RkNDItZGlhbG9nIFxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZChzZWxmKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZFRvKG1vZGFsKVxyXG4gICAgICAgICAgICAgICAgLmJpbmQoJ29wZW4nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlb2YgKG9wdHMub3BlbikgPT0gJ2Z1bmN0aW9uJyAmJiAkLnByb3h5KG9wdHMub3Blbiwgc2VsZlswXSkoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuYmluZCgnY2xvc2UnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQubW91c2Vkb3duKCkuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAxMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKG9wdHMuY2xvc2UpID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5wcm94eShvcHRzLmNsb3NlLCBzZWxmWzBdKSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0cy5kZXN0cm95T25DbG9zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5oaWRlKCkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5kYXRhKHsgbW9kYWw6IG9wdHMubW9kYWwgfSk7XHJcblxyXG5cclxuICAgICAgICBpZiAob3B0cy5jbG9zZU9uRXNjYXBlKSB7XHJcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLmJpbmQoJ2tleXVwLicgKyBpZCwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAkLnVpLmtleUNvZGUuRVNDQVBFICYmIGRpYWxvZy5pcygnLicgKyBjbGFjdGl2ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmVsZmluZGVyY3J5cHR4ZGlhbG9nKCdjbG9zZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLnVuYmluZCgna2V5dXAuJyArIGlkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRpYWxvZy5wcmVwZW5kKFxyXG4gICAgICAgICAgICAkKCc8ZGl2IGNsYXNzPVwiaGVhZGVyXCI+PGgyPicgKyBvcHRzLnRpdGxlICsgJzwvaDI+PC9kaXY+JylcclxuICAgICAgICAgICAgLnByZXBlbmQoJCgnPGRpdiBjbGFzcz1cImNsb3NlXCI+PC9kaXY+JylcclxuICAgICAgICAgICAgICAgIC5tb3VzZWRvd24oZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmVsZmluZGVyY3J5cHR4ZGlhbG9nKCdjbG9zZScpO1xyXG4gICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgJC5lYWNoKG9wdHMuYnV0dG9ucywgZnVuY3Rpb24obmFtZSwgY2IpIHtcclxuICAgICAgICAgICAgdmFyIGJ1dHRvbjtcclxuICAgICAgICAgICAgaWYgKG5hbWUuaW5kZXhPZihcItCe0YLQvNC10L3QsFwiKSA9PSAtMSkgYnV0dG9uID0gJCgnPGRpdiBjbGFzcz1cImJ0biBidG4tZ3JlZW5cIj4nICsgbmFtZSArICc8L2Rpdj4nKTtcclxuICAgICAgICAgICAgZWxzZSBidXR0b24gPSAkKCc8ZGl2IGNsYXNzPVwiYnRuXCI+JyArIG5hbWUgKyAnPC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIC8vdmFyIGJ1dHRvbiA9ICQoJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwidWktYnV0dG9uIHVpLXdpZGdldCB1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwgdWktYnV0dG9uLXRleHQtb25seVwiPjxzcGFuIGNsYXNzPVwidWktYnV0dG9uLXRleHRcIj4nICsgbmFtZSArICc8L3NwYW4+PC9idXR0b24+JylcclxuICAgICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAuY2xpY2soJC5wcm94eShjYiwgc2VsZlswXSkpXHJcbiAgICAgICAgICAgICAgICAuaG92ZXIoZnVuY3Rpb24oZSkgeyAkKHRoaXMpW2UudHlwZSA9PSAnbW91c2VlbnRlcicgPyAnZm9jdXMnIDogJ2JsdXInXSgpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmZvY3VzKGZ1bmN0aW9uKCkgeyAkKHRoaXMpLmFkZENsYXNzKGNsaG92ZXIpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmJsdXIoZnVuY3Rpb24oKSB7ICQodGhpcykucmVtb3ZlQ2xhc3MoY2xob3Zlcik7IH0pXHJcbiAgICAgICAgICAgICAgICAua2V5ZG93bihmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT0gJC51aS5rZXlDb2RlLkVOVEVSKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAkLnVpLmtleUNvZGUuVEFCKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQgPSAkKHRoaXMpLm5leHQoJy51aS1idXR0b24nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dC5sZW5ndGggPyBuZXh0LmZvY3VzKCkgOiAkKHRoaXMpLnBhcmVudCgpLmNoaWxkcmVuKCcudWktYnV0dG9uOmZpcnN0JykuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYnV0dG9uc2V0LnByZXBlbmQoYnV0dG9uKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgYnV0dG9uc2V0LmNoaWxkcmVuKCkubGVuZ3RoICYmIG1lc3NhZ2VwYW4uYXBwZW5kKGJ1dHRvbnNldCk7XHJcblxyXG4gICAgICAgIHR5cGVvZiAob3B0cy5jcmVhdGUpID09ICdmdW5jdGlvbicgJiYgJC5wcm94eShvcHRzLmNyZWF0ZSwgdGhpcykoKTtcclxuXHJcbiAgICAgICAgb3B0cy5hdXRvT3BlbiAmJiBzZWxmLmVsZmluZGVyY3J5cHR4ZGlhbG9nKCdvcGVuJyk7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07XHJcbiQuZm4uZWxmaW5kZXJjcnlwdHhkaWFsb2cuZGVmYXVsdHMgPSB7XHJcbiAgICBjc3NDbGFzczogJycsXHJcbiAgICB0aXRsZTogJycsXHJcbiAgICBtb2RhbDogZmFsc2UsXHJcbiAgICByZXNpemFibGU6IHRydWUsXHJcbiAgICBhdXRvT3BlbjogdHJ1ZSxcclxuICAgIGNsb3NlT25Fc2NhcGU6IHRydWUsXHJcbiAgICBkZXN0cm95T25DbG9zZTogZmFsc2UsXHJcbiAgICBidXR0b25zOiB7fSxcclxuICAgIHBvc2l0aW9uOiBudWxsLFxyXG4gICAgd2lkdGg6IDMyMCxcclxuICAgIGhlaWdodDogJ2F1dG8nLFxyXG4gICAgbWluV2lkdGg6IDIwMCxcclxuICAgIG1pbkhlaWdodDogMTEwXHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbiQuZm4uZWxmaW5kZXJib3R0b21hZGRwYW5lbCA9IGZ1bmN0aW9uKGZtLCBvcHRzKSB7XHJcbiAgICB0aGlzLm5vdCgnLmVsZmluZGVyLWJvdHRvbWFkZHBhbmVsJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgYyA9ICdjbGFzcycsXHJcbiAgICAgICAgICAgIGdyZWVuID0gJ3VpLWVsZmluZGVyLWJ1dHRvbi1ncmVlbicsXHJcbiAgICAgICAgICAgIG1haW5jbGFzcyA9ICd1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYWxsIGVsZmluZGVyLWJ1dHRvbnNldCcsXHJcbiAgICAgICAgICAgIGRpc2FibGVkID0gZm0ucmVzKGMsICdkaXNhYmxlZCcpLFxyXG4gICAgICAgICAgICBob3ZlciA9IGZtLnJlcyhjLCAnaG92ZXInKSxcclxuICAgICAgICAgICAgY29tbWFuZHMgPSBmbS5fY29tbWFuZHMsXHJcbiAgICAgICAgICAgIGNtZCA9IGNvbW1hbmRzWydhZGQnXSxcclxuICAgICAgICAgICAgYnV0dG9ucyA9ICQoJzxkaXYgY2xhc3M9XCJidXR0b25zXCIvPicpLFxyXG4gICAgICAgICAgICBjYW5jZWxCID0gJCgnPGRpdiBjbGFzcz1cImVsZmluZGVyLWJ1dHRvbnNldFwiPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidWktc3RhdGUtZGVmYXVsdCBlbGZpbmRlci1idXR0b24gZWxmaW5kZXItbGluay1idXR0b25cIiB0aXRsZT1cIicgKyBmbS5pMThuKCdjbWRjYW5jZWwnKSArICdcIj4nICtcclxuICAgICAgICAgICAgICAgICAgICAnPGEgY2xhc3M9XCJlbGZpbmRlci1idXR0b24tdGV4dFwiPicgKyBmbS5pMThuKCdjbWRjYW5jZWwyJykgKyAnPC9hPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nKVxyXG4gICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuTWFzdGVyICYmIHBhcmVudC5NYXN0ZXIuT3BlbkZpbGVzRXZlbnRIYW5kbGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5NYXN0ZXIuT3BlbkZpbGVzRXZlbnRIYW5kbGVyKCdjbG9zZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBhZGRCdXQgPSAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uc2V0IGJ0biBidG4tYmlnIGJ0bi1ncmVlblwiPicgKyBmbS5pMThuKCdjbWRhZGQnKSArICc8L2Rpdj4nKVxyXG4gICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghYWRkQnV0LmlzKCcuJyArIGRpc2FibGVkKSAmJiBjbWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY21kLmV4ZWMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc2VsZiA9ICQodGhpcykuYWRkQ2xhc3MoJ3VpLXdpZGdldC1oZWFkZXIgdWktaGVscGVyLWNsZWFyZml4IHVpLWNvcm5lci1ib3R0b20gZWxmaW5kZXItYm90dG9tYWRkcGFuZWwnKVxyXG4gICAgICAgICAgICAgICAgLmNzcygnaGVpZ2h0JywgJzM4cHgnKVxyXG4gICAgICAgICAgICAgICAgLmNzcygnZm9udC1zaXplJywgJzEycHgnKVxyXG4gICAgICAgICAgICAgICAgLnByZXBlbmQoYnV0dG9ucyk7XHJcblxyXG5cclxuICAgICAgICBjbWQuY2hhbmdlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNtZC5kaXNhYmxlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRkQnV0LnJlbW92ZUNsYXNzKGhvdmVyKS5hZGRDbGFzcyhkaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkZEJ1dC5yZW1vdmVDbGFzcyhkaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jaGFuZ2UoKTtcclxuXHJcbiAgICAgICAgYnV0dG9ucy5wcmVwZW5kKGNhbmNlbEIpO1xyXG4gICAgICAgIGJ1dHRvbnMuYXBwZW5kKGFkZEJ1dCk7XHJcbiAgICAgICAgLy8kLmVhY2goaW5jbHVkZWRDb21tYW5kcywgZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgLy8gICAgdmFyIGNtZCwgYnV0dG9uLCBkaXY9JChcIjxkaXYvPlwiKTtcclxuICAgICAgICAvLyAgICBpZiAoKGNtZCA9IGNvbW1hbmRzW3ZhbHVlXSkpIHtcclxuICAgICAgICAvLyAgICAgICAgZGl2LmFkZENsYXNzKG1haW5jbGFzcyk7XHJcbiAgICAgICAgLy8gICAgICAgIGlmICh2YWx1ZSA9PSAnYWRkJykgZGl2LmFkZENsYXNzKGdyZWVuKTtcclxuICAgICAgICAvLyAgICAgICAgYnV0dG9uID0gJ2VsZmluZGVyJyArIGNtZC5vcHRpb25zLnVpO1xyXG4gICAgICAgIC8vICAgICAgICAkLmZuW2J1dHRvbl0gJiYgZGl2LnByZXBlbmQoJCgnPGRpdi8+JylbYnV0dG9uXShjbWQpKSAmJiBidXR0b25zLmFwcGVuZChkaXYpO1xyXG4gICAgICAgIC8vICAgIH1cclxuICAgICAgICAvL30pO1xyXG5cclxuICAgICAgICBzZWxmLnByZXYoKS5sZW5ndGggJiYgc2VsZi5wYXJlbnQoKS5hcHBlbmQodGhpcykgJiYgc2VsZi5zaG93KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcztcclxufTsiLCJcclxuJC5mbi5lbGZpbmRlcm11bHRpcGx5YWRkYnV0dG9uID0gZnVuY3Rpb24gKGNtZCkge1xyXG5cdFxyXG5cdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0ICAgIHZhciBmbSA9IGNtZC5mbSxcclxuXHQgICAgICAgIGNvbW1hbmRzID0gZm0uX2NvbW1hbmRzLFxyXG5cdCAgICAgICAgbmFtZSA9IGNtZC5uYW1lLFxyXG5cdCAgICAgICAgYyA9ICdjbGFzcycsXHJcblx0ICAgICAgICBkaXNhYmxlZCA9IGZtLnJlcyhjLCAnZGlzYWJsZWQnKSxcclxuXHQgICAgICAgIGhvdmVyID0gZm0ucmVzKGMsICdob3ZlcicpLFxyXG5cdCAgICAgICAgaXRlbSA9ICdlbGZpbmRlci1idXR0b24tbWVudS1pdGVtJyxcclxuXHQgICAgICAgIGluY2x1ZGVkQ29tbWFuZHMgPSBbJ3VwbG9hZCcsICdta2RpcicsICdwYXN0ZSddLFxyXG5cclxuICAgICAgICAgICAgYnV0dG9uID0gJCh0aGlzKS5hZGRDbGFzcygnZWxmaW5kZXItYnV0dG9uc2V0IGJ0biBidG4tYmlnIGJ0bi1ncmVlbicpXHJcblx0ICAgICAgICAgICAgLmF0dHIoJ3RpdGxlJywgY21kLnRpdGxlKVxyXG5cdCAgICAgICAgICAgIC5ob3ZlcihmdW5jdGlvbihlKSB7XHJcblx0ICAgICAgICAgICAgICAgICFidXR0b24uaXMoJy4nICsgZGlzYWJsZWQpICYmIGJ1dHRvbi50b2dnbGVDbGFzcyhob3Zlcik7XHJcblx0ICAgICAgICAgICAgfSlcclxuXHQgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkge1xyXG5cdCAgICAgICAgICAgICAgICBpZiAoIWJ1dHRvbi5pcygnLicgKyBkaXNhYmxlZCkpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0ICAgICAgICAgICAgICAgICAgICAkLmVhY2gobWVudS5jaGlsZHJlbigpLCBmdW5jdGlvbigpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdCA9ICQodGhpcykuYXR0cigncmVsJyk7XHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhkaXNhYmxlZCk7XHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhob3Zlcik7XHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbTtcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShjb20gPSBjb21tYW5kc1t0XSkgfHwgY29tLmdldHN0YXRlKCkgIT0gMCkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKGRpc2FibGVkKTtcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHQgICAgICAgICAgICAgICAgICAgIG1lbnUuaXMoJzpoaWRkZW4nKSAmJiBjbWQuZm0uZ2V0VUkoKS5jbGljaygpO1xyXG5cdCAgICAgICAgICAgICAgICAgICAgbWVudS5zbGlkZVRvZ2dsZSgxMDApO1xyXG5cdCAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHRleHQgPSAkKHRoaXMpLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJlbGZpbmRlci1idXR0b24tdGV4dFwiPicgKyBjbWQudGl0bGUgKyAnPC9zcGFuPicpLFxyXG4gICAgICAgICAgICAvL2ljb24gPSAkKHRoaXMpLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJjYXJldFwiPjwvc3Bhbj4nKSxcclxuXHQgICAgICAgIG1lbnUgPSAkKCc8ZGl2IGNsYXNzPVwidWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IGVsZmluZGVyLWJ1dHRvbi1tZW51IHVpLWNvcm5lci1hbGxcIi8+JylcclxuXHQgICAgICAgICAgICAuaGlkZSgpXHJcblx0ICAgICAgICAgICAgLmFwcGVuZFRvKGJ1dHRvbilcclxuXHQgICAgICAgICAgICAuekluZGV4KDEyICsgYnV0dG9uLnpJbmRleCgpKVxyXG5cdCAgICAgICAgICAgIC5kZWxlZ2F0ZSgnLicgKyBpdGVtLCAnaG92ZXInLCBmdW5jdGlvbigpIHtcclxuXHQgICAgICAgICAgICAgICAgISQodGhpcykuaXMoJy4nICsgZGlzYWJsZWQpICYmICQodGhpcykudG9nZ2xlQ2xhc3MoaG92ZXIpO1xyXG5cdCAgICAgICAgICAgIH0pXHJcblx0ICAgICAgICAgICAgLmRlbGVnYXRlKCcuJyArIGl0ZW0sICdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuXHQgICAgICAgICAgICAgICAgdmFyIHQgPSAkKHRoaXMpLmF0dHIoJ3JlbCcpO1xyXG5cdCAgICAgICAgICAgICAgICBpZiAodCE9J3VwbG9hZCcpIHtcclxuXHQgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHQgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5qcy11cGxvYWQnKS5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cdCAgICAgICAgICAgIH0pLFxyXG5cdCAgICAgICAgXHJcblx0ICAgICAgICBoaWRlID0gZnVuY3Rpb24oKSB7IG1lbnUuaGlkZSgpOyB9LFxyXG5cclxuICAgICAgICAgICAgY2xlYXJNZW51ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbWVudS50ZXh0KFwiXCIpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgaW5pdE1lbnUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkLmVhY2goaW5jbHVkZWRDb21tYW5kcywgZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09ICd1cGxvYWQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb207XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoY29tID0gY29tbWFuZHNbdmFsdWVdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvcm0gPSAkKCc8Zm9ybSBzdHlsZT1cIm92ZXJmbG93OiBoaWRkZW5cIi8+JyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQgPSAkKCc8aW5wdXQgdHlwZT1cImZpbGVcIiBtdWx0aXBsZT1cInRydWVcIiBzdHlsZT1cIlwiIGNsYXNzPVwianMtdXBsb2FkXCIgLz4nKVxyXG5cdFx0XHRcdCAgICAgICAgICAgICAgICAgICAgLmNoYW5nZShmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pbnB1dCA9ICQodGhpcyk7XHJcblx0XHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9pbnB1dC52YWwoKSkge1xyXG5cdFx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb20uZXhlYyh7IGlucHV0OiBfaW5wdXQucmVtb3ZlKClbMF0gfSk7XHJcblx0XHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmNsb25lKHRydWUpLmFwcGVuZFRvKGZvcm0pO1xyXG5cdFx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHRcdFx0XHQgICAgICAgICAgICAgICAgICAgIH0pLmNsaWNrKGZ1bmN0aW9uKCl7bWVudS5oaWRlKCk7fSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0ID0gJCgnPGRpdiBjbGFzcz1cIicgKyBpdGVtICsgJ1wiIHJlbD1cIicgKyB2YWx1ZSArICdcIj48c3BhbiBjbGFzcz1cImVsZmluZGVyLWJ1dHRvbi1pY29uIGVsZmluZGVyLWJ1dHRvbi1pY29uLSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIHZhbHVlICsgJ1wiLz48c3BhbiBjbGFzcz1cInVpLWljb24gdWktaWNvbi1hcnJvd3RoaWNrLTEtc1wiLz4nICsgZm0uaTE4bignYWRkJyArIHZhbHVlKSArICc8L2Rpdj4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uYXBwZW5kKGlucHV0LmNsb25lKHRydWUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUuYXBwZW5kKGJ1dCkucGFyZW50KCkuYXBwZW5kKGZvcm0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tLmNoYW5nZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVtjb20uZGlzYWJsZWQoKSA/ICdoaWRlJyA6ICdzaG93J10oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcblx0XHQgICAgICAgICAgICAgICAgICAgIC5jaGFuZ2UoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZW51LmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiJyArIGl0ZW0gKyAnXCIgcmVsPVwiJyArIHZhbHVlICsgJ1wiPjxzcGFuIGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uLWljb24gZWxmaW5kZXItYnV0dG9uLWljb24tJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKyB2YWx1ZSArICdcIi8+PHNwYW4gY2xhc3M9XCJ1aS1pY29uIHVpLWljb24tYXJyb3d0aGljay0xLXNcIi8+JyArIGZtLmkxOG4oJ2FkZCcgKyB2YWx1ZSkgKyAnPC9kaXY+JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGljayhmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSAkKHRoaXMpLmF0dHIoJ3JlbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICEkKHRoaXMpLmlzKCcuJyArIGRpc2FibGVkKSAmJiBjbWQuZXhlYyh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGFkZENvbW1hbmQgPSBmdW5jdGlvbiAoY29tTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaW5jbHVkZWRDb21tYW5kcy5wdXNoKGNvbU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgY2xlYXJNZW51KCk7XHJcbiAgICAgICAgICAgICAgICBpbml0TWVudSgpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuXHQgICAgaW5pdE1lbnUoKTtcclxuXHQgICAgZm0uYmluZCgnZGlzYWJsZSBzZWxlY3QnLCBoaWRlKS5nZXRVSSgpLmNsaWNrKGhpZGUpO1xyXG5cclxuXHQgICAgaWYgKG1lbnUuY2hpbGRyZW4oKS5sZW5ndGggPiAxKSB7XHJcblx0ICAgICAgICBjbWQuY2hhbmdlKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgICAgICBidXR0b24udG9nZ2xlQ2xhc3MoZGlzYWJsZWQsIGNtZC5kaXNhYmxlZCgpKTtcclxuXHQgICAgICAgIH0pLmNoYW5nZSgpO1xyXG5cclxuXHQgICAgfSBlbHNlIHtcclxuXHQgICAgICAgIGJ1dHRvbi5hZGRDbGFzcyhkaXNhYmxlZCk7XHJcblx0ICAgIH1cclxuXHR9KTtcclxuXHRcclxufVxyXG5cclxuXHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG4vKipcbiAqIEBjbGFzcyAgZWxGaW5kZXIgY29tbWFuZCBcImJhY2tcIlxuICogT3BlbiBsYXN0IHZpc2l0ZWQgZm9sZGVyXG4gKlxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLmJhY2sgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuYWx3YXlzRW5hYmxlZCA9IHRydWU7XHJcbiAgICB0aGlzLnVwZGF0ZU9uU2VsZWN0ID0gZmFsc2U7XHJcbiAgICB0aGlzLnNob3J0Y3V0cyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHBhdHRlcm46ICdjdHJsK2xlZnQgYmFja3NwYWNlJ1xyXG4gICAgICAgIH1cclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZtLmhpc3RvcnkuY2FuQmFjaygpID8gMCA6IC0xO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZtLmhpc3RvcnkuYmFjaygpO1xyXG4gICAgfTtcclxufTsiLCIvKipcbiAqIEBjbGFzcyAgZWxGaW5kZXIgY29tbWFuZCBcImZvcndhcmRcIlxuICogT3BlbiBuZXh0IHZpc2l0ZWQgZm9sZGVyXG4gKlxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLmZvcndhcmQgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuYWx3YXlzRW5hYmxlZCA9IHRydWU7XHJcbiAgICB0aGlzLnVwZGF0ZU9uU2VsZWN0ID0gdHJ1ZTtcclxuICAgIHRoaXMuc2hvcnRjdXRzID0gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcGF0dGVybjogJ2N0cmwrcmlnaHQnXHJcbiAgICAgICAgfVxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm0uaGlzdG9yeS5jYW5Gb3J3YXJkKCkgPyAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm0uaGlzdG9yeS5mb3J3YXJkKCk7XHJcbiAgICB9O1xyXG59IiwiLyoqXG4gKiBAY2xhc3MgIGVsRmluZGVyIGNvbW1hbmQgXCJyZWxvYWRcIlxuICogU3luYyBmaWxlcyBhbmQgZm9sZGVyc1xuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5yZWxvYWQgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0aGlzLmFsd2F5c0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgdGhpcy51cGRhdGVPblNlbGVjdCA9IHRydWU7XHJcblxyXG4gICAgLy90aGlzLnNob3J0Y3V0cyA9IFt7XHJcbiAgICAvL1x0cGF0dGVybiAgICAgOiAnY3RybCtzaGlmdCtyIGY1J1xyXG4gICAgLy99XTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbSxcclxuICAgICAgICAgICAgZGZyZCA9IGZtLnN5bmMoKSxcclxuICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBmbS5ub3RpZnkoeyB0eXBlOiAncmVsb2FkJywgY250OiAxLCBoaWRlQ250OiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAgICAgZGZyZC5hbHdheXMoZnVuY3Rpb24oKSB7IGZtLm5vdGlmeSh7IHR5cGU6ICdyZWxvYWQnLCBjbnQ6IC0xIH0pOyB9KTtcclxuICAgICAgICAgICAgfSwgZm0ubm90aWZ5RGVsYXkpO1xyXG5cclxuICAgICAgICByZXR1cm4gZGZyZC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcclxuICAgICAgICAgICAgZm0udHJpZ2dlcigncmVsb2FkJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxuICogQGNsYXNzICBlbEZpbmRlciBjb21tYW5kIFwidXBcIlxuICogR28gaW50byBwYXJlbnQgZGlyZWN0b3J5XG4gKlxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLnVwID0gZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLmFsd2F5c0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgdGhpcy51cGRhdGVPblNlbGVjdCA9IGZhbHNlO1xyXG5cclxuICAgIHRoaXMuc2hvcnRjdXRzID0gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcGF0dGVybjogJ2N0cmwrdXAnXHJcbiAgICAgICAgfVxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm0uY3dkKCkucGhhc2ggPyAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm0uY3dkKCkucGhhc2ggPyB0aGlzLmZtLmV4ZWMoJ29wZW4nLCB0aGlzLmZtLmN3ZCgpLnBoYXNoKSA6ICQuRGVmZXJyZWQoKS5yZWplY3QoKTtcclxuICAgIH07XHJcbn07IiwiXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMuaG9tZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy50aXRsZSA9ICdIb21lJztcclxuICAgIHRoaXMuYWx3YXlzRW5hYmxlZCA9IHRydWU7XHJcbiAgICB0aGlzLnVwZGF0ZU9uU2VsZWN0ID0gZmFsc2U7XHJcbiAgICB0aGlzLnNob3J0Y3V0cyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHBhdHRlcm46ICdjdHJsK2hvbWUgY3RybCtzaGlmdCt1cCcsXHJcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnSG9tZSdcclxuICAgICAgICB9XHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgcm9vdCA9IHRoaXMuZm0ucm9vdCgpLFxyXG4gICAgICAgICAgICBjd2QgPSB0aGlzLmZtLmN3ZCgpLmhhc2g7XHJcblxyXG4gICAgICAgIHJldHVybiByb290ICYmIGN3ZCAmJiByb290ICE9IGN3ZCA/IDAgOiAtMTtcclxuICAgIH07XHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mbS5leGVjKCdvcGVuJywgdGhpcy5mbS5yb290KCkpO1xyXG4gICAgfTtcclxufSIsIlwidXNlIHN0cmljdFwiO1xyXG4vKipcbiAqIEBjbGFzcyBlbEZpbmRlciBjb21tYW5kIFwiY29weVwiLlxuICogUHV0IGZpbGVzIGluIGZpbGVtYW5hZ2VyIGNsaXBib2FyZC5cbiAqXG4gKiBAdHlwZSAgZWxGaW5kZXIuY29tbWFuZFxuICogQGF1dGhvciAgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLmNvcHkgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0aGlzLnNob3J0Y3V0cyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHBhdHRlcm46ICdjdHJsK2MgY3RybCtpbnNlcnQnXHJcbiAgICAgICAgfVxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oc2VsKSB7XHJcbiAgICAgICAgdmFyIHNlbCA9IHRoaXMuZmlsZXMoc2VsKSxcclxuICAgICAgICAgICAgY250ID0gc2VsLmxlbmd0aDtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNudCAmJiAkLm1hcChzZWwsIGZ1bmN0aW9uKGYpIHsgcmV0dXJuIGYucGhhc2ggJiYgZi5yZWFkID8gZiA6IG51bGw7IH0pLmxlbmd0aCA9PSBjbnQgPyAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oaGFzaGVzKSB7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbSxcclxuICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKVxyXG4gICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJC5lYWNoKHRoaXMuZmlsZXMoaGFzaGVzKSwgZnVuY3Rpb24oaSwgZmlsZSkge1xyXG4gICAgICAgICAgICBpZiAoIShmaWxlLnJlYWQgJiYgZmlsZS5waGFzaCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJDb3B5JywgZmlsZS5uYW1lLCAnZXJyUGVybSddKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gZGZyZC5zdGF0ZSgpID09ICdyZWplY3RlZCcgPyBkZnJkIDogZGZyZC5yZXNvbHZlKGZtLmNsaXBib2FyZCh0aGlzLmhhc2hlcyhoYXNoZXMpKSk7XHJcbiAgICB9O1xyXG59OyIsIlwidXNlIHN0cmljdFwiO1xyXG4vKipcbiAqIEBjbGFzcyAgZWxGaW5kZXIgY29tbWFuZCBcInBhc3RlXCJcbiAqIFBhc3RlIGZpbGVzZnJvbSBjbGlwYm9hcmQgaW50byBkaXJlY3RvcnkuXG4gKiBJZiBmaWxlcyBwYXN0ZWQgaW4gaXRzIHBhcmVudCBkaXJlY3RvcnkgLSBmaWxlcyBkdXBsaWNhdGVzIHdpbGwgY3JlYXRlZFxuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5wYXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy51cGRhdGVPblNlbGVjdCA9IGZhbHNlO1xyXG5cclxuICAgIHRoaXMuaGFuZGxlcnMgPSB7XHJcbiAgICAgICAgY2hhbmdlY2xpcGJvYXJkOiBmdW5jdGlvbigpIHsgdGhpcy51cGRhdGUoKTsgfVxyXG4gICAgfTtcclxuICAgIHRoaXMuc2hvcnRjdXRzID0gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcGF0dGVybjogJ2N0cmwrdiBzaGlmdCtpbnNlcnQnXHJcbiAgICAgICAgfVxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oZHN0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGRzdCkge1xyXG4gICAgICAgICAgICBpZiAoJC5pc0FycmF5KGRzdCkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkc3QubGVuZ3RoICE9IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBkc3QgPSB0aGlzLmZtLmZpbGUoZHN0WzBdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRzdCA9IHRoaXMuZm0uY3dkKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5mbS5jbGlwYm9hcmQoKS5sZW5ndGggJiYgZHN0Lm1pbWUgPT0gJ2RpcmVjdG9yeScgJiYgZHN0LndyaXRlID8gMCA6IC0xO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGRzdCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgZm0gPSBzZWxmLmZtLFxyXG4gICAgICAgICAgICBkc3QgPSBkc3QgPyB0aGlzLmZpbGVzKGRzdClbMF0gOiBmbS5jd2QoKSxcclxuICAgICAgICAgICAgZmlsZXMgPSBmbS5jbGlwYm9hcmQoKSxcclxuICAgICAgICAgICAgY250ID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICBjdXQgPSBjbnQgPyBmaWxlc1swXS5jdXQgOiBmYWxzZSxcclxuICAgICAgICAgICAgZXJyb3IgPSBjdXQgPyAnZXJyTW92ZScgOiAnZXJyQ29weScsXHJcbiAgICAgICAgICAgIGZwYXN0ZSA9IFtdLFxyXG4gICAgICAgICAgICBmY29weSA9IFtdLFxyXG4gICAgICAgICAgICBkZnJkID0gJC5EZWZlcnJlZCgpXHJcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yICYmIGZtLmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBjb3B5ID0gZnVuY3Rpb24oZmlsZXMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlcy5sZW5ndGggJiYgZm0uX2NvbW1hbmRzLmR1cGxpY2F0ZVxyXG4gICAgICAgICAgICAgICAgICAgID8gZm0uZXhlYygnZHVwbGljYXRlJywgZmlsZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgOiAkLkRlZmVycmVkKCkucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwYXN0ZSA9IGZ1bmN0aW9uKGZpbGVzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGZyZCA9ICQuRGVmZXJyZWQoKSxcclxuICAgICAgICAgICAgICAgICAgICBleGlzdGVkID0gW10sXHJcbiAgICAgICAgICAgICAgICAgICAgaW50ZXJzZWN0ID0gZnVuY3Rpb24oZmlsZXMsIG5hbWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXQgPSBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBmaWxlcy5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmluQXJyYXkoZmlsZXNbaV0ubmFtZSwgbmFtZXMpICE9PSAtMSAmJiByZXQudW5zaGlmdChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlybSA9IGZ1bmN0aW9uKG5keCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGV4aXN0ZWRbbmR4XSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUgPSBmaWxlc1tpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QgPSBuZHggPT0gZXhpc3RlZC5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZtLmNvbmZpcm0oe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGZtLmkxOG4oY3V0ID8gJ21vdmVGaWxlcycgOiAnY29weUZpbGVzJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBmbS5pMThuKFsnZXJyRXhpc3RzJywgZmlsZS5uYW1lLCAnY29uZmlybVJlcGwnXSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGw6ICFsYXN0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdidG5ZZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbihhbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIWxhc3QgJiYgIWFsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBjb25maXJtKCsrbmR4KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBwYXN0ZShmaWxlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnYnRuTm8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbihhbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gZXhpc3RlZC5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAobmR4IDwgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXNbZXhpc3RlZFtpXV0uZHVibGljYXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzW2V4aXN0ZWRbbmR4XV0uZHVibGljYXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIWxhc3QgJiYgIWFsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBjb25maXJtKCsrbmR4KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBwYXN0ZShmaWxlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnYnRuQ2FuY2VsJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICB2YWxpZCA9IGZ1bmN0aW9uKG5hbWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0ZWQgPSBpbnRlcnNlY3QoZmlsZXMsIG5hbWVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RlZC5sZW5ndGggPyBjb25maXJtKDApIDogcGFzdGUoZmlsZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcGFzdGUgPSBmdW5jdGlvbihmaWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgLy9maWxlcyAgPSAkLm1hcChmaWxlcywgZnVuY3Rpb24oZmlsZSkgeyByZXR1cm4gIWZpbGUucmVtb3ZlID8gZmlsZSA6IG51bGwgfSApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY250ID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBzID0ge30sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzID0gW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdWJsaWNhdGVJbmRleGVzID0gW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcmMgPSBmaWxlc1swXS5waGFzaDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZHVibGljYXRlSW5kZXhlcyA9ICQubWFwKGZpbGVzLCBmdW5jdGlvbihmLCBpKSB7IHJldHVybiBmLmR1YmxpY2F0ZSA/IGkgOiBudWxsOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXMgPSAkLm1hcChmaWxlcywgZnVuY3Rpb24oZikgeyByZXR1cm4gZi5oYXNoOyB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAncGFzdGUnLCBkc3Q6IGRzdC5oYXNoLCB0YXJnZXRzOiBmaWxlcywgY3V0OiBjdXQgPyAxIDogMCwgc3JjOiBzcmMsIGR1YmxpbmRleGVzOiBkdWJsaWNhdGVJbmRleGVzIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZ5OiB7IHR5cGU6IGN1dCA/ICdtb3ZlJyA6ICdjb3B5JywgY250OiBjbnQgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hbHdheXMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm0udW5sb2NrZmlsZXMoeyBmaWxlczogZmlsZXMgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLl9kaXNhYmxlZCB8fCAhZmlsZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZm0ub2xkQVBJKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFzdGUoZmlsZXMpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmbS5vcHRpb24oJ2NvcHlPdmVyd3JpdGUnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXN0ZShmaWxlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRzdC5oYXNoID09IGZtLmN3ZCgpLmhhc2hcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdmFsaWQoJC5tYXAoZm0uZmlsZXMoKSwgZnVuY3Rpb24oZmlsZSkgeyByZXR1cm4gZmlsZS5waGFzaCA9PSBkc3QuaGFzaCA/IGZpbGUubmFtZSA6IG51bGw7IH0pKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogJ2xzJywgdGFyZ2V0OiBkc3QuaGFzaCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmeTogeyB0eXBlOiAncHJlcGFyZScsIGNudDogMSwgaGlkZUNudDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZlbnRGYWlsOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFsd2F5cyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWQoZGF0YS5saXN0IHx8IFtdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGZyZDtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcGFyZW50cyxcclxuICAgICAgICAgICAgZnBhcmVudHM7XHJcblxyXG5cclxuICAgICAgICBpZiAoIWNudCB8fCAhZHN0IHx8IGRzdC5taW1lICE9ICdkaXJlY3RvcnknKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFkc3Qud3JpdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KFtlcnJvciwgZmlsZXNbMF0ubmFtZSwgJ2VyclBlcm0nXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwYXJlbnRzID0gZm0ucGFyZW50cyhkc3QuaGFzaCk7XHJcblxyXG4gICAgICAgICQuZWFjaChmaWxlcywgZnVuY3Rpb24oaSwgZmlsZSkge1xyXG4gICAgICAgICAgICBpZiAoIWZpbGUucmVhZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFkZnJkLnJlamVjdChbZXJyb3IsIGZpbGVzWzBdLm5hbWUsICdlcnJQZXJtJ10pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoY3V0ICYmIGZpbGUubG9ja2VkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gIWRmcmQucmVqZWN0KFsnZXJyTG9ja2VkJywgZmlsZS5uYW1lXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICgkLmluQXJyYXkoZmlsZS5oYXNoLCBwYXJlbnRzKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJDb3B5SW5JdHNlbGYnLCBmaWxlLm5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnBhcmVudHMgPSBmbS5wYXJlbnRzKGZpbGUuaGFzaCk7XHJcbiAgICAgICAgICAgIGZwYXJlbnRzLnBvcCgpO1xyXG4gICAgICAgICAgICBpZiAoJC5pbkFycmF5KGRzdC5oYXNoLCBmcGFyZW50cykgIT09IC0xKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCQubWFwKGZwYXJlbnRzLCBmdW5jdGlvbihoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBmbS5maWxlKGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnBoYXNoID09IGRzdC5oYXNoICYmIGQubmFtZSA9PSBmaWxlLm5hbWUgPyBkIDogbnVsbDtcclxuICAgICAgICAgICAgICAgIH0pLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJSZXBsQnlDaGlsZCcsIGZpbGUubmFtZV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZmlsZS5waGFzaCA9PSBkc3QuaGFzaCkge1xyXG4gICAgICAgICAgICAgICAgZmNvcHkucHVzaChmaWxlLmhhc2gpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZnBhc3RlLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc2g6IGZpbGUuaGFzaCxcclxuICAgICAgICAgICAgICAgICAgICBwaGFzaDogZmlsZS5waGFzaCxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBmaWxlLm5hbWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChkZnJkLnN0YXRlKCkgPT0gJ3JlamVjdGVkJykge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAkLndoZW4oXHJcbiAgICAgICAgICAgIGNvcHkoZmNvcHkpLFxyXG4gICAgICAgICAgICBwYXN0ZShmcGFzdGUpXHJcbiAgICAgICAgKS5hbHdheXMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGN1dCAmJiBmbS5jbGlwYm9hcmQoW10pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjsgLyoqXHJcbiAqIEBjbGFzcyAgZWxGaW5kZXIgY29tbWFuZCBcIm9wZW5cIlxyXG4gKiBFbnRlciBmb2xkZXIgb3Igb3BlbiBmaWxlcyBpbiBuZXcgd2luZG93c1xyXG4gKlxyXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxyXG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5vcGVuID0gZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLmFsd2F5c0VuYWJsZWQgPSB0cnVlO1xyXG5cclxuICAgIHRoaXMuX2hhbmRsZXJzID0ge1xyXG4gICAgICAgIGRibGNsaWNrOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgaWYgKGUuZGF0YSAmJiBlLmRhdGEuZmlsZSAmJiBlLmRhdGEuZmlsZSAhPSBcIlwiKSB0aGlzLmV4ZWMoZS5kYXRhLmZpbGUpO1xyXG4gICAgICAgICAgICBlbHNlIHRoaXMuZXhlYygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgJ3NlbGVjdCBlbmFibGUgZGlzYWJsZSByZWxvYWQnOiBmdW5jdGlvbihlKSB7IHRoaXMudXBkYXRlKGUudHlwZSA9PSAnZGlzYWJsZScgPyAtMSA6IHZvaWQoMCkpOyB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zaG9ydGN1dHMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwYXR0ZXJuOiAnY3RybCtkb3duIG51bXBhZF9lbnRlcicgKyAodGhpcy5mbS5PUyAhPSAnbWFjJyAmJiAnIGVudGVyJylcclxuICAgICAgICB9XHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbihzZWwpIHtcclxuICAgICAgICB2YXIgc2VsID0gdGhpcy5maWxlcyhzZWwpLFxyXG4gICAgICAgICAgICBjbnQgPSBzZWwubGVuZ3RoO1xyXG5cclxuICAgICAgICByZXR1cm4gY250ID09IDFcclxuICAgICAgICAgICAgPyAwXHJcbiAgICAgICAgICAgIDogY250ID8gKCQubWFwKHNlbCwgZnVuY3Rpb24oZmlsZSkgeyByZXR1cm4gZmlsZS5taW1lID09ICdkaXJlY3RvcnknID8gbnVsbCA6IGZpbGU7IH0pLmxlbmd0aCA9PSBjbnQgPyAwIDogLTEpIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oaGFzaGVzKSB7XHJcblxyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm0sXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKCkuZmFpbChmdW5jdGlvbihlcnJvcikgeyBlcnJvciAmJiBmbS5lcnJvcihlcnJvcik7IH0pLFxyXG4gICAgICAgICAgICBmaWxlcyA9IHRoaXMuZmlsZXMoaGFzaGVzKSxcclxuICAgICAgICAgICAgY250ID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICBmaWxlLFxyXG4gICAgICAgICAgICB1cmwsXHJcbiAgICAgICAgICAgIHMsXHJcbiAgICAgICAgICAgIHc7XHJcblxyXG4gICAgICAgIGlmICghY250KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gb3BlbiBmb2xkZXJcclxuICAgICAgICBpZiAoY250ID09IDEgJiYgKGZpbGUgPSBmaWxlc1swXSkgJiYgZmlsZS5taW1lID09ICdkaXJlY3RvcnknKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmaWxlICYmICFmaWxlLnJlYWRcclxuICAgICAgICAgICAgICAgID8gZGZyZC5yZWplY3QoWydlcnJPcGVuJywgZmlsZS5uYW1lLCAnZXJyUGVybSddKVxyXG4gICAgICAgICAgICAgICAgOiBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogJ29wZW4nLCB0YXJnZXQ6IGZpbGUudGhhc2ggfHwgZmlsZS5oYXNoIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZ5OiB7IHR5cGU6ICdvcGVuJywgY250OiAxLCBoaWRlQ250OiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3luY09uRmFpbDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL2lmIChmbS5pc01vZGFsKSB7XHJcbiAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgLy99XHJcblxyXG4gICAgICAgIGZpbGVzID0gJC5tYXAoZmlsZXMsIGZ1bmN0aW9uKGZpbGUpIHsgcmV0dXJuIGZpbGUubWltZSAhPSAnZGlyZWN0b3J5JyA/IGZpbGUgOiBudWxsOyB9KTtcclxuXHJcbiAgICAgICAgLy8gbm90aGluZyB0byBvcGVuIG9yIGZpbGVzIGFuZCBmb2xkZXJzIHNlbGVjdGVkIC0gZG8gbm90aGluZ1xyXG4gICAgICAgIGlmIChjbnQgIT0gZmlsZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gb3BlbiBmaWxlc1xyXG4gICAgICAgIGNudCA9IGZpbGVzLmxlbmd0aDtcclxuICAgICAgICB3aGlsZSAoY250LS0pIHtcclxuICAgICAgICAgICAgZmlsZSA9IGZpbGVzW2NudF07XHJcblxyXG4gICAgICAgICAgICBpZiAoIWZpbGUucmVhZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KFsnZXJyT3BlbicsIGZpbGUubmFtZSwgJ2VyclBlcm0nXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghKHVybCA9IGZtLnVybCggLypmaWxlLnRoYXNoIHx8ICovZmlsZS5oYXNoKSkpIHtcclxuICAgICAgICAgICAgICAgIHVybCA9IGZtLm9wdGlvbnMudXJsO1xyXG4gICAgICAgICAgICAgICAgdXJsID0gdXJsICsgKHVybC5pbmRleE9mKCc/JykgPT09IC0xID8gJz8nIDogJyYnKVxyXG4gICAgICAgICAgICAgICAgICAgICsgKGZtLm9sZEFQSSA/ICdjbWQ9b3BlbiZjdXJyZW50PScgKyBmaWxlLnBoYXNoIDogJ2NtZD1maWxlJylcclxuICAgICAgICAgICAgICAgICAgICArICcmdGFyZ2V0PScgKyBmaWxlLmhhc2g7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHNldCB3aW5kb3cgc2l6ZSBmb3IgaW1hZ2UgaWYgc2V0XHJcbiAgICAgICAgICAgIGlmIChmaWxlLmRpbSkge1xyXG4gICAgICAgICAgICAgICAgcyA9IGZpbGUuZGltLnNwbGl0KCd4Jyk7XHJcbiAgICAgICAgICAgICAgICB3ID0gJ3dpZHRoPScgKyAocGFyc2VJbnQoc1swXSkgKyAyMCkgKyAnLGhlaWdodD0nICsgKHBhcnNlSW50KHNbMV0pICsgMjApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdyA9ICd3aWR0aD0nICsgcGFyc2VJbnQoMiAqICQod2luZG93KS53aWR0aCgpIC8gMykgKyAnLGhlaWdodD0nICsgcGFyc2VJbnQoMiAqICQod2luZG93KS5oZWlnaHQoKSAvIDMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgd25kID0gd2luZG93Lm9wZW4oJycsICduZXdfd2luZG93JywgdyArICcsdG9wPTUwLGxlZnQ9NTAsc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcycpO1xyXG4gICAgICAgICAgICBpZiAoIXduZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCdlcnJQb3B1cCcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpO1xyXG4gICAgICAgICAgICBmb3JtLmFjdGlvbiA9IGZtLm9wdGlvbnMudXJsO1xyXG4gICAgICAgICAgICBmb3JtLm1ldGhvZCA9ICdQT1NUJztcclxuICAgICAgICAgICAgZm9ybS50YXJnZXQgPSAnbmV3X3dpbmRvdyc7XHJcbiAgICAgICAgICAgIGZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9ICQuZXh0ZW5kKHt9LCBmbS5vcHRpb25zLmN1c3RvbURhdGEsIHtcclxuICAgICAgICAgICAgICAgIGNtZDogJ2ZpbGUnLFxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBmaWxlLmhhc2hcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICQuZWFjaChwYXJhbXMsIGZ1bmN0aW9uKGtleSwgdmFsKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgICAgICAgICBpbnB1dC5uYW1lID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgaW5wdXQudmFsdWUgPSB2YWw7XHJcbiAgICAgICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKGlucHV0KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZvcm0pO1xyXG4gICAgICAgICAgICBmb3JtLnN1Ym1pdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGZyZC5yZXNvbHZlKGhhc2hlcyk7XHJcbiAgICB9O1xyXG59OyIsIlwidXNlIHN0cmljdFwiOyAvKipcclxuICogQGNsYXNzICBlbEZpbmRlciBjb21tYW5kIFwicm1cIlxyXG4gKiBEZWxldGUgZmlsZXNcclxuICpcclxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcclxuICoqL1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMucm0gPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0aGlzLnNob3J0Y3V0cyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHBhdHRlcm46ICdkZWxldGUgY3RybCtiYWNrc3BhY2UnXHJcbiAgICAgICAgfVxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oc2VsKSB7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbTtcclxuICAgICAgICBzZWwgPSBzZWwgfHwgZm0uc2VsZWN0ZWQoKTtcclxuICAgICAgICByZXR1cm4gIXRoaXMuX2Rpc2FibGVkICYmIHNlbC5sZW5ndGggJiYgJC5tYXAoc2VsLCBmdW5jdGlvbihoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IGZtLmZpbGUoaCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZiAmJiBmLnBoYXNoICYmICFmLmxvY2tlZCA/IGggOiBudWxsO1xyXG4gICAgICAgICAgICB9KS5sZW5ndGggPT0gc2VsLmxlbmd0aFxyXG4gICAgICAgICAgICA/IDAgOiAtMTtcclxuICAgIH07XHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihoYXNoZXMpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXMsXHJcbiAgICAgICAgICAgIGZtID0gdGhpcy5mbSxcclxuICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKVxyXG4gICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvciAmJiBmbS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgZmlsZXMgPSB0aGlzLmZpbGVzKGhhc2hlcyksXHJcbiAgICAgICAgICAgIGNudCA9IGZpbGVzLmxlbmd0aCxcclxuICAgICAgICAgICAgY3dkID0gZm0uY3dkKCkuaGFzaCxcclxuICAgICAgICAgICAgZ29yb290ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmICghY250IHx8IHRoaXMuX2Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5lYWNoKGZpbGVzLCBmdW5jdGlvbihpLCBmaWxlKSB7XHJcbiAgICAgICAgICAgIGlmICghZmlsZS5waGFzaCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFkZnJkLnJlamVjdChbJ2VyclJtJywgZmlsZS5uYW1lLCAnZXJyUGVybSddKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZmlsZS5sb2NrZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJMb2NrZWQnLCBmaWxlLm5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZmlsZS5oYXNoID09IGN3ZCkge1xyXG4gICAgICAgICAgICAgICAgZ29yb290ID0gZm0ucm9vdChmaWxlLmhhc2gpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChkZnJkLnN0YXRlKCkgPT0gJ3BlbmRpbmcnKSB7XHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5oYXNoZXMoaGFzaGVzKTtcclxuXHJcbiAgICAgICAgICAgIGZtLmNvbmZpcm0oe1xyXG4gICAgICAgICAgICAgICAgdGl0bGU6ICfQktC90LjQvNCw0L3QuNC1IScsXHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAnY29uZmlybVJtJyxcclxuICAgICAgICAgICAgICAgIGFjY2VwdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnYnRuUm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm0ubG9ja2ZpbGVzKHsgZmlsZXM6IGZpbGVzIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogJ3JtJywgdGFyZ2V0czogZmlsZXMgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ3JtJywgY250OiBjbnQgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RmFpbDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5kb25lKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3Jvb3QgJiYgZm0uZXhlYygnb3BlbicsIGdvcm9vdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5hbHdheXMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm0udW5sb2NrZmlsZXMoeyBmaWxlczogZmlsZXMgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgY2FuY2VsOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdidG5DYW5jZWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHsgZGZyZC5yZWplY3QoKTsgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBkZnJkO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuLyoqXG4gKiBAY2xhc3MgZWxGaW5kZXIgY29tbWFuZCBcImluZm9cIi4gXG4gKiBEaXNwbGF5IGRpYWxvZyB3aXRoIGZpbGUgcHJvcGVydGllcy5cbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdiwgZGlvQHN0ZDQyLnJ1XG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5pbmZvID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgbSA9ICdtc2cnLFxyXG4gICAgICAgIGZtID0gdGhpcy5mbSxcclxuICAgICAgICBzcGNsYXNzID0gJ2VsZmluZGVyLWluZm8tc3Bpbm5lcicsXHJcbiAgICAgICAgbXNnID0ge1xyXG4gICAgICAgICAgICBjYWxjOiBmbS5pMThuKCdjYWxjJyksXHJcbiAgICAgICAgICAgIHNpemU6IGZtLmkxOG4oJ3NpemUnKSxcclxuICAgICAgICAgICAgdW5rbm93bjogZm0uaTE4bigndW5rbm93bicpLFxyXG4gICAgICAgICAgICBwYXRoOiBmbS5pMThuKCdwYXRoJyksXHJcbiAgICAgICAgICAgIGFsaWFzZm9yOiBmbS5pMThuKCdhbGlhc2ZvcicpLFxyXG4gICAgICAgICAgICBtb2RpZnk6IGZtLmkxOG4oJ21vZGlmeScpLFxyXG4gICAgICAgICAgICBwZXJtczogZm0uaTE4bigncGVybXMnKSxcclxuICAgICAgICAgICAgbG9ja2VkOiBmbS5pMThuKCdsb2NrZWQnKSxcclxuICAgICAgICAgICAgZGltOiBmbS5pMThuKCdkaW0nKSxcclxuICAgICAgICAgICAga2luZDogZm0uaTE4bigna2luZCcpLFxyXG4gICAgICAgICAgICBmaWxlczogZm0uaTE4bignZmlsZXMnKSxcclxuICAgICAgICAgICAgZm9sZGVyczogZm0uaTE4bignZm9sZGVycycpLFxyXG4gICAgICAgICAgICBpdGVtczogZm0uaTE4bignaXRlbXMnKSxcclxuICAgICAgICAgICAgeWVzOiBmbS5pMThuKCd5ZXMnKSxcclxuICAgICAgICAgICAgbm86IGZtLmkxOG4oJ25vJyksXHJcbiAgICAgICAgICAgIGxpbms6IGZtLmkxOG4oJ2xpbmsnKVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgdGhpcy50cGwgPSB7XHJcbiAgICAgICAgbWFpbjogJzxkaXYgY2xhc3M9XCJ1aS1oZWxwZXItY2xlYXJmaXggZWxmaW5kZXItaW5mby10aXRsZVwiPjxzcGFuIGNsYXNzPVwiZWxmaW5kZXItY3dkLWljb24ge2NsYXNzfSB1aS1jb3JuZXItYWxsXCIvPnt0aXRsZX08L2Rpdj48dGFibGUgY2xhc3M9XCJlbGZpbmRlci1pbmZvLXRiXCI+e2NvbnRlbnR9PC90YWJsZT4nLFxyXG4gICAgICAgIGl0ZW1UaXRsZTogJzxzdHJvbmc+e25hbWV9PC9zdHJvbmc+PHNwYW4gY2xhc3M9XCJlbGZpbmRlci1pbmZvLWtpbmRcIj57a2luZH08L3NwYW4+JyxcclxuICAgICAgICBncm91cFRpdGxlOiAnPHN0cm9uZz57aXRlbXN9OiB7bnVtfTwvc3Ryb25nPicsXHJcbiAgICAgICAgcm93OiAnPHRyPjx0ZD57bGFiZWx9IDogPC90ZD48dGQ+e3ZhbHVlfTwvdGQ+PC90cj4nLFxyXG4gICAgICAgIHNwaW5uZXI6ICc8c3Bhbj57dGV4dH08L3NwYW4+IDxzcGFuIGNsYXNzPVwiJyArIHNwY2xhc3MgKyAnXCIvPidcclxuICAgIH07XHJcbiAgICB0aGlzLmFsd2F5c0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgdGhpcy51cGRhdGVPblNlbGVjdCA9IGZhbHNlO1xyXG4gICAgdGhpcy5zaG9ydGN1dHMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwYXR0ZXJuOiAnY3RybCtpJ1xyXG4gICAgICAgIH1cclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5pbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJC5lYWNoKG1zZywgZnVuY3Rpb24oaywgdikge1xyXG4gICAgICAgICAgICBtc2dba10gPSBmbS5pMThuKHYpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihoYXNoZXMpIHtcclxuICAgICAgICB2YXIgZmlsZXMgPSB0aGlzLmZpbGVzKGhhc2hlcyk7XHJcbiAgICAgICAgaWYgKCEgZmlsZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5maWxlcyhbdGhpcy5mbS5jd2QoKS5oYXNoXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBvID0gdGhpcy5vcHRpb25zLFxyXG4gICAgICAgICAgICB0cGwgPSB0aGlzLnRwbCxcclxuICAgICAgICAgICAgcm93ID0gdHBsLnJvdyxcclxuICAgICAgICAgICAgY250ID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICBjb250ZW50ID0gW10sXHJcbiAgICAgICAgICAgIHZpZXcgPSB0cGwubWFpbixcclxuICAgICAgICAgICAgbCA9ICd7bGFiZWx9JyxcclxuICAgICAgICAgICAgdiA9ICd7dmFsdWV9JyxcclxuICAgICAgICAgICAgb3B0cyA9IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgd2lkdGg6ICdhdXRvJyxcclxuICAgICAgICAgICAgICAgIGNsb3NlOiBmdW5jdGlvbigpIHsgJCh0aGlzKS5lbGZpbmRlcmRpYWxvZygnZGVzdHJveScpOyB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvdW50ID0gW10sXHJcbiAgICAgICAgICAgIHJlcGxTcGlubmVyID0gZnVuY3Rpb24obXNnKSB7IGRpYWxvZy5maW5kKCcuJyArIHNwY2xhc3MpLnBhcmVudCgpLnRleHQobXNnKTsgfSxcclxuICAgICAgICAgICAgaWQgPSBmbS5uYW1lc3BhY2UgKyAnLWluZm8tJyArICQubWFwKGZpbGVzLCBmdW5jdGlvbihmKSB7IHJldHVybiBmLmhhc2g7IH0pLmpvaW4oJy0nKSxcclxuICAgICAgICAgICAgZGlhbG9nID0gZm0uZ2V0VUkoKS5maW5kKCcjJyArIGlkKSxcclxuICAgICAgICAgICAgc2l6ZSxcclxuICAgICAgICAgICAgdG1iLFxyXG4gICAgICAgICAgICBmaWxlLFxyXG4gICAgICAgICAgICB0aXRsZSxcclxuICAgICAgICAgICAgZGNudDtcclxuXHJcbiAgICAgICAgaWYgKCFjbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICQuRGVmZXJyZWQoKS5yZWplY3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkaWFsb2cubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGRpYWxvZy5lbGZpbmRlcmRpYWxvZygndG9Ub3AnKTtcclxuICAgICAgICAgICAgcmV0dXJuICQuRGVmZXJyZWQoKS5yZXNvbHZlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKGNudCA9PSAxKSB7XHJcbiAgICAgICAgICAgIGZpbGUgPSBmaWxlc1swXTtcclxuXHJcbiAgICAgICAgICAgIHZpZXcgPSB2aWV3LnJlcGxhY2UoJ3tjbGFzc30nLCBmbS5taW1lMmNsYXNzKGZpbGUubWltZSkpO1xyXG4gICAgICAgICAgICB0aXRsZSA9IHRwbC5pdGVtVGl0bGUucmVwbGFjZSgne25hbWV9JywgZm0uZXNjYXBlKGZpbGUuaTE4IHx8IGZpbGUubmFtZSkpLnJlcGxhY2UoJ3traW5kfScsIGZtLm1pbWUya2luZChmaWxlKSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZmlsZS50bWIpIHtcclxuICAgICAgICAgICAgICAgIHRtYiA9IGZtLm9wdGlvbigndG1iVXJsJykgKyBmaWxlLnRtYjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFmaWxlLnJlYWQpIHtcclxuICAgICAgICAgICAgICAgIHNpemUgPSBtc2cudW5rbm93bjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlLm1pbWUgIT0gJ2RpcmVjdG9yeScgfHwgZmlsZS5hbGlhcykge1xyXG4gICAgICAgICAgICAgICAgc2l6ZSA9IGZtLmZvcm1hdFNpemUoZmlsZS5zaXplKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNpemUgPSB0cGwuc3Bpbm5lci5yZXBsYWNlKCd7dGV4dH0nLCBtc2cuY2FsYyk7XHJcbiAgICAgICAgICAgICAgICBjb3VudC5wdXNoKGZpbGUuaGFzaCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnRlbnQucHVzaChyb3cucmVwbGFjZShsLCBtc2cuc2l6ZSkucmVwbGFjZSh2LCBzaXplKSk7XHJcbiAgICAgICAgICAgIGZpbGUuYWxpYXMgJiYgY29udGVudC5wdXNoKHJvdy5yZXBsYWNlKGwsIG1zZy5hbGlhc2ZvcikucmVwbGFjZSh2LCBmaWxlLmFsaWFzKSk7XHJcbiAgICAgICAgICAgIGNvbnRlbnQucHVzaChyb3cucmVwbGFjZShsLCBtc2cucGF0aCkucmVwbGFjZSh2LCBmbS5lc2NhcGUoZm0ucGF0aChmaWxlLmhhc2gsIHRydWUpKSkpO1xyXG4gICAgICAgICAgICBpZiAoZmlsZS5yZWFkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaHJlZjtcclxuICAgICAgICAgICAgICAgIGlmIChvLm51bGxVcmxEaXJMaW5rU2VsZiAmJiBmaWxlLm1pbWUgPT0gJ2RpcmVjdG9yeScgJiYgZmlsZS51cmwgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9jID0gd2luZG93LmxvY2F0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIGhyZWYgPSBsb2MucGF0aG5hbWUgKyBsb2Muc2VhcmNoICsgJyNlbGZfJyArIGZpbGUuaGFzaDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaHJlZiA9IGZtLnVybChmaWxlLmhhc2gpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udGVudC5wdXNoKHJvdy5yZXBsYWNlKGwsIG1zZy5saW5rKS5yZXBsYWNlKHYsICc8YSBocmVmPVwiJyArIGhyZWYgKyAnXCIgdGFyZ2V0PVwiX2JsYW5rXCI+JyArIGZpbGUubmFtZSArICc8L2E+JykpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZmlsZS5kaW0pIHsgLy8gb2xkIGFwaVxyXG4gICAgICAgICAgICAgICAgY29udGVudC5wdXNoKHJvdy5yZXBsYWNlKGwsIG1zZy5kaW0pLnJlcGxhY2UodiwgZmlsZS5kaW0pKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlLm1pbWUuaW5kZXhPZignaW1hZ2UnKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlLndpZHRoICYmIGZpbGUuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5wdXNoKHJvdy5yZXBsYWNlKGwsIG1zZy5kaW0pLnJlcGxhY2UodiwgZmlsZS53aWR0aCArICd4JyArIGZpbGUuaGVpZ2h0KSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQucHVzaChyb3cucmVwbGFjZShsLCBtc2cuZGltKS5yZXBsYWNlKHYsIHRwbC5zcGlubmVyLnJlcGxhY2UoJ3t0ZXh0fScsIG1zZy5jYWxjKSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdkaW0nLCB0YXJnZXQ6IGZpbGUuaGFzaCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmVudERlZmF1bHQ6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsU3Bpbm5lcihtc2cudW5rbm93bik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxTcGlubmVyKGRhdGEuZGltIHx8IG1zZy51bmtub3duKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmRpbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaW0gPSBkYXRhLmRpbS5zcGxpdCgneCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZmlsZSA9IGZtLmZpbGUoZmlsZS5oYXNoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZmlsZS53aWR0aCA9IGRpbVswXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZmlsZS5oZWlnaHQgPSBkaW1bMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgY29udGVudC5wdXNoKHJvdy5yZXBsYWNlKGwsIG1zZy5tb2RpZnkpLnJlcGxhY2UodiwgZm0uZm9ybWF0RGF0ZShmaWxlKSkpO1xyXG4gICAgICAgICAgICBjb250ZW50LnB1c2gocm93LnJlcGxhY2UobCwgbXNnLnBlcm1zKS5yZXBsYWNlKHYsIGZtLmZvcm1hdFBlcm1pc3Npb25zKGZpbGUpKSk7XHJcbiAgICAgICAgICAgIGNvbnRlbnQucHVzaChyb3cucmVwbGFjZShsLCBtc2cubG9ja2VkKS5yZXBsYWNlKHYsIGZpbGUubG9ja2VkID8gbXNnLnllcyA6IG1zZy5ubykpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZpZXcgPSB2aWV3LnJlcGxhY2UoJ3tjbGFzc30nLCAnZWxmaW5kZXItY3dkLWljb24tZ3JvdXAnKTtcclxuICAgICAgICAgICAgdGl0bGUgPSB0cGwuZ3JvdXBUaXRsZS5yZXBsYWNlKCd7aXRlbXN9JywgbXNnLml0ZW1zKS5yZXBsYWNlKCd7bnVtfScsIGNudCk7XHJcbiAgICAgICAgICAgIGRjbnQgPSAkLm1hcChmaWxlcywgZnVuY3Rpb24oZikgeyByZXR1cm4gZi5taW1lID09ICdkaXJlY3RvcnknID8gMSA6IG51bGw7IH0pLmxlbmd0aDtcclxuICAgICAgICAgICAgaWYgKCFkY250KSB7XHJcbiAgICAgICAgICAgICAgICBzaXplID0gMDtcclxuICAgICAgICAgICAgICAgICQuZWFjaChmaWxlcywgZnVuY3Rpb24oaCwgZikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gcGFyc2VJbnQoZi5zaXplKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMgPj0gMCAmJiBzaXplID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZSArPSBzO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemUgPSAndW5rbm93bic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50LnB1c2gocm93LnJlcGxhY2UobCwgbXNnLmtpbmQpLnJlcGxhY2UodiwgbXNnLmZpbGVzKSk7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50LnB1c2gocm93LnJlcGxhY2UobCwgbXNnLnNpemUpLnJlcGxhY2UodiwgZm0uZm9ybWF0U2l6ZShzaXplKSkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29udGVudC5wdXNoKHJvdy5yZXBsYWNlKGwsIG1zZy5raW5kKS5yZXBsYWNlKHYsIGRjbnQgPT0gY250ID8gbXNnLmZvbGRlcnMgOiBtc2cuZm9sZGVycyArICcgJyArIGRjbnQgKyAnLCAnICsgbXNnLmZpbGVzICsgJyAnICsgKGNudCAtIGRjbnQpKSk7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50LnB1c2gocm93LnJlcGxhY2UobCwgbXNnLnNpemUpLnJlcGxhY2UodiwgdHBsLnNwaW5uZXIucmVwbGFjZSgne3RleHR9JywgbXNnLmNhbGMpKSk7XHJcbiAgICAgICAgICAgICAgICBjb3VudCA9ICQubWFwKGZpbGVzLCBmdW5jdGlvbihmKSB7IHJldHVybiBmLmhhc2g7IH0pO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmlldyA9IHZpZXcucmVwbGFjZSgne3RpdGxlfScsIHRpdGxlKS5yZXBsYWNlKCd7Y29udGVudH0nLCBjb250ZW50LmpvaW4oJycpKTtcclxuXHJcbiAgICAgICAgZGlhbG9nID0gZm0uZGlhbG9nKHZpZXcsIG9wdHMpO1xyXG4gICAgICAgIGRpYWxvZy5hdHRyKCdpZCcsIGlkKTsgLy8gbG9hZCB0aHVtYm5haWxcclxuICAgICAgICBpZiAodG1iKSB7XHJcbiAgICAgICAgICAgICQoJzxpbWcvPicpXHJcbiAgICAgICAgICAgICAgICAubG9hZChmdW5jdGlvbigpIHsgZGlhbG9nLmZpbmQoJy5lbGZpbmRlci1jd2QtaWNvbicpLmNzcygnYmFja2dyb3VuZCcsICd1cmwoXCInICsgdG1iICsgJ1wiKSBjZW50ZXIgY2VudGVyIG5vLXJlcGVhdCcpOyB9KVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3NyYycsIHRtYik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBzZW5kIHJlcXVlc3QgdG8gY291bnQgdG90YWwgc2l6ZVxyXG4gICAgICAgIGlmIChjb3VudC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdzaXplJywgdGFyZ2V0czogY291bnQgfSxcclxuICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGxTcGlubmVyKG1zZy51bmtub3duKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNpemUgPSBwYXJzZUludChkYXRhLnNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGxTcGlubmVyKHNpemUgPj0gMCA/IGZtLmZvcm1hdFNpemUoc2l6ZSkgOiBtc2cudW5rbm93bik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuLyoqXG4gKiBAY2xhc3MgZWxGaW5kZXIgY29tbWFuZCBcImR1cGxpY2F0ZVwiXG4gKiBDcmVhdGUgZmlsZS9mb2xkZXIgY29weSB3aXRoIHN1ZmZpeCBcImNvcHkgTnVtYmVyXCJcbiAqXG4gKiBAdHlwZSAgZWxGaW5kZXIuY29tbWFuZFxuICogQGF1dGhvciAgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLmR1cGxpY2F0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGZtID0gdGhpcy5mbTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oc2VsKSB7XHJcbiAgICAgICAgdmFyIHNlbCA9IHRoaXMuZmlsZXMoc2VsKSxcclxuICAgICAgICAgICAgY250ID0gc2VsLmxlbmd0aDtcclxuXHJcbiAgICAgICAgcmV0dXJuICF0aGlzLl9kaXNhYmxlZCAmJiBjbnQgJiYgZm0uY3dkKCkud3JpdGUgJiYgJC5tYXAoc2VsLCBmdW5jdGlvbihmKSB7IHJldHVybiBmLnBoYXNoICYmIGYucmVhZCA/IGYgOiBudWxsOyB9KS5sZW5ndGggPT0gY250ID8gMCA6IC0xO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm0sXHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5maWxlcyhoYXNoZXMpLFxyXG4gICAgICAgICAgICBjbnQgPSBmaWxlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgJiYgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIGFyZ3MgPSBbXTtcclxuXHJcbiAgICAgICAgaWYgKCFjbnQgfHwgdGhpcy5fZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkLmVhY2goZmlsZXMsIGZ1bmN0aW9uKGksIGZpbGUpIHtcclxuICAgICAgICAgICAgaWYgKCFmaWxlLnJlYWQgfHwgIWZtLmZpbGUoZmlsZS5waGFzaCkud3JpdGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJDb3B5JywgZmlsZS5uYW1lLCAnZXJyUGVybSddKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoZGZyZC5zdGF0ZSgpID09ICdyZWplY3RlZCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgIGRhdGE6IHsgY21kOiAnZHVwbGljYXRlJywgdGFyZ2V0czogdGhpcy5oYXNoZXMoaGFzaGVzKSB9LFxyXG4gICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ2NvcHknLCBjbnQ6IGNudCB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuLyoqXG4gKiBAY2xhc3MgZWxGaW5kZXIgY29tbWFuZCBcInJlbmFtZVwiLiBcbiAqIFJlbmFtZSBzZWxlY3RlZCBmaWxlLlxuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92LCBkaW9Ac3RkNDIucnVcbiAqKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLnJlbmFtZSA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHRoaXMuc2hvcnRjdXRzID0gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcGF0dGVybjogJ2YyJyArICh0aGlzLmZtLk9TID09ICdtYWMnID8gJyBlbnRlcicgOiAnJylcclxuICAgICAgICB9XHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsID0gdGhpcy5mbS5zZWxlY3RlZEZpbGVzKCk7XHJcblxyXG4gICAgICAgIHJldHVybiAhdGhpcy5fZGlzYWJsZWQgJiYgc2VsLmxlbmd0aCA9PSAxICYmIHNlbFswXS5waGFzaCAmJiAhc2VsWzBdLmxvY2tlZCA/IDAgOiAtMTtcclxuICAgIH07XHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBjd2QgPSBmbS5nZXRVSSgnY3dkJyksXHJcbiAgICAgICAgICAgIHNlbCA9IGZtLnNlbGVjdGVkKCksXHJcbiAgICAgICAgICAgIGNudCA9IHNlbC5sZW5ndGgsXHJcbiAgICAgICAgICAgIGZpbGUgPSBmbS5maWxlKHNlbC5zaGlmdCgpKSxcclxuICAgICAgICAgICAgZmlsZW5hbWUgPSAnLmVsZmluZGVyLWN3ZC1maWxlbmFtZScsXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IGlucHV0LnBhcmVudCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gZm0uZXNjYXBlKGZpbGUubmFtZSk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Lmh0bWwobmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3dkLmZpbmQoJyMnICsgZmlsZS5oYXNoKS5maW5kKGZpbGVuYW1lKS5odG1sKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3dkLmZpbmQoJyMnICsgZmlsZS5oYXNoKS5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCA1MCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBlcnJvciAmJiBmbS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbS5lbmFibGUoKTtcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBpbnB1dCA9ICQoJzxpbnB1dCB0eXBlPVwidGV4dFwiLz4nKVxyXG4gICAgICAgICAgICAgICAgLmtleWRvd24oZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09ICQudWkua2V5Q29kZS5FU0NBUEUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAkLnVpLmtleUNvZGUuRU5URVIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuYmx1cigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubW91c2Vkb3duKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5kYmxjbGljayhmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmJsdXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSAkLnRyaW0oaW5wdXQudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBpbnB1dC5wYXJlbnQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlucHV0WzBdLnNldFNlbGVjdGlvblJhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFswXS5zZXRTZWxlY3Rpb25SYW5nZSgwLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PSBmaWxlLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCdlcnJJbnZOYW1lQ3InICsgKGZpbGUubWltZSA9PSBcImRpcmVjdG9yeVwiID8gJ0RpcicgOiAnJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lLm1hdGNoKFwiW1xcL3xcXFxcfFxcOnxcXCp8XFxcInxcXDx8XFw+fFxcI3xcXHxcXCRdXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoJ2VyckludlN5bScgKyAoZmlsZS5taW1lID09IFwiZGlyZWN0b3J5XCIgPyAnRGlyJyA6ICcnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUubGVuZ3RoID4gMTAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoJ2Vyckludk5hbWVTaXplJyArIChmaWxlLm1pbWUgPT0gXCJkaXJlY3RvcnlcIiA/ICdEaXInIDogJycpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZtLmZpbGVCeU5hbWUobmFtZSwgZmlsZS5waGFzaCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdChbJ2VyckV4aXN0cycsIG5hbWVdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZS5taW1lICE9IFwiZGlyZWN0b3J5XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleHROZXcgPSBmbS5nZXRFeHRlbnNpb24obmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXh0T2xkID0gZm0uZ2V0RXh0ZW5zaW9uKGZpbGUubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWV4dE5ldykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgnZXJySW52TmFtZUNyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXh0T2xkWzBdICYmIGV4dE5ld1swXSAmJiBleHROZXdbMF0gIT0gZXh0T2xkWzBdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCdlcnJJbnZFeHREaWZmZXJlbnQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuYW1lV2l0b3V0ZXh0ID0gbmFtZS5zcGxpdCgnLicpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWVXaXRvdXRleHQgPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgnZXJySW52TmFtZUNyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Lmh0bWwoZm0uZXNjYXBlKG5hbWUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm0ubG9ja2ZpbGVzKHsgZmlsZXM6IFtmaWxlLmhhc2hdIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogJ3JlbmFtZScsIHRhcmdldDogZmlsZS5oYXNoLCBuYW1lOiBuYW1lIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZ5OiB7IHR5cGU6ICdyZW5hbWUnLCBjbnQ6IDEgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbS5zeW5jKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZtLnVubG9ja2ZpbGVzKHsgZmlsZXM6IFtmaWxlLmhhc2hdIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBub2RlID0gY3dkLmZpbmQoJyMnICsgZmlsZS5oYXNoKS5maW5kKGZpbGVuYW1lKS5lbXB0eSgpLmFwcGVuZChpbnB1dC52YWwoZmlsZS5uYW1lKSksXHJcbiAgICAgICAgICAgIG5hbWUgPSBpbnB1dC52YWwoKS5yZXBsYWNlKC9cXC4oKHRhclxcLihnenxienxiejJ8enxsem8pKXxjcGlvXFwuZ3p8cHNcXC5nenx4Y2ZcXC4oZ3p8YnoyKXxbYS16MC05XXsxLDR9KSQvaWcsICcnKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghZmlsZSB8fCBjbnQgPiAxIHx8ICFub2RlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoJ2VyckNtZFBhcmFtcycsIHRoaXMudGl0bGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGZpbGUubG9ja2VkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdChbJ2VyckxvY2tlZCcsIGZpbGUubmFtZV0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm0ub25lKCdzZWxlY3QnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5wdXQucGFyZW50KCkubGVuZ3RoICYmIGZpbGUgJiYgJC5pbkFycmF5KGZpbGUuaGFzaCwgZm0uc2VsZWN0ZWQoKSkgPT09IC0xICYmIGlucHV0LmJsdXIoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpbnB1dC5zZWxlY3QoKS5mb2N1cygpO1xyXG5cclxuICAgICAgICBpbnB1dFswXS5zZXRTZWxlY3Rpb25SYW5nZSAmJiBpbnB1dFswXS5zZXRTZWxlY3Rpb25SYW5nZSgwLCBuYW1lLmxlbmd0aCk7XHJcblxyXG4gICAgICAgIHJldHVybiBkZnJkO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuLyoqXG4gKiBAY2xhc3MgIGVsRmluZGVyIGNvbW1hbmQgXCJoZWxwXCJcbiAqIFwiQWJvdXRcIiBkaWFsb2dcbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMuaGVscCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGZtID0gdGhpcy5mbSxcclxuICAgICAgICBzZWxmID0gdGhpcyxcclxuICAgICAgICBsaW5rdHBsID0gJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1oZWxwLWxpbmtcIj4gPGEgaHJlZj1cInt1cmx9XCI+e2xpbmt9PC9hPjwvZGl2PicsXHJcbiAgICAgICAgbGlua3RwbHRndCA9ICc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItaGVscC1saW5rXCI+IDxhIGhyZWY9XCJ7dXJsfVwiIHRhcmdldD1cIl9ibGFua1wiPntsaW5rfTwvYT48L2Rpdj4nLFxyXG4gICAgICAgIGF0cGwgPSAnPGRpdiBjbGFzcz1cImVsZmluZGVyLWhlbHAtdGVhbVwiPjxkaXY+e2F1dGhvcn08L2Rpdj57d29ya308L2Rpdj4nLFxyXG4gICAgICAgIHVybCA9IC9cXHt1cmxcXH0vLFxyXG4gICAgICAgIGxpbmsgPSAvXFx7bGlua1xcfS8sXHJcbiAgICAgICAgYXV0aG9yID0gL1xce2F1dGhvclxcfS8sXHJcbiAgICAgICAgd29yayA9IC9cXHt3b3JrXFx9LyxcclxuICAgICAgICByID0gJ3JlcGxhY2UnLFxyXG4gICAgICAgIHByaW0gPSAndWktcHJpb3JpdHktcHJpbWFyeScsXHJcbiAgICAgICAgc2VjID0gJ3VpLXByaW9yaXR5LXNlY29uZGFyeScsXHJcbiAgICAgICAgbGljID0gJ2VsZmluZGVyLWhlbHAtbGljZW5zZScsXHJcbiAgICAgICAgdGFiID0gJzxsaSBjbGFzcz1cInVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLXRvcFwiPjxhIGhyZWY9XCIje2lkfVwiPnt0aXRsZX08L2E+PC9saT4nLFxyXG4gICAgICAgIGh0bWwgPSBbXHJcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidWktdGFicyB1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgdWktY29ybmVyLWFsbCBlbGZpbmRlci1oZWxwXCI+JyxcclxuICAgICAgICAgICAgJzx1bCBjbGFzcz1cInVpLXRhYnMtbmF2IHVpLWhlbHBlci1yZXNldCB1aS1oZWxwZXItY2xlYXJmaXggdWktd2lkZ2V0LWhlYWRlciB1aS1jb3JuZXItYWxsXCI+J1xyXG4gICAgICAgIF0sXHJcbiAgICAgICAgc3RwbCA9ICc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItaGVscC1zaG9ydGN1dFwiPjxkaXYgY2xhc3M9XCJlbGZpbmRlci1oZWxwLXNob3J0Y3V0LXBhdHRlcm5cIj57cGF0dGVybn08L2Rpdj4ge2Rlc2NyaXB9PC9kaXY+JyxcclxuICAgICAgICBzZXAgPSAnPGRpdiBjbGFzcz1cImVsZmluZGVyLWhlbHAtc2VwYXJhdG9yXCIvPicsXHJcblxyXG5cclxuICAgICAgICBhYm91dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBodG1sLnB1c2goJzxkaXYgaWQ9XCJhYm91dFwiIGNsYXNzPVwidWktdGFicy1wYW5lbCB1aS13aWRnZXQtY29udGVudCB1aS1jb3JuZXItYm90dG9tXCI+PGRpdiBjbGFzcz1cImVsZmluZGVyLWhlbHAtbG9nb1wiLz4nKTtcclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8aDM+ZWxGaW5kZXI8L2gzPicpO1xyXG4gICAgICAgICAgICBodG1sLnB1c2goJzxkaXYgY2xhc3M9XCInICsgcHJpbSArICdcIj4nICsgZm0uaTE4bignd2ViZm0nKSArICc8L2Rpdj4nKTtcclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8ZGl2IGNsYXNzPVwiJyArIHNlYyArICdcIj4nICsgZm0uaTE4bigndmVyJykgKyAnOiAnICsgZm0udmVyc2lvbiArICcsICcgKyBmbS5pMThuKCdwcm90b2NvbHZlcicpICsgJzogPHNwYW4gaWQ9XCJhcGl2ZXJcIj48L3NwYW4+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdiBjbGFzcz1cIicgKyBzZWMgKyAnXCI+alF1ZXJ5L2pRdWVyeSBVSTogJyArICQoKS5qcXVlcnkgKyAnLycgKyAkLnVpLnZlcnNpb24gKyAnPC9kaXY+Jyk7XHJcblxyXG4gICAgICAgICAgICBodG1sLnB1c2goc2VwKTtcclxuXHJcbiAgICAgICAgICAgIGh0bWwucHVzaChsaW5rdHBsdGd0W3JdKHVybCwgJ2h0dHA6Ly9lbGZpbmRlci5vcmcvJylbcl0obGluaywgZm0uaTE4bignaG9tZXBhZ2UnKSkpO1xyXG4gICAgICAgICAgICBodG1sLnB1c2gobGlua3RwbHRndFtyXSh1cmwsICdodHRwczovL2dpdGh1Yi5jb20vU3R1ZGlvLTQyL2VsRmluZGVyL3dpa2knKVtyXShsaW5rLCBmbS5pMThuKCdkb2NzJykpKTtcclxuICAgICAgICAgICAgaHRtbC5wdXNoKGxpbmt0cGx0Z3Rbcl0odXJsLCAnaHR0cHM6Ly9naXRodWIuY29tL1N0dWRpby00Mi9lbEZpbmRlcicpW3JdKGxpbmssIGZtLmkxOG4oJ2dpdGh1YicpKSk7XHJcbiAgICAgICAgICAgIGh0bWwucHVzaChsaW5rdHBsdGd0W3JdKHVybCwgJ2h0dHA6Ly90d2l0dGVyLmNvbS9lbHJ0ZV9lbGZpbmRlcicpW3JdKGxpbmssIGZtLmkxOG4oJ3R3aXR0ZXInKSkpO1xyXG5cclxuICAgICAgICAgICAgaHRtbC5wdXNoKHNlcCk7XHJcblxyXG4gICAgICAgICAgICBodG1sLnB1c2goJzxkaXYgY2xhc3M9XCInICsgcHJpbSArICdcIj4nICsgZm0uaTE4bigndGVhbScpICsgJzwvZGl2PicpO1xyXG5cclxuICAgICAgICAgICAgaHRtbC5wdXNoKGF0cGxbcl0oYXV0aG9yLCAnRG1pdHJ5IFwiZGlvXCIgTGV2YXNob3YgJmx0O2Rpb0BzdGQ0Mi5ydSZndDsnKVtyXSh3b3JrLCBmbS5pMThuKCdjaGllZmRldicpKSk7XHJcbiAgICAgICAgICAgIGh0bWwucHVzaChhdHBsW3JdKGF1dGhvciwgJ1Ryb2V4IE5ldmVsaW4gJmx0O3Ryb2V4QGZ1cnkuc2NhbmNvZGUucnUmZ3Q7Jylbcl0od29yaywgZm0uaTE4bignbWFpbnRhaW5lcicpKSk7XHJcbiAgICAgICAgICAgIGh0bWwucHVzaChhdHBsW3JdKGF1dGhvciwgJ0FsZXhleSBTdWtob3RpbiAmbHQ7c3Ryb2dnQHlhbmRleC5ydSZndDsnKVtyXSh3b3JrLCBmbS5pMThuKCdjb250cmlidXRvcicpKSk7XHJcbiAgICAgICAgICAgIGh0bWwucHVzaChhdHBsW3JdKGF1dGhvciwgJ05hb2tpIFNhd2FkYSAmbHQ7aHlwd2ViQGdtYWlsLmNvbSZndDsnKVtyXSh3b3JrLCBmbS5pMThuKCdjb250cmlidXRvcicpKSk7XHJcblxyXG4gICAgICAgICAgICBmbS5pMThbZm0ubGFuZ10udHJhbnNsYXRvciAmJiBodG1sLnB1c2goYXRwbFtyXShhdXRob3IsIGZtLmkxOFtmbS5sYW5nXS50cmFuc2xhdG9yKVtyXSh3b3JrLCBmbS5pMThuKCd0cmFuc2xhdG9yJykgKyAnICgnICsgZm0uaTE4W2ZtLmxhbmddLmxhbmd1YWdlICsgJyknKSk7XHJcblxyXG4gICAgICAgICAgICBodG1sLnB1c2goc2VwKTtcclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8ZGl2IGNsYXNzPVwiJyArIGxpYyArICdcIj4nICsgZm0uaTE4bignaWNvbnMnKSArICc6IFBpeGVsbWl4ZXIsIDxhIGhyZWY9XCJodHRwOi8vcC55dXN1a2VrYW1peWFtYW5lLmNvbVwiIHRhcmdldD1cIl9ibGFua1wiPkZ1Z3VlPC9hPjwvZGl2PicpO1xyXG5cclxuICAgICAgICAgICAgaHRtbC5wdXNoKHNlcCk7XHJcbiAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdiBjbGFzcz1cIicgKyBsaWMgKyAnXCI+TGljZW5jZTogQlNEIExpY2VuY2U8L2Rpdj4nKTtcclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8ZGl2IGNsYXNzPVwiJyArIGxpYyArICdcIj5Db3B5cmlnaHQgwqkgMjAwOS0yMDExLCBTdHVkaW8gNDI8L2Rpdj4nKTtcclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8ZGl2IGNsYXNzPVwiJyArIGxpYyArICdcIj7igJ4g4oCmJyArIGZtLmkxOG4oJ2RvbnRmb3JnZXQnKSArICcg4oCdPC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIGh0bWwucHVzaCgnPC9kaXY+Jyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzaG9ydGN1dHMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHNoID0gZm0uc2hvcnRjdXRzKCk7XHJcbiAgICAgICAgICAgIC8vIHNob3J0Y3V0cyB0YWJcclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8ZGl2IGlkPVwic2hvcnRjdXRzXCIgY2xhc3M9XCJ1aS10YWJzLXBhbmVsIHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1ib3R0b21cIj4nKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzaC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdiBjbGFzcz1cInVpLXdpZGdldC1jb250ZW50IGVsZmluZGVyLWhlbHAtc2hvcnRjdXRzXCI+Jyk7XHJcbiAgICAgICAgICAgICAgICAkLmVhY2goc2gsIGZ1bmN0aW9uKGksIHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBodG1sLnB1c2goc3RwbC5yZXBsYWNlKC9cXHtwYXR0ZXJuXFx9Lywgc1swXSkucmVwbGFjZSgvXFx7ZGVzY3JpcFxcfS8sIHNbMV0pKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1oZWxwLWRpc2FibGVkXCI+JyArIGZtLmkxOG4oJ3Nob3J0Y3V0c29mJykgKyAnPC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICBodG1sLnB1c2goJzwvZGl2PicpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGVscCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBoZWxwIHRhYlxyXG4gICAgICAgICAgICBodG1sLnB1c2goJzxkaXYgaWQ9XCJoZWxwXCIgY2xhc3M9XCJ1aS10YWJzLXBhbmVsIHVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1ib3R0b21cIj4nKTtcclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8YSBocmVmPVwiaHR0cDovL2VsZmluZGVyLm9yZy9mb3J1bS9cIiB0YXJnZXQ9XCJfYmxhbmtcIiBjbGFzcz1cImVsZmluZGVyLWRvbnQtcGFuaWNcIj48c3Bhbj5ET05cXCdUIFBBTklDPC9zcGFuPjwvYT4nKTtcclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8L2Rpdj4nKTtcclxuICAgICAgICAgICAgLy8gZW5kIGhlbHBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbnRlbnQ7XHJcblxyXG4gICAgdGhpcy5hbHdheXNFbmFibGVkID0gdHJ1ZTtcclxuICAgIHRoaXMudXBkYXRlT25TZWxlY3QgPSBmYWxzZTtcclxuICAgIHRoaXMuc3RhdGUgPSAwO1xyXG5cclxuICAgIHRoaXMuc2hvcnRjdXRzID0gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcGF0dGVybjogJ2YxJyxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMudGl0bGVcclxuICAgICAgICB9XHJcbiAgICBdO1xyXG5cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHBhcnRzID0gc2VsZi5vcHRpb25zLnZpZXcgfHwgWydhYm91dCcsICdzaG9ydGN1dHMnLCAnaGVscCddO1xyXG5cclxuICAgICAgICAkLmVhY2gocGFydHMsIGZ1bmN0aW9uKGksIHRpdGxlKSB7XHJcbiAgICAgICAgICAgIGh0bWwucHVzaCh0YWJbcl0oL1xce2lkXFx9LywgdGl0bGUpW3JdKC9cXHt0aXRsZVxcfS8sIGZtLmkxOG4odGl0bGUpKSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGh0bWwucHVzaCgnPC91bD4nKTtcclxuXHJcbiAgICAgICAgJC5pbkFycmF5KCdhYm91dCcsIHBhcnRzKSAhPT0gLTEgJiYgYWJvdXQoKTtcclxuICAgICAgICAkLmluQXJyYXkoJ3Nob3J0Y3V0cycsIHBhcnRzKSAhPT0gLTEgJiYgc2hvcnRjdXRzKCk7XHJcbiAgICAgICAgJC5pbkFycmF5KCdoZWxwJywgcGFydHMpICE9PSAtMSAmJiBoZWxwKCk7XHJcblxyXG4gICAgICAgIGh0bWwucHVzaCgnPC9kaXY+Jyk7XHJcbiAgICAgICAgY29udGVudCA9ICQoaHRtbC5qb2luKCcnKSk7XHJcblxyXG4gICAgICAgIGZtLm9uZSgnbG9hZCcsIGZ1bmN0aW9uIHNldGFwaSgpIHsgY29udGVudC5maW5kKCcjYXBpdmVyJykudGV4dChmbS5hcGkpOyB9KTtcclxuXHJcbiAgICAgICAgY29udGVudC5maW5kKCcudWktdGFicy1uYXYgbGknKVxyXG4gICAgICAgICAgICAuaG92ZXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCd1aS1zdGF0ZS1ob3ZlcicpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2hpbGRyZW4oKVxyXG4gICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpbmsgPSAkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFsaW5rLmlzKCcudWktdGFicy1zZWxlY3RlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGluay5wYXJlbnQoKS5hZGRDbGFzcygndWktdGFicy1zZWxlY3RlZCB1aS1zdGF0ZS1hY3RpdmUnKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCd1aS10YWJzLXNlbGVjdGVkJykucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuZmluZCgnLnVpLXRhYnMtcGFuZWwnKS5oaWRlKCkuZmlsdGVyKGxpbmsuYXR0cignaHJlZicpKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmlsdGVyKCc6Zmlyc3QnKS5jbGljaygpO1xyXG5cclxuICAgIH0sIDIwMCk7XHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRpYWxvZykge1xyXG4gICAgICAgICAgICB0aGlzLmRpYWxvZyA9IHRoaXMuZm0uZGlhbG9nKGNvbnRlbnQsIHsgdGl0bGU6IHRoaXMudGl0bGUsIHdpZHRoOiA1MzAsIGF1dG9PcGVuOiBmYWxzZSwgZGVzdHJveU9uQ2xvc2U6IGZhbHNlIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5kaWFsb2cuZWxmaW5kZXJkaWFsb2coJ29wZW4nKS5maW5kKCcudWktdGFicy1uYXYgbGkgYTpmaXJzdCcpLmNsaWNrKCk7XHJcbiAgICB9O1xyXG59OyIsIlwidXNlIHN0cmljdFwiO1xyXG4vKipcbiAqIEBjbGFzcyBlbEZpbmRlciBjb21tYW5kIFwiZ2V0ZmlsZVwiLiBcbiAqIFJldHVybiBzZWxlY3RlZCBmaWxlcyBpbmZvIGludG8gb3V0ZXIgY2FsbGJhY2suXG4gKiBGb3IgdXNlIGVsRmluZGVyIHdpdGggd3lzaXd5ZyBlZGl0b3JzIGV0Yy5cbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdiwgZGlvQHN0ZDQyLnJ1XG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5nZXRmaWxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXMsXHJcbiAgICAgICAgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgIGZpbHRlciA9IGZ1bmN0aW9uKGZpbGVzKSB7XHJcbiAgICAgICAgICAgIHZhciBvID0gc2VsZi5vcHRpb25zO1xyXG5cclxuICAgICAgICAgICAgZmlsZXMgPSAkLm1hcChmaWxlcywgZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbGUubWltZSAhPSAnZGlyZWN0b3J5JyB8fCBvLmZvbGRlcnMgPyBmaWxlIDogbnVsbDtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gby5tdWx0aXBsZSB8fCBmaWxlcy5sZW5ndGggPT0gMSA/IGZpbGVzIDogW107XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB0aGlzLmFsd2F5c0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgdGhpcy5jYWxsYmFjayA9IGZtLm9wdGlvbnMuZ2V0RmlsZUNhbGxiYWNrO1xyXG4gICAgdGhpcy5fZGlzYWJsZWQgPSB0eXBlb2YodGhpcy5jYWxsYmFjaykgPT0gJ2Z1bmN0aW9uJztcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oc2VsKSB7XHJcbiAgICAgICAgdmFyIHNlbCA9IHRoaXMuZmlsZXMoc2VsKSxcclxuICAgICAgICAgICAgY250ID0gc2VsLmxlbmd0aDtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FsbGJhY2sgJiYgY250ICYmIGZpbHRlcihzZWwpLmxlbmd0aCA9PSBjbnQgPyAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oaGFzaGVzKSB7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbSxcclxuICAgICAgICAgICAgb3B0cyA9IHRoaXMub3B0aW9ucyxcclxuICAgICAgICAgICAgZmlsZXMgPSB0aGlzLmZpbGVzKGhhc2hlcyksXHJcbiAgICAgICAgICAgIGNudCA9IGZpbGVzLmxlbmd0aCxcclxuICAgICAgICAgICAgdXJsID0gZm0ub3B0aW9uKCd1cmwnKSxcclxuICAgICAgICAgICAgdG1iID0gZm0ub3B0aW9uKCd0bWJVcmwnKSxcclxuICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKVxyXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZtLnRyaWdnZXIoJ2dldGZpbGUnLCB7IGZpbGVzOiBkYXRhIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsbGJhY2soZGF0YSwgZm0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0cy5vbmNvbXBsZXRlID09ICdjbG9zZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm0uaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0cy5vbmNvbXBsZXRlID09ICdkZXN0cm95Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbS5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvcHRzLm9ubHlVUkxcclxuICAgICAgICAgICAgICAgICAgICA/IG9wdHMubXVsdGlwbGUgPyAkLm1hcChmaWxlcywgZnVuY3Rpb24oZikgeyByZXR1cm4gZi51cmw7IH0pIDogZmlsZXNbMF0udXJsXHJcbiAgICAgICAgICAgICAgICAgICAgOiBvcHRzLm11bHRpcGxlID8gZmlsZXMgOiBmaWxlc1swXTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcmVxID0gW10sXHJcbiAgICAgICAgICAgIGksXHJcbiAgICAgICAgICAgIGZpbGUsXHJcbiAgICAgICAgICAgIGRpbTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZ2V0c3RhdGUoKSA9PSAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBjbnQ7IGkrKykge1xyXG4gICAgICAgICAgICBmaWxlID0gZmlsZXNbaV07XHJcbiAgICAgICAgICAgIGlmIChmaWxlLm1pbWUgPT0gJ2RpcmVjdG9yeScgJiYgIW9wdHMuZm9sZGVycykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmlsZS5iYXNlVXJsID0gdXJsO1xyXG4gICAgICAgICAgICBmaWxlLnVybCA9IGZtLnVybChmaWxlLmhhc2gpO1xyXG4gICAgICAgICAgICBmaWxlLnBhdGggPSBmbS5wYXRoKGZpbGUuaGFzaCk7XHJcbiAgICAgICAgICAgIGlmIChmaWxlLnRtYiAmJiBmaWxlLnRtYiAhPSAxKSB7XHJcbiAgICAgICAgICAgICAgICBmaWxlLnRtYiA9IHRtYiArIGZpbGUudG1iO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghZmlsZS53aWR0aCAmJiAhZmlsZS5oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlLmRpbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpbSA9IGZpbGUuZGltLnNwbGl0KCd4Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZS53aWR0aCA9IGRpbVswXTtcclxuICAgICAgICAgICAgICAgICAgICBmaWxlLmhlaWdodCA9IGRpbVsxXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZS5taW1lLmluZGV4T2YoJ2ltYWdlJykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxLnB1c2goZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogJ2RpbScsIHRhcmdldDogZmlsZS5oYXNoIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ2RpbScsIGNudDogMSwgaGlkZUNudDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmVudERlZmF1bHQ6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZGltKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpbSA9IGRhdGEuZGltLnNwbGl0KCd4Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJmaWxlID0gZm0uZmlsZSh0aGlzLmhhc2gpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJmaWxlLndpZHRoID0gdGhpcy53aWR0aCA9IGRpbVswXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZmlsZS5oZWlnaHQgPSB0aGlzLmhlaWdodCA9IGRpbVsxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfS5iaW5kKGZpbGUpKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChyZXEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICQud2hlbi5hcHBseShudWxsLCByZXEpLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGRmcmQucmVzb2x2ZShyZXN1bHQoZmlsZXMpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGRmcmQucmVzb2x2ZShyZXN1bHQoZmlsZXMpKTtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxuICogQGNsYXNzICBlbEZpbmRlciBjb21tYW5kIFwibWtkaXJcIlxuICogQ3JlYXRlIG5ldyBmb2xkZXJcbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMubWtkaXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuZGlzYWJsZU9uU2VhcmNoID0gdHJ1ZTtcclxuICAgIHRoaXMudXBkYXRlT25TZWxlY3QgPSBmYWxzZTtcclxuICAgIHRoaXMubWltZSA9ICdkaXJlY3RvcnknO1xyXG4gICAgdGhpcy5wcmVmaXggPSAndW50aXRsZWQgZm9sZGVyJztcclxuICAgIHRoaXMuZXhlYyA9ICQucHJveHkodGhpcy5mbS5yZXMoJ21peGluJywgJ21ha2UnKSwgdGhpcyk7XHJcblxyXG4gICAgdGhpcy5zaG9ydGN1dHMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwYXR0ZXJuOiAnY3RybCtzaGlmdCtuJ1xyXG4gICAgICAgIH1cclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5fZGlzYWJsZWQgJiYgdGhpcy5mbS5jd2QoKS53cml0ZSA/IDAgOiAtMTtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxuICogQGNsYXNzICBlbEZpbmRlciBjb21tYW5kIFwibWtmaWxlXCJcbiAqIENyZWF0ZSBuZXcgZW1wdHkgZmlsZVxuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5ta2ZpbGUgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuZGlzYWJsZU9uU2VhcmNoID0gdHJ1ZTtcclxuICAgIHRoaXMudXBkYXRlT25TZWxlY3QgPSBmYWxzZTtcclxuICAgIHRoaXMubWltZSA9ICd0ZXh0L3BsYWluJztcclxuICAgIHRoaXMucHJlZml4ID0gJ3VudGl0bGVkIGZpbGUudHh0JztcclxuICAgIHRoaXMuZXhlYyA9ICQucHJveHkodGhpcy5mbS5yZXMoJ21peGluJywgJ21ha2UnKSwgdGhpcyk7XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5fZGlzYWJsZWQgJiYgdGhpcy5mbS5jd2QoKS53cml0ZSA/IDAgOiAtMTtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxyXG4gKiBAY2xhc3MgZWxGaW5kZXIgY29tbWFuZCBcInVwbG9hZFwiXHJcbiAqIFVwbG9hZCBmaWxlcyB1c2luZyBpZnJhbWUgb3IgWE1MSHR0cFJlcXVlc3QgJiBGb3JtRGF0YS5cclxuICogRGlhbG9nIGFsbG93IHRvIHNlbmQgZmlsZXMgdXNpbmcgZHJhZyBhbmQgZHJvcFxyXG4gKlxyXG4gKiBAdHlwZSAgZWxGaW5kZXIuY29tbWFuZFxyXG4gKiBAYXV0aG9yICBEbWl0cnkgKGRpbykgTGV2YXNob3ZcclxuICovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy51cGxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBob3ZlciA9IHRoaXMuZm0ucmVzKCdjbGFzcycsICdob3ZlcicpO1xyXG5cclxuICAgIHRoaXMuZGlzYWJsZU9uU2VhcmNoID0gdHJ1ZTtcclxuICAgIHRoaXMudXBkYXRlT25TZWxlY3QgPSBmYWxzZTtcclxuXHJcbiAgICAvLyBTaG9ydGN1dCBvcGVucyBkaWFsb2dcclxuICAgIHRoaXMuc2hvcnRjdXRzID0gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcGF0dGVybjogJ2N0cmwrdSdcclxuICAgICAgICB9XHJcbiAgICBdO1xyXG5cclxuICAgIC8qKlxyXG5cdCAqIFJldHVybiBjb21tYW5kIHN0YXRlXHJcblx0ICpcclxuXHQgKiBAcmV0dXJuIE51bWJlclxyXG5cdCAqKi9cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gMDsgLy8hdGhpcy5fZGlzYWJsZWQgJiYgdGhpcy5mbS5jd2QoKS53cml0ZSA/IDAgOiAtMTtcclxuICAgIH07XHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbSxcclxuICAgICAgICAgICAgZmlsZXMsXHJcbiAgICAgICAgICAgIGV4aXN0ZWQgPSBbXSxcclxuICAgICAgICAgICAgbm90VXBsb2FkID0gW10sXHJcbiAgICAgICAgICAgIGR1YmxpY2F0ZUluZGV4ZXMgPSBbXSxcclxuXHJcbiAgICAgICAgICAgIGVyclRleHQgPSBmbS5pMThuKCdlcnJOb3RVcGxUaXRsZScpICsgJzxici8+JyxcclxuICAgICAgICAgICAgZXJyb3IgPSBmYWxzZSxcclxuICAgICAgICAgICAgb3B0cyA9IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiBmbS5pMThuKCdhdHRlbnRpb24nKSxcclxuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHt9LFxyXG4gICAgICAgICAgICAgICAgY2xvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVzLmxlbmd0aCAhPSBub3RVcGxvYWQubGVuZ3RoICYmIGZtLnVwbG9hZChkYXRhLCBub3RVcGxvYWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjd2RGaWxlTmFtZXMgPSAkLm1hcChmbS5maWxlcygpLCBmdW5jdGlvbihmaWxlKSB7IHJldHVybiBmaWxlLnBoYXNoID09IGZtLmN3ZCgpLmhhc2ggPyBmaWxlLm5hbWUgOiBudWxsOyB9KSxcclxuICAgICAgICAgICAgY29uZmlybSA9IGZ1bmN0aW9uKG5keCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBleGlzdGVkW25keF0sXHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZSA9IGZpbGVzW2ldLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhc3QgPSBuZHggPT0gZXhpc3RlZC5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmbS5jb25maXJtKHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZm0uaTE4bignbW92ZUZpbGVzJyksXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogZm0uaTE4bihbJ2VyckV4aXN0cycsIGZpbGUubmFtZSwgJ2NvbmZpcm1SZXBsJ10pLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vYWxsOiAhbGFzdCxcclxuICAgICAgICAgICAgICAgICAgICBhY2NlcHQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdidG5ZZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oYWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhbGFzdCAmJiAhYWxsID8gY29uZmlybSgrK25keClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVwbG9hZENvbmYoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnYnRuTm8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oYWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGV4aXN0ZWQubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChuZHggPCBpLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/vv73vv73vv73vv73vv73vv70g77+977+977+9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1YmxpY2F0ZUluZGV4ZXMucHVzaChleGlzdGVkW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v77+977+977+977+977+977+9IO+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/vVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1YmxpY2F0ZUluZGV4ZXMucHVzaChleGlzdGVkW25keF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICFsYXN0ICYmICFhbGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGNvbmZpcm0oKytuZHgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1cGxvYWRDb25mKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ2J0bkNhbmNlbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQyLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBpbnRlcnNlY3QgPSBmdW5jdGlvbihmaWxlcywgbmFtZXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXQgPSBbXSxcclxuICAgICAgICAgICAgICAgICAgICBpID0gZmlsZXMubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICAkLmluQXJyYXkoZmlsZXNbaV0ubmFtZSwgbmFtZXMpICE9PSAtMSAmJiByZXQudW5zaGlmdChpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHVwbG9hZENvbmYgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGVycm9yXHJcbiAgICAgICAgICAgICAgICAgICAgPyBmbS5kaWFsb2coJzxkaXYgY2xhc3M9XCJlcnJvclwiPjxzcGFuPicgKyBlcnJUZXh0ICsgJzwvc3Bhbj48L2Rpdj48L2Rpdj4nLCBvcHRzKVxyXG4gICAgICAgICAgICAgICAgICAgIDogZm0udXBsb2FkKGRhdGEsIG5vdFVwbG9hZCwgZHVibGljYXRlSW5kZXhlcyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHVwbG9hZCA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGRpYWxvZy5lbGZpbmRlcmRpYWxvZygnY2xvc2UnKTtcclxuICAgICAgICAgICAgICAgIGZtLnVwbG9hZChkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkZnJkMiA9ICQuRGVmZXJyZWQoKVxyXG4gICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvciAmJiBmbS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbS5lbmFibGUoKTtcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBkZnJkLFxyXG4gICAgICAgICAgICBkaWFsb2csXHJcbiAgICAgICAgICAgIGlucHV0LFxyXG4gICAgICAgICAgICBidXR0b24sXHJcbiAgICAgICAgICAgIGRyb3Bib3g7XHJcblxyXG4gICAgICAgIG9wdHMuYnV0dG9uc1tmbS5pMThuKCdidG5DbG9zZScpXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLmVsZmluZGVyY3J5cHR4ZGlhbG9nKCdjbG9zZScpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICQuRGVmZXJyZWQoKS5yZWplY3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkYXRhICYmIChkYXRhLmlucHV0IHx8IGRhdGEuZmlsZXMpKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmlucHV0ICYmIGRhdGEuaW5wdXQuZmlsZXMpIHtcclxuICAgICAgICAgICAgICAgIGZpbGVzID0gZGF0YS5pbnB1dC5maWxlcztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLmZpbGVzKSB7XHJcbiAgICAgICAgICAgICAgICBmaWxlcyA9IGRhdGEuZmlsZXM7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChmaWxlcy5sZW5ndGggPiAxMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQyLnJlamVjdCgnZXJyVXBsb2FkTWF4Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGZpbGVzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IGZpbGVzW2tleV07XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGYuc2l6ZSA9PSBcInVuZGVmaW5lZFwiKSBicmVhaztcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZi5uYW1lID09IFwidW5kZWZpbmVkXCIpIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgaWYgKGYuc2l6ZSA+IDIwOTcxNTIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90VXBsb2FkLnB1c2goa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICBlcnJUZXh0ICs9ICc8Yj5cIicgKyBmLm5hbWUgKyAnXCI8L2I+OiAnICsgZm0uaTE4bignZXJyVXBsb2FkTWF4U2l6ZScpICsgJzs8YnIvPic7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmLnNpemUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdFVwbG9hZC5wdXNoKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyVGV4dCArPSAnPGI+XCInICsgZi5uYW1lICsgJ1wiPC9iPjogJyArIGZtLmkxOG4oJ2VyclVwbG9hZE1pblNpemUnKSArICc7PGJyLz4nO1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZi5uYW1lLmxlbmd0aCA+IDEwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdFVwbG9hZC5wdXNoKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyVGV4dCArPSAnPGI+XCInICsgZi5uYW1lICsgJ1wiPC9iPjogJyArIGZtLmkxOG4oJ2Vyckludk5hbWVTaXplJykgKyAnOzxici8+JztcclxuICAgICAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGYubmFtZS5tYXRjaChcIltcXC98XFxcXHxcXDp8XFwqfFxcXCJ8XFw8fFxcPnxcXCt8XFwjfFxcfF1cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RVcGxvYWQucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVyclRleHQgKz0gJzxiPlwiJyArIGYubmFtZSArICdcIjwvYj46ICcgKyBmbS5pMThuKCdlcnJJbnZTeW0nKSArICc7PGJyLz4nO1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhpc3RlZCA9IGludGVyc2VjdChmaWxlcywgY3dkRmlsZU5hbWVzKTtcclxuICAgICAgICAgICAgZXhpc3RlZC5sZW5ndGhcclxuICAgICAgICAgICAgICAgID8gY29uZmlybSgwKVxyXG4gICAgICAgICAgICAgICAgOiB1cGxvYWRDb25mKCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkZnJkID0gJC5EZWZlcnJlZCgpO1xyXG5cclxuXHJcbiAgICAgICAgaW5wdXQgPSAkKCc8aW5wdXQgdHlwZT1cImZpbGVcIiBtdWx0aXBsZT1cInRydWVcIi8+JylcclxuICAgICAgICAgICAgLmNoYW5nZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHVwbG9hZCh7IGlucHV0OiBpbnB1dFswXSB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGJ1dHRvbiA9ICQoJzxkaXYgY2xhc3M9XCJ1aS1idXR0b24gdWktd2lkZ2V0IHVpLXN0YXRlLWRlZmF1bHQgdWktY29ybmVyLWFsbCB1aS1idXR0b24tdGV4dC1vbmx5XCI+PHNwYW4gY2xhc3M9XCJ1aS1idXR0b24tdGV4dFwiPicgKyBmbS5pMThuKCdzZWxlY3RGb3JVcGxvYWQnKSArICc8L3NwYW4+PC9kaXY+JylcclxuICAgICAgICAgICAgLmFwcGVuZCgkKCc8Zm9ybS8+JykuYXBwZW5kKGlucHV0KSlcclxuICAgICAgICAgICAgLmhvdmVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLnRvZ2dsZUNsYXNzKGhvdmVyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgZGlhbG9nID0gJCgnPGRpdiBjbGFzcz1cImVsZmluZGVyLXVwbG9hZC1kaWFsb2ctd3JhcHBlclwiLz4nKVxyXG4gICAgICAgICAgICAuYXBwZW5kKGJ1dHRvbik7XHJcblxyXG4gICAgICAgIGlmIChmbS5kcmFnVXBsb2FkKSB7XHJcbiAgICAgICAgICAgIGRyb3Bib3ggPSAkKCc8ZGl2IGNsYXNzPVwidWktY29ybmVyLWFsbCBlbGZpbmRlci11cGxvYWQtZHJvcGJveFwiPicgKyBmbS5pMThuKCdkcm9wRmlsZXMnKSArICc8L2Rpdj4nKVxyXG4gICAgICAgICAgICAgICAgLnByZXBlbmRUbyhkaWFsb2cpXHJcbiAgICAgICAgICAgICAgICAuYWZ0ZXIoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci11cGxvYWQtZGlhbG9nLW9yXCI+JyArIGZtLmkxOG4oJ29yJykgKyAnPC9kaXY+JylbMF07XHJcblxyXG4gICAgICAgICAgICBkcm9wYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAkKGRyb3Bib3gpLmFkZENsYXNzKGhvdmVyKTtcclxuICAgICAgICAgICAgfSwgZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgZHJvcGJveC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgJChkcm9wYm94KS5yZW1vdmVDbGFzcyhob3Zlcik7XHJcbiAgICAgICAgICAgIH0sIGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgIGRyb3Bib3guYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB9LCBmYWxzZSk7XHJcblxyXG4gICAgICAgICAgICBkcm9wYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHVwbG9hZCh7IGZpbGVzOiBlLmRhdGFUcmFuc2Zlci5maWxlcyB9KTtcclxuICAgICAgICAgICAgfSwgZmFsc2UpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZtLmRpYWxvZyhkaWFsb2csIHtcclxuICAgICAgICAgICAgdGl0bGU6IHRoaXMudGl0bGUsXHJcbiAgICAgICAgICAgIG1vZGFsOiB0cnVlLFxyXG4gICAgICAgICAgICByZXNpemFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBkZXN0cm95T25DbG9zZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gZGZyZDtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8qKlxyXG4gKiBAY2xhc3MgZWxGaW5kZXIgY29tbWFuZCBcImRvd25sb2FkXCIuIFxyXG4gKiBEb3dubG9hZCBzZWxlY3RlZCBmaWxlcy5cclxuICogT25seSBmb3IgbmV3IGFwaVxyXG4gKlxyXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdiwgZGlvQHN0ZDQyLnJ1XHJcbiAqKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLmRvd25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXMsXHJcbiAgICAgICAgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgIGZpbHRlciA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgICAgICByZXR1cm4gJC5tYXAoc2VsZi5maWxlcyhoYXNoZXMpLCBmdW5jdGlvbihmKSB7IHJldHVybiBmLm1pbWUgPT0gJ2RpcmVjdG9yeScgPyBudWxsIDogZjsgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB0aGlzLnNob3J0Y3V0cyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHBhdHRlcm46ICdzaGlmdCtlbnRlcidcclxuICAgICAgICB9XHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsID0gdGhpcy5mbS5zZWxlY3RlZCgpLFxyXG4gICAgICAgICAgICBjbnQgPSBzZWwubGVuZ3RoO1xyXG5cclxuICAgICAgICByZXR1cm4gIXRoaXMuX2Rpc2FibGVkICYmIGNudCAmJiAgY250ID09IGZpbHRlcihzZWwpLmxlbmd0aCA/IDAgOiAtMTtcclxuICAgIH07XHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihoYXNoZXMpIHtcclxuICAgICAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBiYXNlID0gZm0ub3B0aW9ucy51cmwsXHJcbiAgICAgICAgICAgIGZpbGVzID0gZmlsdGVyKGhhc2hlcyksXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKCksXHJcbiAgICAgICAgICAgIGlmcmFtZXMgPSAnJyxcclxuICAgICAgICAgICAgaWZyYW1lID0gJycsXHJcbiAgICAgICAgICAgIHRhcmdldHMgPSAnJyxcclxuICAgICAgICAgICAgY2RhdGEgPSAnJyxcclxuICAgICAgICAgICAgaSA9IDEsXHJcbiAgICAgICAgICAgIHVybDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChmbS5vbGRBUEkpIHtcclxuICAgICAgICAgICAgZm0uZXJyb3IoJ2VyckNtZE5vU3VwcG9ydCcpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNkYXRhID0gJC5wYXJhbShmbS5vcHRpb25zLmN1c3RvbURhdGEgfHwge30pO1xyXG4gICAgICAgIGlmIChjZGF0YSkge1xyXG4gICAgICAgICAgICBjZGF0YSA9ICcmJyArIGNkYXRhO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYmFzZSArPSBiYXNlLmluZGV4T2YoJz8nKSA9PT0gLTEgPyAnPycgOiAnJic7XHJcblxyXG4gICAgICAgIC8vZm9yIChpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgLy9cdGlmcmFtZXMgKz0gJzxpZnJhbWUgY2xhc3M9XCJkb3dubG9hZGVyXCIgaWQ9XCJkb3dubG9hZGVyLScgKyBmaWxlc1tpXS5oYXNoKydcIiBzdHlsZT1cImRpc3BsYXk6bm9uZVwiIHNyYz1cIicrYmFzZSArICdjbWQ9ZmlsZSZ0YXJnZXQ9JyArIGZpbGVzW2ldLmhhc2grJyZkb3dubG9hZD0xJytjZGF0YSsnXCIvPic7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGZpbGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRhcmdldHMgKz0gZmlsZXNbaV0uaGFzaCArICcsJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGFyZ2V0cyA9IHRhcmdldHMuc3Vic3RyaW5nKHRhcmdldHMubGVuZ3RoIC0gMSwgMSk7XHJcbiAgICAgICAgdmFyIG5ld1dpbj0gd2luZG93Lm9wZW4oYmFzZSArICdjbWQ9ZG93bmxvYWQmdGFyZ2V0cz0nICsgdGFyZ2V0cyk7XHJcbiAgICAgICAgLy9pZnJhbWUgPSAnPGlmcmFtZSBjbGFzcz1cImRvd25sb2FkZXJcIiBpZD1cImRvd25sb2FkZXItJyArICdjcnlwdHgnICsgJ1wiIHN0eWxlPVwiZGlzcGxheTpub25lXCIgc3JjPVwiJyArIGJhc2UgKyAnY21kPWRvd25sb2FkJnRhcmdldHM9JyArIHRhcmdldHMgKyAnXCIvPic7XHJcbiAgICAgICAgLy8kKGlmcmFtZSlcclxuICAgICAgICAvL1x0LmFwcGVuZFRvKCdib2R5JylcclxuICAgICAgICAvL1x0LnJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy9cdFx0ICAgICQoaWZyYW1lKS5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL1x0XHRcdFx0JCgnIycgKyAkKHRoaXMpLmF0dHIoJ2lkJykpLnJlbW92ZSgpO1xyXG4gICAgICAgIC8vXHRcdFx0fSk7XHJcbiAgICAgICAgLy9cdFx0fSwgZm0uVUEuRmlyZWZveD8gKDIwMDAwICsgKDEwMDAwICogaSkpIDogMTAwMDApOyAvLyBnaXZlIG1vemlsbGEgMjAgc2VjICsgMTAgc2VjIGZvciBlYWNoIGZpbGUgdG8gYmUgc2F2ZWRcclxuICAgICAgICAvL1x0fSk7XHJcbiAgICAgICAgZm0udHJpZ2dlcignZG93bmxvYWQnLCB7IGZpbGVzOiBmaWxlcyB9KTtcclxuICAgICAgICByZXR1cm4gZGZyZC5yZXNvbHZlKGhhc2hlcyk7XHJcbiAgICB9O1xyXG59OyIsIlwidXNlIHN0cmljdFwiOyAvKipcbiAqIEBjbGFzcyBlbEZpbmRlciBjb21tYW5kIFwiZWRpdFwiLiBcbiAqIEVkaXQgdGV4dCBmaWxlIGluIGRpYWxvZyB3aW5kb3dcbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdiwgZGlvQHN0ZDQyLnJ1XG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5lZGl0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXMsXHJcbiAgICAgICAgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgIG1pbWVzID0gZm0ucmVzKCdtaW1lcycsICd0ZXh0JykgfHwgW10sXHJcblxyXG4gICAgICAgIC8qKlxuXHRcdCAqIFJldHVybiBmaWxlcyBhY2NlcHRhYmxlIHRvIGVkaXRcblx0XHQgKlxuXHRcdCAqIEBwYXJhbSAgQXJyYXkgIGZpbGVzIGhhc2hlc1xuXHRcdCAqIEByZXR1cm4gQXJyYXlcblx0XHQgKiovXHJcbiAgICAgICAgZmlsdGVyID0gZnVuY3Rpb24oZmlsZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuICQubWFwKGZpbGVzLCBmdW5jdGlvbihmaWxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGZpbGUubWltZS5pbmRleE9mKCd0ZXh0LycpID09PSAwIHx8ICQuaW5BcnJheShmaWxlLm1pbWUsIG1pbWVzKSAhPT0gLTEpXHJcbiAgICAgICAgICAgICAgICAgICAgJiYgZmlsZS5taW1lLmluZGV4T2YoJ3RleHQvcnRmJylcclxuICAgICAgICAgICAgICAgICAgICAmJiAoIXNlbGYub25seU1pbWVzLmxlbmd0aCB8fCAkLmluQXJyYXkoZmlsZS5taW1lLCBzZWxmLm9ubHlNaW1lcykgIT09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgICYmIGZpbGUucmVhZCAmJiBmaWxlLndyaXRlID8gZmlsZSA6IG51bGw7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxuXHRcdCAqIE9wZW4gZGlhbG9nIHdpdGggdGV4dGFyZWEgdG8gZWRpdCBmaWxlXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIFN0cmluZyAgaWQgICAgICAgZGlhbG9nIGlkXG5cdFx0ICogQHBhcmFtICBPYmplY3QgIGZpbGUgICAgIGZpbGUgb2JqZWN0XG5cdFx0ICogQHBhcmFtICBTdHJpbmcgIGNvbnRlbnQgIGZpbGUgY29udGVudFxuXHRcdCAqIEByZXR1cm4gJC5EZWZlcnJlZFxuXHRcdCAqKi9cclxuICAgICAgICBkaWFsb2cgPSBmdW5jdGlvbihpZCwgZmlsZSwgY29udGVudCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGRmcmQgPSAkLkRlZmVycmVkKCksXHJcbiAgICAgICAgICAgICAgICB0YSA9ICQoJzx0ZXh0YXJlYSBjbGFzcz1cImVsZmluZGVyLWZpbGUtZWRpdFwiIHJvd3M9XCIyMFwiIGlkPVwiJyArIGlkICsgJy10YVwiPicgKyBmbS5lc2NhcGUoY29udGVudCkgKyAnPC90ZXh0YXJlYT4nKSxcclxuICAgICAgICAgICAgICAgIHNhdmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB0YS5lZGl0b3IgJiYgdGEuZWRpdG9yLnNhdmUodGFbMF0sIHRhLmVkaXRvci5pbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGZyZC5yZXNvbHZlKHRhLmdldENvbnRlbnQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGEuZWxmaW5kZXJkaWFsb2coJ2Nsb3NlJyk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgY2FuY2VsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoKTtcclxuICAgICAgICAgICAgICAgICAgICB0YS5lbGZpbmRlcmRpYWxvZygnY2xvc2UnKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvcHRzID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBmaWxlLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHNlbGYub3B0aW9ucy5kaWFsb2dXaWR0aCB8fCA0NTAsXHJcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uczoge30sXHJcbiAgICAgICAgICAgICAgICAgICAgY2xvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YS5lZGl0b3IgJiYgdGEuZWRpdG9yLmNsb3NlKHRhWzBdLCB0YS5lZGl0b3IuaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmVsZmluZGVyZGlhbG9nKCdkZXN0cm95Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBvcGVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm0uZGlzYWJsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YS5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YVswXS5zZXRTZWxlY3Rpb25SYW5nZSAmJiB0YVswXS5zZXRTZWxlY3Rpb25SYW5nZSgwLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGEuZWRpdG9yICYmIHRhLmVkaXRvci5sb2FkKHRhWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRhLmdldENvbnRlbnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YS52YWwoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgJC5lYWNoKHNlbGYub3B0aW9ucy5lZGl0b3JzIHx8IFtdLCBmdW5jdGlvbihpLCBlZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkoZmlsZS5taW1lLCBlZGl0b3IubWltZXMgfHwgW10pICE9PSAtMVxyXG4gICAgICAgICAgICAgICAgICAgICYmIHR5cGVvZiBlZGl0b3IubG9hZCA9PSAnZnVuY3Rpb24nXHJcbiAgICAgICAgICAgICAgICAgICAgJiYgdHlwZW9mIGVkaXRvci5zYXZlID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICB0YS5lZGl0b3IgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWQ6IGVkaXRvci5sb2FkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzYXZlOiBlZGl0b3Iuc2F2ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2U6IHR5cGVvZiBlZGl0b3IuY2xvc2UgPT0gJ2Z1bmN0aW9uJyA/IGVkaXRvci5jbG9zZSA6IGZ1bmN0aW9uKCkge30sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlOiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCF0YS5lZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgIHRhLmtleWRvd24oZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2RlID0gZS5rZXlDb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUgPT0gOSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluc2VydCB0YWIgb24gdGFiIHByZXNzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldFNlbGVjdGlvblJhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHRoaXMuc2VsZWN0aW9uU3RhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWUuc3Vic3RyKDAsIHN0YXJ0KSArIFwiXFx0XCIgKyB2YWx1ZS5zdWJzdHIodGhpcy5zZWxlY3Rpb25FbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgKz0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uUmFuZ2Uoc3RhcnQsIHN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xvc2Ugb24gY3RybCt3L3FcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUgPT0gODEgfHwgY29kZSA9PSA4Nykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUgPT0gODMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb3B0cy5idXR0b25zW2ZtLmkxOG4oJ1NhdmUnKV0gPSBzYXZlO1xyXG4gICAgICAgICAgICBvcHRzLmJ1dHRvbnNbZm0uaTE4bignQ2FuY2VsJyldID0gY2FuY2VsO1xyXG4gICAgICAgICAgICBmbS5kaWFsb2codGEsIG9wdHMpLmF0dHIoJ2lkJywgaWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5wcm9taXNlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXG5cdFx0ICogR2V0IGZpbGUgY29udGVudCBhbmRcblx0XHQgKiBvcGVuIGRpYWxvZyB3aXRoIHRleHRhcmVhIHRvIGVkaXQgZmlsZSBjb250ZW50XG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIFN0cmluZyAgZmlsZSBoYXNoXG5cdFx0ICogQHJldHVybiBqUXVlcnkuRGVmZXJyZWRcblx0XHQgKiovXHJcbiAgICAgICAgZWRpdCA9IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgICAgICAgdmFyIGhhc2ggPSBmaWxlLmhhc2gsXHJcbiAgICAgICAgICAgICAgICBvcHRzID0gZm0ub3B0aW9ucyxcclxuICAgICAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKCksXHJcbiAgICAgICAgICAgICAgICBkYXRhID0geyBjbWQ6ICdmaWxlJywgdGFyZ2V0OiBoYXNoIH0sXHJcbiAgICAgICAgICAgICAgICB1cmwgPSBmbS51cmwoaGFzaCkgfHwgZm0ub3B0aW9ucy51cmwsXHJcbiAgICAgICAgICAgICAgICBpZCA9ICdlZGl0LScgKyBmbS5uYW1lc3BhY2UgKyAnLScgKyBmaWxlLmhhc2gsXHJcbiAgICAgICAgICAgICAgICBkID0gZm0uZ2V0VUkoKS5maW5kKCcjJyArIGlkKSxcclxuICAgICAgICAgICAgICAgIGVycm9yO1xyXG5cclxuXHJcbiAgICAgICAgICAgIGlmIChkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgZC5lbGZpbmRlcmRpYWxvZygndG9Ub3AnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkZnJkLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFmaWxlLnJlYWQgfHwgIWZpbGUud3JpdGUpIHtcclxuICAgICAgICAgICAgICAgIGVycm9yID0gWydlcnJPcGVuJywgZmlsZS5uYW1lLCAnZXJyUGVybSddO1xyXG4gICAgICAgICAgICAgICAgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdnZXQnLCB0YXJnZXQ6IGhhc2ggfSxcclxuICAgICAgICAgICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ29wZW5maWxlJywgY250OiAxIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3luY09uRmFpbDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaWFsb2coaWQsIGZpbGUsIGRhdGEuY29udGVudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oY29udGVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHsgdHlwZTogJ3Bvc3QnIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZDogJ3B1dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGhhc2gsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmeTogeyB0eXBlOiAnc2F2ZScsIGNudDogMSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeW5jT25GYWlsOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZnJkLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuY2hhbmdlZCAmJiBkYXRhLmNoYW5nZWQubGVuZ3RoICYmIGZtLmNoYW5nZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5wcm9taXNlKCk7XHJcbiAgICAgICAgfTtcclxuXHJcblxyXG4gICAgdGhpcy5zaG9ydGN1dHMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwYXR0ZXJuOiAnY3RybCtlJ1xyXG4gICAgICAgIH1cclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5pbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5vbmx5TWltZXMgPSB0aGlzLm9wdGlvbnMubWltZXMgfHwgW107XHJcbiAgICB9O1xyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKHNlbCkge1xyXG4gICAgICAgIHZhciBzZWwgPSB0aGlzLmZpbGVzKHNlbCksXHJcbiAgICAgICAgICAgIGNudCA9IHNlbC5sZW5ndGg7XHJcblxyXG4gICAgICAgIHJldHVybiAhdGhpcy5fZGlzYWJsZWQgJiYgY250ICYmIGZpbHRlcihzZWwpLmxlbmd0aCA9PSBjbnQgPyAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oaGFzaGVzKSB7XHJcbiAgICAgICAgdmFyIGZpbGVzID0gZmlsdGVyKHRoaXMuZmlsZXMoaGFzaGVzKSksXHJcbiAgICAgICAgICAgIGxpc3QgPSBbXSxcclxuICAgICAgICAgICAgZmlsZTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJC5EZWZlcnJlZCgpLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgd2hpbGUgKChmaWxlID0gZmlsZXMuc2hpZnQoKSkpIHtcclxuICAgICAgICAgICAgbGlzdC5wdXNoKGVkaXQoZmlsZSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGxpc3QubGVuZ3RoXHJcbiAgICAgICAgICAgID8gJC53aGVuLmFwcGx5KG51bGwsIGxpc3QpXHJcbiAgICAgICAgICAgIDogJC5EZWZlcnJlZCgpLnJlamVjdCgpO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjsgLyoqXG4gKiBAY2xhc3MgIGVsRmluZGVyIGNvbW1hbmQgXCJxdWlja2xvb2tcIlxuICogRmFzdCBwcmV2aWV3IGZvciBzb21lIGZpbGVzIHR5cGVzXG4gKlxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLnF1aWNrbG9vayA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzLFxyXG4gICAgICAgIGZtID0gc2VsZi5mbSxcclxuICAgICAgICAvKipcblx0XHQgKiB3aW5kb3cgY2xvc2VkIHN0YXRlXG5cdFx0ICpcblx0XHQgKiBAdHlwZSBOdW1iZXJcblx0XHQgKiovXHJcbiAgICAgICAgY2xvc2VkID0gMCxcclxuICAgICAgICAvKipcblx0XHQgKiB3aW5kb3cgYW5pbWF0ZWQgc3RhdGVcblx0XHQgKlxuXHRcdCAqIEB0eXBlIE51bWJlclxuXHRcdCAqKi9cclxuICAgICAgICBhbmltYXRlZCA9IDEsXHJcbiAgICAgICAgLyoqXG5cdFx0ICogd2luZG93IG9wZW5lZCBzdGF0ZVxuXHRcdCAqXG5cdFx0ICogQHR5cGUgTnVtYmVyXG5cdFx0ICoqL1xyXG4gICAgICAgIG9wZW5lZCA9IDIsXHJcbiAgICAgICAgLyoqXG5cdFx0ICogd2luZG93IHN0YXRlXG5cdFx0ICpcblx0XHQgKiBAdHlwZSBOdW1iZXJcblx0XHQgKiovXHJcbiAgICAgICAgc3RhdGUgPSBjbG9zZWQsXHJcbiAgICAgICAgLyoqXG5cdFx0ICogbmV4dC9wcmV2IGV2ZW50IG5hbWUgKHJlcXVpZWQgdG8gY3dkIGNhdGNoIGl0KVxuXHRcdCAqXG5cdFx0ICogQHR5cGUgTnVtYmVyXG5cdFx0ICoqL1xyXG4gICAgICAgIC8vIGtleWRvd24gICAgPSBmbS5VQS5GaXJlZm94IHx8IGZtLlVBLk9wZXJhID8gJ2tleXByZXNzJyA6ICdrZXlkb3duJyxcclxuICAgICAgICAvKipcblx0XHQgKiBuYXZiYXIgaWNvbiBjbGFzc1xuXHRcdCAqXG5cdFx0ICogQHR5cGUgTnVtYmVyXG5cdFx0ICoqL1xyXG4gICAgICAgIG5hdmljb24gPSAnZWxmaW5kZXItcXVpY2tsb29rLW5hdmJhci1pY29uJyxcclxuICAgICAgICAvKipcblx0XHQgKiBuYXZiYXIgXCJmdWxsc2NyZWVuXCIgaWNvbiBjbGFzc1xuXHRcdCAqXG5cdFx0ICogQHR5cGUgTnVtYmVyXG5cdFx0ICoqL1xyXG4gICAgICAgIGZ1bGxzY3JlZW4gPSAnZWxmaW5kZXItcXVpY2tsb29rLWZ1bGxzY3JlZW4nLFxyXG4gICAgICAgIC8qKlxuXHRcdCAqIFRyaWdlciBrZXlkb3duL2tleXByZXNzIGV2ZW50IHdpdGggbGVmdC9yaWdodCBhcnJvdyBrZXkgY29kZVxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBOdW1iZXIgIGxlZnQvcmlnaHQgYXJyb3cga2V5IGNvZGVcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiovXHJcbiAgICAgICAgbmF2dHJpZ2dlciA9IGZ1bmN0aW9uKGNvZGUpIHtcclxuICAgICAgICAgICAgJChkb2N1bWVudCkudHJpZ2dlcigkLkV2ZW50KCdrZXlkb3duJywgeyBrZXlDb2RlOiBjb2RlLCBjdHJsS2V5OiBmYWxzZSwgc2hpZnRLZXk6IGZhbHNlLCBhbHRLZXk6IGZhbHNlLCBtZXRhS2V5OiBmYWxzZSB9KSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvKipcblx0XHQgKiBSZXR1cm4gY3NzIGZvciBjbG9zZWQgd2luZG93XG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIGpRdWVyeSAgZmlsZSBub2RlIGluIGN3ZFxuXHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdCAqKi9cclxuICAgICAgICBjbG9zZWRDc3MgPSBmdW5jdGlvbihub2RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLFxyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDIwLCAvL25vZGUud2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogZm0udmlldyA9PSAnbGlzdCcgPyAxIDogMjAsXHJcbiAgICAgICAgICAgICAgICB0b3A6IG5vZGUub2Zmc2V0KCkudG9wICsgJ3B4JyxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IG5vZGUub2Zmc2V0KCkubGVmdCArICdweCdcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8qKlxuXHRcdCAqIFJldHVybiBjc3MgZm9yIG9wZW5lZCB3aW5kb3dcblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdCAqKi9cclxuICAgICAgICBvcGVuZWRDc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHdpbiA9ICQod2luZG93KTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXHJcbiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcclxuICAgICAgICAgICAgICAgIHRvcDogcGFyc2VJbnQoKHdpbi5oZWlnaHQoKSAtIGhlaWdodCkgLyAyICsgd2luLnNjcm9sbFRvcCgpKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHBhcnNlSW50KCh3aW4ud2lkdGgoKSAtIHdpZHRoKSAvIDIgKyB3aW4uc2Nyb2xsTGVmdCgpKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHN1cHBvcnQgPSBmdW5jdGlvbihjb2RlYykge1xyXG4gICAgICAgICAgICB2YXIgbWVkaWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGNvZGVjLnN1YnN0cigwLCBjb2RlYy5pbmRleE9mKCcvJykpKSxcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBtZWRpYS5jYW5QbGF5VHlwZSAmJiBtZWRpYS5jYW5QbGF5VHlwZShjb2RlYyk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAmJiB2YWx1ZSAhPT0gJycgJiYgdmFsdWUgIT0gJ25vJztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcblx0XHQgKiBPcGVuZWQgd2luZG93IHdpZHRoIChmcm9tIGNvbmZpZylcblx0XHQgKlxuXHRcdCAqIEB0eXBlIE51bWJlclxuXHRcdCAqKi9cclxuICAgICAgICB3aWR0aCxcclxuICAgICAgICAvKipcblx0XHQgKiBPcGVuZWQgd2luZG93IGhlaWdodCAoZnJvbSBjb25maWcpXG5cdFx0ICpcblx0XHQgKiBAdHlwZSBOdW1iZXJcblx0XHQgKiovXHJcbiAgICAgICAgaGVpZ2h0LFxyXG4gICAgICAgIC8qKlxuXHRcdCAqIGVsRmluZGVyIG5vZGVcblx0XHQgKlxuXHRcdCAqIEB0eXBlIGpRdWVyeVxuXHRcdCAqKi9cclxuICAgICAgICBwYXJlbnQsXHJcbiAgICAgICAgLyoqXG5cdFx0ICogZWxGaW5kZXIgY3VycmVudCBkaXJlY3Rvcnkgbm9kZVxuXHRcdCAqXG5cdFx0ICogQHR5cGUgalF1ZXJ5XG5cdFx0ICoqL1xyXG4gICAgICAgIGN3ZCxcclxuICAgICAgICB0aXRsZSA9ICQoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1xdWlja2xvb2stdGl0bGVcIi8+JyksXHJcbiAgICAgICAgaWNvbiA9ICQoJzxkaXYvPicpLFxyXG4gICAgICAgIGluZm8gPSAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItcXVpY2tsb29rLWluZm9cIi8+JyksIC8vLmhpZGUoKSxcclxuICAgICAgICBmc2ljb24gPSAkKCc8ZGl2IGNsYXNzPVwiJyArIG5hdmljb24gKyAnICcgKyBuYXZpY29uICsgJy1mdWxsc2NyZWVuXCIvPicpXHJcbiAgICAgICAgICAgIC5tb3VzZWRvd24oZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHdpbiA9IHNlbGYud2luZG93LFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bGwgPSB3aW4uaXMoJy4nICsgZnVsbHNjcmVlbiksXHJcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsID0gJ3Njcm9sbC4nICsgZm0ubmFtZXNwYWNlLFxyXG4gICAgICAgICAgICAgICAgICAgICR3aW5kb3cgPSAkKHdpbmRvdyk7XHJcblxyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbi5jc3Mod2luLmRhdGEoJ3Bvc2l0aW9uJykpLnVuYmluZCgnbW91c2Vtb3ZlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHdpbmRvdy51bmJpbmQoc2Nyb2xsKS50cmlnZ2VyKHNlbGYucmVzaXplKS51bmJpbmQoc2VsZi5yZXNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5hdmJhci51bmJpbmQoJ21vdXNlZW50ZXInKS51bmJpbmQoJ21vdXNlbW92ZScpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW4uZGF0YSgncG9zaXRpb24nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiB3aW4uY3NzKCdsZWZ0JyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHdpbi5jc3MoJ3RvcCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHdpbi53aWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiB3aW4uaGVpZ2h0KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogJzEwMCUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAnMTAwJSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICQod2luZG93KS5iaW5kKHNjcm9sbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW4uY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBwYXJzZUludCgkKHdpbmRvdykuc2Nyb2xsTGVmdCgpKSArICdweCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBwYXJzZUludCgkKHdpbmRvdykuc2Nyb2xsVG9wKCkpICsgJ3B4J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5iaW5kKHNlbGYucmVzaXplLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnByZXZpZXcudHJpZ2dlcignY2hhbmdlc2l6ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJpZ2dlcihzY3JvbGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50cmlnZ2VyKHNlbGYucmVzaXplKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgd2luLmJpbmQoJ21vdXNlbW92ZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmJhci5zdG9wKHRydWUsIHRydWUpLnNob3coKS5kZWxheSgzMDAwKS5mYWRlT3V0KCdzbG93Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tb3VzZW1vdmUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbmF2YmFyLm1vdXNlZW50ZXIoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXZiYXIuc3RvcCh0cnVlLCB0cnVlKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tb3VzZW1vdmUoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBuYXZiYXIuYXR0cignc3R5bGUnLCAnJykuZHJhZ2dhYmxlKGZ1bGwgPyAnZGVzdHJveScgOiB7fSk7XHJcbiAgICAgICAgICAgICAgICB3aW4udG9nZ2xlQ2xhc3MoZnVsbHNjcmVlbik7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKG5hdmljb24gKyAnLWZ1bGxzY3JlZW4tb2ZmJyk7XHJcbiAgICAgICAgICAgICAgICAkLmZuLnJlc2l6YWJsZSAmJiBwYXJlbnQuYWRkKHdpbikucmVzaXphYmxlKGZ1bGwgPyAnZW5hYmxlJyA6ICdkaXNhYmxlJykucmVtb3ZlQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcbiAgICAgICAgICAgIH0pLFxyXG5cclxuICAgICAgICBuYXZiYXIgPSAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItcXVpY2tsb29rLW5hdmJhclwiLz4nKVxyXG4gICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCInICsgbmF2aWNvbiArICcgJyArIG5hdmljb24gKyAnLXByZXZcIi8+JykubW91c2Vkb3duKGZ1bmN0aW9uKCkgeyBuYXZ0cmlnZ2VyKDM3KTsgfSkpXHJcbiAgICAgICAgICAgIC5hcHBlbmQoZnNpY29uKVxyXG4gICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCInICsgbmF2aWNvbiArICcgJyArIG5hdmljb24gKyAnLW5leHRcIi8+JykubW91c2Vkb3duKGZ1bmN0aW9uKCkgeyBuYXZ0cmlnZ2VyKDM5KTsgfSkpXHJcbiAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1xdWlja2xvb2stbmF2YmFyLXNlcGFyYXRvclwiLz4nKVxyXG4gICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXYgY2xhc3M9XCInICsgbmF2aWNvbiArICcgJyArIG5hdmljb24gKyAnLWNsb3NlXCIvPicpLm1vdXNlZG93bihmdW5jdGlvbigpIHsgc2VsZi53aW5kb3cudHJpZ2dlcignY2xvc2UnKTsgfSkpO1xyXG5cclxuICAgIHRoaXMucmVzaXplID0gJ3Jlc2l6ZS4nICsgZm0ubmFtZXNwYWNlO1xyXG4gICAgdGhpcy5pbmZvID0gJCgnPGRpdiBjbGFzcz1cImVsZmluZGVyLXF1aWNrbG9vay1pbmZvLXdyYXBwZXJcIi8+JylcclxuICAgICAgICAuYXBwZW5kKGljb24pXHJcbiAgICAgICAgLmFwcGVuZChpbmZvKTtcclxuXHJcbiAgICB0aGlzLnByZXZpZXcgPSAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItcXVpY2tsb29rLXByZXZpZXcgdWktaGVscGVyLWNsZWFyZml4XCIvPicpXHJcbiAgICAgICAgLy8gY2xlYW4gaW5mby9pY29uXHJcbiAgICAgICAgLmJpbmQoJ2NoYW5nZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgc2VsZi5pbmZvLmF0dHIoJ3N0eWxlJywgJycpLmhpZGUoKTtcclxuICAgICAgICAgICAgaWNvbi5yZW1vdmVBdHRyKCdjbGFzcycpLmF0dHIoJ3N0eWxlJywgJycpO1xyXG4gICAgICAgICAgICBpbmZvLmh0bWwoJycpO1xyXG5cclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIHVwZGF0ZSBpbmZvL2ljb25cclxuICAgICAgICAuYmluZCgndXBkYXRlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgZm0gPSBzZWxmLmZtLFxyXG4gICAgICAgICAgICAgICAgcHJldmlldyA9IHNlbGYucHJldmlldyxcclxuICAgICAgICAgICAgICAgIGZpbGUgPSBlLmZpbGUsXHJcbiAgICAgICAgICAgICAgICB0cGwgPSAnPGRpdiBjbGFzcz1cImVsZmluZGVyLXF1aWNrbG9vay1pbmZvLWRhdGFcIj57dmFsdWV9PC9kaXY+JyxcclxuICAgICAgICAgICAgICAgIHRtYjtcclxuXHJcbiAgICAgICAgICAgIGlmIChmaWxlKSB7XHJcbiAgICAgICAgICAgICAgICAhZmlsZS5yZWFkICYmIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLndpbmRvdy5kYXRhKCdoYXNoJywgZmlsZS5oYXNoKTtcclxuICAgICAgICAgICAgICAgIHNlbGYucHJldmlldy51bmJpbmQoJ2NoYW5nZXNpemUnKS50cmlnZ2VyKCdjaGFuZ2UnKS5jaGlsZHJlbigpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGl0bGUuaHRtbChmbS5lc2NhcGUoZmlsZS5uYW1lKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaW5mby5odG1sKFxyXG4gICAgICAgICAgICAgICAgICAgIHRwbC5yZXBsYWNlKC9cXHt2YWx1ZVxcfS8sIGZpbGUubmFtZSlcclxuICAgICAgICAgICAgICAgICAgICArIHRwbC5yZXBsYWNlKC9cXHt2YWx1ZVxcfS8sIGZtLm1pbWUya2luZChmaWxlKSlcclxuICAgICAgICAgICAgICAgICAgICArIChmaWxlLm1pbWUgPT0gJ2RpcmVjdG9yeScgPyAnJyA6IHRwbC5yZXBsYWNlKC9cXHt2YWx1ZVxcfS8sIGZtLmZvcm1hdFNpemUoZmlsZS5zaXplKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgKyB0cGwucmVwbGFjZSgvXFx7dmFsdWVcXH0vLCBmbS5pMThuKCdtb2RpZnknKSArICc6ICcgKyBmbS5mb3JtYXREYXRlKGZpbGUpKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGljb24uYWRkQ2xhc3MoJ2VsZmluZGVyLWN3ZC1pY29uIHVpLWNvcm5lci1hbGwgJyArIGZtLm1pbWUyY2xhc3MoZmlsZS5taW1lKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUudG1iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnPGltZy8+JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGUoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8oc2VsZi5wcmV2aWV3KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAubG9hZChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb24uY3NzKCdiYWNrZ3JvdW5kJywgJ3VybChcIicgKyB0bWIgKyAnXCIpIGNlbnRlciBjZW50ZXIgbm8tcmVwZWF0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignc3JjJywgKHRtYiA9IGZtLnRtYihmaWxlLmhhc2gpKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLmluZm8uZGVsYXkoMTAwKS5mYWRlSW4oMTApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICB0aGlzLndpbmRvdyA9ICQoJzxkaXYgY2xhc3M9XCJ1aS1oZWxwZXItcmVzZXQgdWktd2lkZ2V0IGVsZmluZGVyLXF1aWNrbG9va1wiIHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGVcIi8+JylcclxuICAgICAgICAuY2xpY2soZnVuY3Rpb24oZSkgeyBlLnN0b3BQcm9wYWdhdGlvbigpOyB9KVxyXG4gICAgICAgIC5hcHBlbmQoXHJcbiAgICAgICAgICAgICQoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1xdWlja2xvb2stdGl0bGViYXJcIi8+JylcclxuICAgICAgICAgICAgLmFwcGVuZCh0aXRsZSlcclxuICAgICAgICAgICAgLmFwcGVuZCgkKCc8c3BhbiBjbGFzcz1cInVpLWljb24gdWktaWNvbi1jaXJjbGUtY2xvc2VcIi8+JykubW91c2Vkb3duKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLndpbmRvdy50cmlnZ2VyKCdjbG9zZScpO1xyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICApXHJcbiAgICAgICAgLmFwcGVuZCh0aGlzLnByZXZpZXcuYWRkKG5hdmJhcikpXHJcbiAgICAgICAgLmFwcGVuZChzZWxmLmluZm8uaGlkZSgpKVxyXG4gICAgICAgIC5kcmFnZ2FibGUoeyBoYW5kbGU6ICdkaXYuZWxmaW5kZXItcXVpY2tsb29rLXRpdGxlYmFyJyB9KVxyXG4gICAgICAgIC5iaW5kKCdvcGVuJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgd2luID0gc2VsZi53aW5kb3csXHJcbiAgICAgICAgICAgICAgICBmaWxlID0gc2VsZi52YWx1ZSxcclxuICAgICAgICAgICAgICAgIG5vZGU7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2VsZi5jbG9zZWQoKSAmJiBmaWxlICYmIChub2RlID0gY3dkLmZpbmQoJyMnICsgZmlsZS5oYXNoKSkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBuYXZiYXIuYXR0cignc3R5bGUnLCAnJyk7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IGFuaW1hdGVkO1xyXG4gICAgICAgICAgICAgICAgbm9kZS50cmlnZ2VyKCdzY3JvbGx0b3ZpZXcnKTtcclxuICAgICAgICAgICAgICAgIHdpbi5jc3MoY2xvc2VkQ3NzKG5vZGUpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zaG93KClcclxuICAgICAgICAgICAgICAgICAgICAuYW5pbWF0ZShvcGVuZWRDc3MoKSwgNTUwLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBvcGVuZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlKDEsIHNlbGYudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuYmluZCgnY2xvc2UnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciB3aW4gPSBzZWxmLndpbmRvdyxcclxuICAgICAgICAgICAgICAgIHByZXZpZXcgPSBzZWxmLnByZXZpZXcudHJpZ2dlcignY2hhbmdlJyksXHJcbiAgICAgICAgICAgICAgICBmaWxlID0gc2VsZi52YWx1ZSxcclxuICAgICAgICAgICAgICAgIG5vZGUgPSBjd2QuZmluZCgnIycgKyB3aW4uZGF0YSgnaGFzaCcpKSxcclxuICAgICAgICAgICAgICAgIGNsb3NlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBjbG9zZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3LmNoaWxkcmVuKCkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi51cGRhdGUoMCwgc2VsZi52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzZWxmLm9wZW5lZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IGFuaW1hdGVkO1xyXG4gICAgICAgICAgICAgICAgd2luLmlzKCcuJyArIGZ1bGxzY3JlZW4pICYmIGZzaWNvbi5tb3VzZWRvd24oKTtcclxuICAgICAgICAgICAgICAgIG5vZGUubGVuZ3RoXHJcbiAgICAgICAgICAgICAgICAgICAgPyB3aW4uYW5pbWF0ZShjbG9zZWRDc3Mobm9kZSksIDUwMCwgY2xvc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgOiBjbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgLyoqXG5cdCAqIFRoaXMgY29tbWFuZCBjYW5ub3QgYmUgZGlzYWJsZSBieSBiYWNrZW5kXG5cdCAqXG5cdCAqIEB0eXBlIEJvb2xlYW5cblx0ICoqL1xyXG4gICAgdGhpcy5hbHdheXNFbmFibGVkID0gdHJ1ZTtcclxuXHJcbiAgICAvKipcblx0ICogU2VsZWN0ZWQgZmlsZVxuXHQgKlxuXHQgKiBAdHlwZSBPYmplY3Rcblx0ICoqL1xyXG4gICAgdGhpcy52YWx1ZSA9IG51bGw7XHJcblxyXG4gICAgdGhpcy5oYW5kbGVycyA9IHtcclxuICAgICAgICAvLyBzYXZlIHNlbGVjdGVkIGZpbGVcclxuICAgICAgICBzZWxlY3Q6IGZ1bmN0aW9uKCkgeyB0aGlzLnVwZGF0ZSh2b2lkKDApLCB0aGlzLmZtLnNlbGVjdGVkRmlsZXMoKVswXSk7IH0sXHJcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgeyBzZWxmLndpbmRvdy5pcygnOnZpc2libGUnKSAmJiBzZWxmLndpbmRvdy5kYXRhKCdoYXNoJywgJycpLnRyaWdnZXIoJ2Nsb3NlJyk7IH0sXHJcbiAgICAgICAgJ3NlYXJjaHNob3cgc2VhcmNoaGlkZSc6IGZ1bmN0aW9uKCkgeyB0aGlzLm9wZW5lZCgpICYmIHRoaXMud2luZG93LnRyaWdnZXIoJ2Nsb3NlJyk7IH1cclxuICAgIH07XHJcbiAgICB0aGlzLnNob3J0Y3V0cyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHBhdHRlcm46ICdzcGFjZSdcclxuICAgICAgICB9XHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMuc3VwcG9ydCA9IHtcclxuICAgICAgICBhdWRpbzoge1xyXG4gICAgICAgICAgICBvZ2c6IHN1cHBvcnQoJ2F1ZGlvL29nZzsgY29kZWNzPVwidm9yYmlzXCInKSxcclxuICAgICAgICAgICAgbXAzOiBzdXBwb3J0KCdhdWRpby9tcGVnOycpLFxyXG4gICAgICAgICAgICB3YXY6IHN1cHBvcnQoJ2F1ZGlvL3dhdjsgY29kZWNzPVwiMVwiJyksXHJcbiAgICAgICAgICAgIG00YTogc3VwcG9ydCgnYXVkaW8veC1tNGE7JykgfHwgc3VwcG9ydCgnYXVkaW8vYWFjOycpXHJcbiAgICAgICAgfSxcclxuICAgICAgICB2aWRlbzoge1xyXG4gICAgICAgICAgICBvZ2c6IHN1cHBvcnQoJ3ZpZGVvL29nZzsgY29kZWNzPVwidGhlb3JhXCInKSxcclxuICAgICAgICAgICAgd2VibTogc3VwcG9ydCgndmlkZW8vd2VibTsgY29kZWNzPVwidnA4LCB2b3JiaXNcIicpLFxyXG4gICAgICAgICAgICBtcDQ6IHN1cHBvcnQoJ3ZpZGVvL21wNDsgY29kZWNzPVwiYXZjMS40MkUwMUVcIicpIHx8IHN1cHBvcnQoJ3ZpZGVvL21wNDsgY29kZWNzPVwiYXZjMS40MkUwMUUsIG1wNGEuNDAuMlwiJylcclxuICAgICAgICB9XHJcbiAgICB9OyAvKipcblx0ICogUmV0dXJuIHRydWUgaWYgcXVpY2tMb29jayB3aW5kb3cgaXMgdmlzaWJsZSBhbmQgbm90IGFuaW1hdGVkXG5cdCAqXG5cdCAqIEByZXR1cm4gQm9vbGVhblxuXHQgKiovXHJcbiAgICB0aGlzLmNsb3NlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBzdGF0ZSA9PSBjbG9zZWQ7XHJcbiAgICB9OyAvKipcblx0ICogUmV0dXJuIHRydWUgaWYgcXVpY2tMb29jayB3aW5kb3cgaXMgaGlkZGVuXG5cdCAqXG5cdCAqIEByZXR1cm4gQm9vbGVhblxuXHQgKiovXHJcbiAgICB0aGlzLm9wZW5lZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBzdGF0ZSA9PSBvcGVuZWQ7XHJcbiAgICB9OyAvKipcblx0ICogSW5pdCBjb21tYW5kLlxuXHQgKiBBZGQgZGVmYXVsdCBwbHVnaW5zIGFuZCBpbml0IG90aGVyIHBsdWdpbnNcblx0ICpcblx0ICogQHJldHVybiBPYmplY3Rcblx0ICoqL1xyXG4gICAgdGhpcy5pbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG8gPSB0aGlzLm9wdGlvbnMsXHJcbiAgICAgICAgICAgIHdpbiA9IHRoaXMud2luZG93LFxyXG4gICAgICAgICAgICBwcmV2aWV3ID0gdGhpcy5wcmV2aWV3LFxyXG4gICAgICAgICAgICBpLFxyXG4gICAgICAgICAgICBwO1xyXG5cclxuICAgICAgICB3aWR0aCA9IG8ud2lkdGggPiAwID8gcGFyc2VJbnQoby53aWR0aCkgOiA0NTA7XHJcbiAgICAgICAgaGVpZ2h0ID0gby5oZWlnaHQgPiAwID8gcGFyc2VJbnQoby5oZWlnaHQpIDogMzAwO1xyXG5cclxuICAgICAgICBmbS5vbmUoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcGFyZW50ID0gZm0uZ2V0VUkoKTtcclxuICAgICAgICAgICAgY3dkID0gZm0uZ2V0VUkoJ2N3ZCcpO1xyXG5cclxuICAgICAgICAgICAgd2luLmFwcGVuZFRvKCdib2R5JykuekluZGV4KDEwMCArIHBhcmVudC56SW5kZXgoKSk7XHJcblxyXG4gICAgICAgICAgICAvLyBjbG9zZSB3aW5kb3cgb24gZXNjYXBlXHJcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLmtleWRvd24oZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgZS5rZXlDb2RlID09IDI3ICYmIHNlbGYub3BlbmVkKCkgJiYgd2luLnRyaWdnZXIoJ2Nsb3NlJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoJC5mbi5yZXNpemFibGUpIHtcclxuICAgICAgICAgICAgICAgIHdpbi5yZXNpemFibGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXM6ICdzZScsXHJcbiAgICAgICAgICAgICAgICAgICAgbWluV2lkdGg6IDM1MCxcclxuICAgICAgICAgICAgICAgICAgICBtaW5IZWlnaHQ6IDEyMCxcclxuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1c2UgYW5vdGhlciBldmVudCB0byBhdm9pZCByZWN1cnNpb24gaW4gZnVsbHNjcmVlbiBtb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1heSBiZSB0aGVyZSBpcyBjbGV2ZXIgc29sdXRpb24sIGJ1dCBpIGNhbnQgZmluZCBpdCA6KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3LnRyaWdnZXIoJ2NoYW5nZXNpemUnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2VsZi5jaGFuZ2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vcGVuZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYudmFsdWUgPyBwcmV2aWV3LnRyaWdnZXIoJC5FdmVudCgndXBkYXRlJywgeyBmaWxlOiBzZWxmLnZhbHVlIH0pKSA6IHdpbi50cmlnZ2VyKCdjbG9zZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICQuZWFjaChmbS5jb21tYW5kcy5xdWlja2xvb2sucGx1Z2lucyB8fCBbXSwgZnVuY3Rpb24oaSwgcGx1Z2luKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mKHBsdWdpbikgPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBwbHVnaW4oc2VsZik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcHJldmlldy5iaW5kKCd1cGRhdGUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaW5mby5zaG93KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH07XHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm0uc2VsZWN0ZWQoKS5sZW5ndGggPT0gMSA/IHN0YXRlID09IG9wZW5lZCA/IDEgOiAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5lbmFibGVkKCkgJiYgdGhpcy53aW5kb3cudHJpZ2dlcih0aGlzLm9wZW5lZCgpID8gJ2Nsb3NlJyA6ICdvcGVuJyk7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5oaWRlaW5mbyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuaW5mby5zdG9wKHRydWUpLmhpZGUoKTtcclxuICAgIH07XHJcbn07IiwiXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMucXVpY2tsb29rLnBsdWdpbnMgPSBbXHJcblxyXG4gICAgLyoqXG5cdCAqIEltYWdlcyBwcmV2aWV3IHBsdWdpblxuXHQgKlxuXHQgKiBAcGFyYW0gZWxGaW5kZXIuY29tbWFuZHMucXVpY2tsb29rXG5cdCAqKi9cclxuICAgIGZ1bmN0aW9uKHFsKSB7XHJcbiAgICAgICAgdmFyIG1pbWVzID0gWydpbWFnZS9qcGVnJywgJ2ltYWdlL3BuZycsICdpbWFnZS9naWYnXSxcclxuICAgICAgICAgICAgcHJldmlldyA9IHFsLnByZXZpZXc7XHJcblxyXG4gICAgICAgIC8vIHdoYXQga2luZCBvZiBpbWFnZXMgd2UgY2FuIGRpc3BsYXlcclxuICAgICAgICAkLmVhY2gobmF2aWdhdG9yLm1pbWVUeXBlcywgZnVuY3Rpb24oaSwgbykge1xyXG4gICAgICAgICAgICB2YXIgbWltZSA9IG8udHlwZTtcclxuXHJcbiAgICAgICAgICAgIGlmIChtaW1lLmluZGV4T2YoJ2ltYWdlLycpID09PSAwICYmICQuaW5BcnJheShtaW1lLCBtaW1lcykpIHtcclxuICAgICAgICAgICAgICAgIG1pbWVzLnB1c2gobWltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcHJldmlldy5iaW5kKCd1cGRhdGUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlID0gZS5maWxlLFxyXG4gICAgICAgICAgICAgICAgaW1nO1xyXG5cclxuICAgICAgICAgICAgaWYgKCQuaW5BcnJheShmaWxlLm1pbWUsIG1pbWVzKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgb3VyIGZpbGUgLSBzdG9wIGV2ZW50IHByb3BhZ2F0aW9uXHJcbiAgICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGltZyA9ICQoJzxpbWcvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmhpZGUoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhwcmV2aWV3KVxyXG4gICAgICAgICAgICAgICAgICAgIC5sb2FkKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aW1lb3V0IC0gYmVjYXVzZSBvZiBzdHJhbmdlIHNhZmFyaSBidWcgLSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc29tZXRpbWVzIGNhbnQgZ2V0IGltYWdlIGhlaWdodCAwX29cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9wID0gKGltZy53aWR0aCgpIC8gaW1nLmhlaWdodCgpKS50b0ZpeGVkKDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlldy5iaW5kKCdjaGFuZ2VzaXplJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwdyA9IHBhcnNlSW50KHByZXZpZXcud2lkdGgoKSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaCA9IHBhcnNlSW50KHByZXZpZXcuaGVpZ2h0KCkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGg7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvcCA8IChwdyAvIHBoKS50b0ZpeGVkKDIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gcGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ID0gTWF0aC5mbG9vcihoICogcHJvcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ID0gcHc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gTWF0aC5mbG9vcih3IC8gcHJvcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nLndpZHRoKHcpLmhlaWdodChoKS5jc3MoJ21hcmdpbi10b3AnLCBoIDwgcGggPyBNYXRoLmZsb29yKChwaCAtIGgpIC8gMikgOiAwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudHJpZ2dlcignY2hhbmdlc2l6ZScpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhpZGUgaW5mby9pY29uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxbC5oaWRlaW5mbygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zaG93IGltYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWcuZmFkZUluKDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3NyYycsIHFsLmZtLnVybChmaWxlLmhhc2gpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXG5cdCAqIEhUTUwgcHJldmlldyBwbHVnaW5cblx0ICpcblx0ICogQHBhcmFtIGVsRmluZGVyLmNvbW1hbmRzLnF1aWNrbG9va1xuXHQgKiovXHJcbiAgICBmdW5jdGlvbihxbCkge1xyXG4gICAgICAgIHZhciBtaW1lcyA9IFsndGV4dC9odG1sJywgJ2FwcGxpY2F0aW9uL3hodG1sK3htbCddLFxyXG4gICAgICAgICAgICBwcmV2aWV3ID0gcWwucHJldmlldyxcclxuICAgICAgICAgICAgZm0gPSBxbC5mbTtcclxuXHJcbiAgICAgICAgcHJldmlldy5iaW5kKCd1cGRhdGUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlID0gZS5maWxlLCBqcXhocjtcclxuXHJcbiAgICAgICAgICAgIGlmICgkLmluQXJyYXkoZmlsZS5taW1lLCBtaW1lcykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHN0b3AgbG9hZGluZyBvbiBjaGFuZ2UgZmlsZSBpZiBub3QgbG9hZGVkIHlldFxyXG4gICAgICAgICAgICAgICAgcHJldmlldy5vbmUoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGpxeGhyLnN0YXRlKCkgPT0gJ3BlbmRpbmcnICYmIGpxeGhyLnJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAganF4aHIgPSBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdnZXQnLCB0YXJnZXQ6IGZpbGUuaGFzaCwgY3VycmVudDogZmlsZS5waGFzaCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxbC5oaWRlaW5mbygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSAkKCc8aWZyYW1lIGNsYXNzPVwiZWxmaW5kZXItcXVpY2tsb29rLXByZXZpZXctaHRtbFwiLz4nKS5hcHBlbmRUbyhwcmV2aWV3KVswXS5jb250ZW50V2luZG93LmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2Mub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2Mud3JpdGUoZGF0YS5jb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXG5cdCAqIFRleHRzIHByZXZpZXcgcGx1Z2luXG5cdCAqXG5cdCAqIEBwYXJhbSBlbEZpbmRlci5jb21tYW5kcy5xdWlja2xvb2tcblx0ICoqL1xyXG4gICAgZnVuY3Rpb24ocWwpIHtcclxuICAgICAgICB2YXIgZm0gPSBxbC5mbSxcclxuICAgICAgICAgICAgbWltZXMgPSBmbS5yZXMoJ21pbWVzJywgJ3RleHQnKSxcclxuICAgICAgICAgICAgcHJldmlldyA9IHFsLnByZXZpZXc7XHJcblxyXG5cclxuICAgICAgICBwcmV2aWV3LmJpbmQoJ3VwZGF0ZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSBlLmZpbGUsXHJcbiAgICAgICAgICAgICAgICBtaW1lID0gZmlsZS5taW1lLFxyXG4gICAgICAgICAgICAgICAganF4aHI7XHJcblxyXG4gICAgICAgICAgICBpZiAobWltZS5pbmRleE9mKCd0ZXh0LycpID09PSAwIHx8ICQuaW5BcnJheShtaW1lLCBtaW1lcykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHN0b3AgbG9hZGluZyBvbiBjaGFuZ2UgZmlsZSBpZiBub3QgbG9hZGluIHlldFxyXG4gICAgICAgICAgICAgICAgcHJldmlldy5vbmUoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGpxeGhyLnN0YXRlKCkgPT0gJ3BlbmRpbmcnICYmIGpxeGhyLnJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAganF4aHIgPSBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdnZXQnLCB0YXJnZXQ6IGZpbGUuaGFzaCB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxbC5oaWRlaW5mbygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItcXVpY2tsb29rLXByZXZpZXctdGV4dC13cmFwcGVyXCI+PHByZSBjbGFzcz1cImVsZmluZGVyLXF1aWNrbG9vay1wcmV2aWV3LXRleHRcIj4nICsgZm0uZXNjYXBlKGRhdGEuY29udGVudCkgKyAnPC9wcmU+PC9kaXY+JykuYXBwZW5kVG8ocHJldmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXG5cdCAqIFBERiBwcmV2aWV3IHBsdWdpblxuXHQgKlxuXHQgKiBAcGFyYW0gZWxGaW5kZXIuY29tbWFuZHMucXVpY2tsb29rXG5cdCAqKi9cclxuICAgIGZ1bmN0aW9uKHFsKSB7XHJcbiAgICAgICAgdmFyIGZtID0gcWwuZm0sXHJcbiAgICAgICAgICAgIG1pbWUgPSAnYXBwbGljYXRpb24vcGRmJyxcclxuICAgICAgICAgICAgcHJldmlldyA9IHFsLnByZXZpZXcsXHJcbiAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAoKGZtLlVBLlNhZmFyaSAmJiBmbS5PUyA9PSAnbWFjJykgfHwgZm0uVUEuSUUpIHtcclxuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkLmVhY2gobmF2aWdhdG9yLnBsdWdpbnMsIGZ1bmN0aW9uKGksIHBsdWdpbnMpIHtcclxuICAgICAgICAgICAgICAgICQuZWFjaChwbHVnaW5zLCBmdW5jdGlvbihpLCBwbHVnaW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGx1Z2luLnR5cGUgPT0gbWltZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShhY3RpdmUgPSB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhY3RpdmUgJiYgcHJldmlldy5iaW5kKCd1cGRhdGUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlID0gZS5maWxlLCBub2RlO1xyXG5cclxuICAgICAgICAgICAgaWYgKGZpbGUubWltZSA9PSBtaW1lKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgcHJldmlldy5vbmUoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUudW5iaW5kKCdsb2FkJykucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBub2RlID0gJCgnPGlmcmFtZSBjbGFzcz1cImVsZmluZGVyLXF1aWNrbG9vay1wcmV2aWV3LXBkZlwiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlKClcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8ocHJldmlldylcclxuICAgICAgICAgICAgICAgICAgICAubG9hZChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcWwuaGlkZWluZm8oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuYXR0cignc3JjJywgZm0udXJsKGZpbGUuaGFzaCkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcblx0ICogRmxhc2ggcHJldmlldyBwbHVnaW5cblx0ICpcblx0ICogQHBhcmFtIGVsRmluZGVyLmNvbW1hbmRzLnF1aWNrbG9va1xuXHQgKiovXHJcbiAgICBmdW5jdGlvbihxbCkge1xyXG4gICAgICAgIHZhciBmbSA9IHFsLmZtLFxyXG4gICAgICAgICAgICBtaW1lID0gJ2FwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoJyxcclxuICAgICAgICAgICAgcHJldmlldyA9IHFsLnByZXZpZXcsXHJcbiAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAkLmVhY2gobmF2aWdhdG9yLnBsdWdpbnMsIGZ1bmN0aW9uKGksIHBsdWdpbnMpIHtcclxuICAgICAgICAgICAgJC5lYWNoKHBsdWdpbnMsIGZ1bmN0aW9uKGksIHBsdWdpbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHBsdWdpbi50eXBlID09IG1pbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShhY3RpdmUgPSB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGFjdGl2ZSAmJiBwcmV2aWV3LmJpbmQoJ3VwZGF0ZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSBlLmZpbGUsXHJcbiAgICAgICAgICAgICAgICBub2RlO1xyXG5cclxuICAgICAgICAgICAgaWYgKGZpbGUubWltZSA9PSBtaW1lKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgcWwuaGlkZWluZm8oKTtcclxuICAgICAgICAgICAgICAgIHByZXZpZXcuYXBwZW5kKChub2RlID0gJCgnPGVtYmVkIGNsYXNzPVwiZWxmaW5kZXItcXVpY2tsb29rLXByZXZpZXctZmxhc2hcIiBwbHVnaW5zcGFnZT1cImh0dHA6Ly93d3cubWFjcm9tZWRpYS5jb20vZ28vZ2V0Zmxhc2hwbGF5ZXJcIiBzcmM9XCInICsgZm0udXJsKGZpbGUuaGFzaCkgKyAnXCIgcXVhbGl0eT1cImhpZ2hcIiB0eXBlPVwiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2hcIiAvPicpKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXG5cdCAqIEhUTUw1IGF1ZGlvIHByZXZpZXcgcGx1Z2luXG5cdCAqXG5cdCAqIEBwYXJhbSBlbEZpbmRlci5jb21tYW5kcy5xdWlja2xvb2tcblx0ICoqL1xyXG4gICAgZnVuY3Rpb24ocWwpIHtcclxuICAgICAgICB2YXIgcHJldmlldyA9IHFsLnByZXZpZXcsXHJcbiAgICAgICAgICAgIGF1dG9wbGF5ID0gISFxbC5vcHRpb25zWydhdXRvcGxheSddLFxyXG4gICAgICAgICAgICBtaW1lcyA9IHtcclxuICAgICAgICAgICAgICAgICdhdWRpby9tcGVnJzogJ21wMycsXHJcbiAgICAgICAgICAgICAgICAnYXVkaW8vbXBlZzMnOiAnbXAzJyxcclxuICAgICAgICAgICAgICAgICdhdWRpby9tcDMnOiAnbXAzJyxcclxuICAgICAgICAgICAgICAgICdhdWRpby94LW1wZWczJzogJ21wMycsXHJcbiAgICAgICAgICAgICAgICAnYXVkaW8veC1tcDMnOiAnbXAzJyxcclxuICAgICAgICAgICAgICAgICdhdWRpby94LXdhdic6ICd3YXYnLFxyXG4gICAgICAgICAgICAgICAgJ2F1ZGlvL3dhdic6ICd3YXYnLFxyXG4gICAgICAgICAgICAgICAgJ2F1ZGlvL3gtbTRhJzogJ200YScsXHJcbiAgICAgICAgICAgICAgICAnYXVkaW8vYWFjJzogJ200YScsXHJcbiAgICAgICAgICAgICAgICAnYXVkaW8vbXA0JzogJ200YScsXHJcbiAgICAgICAgICAgICAgICAnYXVkaW8veC1tcDQnOiAnbTRhJyxcclxuICAgICAgICAgICAgICAgICdhdWRpby9vZ2cnOiAnb2dnJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBub2RlO1xyXG5cclxuICAgICAgICBwcmV2aWV3LmJpbmQoJ3VwZGF0ZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSBlLmZpbGUsXHJcbiAgICAgICAgICAgICAgICB0eXBlID0gbWltZXNbZmlsZS5taW1lXTtcclxuXHJcbiAgICAgICAgICAgIGlmIChxbC5zdXBwb3J0LmF1ZGlvW3R5cGVdKSB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIG5vZGUgPSAkKCc8YXVkaW8gY2xhc3M9XCJlbGZpbmRlci1xdWlja2xvb2stcHJldmlldy1hdWRpb1wiIGNvbnRyb2xzIHByZWxvYWQ9XCJhdXRvXCIgYXV0b2J1ZmZlcj48c291cmNlIHNyYz1cIicgKyBxbC5mbS51cmwoZmlsZS5oYXNoKSArICdcIiAvPjwvYXVkaW8+JylcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8ocHJldmlldyk7XHJcbiAgICAgICAgICAgICAgICBhdXRvcGxheSAmJiBub2RlWzBdLnBsYXkoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLmJpbmQoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAobm9kZSAmJiBub2RlLnBhcmVudCgpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgbm9kZVswXS5wYXVzZSgpO1xyXG4gICAgICAgICAgICAgICAgbm9kZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIG5vZGUgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxuXHQgKiBIVE1MNSB2aWRlbyBwcmV2aWV3IHBsdWdpblxuXHQgKlxuXHQgKiBAcGFyYW0gZWxGaW5kZXIuY29tbWFuZHMucXVpY2tsb29rXG5cdCAqKi9cclxuICAgIGZ1bmN0aW9uKHFsKSB7XHJcbiAgICAgICAgdmFyIHByZXZpZXcgPSBxbC5wcmV2aWV3LFxyXG4gICAgICAgICAgICBhdXRvcGxheSA9ICEhcWwub3B0aW9uc1snYXV0b3BsYXknXSxcclxuICAgICAgICAgICAgbWltZXMgPSB7XHJcbiAgICAgICAgICAgICAgICAndmlkZW8vbXA0JzogJ21wNCcsXHJcbiAgICAgICAgICAgICAgICAndmlkZW8veC1tNHYnOiAnbXA0JyxcclxuICAgICAgICAgICAgICAgICd2aWRlby9vZ2cnOiAnb2dnJyxcclxuICAgICAgICAgICAgICAgICdhcHBsaWNhdGlvbi9vZ2cnOiAnb2dnJyxcclxuICAgICAgICAgICAgICAgICd2aWRlby93ZWJtJzogJ3dlYm0nXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG5vZGU7XHJcblxyXG4gICAgICAgIHByZXZpZXcuYmluZCgndXBkYXRlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgZmlsZSA9IGUuZmlsZSxcclxuICAgICAgICAgICAgICAgIHR5cGUgPSBtaW1lc1tmaWxlLm1pbWVdO1xyXG5cclxuICAgICAgICAgICAgaWYgKHFsLnN1cHBvcnQudmlkZW9bdHlwZV0pIHtcclxuICAgICAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcWwuaGlkZWluZm8oKTtcclxuICAgICAgICAgICAgICAgIG5vZGUgPSAkKCc8dmlkZW8gY2xhc3M9XCJlbGZpbmRlci1xdWlja2xvb2stcHJldmlldy12aWRlb1wiIGNvbnRyb2xzIHByZWxvYWQ9XCJhdXRvXCIgYXV0b2J1ZmZlcj48c291cmNlIHNyYz1cIicgKyBxbC5mbS51cmwoZmlsZS5oYXNoKSArICdcIiAvPjwvdmlkZW8+JykuYXBwZW5kVG8ocHJldmlldyk7XHJcbiAgICAgICAgICAgICAgICBhdXRvcGxheSAmJiBub2RlWzBdLnBsYXkoKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5iaW5kKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5wYXJlbnQoKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIG5vZGVbMF0ucGF1c2UoKTtcclxuICAgICAgICAgICAgICAgIG5vZGUucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcblx0ICogQXVkaW8vdmlkZW8gcHJldmlldyBwbHVnaW4gdXNpbmcgYnJvd3NlciBwbHVnaW5zXG5cdCAqXG5cdCAqIEBwYXJhbSBlbEZpbmRlci5jb21tYW5kcy5xdWlja2xvb2tcblx0ICoqL1xyXG4gICAgZnVuY3Rpb24ocWwpIHtcclxuICAgICAgICB2YXIgcHJldmlldyA9IHFsLnByZXZpZXcsXHJcbiAgICAgICAgICAgIG1pbWVzID0gW10sXHJcbiAgICAgICAgICAgIG5vZGU7XHJcblxyXG4gICAgICAgICQuZWFjaChuYXZpZ2F0b3IucGx1Z2lucywgZnVuY3Rpb24oaSwgcGx1Z2lucykge1xyXG4gICAgICAgICAgICAkLmVhY2gocGx1Z2lucywgZnVuY3Rpb24oaSwgcGx1Z2luKSB7XHJcbiAgICAgICAgICAgICAgICAocGx1Z2luLnR5cGUuaW5kZXhPZignYXVkaW8vJykgPT09IDAgfHwgcGx1Z2luLnR5cGUuaW5kZXhPZigndmlkZW8vJykgPT09IDApICYmIG1pbWVzLnB1c2gocGx1Z2luLnR5cGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcHJldmlldy5iaW5kKCd1cGRhdGUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlID0gZS5maWxlLFxyXG4gICAgICAgICAgICAgICAgbWltZSA9IGZpbGUubWltZSxcclxuICAgICAgICAgICAgICAgIHZpZGVvO1xyXG5cclxuICAgICAgICAgICAgaWYgKCQuaW5BcnJheShmaWxlLm1pbWUsIG1pbWVzKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAodmlkZW8gPSBtaW1lLmluZGV4T2YoJ3ZpZGVvLycpID09PSAwKSAmJiBxbC5oaWRlaW5mbygpO1xyXG4gICAgICAgICAgICAgICAgbm9kZSA9ICQoJzxlbWJlZCBzcmM9XCInICsgcWwuZm0udXJsKGZpbGUuaGFzaCkgKyAnXCIgdHlwZT1cIicgKyBtaW1lICsgJ1wiIGNsYXNzPVwiZWxmaW5kZXItcXVpY2tsb29rLXByZXZpZXctJyArICh2aWRlbyA/ICd2aWRlbycgOiAnYXVkaW8nKSArICdcIi8+JylcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8ocHJldmlldyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5iaW5kKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5wYXJlbnQoKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXSIsIlwidXNlIHN0cmljdFwiOyAvKipcbiAqIEBjbGFzcyAgZWxGaW5kZXIgY29tbWFuZCBcImV4dHJhY3RcIlxuICogRXh0cmFjdCBmaWxlcyBmcm9tIGFyY2hpdmVcbiAqXG4gKiBAYXV0aG9yIERtaXRyeSAoZGlvKSBMZXZhc2hvdlxuICoqL1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMuZXh0cmFjdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzLFxyXG4gICAgICAgIGZtID0gc2VsZi5mbSxcclxuICAgICAgICBtaW1lcyA9IFtdLFxyXG4gICAgICAgIGZpbHRlciA9IGZ1bmN0aW9uKGZpbGVzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkLm1hcChmaWxlcywgZnVuY3Rpb24oZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbGUucmVhZCAmJiAkLmluQXJyYXkoZmlsZS5taW1lLCBtaW1lcykgIT09IC0xID8gZmlsZSA6IG51bGw7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgdGhpcy5kaXNhYmxlT25TZWFyY2ggPSB0cnVlO1xyXG5cclxuICAgIC8vIFVwZGF0ZSBtaW1lcyBsaXN0IG9uIG9wZW4vcmVsb2FkXHJcbiAgICBmbS5iaW5kKCdvcGVuIHJlbG9hZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIG1pbWVzID0gZm0ub3B0aW9uKCdhcmNoaXZlcnMnKVsnZXh0cmFjdCddIHx8IFtdO1xyXG4gICAgICAgIHNlbGYuY2hhbmdlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oc2VsKSB7XHJcbiAgICAgICAgdmFyIHNlbCA9IHRoaXMuZmlsZXMoc2VsKSxcclxuICAgICAgICAgICAgY250ID0gc2VsLmxlbmd0aDtcclxuXHJcbiAgICAgICAgcmV0dXJuICF0aGlzLl9kaXNhYmxlZCAmJiBjbnQgJiYgdGhpcy5mbS5jd2QoKS53cml0ZSAmJiBmaWx0ZXIoc2VsKS5sZW5ndGggPT0gY250ID8gMCA6IC0xO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgIHZhciBmaWxlcyA9IHRoaXMuZmlsZXMoaGFzaGVzKSxcclxuICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKSxcclxuICAgICAgICAgICAgY250ID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICBpLFxyXG4gICAgICAgICAgICBlcnJvcixcclxuICAgICAgICAgICAgZGVjaXNpb247XHJcblxyXG4gICAgICAgIHZhciBvdmVyd3JpdGVBbGwgPSBmYWxzZTtcclxuICAgICAgICB2YXIgb21pdEFsbCA9IGZhbHNlO1xyXG5cclxuICAgICAgICB2YXIgbmFtZXMgPSAkLm1hcChmbS5maWxlcyhoYXNoZXMpLCBmdW5jdGlvbihmaWxlKSB7IHJldHVybiBmaWxlLm5hbWU7IH0pO1xyXG4gICAgICAgIHZhciBtYXAgPSB7fTtcclxuICAgICAgICAkLm1hcChmbS5maWxlcyhoYXNoZXMpLCBmdW5jdGlvbihmaWxlKSB7IG1hcFtmaWxlLm5hbWVdID0gZmlsZTsgfSk7XHJcblxyXG4gICAgICAgIHZhciBkZWNpZGUgPSBmdW5jdGlvbihkZWNpc2lvbikge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGRlY2lzaW9uKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ292ZXJ3cml0ZV9hbGwnOlxyXG4gICAgICAgICAgICAgICAgb3ZlcndyaXRlQWxsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdvbWl0X2FsbCc6XHJcbiAgICAgICAgICAgICAgICBvbWl0QWxsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHVucGFjayA9IGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgICAgICAgaWYgKCEoZmlsZS5yZWFkICYmIGZtLmZpbGUoZmlsZS5waGFzaCkud3JpdGUpKSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvciA9IFsnZXJyRXh0cmFjdCcsIGZpbGUubmFtZSwgJ2VyclBlcm0nXTtcclxuICAgICAgICAgICAgICAgIGZtLmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICgkLmluQXJyYXkoZmlsZS5taW1lLCBtaW1lcykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvciA9IFsnZXJyRXh0cmFjdCcsIGZpbGUubmFtZSwgJ2Vyck5vQXJjaGl2ZSddO1xyXG4gICAgICAgICAgICAgICAgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAnZXh0cmFjdCcsIHRhcmdldDogZmlsZS5oYXNoIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmeTogeyB0eXBlOiAnZXh0cmFjdCcsIGNudDogMSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzeW5jT25GYWlsOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGZyZC5zdGF0ZSgpICE9ICdyZWplY3RlZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY29uZmlybSA9IGZ1bmN0aW9uKGZpbGVzLCBpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgZmlsZSA9IGZpbGVzW2luZGV4XTtcclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBmaWxlLm5hbWUucmVwbGFjZSgvXFwuKCh0YXJcXC4oZ3p8Ynp8YnoyfHp8bHpvKSl8Y3Bpb1xcLmd6fHBzXFwuZ3p8eGNmXFwuKGd6fGJ6Mil8W2EtejAtOV17MSw0fSkkL2lnLCAnJyk7XHJcbiAgICAgICAgICAgIHZhciBleGlzdGVkID0gKCQuaW5BcnJheShuYW1lLCBuYW1lcykgPj0gMCk7XHJcbiAgICAgICAgICAgIGlmIChleGlzdGVkICYmIG1hcFtuYW1lXS5taW1lICE9ICdkaXJlY3RvcnknKSB7XHJcbiAgICAgICAgICAgICAgICBmbS5jb25maXJtKFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGZtLmkxOG4oJ250ZmV4dHJhY3QnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogZm0uaTE4bihbJ2VyckV4aXN0cycsIG5hbWUsICdjb25maXJtUmVwbCddKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ2J0blllcycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oYWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjaXNpb24gPSBhbGwgPyAnb3ZlcndyaXRlX2FsbCcgOiAnb3ZlcndyaXRlJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNpZGUoZGVjaXNpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb3ZlcndyaXRlQWxsICYmICFvbWl0QWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnb3ZlcndyaXRlJyA9PSBkZWNpc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5wYWNrKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoaW5kZXggKyAxKSA8IGNudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybShmaWxlcywgaW5kZXggKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvdmVyd3JpdGVBbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNudDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnBhY2soZmlsZXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ2J0bk5vJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbihhbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNpc2lvbiA9IGFsbCA/ICdvbWl0X2FsbCcgOiAnb21pdCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjaWRlKGRlY2lzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW92ZXJ3cml0ZUFsbCAmJiAhb21pdEFsbCAmJiAoaW5kZXggKyAxKSA8IGNudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtKGZpbGVzLCBpbmRleCArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob21pdEFsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZnJkLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdidG5DYW5jZWwnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGw6IChjbnQgPiAxKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB1bnBhY2soZmlsZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoKGluZGV4ICsgMSkgPCBjbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25maXJtKGZpbGVzLCBpbmRleCArIDEpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkZnJkLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmICghKHRoaXMuZW5hYmxlZCgpICYmIGNudCAmJiBtaW1lcy5sZW5ndGgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNudCA+IDApIHtcclxuICAgICAgICAgICAgY29uZmlybShmaWxlcywgMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZGZyZDtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7IC8qKlxuICogQGNsYXNzICBlbEZpbmRlciBjb21tYW5kIFwiYXJjaGl2ZVwiXG4gKiBBcmNoaXZlIHNlbGVjdGVkIGZpbGVzXG4gKlxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLmFyY2hpdmUgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICBmbSA9IHNlbGYuZm0sXHJcbiAgICAgICAgbWltZXMgPSBbXTtcclxuXHJcbiAgICB0aGlzLnZhcmlhbnRzID0gW107XHJcblxyXG4gICAgdGhpcy5kaXNhYmxlT25TZWFyY2ggPSB0cnVlO1xyXG5cclxuICAgIC8qKlxuXHQgKiBVcGRhdGUgbWltZXMgb24gb3Blbi9yZWxvYWRcblx0ICpcblx0ICogQHJldHVybiB2b2lkXG5cdCAqKi9cclxuICAgIGZtLmJpbmQoJ29wZW4gcmVsb2FkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc2VsZi52YXJpYW50cyA9IFtdO1xyXG4gICAgICAgICQuZWFjaCgobWltZXMgPSBmbS5vcHRpb24oJ2FyY2hpdmVycycpWydjcmVhdGUnXSB8fCBbXSksIGZ1bmN0aW9uKGksIG1pbWUpIHtcclxuICAgICAgICAgICAgc2VsZi52YXJpYW50cy5wdXNoKFttaW1lLCBmbS5taW1lMmtpbmQobWltZSldKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBzZWxmLmNoYW5nZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5fZGlzYWJsZWQgJiYgbWltZXMubGVuZ3RoICYmIGZtLnNlbGVjdGVkKCkubGVuZ3RoICYmIGZtLmN3ZCgpLndyaXRlID8gMCA6IC0xO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGhhc2hlcywgdHlwZSkge1xyXG4gICAgICAgIHZhciBmaWxlcyA9IHRoaXMuZmlsZXMoaGFzaGVzKSxcclxuICAgICAgICAgICAgY250ID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICBtaW1lID0gdHlwZSB8fCBtaW1lc1swXSxcclxuICAgICAgICAgICAgY3dkID0gZm0uY3dkKCksXHJcbiAgICAgICAgICAgIGVycm9yID0gWydlcnJBcmNoaXZlJywgJ2VyclBlcm0nLCAnZXJyQ3JlYXRpbmdUZW1wRGlyJywgJ2VyckZ0cERvd25sb2FkRmlsZScsICdlcnJGdHBVcGxvYWRGaWxlJywgJ2VyckZ0cE1rZGlyJywgJ2VyckFyY2hpdmVFeGVjJywgJ2VyckV4dHJhY3RFeGVjJywgJ2VyclJtJ10sXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKCkuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgZXJyb3IgJiYgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgaTtcclxuXHJcbiAgICAgICAgaWYgKCEodGhpcy5lbmFibGVkKCkgJiYgY250ICYmIG1pbWVzLmxlbmd0aCAmJiAkLmluQXJyYXkobWltZSwgbWltZXMpICE9PSAtMSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWN3ZC53cml0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNudDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICghZmlsZXNbaV0ucmVhZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICBkYXRhOiB7IGNtZDogJ2FyY2hpdmUnLCB0YXJnZXRzOiB0aGlzLmhhc2hlcyhoYXNoZXMpLCB0eXBlOiBtaW1lIH0sXHJcbiAgICAgICAgICAgIG5vdGlmeTogeyB0eXBlOiAnYXJjaGl2ZScsIGNudDogMSB9LFxyXG4gICAgICAgICAgICBzeW5jT25GYWlsOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59OyIsIlwidXNlIHN0cmljdFwiOyAvKipcbiAqIEBjbGFzcyAgZWxGaW5kZXIgY29tbWFuZCBcInNlYXJjaFwiXG4gKiBGaW5kIGZpbGVzXG4gKlxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqKi9cclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLnNlYXJjaCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy50aXRsZSA9ICdGaW5kIGZpbGVzJztcclxuICAgIHRoaXMub3B0aW9ucyA9IHsgdWk6ICdzZWFyY2hidXR0b24nIH07XHJcbiAgICB0aGlzLmFsd2F5c0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgdGhpcy51cGRhdGVPblNlbGVjdCA9IGZhbHNlO1xyXG5cclxuICAgIC8qKlxuXHQgKiBSZXR1cm4gY29tbWFuZCBzdGF0dXMuXG5cdCAqIFNlYXJjaCBkb2VzIG5vdCBzdXBwb3J0IG9sZCBhcGkuXG5cdCAqXG5cdCAqIEByZXR1cm4gTnVtYmVyXG5cdCAqKi9cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07IC8qKlxuXHQgKiBTZW5kIHNlYXJjaCByZXF1ZXN0IHRvIGJhY2tlbmQuXG5cdCAqXG5cdCAqIEBwYXJhbSAgU3RyaW5nICBzZWFyY2ggc3RyaW5nXG5cdCAqIEByZXR1cm4gJC5EZWZlcnJlZFxuXHQgKiovXHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihxKSB7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbTtcclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZihxKSA9PSAnc3RyaW5nJyAmJiBxKSB7XHJcbiAgICAgICAgICAgIGZtLnRyaWdnZXIoJ3NlYXJjaHN0YXJ0JywgeyBxdWVyeTogcSB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAnc2VhcmNoJywgcTogcSB9LFxyXG4gICAgICAgICAgICAgICAgbm90aWZ5OiB7IHR5cGU6ICdzZWFyY2gnLCBjbnQ6IDEsIGhpZGVDbnQ6IHRydWUgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm0uZ2V0VUkoJ3Rvb2xiYXInKS5maW5kKCcuJyArIGZtLnJlcygnY2xhc3MnLCAnc2VhcmNoYnRuJykgKyAnIDp0ZXh0JykuZm9jdXMoKTtcclxuICAgICAgICByZXR1cm4gJC5EZWZlcnJlZCgpLnJlamVjdCgpO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuLyoqXG4gKiBAY2xhc3MgIGVsRmluZGVyIGNvbW1hbmQgXCJ2aWV3XCJcbiAqIENoYW5nZSBjdXJyZW50IGRpcmVjdG9yeSB2aWV3IChpY29ucy9saXN0KVxuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy52aWV3ID0gZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLnZhbHVlID0gdGhpcy5mbS52aWV3VHlwZTtcclxuICAgIHRoaXMuYWx3YXlzRW5hYmxlZCA9IHRydWU7XHJcbiAgICB0aGlzLnVwZGF0ZU9uU2VsZWN0ID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5vcHRpb25zID0geyB1aTogJ3ZpZXdidXR0b24nIH07XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZm0uc3RvcmFnZSgndmlldycsIHRoaXMudmFsdWUgPT0gJ2xpc3QnID8gJ2ljb25zJyA6ICdsaXN0Jyk7XHJcbiAgICAgICAgdGhpcy5mbS52aWV3Y2hhbmdlKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGUodm9pZCgwKSwgdmFsdWUpO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuLyoqXG4gKiBAY2xhc3MgIGVsRmluZGVyIGNvbW1hbmQgXCJyZXNpemVcIlxuICogT3BlbiBkaWFsb2cgdG8gcmVzaXplIGltYWdlXG4gKlxuICogQGF1dGhvciBEbWl0cnkgKGRpbykgTGV2YXNob3ZcbiAqIEBhdXRob3IgQWxleGV5IFN1a2hvdGluXG4gKiBAYXV0aG9yIE5hb2tpIFNhd2FkYVxuICogQGF1dGhvciBTZXJnaW8gSm92YW5pXG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5yZXNpemUgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0aGlzLnVwZGF0ZU9uU2VsZWN0ID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWwgPSB0aGlzLmZtLnNlbGVjdGVkRmlsZXMoKTtcclxuICAgICAgICByZXR1cm4gIXRoaXMuX2Rpc2FibGVkICYmIHNlbC5sZW5ndGggPT0gMSAmJiBzZWxbMF0ucmVhZCAmJiBzZWxbMF0ud3JpdGUgJiYgc2VsWzBdLm1pbWUuaW5kZXhPZignaW1hZ2UvJykgIT09IC0xID8gMCA6IC0xO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihoYXNoZXMpIHtcclxuICAgICAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBmaWxlcyA9IHRoaXMuZmlsZXMoaGFzaGVzKSxcclxuICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKSxcclxuXHJcbiAgICAgICAgICAgIG9wZW4gPSBmdW5jdGlvbihmaWxlLCBpZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRpYWxvZyA9ICQoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1kaWFsb2ctcmVzaXplXCIvPicpLFxyXG4gICAgICAgICAgICAgICAgICAgIGlucHV0ID0gJzxpbnB1dCB0eXBlPVwidGV4dFwiIHNpemU9XCI1XCIvPicsXHJcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1yZXNpemUtcm93XCIvPicsXHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWwgPSAnPGRpdiBjbGFzcz1cImVsZmluZGVyLXJlc2l6ZS1sYWJlbFwiLz4nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItcmVzaXplLWNvbnRyb2xcIi8+JyksXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlldyA9ICQoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1yZXNpemUtcHJldmlld1wiLz4nKSxcclxuICAgICAgICAgICAgICAgICAgICBzcGlubmVyID0gJCgnPGRpdiBjbGFzcz1cImVsZmluZGVyLXJlc2l6ZS1zcGlubmVyXCI+JyArIGZtLmkxOG4oJ250ZmxvYWRpbWcnKSArICc8L2Rpdj4nKSxcclxuICAgICAgICAgICAgICAgICAgICByaGFuZGxlID0gJCgnPGRpdiBjbGFzcz1cImVsZmluZGVyLXJlc2l6ZS1oYW5kbGVcIi8+JyksXHJcbiAgICAgICAgICAgICAgICAgICAgcmhhbmRsZWMgPSAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItcmVzaXplLWhhbmRsZVwiLz4nKSxcclxuICAgICAgICAgICAgICAgICAgICB1aXJlc2l6ZSA9ICQoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1yZXNpemUtdWlyZXNpemVcIi8+JyksXHJcbiAgICAgICAgICAgICAgICAgICAgdWljcm9wID0gJCgnPGRpdiBjbGFzcz1cImVsZmluZGVyLXJlc2l6ZS11aWNyb3BcIi8+JyksXHJcbiAgICAgICAgICAgICAgICAgICAgdWlidXR0b25zZXQgPSAnPGRpdiBjbGFzcz1cInVpLXdpZGdldC1jb250ZW50IHVpLWNvcm5lci1hbGwgZWxmaW5kZXItYnV0dG9uc2V0XCIvPicsXHJcbiAgICAgICAgICAgICAgICAgICAgdWlidXR0b24gPSAnPGRpdiBjbGFzcz1cInVpLXN0YXRlLWRlZmF1bHQgZWxmaW5kZXItYnV0dG9uXCIvPicsXHJcbiAgICAgICAgICAgICAgICAgICAgdWlzZXBhcmF0b3IgPSAnPHNwYW4gY2xhc3M9XCJ1aS13aWRnZXQtY29udGVudCBlbGZpbmRlci10b29sYmFyLWJ1dHRvbi1zZXBhcmF0b3JcIi8+JyxcclxuICAgICAgICAgICAgICAgICAgICB1aXJvdGF0ZSA9ICQoJzxkaXYgY2xhc3M9XCJlbGZpbmRlci1yZXNpemUtcm90YXRlXCIvPicpLFxyXG4gICAgICAgICAgICAgICAgICAgIHVpZGVnMjcwID0gJCh1aWJ1dHRvbikuYXR0cigndGl0bGUnLCBmbS5pMThuKCdyb3RhdGUtY3cnKSkuYXBwZW5kKCQoJzxzcGFuIGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uLWljb24gZWxmaW5kZXItYnV0dG9uLWljb24tcm90YXRlLWxcIi8+JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmRlZ3JlZSA9IHJkZWdyZWUgLSA5MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdGF0ZS51cGRhdGUocmRlZ3JlZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKSxcclxuICAgICAgICAgICAgICAgICAgICB1aWRlZzkwID0gJCh1aWJ1dHRvbikuYXR0cigndGl0bGUnLCBmbS5pMThuKCdyb3RhdGUtY2N3JykpLmFwcGVuZCgkKCc8c3BhbiBjbGFzcz1cImVsZmluZGVyLWJ1dHRvbi1pY29uIGVsZmluZGVyLWJ1dHRvbi1pY29uLXJvdGF0ZS1yXCIvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJkZWdyZWUgPSByZGVncmVlICsgOTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RhdGUudXBkYXRlKHJkZWdyZWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSksXHJcbiAgICAgICAgICAgICAgICAgICAgdWlwcm9wID0gJCgnPHNwYW4gLz4nKSxcclxuICAgICAgICAgICAgICAgICAgICByZXNldCA9ICQoJzxkaXYgY2xhc3M9XCJ1aS1zdGF0ZS1kZWZhdWx0IHVpLWNvcm5lci1hbGwgZWxmaW5kZXItcmVzaXplLXJlc2V0XCI+PHNwYW4gY2xhc3M9XCJ1aS1pY29uIHVpLWljb24tYXJyb3dyZXR1cm50aGljay0xLXdcIi8+PC9kaXY+JyksXHJcbiAgICAgICAgICAgICAgICAgICAgdWl0eXBlID0gJCgnPGRpdiBjbGFzcz1cImVsZmluZGVyLXJlc2l6ZS10eXBlXCIvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwidHlwZVwiIGlkPVwiJyArIGlkICsgJy1yZXNpemVcIiB2YWx1ZT1cInJlc2l6ZVwiIGNoZWNrZWQ9XCJjaGVja2VkXCIgLz48bGFiZWwgZm9yPVwiJyArIGlkICsgJy1yZXNpemVcIj4nICsgZm0uaTE4bigncmVzaXplJykgKyAnPC9sYWJlbD4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCc8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cInR5cGVcIiBpZD1cIicgKyBpZCArICctY3JvcFwiIHZhbHVlPVwiY3JvcFwiIC8+PGxhYmVsIGZvcj1cIicgKyBpZCArICctY3JvcFwiPicgKyBmbS5pMThuKCdjcm9wJykgKyAnPC9sYWJlbD4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCc8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cInR5cGVcIiBpZD1cIicgKyBpZCArICctcm90YXRlXCIgdmFsdWU9XCJyb3RhdGVcIiAvPjxsYWJlbCBmb3I9XCInICsgaWQgKyAnLXJvdGF0ZVwiPicgKyBmbS5pMThuKCdyb3RhdGUnKSArICc8L2xhYmVsPicpLFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSAkKCdpbnB1dCcsIHVpdHlwZSkuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2hhbmdlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9ICQoJ2lucHV0OmNoZWNrZWQnLCB1aXR5cGUpLnZhbCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2V0VmlldygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXphYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JvcHBhYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90YXRlYWJsZSh0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsID09ICdyZXNpemUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWlyZXNpemUuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpcm90YXRlLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aWNyb3AuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6YWJsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwgPT0gJ2Nyb3AnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWlyb3RhdGUuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpcmVzaXplLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aWNyb3Auc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyb3BwYWJsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwgPT0gJ3JvdGF0ZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aXJlc2l6ZS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWljcm9wLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aXJvdGF0ZS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90YXRlYWJsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICBjb25zdHIgPSAkKCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgY2hlY2tlZD1cImNoZWNrZWRcIi8+JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNoYW5nZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyYXRpbyA9ICEhY29uc3RyLnByb3AoJ2NoZWNrZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZS5maXhIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6YWJsZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6YWJsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9ICQoaW5wdXQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jaGFuZ2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdyA9IHBhcnNlSW50KHdpZHRoLnZhbCgpKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gcGFyc2VJbnQoY3JhdGlvID8gTWF0aC5yb3VuZCh3IC8gcmF0aW8pIDogaGVpZ2h0LnZhbCgpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodyA+IDAgJiYgaCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNpemUudXBkYXRlVmlldyh3LCBoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQudmFsKGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAkKGlucHV0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2hhbmdlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBwYXJzZUludChoZWlnaHQudmFsKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcgPSBwYXJzZUludChjcmF0aW8gPyBNYXRoLnJvdW5kKGggKiByYXRpbykgOiB3aWR0aC52YWwoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHcgPiAwICYmIGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplLnVwZGF0ZVZpZXcodywgaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGgudmFsKHcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICBwb2ludFggPSAkKGlucHV0KS5jaGFuZ2UoZnVuY3Rpb24oKSB7IGNyb3AudXBkYXRlVmlldygpOyB9KSxcclxuICAgICAgICAgICAgICAgICAgICBwb2ludFkgPSAkKGlucHV0KS5jaGFuZ2UoZnVuY3Rpb24oKSB7IGNyb3AudXBkYXRlVmlldygpOyB9KSxcclxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRYID0gJChpbnB1dCkuY2hhbmdlKGZ1bmN0aW9uKCkgeyBjcm9wLnVwZGF0ZVZpZXcoKTsgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0WSA9ICQoaW5wdXQpLmNoYW5nZShmdW5jdGlvbigpIHsgY3JvcC51cGRhdGVWaWV3KCk7IH0pLFxyXG4gICAgICAgICAgICAgICAgICAgIGRlZ3JlZSA9ICQoJzxpbnB1dCB0eXBlPVwidGV4dFwiIHNpemU9XCIzXCIgbWF4bGVuZ3RoPVwiM1wiIHZhbHVlPVwiMFwiIC8+JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNoYW5nZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdGF0ZS51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgdWlkZWdzbGlkZXIgPSAkKCc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItcmVzaXplLXJvdGF0ZS1zbGlkZXJcIi8+JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNsaWRlcih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW46IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXg6IDM1OSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBkZWdyZWUudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiBmdW5jdGlvbihldmVudCwgdWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodWkudmFsdWUgIT0gdWlkZWdzbGlkZXIuc2xpZGVyKCd2YWx1ZScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdGF0ZS51cGRhdGUodWkudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZTogZnVuY3Rpb24oZXZlbnQsIHVpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90YXRlLnVwZGF0ZSh1aS52YWx1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICByYXRpbyA9IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcCA9IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgb3dpZHRoID0gMCxcclxuICAgICAgICAgICAgICAgICAgICBvaGVpZ2h0ID0gMCxcclxuICAgICAgICAgICAgICAgICAgICBjcmF0aW8gPSB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHB3aWR0aCA9IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgcGhlaWdodCA9IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgcndpZHRoID0gMCxcclxuICAgICAgICAgICAgICAgICAgICByaGVpZ2h0ID0gMCxcclxuICAgICAgICAgICAgICAgICAgICByZGVncmVlID0gMCxcclxuICAgICAgICAgICAgICAgICAgICBpbWcgPSAkKCc8aW1nLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAubG9hZChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwaW5uZXIucmVtb3ZlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3dpZHRoID0gaW1nLndpZHRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvaGVpZ2h0ID0gaW1nLmhlaWdodCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF0aW8gPSBvd2lkdGggLyBvaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplLnVwZGF0ZVZpZXcob3dpZHRoLCBvaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaGFuZGxlLmFwcGVuZChpbWcuc2hvdygpKS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aC52YWwob3dpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodC52YWwob2hlaWdodCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJfc2NhbGUgPSBNYXRoLm1pbihwd2lkdGgsIHBoZWlnaHQpIC8gTWF0aC5zcXJ0KE1hdGgucG93KG93aWR0aCwgMikgKyBNYXRoLnBvdyhvaGVpZ2h0LCAyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByd2lkdGggPSBvd2lkdGggKiByX3NjYWxlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmhlaWdodCA9IG9oZWlnaHQgKiByX3NjYWxlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUuYnV0dG9uKCdlbmFibGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuZmluZCgnaW5wdXQsIHNlbGVjdCcpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKCc6dGV4dCcpLmtleWRvd24oZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGUua2V5Q29kZSwgaTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGMgPj0gMzcgJiYgYyA8PSA0MClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IGMgPT0gJC51aS5rZXlDb2RlLkJBQ0tTUEFDRVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYyA9PSAkLnVpLmtleUNvZGUuREVMRVRFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAoYyA9PSA2NSAmJiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBjID09IDI3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjID09IDkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAkKHRoaXMpLnBhcmVudCgpW2Uuc2hpZnRLZXkgPyAncHJldicgOiAnbmV4dCddKCcuZWxmaW5kZXItcmVzaXplLXJvdycpLmNoaWxkcmVuKCc6dGV4dCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCc6dGV4dDonICsgKGUuc2hpZnRLZXkgPyAnbGFzdCcgOiAnZmlyc3QnKSkuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGMgPT0gMTMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZtLmNvbmZpcm0oe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAkKCdpbnB1dDpjaGVja2VkJywgdWl0eXBlKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnY29uZmlybVJlcScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnYnRuQXBwbHknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ2J0bkNhbmNlbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHt9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKChjID49IDQ4ICYmIGMgPD0gNTcpIHx8IChjID49IDk2ICYmIGMgPD0gMTA1KSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcignOmZpcnN0JykuZm9jdXMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNpemFibGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNldC5ob3ZlcihmdW5jdGlvbigpIHsgcmVzZXQudG9nZ2xlQ2xhc3MoJ3VpLXN0YXRlLWhvdmVyJyk7IH0pLmNsaWNrKHJlc2V0Vmlldyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGlubmVyLnRleHQoJ1VuYWJsZSB0byBsb2FkIGltYWdlJykuY3NzKCdiYWNrZ3JvdW5kJywgJ3RyYW5zcGFyZW50Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgICAgIGJhc2VjID0gJCgnPGRpdi8+JyksXHJcbiAgICAgICAgICAgICAgICAgICAgaW1nYyA9ICQoJzxpbWcvPicpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvdmVyYyA9ICQoJzxkaXYvPicpLFxyXG4gICAgICAgICAgICAgICAgICAgIGltZ3IgPSAkKCc8aW1nLz4nKSxcclxuICAgICAgICAgICAgICAgICAgICByZXNldFZpZXcgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGgudmFsKG93aWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodC52YWwob2hlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZS51cGRhdGVWaWV3KG93aWR0aCwgb2hlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICByZXNpemUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aC52YWwoTWF0aC5yb3VuZChpbWcud2lkdGgoKSAvIHByb3ApKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodC52YWwoTWF0aC5yb3VuZChpbWcuaGVpZ2h0KCkgLyBwcm9wKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVWaWV3OiBmdW5jdGlvbih3LCBoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodyA+IHB3aWR0aCB8fCBoID4gcGhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3IC8gcHdpZHRoID4gaCAvIHBoZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcCA9IHB3aWR0aCAvIHc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZy53aWR0aChwd2lkdGgpLmhlaWdodChNYXRoLmNlaWwoaCAqIHByb3ApKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wID0gcGhlaWdodCAvIGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZy5oZWlnaHQocGhlaWdodCkud2lkdGgoTWF0aC5jZWlsKHcgKiBwcm9wKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWcud2lkdGgodykuaGVpZ2h0KGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3AgPSBpbWcud2lkdGgoKSAvIHc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aXByb3AudGV4dCgnMSA6ICcgKyAoMSAvIHByb3ApLnRvRml4ZWQoMikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplLnVwZGF0ZUhhbmRsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlSGFuZGxlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJoYW5kbGUud2lkdGgoaW1nLndpZHRoKCkpLmhlaWdodChpbWcuaGVpZ2h0KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhXaWR0aDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdywgaDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjcmF0aW8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gaGVpZ2h0LnZhbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBNYXRoLnJvdW5kKGggKiByYXRpbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplLnVwZGF0ZVZpZXcodywgaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGgudmFsKHcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhIZWlnaHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHcsIGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3JhdGlvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdyA9IHdpZHRoLnZhbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBNYXRoLnJvdW5kKHcgLyByYXRpbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplLnVwZGF0ZVZpZXcodywgaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0LnZhbChoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY3JvcCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldFgudmFsKE1hdGgucm91bmQoKHJoYW5kbGVjLmRhdGEoJ3cnKSB8fCByaGFuZGxlYy53aWR0aCgpKSAvIHByb3ApKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldFkudmFsKE1hdGgucm91bmQoKHJoYW5kbGVjLmRhdGEoJ2gnKSB8fCByaGFuZGxlYy5oZWlnaHQoKSkgLyBwcm9wKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludFgudmFsKE1hdGgucm91bmQoKChyaGFuZGxlYy5kYXRhKCd4JykgfHwgcmhhbmRsZWMub2Zmc2V0KCkubGVmdCkgLSBpbWdjLm9mZnNldCgpLmxlZnQpIC8gcHJvcCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRZLnZhbChNYXRoLnJvdW5kKCgocmhhbmRsZWMuZGF0YSgneScpIHx8IHJoYW5kbGVjLm9mZnNldCgpLnRvcCkgLSBpbWdjLm9mZnNldCgpLnRvcCkgLyBwcm9wKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVZpZXc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBwYXJzZUludChwb2ludFgudmFsKCkpICogcHJvcCArIGltZ2Mub2Zmc2V0KCkubGVmdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB5ID0gcGFyc2VJbnQocG9pbnRZLnZhbCgpKSAqIHByb3AgKyBpbWdjLm9mZnNldCgpLnRvcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3ID0gb2Zmc2V0WC52YWwoKSAqIHByb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IG9mZnNldFkudmFsKCkgKiBwcm9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmhhbmRsZWMuZGF0YSh7IHg6IHgsIHk6IHksIHc6IHcsIGg6IGggfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaGFuZGxlYy53aWR0aChNYXRoLnJvdW5kKHcpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJoYW5kbGVjLmhlaWdodChNYXRoLnJvdW5kKGgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdmVyYy53aWR0aChyaGFuZGxlYy53aWR0aCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdmVyYy5oZWlnaHQocmhhbmRsZWMuaGVpZ2h0KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmhhbmRsZWMub2Zmc2V0KHsgbGVmdDogTWF0aC5yb3VuZCh4KSwgdG9wOiBNYXRoLnJvdW5kKHkpIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNpemVfdXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJoYW5kbGVjLmRhdGEoeyB3OiBudWxsLCBoOiBudWxsIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JvcC51cGRhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdmVyYy53aWR0aChyaGFuZGxlYy53aWR0aCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdmVyYy5oZWlnaHQocmhhbmRsZWMuaGVpZ2h0KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkcmFnX3VwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaGFuZGxlYy5kYXRhKHsgeDogbnVsbCwgeTogbnVsbCB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyb3AudXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHJvdGF0ZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW91c2VTdGFydEFuZ2xlOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZVN0YXJ0QW5nbGU6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlQmVpbmdSb3RhdGVkOiBmYWxzZSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZTogZnVuY3Rpb24odmFsdWUsIGFuaW1hdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZGVncmVlID0gdmFsdWUgPSBwYXJzZUludChkZWdyZWUudmFsKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhbmltYXRlID09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISBhbmltYXRlIHx8IGZtLlVBLk9wZXJhIHx8IGZtLlVBLmx0SUU4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nci5yb3RhdGUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWdyLmFuaW1hdGUoeyByb3RhdGU6IHZhbHVlICsgJ2RlZycgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICUgMzYwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlICs9IDM2MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZ3JlZS52YWwocGFyc2VJbnQodmFsdWUpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aWRlZ3NsaWRlci5zbGlkZXIoJ3ZhbHVlJywgZGVncmVlLnZhbCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dGU6IGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJvdGF0ZS5pbWFnZUJlaW5nUm90YXRlZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbWFnZUNlbnRyZSA9IHJvdGF0ZS5nZXRDZW50ZXIoaW1ncik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW91c2VYRnJvbUNlbnRyZSA9IGUucGFnZVggLSBpbWFnZUNlbnRyZVswXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb3VzZVlGcm9tQ2VudHJlID0gZS5wYWdlWSAtIGltYWdlQ2VudHJlWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vdXNlQW5nbGUgPSBNYXRoLmF0YW4yKG1vdXNlWUZyb21DZW50cmUsIG1vdXNlWEZyb21DZW50cmUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByb3RhdGVBbmdsZSA9IG1vdXNlQW5nbGUgLSByb3RhdGUubW91c2VTdGFydEFuZ2xlICsgcm90YXRlLmltYWdlU3RhcnRBbmdsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdGF0ZUFuZ2xlID0gTWF0aC5yb3VuZChwYXJzZUZsb2F0KHJvdGF0ZUFuZ2xlKSAqIDE4MCAvIE1hdGguUEkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90YXRlQW5nbGUgPSBNYXRoLnJvdW5kKChyb3RhdGVBbmdsZSArIDYpIC8gMTUpICogMTU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nci5yb3RhdGUocm90YXRlQW5nbGUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdGF0ZUFuZ2xlID0gcm90YXRlQW5nbGUgJSAzNjA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm90YXRlQW5nbGUgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm90YXRlQW5nbGUgKz0gMzYwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVncmVlLnZhbChyb3RhdGVBbmdsZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdWlkZWdzbGlkZXIuc2xpZGVyKCd2YWx1ZScsIGRlZ3JlZS52YWwoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RhdGUuaW1hZ2VCZWluZ1JvdGF0ZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbWFnZUNlbnRyZSA9IHJvdGF0ZS5nZXRDZW50ZXIoaW1ncik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW91c2VTdGFydFhGcm9tQ2VudHJlID0gZS5wYWdlWCAtIGltYWdlQ2VudHJlWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vdXNlU3RhcnRZRnJvbUNlbnRyZSA9IGUucGFnZVkgLSBpbWFnZUNlbnRyZVsxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdGF0ZS5tb3VzZVN0YXJ0QW5nbGUgPSBNYXRoLmF0YW4yKG1vdXNlU3RhcnRZRnJvbUNlbnRyZSwgbW91c2VTdGFydFhGcm9tQ2VudHJlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3RhdGUuaW1hZ2VTdGFydEFuZ2xlID0gcGFyc2VGbG9hdChpbWdyLnJvdGF0ZSgpKSAqIE1hdGguUEkgLyAxODAuMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5tb3VzZW1vdmUocm90YXRlLmV4ZWN1dGUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJvdGF0ZS5pbWFnZUJlaW5nUm90YXRlZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLnVuYmluZCgnbW91c2Vtb3ZlJywgcm90YXRlLmV4ZWN1dGUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IHJvdGF0ZS5pbWFnZUJlaW5nUm90YXRlZCA9IGZhbHNlOyB9LCAxMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRDZW50ZXI6IGZ1bmN0aW9uKGltYWdlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRSb3RhdGlvbiA9IGltZ3Iucm90YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWdyLnJvdGF0ZSgwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW1hZ2VPZmZzZXQgPSBpbWdyLm9mZnNldCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlQ2VudHJlWCA9IGltYWdlT2Zmc2V0LmxlZnQgKyBpbWdyLndpZHRoKCkgLyAyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlQ2VudHJlWSA9IGltYWdlT2Zmc2V0LnRvcCArIGltZ3IuaGVpZ2h0KCkgLyAyO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ3Iucm90YXRlKGN1cnJlbnRSb3RhdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5KGltYWdlQ2VudHJlWCwgaW1hZ2VDZW50cmVZKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzaXphYmxlID0gZnVuY3Rpb24oZGVzdHJveSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJC5mbi5yZXNpemFibGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZXN0cm95KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmhhbmRsZS5maWx0ZXIoJzp1aS1yZXNpemFibGUnKS5yZXNpemFibGUoJ2Rlc3Ryb3knKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaGFuZGxlLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmhhbmRsZS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmhhbmRsZS5yZXNpemFibGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHNvUmVzaXplOiBpbWcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzcGVjdFJhdGlvOiBjcmF0aW8sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogcmVzaXplLnVwZGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcDogcmVzaXplLmZpeEhlaWdodFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjcm9wcGFibGUgPSBmdW5jdGlvbihkZXN0cm95KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkLmZuLmRyYWdnYWJsZSAmJiAkLmZuLnJlc2l6YWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlc3Ryb3kpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaGFuZGxlYy5maWx0ZXIoJzp1aS1yZXNpemFibGUnKS5yZXNpemFibGUoJ2Rlc3Ryb3knKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaGFuZGxlYy5maWx0ZXIoJzp1aS1kcmFnZ2FibGUnKS5kcmFnZ2FibGUoJ2Rlc3Ryb3knKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlYy5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ2NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpZHRoKGltZy53aWR0aCgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGVpZ2h0KGltZy5oZWlnaHQoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdmVyY1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAud2lkdGgoaW1nLndpZHRoKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5oZWlnaHQoaW1nLmhlaWdodCgpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmhhbmRsZWNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpZHRoKGltZ2Mud2lkdGgoKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhlaWdodChpbWdjLmhlaWdodCgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub2Zmc2V0KGltZ2Mub2Zmc2V0KCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXNpemFibGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbm1lbnQ6IGJhc2VjLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBjcm9wLnJlc2l6ZV91cGRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVzOiAnYWxsJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZHJhZ2dhYmxlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZTogY292ZXJjLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbm1lbnQ6IGltZ2MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcmFnOiBjcm9wLmRyYWdfdXBkYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlYy5zaG93KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpZHRoKGltZy53aWR0aCgpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGVpZ2h0KGltZy5oZWlnaHQoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyb3AudXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHJvdGF0ZWFibGUgPSBmdW5jdGlvbihkZXN0cm95KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkLmZuLmRyYWdnYWJsZSAmJiAkLmZuLnJlc2l6YWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlc3Ryb3kpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWdyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nci5zaG93KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLndpZHRoKHJ3aWR0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhlaWdodChyaGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3NzKCdtYXJnaW4tdG9wJywgKHBoZWlnaHQgLSByaGVpZ2h0KSAvIDIgKyAncHgnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3NzKCdtYXJnaW4tbGVmdCcsIChwd2lkdGggLSByd2lkdGgpIC8gMiArICdweCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2F2ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdywgaCwgeCwgeSwgZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGUgPSAkKCdpbnB1dDpjaGVja2VkJywgdWl0eXBlKS52YWwoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2lkdGguYWRkKGhlaWdodCkuY2hhbmdlKCk7IC8vIG1heSBiZSB1bm5lY2Vzc2FyeVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGUgPT0gJ3Jlc2l6ZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcgPSBwYXJzZUludCh3aWR0aC52YWwoKSkgfHwgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBwYXJzZUludChoZWlnaHQudmFsKCkpIHx8IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobW9kZSA9PSAnY3JvcCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcgPSBwYXJzZUludChvZmZzZXRYLnZhbCgpKSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IHBhcnNlSW50KG9mZnNldFkudmFsKCkpIHx8IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ID0gcGFyc2VJbnQocG9pbnRYLnZhbCgpKSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeSA9IHBhcnNlSW50KHBvaW50WS52YWwoKSkgfHwgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtb2RlID09ICdyb3RhdGUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ID0gb3dpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IG9oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gcGFyc2VJbnQoZGVncmVlLnZhbCgpKSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQgPCAwIHx8IGQgPiAzNjApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm0uZXJyb3IoJ0ludmFsaWQgcm90YXRlIGRlZ3JlZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQgPT0gMCB8fCBkID09IDM2MCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmbS5lcnJvcignSW1hZ2UgZG9zZSBub3Qgcm90YXRlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZSAhPSAncm90YXRlJykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3IDw9IDAgfHwgaCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZtLmVycm9yKCdJbnZhbGlkIGltYWdlIHNpemUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodyA9PSBvd2lkdGggJiYgaCA9PSBvaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZtLmVycm9yKCdJbWFnZSBzaXplIG5vdCBjaGFuZ2VkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2cuZWxmaW5kZXJkaWFsb2coJ2Nsb3NlJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtZDogJ3Jlc2l6ZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogZmlsZS5oYXNoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogdyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiB4LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiB5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWdyZWU6IGQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6IG1vZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmeTogeyB0eXBlOiAncmVzaXplJywgY250OiAxIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZnJkLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbnMgPSB7fSxcclxuICAgICAgICAgICAgICAgICAgICBobGluZSA9ICdlbGZpbmRlci1yZXNpemUtaGFuZGxlLWhsaW5lJyxcclxuICAgICAgICAgICAgICAgICAgICB2bGluZSA9ICdlbGZpbmRlci1yZXNpemUtaGFuZGxlLXZsaW5lJyxcclxuICAgICAgICAgICAgICAgICAgICBycG9pbnQgPSAnZWxmaW5kZXItcmVzaXplLWhhbmRsZS1wb2ludCcsXHJcbiAgICAgICAgICAgICAgICAgICAgc3JjID0gZm0udXJsKGZpbGUuaGFzaCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaW1nci5tb3VzZWRvd24ocm90YXRlLnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLm1vdXNldXAocm90YXRlLnN0b3ApO1xyXG5cclxuICAgICAgICAgICAgICAgIHVpcmVzaXplLmFwcGVuZCgkKHJvdykuYXBwZW5kKCQobGFiZWwpLnRleHQoZm0uaTE4bignd2lkdGgnKSkpLmFwcGVuZCh3aWR0aCkuYXBwZW5kKHJlc2V0KSlcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQocm93KS5hcHBlbmQoJChsYWJlbCkudGV4dChmbS5pMThuKCdoZWlnaHQnKSkpLmFwcGVuZChoZWlnaHQpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJChyb3cpLmFwcGVuZCgkKCc8bGFiZWwvPicpLnRleHQoZm0uaTE4bignYXNwZWN0UmF0aW8nKSkucHJlcGVuZChjb25zdHIpKSlcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQocm93KS5hcHBlbmQoZm0uaTE4bignc2NhbGUnKSArICcgJykuYXBwZW5kKHVpcHJvcCkpO1xyXG5cclxuICAgICAgICAgICAgICAgIHVpY3JvcC5hcHBlbmQoJChyb3cpLmFwcGVuZCgkKGxhYmVsKS50ZXh0KCdYJykpLmFwcGVuZChwb2ludFgpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJChyb3cpLmFwcGVuZCgkKGxhYmVsKS50ZXh0KCdZJykpLmFwcGVuZChwb2ludFkpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJChyb3cpLmFwcGVuZCgkKGxhYmVsKS50ZXh0KGZtLmkxOG4oJ3dpZHRoJykpKS5hcHBlbmQob2Zmc2V0WCkpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKHJvdykuYXBwZW5kKCQobGFiZWwpLnRleHQoZm0uaTE4bignaGVpZ2h0JykpKS5hcHBlbmQob2Zmc2V0WSkpO1xyXG5cclxuICAgICAgICAgICAgICAgIHVpcm90YXRlLmFwcGVuZCgkKHJvdylcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQobGFiZWwpLnRleHQoZm0uaTE4bigncm90YXRlJykpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGRpdiBzdHlsZT1cImZsb2F0OmxlZnQ7IHdpZHRoOiAxMzBweDtcIj4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXYgc3R5bGU9XCJmbG9hdDpsZWZ0O1wiPicpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGRlZ3JlZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHNwYW4vPicpLnRleHQoZm0uaTE4bignZGVncmVlJykpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCh1aWJ1dHRvbnNldCkuYXBwZW5kKHVpZGVnMjcwKS5hcHBlbmQoJCh1aXNlcGFyYXRvcikpLmFwcGVuZCh1aWRlZzkwKSlcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCh1aWRlZ3NsaWRlcilcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGRpYWxvZy5hcHBlbmQodWl0eXBlKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb250cm9sLmFwcGVuZCgkKHJvdykpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCh1aXJlc2l6ZSlcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKHVpY3JvcC5oaWRlKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCh1aXJvdGF0ZS5oaWRlKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2lucHV0LCBzZWxlY3QnKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJoYW5kbGUuYXBwZW5kKCc8ZGl2IGNsYXNzPVwiJyArIGhsaW5lICsgJyAnICsgaGxpbmUgKyAnLXRvcFwiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCInICsgaGxpbmUgKyAnICcgKyBobGluZSArICctYm90dG9tXCIvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnPGRpdiBjbGFzcz1cIicgKyB2bGluZSArICcgJyArIHZsaW5lICsgJy1sZWZ0XCIvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnPGRpdiBjbGFzcz1cIicgKyB2bGluZSArICcgJyArIHZsaW5lICsgJy1yaWdodFwiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCInICsgcnBvaW50ICsgJyAnICsgcnBvaW50ICsgJy1lXCIvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnPGRpdiBjbGFzcz1cIicgKyBycG9pbnQgKyAnICcgKyBycG9pbnQgKyAnLXNlXCIvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnPGRpdiBjbGFzcz1cIicgKyBycG9pbnQgKyAnICcgKyBycG9pbnQgKyAnLXNcIi8+Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcHJldmlldy5hcHBlbmQoc3Bpbm5lcikuYXBwZW5kKHJoYW5kbGUuaGlkZSgpKS5hcHBlbmQoaW1nLmhpZGUoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmhhbmRsZWMuY3NzKCdwb3NpdGlvbicsICdhYnNvbHV0ZScpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnPGRpdiBjbGFzcz1cIicgKyBobGluZSArICcgJyArIGhsaW5lICsgJy10b3BcIi8+JylcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCc8ZGl2IGNsYXNzPVwiJyArIGhsaW5lICsgJyAnICsgaGxpbmUgKyAnLWJvdHRvbVwiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCInICsgdmxpbmUgKyAnICcgKyB2bGluZSArICctbGVmdFwiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCInICsgdmxpbmUgKyAnICcgKyB2bGluZSArICctcmlnaHRcIi8+JylcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCc8ZGl2IGNsYXNzPVwiJyArIHJwb2ludCArICcgJyArIHJwb2ludCArICctblwiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCInICsgcnBvaW50ICsgJyAnICsgcnBvaW50ICsgJy1lXCIvPicpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnPGRpdiBjbGFzcz1cIicgKyBycG9pbnQgKyAnICcgKyBycG9pbnQgKyAnLXNcIi8+JylcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCc8ZGl2IGNsYXNzPVwiJyArIHJwb2ludCArICcgJyArIHJwb2ludCArICctd1wiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCInICsgcnBvaW50ICsgJyAnICsgcnBvaW50ICsgJy1uZVwiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCInICsgcnBvaW50ICsgJyAnICsgcnBvaW50ICsgJy1zZVwiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCInICsgcnBvaW50ICsgJyAnICsgcnBvaW50ICsgJy1zd1wiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJzxkaXYgY2xhc3M9XCInICsgcnBvaW50ICsgJyAnICsgcnBvaW50ICsgJy1ud1wiLz4nKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwcmV2aWV3LmFwcGVuZChiYXNlYy5jc3MoJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJykuaGlkZSgpLmFwcGVuZChpbWdjKS5hcHBlbmQocmhhbmRsZWMuYXBwZW5kKGNvdmVyYykpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwcmV2aWV3LmFwcGVuZChpbWdyLmhpZGUoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcHJldmlldy5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpO1xyXG5cclxuICAgICAgICAgICAgICAgIGRpYWxvZy5hcHBlbmQocHJldmlldykuYXBwZW5kKGNvbnRyb2wpO1xyXG5cclxuICAgICAgICAgICAgICAgIGJ1dHRvbnNbZm0uaTE4bignYnRuQXBwbHknKV0gPSBzYXZlO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uc1tmbS5pMThuKCdidG5DYW5jZWwnKV0gPSBmdW5jdGlvbigpIHsgZGlhbG9nLmVsZmluZGVyZGlhbG9nKCdjbG9zZScpOyB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGZtLmRpYWxvZyhkaWFsb2csIHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZmlsZS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiA2NTAsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzaXphYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBkZXN0cm95T25DbG9zZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBidXR0b25zOiBidXR0b25zLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wZW46IGZ1bmN0aW9uKCkgeyBwcmV2aWV3LnpJbmRleCgxICsgJCh0aGlzKS5wYXJlbnQoKS56SW5kZXgoKSk7IH1cclxuICAgICAgICAgICAgICAgIH0pLmF0dHIoJ2lkJywgaWQpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGZvciBJRSA8IDkgZGlhbG9nIG1pc2luZyBhdCBvcGVuIHNlY29uZCsgdGltZS5cclxuICAgICAgICAgICAgICAgIGlmIChmbS5VQS5sdElFOCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5lbGZpbmRlci1kaWFsb2cnKS5jc3MoJ2ZpbHRlcicsICcnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXNldC5jc3MoJ2xlZnQnLCB3aWR0aC5wb3NpdGlvbigpLmxlZnQgKyB3aWR0aC53aWR0aCgpICsgMTIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvdmVyYy5jc3MoeyAnb3BhY2l0eSc6IDAuMiwgJ2JhY2tncm91bmQtY29sb3InOiAnI2ZmZicsICdwb3NpdGlvbic6ICdhYnNvbHV0ZScgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgcmhhbmRsZWMuY3NzKCdjdXJzb3InLCAnbW92ZScpO1xyXG4gICAgICAgICAgICAgICAgcmhhbmRsZWMuZmluZCgnLmVsZmluZGVyLXJlc2l6ZS1oYW5kbGUtcG9pbnQnKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICdiYWNrZ3JvdW5kLWNvbG9yJzogJyNmZmYnLFxyXG4gICAgICAgICAgICAgICAgICAgICdvcGFjaXR5JzogMC41LFxyXG4gICAgICAgICAgICAgICAgICAgICdib3JkZXItY29sb3InOiAnIzAwMCdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGltZ3IuY3NzKCdjdXJzb3InLCAncG9pbnRlcicpO1xyXG5cclxuICAgICAgICAgICAgICAgIHVpdHlwZS5idXR0b25zZXQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwd2lkdGggPSBwcmV2aWV3LndpZHRoKCkgLSAocmhhbmRsZS5vdXRlcldpZHRoKCkgLSByaGFuZGxlLndpZHRoKCkpO1xyXG4gICAgICAgICAgICAgICAgcGhlaWdodCA9IHByZXZpZXcuaGVpZ2h0KCkgLSAocmhhbmRsZS5vdXRlckhlaWdodCgpIC0gcmhhbmRsZS5oZWlnaHQoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaW1nLmF0dHIoJ3NyYycsIHNyYyArIChzcmMuaW5kZXhPZignPycpID09PSAtMSA/ICc/JyA6ICcmJykgKyAnXz0nICsgTWF0aC5yYW5kb20oKSk7XHJcbiAgICAgICAgICAgICAgICBpbWdjLmF0dHIoJ3NyYycsIGltZy5hdHRyKCdzcmMnKSk7XHJcbiAgICAgICAgICAgICAgICBpbWdyLmF0dHIoJ3NyYycsIGltZy5hdHRyKCdzcmMnKSk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgIGRpYWxvZztcclxuXHJcblxyXG4gICAgICAgIGlmICghZmlsZXMubGVuZ3RoIHx8IGZpbGVzWzBdLm1pbWUuaW5kZXhPZignaW1hZ2UvJykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWQgPSAncmVzaXplLScgKyBmbS5uYW1lc3BhY2UgKyAnLScgKyBmaWxlc1swXS5oYXNoO1xyXG4gICAgICAgIGRpYWxvZyA9IGZtLmdldFVJKCkuZmluZCgnIycgKyBpZCk7XHJcblxyXG4gICAgICAgIGlmIChkaWFsb2cubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGRpYWxvZy5lbGZpbmRlcmRpYWxvZygndG9Ub3AnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgb3BlbihmaWxlc1swXSwgaWQpO1xyXG5cclxuICAgICAgICByZXR1cm4gZGZyZDtcclxuICAgIH07XHJcblxyXG59O1xyXG5cclxuKGZ1bmN0aW9uKCQpIHtcclxuXHJcbiAgICB2YXIgZmluZFByb3BlcnR5ID0gZnVuY3Rpb24oc3R5bGVPYmplY3QsIHN0eWxlQXJncykge1xyXG4gICAgICAgIHZhciBpID0gMDtcclxuICAgICAgICBmb3IgKGkgaW4gc3R5bGVBcmdzKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3R5bGVPYmplY3Rbc3R5bGVBcmdzW2ldXSAhPSAndW5kZWZpbmVkJylcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdHlsZUFyZ3NbaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN0eWxlT2JqZWN0W3N0eWxlQXJnc1tpXV0gPSAnJztcclxuICAgICAgICByZXR1cm4gc3R5bGVBcmdzW2ldO1xyXG4gICAgfTtcclxuXHJcbiAgICAkLmNzc0hvb2tzLnJvdGF0ZSA9IHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKGVsZW0sIGNvbXB1dGVkLCBleHRyYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJChlbGVtKS5yb3RhdGUoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24oZWxlbSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgJChlbGVtKS5yb3RhdGUodmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgICQuY3NzSG9va3MudHJhbnNmb3JtID0ge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24oZWxlbSwgY29tcHV0ZWQsIGV4dHJhKSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gZmluZFByb3BlcnR5KGVsZW0uc3R5bGUsXHJcbiAgICAgICAgICAgIFsnV2Via2l0VHJhbnNmb3JtJywgJ01velRyYW5zZm9ybScsICdPVHJhbnNmb3JtJywgJ21zVHJhbnNmb3JtJywgJ3RyYW5zZm9ybSddKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVsZW0uc3R5bGVbbmFtZV07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKGVsZW0sIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gZmluZFByb3BlcnR5KGVsZW0uc3R5bGUsXHJcbiAgICAgICAgICAgIFsnV2Via2l0VHJhbnNmb3JtJywgJ01velRyYW5zZm9ybScsICdPVHJhbnNmb3JtJywgJ21zVHJhbnNmb3JtJywgJ3RyYW5zZm9ybSddKTtcclxuICAgICAgICAgICAgZWxlbS5zdHlsZVtuYW1lXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAkLmZuLnJvdGF0ZSA9IGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsID09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIGlmICghIXdpbmRvdy5vcGVyYSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHIgPSB0aGlzLmNzcygndHJhbnNmb3JtJykubWF0Y2goL3JvdGF0ZVxcKCguKj8pXFwpLyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKHIgJiYgclsxXSkgP1xyXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQocGFyc2VGbG9hdChyWzFdKSAqIDE4MCAvIE1hdGguUEkpIDogMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciByID0gdGhpcy5jc3MoJ3RyYW5zZm9ybScpLm1hdGNoKC9yb3RhdGVcXCgoLio/KVxcKS8pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChyICYmIHJbMV0pID8gcGFyc2VJbnQoclsxXSkgOiAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY3NzKCd0cmFuc2Zvcm0nLFxyXG4gICAgICAgICAgICB0aGlzLmNzcygndHJhbnNmb3JtJykucmVwbGFjZSgvbm9uZXxyb3RhdGVcXCguKj9cXCkvLCAnJykgKyAncm90YXRlKCcgKyBwYXJzZUludCh2YWwpICsgJ2RlZyknKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcblxyXG4gICAgJC5meC5zdGVwLnJvdGF0ZSA9IGZ1bmN0aW9uKGZ4KSB7XHJcbiAgICAgICAgaWYgKGZ4LnN0YXRlID09IDApIHtcclxuICAgICAgICAgICAgZnguc3RhcnQgPSAkKGZ4LmVsZW0pLnJvdGF0ZSgpO1xyXG4gICAgICAgICAgICBmeC5ub3cgPSBmeC5zdGFydDtcclxuICAgICAgICB9XHJcbiAgICAgICAgJChmeC5lbGVtKS5yb3RhdGUoZngubm93KTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciA9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lID09IFwidW5kZWZpbmVkXCIpIHsgLy8gSUUgJiBJRTw5XHJcbiAgICAgICAgdmFyIEdldEFic29sdXRlWFkgPSBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwbm9kZSA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHZhciB4ID0gcG5vZGUub2Zmc2V0TGVmdDtcclxuICAgICAgICAgICAgdmFyIHkgPSBwbm9kZS5vZmZzZXRUb3A7XHJcblxyXG4gICAgICAgICAgICB3aGlsZSAocG5vZGUub2Zmc2V0UGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICBwbm9kZSA9IHBub2RlLm9mZnNldFBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmIChwbm9kZSAhPSBkb2N1bWVudC5ib2R5ICYmIHBub2RlLmN1cnJlbnRTdHlsZVsncG9zaXRpb24nXSAhPSAnc3RhdGljJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHBub2RlICE9IGRvY3VtZW50LmJvZHkgJiYgcG5vZGUgIT0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeCAtPSBwbm9kZS5zY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgIHkgLT0gcG5vZGUuc2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgeCArPSBwbm9kZS5vZmZzZXRMZWZ0O1xyXG4gICAgICAgICAgICAgICAgeSArPSBwbm9kZS5vZmZzZXRUb3A7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7IHg6IHgsIHk6IHkgfTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgU3RhdGljVG9BYnNvbHV0ZSA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuY3VycmVudFN0eWxlWydwb3NpdGlvbiddICE9ICdzdGF0aWMnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciB4eSA9IEdldEFic29sdXRlWFkoZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSB4eS54ICsgJ3B4JztcclxuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50b3AgPSB4eS55ICsgJ3B4JztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgSUVUcmFuc2Zvcm0gPSBmdW5jdGlvbihlbGVtZW50LCB0cmFuc2Zvcm0pIHtcclxuXHJcbiAgICAgICAgICAgIHZhciByO1xyXG4gICAgICAgICAgICB2YXIgbTExID0gMTtcclxuICAgICAgICAgICAgdmFyIG0xMiA9IDE7XHJcbiAgICAgICAgICAgIHZhciBtMjEgPSAxO1xyXG4gICAgICAgICAgICB2YXIgbTIyID0gMTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZWxlbWVudC5zdHlsZVsnbXNUcmFuc2Zvcm0nXSAhPSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFN0YXRpY1RvQWJzb2x1dGUoZWxlbWVudCk7XHJcblxyXG4gICAgICAgICAgICByID0gdHJhbnNmb3JtLm1hdGNoKC9yb3RhdGVcXCgoLio/KVxcKS8pO1xyXG4gICAgICAgICAgICB2YXIgcm90YXRlID0gKHIgJiYgclsxXSkgPyBwYXJzZUludChyWzFdKSA6IDA7XHJcblxyXG4gICAgICAgICAgICByb3RhdGUgPSByb3RhdGUgJSAzNjA7XHJcbiAgICAgICAgICAgIGlmIChyb3RhdGUgPCAwKSByb3RhdGUgPSAzNjAgKyByb3RhdGU7XHJcblxyXG4gICAgICAgICAgICB2YXIgcmFkaWFuID0gcm90YXRlICogTWF0aC5QSSAvIDE4MDtcclxuICAgICAgICAgICAgdmFyIGNvc1ggPSBNYXRoLmNvcyhyYWRpYW4pO1xyXG4gICAgICAgICAgICB2YXIgc2luWSA9IE1hdGguc2luKHJhZGlhbik7XHJcblxyXG4gICAgICAgICAgICBtMTEgKj0gY29zWDtcclxuICAgICAgICAgICAgbTEyICo9IC1zaW5ZO1xyXG4gICAgICAgICAgICBtMjEgKj0gc2luWTtcclxuICAgICAgICAgICAgbTIyICo9IGNvc1g7XHJcblxyXG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLmZpbHRlciA9IChlbGVtZW50LnN0eWxlLmZpbHRlciB8fCAnJykucmVwbGFjZSgvcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm1cXC5NaWNyb3NvZnRcXC5NYXRyaXhcXChbXildKlxcKS8sIFwiXCIpICtcclxuICAgICAgICAgICAgKFwicHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0Lk1hdHJpeChcIiArXHJcbiAgICAgICAgICAgICAgICBcIk0xMT1cIiArIG0xMSArXHJcbiAgICAgICAgICAgICAgICBcIixNMTI9XCIgKyBtMTIgK1xyXG4gICAgICAgICAgICAgICAgXCIsTTIxPVwiICsgbTIxICtcclxuICAgICAgICAgICAgICAgIFwiLE0yMj1cIiArIG0yMiArXHJcbiAgICAgICAgICAgICAgICBcIixGaWx0ZXJUeXBlPSdiaWxpbmVhcicsc2l6aW5nTWV0aG9kPSdhdXRvIGV4cGFuZCcpXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIG93ID0gcGFyc2VJbnQoZWxlbWVudC5zdHlsZS53aWR0aCB8fCBlbGVtZW50LndpZHRoIHx8IDApO1xyXG4gICAgICAgICAgICB2YXIgb2ggPSBwYXJzZUludChlbGVtZW50LnN0eWxlLmhlaWdodCB8fCBlbGVtZW50LmhlaWdodCB8fCAwKTtcclxuXHJcbiAgICAgICAgICAgIHZhciByYWRpYW4gPSByb3RhdGUgKiBNYXRoLlBJIC8gMTgwO1xyXG4gICAgICAgICAgICB2YXIgYWJzQ29zWCA9IE1hdGguYWJzKE1hdGguY29zKHJhZGlhbikpO1xyXG4gICAgICAgICAgICB2YXIgYWJzU2luWSA9IE1hdGguYWJzKE1hdGguc2luKHJhZGlhbikpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGR4ID0gKG93IC0gKG93ICogYWJzQ29zWCArIG9oICogYWJzU2luWSkpIC8gMjtcclxuICAgICAgICAgICAgdmFyIGR5ID0gKG9oIC0gKG93ICogYWJzU2luWSArIG9oICogYWJzQ29zWCkpIC8gMjtcclxuXHJcbiAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUubWFyZ2luTGVmdCA9IE1hdGguZmxvb3IoZHgpICsgXCJweFwiO1xyXG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLm1hcmdpblRvcCA9IE1hdGguZmxvb3IoZHkpICsgXCJweFwiO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuKHRydWUpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciB0cmFuc2Zvcm1fc2V0ID0gJC5jc3NIb29rcy50cmFuc2Zvcm0uc2V0O1xyXG4gICAgICAgICQuY3NzSG9va3MudHJhbnNmb3JtLnNldCA9IGZ1bmN0aW9uKGVsZW0sIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybV9zZXQuYXBwbHkodGhpcywgW2VsZW0sIHZhbHVlXSk7XHJcbiAgICAgICAgICAgIElFVHJhbnNmb3JtKGVsZW0sIHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG59KShqUXVlcnkpOyIsIlwidXNlIHN0cmljdFwiOyAvKipcbiAqIEBjbGFzcyAgZWxGaW5kZXIgY29tbWFuZCBcInNvcnRcIlxuICogQ2hhbmdlIHNvcnQgZmlsZXMgcnVsZVxuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5zb3J0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAvKipcblx0ICogQ29tbWFuZCBvcHRpb25zXG5cdCAqXG5cdCAqIEB0eXBlICBPYmplY3Rcblx0ICovXHJcbiAgICB0aGlzLm9wdGlvbnMgPSB7IHVpOiAnc29ydGJ1dHRvbicgfTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oaGFzaGVzLCBzb3J0KSB7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbSxcclxuICAgICAgICAgICAgc29ydCA9ICQuZXh0ZW5kKHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IGZtLnNvcnRUeXBlLFxyXG4gICAgICAgICAgICAgICAgb3JkZXI6IGZtLnNvcnRPcmRlcixcclxuICAgICAgICAgICAgICAgIHN0aWNrOiBmbS5zb3J0U3RpY2tGb2xkZXJzXHJcbiAgICAgICAgICAgIH0sIHNvcnQpO1xyXG5cclxuICAgICAgICB0aGlzLmZtLnNldFNvcnQoc29ydC50eXBlLCBzb3J0Lm9yZGVyLCBzb3J0LnN0aWNrKTtcclxuICAgICAgICByZXR1cm4gJC5EZWZlcnJlZCgpLnJlc29sdmUoKTtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7IC8qKlxuICogQGNsYXNzICBlbEZpbmRlciBjb21tYW5kIFwibmV0bW91bnRcIlxuICogTW91bnQgbmV0d29yayB2b2x1bWUgd2l0aCB1c2VyIGNyZWRlbnRpYWxzLlxuICpcbiAqIEBhdXRob3IgRG1pdHJ5IChkaW8pIExldmFzaG92XG4gKiovXHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5uZXRtb3VudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIHRoaXMuYWx3YXlzRW5hYmxlZCA9IHRydWU7XHJcbiAgICB0aGlzLnVwZGF0ZU9uU2VsZWN0ID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5kcml2ZXJzID0gW107XHJcblxyXG4gICAgdGhpcy5oYW5kbGVycyA9IHtcclxuICAgICAgICBsb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5kcml2ZXJzID0gdGhpcy5mbS5uZXREcml2ZXJzO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZHJpdmVycy5sZW5ndGggPyAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGZtID0gc2VsZi5mbSxcclxuICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKSxcclxuICAgICAgICAgICAgY3JlYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXRzID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm90b2NvbDogJCgnPHNlbGVjdC8+JyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3Q6ICQoJzxpbnB1dCB0eXBlPVwidGV4dFwiLz4nKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9ydDogJCgnPGlucHV0IHR5cGU9XCJ0ZXh0XCIvPicpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiAkKCc8aW5wdXQgdHlwZT1cInRleHRcIiB2YWx1ZT1cIi9cIi8+JyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6ICQoJzxpbnB1dCB0eXBlPVwidGV4dFwiLz4nKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFzczogJCgnPGlucHV0IHR5cGU9XCJwYXNzd29yZFwiLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0cyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGZtLmkxOG4oJ25ldE1vdW50RGlhbG9nVGl0bGUnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXphYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWw6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc3Ryb3lPbkNsb3NlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgc2VsZi5kaWFsb2c7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZnJkLnN0YXRlKCkgPT0gJ3BlbmRpbmcnICYmIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHt9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gJCgnPHRhYmxlIGNsYXNzPVwiZWxmaW5kZXItaW5mby10YiBlbGZpbmRlci1uZXRtb3VudC10YlwiLz4nKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkLmVhY2goc2VsZi5kcml2ZXJzLCBmdW5jdGlvbihpLCBwcm90b2NvbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlucHV0cy5wcm90b2NvbC5hcHBlbmQoJzxvcHRpb24gdmFsdWU9XCInICsgcHJvdG9jb2wgKyAnXCI+JyArIGZtLmkxOG4ocHJvdG9jb2wpICsgJzwvb3B0aW9uPicpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICQuZWFjaChpbnB1dHMsIGZ1bmN0aW9uKG5hbWUsIGlucHV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZSAhPSAncHJvdG9jb2wnICYmIGlucHV0LmFkZENsYXNzKCd1aS1jb3JuZXItYWxsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5hcHBlbmQoJCgnPHRyLz4nKS5hcHBlbmQoJCgnPHRkPicgKyBmbS5pMThuKG5hbWUpICsgJzwvdGQ+JykpLmFwcGVuZCgkKCc8dGQvPicpLmFwcGVuZChpbnB1dCkpKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIG9wdHMuYnV0dG9uc1tmbS5pMThuKCdidG5Nb3VudCcpXSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0geyBjbWQ6ICduZXRtb3VudCcgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGlucHV0cywgZnVuY3Rpb24obmFtZSwgaW5wdXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9ICQudHJpbShpbnB1dC52YWwoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhW25hbWVdID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZGF0YS5ob3N0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmZtLnRyaWdnZXIoJ2Vycm9yJywgeyBlcnJvcjogJ2Vyck5ldE1vdW50SG9zdFJlcScgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmZtLnJlcXVlc3QoeyBkYXRhOiBkYXRhLCBub3RpZnk6IHsgdHlwZTogJ25ldG1vdW50JywgY250OiAxIH0gfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oKSB7IGRmcmQucmVzb2x2ZSgpOyB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikgeyBkZnJkLnJlamVjdChlcnJvcik7IH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmRpYWxvZy5lbGZpbmRlcmRpYWxvZygnY2xvc2UnKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBvcHRzLmJ1dHRvbnNbZm0uaTE4bignYnRuQ2FuY2VsJyldID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5kaWFsb2cuZWxmaW5kZXJkaWFsb2coJ2Nsb3NlJyk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZtLmRpYWxvZyhjb250ZW50LCBvcHRzKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKCFzZWxmLmRpYWxvZykge1xyXG4gICAgICAgICAgICBzZWxmLmRpYWxvZyA9IGNyZWF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGRmcmQucHJvbWlzZSgpO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLm1vcmUgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMub3B0aW9ucyA9IHsgdWk6ICdtb3JlYnV0dG9uJyB9O1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsID0gdGhpcy5mbS5zZWxlY3RlZEZpbGVzKCk7XHJcblxyXG4gICAgICAgIHJldHVybiBzZWwubGVuZ3RoID49IDEgPyAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oY29tbWFuZE5hbWUpIHtcclxuICAgICAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBjb20sXHJcbiAgICAgICAgICAgIGMgPSAnY2xhc3MnLFxyXG4gICAgICAgICAgICBkaXNhYmxlZCA9IGZtLnJlcyhjLCAnZGlzYWJsZWQnKSxcclxuICAgICAgICAgICAgY29tbWFuZHMgPSBmbS5fY29tbWFuZHM7XHJcblxyXG4gICAgICAgIGlmICgoY29tID0gY29tbWFuZHNbY29tbWFuZE5hbWVdKSkge1xyXG4gICAgICAgICAgICBpZiAoISQodGhpcykuaXMoJy4nICsgZGlzYWJsZWQpKSB7XHJcbiAgICAgICAgICAgICAgICBjb20uZXhlYygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAkLkRlZmVycmVkKCkucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIlxyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMuaW5mb2JhcmNtZCA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuXHQgICAgaWYgKHRoaXMuZm0uc2VsZWN0ZWRGaWxlcygpLmxlbmd0aCA+PTEpIHJldHVybiAwO1xyXG5cdCAgICBlbHNlIHJldHVybiAtMTtcclxuXHR9XHJcblx0XHJcblx0dGhpcy5leGVjID0gZnVuY3Rpb24oaW5mbykge1xyXG5cdCAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG5cdCAgICAgICAgYyA9ICdjbGFzcycsXHJcblx0ICAgICAgICBpY29uQ2xhc3MgPSBcImVsZmluZGVyLWN3ZC1pY29uIHtjbGFzc30gdWktY29ybmVyLWFsbFwiLFxyXG5cdCAgICAgICAgc2VsID0gdGhpcy5mbS5zZWxlY3RlZEZpbGVzKCksXHJcblx0ICAgICAgICBkaXNhYmxlZCA9IGZtLnJlcyhjLCAnZGlzYWJsZWQnKSxcclxuXHQgICAgICAgIGluZm9iYXIgPSBmbS51aVsnaW5mb2JhciddLFxyXG4gICAgICAgICAgICBzZWxibG9jayA9IGluZm9iYXIuZmluZCgnLnNlbGVjdGJsb2NrJyksXHJcblx0ICAgICAgICBpY29uID0gaW5mb2Jhci5maW5kKFwiLnNlbGVjdGljbyBzcGFuOmZpcnN0XCIpLFxyXG5cdCAgICAgICAgbmFtZSA9IGluZm9iYXIuZmluZChcIi50aXRsZVwiKSxcclxuXHQgICAgICAgIGxhc3RDaGFuZ2UgPSBpbmZvYmFyLmZpbmQoXCIuZGF0ZWJsb2NrIHNwYW4uZGF0ZXNwYW5cIiksXHJcbiAgICAgICAgICAgIHNpemUgPSBpbmZvYmFyLmZpbmQoXCIuZGF0ZWJsb2NrIHNwYW4uc2l6ZXNwYW5cIiksXHJcblx0ICAgICAgICBjcnlwdEluZm8gPSBpbmZvYmFyLmZpbmQoXCIuc2lnbmF0dXJlXCIpLFxyXG4gICAgICAgICAgICBjcnlwdGJsb2NrID0gJzxkaXYgY2xhc3M9XCJoYXZlc2lnXCI+JyArXHJcblx0XHRcdCc8ZGl2IGNsYXNzPVwiaWNvYmxvY2tcIj4nK1xyXG5cclxuXHRcdFx0XHQnPHNwYW4gY2xhc3M9XCJ7aWNvbn1cIj48L3NwYW4+JyArXHJcblx0XHRcdCc8L2Rpdj4nK1xyXG5cdFx0XHQnPGRpdiBjbGFzcz1cInRleHRibG9ja1wiPicrXHJcblx0XHRcdFx0JzxkaXYgY2xhc3M9XCJ0b3BcIj4nK1xyXG5cdFx0XHRcdFx0JzxkaXYgY2xhc3M9XCJhY3Rpb250aXRsZVwiPicrXHJcblx0XHRcdFx0XHRcdCc8YSBocmVmPVwiI1wiIGNsYXNzPVwiYWN0aW9uXCI+e2FjdGlvbn08L2E+JyArXHJcblx0XHRcdFx0XHQnPC9kaXY+JytcclxuXHRcdFx0XHQnPC9kaXY+JytcclxuXHRcdFx0XHQnPGRpdiBjbGFzcz1cImJvdHRvbVwiPicrXHJcblx0XHRcdFx0JzwvZGl2PicrXHJcblx0XHRcdCc8L2Rpdj4nK1xyXG5cdFx0XHQnPC9kaXY+JyxcclxuXHJcbiAgICAgICAgICAgIGNyeXB0bGlzdCA9IFwiPGRpdiBjbGFzcz0nY2VydC1saXN0Jz5cIiArXHJcbiAgICAgICAgICAgICAgICBcIjxzcGFuIGNsYXNzPSdlbGZpbmRlci1idXR0b24taWNvbiBlbGZpbmRlci1idXR0b24taWNvbi17aWNvbn0nLz5cIitcclxuICAgICAgICAgICAgICAgIFwiPHNwYW4gY2xhc3M9J2xpc3QtdHlwZSc+e3R5cGV9PC9zcGFuPlwiICtcclxuXHQgICAgICAgICAgICBcIjxzcGFuIGNsYXNzPSdsaXN0LWNvdW50Jz4oe2NvdW50fSk8L3NwYW4+XCIgK1xyXG5cdCAgICAgICAgICAgIFwiPHNwYW4gY2xhc3M9J2VsZmluZGVyLWJ1dHRvbi1pY29uIGVsZmluZGVyLWJ1dHRvbi1pY29uLWluZm8tbW9yZScvPlwiLFxyXG5cdCAgICAgICAgY2xlYXIgPSBmdW5jdGlvbigpIHtcclxuXHQgICAgICAgICAgICBpZiAoaW5mb2Jhcikge1xyXG5cdCAgICAgICAgICAgICAgICBpY29uLnJlbW92ZUNsYXNzKCk7XHJcblx0ICAgICAgICAgICAgICAgIG5hbWUudGV4dChcIlwiKTtcclxuXHQgICAgICAgICAgICAgICAgbGFzdENoYW5nZS50ZXh0KFwiXCIpO1xyXG5cdCAgICAgICAgICAgICAgICBjcnlwdEluZm8uZW1wdHkoKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9LFxyXG4gICAgICAgICAgICBpdGVtID0gJ2VsZmluZGVyLWJ1dHRvbi1tZW51LWl0ZW0nLFxyXG4gICAgICAgICAgICBob3ZlciA9IGZtLnJlcygnY2xhc3MnLCAnaG92ZXInKSxcclxuICAgICAgICAgICAgbWVudSA9ICQoJzxkaXYgY2xhc3M9XCJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgZWxmaW5kZXItYnV0dG9uLW1lbnUgdWktY29ybmVyLWFsbFwiLz4nKVxyXG5cdCAgICAgICAgICAgIC5oaWRlKClcclxuXHQgICAgICAgICAgICAvLy5kZWxlZ2F0ZSgnLicgKyBpdGVtLCAnaG92ZXInLCBmdW5jdGlvbiAoKSB7ICQodGhpcykudG9nZ2xlQ2xhc3MoaG92ZXIpOyB9KVxyXG5cdCAgICAgICAgICAgIC5kZWxlZ2F0ZSgnLicgKyBpdGVtLCAnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG5cdCAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0ICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0ICAgICAgICAgICAgICAgIG1lbnUuaGlkZSgpO1xyXG5cdCAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBoaWRlPWZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgbWVudS5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGFkZEl0ZW0gPSBmdW5jdGlvbiAodHlwZSwgYmxvY2spIHtcclxuICAgICAgICAgICAgICAgICAgICBtZW51LmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwiJyArIGl0ZW0gKyAnXCIvPicpLmFwcGVuZChibG9jaykpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0sXHJcblx0ICAgICAgICBnZXRCbG9jayA9IGZ1bmN0aW9uICh0eXBlLCBjZXJ0aW5mbykge1xyXG5cclxuXHJcblx0ICAgICAgICAgICAgdmFyIGljb25jbCA9IHR5cGUgPT0gMSA/ICdlbmNyeXB0JyA6ICdzaWduJztcclxuXHQgICAgICAgICAgICB2YXIgYmxvY2sgPSBjcnlwdGJsb2NrLnJlcGxhY2UoJ3tpY29ufScsICdlbGZpbmRlci1jd2QtaWNvbiBlbGZpbmRlci1jd2QtaWNvbi0nICsgaWNvbmNsICsgJyB1aS1jb3JuZXItYWxsJyk7XHJcblx0ICAgICAgICAgICAgYmxvY2sgPSBibG9jay5yZXBsYWNlKCd7YWN0aW9ufScsIHR5cGUgPT0gMSA/IGZtLmkxOG4oXCJlbmNyeXB0ZWRcIikgOiBmbS5pMThuKFwic2lnbmVkXCIpKTtcclxuXHQgICAgICAgICAgICBcclxuXHQgICAgICAgICAgICB2YXIgY29tLCBidXR0b24sIGxpbms7XHJcblx0ICAgICAgICAgICAgYmxvY2sgPSAkKGJsb2NrKTtcclxuXHQgICAgICAgICAgICBpZiAoY2VydGluZm8uVGh1bWJwcmludCAmJiBjZXJ0aW5mby5TdWJqZWN0TmFtZSkge1xyXG5cdCAgICAgICAgICAgICAgICBpZiAoKGNvbSA9IGZtLl9jb21tYW5kc1snY2VydGRvd25sb2FkJ10pKSB7XHJcblx0ICAgICAgICAgICAgICAgICAgICBidXR0b24gPSAnZWxmaW5kZXInICsgJ2xpbmtidXR0b24nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNUZXN0ID0gY2VydGluZm8uSXNUZXN0ID8gJzxzcGFuIGNsYXNzPVwidGVzdC1jZXJ0aWZpY2F0ZS1pY29uIG5vLXBhZGRpbmcganMtdGVzdC1jZXJ0aWZpY2F0ZS10aXBcIiBpZD1cInRlc3RUaXAtJytjZXJ0aW5mby5UaHVtYnByaW50KydcIj48L3NwYW4+JytjZXJ0aW5mby5TdWJqZWN0TmFtZSA6IGNlcnRpbmZvLlN1YmplY3ROYW1lO1xyXG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKCQuZm5bYnV0dG9uXSkgbGluayA9ICQoJzxkaXYvPicpW2J1dHRvbl0oY29tLCBjZXJ0aW5mby5UaHVtYnByaW50LCBpc1Rlc3QpO1xyXG5cdCAgICAgICAgICAgICAgICAgICAgYmxvY2suZmluZChcIi5ib3R0b21cIikuYXBwZW5kKGxpbmspO1xyXG5cdCAgICAgICAgICAgICAgICB9XHJcblxyXG5cdCAgICAgICAgICAgICAgICB2YXIgY29tbWFuZE5hbWUgPSB0eXBlID09IDEgPyAnZGVjcnlwdCcgOiAnY2hlY2tzaWduJztcclxuXHQgICAgICAgICAgICAgICAgaWYgKChjb20gPSBmbS5fY29tbWFuZHNbY29tbWFuZE5hbWVdKSkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgYnV0dG9uID0gJ2VsZmluZGVyJyArICdsaW5rYnV0dG9uJztcclxuXHQgICAgICAgICAgICAgICAgICAgIGlmICgkLmZuW2J1dHRvbl0pIGxpbmsgPSAkKCc8ZGl2Lz4nKVtidXR0b25dKGNvbSk7XHJcblx0ICAgICAgICAgICAgICAgICAgICBibG9jay5maW5kKFwiLmFjdGlvbnRpdGxlXCIpLmFwcGVuZChsaW5rKTtcclxuXHQgICAgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIH0gZWxzZSB7XHJcblx0ICAgICAgICAgICAgICAgIGJsb2NrLmZpbmQoXCIuYWN0aW9udGl0bGVcIikuY3NzKCdwYWRkaW5nLXRvcCcsJzExcHgnKTtcclxuXHQgICAgICAgICAgICB9XHJcblxyXG5cdCAgICAgICAgICAgIHJldHVybiBibG9jaztcclxuXHQgICAgICAgIH07XHJcblxyXG5cdCAgICBpZiAoaW5mbykge1xyXG5cdCAgICAgICAgY3J5cHRJbmZvLmVtcHR5KCk7XHJcblx0ICAgICAgICBpbmZvYmFyLmZpbmQoXCIuZGF0ZWJsb2NrIGRpdiBkaXZcIikuYWRkQ2xhc3MoJ3VpLXN0YXRlLWRpc2FibGVkJyk7XHJcblx0ICAgICAgICBpZiAoaW5mbyA9PSAnRW1wdHknKSB7XHJcblx0ICAgICAgICAgICAgY3J5cHRJbmZvLnByZXBlbmQoJChcIjxoMz5cIikudGV4dChmbS5pMThuKFwiZW1wdHljcnlwdGluZm9cIikpKTtcclxuXHQgICAgICAgIH1lbHNlIGlmIChpbmZvLkNlcnRpZmljYXRlcy5sZW5ndGg9PTApIHtcclxuXHQgICAgICAgICAgICBjcnlwdEluZm8ucHJlcGVuZCgkKFwiPGgzPlwiKS50ZXh0KGZtLmkxOG4oXCJjcnlwdGluZm9ub2NlcnRcIikpKTtcclxuXHQgICAgICAgIH1lbHNlIHtcclxuXHQgICAgICAgICAgICBpZiAoaW5mby5DZXJ0aWZpY2F0ZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5mby5DZXJ0aWZpY2F0ZXMubGVuZ3RoOyBpKyspIHtcclxuXHQgICAgICAgICAgICAgICAgICAgIHZhciBjZXJ0ID0gaW5mby5DZXJ0aWZpY2F0ZXNbaV07XHJcblx0ICAgICAgICAgICAgICAgICAgICBhZGRJdGVtKGluZm8uRmlsZVR5cGUsIGdldEJsb2NrKGluZm8uRmlsZVR5cGUsIGNlcnQpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGljb25jbCA9IGluZm8uRmlsZVR5cGUgPT0gMSA/ICdlbmNyeXB0JyA6ICdzaWduJztcclxuICAgICAgICAgICAgICAgICAgICBjcnlwdGxpc3QgPSBjcnlwdGxpc3QucmVwbGFjZSgne2ljb259JyxpY29uY2wpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyeXB0bGlzdCA9IGNyeXB0bGlzdC5yZXBsYWNlKCd7dHlwZX0nLCBpbmZvLkZpbGVUeXBlID09IDEgPyBmbS5pMThuKFwiZW5jcnlwdGVkXCIpIDogZm0uaTE4bihcInNpZ25lZFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3J5cHRsaXN0ID0gY3J5cHRsaXN0LnJlcGxhY2UoJ3tjb3VudH0nLCBpbmZvLkNlcnRpZmljYXRlcy5sZW5ndGggKycgJyArIGZtLmkxOG4oXCJ0aW1lc1wiKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNyeXB0bGlzdCA9ICQoY3J5cHRsaXN0KS5iaW5kKCdob3ZlcicsIGZ1bmN0aW9uICgpIHsgJCh0aGlzKS50b2dnbGVDbGFzcyhob3Zlcik7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyeXB0bGlzdC5maW5kKCcuZWxmaW5kZXItYnV0dG9uLWljb24nKS5jbGljayhmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZW51LnNsaWRlVG9nZ2xlKDEwMCk7XHJcblx0ICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuXHQgICAgICAgICAgICAgICAgY3J5cHRJbmZvLmFwcGVuZChjcnlwdGxpc3QpO1xyXG5cdCAgICAgICAgICAgICAgICBjcnlwdEluZm8uYXBwZW5kKG1lbnUpO1xyXG5cclxuXHQgICAgICAgICAgICAgICAgZm0uYmluZCgnZGlzYWJsZSBzZWxlY3QnLCBoaWRlKS5nZXRVSSgpLmNsaWNrKGhpZGUpO1xyXG5cdCAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG5cdCAgICAgICAgICAgICAgICBjcnlwdEluZm8uYXBwZW5kKGdldEJsb2NrKGluZm8uRmlsZVR5cGUsIGluZm8uQ2VydGlmaWNhdGVzWzBdKSk7XHJcblx0ICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHJlZ1RpcE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGlwSm9pbnQ6IFwibGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICcjZmZmNWQyJyxcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXJSYWRpdXM6IDQsXHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICcjZmVlOGFlJ1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICQoXCIuanMtdGVzdC1jZXJ0aWZpY2F0ZS10aXBcIikuZWFjaChmdW5jdGlvbihpLGVsKXtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgT3BlbnRpcCgkKGVsKSwgJ9Ch0LXRgNGC0LjRhNC40LrQsNGCINCy0YvQv9GD0YnQtdC9INCx0LXQtyDRg9GH0LDRgdGC0LjRjzxicj7QsNC60LrRgNC10LTQuNGC0L7QstCw0L3QvdC+0LPQviDQo9C00L7RgdGC0L7QstC10YDRj9GO0YnQtdCz0L48YnI+0KbQtdC90YLRgNCwINC4INC90LUg0LjQvNC10LXRgiDRjtGA0LjQtNC40YfQtdGB0LrQvtC5INGB0LjQu9GLLicsICcnLCByZWdUaXBPcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cdCAgICAgICAgfVxyXG5cclxuXHQgICAgICAgIHJldHVybiAkLkRlZmVycmVkKCkucmVzb2x2ZSgpO1xyXG5cdCAgICB9XHJcblxyXG5cdCAgICBpZiAoaW5mb2Jhcikge1xyXG5cdCAgICAgICAgY2xlYXIoKTtcclxuXHQgICAgICAgIHZhciBmaWxlO1xyXG4gICAgICAgICAgICB2YXIgYWNjZXB0RXh0ID0gWydvZHMnLCd4bHMnLCd4bHNiJywneGxzeCcsJ29kcycsJ3hsc2InLCd4bHNtJywneGxzeCcsJ29kcCcsJ3BvdCcsJ3BvdG0nLCdwb3R4JyxcclxuICAgICAgICAgICAgICAgICdwcHMnLCdwcHNtJywncHBzeCcsJ3BwdCcsJ3BwdG0nLCdwcHR4Jywnb2RwJywncHBzeCcsJ3BwdHgnLCdkb2MnLCdkb2NtJywnZG9jeCcsJ2RvdCcsXHJcbiAgICAgICAgICAgICAgICAnZG90bScsJ2RvdHgnLCdvZHQnLCdwZGYnLCdvbmUnLCdvbmV0b2MyJywnanBnJywnanBlZycsJ2dpZicsJ3BuZycsJ2JtcCcsJ3htbCddO1xyXG4gICAgICAgICAgICB2YXIgZXh0ID0gJyc7XHJcblx0ICAgICAgICBpZiAoc2VsLmxlbmd0aCA9PSAxICYmIChmaWxlID0gc2VsWzBdKSAmJiBmaWxlICYmIGZpbGUubWltZSAhPSBcImRpcmVjdG9yeVwiKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUubmFtZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4dCA9IGZpbGUubmFtZS5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV4dCA9IGV4dFtleHQubGVuZ3RoLTFdO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJChpbmZvYmFyKS5maW5kKFwiLmpzLXZpc2F1bGl6ZVwiKS5kYXRhKCd0eXBlJyxmaWxlLlZpc3VhbGl6YXRpb25UeXBlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjY2VwdEV4dC5pbmRleE9mKGV4dC50b0xvd2VyQ2FzZSgpKSAhPT0gLTEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoaW5mb2JhcikuZmluZChcIi5qcy12aXNhdWxpemVcIikuY3NzKCdkaXNwbGF5JywgJ2Jsb2NrJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoaW5mb2JhcikuZmluZChcIi5qcy12aXNhdWxpemVcIikuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cdCAgICAgICAgICAgIGljb25DbGFzcyA9IGljb25DbGFzcy5yZXBsYWNlKCd7Y2xhc3N9JywgZm0ubWltZTJjbGFzcyhmaWxlLm1pbWUpKTtcclxuXHQgICAgICAgICAgICBpY29uLnJlbW92ZUNsYXNzKCkuYWRkQ2xhc3MoaWNvbkNsYXNzKTtcclxuXHQgICAgICAgICAgICBuYW1lLnRleHQoZmlsZS5uYW1lKTtcclxuXHQgICAgICAgICAgICBsYXN0Q2hhbmdlLnRleHQoZm0uZm9ybWF0RGF0ZShmaWxlKSk7XHJcblx0ICAgICAgICAgICAgc2l6ZS50ZXh0KGZtLmZvcm1hdFNpemUoZmlsZS5zaXplKSk7XHJcblx0ICAgICAgICAgICAgJChpbmZvYmFyKS5maW5kKFwiLnJlbmFtZTpmaXJzdFwiKS5jc3MoJ2Rpc3BsYXknLCAnYmxvY2snKTtcclxuXHQgICAgICAgICAgICAkKGluZm9iYXIpLmZpbmQoXCIuZGF0ZWJsb2NrOmZpcnN0XCIpLmNzcygnZGlzcGxheScsICdibG9jaycpO1xyXG5cdCAgICAgICAgICAgIHNlbGJsb2NrLnNob3coKTtcclxuXHQgICAgICAgIH0gZWxzZSBpZiAoc2VsLmxlbmd0aCA+IDEpIHtcclxuXHQgICAgICAgICAgICAkKGluZm9iYXIpLmZpbmQoXCIucmVuYW1lOmZpcnN0XCIpLmNzcygnZGlzcGxheScsICdub25lJyk7XHJcblx0ICAgICAgICAgICAgJChpbmZvYmFyKS5maW5kKFwiLmRhdGVibG9jazpmaXJzdFwiKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xyXG5cdCAgICAgICAgICAgIGljb25DbGFzcyA9IGljb25DbGFzcy5yZXBsYWNlKCd7Y2xhc3N9JywgJ2VsZmluZGVyLWN3ZC1pY29uLWdyb3VwJyk7XHJcblx0ICAgICAgICAgICAgaWNvbi5yZW1vdmVDbGFzcygpLmFkZENsYXNzKGljb25DbGFzcyk7XHJcblx0ICAgICAgICAgICAgbmFtZS50ZXh0KGZtLmkxOG4oXCJpbmZvc2VsXCIpICsgc2VsLmxlbmd0aCk7XHJcblx0ICAgICAgICAgICAgc2VsYmxvY2suc2hvdygpO1xyXG5cdCAgICAgICAgfSBlbHNlIHNlbGJsb2NrLmhpZGUoKTtcclxuXHQgICAgfVxyXG5cdCAgICByZXR1cm4gJC5EZWZlcnJlZCgpLnJlc29sdmUoKTtcclxuXHR9XHJcbn0iLCJcInVzZSBzdHJpY3RcIjtcclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLmVuY3J5cHQgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbCA9IHRoaXMuZm0uc2VsZWN0ZWRGaWxlcygpLFxyXG4gICAgICAgICAgICBjbnQgPSBzZWwubGVuZ3RoO1xyXG5cclxuICAgICAgICB2YXIgZmlsZXMgPSAkLm1hcChzZWwsIGZ1bmN0aW9uKGYpIHsgcmV0dXJuIGYubWltZSA9PSAnZGlyZWN0b3J5JyA/IG51bGwgOiBmOyB9KTtcclxuICAgICAgICByZXR1cm4gY250ID49IDEgJiYgY250ID09IGZpbGVzLmxlbmd0aCA/IDAgOiAtMTtcclxuICAgIH07XHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihoYXNoZXMpIHtcclxuICAgICAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBjd2QgPSBmbS5jd2QoKS5oYXNoLFxyXG4gICAgICAgICAgICBmaWxlcyA9IHRoaXMuZmlsZXMoaGFzaGVzKSxcclxuICAgICAgICAgICAgY250ID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICBkZnJkID0gJC5EZWZlcnJlZCgpXHJcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yICYmIGZtLmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWNudCB8fCB0aGlzLl9kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQuZWFjaChmaWxlcywgZnVuY3Rpb24oaSwgZmlsZSkge1xyXG4gICAgICAgICAgICBpZiAoIWZpbGUucGhhc2gpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJSbScsIGZpbGUubmFtZSwgJ2VyclBlcm0nXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZpbGUubG9ja2VkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gIWRmcmQucmVqZWN0KFsnZXJyTG9ja2VkJywgZmlsZS5uYW1lXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGRmcmQuc3RhdGUoKSA9PSAncGVuZGluZycpIHtcclxuICAgICAgICAgICAgZmlsZXMgPSB0aGlzLmhhc2hlcyhoYXNoZXMpO1xyXG5cclxuICAgICAgICAgICAgLy9mbS5sb2NrZmlsZXMoeyBmaWxlczogZmlsZXMgfSk7XHJcbiAgICAgICAgICAgIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAnZW5jcnlwdCcsIHRhcmdldHM6IGZpbGVzIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZ5OiB7IHR5cGU6ICdlbmNyeXB0JywgY250OiBjbnQgfSxcclxuICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RmFpbDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChjb20gPSBmbS5fY29tbWFuZHNbJ3Bvc3QnXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbS5leGVjKGZtLk1hc3RlclVybCwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGZyZC5kb25lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKS5hbHdheXMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9mbS51bmxvY2tmaWxlcyh7IGZpbGVzOiBmaWxlcyB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGRmcmQ7XHJcbiAgICB9O1xyXG59OyIsIlwidXNlIHN0cmljdFwiO1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMuZGVjcnlwdCA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsID0gdGhpcy5mbS5zZWxlY3RlZEZpbGVzKCksXHJcbiAgICAgICAgICAgIGNudCA9IHNlbC5sZW5ndGg7XHJcblxyXG4gICAgICAgIHZhciBmaWxlcyA9ICQubWFwKHNlbCwgZnVuY3Rpb24oZikgeyByZXR1cm4gZi5taW1lID09ICdkaXJlY3RvcnknID8gbnVsbCA6IGY7IH0pO1xyXG4gICAgICAgIHJldHVybiBjbnQgPj0gMSAmJiBjbnQgPT0gZmlsZXMubGVuZ3RoID8gMCA6IC0xO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm0sXHJcbiAgICAgICAgICAgIGN3ZCA9IGZtLmN3ZCgpLmhhc2gsXHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5maWxlcyhoYXNoZXMpLFxyXG4gICAgICAgICAgICBjbnQgPSBmaWxlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgJiYgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghY250IHx8IHRoaXMuX2Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5lYWNoKGZpbGVzLCBmdW5jdGlvbihpLCBmaWxlKSB7XHJcbiAgICAgICAgICAgIGlmICghZmlsZS5waGFzaCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFkZnJkLnJlamVjdChbJ2VyclJtJywgZmlsZS5uYW1lLCAnZXJyUGVybSddKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZmlsZS5sb2NrZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJMb2NrZWQnLCBmaWxlLm5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoZGZyZC5zdGF0ZSgpID09ICdwZW5kaW5nJykge1xyXG4gICAgICAgICAgICBmaWxlcyA9IHRoaXMuaGFzaGVzKGhhc2hlcyk7XHJcblxyXG4gICAgICAgICAgICAvL2ZtLmxvY2tmaWxlcyh7IGZpbGVzOiBmaWxlcyB9KTtcclxuICAgICAgICAgICAgZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdkZWNyeXB0JywgdGFyZ2V0czogZmlsZXMgfSxcclxuICAgICAgICAgICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ2RlY3J5cHQnLCBjbnQ6IGNudCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZlbnRGYWlsOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZnJkLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGNvbSA9IGZtLl9jb21tYW5kc1sncG9zdCddKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tLmV4ZWMoZm0uTWFzdGVyVXJsLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZnJkLmRvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL2ZtLnVubG9ja2ZpbGVzKHsgZmlsZXM6IGZpbGVzIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZGZyZDtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5jaGVja3NpZ24gPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbCA9IHRoaXMuZm0uc2VsZWN0ZWRGaWxlcygpLFxyXG4gICAgICAgICAgICBjbnQgPSBzZWwubGVuZ3RoO1xyXG5cclxuICAgICAgICB2YXIgZmlsZXMgPSAkLm1hcChzZWwsIGZ1bmN0aW9uKGYpIHsgcmV0dXJuIGYubWltZSA9PSAnZGlyZWN0b3J5JyA/IG51bGwgOiBmOyB9KTtcclxuICAgICAgICByZXR1cm4gY250ID49IDEgJiYgY250ID09IGZpbGVzLmxlbmd0aCA/IDAgOiAtMTtcclxuICAgIH07XHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihoYXNoZXMpIHtcclxuICAgICAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBjd2QgPSBmbS5jd2QoKS5oYXNoLFxyXG4gICAgICAgICAgICBmaWxlcyA9IHRoaXMuZmlsZXMoaGFzaGVzKSxcclxuICAgICAgICAgICAgY250ID0gZmlsZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICBkZnJkID0gJC5EZWZlcnJlZCgpXHJcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yICYmIGZtLmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWNudCB8fCB0aGlzLl9kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQuZWFjaChmaWxlcywgZnVuY3Rpb24oaSwgZmlsZSkge1xyXG4gICAgICAgICAgICBpZiAoIWZpbGUucGhhc2gpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJSbScsIGZpbGUubmFtZSwgJ2VyclBlcm0nXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZpbGUubG9ja2VkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gIWRmcmQucmVqZWN0KFsnZXJyTG9ja2VkJywgZmlsZS5uYW1lXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGRmcmQuc3RhdGUoKSA9PSAncGVuZGluZycpIHtcclxuICAgICAgICAgICAgZmlsZXMgPSB0aGlzLmhhc2hlcyhoYXNoZXMpO1xyXG5cclxuICAgICAgICAgICAgLy9mbS5sb2NrZmlsZXMoeyBmaWxlczogZmlsZXMgfSk7XHJcbiAgICAgICAgICAgIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAnY2hlY2tzaWduJywgdGFyZ2V0czogZmlsZXMgfSxcclxuICAgICAgICAgICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ2NoZWNrc2lnbicsIGNudDogY250IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmVudEZhaWw6IHRydWVcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb207XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoY29tID0gZm0uX2NvbW1hbmRzWydwb3N0J10pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb20uZXhlYyhmbS5NYXN0ZXJVcmwsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQuZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICkuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vZm0udW5sb2NrZmlsZXMoeyBmaWxlczogZmlsZXMgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBkZnJkO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLnJlY2VpdmVkbWFpbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICBmbSA9IHNlbGYuZm07XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcblxyXG4gICAgZm0uYmluZCgncmVjZWl2ZWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGd1aWQgPSBmbS5HZXRSZWNlaXZlZE1haWxJZCgpO1xyXG4gICAgICAgIGlmIChndWlkKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZXhlYyhndWlkKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHZhciAkZWxGaW5kZXIgPSAkKCcjZWxmaW5kZXInKTtcclxuXHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICAkZWxGaW5kZXIuZmluZCgnI21vZGFsIC5wb3B1cCcpLnBhcmVudCgpLnJlbW92ZSgpO1xyXG5cclxuICAgICAgICB2YXIgZGlzYWJsZWQgPSBmbS5yZXMoJ2NsYXNzJywgJ2Rpc2FibGVkJyksXHJcbiAgICAgICAgICAgIGhvdmVyID0gZm0ucmVzKCdjbGFzcycsICdob3ZlcicpLFxyXG4gICAgICAgICAgICBwb3B1cCA9ICQoJzxkaXYgaWQ9XCJtb2RhbFwiPjxkaXYgY2xhc3M9XCJ3aW5kb3cgcmVjZWl2ZWQtcG9wdXAgcG9wdXBcIj4nICtcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGVhZGVyXCI+PGgyPicgKyBmbS5pMThuKFwicmVjZWl2ZWRtYWlsaGVhZGVyXCIpICsgJzwvaDI+PGRpdiBjbGFzcz1cImNsb3NlXCI+PC9kaXY+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInNjcm9sbC13cmFwXCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInNjcm9sbGVyXCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImltZ1wiPicgK1xyXG4gICAgICAgICAgICAgICAgJzxpbWcgc3JjPVwiLi4vLi4vQ29udGVudC9JbWFnZXMvcHJlbG9hZGVyLkdJRlwiPicgK1xyXG4gICAgICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpbmZvXCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1lc3NhZ2VcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICc8L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZG9jdW1lbnRzLWxpc3QgdWktaGVscGVyLWNsZWFyZml4IGVsZmluZGVyLWN3ZCB1aS1zZWxlY3RhYmxlIHVpLWRyb3BwYWJsZSBlbGZpbmRlci1jd2Qtdmlldy1saXN0XCI+PHRhYmxlPjwvdGFibGU+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInNjcm9sbGVyX19iYXItd3JhcHBlclwiPjxkaXYgY2xhc3M9XCJzY3JvbGxlcl9fYmFyXCI+PC9kaXY+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImJ1dHRvbnMgcmlnaHRcIj4nICtcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uc2V0XCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVpLXN0YXRlLWRlZmF1bHQgZWxmaW5kZXItYnV0dG9uIGVsZmluZGVyLWxpbmstYnV0dG9uXCIgdGl0bGU9XCInICsgZm0uaTE4bignY21kY2FuY2VsMicpICsgJ1wiPicgK1xyXG4gICAgICAgICAgICAgICAgJzxhIGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uLXRleHRcIj4nICsgZm0uaTE4bignY21kY2FuY2VsMicpICsgJzwvYT48L2Rpdj48L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZWxmaW5kZXItYnV0dG9uc2V0IGJ0biBidG4tYmlnIGJ0bi1ncmVlblwiPicgKyBmbS5pMThuKCdnb21hc3RlcicpICsgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgLy8nPGRpdiBjbGFzcz1cImVsZmluZGVyLWJ1dHRvbnNldCB1aS1lbGZpbmRlci1idXR0b24tZ3JlZW5cIj4nICtcclxuICAgICAgICAgICAgICAgIC8vJzxkaXYgY2xhc3M9XCJ1aS1zdGF0ZS1kZWZhdWx0IGVsZmluZGVyLWJ1dHRvblwiIHRpdGxlPVwiJyArIGZtLmkxOG4oJ2dvbWFzdGVyJykgKyAnXCI+JyArXHJcbiAgICAgICAgICAgICAgICAvLyc8c3BhbiBjbGFzcz1cImVsZmluZGVyLWJ1dHRvbi10ZXh0XCI+JyArIGZtLmkxOG4oJ2dvbWFzdGVyJykgKyAnPC9zcGFuPjwvZGl2PjwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PicpLFxyXG4gICAgICAgICAgICBtYWluYnV0ID0gcG9wdXAuZmluZCgnLmJ0bi5idG4tYmlnLmJ0bi1ncmVlbicpLmFkZENsYXNzKGRpc2FibGVkKSxcclxuICAgICAgICAgICAgZG9jdW1lbnQgPSAnJyArXHJcbiAgICAgICAgICAgICAgICAnPHRyICBjbGFzcz1cImVsZmluZGVyLWN3ZC1maWxlIGRvY3VtZW50IGpzLXZpc3VhbGl6ZVwiID4nICtcclxuICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJuYW1lXCIgdGl0bGU9XCJ7dGl0bGV9XCI+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImVsZmluZGVyLWN3ZC1maWxlLXdyYXBwZXJcIj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImVsZmluZGVyLWN3ZC1pY29uIHtpY29ufVwiPjwvc3Bhbj4nICtcclxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImVsZmluZGVyLWN3ZC1maWxlbmFtZVwiPnt0aXRsZX08L3NwYW4+JyArXHJcbiAgICAgICAgICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRvcFwiPicgK1xyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJwYXRoIGpzLXBhdGhcIiBzdHlsZT1cImRpc3BsYXk6bm9uZVwiPntwYXRofTwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJsYXN0Q2hhbmdlXCIgc3R5bGU9XCJkaXNwbGF5Om5vbmVcIj57bGFzdENoYW5nZX08L2Rpdj4nICtcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwib3BlcmF0aW9udHlwZVwiIHN0eWxlPVwiZGlzcGxheTpub25lXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPC90ZD4nICtcclxuICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJraW5kXCIgdGl0bGU9XCJ7dHlwZX1cIj57dHlwZX08L3RkPicgK1xyXG4gICAgICAgICAgICAgICAgJzx0ZCBjbGFzcz1cImFjdGlvbnMgdGV4dC1yaWdodCByaWdodFwiID48YSBocmVmPVwiI1wiIGNsYXNzPVwiYWN0aW9uXCI+PC9hPjwvdGQ+JyArXHJcbiAgICAgICAgICAgICAgICAnPC90cj4nLFxyXG5cclxuICAgICAgICAgICAgYWN0aW9uSGFuZGxlciA9IGZ1bmN0aW9uIChtZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbTtcclxuICAgICAgICAgICAgICAgIHZhciBmaWxlID0geyBuYW1lOiBudWxsLCBwYXRoOiBudWxsLCBsYXN0Q2hhbmdlOiBudWxsLCBtaW1lOiBudWxsIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jID0gJChtZSkucGFyZW50cygnLmRvY3VtZW50Jyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGRvYy5maW5kKCcudG9wIC5vcGVyYXRpb250eXBlJykudGV4dCgpO1xyXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoID0gZG9jLmZpbmQoJy50b3AgLnBhdGgnKS50ZXh0KCk7XHJcbiAgICAgICAgICAgICAgICBmaWxlLmxhc3RDaGFuZ2UgPSBkb2MuZmluZCgnLnRvcCAubGFzdENoYW5nZScpLnRleHQoKTtcclxuICAgICAgICAgICAgICAgIGlmICgoY29tID0gZm0uX2NvbW1hbmRzWydwb3N0J10pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7IFR5cGU6IHR5cGUsIEZpbGVzOiBbXSB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuRmlsZXMucHVzaChmaWxlKTtcclxuICAgICAgICAgICAgICAgICAgICBjb20uZXhlYyhmbS5NYXN0ZXJVcmwsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBhZGRGaWxlc0luUG9wdXAgPSBmdW5jdGlvbiAoZnMpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIWZzLmxlbmd0aCB8fCBmcy5sZW5ndGggPT0gMCkgc2hvd0Vycm9yQmxvY2soKTtcclxuICAgICAgICAgICAgICAgIHBvcHVwLmZpbmQoJy5pbWcnKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZnMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IGZzW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvY1BhdHRlcm4gPSBkb2N1bWVudDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jUGF0dGVybiA9IGRvY1BhdHRlcm4ucmVwbGFjZSgne3RpdGxlfScsIGZpbGUubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jUGF0dGVybiA9IGRvY1BhdHRlcm4ucmVwbGFjZSgne3RpdGxlfScsIGZpbGUubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jUGF0dGVybiA9IGRvY1BhdHRlcm4ucmVwbGFjZSgne3BhdGh9JywgZmlsZS5wYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICBkb2NQYXR0ZXJuID0gZG9jUGF0dGVybi5yZXBsYWNlKCd7bGFzdENoYW5nZX0nLCBmaWxlLmxhc3RDaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY1BhdHRlcm4gPSBkb2NQYXR0ZXJuLnJlcGxhY2UoJ3tpY29ufScsIGZtLm1pbWUyY2xhc3MoZmlsZS5taW1lKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jUGF0dGVybiA9IGRvY1BhdHRlcm4ucmVwbGFjZSgne3R5cGV9JywgZm0ubWltZTJraW5kKGZpbGUpKTtcclxuICAgICAgICAgICAgICAgICAgICBkb2NQYXR0ZXJuID0gZG9jUGF0dGVybi5yZXBsYWNlKCd7dHlwZX0nLCBmbS5taW1lMmtpbmQoZmlsZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY1BhdHRlcm4gPSAkKGRvY1BhdHRlcm4pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZXh0ID0gZmlsZS5uYW1lLnNwbGl0KCcuJykucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNtZCA9IGRvY1BhdHRlcm4uZmluZChcIi5yaWdodCBhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gZmlsZS50eXBlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY21kLnRleHQoZm0uaTE4bignY21kJyArICdkZWNyeXB0JykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2NQYXR0ZXJuLmZpbmQoXCIudG9wIC5vcGVyYXRpb250eXBlXCIpLnRleHQodHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZC5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25IYW5kbGVyKCQodGhpcykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gNCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQudGV4dChmbS5pMThuKCdjbWQnICsgJ2NoZWNrc2lnbicpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jUGF0dGVybi5maW5kKFwiLnRvcCAub3BlcmF0aW9udHlwZVwiKS50ZXh0KHR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQuY2xpY2soZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkhhbmRsZXIoJCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSA2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtZC50ZXh0KGZtLmkxOG4oJ2NtZCcgKyAnZGVjcnlwdGFuZGNoZWNrc2lnbicpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jUGF0dGVybi5maW5kKFwiLnRvcCAub3BlcmF0aW9udHlwZVwiKS50ZXh0KHR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbWQuY2xpY2soZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkhhbmRsZXIoJCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY21kLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcG9wdXAuZmluZCgnLmRvY3VtZW50cy1saXN0IHRhYmxlJykuYXBwZW5kKGRvY1BhdHRlcm4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjaGVja0J1dHRvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwb3B1cC5maW5kKCcuZG9jdW1lbnRzLWxpc3QnKS5pcygnOmVtcHR5JykpIHtcclxuICAgICAgICAgICAgICAgICAgICBtYWluYnV0LnJlbW92ZUNsYXNzKGhvdmVyKS5hZGRDbGFzcyhkaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG1haW5idXQucmVtb3ZlQ2xhc3MoZGlzYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzaG93RXJyb3JCbG9jayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHBvcHVwLmZpbmQoJy5pbmZvJykuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgcG9wdXAuZmluZCgnLmltZycpLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIHBvcHVwLmZpbmQoJy5pbmZvIC5tZXNzYWdlJylcclxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2Vycm9yJylcclxuICAgICAgICAgICAgICAgICAgICAudGV4dChmbS5pMThuKCdlcnJyZWNlaXZlZG1haWwnKSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yICYmIGZtLmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIGNoZWNrQnV0dG9uKCk7XHJcbiAgICAgICAgcG9wdXAuZmluZCgnLmluZm8nKS5oaWRlKCk7XHJcbiAgICAgICAgcG9wdXAuZmluZCgnLmNsb3NlJylcclxuICAgICAgICAgICAgLmJpbmQoJ2hvdmVyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS50b2dnbGVDbGFzcyhob3Zlcik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KCc/JylbMF07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIHBvcHVwLmZpbmQoJy5idXR0b25zIC5lbGZpbmRlci1saW5rLWJ1dHRvbiBhJykuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KCc/JylbMF07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIG1haW5idXRcclxuICAgICAgICAgICAgLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIW1haW5idXQuaXMoJy4nICsgZGlzYWJsZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvY0xpc3QgPSBwb3B1cC5maW5kKCcuZG9jdW1lbnRzLWxpc3QnKS5jaGlsZHJlbigpLmZpbmQoJ3RyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7IFR5cGU6IG51bGwsIEZpbGVzOiBbXSB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0eXBlcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICQuZWFjaChkb2NMaXN0LCBmdW5jdGlvbiAoaSwgZG9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvYyA9ICQoZG9jKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGUgPSB7IG5hbWU6IG51bGwsIHBhdGg6IG51bGwsIGxhc3RDaGFuZ2U6IG51bGwsIG1pbWU6IG51bGwgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZXMucHVzaChkb2MuZmluZCgnLnRvcCAub3BlcmF0aW9udHlwZScpLnRleHQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUucGF0aCA9IGRvYy5maW5kKCcudG9wIC5wYXRoJykudGV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmxhc3RDaGFuZ2UgPSBkb2MuZmluZCgnLnRvcCAubGFzdENoYW5nZScpLnRleHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5GaWxlcy5wdXNoKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0eXBlMSA9IHR5cGVzWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1bmRlZk9wZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdHlwZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVzW2tleV0gIT0gdHlwZTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVmT3BlciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF1bmRlZk9wZXIgJiYgdHlwZTEgIT0gXCJcIikgZGF0YS5UeXBlID0gdHlwZTE7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKGNvbSA9IGZtLl9jb21tYW5kc1sncG9zdCddKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb20uZXhlYyhmbS5NYXN0ZXJVcmwsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmJpbmQoXCJtb3VzZWVudGVyIG1vdXNlbGVhdmVcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY2hlY2tCdXR0b24oKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmJpbmQoJ2hvdmVyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgISQodGhpcykuaXMoJy4nICsgZGlzYWJsZWQpICYmICQodGhpcykudG9nZ2xlQ2xhc3MoaG92ZXIpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJGVsRmluZGVyLmFwcGVuZChwb3B1cCk7XHJcblxyXG4gICAgICAgIHdpbmRvdy5zY3JvbGwgPSBiYXJvbih7XHJcbiAgICAgICAgICAgIHJvb3Q6ICcuc2Nyb2xsLXdyYXAnLFxyXG4gICAgICAgICAgICBzY3JvbGxlcjogJy5zY3JvbGxlcicsXHJcbiAgICAgICAgICAgIGJhcjogJy5zY3JvbGxlcl9fYmFyJyxcclxuICAgICAgICAgICAgYmFyT25DbHM6ICdiYXJvbidcclxuICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuICAgICAgICBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdyZWNpdmVkbWFpbCcsIGZpbGVHcm91cFNlbmRJZDogaWQgfSxcclxuICAgICAgICAgICAgcHJldmVudEZhaWw6IHRydWVcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmFpbChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHNob3dFcnJvckJsb2NrKCk7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZSAmJiB3aW5kb3cuY29uc29sZS5sb2cgJiYgd2luZG93LmNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBhZGRGaWxlc0luUG9wdXAoZGF0YS5GaWxlcyk7XHJcbiAgICAgICAgICAgICAgICAkKCcuanMtdmlzdWFsaXplJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoZS50YXJnZXQpLmhhc0NsYXNzKCdhY3Rpb24nKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9ICQodGhpcykuZmluZCgnLmpzLXBhdGgnKS5odG1sKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHRFeHQgPSBbJ29kcycsJ3hscycsJ3hsc2InLCd4bHN4Jywnb2RzJywneGxzYicsJ3hsc20nLCd4bHN4Jywnb2RwJywncG90JywncG90bScsJ3BvdHgnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAncHBzJywncHBzbScsJ3Bwc3gnLCdwcHQnLCdwcHRtJywncHB0eCcsJ29kcCcsJ3Bwc3gnLCdwcHR4JywnZG9jJywnZG9jbScsJ2RvY3gnLCdkb3QnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZG90bScsJ2RvdHgnLCdvZHQnLCdwZGYnLCdvbmUnLCdvbmV0b2MyJywnanBnJywnanBlZycsJ2dpZicsJ3BuZycsJ2JtcCcsJ3htbCddO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gIHBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZXh0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IG5hbWVbbmFtZS5sZW5ndGgtMV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0ID0gbmFtZS5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBleHQgPSBleHRbZXh0Lmxlbmd0aC0xXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjY2VwdEV4dC5pbmRleE9mKGV4dC50b0xvd2VyQ2FzZSgpKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZmFuY3lib3goJyNuby12aXN1YWxpemUnLHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3cmFwQ1NTIDogJ25vLXZpc3VhbGlzZU1vZGFsJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvU2l6ZVx0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9SZXNpemVcdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxpbmc6ICdubycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXJDbG9zZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy52aXN1YWxTdGF0ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvaGVscGVyL0dldFZpc3VhbGl6YXRpb25JbmZvJyxhc3luYzogZmFsc2UsdHlwZTogXCJHRVRcIixkYXRhOiB7ZmlsZW5hbWU6IHBhdGh9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdC5FcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZW4gPSAxMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5hbWUubGVuZ3RoID4gbGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSAnLi4uJytuYW1lLnN1YnN0cmluZyhuYW1lLmxlbmd0aC1sZW4sIG5hbWUubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5WaXN1YWxpemF0aW9uVXJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZW5nPTQwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZS5sZW5ndGggPiBsZW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gJy4uLicrbmFtZS5zdWJzdHJpbmcobmFtZS5sZW5ndGgtbGVuZywgbmFtZS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZmFuY3lib3goe2hyZWYgOiByZXN1bHQuVmlzdWFsaXphdGlvblVybCx0eXBlOiAnaWZyYW1lJ30se1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyczoge3RpdGxlOiB7cG9zaXRpb246ICd0b3AnfX0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aFx0OiA3MDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgICAgICA6IDEwMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5XaWR0aFx0OiAyMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvU2l6ZVx0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1Jlc2l6ZVx0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsaW5nOiAnbm8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wUmF0aW86IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW46IFsyMCwgMjAsIDkwLCAyMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUNsaWNrXHQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkVmZmVjdFx0OiAnZmFkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3cmFwQ1NTICAgICA6ICd2aXN1YWxpc2VNb2RhbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZSAgICAgICA6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlckNsb3NlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cudmlzdWFsU3RhdGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZmFuY3lib3goXCI8aW1nIGFsaWduPSdjZW50ZXInIHdpZHRoPScxMDAlJyBzdHlsZT0nbWFyZ2luOiAwIGF1dG87ZGlzcGxheTogYmxvY2s7JyBzcmM9J2RhdGE6aW1hZ2UvanBnO2Jhc2U2NCxcIityZXN1bHQuQmFzZTY0UGljdHVyZStcIic+XCIse1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyczoge3RpdGxlOiB7cG9zaXRpb246ICd0b3AnfX0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3BlY3RSYXRpbyA6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXRUb1ZpZXdcdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TaXplXHQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvUmVzaXplXHQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxpbmc6ICdubycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3BSYXRpbzogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbjogWzIwLCAyMCwgOTAsIDIwXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlQ2xpY2tcdDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVuRWZmZWN0XHQ6ICdmYWRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBDU1MgICAgIDogJ3Zpc3VhbGlzZU1vZGFsJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlICAgICAgIDogbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyQ2xvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy52aXN1YWxTdGF0ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZmFuY3lib3goJyNuby12aXN1YWxpemUnLHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JhcENTUyA6ICduby12aXN1YWxpc2VNb2RhbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TaXplXHQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9SZXNpemVcdDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsaW5nOiAnbm8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlckNsb3NlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy52aXN1YWxTdGF0ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAocmVxdWVzdCwgZXJyb3IsIHJlc3VsdCkge31cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2hlY2tCdXR0b24oKTtcclxuICAgICAgICAgICAgICAgIGRmcmQuZG9uZSgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuYWx3YXlzKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zY3JvbGwgJiYgd2luZG93LnNjcm9sbC51cGRhdGUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGRmcmQ7XHJcbiAgICB9XHJcbn07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMub3BlbnNlbmRwb3B1cCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzLFxyXG4gICAgICAgIGZpbHRlciA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgICAgICByZXR1cm4gJC5tYXAoc2VsZi5maWxlcyhoYXNoZXMpLCBmdW5jdGlvbihmKSB7IHJldHVybiBmLm1pbWUgPT0gJ2RpcmVjdG9yeScgPyBudWxsIDogZjsgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsID0gdGhpcy5mbS5zZWxlY3RlZCgpLFxyXG4gICAgICAgICAgICBjbnQgPSBzZWwubGVuZ3RoO1xyXG5cclxuICAgICAgICByZXR1cm4gc2VsLmxlbmd0aCA+PSAxICYmIHNlbC5sZW5ndGggPD0gMzAgJiYgY250ID09IGZpbHRlcihzZWwpLmxlbmd0aCA/IDAgOiAtMTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oaGFzaGVzKSB7XHJcbiAgICAgICAgJCgnI2VsZmluZGVyJykuZmluZCgnI21vZGFsJykucmVtb3ZlKCk7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbSxcclxuICAgICAgICAgICAgZmlsZXMgPSB0aGlzLmhhc2hlcyhoYXNoZXMpLFxyXG4gICAgICAgICAgICBzcmMgPSAnL0RlZmF1bHQvc2VuZG1haWw/cGFyZW50PWVsZmluZGVyJmZpbGVzPScsXHJcbiAgICAgICAgICAgIHBvcHVwID0gJzxkaXYgaWQ9XCJtb2RhbFwiPjxkaXYgY2xhc3M9XCJ3aW5kb3cgc2VuZC1wb3B1cCBwb3B1cFwiPicgK1xyXG4gICAgICAgICAgICAgICAgJzxpZnJhbWUgc3JjPVwie3NyY31cIiBzdHlsZT1cImJvcmRlcjogbm9uZTtoZWlnaHQ6IDUwMHB4O3dpZHRoOiAxMDAlO1wiPjwvaWZyYW1lPicgK1xyXG4gICAgICAgICAgICAgICAgJzwvZGl2PjwvZGl2PicsXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgJiYgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdnZXR1cmknLCB0YXJnZXRzOiBmaWxlcyB9LFxyXG4gICAgICAgICAgICAgICAgcHJldmVudEZhaWw6IHRydWVcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVyaSA9IGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShkYXRhLkZpbGVzKSk7XHJcbiAgICAgICAgICAgICAgICBzcmMgPSBzcmMgKyB1cmk7XHJcbiAgICAgICAgICAgICAgICBwb3B1cCA9IHBvcHVwLnJlcGxhY2UoJ3tzcmN9Jywgc3JjKTtcclxuICAgICAgICAgICAgICAgICQoJyNlbGZpbmRlcicpLmFwcGVuZChwb3B1cCk7XHJcblxyXG4gICAgICAgICAgICAgICAgd2luZG93LmhpZGVQb3B1cCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjZWxmaW5kZXInKS5maW5kKCcjbW9kYWwgLnBvcHVwJykucGFyZW50KCkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBkZnJkLmRvbmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59OyIsIlwidXNlIHN0cmljdFwiO1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMuZGVjcnlwdGFuZGNoZWNrc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsID0gdGhpcy5mbS5zZWxlY3RlZEZpbGVzKCksXHJcbiAgICAgICAgICAgIGNudCA9IHNlbC5sZW5ndGg7XHJcblxyXG4gICAgICAgIHZhciBmaWxlcyA9ICQubWFwKHNlbCwgZnVuY3Rpb24oZikgeyByZXR1cm4gZi5taW1lID09ICdkaXJlY3RvcnknID8gbnVsbCA6IGY7IH0pO1xyXG4gICAgICAgIHJldHVybiBjbnQgPj0gMSAmJiBjbnQgPT0gZmlsZXMubGVuZ3RoID8gMCA6IC0xO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm0sXHJcbiAgICAgICAgICAgIGN3ZCA9IGZtLmN3ZCgpLmhhc2gsXHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5maWxlcyhoYXNoZXMpLFxyXG4gICAgICAgICAgICBjbnQgPSBmaWxlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgJiYgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghY250IHx8IHRoaXMuX2Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5lYWNoKGZpbGVzLCBmdW5jdGlvbihpLCBmaWxlKSB7XHJcbiAgICAgICAgICAgIGlmICghZmlsZS5waGFzaCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFkZnJkLnJlamVjdChbJ2VyclJtJywgZmlsZS5uYW1lLCAnZXJyUGVybSddKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZmlsZS5sb2NrZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJMb2NrZWQnLCBmaWxlLm5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoZGZyZC5zdGF0ZSgpID09ICdwZW5kaW5nJykge1xyXG4gICAgICAgICAgICBmaWxlcyA9IHRoaXMuaGFzaGVzKGhhc2hlcyk7XHJcblxyXG4gICAgICAgICAgICAvL2ZtLmxvY2tmaWxlcyh7IGZpbGVzOiBmaWxlcyB9KTtcclxuICAgICAgICAgICAgZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdkZWNyeXB0YW5kY2hlY2tzaWduJywgdGFyZ2V0czogZmlsZXMgfSxcclxuICAgICAgICAgICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ2RlY3J5cHRhbmRjaGVja3NpZ24nLCBjbnQ6IGNudCB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZlbnRGYWlsOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZnJkLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGNvbSA9IGZtLl9jb21tYW5kc1sncG9zdCddKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tLmV4ZWMoZm0uTWFzdGVyVXJsLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZnJkLmRvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL2ZtLnVubG9ja2ZpbGVzKHsgZmlsZXM6IGZpbGVzIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZGZyZDtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5zaWduYW5kZW5jcnlwdCA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsID0gdGhpcy5mbS5zZWxlY3RlZEZpbGVzKCksXHJcbiAgICAgICAgICAgIGNudCA9IHNlbC5sZW5ndGg7XHJcblxyXG4gICAgICAgIHZhciBmaWxlcyA9ICQubWFwKHNlbCwgZnVuY3Rpb24oZikgeyByZXR1cm4gZi5taW1lID09ICdkaXJlY3RvcnknID8gbnVsbCA6IGY7IH0pO1xyXG4gICAgICAgIHJldHVybiBjbnQgPj0gMSAmJiBjbnQgPT0gZmlsZXMubGVuZ3RoID8gMCA6IC0xO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm0sXHJcbiAgICAgICAgICAgIGN3ZCA9IGZtLmN3ZCgpLmhhc2gsXHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5maWxlcyhoYXNoZXMpLFxyXG4gICAgICAgICAgICBjbnQgPSBmaWxlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgJiYgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghY250IHx8IHRoaXMuX2Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5lYWNoKGZpbGVzLCBmdW5jdGlvbihpLCBmaWxlKSB7XHJcbiAgICAgICAgICAgIGlmICghZmlsZS5waGFzaCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFkZnJkLnJlamVjdChbJ2VyclJtJywgZmlsZS5uYW1lLCAnZXJyUGVybSddKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZmlsZS5sb2NrZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJMb2NrZWQnLCBmaWxlLm5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoZGZyZC5zdGF0ZSgpID09ICdwZW5kaW5nJykge1xyXG4gICAgICAgICAgICBmaWxlcyA9IHRoaXMuaGFzaGVzKGhhc2hlcyk7XHJcblxyXG4gICAgICAgICAgICAvL2ZtLmxvY2tmaWxlcyh7IGZpbGVzOiBmaWxlcyB9KTtcclxuICAgICAgICAgICAgZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdzaWduYW5kZW5jcnlwdCcsIHRhcmdldHM6IGZpbGVzIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgbm90aWZ5OiB7IHR5cGU6ICdzaWduYW5kZW5jcnlwdCcsIGNudDogY250IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmVudEZhaWw6IHRydWVcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb207XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoY29tID0gZm0uX2NvbW1hbmRzWydwb3N0J10pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb20uZXhlYyhmbS5NYXN0ZXJVcmwsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQuZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICkuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vZm0udW5sb2NrZmlsZXMoeyBmaWxlczogZmlsZXMgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBkZnJkO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLmFkZCA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsID0gdGhpcy5mbS5zZWxlY3RlZEZpbGVzKCksXHJcbiAgICAgICAgICAgIGNudCA9IHNlbC5sZW5ndGg7XHJcblxyXG4gICAgICAgIHZhciBmaWxlcyA9ICQubWFwKHNlbCwgZnVuY3Rpb24oZikge1xyXG4gICAgICAgICAgICByZXR1cm4gZi5taW1lID09ICdkaXJlY3RvcnknID8gbnVsbCA6IGY7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGNudCA+PSAxICYmIGNudCA9PSBmaWxlcy5sZW5ndGggPyAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oaGFzaGVzLCBvcHRzKSB7XHJcblxyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm0sXHJcbiAgICAgICAgICAgIGN3ZCA9IGZtLmN3ZCgpLmhhc2gsXHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5maWxlcyhoYXNoZXMpLFxyXG4gICAgICAgICAgICBjbnQgPSBmaWxlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgJiYgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghY250IHx8IHRoaXMuX2Rpc2FibGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZnJkLnJlamVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5lYWNoKGZpbGVzLCBmdW5jdGlvbihpLCBmaWxlKSB7XHJcbiAgICAgICAgICAgIGlmICghZmlsZS5waGFzaCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFkZnJkLnJlamVjdChbJ2VyclJtJywgZmlsZS5uYW1lLCAnZXJyUGVybSddKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZmlsZS5sb2NrZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJMb2NrZWQnLCBmaWxlLm5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChkZnJkLnN0YXRlKCkgPT0gJ3BlbmRpbmcnKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlID0gdGhpcy5mbS5zZWxlY3RlZEZpbGVzKCk7XHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5oYXNoZXMoaGFzaGVzKTtcclxuICAgICAgICAgICAgZm0ucmVxdWVzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjbWQ6ICdhZGQnLCB0YXJnZXRzOiBmaWxlcyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmeTogeyB0eXBlOiAnYWRkJywgY250OiBjbnQgfSxcclxuICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RmFpbDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGZyZC5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbSA9IGhyZWYubWF0Y2goJ2tleT0oW0EtWmEtejAtOV9dKiknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG0gJiYgbS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBtWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuTWFzdGVyICYmIHBhcmVudC5NYXN0ZXIuT3BlbkZpbGVzRXZlbnRIYW5kbGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuTWFzdGVyLk9wZW5GaWxlc0V2ZW50SGFuZGxlcignYWRkRmlsZScsIHsgZmlsZXM6IGRhdGEuRmlsZXMsIGtleToga2V5IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzdWFsaXNhdGlvbihkYXRhLkZpbGVzLGZpbGUsIG9wdHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQuZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICkuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkZnJkO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5vcHRpb25zID0geyB1aTogJ2xpbmtidXR0b24nIH07XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm0sXHJcbiAgICAgICAgICAgIGN3ZCA9IGZtLmN3ZCgpLmhhc2gsXHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5maWxlcyhoYXNoZXMpLFxyXG4gICAgICAgICAgICBjbnQgPSBmaWxlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKClcclxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgJiYgZm0uZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgZm0udHJpZ2dlcignY2FuY2VsJyk7XHJcbiAgICAgICAgcmV0dXJuIGRmcmQ7XHJcbiAgICB9O1xyXG59OyIsIlwidXNlIHN0cmljdFwiO1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMuY3J5cHRpbmZvID0gZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSB7IHVpOiAnbGlua2J1dHRvbicgfTtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbCA9IHRoaXMuZm0uc2VsZWN0ZWRGaWxlcygpO1xyXG5cclxuICAgICAgICBpZiAoc2VsLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgIHZhciBleHRlbnNpb24gPSBzZWxbMF0ubmFtZS5zdWJzdHIoKHNlbFswXS5uYW1lLmxhc3RJbmRleE9mKCcuJykgKyAxKSk7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZXh0ZW5zaW9uKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2VuYyc6XHJcbiAgICAgICAgICAgIGNhc2UgJ3NpZyc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGhhc2hlcykge1xyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm0sXHJcbiAgICAgICAgICAgIGN3ZCA9IGZtLmN3ZCgpLmhhc2gsXHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5maWxlcyhoYXNoZXMpLFxyXG4gICAgICAgICAgICBjbnQgPSBmaWxlcy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGNtZCA9IGZtLl9jb21tYW5kc1snaW5mb2JhcmNtZCddLFxyXG4gICAgICAgICAgICBkZnJkID0gJC5EZWZlcnJlZCgpXHJcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yICYmIGZtLmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWNudCB8fCB0aGlzLl9kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGZyZC5yZWplY3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQuZWFjaChmaWxlcywgZnVuY3Rpb24oaSwgZmlsZSkge1xyXG4gICAgICAgICAgICBpZiAoIWZpbGUucGhhc2gpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhZGZyZC5yZWplY3QoWydlcnJSbScsIGZpbGUubmFtZSwgJ2VyclBlcm0nXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZpbGUubG9ja2VkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gIWRmcmQucmVqZWN0KFsnZXJyTG9ja2VkJywgZmlsZS5uYW1lXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGRmcmQuc3RhdGUoKSA9PSAncGVuZGluZycpIHtcclxuICAgICAgICAgICAgZmlsZXMgPSB0aGlzLmhhc2hlcyhoYXNoZXMpO1xyXG5cclxuICAgICAgICAgICAgLy9mbS5sb2NrZmlsZXMoeyBmaWxlczogZmlsZXMgfSk7XHJcbiAgICAgICAgICAgIGZtLnJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAnY3J5cHRpbmZvJywgdGFyZ2V0czogZmlsZXMgfSxcclxuICAgICAgICAgICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ2NyeXB0aW5mbycsIGNudDogY250IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmVudEZhaWw6IHRydWVcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjbWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY21kLmV4ZWMoXCJFbXB0eVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGZyZC5kb25lKCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY21kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbWQuZXhlYyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZnJkLmRvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbS51bmxvY2tmaWxlcyh7IGZpbGVzOiBmaWxlcyB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGRmcmQ7XHJcbiAgICB9O1xyXG59OyIsIlwidXNlIHN0cmljdFwiO1xyXG5lbEZpbmRlci5wcm90b3R5cGUuY29tbWFuZHMuY2VydGRvd25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXMsXHJcbiAgICAgICAgZm0gPSB0aGlzLmZtO1xyXG5cclxuICAgIHRoaXMuZ2V0c3RhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH07XHJcbiAgICB0aGlzLmV4ZWMgPSBmdW5jdGlvbihjZXJ0VGh1bWIpIHtcclxuICAgICAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBiYXNlID0gZm0ub3B0aW9ucy51cmwsXHJcbiAgICAgICAgICAgIGRmcmQgPSAkLkRlZmVycmVkKCksXHJcbiAgICAgICAgICAgIGlmcmFtZSA9ICcnLFxyXG4gICAgICAgICAgICBjZGF0YSA9ICcnLFxyXG4gICAgICAgICAgICBpID0gMSxcclxuICAgICAgICAgICAgdXJsO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCgpIHx8ICFjZXJ0VGh1bWIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZm0ub2xkQVBJKSB7XHJcbiAgICAgICAgICAgIGZtLmVycm9yKCdlcnJDbWROb1N1cHBvcnQnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBiYXNlICs9IGJhc2UuaW5kZXhPZignPycpID09PSAtMSA/ICc/JyA6ICcmJztcclxuXHJcbiAgICAgICAgaWZyYW1lICs9ICc8aWZyYW1lIGNsYXNzPVwiZG93bmxvYWRlclwiIGlkPVwiZG93bmxvYWRlci1jZXJ0XCIgc3R5bGU9XCJkaXNwbGF5Om5vbmVcIiBzcmM9XCInICtcclxuICAgICAgICAgICAgYmFzZSArICdjbWQ9Y2VydGRvd25sb2FkJnRhcmdldD0nICsgY2VydFRodW1iICsgJyZkb3dubG9hZD0xXCIvPic7XHJcblxyXG4gICAgICAgICQoaWZyYW1lKVxyXG4gICAgICAgICAgICAuYXBwZW5kVG8oJ2JvZHknKVxyXG4gICAgICAgICAgICAucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoaWZyYW1lKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjJyArICQodGhpcykuYXR0cignaWQnKSkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9LCBmbS5VQS5GaXJlZm94ID8gKDIwMDAwICsgKDEwMDAwICogaSkpIDogMTAwMDApOyAvLyBnaXZlIG1vemlsbGEgMjAgc2VjICsgMTAgc2VjIGZvciBlYWNoIGZpbGUgdG8gYmUgc2F2ZWRcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBkZnJkLnJlc29sdmUoKTtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5maWx0ZXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMub3B0aW9ucyA9IHsgdWk6ICdmaWx0ZXJidXR0b24nIH07XHJcbiAgICB0aGlzLmFsd2F5c0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgdGhpcy51cGRhdGVPblNlbGVjdCA9IGZhbHNlO1xyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmZpbHRlclN0YXRlID0gJ05vdENyeXB0U2lnbic7XHJcbiAgICB0aGlzLmZpbHRlckZvbGRlciA9ICcnO1xyXG5cclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKHEpIHtcclxuICAgICAgICB2YXIgZm0gPSB0aGlzLmZtLFxyXG4gICAgICAgICAgICBoYXNoID0gZm0uY3dkKCkuaGFzaDtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKGhhc2gpXHJcbiAgICAgICAgaWYgKHR5cGVvZihxKSA9PSAnc3RyaW5nJyAmJiBxKSB7XHJcbiAgICAgICAgICAgIGZtLnRyaWdnZXIoJ2ZpbHRlcnN0YXJ0JywgeyBxdWVyeTogcSB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgY21kOiAnZmlsdGVyJywgdGFyZ2V0OiBoYXNoLCBxOiBxIH0sXHJcbiAgICAgICAgICAgICAgICBub3RpZnk6IHsgdHlwZTogJ2ZpbHRlcicsIGNudDogMSwgaGlkZUNudDogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJC5EZWZlcnJlZCgpLnJlamVjdCgpO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLnBvc3QgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICB0aGlzLmdldHN0YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24ocGF0aCwgZGF0YSkge1xyXG4gICAgICAgIHZhciBmbSA9IHRoaXMuZm0sXHJcbiAgICAgICAgICAgIG1ldGhvZCA9ICdwb3N0JyxcclxuICAgICAgICAgICAgZm9ybSA9ICQoJzxmb3JtLz4nKS5hdHRyKFwibWV0aG9kXCIsIG1ldGhvZCkuYXR0cihcImFjdGlvblwiLCBwYXRoKSxcclxuICAgICAgICAgICAgYWRkSGlkZGVuID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBoaWRkZW5GaWVsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICAgICAgICAgICAgICAgIGhpZGRlbkZpZWxkLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJoaWRkZW5cIik7XHJcbiAgICAgICAgICAgICAgICBoaWRkZW5GaWVsZC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaGlkZGVuRmllbGQuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgZm9ybS5hcHBlbmQoaGlkZGVuRmllbGQpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjb25zdHJ1Y3RFbGVtZW50cyA9IGZ1bmN0aW9uKGl0ZW0sIHBhcmVudFN0cmluZykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAoaXRlbSkgPT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIGl0ZW1ba2V5XSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZW1ba2V5XSkgPT09ICdbb2JqZWN0IEFycmF5XScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1ba2V5XS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdHJ1Y3RFbGVtZW50cyhpdGVtW2tleV1baV0sIHBhcmVudFN0cmluZyArIGtleSArIFwiW1wiICsgaSArIFwiXVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVtW2tleV0pID09PSAnW29iamVjdCBPYmplY3RdJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0cnVjdEVsZW1lbnRzKGl0ZW1ba2V5XSwgcGFyZW50U3RyaW5nICsga2V5ICsgXCIuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRIaWRkZW4ocGFyZW50U3RyaW5nICsga2V5LCBpdGVtW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGRIaWRkZW4ocGFyZW50U3RyaW5nLCBpdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICBpZiAoZGF0YS5GaWxlcykgZGF0YS5GaWxlcyA9IEpTT04uc3RyaW5naWZ5KGRhdGEuRmlsZXMpO1xyXG4gICAgICAgIGNvbnN0cnVjdEVsZW1lbnRzKGRhdGEsIFwiXCIpO1xyXG5cclxuICAgICAgICAkKGRvY3VtZW50LmJvZHkpLmFwcGVuZChmb3JtKTtcclxuICAgICAgICAkKGZvcm0pLnN1Ym1pdCgpO1xyXG4gICAgfTtcclxufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuZWxGaW5kZXIucHJvdG90eXBlLmNvbW1hbmRzLm11bHRpcGx5YWRkID0gZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSB7IHVpOiAnbXVsdGlwbHlhZGRidXR0b24nIH07XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZXhlYyA9IGZ1bmN0aW9uKGNvbW1hbmROYW1lKSB7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbSxcclxuICAgICAgICAgICAgY29tLFxyXG4gICAgICAgICAgICBjID0gJ2NsYXNzJyxcclxuICAgICAgICAgICAgZGlzYWJsZWQgPSBmbS5yZXMoYywgJ2Rpc2FibGVkJyksXHJcbiAgICAgICAgICAgIGNvbW1hbmRzID0gZm0uX2NvbW1hbmRzO1xyXG5cclxuICAgICAgICBpZiAoKGNvbSA9IGNvbW1hbmRzW2NvbW1hbmROYW1lXSkpIHtcclxuICAgICAgICAgICAgaWYgKCEkKHRoaXMpLmlzKCcuJyArIGRpc2FibGVkKSkge1xyXG4gICAgICAgICAgICAgICAgY29tLmV4ZWMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJC5EZWZlcnJlZCgpLnJlc29sdmUoKTtcclxuICAgIH07XHJcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbmVsRmluZGVyLnByb3RvdHlwZS5jb21tYW5kcy5zaWduID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdGhpcy5nZXRzdGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWwgPSB0aGlzLmZtLnNlbGVjdGVkRmlsZXMoKSxcclxuICAgICAgICAgICAgY250ID0gc2VsLmxlbmd0aDtcclxuXHJcbiAgICAgICAgdmFyIGZpbGVzID0gJC5tYXAoc2VsLCBmdW5jdGlvbihmKSB7IHJldHVybiBmLm1pbWUgPT0gJ2RpcmVjdG9yeScgPyBudWxsIDogZjsgfSk7XHJcbiAgICAgICAgcmV0dXJuIGNudCA+PSAxICYmIGNudCA9PSBmaWxlcy5sZW5ndGggPyAwIDogLTE7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5leGVjID0gZnVuY3Rpb24oaGFzaGVzKSB7XHJcbiAgICAgICAgdmFyIGZtID0gdGhpcy5mbSxcclxuICAgICAgICAgICAgY3dkID0gZm0uY3dkKCkuaGFzaCxcclxuICAgICAgICAgICAgZmlsZXMgPSB0aGlzLmZpbGVzKGhhc2hlcyksXHJcbiAgICAgICAgICAgIGNudCA9IGZpbGVzLmxlbmd0aCxcclxuICAgICAgICAgICAgZGZyZCA9ICQuRGVmZXJyZWQoKVxyXG4gICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvciAmJiBmbS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFjbnQgfHwgdGhpcy5fZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRmcmQucmVqZWN0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkLmVhY2goZmlsZXMsIGZ1bmN0aW9uKGksIGZpbGUpIHtcclxuICAgICAgICAgICAgaWYgKCFmaWxlLnBoYXNoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gIWRmcmQucmVqZWN0KFsnZXJyUm0nLCBmaWxlLm5hbWUsICdlcnJQZXJtJ10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmaWxlLmxvY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFkZnJkLnJlamVjdChbJ2VyckxvY2tlZCcsIGZpbGUubmFtZV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChkZnJkLnN0YXRlKCkgPT0gJ3BlbmRpbmcnKSB7XHJcbiAgICAgICAgICAgIGZpbGVzID0gdGhpcy5oYXNoZXMoaGFzaGVzKTtcclxuXHJcbiAgICAgICAgICAgIC8vZm0ubG9ja2ZpbGVzKHsgZmlsZXM6IGZpbGVzIH0pO1xyXG4gICAgICAgICAgICBmbS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNtZDogJ3NpZ24nLCB0YXJnZXRzOiBmaWxlcyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmeTogeyB0eXBlOiAnc2lnbicsIGNudDogY250IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmVudEZhaWw6IHRydWVcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGRmcmQucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb207XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoY29tID0gZm0uX2NvbW1hbmRzWydwb3N0J10pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb20uZXhlYyhmbS5NYXN0ZXJVcmwsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRmcmQuZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICkuYWx3YXlzKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vZm0udW5sb2NrZmlsZXMoeyBmaWxlczogZmlsZXMgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBkZnJkO1xyXG4gICAgfTtcclxufTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
