!function (a, b) {
    "use strict";
    function c(b, c, d) {
        b._eventHandlers = b._eventHandlers || [
            {
                element: b.scroller, handler: function (a) {
                    b.scroll(a)
                }, type: "scroll"
            },
            {
                element: b.scroller, handler: function () {
                    b.update()
                }, type: "keyup"
            },
            {
                element: b.bar, handler: function (a) {
                    a.preventDefault(), b.selection(), b.drag.now = 1
                }, type: "touchstart mousedown"
            },
            {
                element: document, handler: function () {
                    b.selection(1), b.drag.now = 0
                }, type: "mouseup blur touchend"
            },
            {
                element: document, handler: function (a) {
                    2 != a.button && b._pos0(a)
                }, type: "touchstart mousedown"
            },
            {
                element: document, handler: function (a) {
                    b.drag.now && b.drag(a)
                }, type: "mousemove touchmove"
            },
            {
                element: a, handler: function () {
                    b.update()
                }, type: "resize"
            },
            {
                element: b.root, handler: function () {
                    b.update()
                }, type: "sizeChange"
            }
        ], l(b._eventHandlers, function (a) {
            a.element && c(a.element, a.type, a.handler, d)
        })
    }

    function d(a, b, c) {
        var d = "data-baron-" + b;
        if ("on" == c) a.setAttribute(d, "inited"); else {
            if ("off" != c) return a.getAttribute(d);
            a.removeAttribute(d)
        }
    }

    function e(a) {
        if (d(a.root, a.direction)) throw new Error("Second baron initialization");
        var b = new n.prototype.constructor(a);
        return c(b, a.event, "on"), d(b.root, a.direction, "on"), b.update({ initMode: !0 }), b
    }

    function f(a) {
        var b = {};
        a = a || {};
        for (var c in a) a.hasOwnProperty(c) && (b[c] = a[c]);
        return b
    }

    function g(a) {
        var b = f(a);
        b.direction = b.direction || "v";
        var c = a.event || function (a, c, d, e) {
            b.$(a)[e || "on"](c, d)
        };
        return b.event = function (a, b, d, e) {
            l(a, function (a) {
                c(a, b, d, e)
            })
        }, b
    }

    function h(a) {
        if (this.events && this.events[a]) for (var b = 0; b < this.events[a].length; b++) {
            var c = Array.prototype.slice.call(arguments, 1);
            this.events[a][b].apply(this, c)
        }
    }

    if (a) {
        var i = m, j = ["left", "top", "right", "bottom", "width", "height"], k = { v: { x: "Y", pos: j[1], oppos: j[3], crossPos: j[0], crossOpPos: j[2], size: j[5], crossSize: j[4], client: "clientHeight", crossClient: "clientWidth", crossScroll: "scrollWidth", offset: "offsetHeight", crossOffset: "offsetWidth", offsetPos: "offsetTop", scroll: "scrollTop", scrollSize: "scrollHeight" }, h: { x: "X", pos: j[0], oppos: j[2], crossPos: j[1], crossOpPos: j[3], size: j[4], crossSize: j[5], client: "clientWidth", crossClient: "clientHeight", crossScroll: "scrollHeight", offset: "offsetWidth", crossOffset: "offsetHeight", offsetPos: "offsetLeft", scroll: "scrollLeft", scrollSize: "scrollWidth" } }, l = function (c, d) {
            var e = 0;
            for ((c.length === b || c === a) && (c = [c]) ; c[e];) d.call(this, c[e], e), e++
        }, m = function (b) {
            var c, d, e;
            return b = b || {}, e = b.$ || a.jQuery, c = this instanceof e, c ? b.root = d = this : d = e(b.root || b.scroller), new m.fn.constructor(d, b, e)
        };
        m.fn = {
            constructor: function (a, b, c) {
                var d = g(b);
                d.$ = c, l.call(this, a, function (a, b) {
                    var c = f(d);
                    d.root && d.scroller ? (c.scroller = d.$(d.scroller, a), c.scroller.length || (c.scroller = a)) : c.scroller = a, c.root = a, this[b] = e(c), this.length = b + 1
                }), this.params = d
            }, dispose: function () {
                var a = this.params;
                l(this, function (b) {
                    b.dispose(a)
                }), this.params = null
            }, update: function () {
                for (var a = 0; this[a];) this[a].update.apply(this[a], arguments), a++
            }, baron: function (a) {
                return a.root = [], a.scroller = this.params.scroller, l.call(this, this, function (b) {
                    a.root.push(b.root)
                }), a.direction = "v" == this.params.direction ? "h" : "v", a._chain = !0, m(a)
            }
        };
        var n = {};
        n.prototype = {
            constructor: function (a) {
                function c(a, b) {
                    return l(a, b)[0]
                }

                function d(a) {
                    var b = this.barMinSize || 20;
                    a > 0 && b > a && (a = b), this.bar && l(this.bar).css(this.origin.size, parseInt(a, 10) + "px")
                }

                function e(a) {
                    this.bar && l(this.bar).css(this.origin.pos, +a + "px")
                }

                function f() {
                    return o[this.origin.client] - this.barTopLimit - this.bar[this.origin.offset]
                }

                function g(a) {
                    return a * f.call(this) + this.barTopLimit
                }

                function i(a) {
                    return (a - this.barTopLimit) / f.call(this)
                }

                function j() {
                    return !1
                }

                var l, m, n, o, p, q, r, s, t, u, v;
                return u = t = (new Date).getTime(), l = this.$ = a.$, this.event = a.event, this.events = {}, this.root = a.root, this.scroller = c(a.scroller), this.bar = c(a.bar, this.root), o = this.track = c(a.track, this.root), !this.track && this.bar && (o = this.bar.parentNode), this.clipper = this.scroller.parentNode, this.direction = a.direction, this.origin = k[this.direction], this.barOnCls = a.barOnCls, this.scrollingCls = a.scrollingCls, this.barTopLimit = 0, s = 1e3 * a.pause || 0, this.cursor = function (a) {
                    return a["client" + this.origin.x] || (((a.originalEvent || a).touches || {})[0] || {})["page" + this.origin.x]
                }, this.pos = function (a) {
                    var c = "page" + this.origin.x + "Offset", d = this.scroller[c] ? c : this.origin.scroll;
                    return a !== b && (this.scroller[d] = a), this.scroller[d]
                }, this.rpos = function (a) {
                    var b, c = this.scroller[this.origin.scrollSize] - this.scroller[this.origin.client];
                    return b = a ? this.pos(a * c) : this.pos(), b / (c || 1)
                }, this.barOn = function (a) {
                    this.barOnCls && (a || this.scroller[this.origin.client] >= this.scroller[this.origin.scrollSize] ? l(this.root).removeClass(this.barOnCls) : l(this.root).addClass(this.barOnCls))
                }, this._pos0 = function (a) {
                    n = this.cursor(a) - m
                }, this.drag = function (a) {
                    this.scroller[this.origin.scroll] = i.call(this, this.cursor(a) - n) * (this.scroller[this.origin.scrollSize] - this.scroller[this.origin.client])
                }, this.selection = function (a) {
                    this.event(document, "selectpos selectstart", j, a ? "off" : "on")
                }, this.resize = function () {
                    function b() {
                        var b, d;
                        c.barOn(), d = c.scroller[c.origin.crossClient], b = c.scroller[c.origin.crossOffset] - d, a.freeze && !c.clipper.style[c.origin.crossSize] && l(c.clipper).css(c.origin.crossSize, c.clipper[c.origin.crossClient] - b + "px"), l(c.scroller).css(c.origin.crossSize, c.clipper[c.origin.crossClient] + b + "px"), Array.prototype.unshift.call(arguments, "resize"), h.apply(c, arguments), u = (new Date).getTime()
                    }

                    var c = this, d = 0;
                    (new Date).getTime() - u < s && (clearTimeout(p), d = s), d ? p = setTimeout(b, d) : b()
                }, this.updatePositions = function () {
                    var a, b = this;
                    b.bar && (a = (o[b.origin.client] - b.barTopLimit) * b.scroller[b.origin.client] / b.scroller[b.origin.scrollSize], parseInt(v, 10) != parseInt(a, 10) && (d.call(b, a), v = a), m = g.call(b, b.rpos()), e.call(b, m)), Array.prototype.unshift.call(arguments, "scroll"), h.apply(b, arguments), t = (new Date).getTime()
                }, this.scroll = function () {
                    var a = 0, c = this;
                    (new Date).getTime() - t < s && (clearTimeout(q), a = s), (new Date).getTime() - t < s && (clearTimeout(q), a = s), a ? q = setTimeout(function () {
                        c.updatePositions()
                    }, a) : c.updatePositions(), c.scrollingCls && (r || this.$(this.scroller).addClass(this.scrollingCls), clearTimeout(r), r = setTimeout(function () {
                        c.$(c.scroller).removeClass(c.scrollingCls), r = b
                    }, 300))
                }, this
            }, update: function (a) {
                return h.call(this, "upd", a), this.resize(1), this.updatePositions(), this
            }, dispose: function (a) {
                c(this, this.event, "off"), d(this.root, a.direction, "off"), $(this.scroller).css(this.origin.crossSize, ""), this.barOn(!0), h.call(this, "dispose")
            }, on: function (a, b, c) {
                for (var d = a.split(" "), e = 0; e < d.length; e++) "init" == d[e] ? b.call(this, c) : (this.events[d[e]] = this.events[d[e]] || [], this.events[d[e]].push(function (a) {
                    b.call(this, a || c)
                }))
            }
        }, m.fn.constructor.prototype = m.fn, n.prototype.constructor.prototype = n.prototype, m.noConflict = function () {
            return a.baron = i, m
        }, m.version = "0.7.7", $ && $.fn && ($.fn.baron = m), a.baron = m, a.module && module.exports && (module.exports = m.noConflict())
    }
}(window), function (a, b) {
    var c = function (a) {
        function c(a, c, d) {
            var e = 1 == d ? "pos" : "oppos";
            g < (h.minView || 0) && (c = b), this.$(f[a]).css(this.origin.pos, "").css(this.origin.oppos, "").removeClass(h.outside), c !== b && (c += "px", this.$(f[a]).css(this.origin[e], c).addClass(h.outside))
        }

        function d(a) {
            try {
                i = document.createEvent("WheelEvent"), i.initWebKitWheelEvent(a.originalEvent.wheelDeltaX, a.originalEvent.wheelDeltaY), m.dispatchEvent(i), a.preventDefault()
            } catch (a) {
            }
        }

        function e(a) {
            var b;
            for (var c in a) h[c] = a[c];
            if (f = this.$(h.elements, this.scroller)) {
                g = this.scroller[this.origin.client];
                for (var e = 0; e < f.length; e++) b = {}, b[this.origin.size] = f[e][this.origin.offset], f[e].parentNode !== this.scroller && this.$(f[e].parentNode).css(b), b = {}, b[this.origin.crossSize] = f[e].parentNode[this.origin.crossClient], this.$(f[e]).css(b), g -= f[e][this.origin.offset], l[e] = f[e].parentNode[this.origin.offsetPos], j[e] = j[e - 1] || 0, k[e] = k[e - 1] || Math.min(l[e], 0), f[e - 1] && (j[e] += f[e - 1][this.origin.offset], k[e] += f[e - 1][this.origin.offset]), (0 != e || 0 != l[e]) && (this.event(f[e], "mousewheel", d, "off"), this.event(f[e], "mousewheel", d));
                h.limiter && f[0] && (this.track && this.track != this.scroller ? (b = {}, b[this.origin.pos] = f[0].parentNode[this.origin.offset], this.$(this.track).css(b)) : this.barTopLimit = f[0].parentNode[this.origin.offset], this.scroll()), h.limiter === !1 && (this.barTopLimit = 0)
            }
            var i = {
                element: f, handler: function () {
                    for (var a, b = o(this)[0].parentNode, c = b.offsetTop, d = 0; d < f.length; d++) f[d] === this && (a = d);
                    var e = c - j[a];
                    h.scroll ? h.scroll({ x1: p.scroller.scrollTop, x2: e }) : p.scroller.scrollTop = e
                }, type: "click"
            };
            h.clickable && (this._eventHandlers.push(i), n(i.element, i.type, i.handler, "on"))
        }

        var f, g, h = { outside: "", inside: "", before: "", after: "", past: "", future: "", radius: 0, minView: 0 }, j = [], k = [], l = [], m = this.scroller, n = this.event, o = this.$, p = this;
        this.on("init", e, a);
        var q = [], r = [];
        this.on("init scroll", function () {
            var a, d, e;
            if (f) {
                for (var i, m = 0; m < f.length; m++) a = 0, l[m] - this.pos() < k[m] + h.radius ? (a = 1, d = j[m]) : l[m] - this.pos() > k[m] + g - h.radius ? (a = 2, d = this.scroller[this.origin.client] - f[m][this.origin.offset] - j[m] - g) : (a = 3, d = b), e = !1, (l[m] - this.pos() < k[m] || l[m] - this.pos() > k[m] + g) && (e = !0), (a != q[m] || e != r[m]) && (c.call(this, m, d, a), q[m] = a, r[m] = e, i = !0);
                if (i) for (m = 0; m < f.length; m++) 1 == q[m] && h.past && this.$(f[m]).addClass(h.past).removeClass(h.future), 2 == q[m] && h.future && this.$(f[m]).addClass(h.future).removeClass(h.past), 3 == q[m] ? ((h.future || h.past) && this.$(f[m]).removeClass(h.past).removeClass(h.future), h.inside && this.$(f[m]).addClass(h.inside)) : h.inside && this.$(f[m]).removeClass(h.inside), q[m] != q[m + 1] && 1 == q[m] && h.before ? this.$(f[m]).addClass(h.before).removeClass(h.after) : q[m] != q[m - 1] && 2 == q[m] && h.after ? this.$(f[m]).addClass(h.after).removeClass(h.before) : this.$(f[m]).removeClass(h.before).removeClass(h.after), h.grad && (r[m] ? this.$(f[m]).addClass(h.grad) : this.$(f[m]).removeClass(h.grad))
            }
        }), this.on("resize upd", function (a) {
            e.call(this, a && a.fix)
        })
    };
    baron.fn.fix = function (a) {
        for (var b = 0; this[b];) c.call(this[b], a), b++;
        return this
    }
}(window), function () {
    var a = function (a) {
        var b, c, d, e, f, g = this;
        e = a.screen || .9, a.forward && (b = this.$(a.forward, this.clipper), f = {
            element: b, handler: function () {
                var b = g.pos() - a.delta || 30;
                g.pos(b)
            }, type: "click"
        }, this._eventHandlers.push(f), this.event(f.element, f.type, f.handler, "on")), a.backward && (c = this.$(a.backward, this.clipper), f = {
            element: c, handler: function () {
                var b = g.pos() + a.delta || 30;
                g.pos(b)
            }, type: "click"
        }, this._eventHandlers.push(f), this.event(f.element, f.type, f.handler, "on")), a.track && (d = a.track === !0 ? this.track : this.$(a.track, this.clipper)[0], d && (f = {
            element: d, handler: function (a) {
                var b = a["offset" + g.origin.x], c = g.bar[g.origin.offsetPos], d = 0;
                c > b ? d = -1 : b > c + g.bar[g.origin.offset] && (d = 1);
                var f = g.pos() + d * e * g.scroller[g.origin.client];
                g.pos(f)
            }, type: "mousedown"
        }, this._eventHandlers.push(f), this.event(f.element, f.type, f.handler, "on")))
    };
    baron.fn.controls = function (b) {
        for (var c = 0; this[c];) a.call(this[c], b), c++;
        return this
    }
}(window), function () {
    var a = function (a) {
        function b() {
            return r.scroller[r.origin.scroll] + r.scroller[r.origin.offset]
        }

        function c() {
            return r.scroller[r.origin.scrollSize]
        }

        function d() {
            return r.scroller[r.origin.client]
        }

        function e(a, b) {
            var c = 5e-4 * a;
            return Math.floor(b - c * (a + 550))
        }

        function f(a) {
            k = a, a ? (g(), h = setInterval(g, 200)) : clearInterval(h)
        }

        function g() {
            var g, h, k = {}, w = b(), x = c(), y = 1 == s;
            if (h = 0, s > 0 && (h = 40), g = e(u, h), w >= x - u && s > -1 ? y && (u += g) : u = 0, 0 > u && (u = 0), k[m] = u + "px", d() <= c()) {
                r.$(l).css(k);
                for (var z = 0; z < p.length; z++) r.$(p[z].self).css(p[z].property, Math.min(u / n * 100, 100) + "%")
            }
            q && u && r.$(r.root).addClass(q), 0 == u && a.onCollapse && a.onCollapse(), s = 0, i = setTimeout(function () {
                s = -1
            }, v), o && u > n && !j && (o(), j = !0), 0 == u ? t++ : t = 0, t > 1 && (f(!1), j = !1, q && r.$(r.root).removeClass(q))
        }

        var h, i, j, k, l = this.$(a.block), m = a.size || this.origin.size, n = a.limit || 80, o = a.onExpand, p = a.elements || [], q = a.inProgress || "", r = this, s = 0, t = 0, u = 0, v = a.waiting || 500;
        this.on("init", function () {
            f(!0)
        }), this.on("dispose", function () {
            f(!1)
        }), this.event(this.scroller, "mousewheel DOMMouseScroll", function (a) {
            var d = a.wheelDelta < 0 || a.originalEvent && a.originalEvent.wheelDelta < 0 || a.detail > 0;
            d && (s = 1, clearTimeout(i), !k && b() >= c() && f(!0))
        })
    };
    baron.fn.pull = function (b) {
        for (var c = 0; this[c];) a.call(this[c], b), c++;
        return this
    }
}(window), function (a) {
    var b = a.MutationObserver || a.WebKitMutationObserver || a.MozMutationObserver || null, c = function () {
        var a = this;
        this._observer = new MutationObserver(function () {
            a.update()
        }), this.on("init", function () {
            a._observer.observe(a.root, { childList: !0, subtree: !0, characterData: !0 })
        }), this.on("dispose", function () {
            a._observer.dissconect(), delete a._observer
        })
    };
    baron.fn.autoUpdate = function (a) {
        if (!b) return this;
        for (var d = 0; this[d];) c.call(this[d], a), d++;
        return this
    }
}(window);


/*! fancyBox v2.1.5 fancyapps.com | fancyapps.com/fancybox/#license */
(function(r, G, f, v) {
    var J = f("html"),
        n = f(r),
        p = f(G),
        b = f.fancybox = function() { b.open.apply(this, arguments); },
        I = navigator.userAgent.match(/msie/i),
        B = null,
        s = G.createTouch !== v,
        t = function(a) { return a && a.hasOwnProperty && a instanceof f; },
        q = function(a) { return a && "string" === f.type(a); },
        E = function(a) { return q(a) && 0 < a.indexOf("%"); },
        l = function(a, d) {
            var e = parseInt(a, 10) || 0;
            d && E(a) && (e *= b.getViewport()[d] / 100);
            return Math.ceil(e);
        },
        w = function(a, b) { return l(a, b) + "px"; };
    f.extend(b, {
        version: "2.1.5",
        defaults: {
            padding: 15,
            margin: 20,
            width: 800,
            height: 600,
            minWidth: 100,
            minHeight: 100,
            maxWidth: 9999,
            maxHeight: 9999,
            pixelRatio: 1,
            autoSize: !0,
            autoHeight: !1,
            autoWidth: !1,
            autoResize: !0,
            autoCenter: !s,
            fitToView: !0,
            aspectRatio: !1,
            topRatio: 0.5,
            leftRatio: 0.5,
            scrolling: "auto",
            wrapCSS: "",
            arrows: !0,
            closeBtn: !0,
            closeClick: !1,
            nextClick: !1,
            mouseWheel: !0,
            autoPlay: !1,
            playSpeed: 3E3,
            preload: 3,
            modal: !1,
            loop: !0,
            ajax: { dataType: "html", headers: { "X-fancyBox": !0 } },
            iframe: { scrolling: "auto", preload: !0 },
            swf: { wmode: "transparent", allowfullscreen: "true", allowscriptaccess: "always" },
            keys: { next: { 13: "left", 34: "up", 39: "left", 40: "up" }, prev: { 8: "right", 33: "down", 37: "right", 38: "down" }, close: [27], play: [32], toggle: [70] },
            direction: { next: "left", prev: "right" },
            scrollOutside: !0,
            index: 0,
            type: null,
            href: null,
            content: null,
            title: null,
            tpl: {
                wrap: '<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',
                image: '<img class="fancybox-image" src="{href}" alt="" />',
                iframe: '<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen' +
                (I ? ' allowtransparency="true"' : "") + "></iframe>",
                error: '<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',
                closeBtn: '<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',
                next: '<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',
                prev: '<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'
            },
            openEffect: "fade",
            openSpeed: 250,
            openEasing: "swing",
            openOpacity: !0,
            openMethod: "zoomIn",
            closeEffect: "fade",
            closeSpeed: 250,
            closeEasing: "swing",
            closeOpacity: !0,
            closeMethod: "zoomOut",
            nextEffect: "elastic",
            nextSpeed: 250,
            nextEasing: "swing",
            nextMethod: "changeIn",
            prevEffect: "elastic",
            prevSpeed: 250,
            prevEasing: "swing",
            prevMethod: "changeOut",
            helpers: { overlay: !0, title: !0 },
            onCancel: f.noop,
            beforeLoad: f.noop,
            afterLoad: f.noop,
            beforeShow: f.noop,
            afterShow: f.noop,
            beforeChange: f.noop,
            beforeClose: f.noop,
            afterClose: f.noop
        },
        group: {},
        opts: {},
        previous: null,
        coming: null,
        current: null,
        isActive: !1,
        isOpen: !1,
        isOpened: !1,
        wrap: null,
        skin: null,
        outer: null,
        inner: null,
        player: { timer: null, isActive: !1 },
        ajaxLoad: null,
        imgPreload: null,
        transitions: {},
        helpers: {},
        open: function(a, d) {
            if (a && (f.isPlainObject(d) || (d = {}), !1 !== b.close(!0)))
                return f.isArray(a) || (a = t(a) ? f(a).get() : [a]), f.each(a, function(e, c) {
                    var k = {}, g, h, j, m, l;
                    "object" === f.type(c) && (c.nodeType && (c = f(c)), t(c) ? (k = { href: c.data("fancybox-href") || c.attr("href"), title: c.data("fancybox-title") || c.attr("title"), isDom: !0, element: c }, f.metadata && f.extend(!0, k,
                        c.metadata())) : k = c);
                    g = d.href || k.href || (q(c) ? c : null);
                    h = d.title !== v ? d.title : k.title || "";
                    m = (j = d.content || k.content) ? "html" : d.type || k.type;
                    !m && k.isDom && (m = c.data("fancybox-type"), m || (m = (m = c.prop("class").match(/fancybox\.(\w+)/)) ? m[1] : null));
                    q(g) && (m || (b.isImage(g) ? m = "image" : b.isSWF(g) ? m = "swf" : "#" === g.charAt(0) ? m = "inline" : q(c) && (m = "html", j = c)), "ajax" === m && (l = g.split(/\s+/, 2), g = l.shift(), l = l.shift()));
                    j || ("inline" === m ? g ? j = f(q(g) ? g.replace(/.*(?=#[^\s]+$)/, "") : g) : k.isDom && (j = c) : "html" === m ? j = g : !m && (!g &&
                    k.isDom) && (m = "inline", j = c));
                    f.extend(k, { href: g, type: m, content: j, title: h, selector: l });
                    a[e] = k;
                }), b.opts = f.extend(!0, {}, b.defaults, d), d.keys !== v && (b.opts.keys = d.keys ? f.extend({}, b.defaults.keys, d.keys) : !1), b.group = a, b._start(b.opts.index);
        },
        cancel: function() {
            var a = b.coming;
            a && !1 !== b.trigger("onCancel") && (b.hideLoading(), b.ajaxLoad && b.ajaxLoad.abort(), b.ajaxLoad = null, b.imgPreload && (b.imgPreload.onload = b.imgPreload.onerror = null), a.wrap && a.wrap.stop(!0, !0).trigger("onReset").remove(), b.coming = null, b.current ||
            b._afterZoomOut(a));
        },
        close: function(a) {
            b.cancel();
            !1 !== b.trigger("beforeClose") && (b.unbindEvents(), b.isActive && (!b.isOpen || !0 === a ? (f(".fancybox-wrap").stop(!0).trigger("onReset").remove(), b._afterZoomOut()) : (b.isOpen = b.isOpened = !1, b.isClosing = !0, f(".fancybox-item, .fancybox-nav").remove(), b.wrap.stop(!0, !0).removeClass("fancybox-opened"), b.transitions[b.current.closeMethod]())));
        },
        play: function(a) {
            var d = function() { clearTimeout(b.player.timer); },
                e = function() {
                    d();
                    b.current && b.player.isActive && (b.player.timer =
                        setTimeout(b.next, b.current.playSpeed));
                },
                c = function() {
                    d();
                    p.unbind(".player");
                    b.player.isActive = !1;
                    b.trigger("onPlayEnd");
                };
            if (!0 === a || !b.player.isActive && !1 !== a) {
                if (b.current && (b.current.loop || b.current.index < b.group.length - 1))b.player.isActive = !0, p.bind({ "onCancel.player beforeClose.player": c, "onUpdate.player": e, "beforeLoad.player": d }), e(), b.trigger("onPlayStart");
            } else c();
        },
        next: function(a) {
            var d = b.current;
            d && (q(a) || (a = d.direction.next), b.jumpto(d.index + 1, a, "next"));
        },
        prev: function(a) {
            var d = b.current;
            d && (q(a) || (a = d.direction.prev), b.jumpto(d.index - 1, a, "prev"));
        },
        jumpto: function(a, d, e) {
            var c = b.current;
            c && (a = l(a), b.direction = d || c.direction[a >= c.index ? "next" : "prev"], b.router = e || "jumpto", c.loop && (0 > a && (a = c.group.length + a % c.group.length), a %= c.group.length), c.group[a] !== v && (b.cancel(), b._start(a)));
        },
        reposition: function(a, d) {
            var e = b.current, c = e ? e.wrap : null, k;
            c && (k = b._getPosition(d), a && "scroll" === a.type ? (delete k.position, c.stop(!0, !0).animate(k, 200)) : (c.css(k), e.pos = f.extend({}, e.dim, k)));
        },
        update: function(a) {
            var d =
                    a && a.type,
                e = !d || "orientationchange" === d;
            e && (clearTimeout(B), B = null);
            b.isOpen && !B && (B = setTimeout(function() {
                var c = b.current;
                c && !b.isClosing && (b.wrap.removeClass("fancybox-tmp"), (e || "load" === d || "resize" === d && c.autoResize) && b._setDimension(), "scroll" === d && c.canShrink || b.reposition(a), b.trigger("onUpdate"), B = null);
            }, e && !s ? 0 : 300));
        },
        toggle: function(a) {
            b.isOpen && (b.current.fitToView = "boolean" === f.type(a) ? a : !b.current.fitToView, s && (b.wrap.removeAttr("style").addClass("fancybox-tmp"), b.trigger("onUpdate")),
                b.update());
        },
        hideLoading: function() {
            p.unbind(".loading");
            f("#fancybox-loading").remove();
        },
        showLoading: function() {
            var a, d;
            b.hideLoading();
            a = f('<div id="fancybox-loading"><div></div></div>').click(b.cancel).appendTo("body");
            p.bind("keydown.loading", function(a) { if (27 === (a.which || a.keyCode))a.preventDefault(), b.cancel(); });
            b.defaults.fixed || (d = b.getViewport(), a.css({ position: "absolute", top: 0.5 * d.h + d.y, left: 0.5 * d.w + d.x }));
        },
        getViewport: function() {
            var a = b.current && b.current.locked || !1,
                d = {
                    x: n.scrollLeft(),
                    y: n.scrollTop()
                };
            a ? (d.w = a[0].clientWidth, d.h = a[0].clientHeight) : (d.w = s && r.innerWidth ? r.innerWidth : n.width(), d.h = s && r.innerHeight ? r.innerHeight : n.height());
            return d;
        },
        unbindEvents: function() {
            b.wrap && t(b.wrap) && b.wrap.unbind(".fb");
            p.unbind(".fb");
            n.unbind(".fb");
        },
        bindEvents: function() {
            var a = b.current, d;
            a && (n.bind("orientationchange.fb" + (s ? "" : " resize.fb") + (a.autoCenter && !a.locked ? " scroll.fb" : ""), b.update), (d = a.keys) && p.bind("keydown.fb", function(e) {
                var c = e.which || e.keyCode, k = e.target || e.srcElement;
                if (27 === c && b.coming)return!1;
                !e.ctrlKey && (!e.altKey && !e.shiftKey && !e.metaKey && (!k || !k.type && !f(k).is("[contenteditable]"))) && f.each(d, function(d, k) {
                    if (1 < a.group.length && k[c] !== v)return b[d](k[c]), e.preventDefault(), !1;
                    if (-1 < f.inArray(c, k))return b[d](), e.preventDefault(), !1;
                });
            }), f.fn.mousewheel && a.mouseWheel && b.wrap.bind("mousewheel.fb", function(d, c, k, g) {
                for (var h = f(d.target || null), j = !1; h.length && !j && !h.is(".fancybox-skin") && !h.is(".fancybox-wrap");)
                    j = h[0] && !(h[0].style.overflow && "hidden" === h[0].style.overflow) &&
                    (h[0].clientWidth && h[0].scrollWidth > h[0].clientWidth || h[0].clientHeight && h[0].scrollHeight > h[0].clientHeight), h = f(h).parent();
                if (0 !== c && !j && 1 < b.group.length && !a.canShrink) {
                    if (0 < g || 0 < k)b.prev(0 < g ? "down" : "left");
                    else if (0 > g || 0 > k)b.next(0 > g ? "up" : "right");
                    d.preventDefault();
                }
            }));
        },
        trigger: function(a, d) {
            var e, c = d || b.coming || b.current;
            if (c) {
                f.isFunction(c[a]) && (e = c[a].apply(c, Array.prototype.slice.call(arguments, 1)));
                if (!1 === e)return!1;
                c.helpers && f.each(c.helpers, function(d, e) {
                    if (e && b.helpers[d] && f.isFunction(b.helpers[d][a]))
                        b.helpers[d][a](f.extend(!0,
                            {}, b.helpers[d].defaults, e), c);
                });
                p.trigger(a);
            }
        },
        isImage: function(a) { return q(a) && a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i); },
        isSWF: function(a) { return q(a) && a.match(/\.(swf)((\?|#).*)?$/i); },
        _start: function(a) {
            var d = {}, e, c;
            a = l(a);
            e = b.group[a] || null;
            if (!e)return!1;
            d = f.extend(!0, {}, b.opts, e);
            e = d.margin;
            c = d.padding;
            "number" === f.type(e) && (d.margin = [e, e, e, e]);
            "number" === f.type(c) && (d.padding = [c, c, c, c]);
            d.modal && f.extend(!0, d, {
                closeBtn: !1,
                closeClick: !1,
                nextClick: !1,
                arrows: !1,
                mouseWheel: !1,
                keys: null,
                helpers: { overlay: { closeClick: !1 } }
            });
            d.autoSize && (d.autoWidth = d.autoHeight = !0);
            "auto" === d.width && (d.autoWidth = !0);
            "auto" === d.height && (d.autoHeight = !0);
            d.group = b.group;
            d.index = a;
            b.coming = d;
            if (!1 === b.trigger("beforeLoad"))b.coming = null;
            else {
                c = d.type;
                e = d.href;
                if (!c)return b.coming = null, b.current && b.router && "jumpto" !== b.router ? (b.current.index = a, b[b.router](b.direction)) : !1;
                b.isActive = !0;
                if ("image" === c || "swf" === c)d.autoHeight = d.autoWidth = !1, d.scrolling = "visible";
                "image" === c && (d.aspectRatio =
                    !0);
                "iframe" === c && s && (d.scrolling = "scroll");
                d.wrap = f(d.tpl.wrap).addClass("fancybox-" + (s ? "mobile" : "desktop") + " fancybox-type-" + c + " fancybox-tmp " + d.wrapCSS).appendTo(d.parent || "body");
                f.extend(d, { skin: f(".fancybox-skin", d.wrap), outer: f(".fancybox-outer", d.wrap), inner: f(".fancybox-inner", d.wrap) });
                f.each(["Top", "Right", "Bottom", "Left"], function(a, b) { d.skin.css("padding" + b, w(d.padding[a])); });
                b.trigger("onReady");
                if ("inline" === c || "html" === c) {
                    if (!d.content || !d.content.length)return b._error("content");
                } else if (!e)return b._error("href");
                "image" === c ? b._loadImage() : "ajax" === c ? b._loadAjax() : "iframe" === c ? b._loadIframe() : b._afterLoad();
            }
        },
        _error: function(a) {
            f.extend(b.coming, { type: "html", autoWidth: !0, autoHeight: !0, minWidth: 0, minHeight: 0, scrolling: "no", hasError: a, content: b.coming.tpl.error });
            b._afterLoad();
        },
        _loadImage: function() {
            var a = b.imgPreload = new Image;
            a.onload = function() {
                this.onload = this.onerror = null;
                b.coming.width = this.width / b.opts.pixelRatio;
                b.coming.height = this.height / b.opts.pixelRatio;
                b._afterLoad();
            };
            a.onerror = function() {
                this.onload =
                    this.onerror = null;
                b._error("image");
            };
            a.src = b.coming.href;
            !0 !== a.complete && b.showLoading();
        },
        _loadAjax: function() {
            var a = b.coming;
            b.showLoading();
            b.ajaxLoad = f.ajax(f.extend({}, a.ajax, { url: a.href, error: function(a, e) { b.coming && "abort" !== e ? b._error("ajax", a) : b.hideLoading(); }, success: function(d, e) { "success" === e && (a.content = d, b._afterLoad()); } }));
        },
        _loadIframe: function() {
            var a = b.coming, d = f(a.tpl.iframe.replace(/\{rnd\}/g, (new Date).getTime())).attr("scrolling", s ? "auto" : a.iframe.scrolling).attr("src", a.href);
            f(a.wrap).bind("onReset", function() {
                try {
                    f(this).find("iframe").hide().attr("src", "//about:blank").end().empty();
                } catch (a) {
                }
            });
            a.iframe.preload && (b.showLoading(), d.one("load", function() {
                f(this).data("ready", 1);
                s || f(this).bind("load.fb", b.update);
                f(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show();
                b._afterLoad();
            }));
            a.content = d.appendTo(a.inner);
            a.iframe.preload || b._afterLoad();
        },
        _preloadImages: function() {
            var a = b.group,
                d = b.current,
                e = a.length,
                c = d.preload ? Math.min(d.preload,
                    e - 1) : 0,
                f,
                g;
            for (g = 1; g <= c; g += 1)f = a[(d.index + g) % e], "image" === f.type && f.href && ((new Image).src = f.href);
        },
        _afterLoad: function() {
            var a = b.coming, d = b.current, e, c, k, g, h;
            b.hideLoading();
            if (a && !1 !== b.isActive)
                if (!1 === b.trigger("afterLoad", a, d))a.wrap.stop(!0).trigger("onReset").remove(), b.coming = null;
                else {
                    d && (b.trigger("beforeChange", d), d.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove());
                    b.unbindEvents();
                    e = a.content;
                    c = a.type;
                    k = a.scrolling;
                    f.extend(b, {
                        wrap: a.wrap,
                        skin: a.skin,
                        outer: a.outer,
                        inner: a.inner,
                        current: a,
                        previous: d
                    });
                    g = a.href;
                    switch (c) {
                        case "inline":
                        case "ajax":
                        case "html":
                            a.selector ? e = f("<div>").html(e).find(a.selector) : t(e) && (e.data("fancybox-placeholder") || e.data("fancybox-placeholder", f('<div class="fancybox-placeholder"></div>').insertAfter(e).hide()), e = e.show().detach(), a.wrap.bind("onReset", function() { f(this).find(e).length && e.hide().replaceAll(e.data("fancybox-placeholder")).data("fancybox-placeholder", !1); }));
                            break;
                        case "image":
                            e = a.tpl.image.replace("{href}",
                                g);
                            break;
                        case "swf":
                            e = '<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="' + g + '"></param>', h = "", f.each(a.swf, function(a, b) {
                                e += '<param name="' + a + '" value="' + b + '"></param>';
                                h += " " + a + '="' + b + '"';
                            }), e += '<embed src="' + g + '" type="application/x-shockwave-flash" width="100%" height="100%"' + h + "></embed></object>";
                    }
                    (!t(e) || !e.parent().is(a.inner)) && a.inner.append(e);
                    b.trigger("beforeShow");
                    a.inner.css("overflow", "yes" === k ? "scroll" :
                        "no" === k ? "hidden" : k);
                    b._setDimension();
                    b.reposition();
                    b.isOpen = !1;
                    b.coming = null;
                    b.bindEvents();
                    if (b.isOpened) {
                        if (d.prevMethod)b.transitions[d.prevMethod]();
                    } else f(".fancybox-wrap").not(a.wrap).stop(!0).trigger("onReset").remove();
                    b.transitions[b.isOpened ? a.nextMethod : a.openMethod]();
                    b._preloadImages();
                }
        },
        _setDimension: function() {
            var a = b.getViewport(),
                d = 0,
                e = !1,
                c = !1,
                e = b.wrap,
                k = b.skin,
                g = b.inner,
                h = b.current,
                c = h.width,
                j = h.height,
                m = h.minWidth,
                u = h.minHeight,
                n = h.maxWidth,
                p = h.maxHeight,
                s = h.scrolling,
                q = h.scrollOutside ?
                    h.scrollbarWidth : 0,
                x = h.margin,
                y = l(x[1] + x[3]),
                r = l(x[0] + x[2]),
                v,
                z,
                t,
                C,
                A,
                F,
                B,
                D,
                H;
            e.add(k).add(g).width("auto").height("auto").removeClass("fancybox-tmp");
            x = l(k.outerWidth(!0) - k.width());
            v = l(k.outerHeight(!0) - k.height());
            z = y + x;
            t = r + v;
            C = E(c) ? (a.w - z) * l(c) / 100 : c;
            A = E(j) ? (a.h - t) * l(j) / 100 : j;
            if ("iframe" === h.type) {
                if (H = h.content, h.autoHeight && 1 === H.data("ready"))
                    try {
                        H[0].contentWindow.document.location && (g.width(C).height(9999), F = H.contents().find("body"), q && F.css("overflow-x", "hidden"), A = F.outerHeight(!0));
                    } catch (G) {
                    }
            } else if (h.autoWidth ||
                h.autoHeight)g.addClass("fancybox-tmp"), h.autoWidth || g.width(C), h.autoHeight || g.height(A), h.autoWidth && (C = g.width()), h.autoHeight && (A = g.height()), g.removeClass("fancybox-tmp");
            c = l(C);
            j = l(A);
            D = C / A;
            m = l(E(m) ? l(m, "w") - z : m);
            n = l(E(n) ? l(n, "w") - z : n);
            u = l(E(u) ? l(u, "h") - t : u);
            p = l(E(p) ? l(p, "h") - t : p);
            F = n;
            B = p;
            h.fitToView && (n = Math.min(a.w - z, n), p = Math.min(a.h - t, p));
            z = a.w - y;
            r = a.h - r;
            h.aspectRatio ? (c > n && (c = n, j = l(c / D)), j > p && (j = p, c = l(j * D)), c < m && (c = m, j = l(c / D)), j < u && (j = u, c = l(j * D))) : (c = Math.max(m, Math.min(c, n)), h.autoHeight &&
            "iframe" !== h.type && (g.width(c), j = g.height()), j = Math.max(u, Math.min(j, p)));
            if (h.fitToView)
                if (g.width(c).height(j), e.width(c + x), a = e.width(), y = e.height(), h.aspectRatio)for (; (a > z || y > r) && (c > m && j > u) && !(19 < d++);)j = Math.max(u, Math.min(p, j - 10)), c = l(j * D), c < m && (c = m, j = l(c / D)), c > n && (c = n, j = l(c / D)), g.width(c).height(j), e.width(c + x), a = e.width(), y = e.height();
                else c = Math.max(m, Math.min(c, c - (a - z))), j = Math.max(u, Math.min(j, j - (y - r)));
            q && ("auto" === s && j < A && c + x + q < z) && (c += q);
            g.width(c).height(j);
            e.width(c + x);
            a = e.width();
            y = e.height();
            e = (a > z || y > r) && c > m && j > u;
            c = h.aspectRatio ? c < F && j < B && c < C && j < A : (c < F || j < B) && (c < C || j < A);
            f.extend(h, { dim: { width: w(a), height: w(y) }, origWidth: C, origHeight: A, canShrink: e, canExpand: c, wPadding: x, hPadding: v, wrapSpace: y - k.outerHeight(!0), skinSpace: k.height() - j });
            !H && (h.autoHeight && j > u && j < p && !c) && g.height("auto");
        },
        _getPosition: function(a) {
            var d = b.current, e = b.getViewport(), c = d.margin, f = b.wrap.width() + c[1] + c[3], g = b.wrap.height() + c[0] + c[2], c = { position: "absolute", top: c[0], left: c[3] };
            d.autoCenter && d.fixed &&
            !a && g <= e.h && f <= e.w ? c.position = "fixed" : d.locked || (c.top += e.y, c.left += e.x);
            c.top = w(Math.max(c.top, c.top + (e.h - g) * d.topRatio));
            c.left = w(Math.max(c.left, c.left + (e.w - f) * d.leftRatio));
            return c;
        },
        _afterZoomIn: function() {
            var a = b.current;
            a && (b.isOpen = b.isOpened = !0, b.wrap.css("overflow", "visible").addClass("fancybox-opened"), b.update(), (a.closeClick || a.nextClick && 1 < b.group.length) && b.inner.css("cursor", "pointer").bind("click.fb", function(d) {
                !f(d.target).is("a") && !f(d.target).parent().is("a") && (d.preventDefault(),
                    b[a.closeClick ? "close" : "next"]());
            }), a.closeBtn && f(a.tpl.closeBtn).appendTo(b.skin).bind("click.fb", function(a) {
                a.preventDefault();
                b.close();
            }), a.arrows && 1 < b.group.length && ((a.loop || 0 < a.index) && f(a.tpl.prev).appendTo(b.outer).bind("click.fb", b.prev), (a.loop || a.index < b.group.length - 1) && f(a.tpl.next).appendTo(b.outer).bind("click.fb", b.next)), b.trigger("afterShow"), !a.loop && a.index === a.group.length - 1 ? b.play(!1) : b.opts.autoPlay && !b.player.isActive && (b.opts.autoPlay = !1, b.play()));
        },
        _afterZoomOut: function(a) {
            a =
                a || b.current;
            f(".fancybox-wrap").trigger("onReset").remove();
            f.extend(b, { group: {}, opts: {}, router: !1, current: null, isActive: !1, isOpened: !1, isOpen: !1, isClosing: !1, wrap: null, skin: null, outer: null, inner: null });
            b.trigger("afterClose", a);
        }
    });
    b.transitions = {
        getOrigPosition: function() {
            var a = b.current, d = a.element, e = a.orig, c = {}, f = 50, g = 50, h = a.hPadding, j = a.wPadding, m = b.getViewport();
            !e && (a.isDom && d.is(":visible")) && (e = d.find("img:first"), e.length || (e = d));
            t(e) ? (c = e.offset(), e.is("img") && (f = e.outerWidth(), g = e.outerHeight())) :
                (c.top = m.y + (m.h - g) * a.topRatio, c.left = m.x + (m.w - f) * a.leftRatio);
            if ("fixed" === b.wrap.css("position") || a.locked)c.top -= m.y, c.left -= m.x;
            return c = { top: w(c.top - h * a.topRatio), left: w(c.left - j * a.leftRatio), width: w(f + j), height: w(g + h) };
        },
        step: function(a, d) {
            var e, c, f = d.prop;
            c = b.current;
            var g = c.wrapSpace, h = c.skinSpace;
            if ("width" === f || "height" === f)
                e = d.end === d.start ? 1 : (a - d.start) / (d.end - d.start), b.isClosing && (e = 1 - e), c = "width" === f ? c.wPadding : c.hPadding, c = a - c, b.skin[f](l("width" === f ? c : c - g * e)), b.inner[f](l("width" ===
                f ? c : c - g * e - h * e));
        },
        zoomIn: function() {
            var a = b.current, d = a.pos, e = a.openEffect, c = "elastic" === e, k = f.extend({ opacity: 1 }, d);
            delete k.position;
            c ? (d = this.getOrigPosition(), a.openOpacity && (d.opacity = 0.1)) : "fade" === e && (d.opacity = 0.1);
            b.wrap.css(d).animate(k, { duration: "none" === e ? 0 : a.openSpeed, easing: a.openEasing, step: c ? this.step : null, complete: b._afterZoomIn });
        },
        zoomOut: function() {
            var a = b.current, d = a.closeEffect, e = "elastic" === d, c = { opacity: 0.1 };
            e && (c = this.getOrigPosition(), a.closeOpacity && (c.opacity = 0.1));
            b.wrap.animate(c,
                { duration: "none" === d ? 0 : a.closeSpeed, easing: a.closeEasing, step: e ? this.step : null, complete: b._afterZoomOut });
        },
        changeIn: function() {
            var a = b.current, d = a.nextEffect, e = a.pos, c = { opacity: 1 }, f = b.direction, g;
            e.opacity = 0.1;
            "elastic" === d && (g = "down" === f || "up" === f ? "top" : "left", "down" === f || "right" === f ? (e[g] = w(l(e[g]) - 200), c[g] = "+=200px") : (e[g] = w(l(e[g]) + 200), c[g] = "-=200px"));
            "none" === d ? b._afterZoomIn() : b.wrap.css(e).animate(c, { duration: a.nextSpeed, easing: a.nextEasing, complete: b._afterZoomIn });
        },
        changeOut: function() {
            var a =
                    b.previous,
                d = a.prevEffect,
                e = { opacity: 0.1 },
                c = b.direction;
            "elastic" === d && (e["down" === c || "up" === c ? "top" : "left"] = ("up" === c || "left" === c ? "-" : "+") + "=200px");
            a.wrap.animate(e, { duration: "none" === d ? 0 : a.prevSpeed, easing: a.prevEasing, complete: function() { f(this).trigger("onReset").remove(); } });
        }
    };
    b.helpers.overlay = {
        defaults: { closeClick: !0, speedOut: 200, showEarly: !0, css: {}, locked: !s, fixed: !0 },
        overlay: null,
        fixed: !1,
        el: f("html"),
        create: function(a) {
            a = f.extend({}, this.defaults, a);
            this.overlay && this.close();
            this.overlay =
                f('<div class="fancybox-overlay"></div>').appendTo(b.coming ? b.coming.parent : a.parent);
            this.fixed = !1;
            a.fixed && b.defaults.fixed && (this.overlay.addClass("fancybox-overlay-fixed"), this.fixed = !0);
        },
        open: function(a) {
            var d = this;
            a = f.extend({}, this.defaults, a);
            this.overlay ? this.overlay.unbind(".overlay").width("auto").height("auto") : this.create(a);
            this.fixed || (n.bind("resize.overlay", f.proxy(this.update, this)), this.update());
            a.closeClick && this.overlay.bind("click.overlay", function(a) {
                if (f(a.target).hasClass("fancybox-overlay"))
                    return b.isActive ?
                        b.close() : d.close(), !1;
            });
            this.overlay.css(a.css).show();
        },
        close: function() {
            var a, b;
            n.unbind("resize.overlay");
            this.el.hasClass("fancybox-lock") && (f(".fancybox-margin").removeClass("fancybox-margin"), a = n.scrollTop(), b = n.scrollLeft(), this.el.removeClass("fancybox-lock"), n.scrollTop(a).scrollLeft(b));
            f(".fancybox-overlay").remove().hide();
            f.extend(this, { overlay: null, fixed: !1 });
        },
        update: function() {
            var a = "100%", b;
            this.overlay.width(a).height("100%");
            I ? (b = Math.max(G.documentElement.offsetWidth, G.body.offsetWidth),
            p.width() > b && (a = p.width())) : p.width() > n.width() && (a = p.width());
            this.overlay.width(a).height(p.height());
        },
        onReady: function(a, b) {
            var e = this.overlay;
            f(".fancybox-overlay").stop(!0, !0);
            e || this.create(a);
            a.locked && (this.fixed && b.fixed) && (e || (this.margin = p.height() > n.height() ? f("html").css("margin-right").replace("px", "") : !1), b.locked = this.overlay.append(b.wrap), b.fixed = !1);
            !0 === a.showEarly && this.beforeShow.apply(this, arguments);
        },
        beforeShow: function(a, b) {
            var e, c;
            b.locked && (!1 !== this.margin && (f("*").filter(function() {
                return"fixed" ===
                    f(this).css("position") && !f(this).hasClass("fancybox-overlay") && !f(this).hasClass("fancybox-wrap");
            }).addClass("fancybox-margin"), this.el.addClass("fancybox-margin")), e = n.scrollTop(), c = n.scrollLeft(), this.el.addClass("fancybox-lock"), n.scrollTop(e).scrollLeft(c));
            this.open(a);
        },
        onUpdate: function() { this.fixed || this.update(); },
        afterClose: function(a) { this.overlay && !b.coming && this.overlay.fadeOut(a.speedOut, f.proxy(this.close, this)); }
    };
    b.helpers.title = {
        defaults: { type: "float", position: "bottom" },
        beforeShow: function(a) {
            var d =
                    b.current,
                e = d.title,
                c = a.type;
            f.isFunction(e) && (e = e.call(d.element, d));
            if (q(e) && "" !== f.trim(e)) {
                d = f('<div class="fancybox-title fancybox-title-' + c + '-wrap">' + e + "</div>");
                switch (c) {
                    case "inside":
                        c = b.skin;
                        break;
                    case "outside":
                        c = b.wrap;
                        break;
                    case "over":
                        c = b.inner;
                        break;
                    default:
                        c = b.skin, d.appendTo("body"), I && d.width(d.width()), d.wrapInner('<span class="child"></span>'), b.current.margin[2] += Math.abs(l(d.css("margin-bottom")));
                }
                d["top" === a.position ? "prependTo" : "appendTo"](c);
            }
        }
    };
    f.fn.fancybox = function(a) {
        var d,
            e = f(this),
            c = this.selector || "",
            k = function(g) {
                var h = f(this).blur(), j = d, k, l;
                !g.ctrlKey && (!g.altKey && !g.shiftKey && !g.metaKey) && !h.is(".fancybox-wrap") && (k = a.groupAttr || "data-fancybox-group", l = h.attr(k), l || (k = "rel", l = h.get(0)[k]), l && ("" !== l && "nofollow" !== l) && (h = c.length ? f(c) : e, h = h.filter("[" + k + '="' + l + '"]'), j = h.index(this)), a.index = j, !1 !== b.open(h, a) && g.preventDefault());
            };
        a = a || {};
        d = a.index || 0;
        !c || !1 === a.live ? e.unbind("click.fb-start").bind("click.fb-start", k) : p.undelegate(c, "click.fb-start").delegate(c +
        ":not('.fancybox-item, .fancybox-nav')", "click.fb-start", k);
        this.filter("[data-fancybox-start=1]").trigger("click");
        return this;
    };
    p.ready(function() {
        var a, d;
        f.scrollbarWidth === v && (f.scrollbarWidth = function() {
            var a = f('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"), b = a.children(), b = b.innerWidth() - b.height(99).innerWidth();
            a.remove();
            return b;
        });
        if (f.support.fixedPosition === v) {
            a = f.support;
            d = f('<div style="position:fixed;top:20px;"></div>').appendTo("body");
            var e = 20 ===
                d[0].offsetTop || 15 === d[0].offsetTop;
            d.remove();
            a.fixedPosition = e;
        }
        f.extend(b.defaults, { scrollbarWidth: f.scrollbarWidth(), fixed: f.support.fixedPosition, parent: f("body") });
        a = f(r).width();
        J.addClass("fancybox-lock-test");
        d = f(r).width();
        J.removeClass("fancybox-lock-test");
        f("<style type='text/css'>.fancybox-margin{margin-right:" + (d - a) + "px;}</style>").appendTo("head");
    });
})(window, document, jQuery);
// Opentip v2.4.6
// Copyright (c) 2009-2012
// www.opentip.org
// MIT Licensed
var Opentip,firstAdapter,i,mouseMoved,mousePosition,mousePositionObservers,position,vendors,_i,_len,_ref,__slice=[].slice,__indexOf=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},__hasProp={}.hasOwnProperty;for(Opentip=function(){function t(e,i,o,s){var n,r,a,h,p,d,l,u,c,g,f,m,v,b,w=this;if(this.id=++t.lastId,this.debug("Creating Opentip."),t.tips.push(this),this.adapter=t.adapter,n=this.adapter.data(e,"opentips")||[],n.push(this),this.adapter.data(e,"opentips",n),this.triggerElement=this.adapter.wrap(e),this.triggerElement.length>1)throw Error("You can't call Opentip on multiple elements.");if(1>this.triggerElement.length)throw Error("Invalid element.");this.loaded=!1,this.loading=!1,this.visible=!1,this.waitingToShow=!1,this.waitingToHide=!1,this.currentPosition={left:0,top:0},this.dimensions={width:100,height:50},this.content="",this.redraw=!0,this.currentObservers={showing:!1,visible:!1,hiding:!1,hidden:!1},s=this.adapter.clone(s),typeof i=="object"?(s=i,i=o=void 0):typeof o=="object"&&(s=o,o=void 0),o!=null&&(s.title=o),i!=null&&this.setContent(i),s["extends"]==null&&(s["extends"]=s.style!=null?s.style:t.defaultStyle),h=[s],b=s;while(b["extends"]){if(d=b["extends"],b=t.styles[d],b==null)throw Error("Invalid style: "+d);h.unshift(b),b["extends"]==null&&d!=="standard"&&(b["extends"]="standard")}for(s=(f=this.adapter).extend.apply(f,[{}].concat(__slice.call(h))),s.hideTriggers=function(){var t,e,i,o;for(i=s.hideTriggers,o=[],t=0,e=i.length;e>t;t++)r=i[t],o.push(r);return o}(),s.hideTrigger&&s.hideTriggers.length===0&&s.hideTriggers.push(s.hideTrigger),m=["tipJoint","targetJoint","stem"],l=0,c=m.length;c>l;l++)p=m[l],s[p]&&typeof s[p]=="string"&&(s[p]=new t.Joint(s[p]));for(!s.ajax||s.ajax!==!0&&s.ajax||(s.ajax=this.adapter.tagName(this.triggerElement)==="A"?this.adapter.attr(this.triggerElement,"href"):!1),s.showOn==="click"&&this.adapter.tagName(this.triggerElement)==="A"&&this.adapter.observe(this.triggerElement,"click",function(t){return t.preventDefault(),t.stopPropagation(),t.stopped=!0}),s.target&&(s.fixed=!0),s.stem===!0&&(s.stem=new t.Joint(s.tipJoint)),s.target===!0?s.target=this.triggerElement:s.target&&(s.target=this.adapter.wrap(s.target)),this.currentStem=s.stem,s.delay==null&&(s.delay=s.showOn==="mouseover"?.2:0),s.targetJoint==null&&(s.targetJoint=new t.Joint(s.tipJoint).flip()),this.showTriggers=[],this.showTriggersWhenVisible=[],this.hideTriggers=[],s.showOn&&s.showOn!=="creation"&&this.showTriggers.push({element:this.triggerElement,event:s.showOn}),s.ajaxCache!=null&&(s.cache=s.ajaxCache,delete s.ajaxCache),this.options=s,this.bound={},v=["prepareToShow","prepareToHide","show","hide","reposition"],u=0,g=v.length;g>u;u++)a=v[u],this.bound[a]=function(t){return function(){return w[t].apply(w,arguments)}}(a);this.adapter.domReady(function(){return w.activate(),w.options.showOn==="creation"?w.prepareToShow():void 0})}return t.prototype.STICKS_OUT_TOP=1,t.prototype.STICKS_OUT_BOTTOM=2,t.prototype.STICKS_OUT_LEFT=1,t.prototype.STICKS_OUT_RIGHT=2,t.prototype["class"]={container:"opentip-container",opentip:"opentip",header:"ot-header",content:"ot-content",loadingIndicator:"ot-loading-indicator",close:"ot-close",goingToHide:"ot-going-to-hide",hidden:"ot-hidden",hiding:"ot-hiding",goingToShow:"ot-going-to-show",showing:"ot-showing",visible:"ot-visible",loading:"ot-loading",ajaxError:"ot-ajax-error",fixed:"ot-fixed",showEffectPrefix:"ot-show-effect-",hideEffectPrefix:"ot-hide-effect-",stylePrefix:"style-"},t.prototype._setup=function(){var t,e,i,o,s,n,r,a,h,p,d;for(this.debug("Setting up the tooltip."),this._buildContainer(),this.hideTriggers=[],h=this.options.hideTriggers,o=s=0,r=h.length;r>s;o=++s){if(e=h[o],i=null,t=this.options.hideOn instanceof Array?this.options.hideOn[o]:this.options.hideOn,typeof e=="string")switch(e){case"trigger":t=t||"mouseout",i=this.triggerElement;break;case"tip":t=t||"mouseover",i=this.container;break;case"target":t=t||"mouseover",i=this.options.target;break;case"closeButton":break;default:throw Error("Unknown hide trigger: "+e+".")}else t=t||"mouseover",i=this.adapter.wrap(e);i&&this.hideTriggers.push({element:i,event:t,original:e})}for(p=this.hideTriggers,d=[],n=0,a=p.length;a>n;n++)e=p[n],d.push(this.showTriggersWhenVisible.push({element:e.element,event:"mouseover"}));return d},t.prototype._buildContainer=function(){return this.container=this.adapter.create('<div id="opentip-'+this.id+'" class="'+this["class"].container+" "+this["class"].hidden+" "+this["class"].stylePrefix+this.options.className+'"></div>'),this.adapter.css(this.container,{position:"absolute"}),this.options.ajax&&this.adapter.addClass(this.container,this["class"].loading),this.options.fixed&&this.adapter.addClass(this.container,this["class"].fixed),this.options.showEffect&&this.adapter.addClass(this.container,""+this["class"].showEffectPrefix+this.options.showEffect),this.options.hideEffect?this.adapter.addClass(this.container,""+this["class"].hideEffectPrefix+this.options.hideEffect):void 0},t.prototype._buildElements=function(){var t,e;return this.tooltipElement=this.adapter.create('<div class="'+this["class"].opentip+'"><div class="'+this["class"].header+'"></div><div class="'+this["class"].content+'"></div></div>'),this.backgroundCanvas=this.adapter.wrap(document.createElement("canvas")),this.adapter.css(this.backgroundCanvas,{position:"absolute"}),typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager!==null&&G_vmlCanvasManager.initElement(this.adapter.unwrap(this.backgroundCanvas)),t=this.adapter.find(this.tooltipElement,"."+this["class"].header),this.options.title&&(e=this.adapter.create("<h1></h1>"),this.adapter.update(e,this.options.title,this.options.escapeTitle),this.adapter.append(t,e)),this.options.ajax&&!this.loaded&&this.adapter.append(this.tooltipElement,this.adapter.create('<div class="'+this["class"].loadingIndicator+'"><span>↻</span></div>')),__indexOf.call(this.options.hideTriggers,"closeButton")>=0&&(this.closeButtonElement=this.adapter.create('<a href="javascript:undefined;" class="'+this["class"].close+'"><span>Close</span></a>'),this.adapter.append(t,this.closeButtonElement)),this.adapter.append(this.container,this.backgroundCanvas),this.adapter.append(this.container,this.tooltipElement),this.adapter.append(document.body,this.container),this._newContent=!0,this.redraw=!0},t.prototype.setContent=function(t){return this.content=t,this._newContent=!0,typeof this.content=="function"?(this._contentFunction=this.content,this.content=""):this._contentFunction=null,this.visible?this._updateElementContent():void 0},t.prototype._updateElementContent=function(){var t;return(this._newContent||!this.options.cache&&this._contentFunction)&&(t=this.adapter.find(this.container,"."+this["class"].content),t!=null&&(this._contentFunction&&(this.debug("Executing content function."),this.content=this._contentFunction(this)),this.adapter.update(t,this.content,this.options.escapeContent)),this._newContent=!1),this._storeAndLockDimensions(),this.reposition()},t.prototype._storeAndLockDimensions=function(){var t;if(this.container)return t=this.dimensions,this.adapter.css(this.container,{width:"auto",left:"0px",top:"0px"}),this.dimensions=this.adapter.dimensions(this.container),this.dimensions.width+=1,this.adapter.css(this.container,{width:""+this.dimensions.width+"px",top:""+this.currentPosition.top+"px",left:""+this.currentPosition.left+"px"}),this._dimensionsEqual(this.dimensions,t)?void 0:(this.redraw=!0,this._draw())},t.prototype.activate=function(){return this._setupObservers("hidden","hiding")},t.prototype.deactivate=function(){return this.debug("Deactivating tooltip."),this.hide(),this._setupObservers("-showing","-visible","-hidden","-hiding")},t.prototype._setupObservers=function(){var t,e,i,o,s,n,r,a,h,p,d,l,u,c,g,f,m=this;for(o=arguments.length>=1?__slice.call(arguments,0):[],n=0,p=o.length;p>n;n++)if(i=o[n],e=!1,i.charAt(0)==="-"&&(e=!0,i=i.substr(1)),this.currentObservers[i]!==!e)switch(this.currentObservers[i]=!e,t=function(){var t,i,o;return t=arguments.length>=1?__slice.call(arguments,0):[],e?(i=m.adapter).stopObserving.apply(i,t):(o=m.adapter).observe.apply(o,t)},i){case"showing":for(c=this.hideTriggers,r=0,d=c.length;d>r;r++)s=c[r],t(s.element,s.event,this.bound.prepareToHide);t(document.onresize!=null?document:window,"resize",this.bound.reposition),t(window,"scroll",this.bound.reposition);break;case"visible":for(g=this.showTriggersWhenVisible,a=0,l=g.length;l>a;a++)s=g[a],t(s.element,s.event,this.bound.prepareToShow);break;case"hiding":for(f=this.showTriggers,h=0,u=f.length;u>h;h++)s=f[h],t(s.element,s.event,this.bound.prepareToShow);break;case"hidden":break;default:throw Error("Unknown state: "+i)}return null},t.prototype.prepareToShow=function(){return this._abortHiding(),this._abortShowing(),this.visible?void 0:(this.debug("Showing in "+this.options.delay+"s."),this.container==null&&this._setup(),this.options.group&&t._abortShowingGroup(this.options.group,this),this.preparingToShow=!0,this._setupObservers("-hidden","-hiding","showing"),this._followMousePosition(),this.options.fixed&&!this.options.target&&(this.initialMousePosition=mousePosition),this.reposition(),this._showTimeoutId=this.setTimeout(this.bound.show,this.options.delay||0))},t.prototype.show=function(){var e=this;return this._abortHiding(),this.visible?void 0:(this._clearTimeouts(),this._triggerElementExists()?(this.debug("Showing now."),this.container==null&&this._setup(),this.options.group&&t._hideGroup(this.options.group,this),this.visible=!0,this.preparingToShow=!1,this.tooltipElement==null&&this._buildElements(),this._updateElementContent(),!this.options.ajax||this.loaded&&this.options.cache||this._loadAjax(),this._searchAndActivateCloseButtons(),this._startEnsureTriggerElement(),this.adapter.css(this.container,{zIndex:t.lastZIndex++}),this._setupObservers("-hidden","-hiding","-showing","-visible","showing","visible"),this.options.fixed&&!this.options.target&&(this.initialMousePosition=mousePosition),this.reposition(),this.adapter.removeClass(this.container,this["class"].hiding),this.adapter.removeClass(this.container,this["class"].hidden),this.adapter.addClass(this.container,this["class"].goingToShow),this.setCss3Style(this.container,{transitionDuration:"0s"}),this.defer(function(){var t;if(e.visible&&!e.preparingToHide)return e.adapter.removeClass(e.container,e["class"].goingToShow),e.adapter.addClass(e.container,e["class"].showing),t=0,e.options.showEffect&&e.options.showEffectDuration&&(t=e.options.showEffectDuration),e.setCss3Style(e.container,{transitionDuration:""+t+"s"}),e._visibilityStateTimeoutId=e.setTimeout(function(){return e.adapter.removeClass(e.container,e["class"].showing),e.adapter.addClass(e.container,e["class"].visible)},t),e._activateFirstInput()}),this._draw()):this.deactivate())},t.prototype._abortShowing=function(){return this.preparingToShow?(this.debug("Aborting showing."),this._clearTimeouts(),this._stopFollowingMousePosition(),this.preparingToShow=!1,this._setupObservers("-showing","-visible","hiding","hidden")):void 0},t.prototype.prepareToHide=function(){return this._abortShowing(),this._abortHiding(),this.visible?(this.debug("Hiding in "+this.options.hideDelay+"s"),this.preparingToHide=!0,this._setupObservers("-showing","visible","-hidden","hiding"),this._hideTimeoutId=this.setTimeout(this.bound.hide,this.options.hideDelay)):void 0},t.prototype.hide=function(){var t=this;return this._abortShowing(),this.visible&&(this._clearTimeouts(),this.debug("Hiding!"),this.visible=!1,this.preparingToHide=!1,this._stopEnsureTriggerElement(),this._setupObservers("-showing","-visible","-hiding","-hidden","hiding","hidden"),this.options.fixed||this._stopFollowingMousePosition(),this.container)?(this.adapter.removeClass(this.container,this["class"].visible),this.adapter.removeClass(this.container,this["class"].showing),this.adapter.addClass(this.container,this["class"].goingToHide),this.setCss3Style(this.container,{transitionDuration:"0s"}),this.defer(function(){var e;return t.adapter.removeClass(t.container,t["class"].goingToHide),t.adapter.addClass(t.container,t["class"].hiding),e=0,t.options.hideEffect&&t.options.hideEffectDuration&&(e=t.options.hideEffectDuration),t.setCss3Style(t.container,{transitionDuration:""+e+"s"}),t._visibilityStateTimeoutId=t.setTimeout(function(){return t.adapter.removeClass(t.container,t["class"].hiding),t.adapter.addClass(t.container,t["class"].hidden),t.setCss3Style(t.container,{transitionDuration:"0s"}),t.options.removeElementsOnHide?(t.debug("Removing HTML elements."),t.adapter.remove(t.container),delete t.container,delete t.tooltipElement):void 0},e)})):void 0},t.prototype._abortHiding=function(){return this.preparingToHide?(this.debug("Aborting hiding."),this._clearTimeouts(),this.preparingToHide=!1,this._setupObservers("-hiding","showing","visible")):void 0},t.prototype.reposition=function(){var t,e,i,o=this;return t=this.getPosition(),t==null||(e=this.options.stem,this.options.containInViewport&&(i=this._ensureViewportContainment(t),t=i.position,e=i.stem),this._positionsEqual(t,this.currentPosition))?void 0:(this.options.stem&&!e.eql(this.currentStem)&&(this.redraw=!0),this.currentPosition=t,this.currentStem=e,this._draw(),this.adapter.css(this.container,{left:""+t.left+"px",top:""+t.top+"px"}),this.defer(function(){var t,e;return t=o.adapter.unwrap(o.container),t.style.visibility="hidden",e=t.offsetHeight,t.style.visibility="visible"}))},t.prototype.getPosition=function(t,e,i){var o,s,n,r,a,h,p,d,l;if(this.container)return t==null&&(t=this.options.tipJoint),e==null&&(e=this.options.targetJoint),r={},this.options.target?(p=this.adapter.offset(this.options.target),h=this.adapter.dimensions(this.options.target),r=p,e.right?(d=this.adapter.unwrap(this.options.target),d.getBoundingClientRect!=null?r.left=d.getBoundingClientRect().right+((l=window.pageXOffset)!=null?l:document.body.scrollLeft):r.left+=h.width):e.center&&(r.left+=Math.round(h.width/2)),e.bottom?r.top+=h.height:e.middle&&(r.top+=Math.round(h.height/2)),this.options.borderWidth&&(this.options.tipJoint.left&&(r.left+=this.options.borderWidth),this.options.tipJoint.right&&(r.left-=this.options.borderWidth),this.options.tipJoint.top?r.top+=this.options.borderWidth:this.options.tipJoint.bottom&&(r.top-=this.options.borderWidth))):r=this.initialMousePosition?{top:this.initialMousePosition.y,left:this.initialMousePosition.x}:{top:mousePosition.y,left:mousePosition.x},this.options.autoOffset&&(a=this.options.stem?this.options.stemLength:0,n=a&&this.options.fixed?2:10,o=t.middle&&!this.options.fixed?15:0,s=t.center&&!this.options.fixed?15:0,t.right?r.left-=n+o:t.left&&(r.left+=n+o),t.bottom?r.top-=n+s:t.top&&(r.top+=n+s),a&&(i==null&&(i=this.options.stem),i.right?r.left-=a:i.left&&(r.left+=a),i.bottom?r.top-=a:i.top&&(r.top+=a))),r.left+=this.options.offset[0],r.top+=this.options.offset[1],t.right?r.left-=this.dimensions.width:t.center&&(r.left-=Math.round(this.dimensions.width/2)),t.bottom?r.top-=this.dimensions.height:t.middle&&(r.top-=Math.round(this.dimensions.height/2)),r},t.prototype._ensureViewportContainment=function(e){var i,o,s,n,r,a,h,p,d,l,u,c;if(h=this.options.stem,s={position:e,stem:h},!this.visible||!e)return s;if(p=this._sticksOut(e),!p[0]&&!p[1])return s;if(l=new t.Joint(this.options.tipJoint),this.options.targetJoint&&(d=new t.Joint(this.options.targetJoint)),a=this.adapter.scrollOffset(),u=this.adapter.viewportDimensions(),c=[e.left-a[0],e.top-a[1]],i=!1,u.width>=this.dimensions.width&&p[0])switch(i=!0,p[0]){case this.STICKS_OUT_LEFT:l.setHorizontal("left"),this.options.targetJoint&&d.setHorizontal("right");break;case this.STICKS_OUT_RIGHT:l.setHorizontal("right"),this.options.targetJoint&&d.setHorizontal("left")}if(u.height>=this.dimensions.height&&p[1])switch(i=!0,p[1]){case this.STICKS_OUT_TOP:l.setVertical("top"),this.options.targetJoint&&d.setVertical("bottom");break;case this.STICKS_OUT_BOTTOM:l.setVertical("bottom"),this.options.targetJoint&&d.setVertical("top")}return i?(this.options.stem&&(h=l),e=this.getPosition(l,d,h),o=this._sticksOut(e),n=!1,r=!1,o[0]&&o[0]!==p[0]&&(n=!0,l.setHorizontal(this.options.tipJoint.horizontal),this.options.targetJoint&&d.setHorizontal(this.options.targetJoint.horizontal)),o[1]&&o[1]!==p[1]&&(r=!0,l.setVertical(this.options.tipJoint.vertical),this.options.targetJoint&&d.setVertical(this.options.targetJoint.vertical)),n&&r?s:((n||r)&&(this.options.stem&&(h=l),e=this.getPosition(l,d,h)),{position:e,stem:h})):s},t.prototype._sticksOut=function(t){var e,i,o,s;return i=this.adapter.scrollOffset(),s=this.adapter.viewportDimensions(),e=[t.left-i[0],t.top-i[1]],o=[!1,!1],0>e[0]?o[0]=this.STICKS_OUT_LEFT:e[0]+this.dimensions.width>s.width&&(o[0]=this.STICKS_OUT_RIGHT),0>e[1]?o[1]=this.STICKS_OUT_TOP:e[1]+this.dimensions.height>s.height&&(o[1]=this.STICKS_OUT_BOTTOM),o},t.prototype._draw=function(){var e,i,o,s,n,r,a,h,p,d,l,u,c,g,f,m,v,b,w,_=this;if(this.backgroundCanvas&&this.redraw){if(this.debug("Drawing background."),this.redraw=!1,this.currentStem){for(v=["top","right","bottom","left"],f=0,m=v.length;m>f;f++)u=v[f],this.adapter.removeClass(this.container,"stem-"+u);this.adapter.addClass(this.container,"stem-"+this.currentStem.horizontal),this.adapter.addClass(this.container,"stem-"+this.currentStem.vertical)}return r=[0,0],a=[0,0],__indexOf.call(this.options.hideTriggers,"closeButton")>=0&&(n=new t.Joint(((b=this.currentStem)!=null?b+"":void 0)==="top right"?"top left":"top right"),r=[this.options.closeButtonRadius+this.options.closeButtonOffset[0],this.options.closeButtonRadius+this.options.closeButtonOffset[1]],a=[this.options.closeButtonRadius-this.options.closeButtonOffset[0],this.options.closeButtonRadius-this.options.closeButtonOffset[1]]),o=this.adapter.clone(this.dimensions),s=[0,0],this.options.borderWidth&&(o.width+=this.options.borderWidth*2,o.height+=this.options.borderWidth*2,s[0]-=this.options.borderWidth,s[1]-=this.options.borderWidth),this.options.shadow&&(o.width+=this.options.shadowBlur*2,o.width+=Math.max(0,this.options.shadowOffset[0]-this.options.shadowBlur*2),o.height+=this.options.shadowBlur*2,o.height+=Math.max(0,this.options.shadowOffset[1]-this.options.shadowBlur*2),s[0]-=Math.max(0,this.options.shadowBlur-this.options.shadowOffset[0]),s[1]-=Math.max(0,this.options.shadowBlur-this.options.shadowOffset[1])),i={left:0,right:0,top:0,bottom:0},this.currentStem&&(this.currentStem.left?i.left=this.options.stemLength:this.currentStem.right&&(i.right=this.options.stemLength),this.currentStem.top?i.top=this.options.stemLength:this.currentStem.bottom&&(i.bottom=this.options.stemLength)),n&&(n.left?i.left=Math.max(i.left,a[0]):n.right&&(i.right=Math.max(i.right,a[0])),n.top?i.top=Math.max(i.top,a[1]):n.bottom&&(i.bottom=Math.max(i.bottom,a[1]))),o.width+=i.left+i.right,o.height+=i.top+i.bottom,s[0]-=i.left,s[1]-=i.top,this.currentStem&&this.options.borderWidth&&(w=this._getPathStemMeasures(this.options.stemBase,this.options.stemLength,this.options.borderWidth),g=w.stemLength,c=w.stemBase),e=this.adapter.unwrap(this.backgroundCanvas),e.width=o.width,e.height=o.height,this.adapter.css(this.backgroundCanvas,{width:""+e.width+"px",height:""+e.height+"px",left:""+s[0]+"px",top:""+s[1]+"px"}),h=e.getContext("2d"),h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,e.width,e.height),h.beginPath(),h.fillStyle=this._getColor(h,this.dimensions,this.options.background,this.options.backgroundGradientHorizontal),h.lineJoin="miter",h.miterLimit=500,l=this.options.borderWidth/2,this.options.borderWidth?(h.strokeStyle=this.options.borderColor,h.lineWidth=this.options.borderWidth):(g=this.options.stemLength,c=this.options.stemBase),c==null&&(c=0),d=function(t,e,i){return i&&h.moveTo(Math.max(c,_.options.borderRadius,r[0])+1-l,-l),e?(h.lineTo(t/2-c/2,-l),h.lineTo(t/2,-g-l),h.lineTo(t/2+c/2,-l)):void 0},p=function(t,e,i){var o,s,n,a;return t?(h.lineTo(-c+l,0-l),h.lineTo(g+l,-g-l),h.lineTo(l,c-l)):e?(a=_.options.closeButtonOffset,n=r[0],i%2!==0&&(a=[a[1],a[0]],n=r[1]),o=Math.acos(a[1]/_.options.closeButtonRadius),s=Math.acos(a[0]/_.options.closeButtonRadius),h.lineTo(-n+l,-l),h.arc(l-a[0],-l+a[1],_.options.closeButtonRadius,-(Math.PI/2+o),s,!1)):(h.lineTo(-_.options.borderRadius+l,-l),h.quadraticCurveTo(l,-l,l,_.options.borderRadius-l))},h.translate(-s[0],-s[1]),h.save(),function(){var e,i,o,s,r,a,l,u,c,g,f;for(f=[],i=c=0,g=t.positions.length/2;g>=0?g>c:c>g;i=g>=0?++c:--c)r=i*2,a=i===0||i===3?0:_.dimensions.width,l=2>i?0:_.dimensions.height,u=Math.PI/2*i,o=i%2===0?_.dimensions.width:_.dimensions.height,s=new t.Joint(t.positions[r]),e=new t.Joint(t.positions[r+1]),h.save(),h.translate(a,l),h.rotate(u),d(o,s.eql(_.currentStem),i===0),h.translate(o,0),p(e.eql(_.currentStem),e.eql(n),i),f.push(h.restore());return f}(),h.closePath(),h.save(),this.options.shadow&&(h.shadowColor=this.options.shadowColor,h.shadowBlur=this.options.shadowBlur,h.shadowOffsetX=this.options.shadowOffset[0],h.shadowOffsetY=this.options.shadowOffset[1]),h.fill(),h.restore(),this.options.borderWidth&&h.stroke(),h.restore(),n?function(){var t,e,i,o,s;return i=e=_.options.closeButtonRadius*2,n+""=="top right"?(s=[_.dimensions.width-_.options.closeButtonOffset[0],_.options.closeButtonOffset[1]],t=[s[0]+l,s[1]-l]):(s=[_.options.closeButtonOffset[0],_.options.closeButtonOffset[1]],t=[s[0]-l,s[1]-l]),h.translate(t[0],t[1]),o=_.options.closeButtonCrossSize/2,h.save(),h.beginPath(),h.strokeStyle=_.options.closeButtonCrossColor,h.lineWidth=_.options.closeButtonCrossLineWidth,h.lineCap="round",h.moveTo(-o,-o),h.lineTo(o,o),h.stroke(),h.beginPath(),h.moveTo(o,-o),h.lineTo(-o,o),h.stroke(),h.restore(),_.adapter.css(_.closeButtonElement,{left:""+(s[0]-o-_.options.closeButtonLinkOverscan)+"px",top:""+(s[1]-o-_.options.closeButtonLinkOverscan)+"px",width:""+(_.options.closeButtonCrossSize+_.options.closeButtonLinkOverscan*2)+"px",height:""+(_.options.closeButtonCrossSize+_.options.closeButtonLinkOverscan*2)+"px"})}():void 0}},t.prototype._getPathStemMeasures=function(t,e,i){var o,s,n,r,a,h,p;if(r=i/2,n=Math.atan(t/2/e),o=n*2,a=r/Math.sin(o),s=2*a*Math.cos(n),p=r+e-s,0>p)throw Error("Sorry but your stemLength / stemBase ratio is strange.");return h=Math.tan(n)*p*2,{stemLength:p,stemBase:h}},t.prototype._getColor=function(t,e,i,o){var s,n,r,a,h;if(o==null&&(o=!1),typeof i=="string")return i;for(n=o?t.createLinearGradient(0,0,e.width,0):t.createLinearGradient(0,0,0,e.height),r=a=0,h=i.length;h>a;r=++a)s=i[r],n.addColorStop(s[0],s[1]);return n},t.prototype._searchAndActivateCloseButtons=function(){var t,e,i,o;for(o=this.adapter.findAll(this.container,"."+this["class"].close),e=0,i=o.length;i>e;e++)t=o[e],this.hideTriggers.push({element:this.adapter.wrap(t),event:"click"});return this.currentObservers.showing&&this._setupObservers("-showing","showing"),this.currentObservers.visible?this._setupObservers("-visible","visible"):void 0},t.prototype._activateFirstInput=function(){var t;return t=this.adapter.unwrap(this.adapter.find(this.container,"input, textarea")),t!=null?typeof t.focus=="function"?t.focus():void 0:void 0},t.prototype._followMousePosition=function(){return this.options.fixed?void 0:t._observeMousePosition(this.bound.reposition)},t.prototype._stopFollowingMousePosition=function(){return this.options.fixed?void 0:t._stopObservingMousePosition(this.bound.reposition)},t.prototype._clearShowTimeout=function(){return clearTimeout(this._showTimeoutId)},t.prototype._clearHideTimeout=function(){return clearTimeout(this._hideTimeoutId)},t.prototype._clearTimeouts=function(){return clearTimeout(this._visibilityStateTimeoutId),this._clearShowTimeout(),this._clearHideTimeout()},t.prototype._triggerElementExists=function(){var t;t=this.adapter.unwrap(this.triggerElement);while(t.parentNode){if(t.parentNode.tagName==="BODY")return!0;t=t.parentNode}return!1},t.prototype._loadAjax=function(){var t=this;if(!this.loading)return this.loaded=!1,this.loading=!0,this.adapter.addClass(this.container,this["class"].loading),this.setContent(""),this.debug("Loading content from "+this.options.ajax),this.adapter.ajax({url:this.options.ajax,method:this.options.ajaxMethod,onSuccess:function(e){return t.debug("Loading successful."),t.adapter.removeClass(t.container,t["class"].loading),t.setContent(e)},onError:function(e){var i;return i=t.options.ajaxErrorMessage,t.debug(i,e),t.setContent(i),t.adapter.addClass(t.container,t["class"].ajaxError)},onComplete:function(){return t.adapter.removeClass(t.container,t["class"].loading),t.loading=!1,t.loaded=!0,t._searchAndActivateCloseButtons(),t._activateFirstInput(),t.reposition()}})},t.prototype._ensureTriggerElement=function(){return this._triggerElementExists()?void 0:(this.deactivate(),this._stopEnsureTriggerElement())},t.prototype._ensureTriggerElementInterval=1e3,t.prototype._startEnsureTriggerElement=function(){var t=this;return this._ensureTriggerElementTimeoutId=setInterval(function(){return t._ensureTriggerElement()},this._ensureTriggerElementInterval)},t.prototype._stopEnsureTriggerElement=function(){return clearInterval(this._ensureTriggerElementTimeoutId)},t}(),vendors=["khtml","ms","o","moz","webkit"],Opentip.prototype.setCss3Style=function(t,e){var i,o,s,n,r;t=this.adapter.unwrap(t),r=[];for(i in e)__hasProp.call(e,i)&&(o=e[i],t.style[i]!=null?r.push(t.style[i]=o):r.push(function(){var e,r,a;for(a=[],e=0,r=vendors.length;r>e;e++)s=vendors[e],n=""+this.ucfirst(s)+this.ucfirst(i),t.style[n]!=null?a.push(t.style[n]=o):a.push(void 0);return a}.call(this)));return r},Opentip.prototype.defer=function(t){return setTimeout(t,0)},Opentip.prototype.setTimeout=function(t,e){return setTimeout(t,e?e*1e3:0)},Opentip.prototype.ucfirst=function(t){return t==null?"":t.charAt(0).toUpperCase()+t.slice(1)},Opentip.prototype.dasherize=function(t){return t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()})},mousePositionObservers=[],mousePosition={x:0,y:0},mouseMoved=function(t){var e,i,o,s;for(mousePosition=Opentip.adapter.mousePosition(t),s=[],i=0,o=mousePositionObservers.length;o>i;i++)e=mousePositionObservers[i],s.push(e());return s},Opentip.followMousePosition=function(){return Opentip.adapter.observe(document.body,"mousemove",mouseMoved)},Opentip._observeMousePosition=function(t){return mousePositionObservers.push(t)},Opentip._stopObservingMousePosition=function(t){var e;return mousePositionObservers=function(){var i,o,s;for(s=[],i=0,o=mousePositionObservers.length;o>i;i++)e=mousePositionObservers[i],e!==t&&s.push(e);return s}()},Opentip.Joint=function(){function t(t){t!=null&&(t instanceof Opentip.Joint&&(t+=""),this.set(t))}return t.prototype.set=function(t){return t=t.toLowerCase(),this.setHorizontal(t),this.setVertical(t),this},t.prototype.setHorizontal=function(t){var e,i,o,s,n,r,a;for(i=["left","center","right"],o=0,n=i.length;n>o;o++)e=i[o],~t.indexOf(e)&&(this.horizontal=e.toLowerCase());for(this.horizontal==null&&(this.horizontal="center"),a=[],s=0,r=i.length;r>s;s++)e=i[s],a.push(this[e]=this.horizontal===e?e:void 0);return a},t.prototype.setVertical=function(t){var e,i,o,s,n,r,a;for(i=["top","middle","bottom"],o=0,n=i.length;n>o;o++)e=i[o],~t.indexOf(e)&&(this.vertical=e.toLowerCase());for(this.vertical==null&&(this.vertical="middle"),a=[],s=0,r=i.length;r>s;s++)e=i[s],a.push(this[e]=this.vertical===e?e:void 0);return a},t.prototype.eql=function(t){return t!=null&&this.horizontal===t.horizontal&&this.vertical===t.vertical},t.prototype.flip=function(){var t,e;return e=Opentip.position[this.toString(!0)],t=(e+4)%8,this.set(Opentip.positions[t]),this},t.prototype.toString=function(t){var e,i;return t==null&&(t=!1),i=this.vertical==="middle"?"":this.vertical,e=this.horizontal==="center"?"":this.horizontal,i&&e&&(e=t?Opentip.prototype.ucfirst(e):" "+e),""+i+e},t}(),Opentip.prototype._positionsEqual=function(t,e){return t!=null&&e!=null&&t.left===e.left&&t.top===e.top},Opentip.prototype._dimensionsEqual=function(t,e){return t!=null&&e!=null&&t.width===e.width&&t.height===e.height},Opentip.prototype.debug=function(){var t;return t=arguments.length>=1?__slice.call(arguments,0):[],Opentip.debug&&(typeof console!="undefined"&&console!==null?console.debug:void 0)!=null?(t.unshift("#"+this.id+" |"),console.debug.apply(console,t)):void 0},Opentip.findElements=function(){var t,e,i,o,s,n,r,a,h,p;for(t=Opentip.adapter,h=t.findAll(document.body,"[data-ot]"),p=[],r=0,a=h.length;a>r;r++){i=h[r],n={},e=t.data(i,"ot"),(e===""||e==="true"||e==="yes")&&(e=t.attr(i,"title"),t.attr(i,"title","")),e=e||"";for(o in Opentip.styles.standard)s=t.data(i,"ot"+Opentip.prototype.ucfirst(o)),s!=null&&(s==="yes"||s==="true"||s==="on"?s=!0:(s==="no"||s==="false"||s==="off")&&(s=!1),n[o]=s);p.push(new Opentip(i,e,n))}return p},Opentip.version="2.4.6",Opentip.debug=!1,Opentip.lastId=0,Opentip.lastZIndex=100,Opentip.tips=[],Opentip._abortShowingGroup=function(t,e){var i,o,s,n,r;for(n=Opentip.tips,r=[],o=0,s=n.length;s>o;o++)i=n[o],i!==e&&i.options.group===t?r.push(i._abortShowing()):r.push(void 0);return r},Opentip._hideGroup=function(t,e){var i,o,s,n,r;for(n=Opentip.tips,r=[],o=0,s=n.length;s>o;o++)i=n[o],i!==e&&i.options.group===t?r.push(i.hide()):r.push(void 0);return r},Opentip.adapters={},Opentip.adapter=null,firstAdapter=!0,Opentip.addAdapter=function(t){return Opentip.adapters[t.name]=t,firstAdapter?(Opentip.adapter=t,t.domReady(Opentip.findElements),t.domReady(Opentip.followMousePosition),firstAdapter=!1):void 0},Opentip.positions=["top","topRight","right","bottomRight","bottom","bottomLeft","left","topLeft"],Opentip.position={},_ref=Opentip.positions,i=_i=0,_len=_ref.length;_len>_i;i=++_i)position=_ref[i],Opentip.position[position]=i;Opentip.styles={standard:{"extends":null,title:void 0,escapeTitle:!0,escapeContent:!1,className:"standard",stem:!0,delay:null,hideDelay:.1,fixed:!1,showOn:"mouseover",hideTrigger:"trigger",hideTriggers:[],hideOn:null,removeElementsOnHide:!1,offset:[0,0],containInViewport:!0,autoOffset:!0,showEffect:"appear",hideEffect:"fade",showEffectDuration:.3,hideEffectDuration:.2,stemLength:5,stemBase:8,tipJoint:"top left",target:null,targetJoint:null,cache:!0,ajax:!1,ajaxMethod:"GET",ajaxErrorMessage:"There was a problem downloading the content.",group:null,style:null,background:"#fff18f",backgroundGradientHorizontal:!1,closeButtonOffset:[5,5],closeButtonRadius:7,closeButtonCrossSize:4,closeButtonCrossColor:"#d2c35b",closeButtonCrossLineWidth:1.5,closeButtonLinkOverscan:6,borderRadius:5,borderWidth:1,borderColor:"#f2e37b",shadow:!0,shadowBlur:10,shadowOffset:[3,3],shadowColor:"rgba(0, 0, 0, 0.1)"},glass:{"extends":"standard",className:"glass",background:[[0,"rgba(252, 252, 252, 0.8)"],[.5,"rgba(255, 255, 255, 0.8)"],[.5,"rgba(250, 250, 250, 0.9)"],[1,"rgba(245, 245, 245, 0.9)"]],borderColor:"#eee",closeButtonCrossColor:"rgba(0, 0, 0, 0.2)",borderRadius:15,closeButtonRadius:10,closeButtonOffset:[8,8]},dark:{"extends":"standard",className:"dark",borderRadius:13,borderColor:"#444",closeButtonCrossColor:"rgba(240, 240, 240, 1)",shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffset:[2,2],background:[[0,"rgba(30, 30, 30, 0.7)"],[.5,"rgba(30, 30, 30, 0.8)"],[.5,"rgba(10, 10, 10, 0.8)"],[1,"rgba(10, 10, 10, 0.9)"]]},alert:{"extends":"standard",className:"alert",borderRadius:1,borderColor:"#AE0D11",closeButtonCrossColor:"rgba(255, 255, 255, 1)",shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffset:[2,2],background:[[0,"rgba(203, 15, 19, 0.7)"],[.5,"rgba(203, 15, 19, 0.8)"],[.5,"rgba(189, 14, 18, 0.8)"],[1,"rgba(179, 14, 17, 0.9)"]]}},Opentip.defaultStyle="standard",typeof module!="undefined"&&module!==null?module.exports=Opentip:window.Opentip=Opentip;var __slice=[].slice;(function(t){var e;return t.fn.opentip=function(t,e,i){return new Opentip(this,t,e,i)},e=function(){function e(){}return e.prototype.name="jquery",e.prototype.domReady=function(e){return t(e)},e.prototype.create=function(e){return t(e)},e.prototype.wrap=function(e){if(e=t(e),e.length>1)throw Error("Multiple elements provided.");return e},e.prototype.unwrap=function(e){return t(e)[0]
},e.prototype.tagName=function(t){return this.unwrap(t).tagName},e.prototype.attr=function(){var e,i,o;return i=arguments[0],e=arguments.length>=2?__slice.call(arguments,1):[],(o=t(i)).attr.apply(o,e)},e.prototype.data=function(){var e,i,o;return i=arguments[0],e=arguments.length>=2?__slice.call(arguments,1):[],(o=t(i)).data.apply(o,e)},e.prototype.find=function(e,i){return t(e).find(i).get(0)},e.prototype.findAll=function(e,i){return t(e).find(i)},e.prototype.update=function(e,i,o){return e=t(e),o?e.text(i):e.html(i)},e.prototype.append=function(e,i){return t(e).append(i)},e.prototype.remove=function(e){return t(e).remove()},e.prototype.addClass=function(e,i){return t(e).addClass(i)},e.prototype.removeClass=function(e,i){return t(e).removeClass(i)},e.prototype.css=function(e,i){return t(e).css(i)},e.prototype.dimensions=function(e){return{width:t(e).outerWidth(),height:t(e).outerHeight()}},e.prototype.scrollOffset=function(){return[window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop]},e.prototype.viewportDimensions=function(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}},e.prototype.mousePosition=function(t){return t==null?null:{x:t.pageX,y:t.pageY}},e.prototype.offset=function(e){var i;return i=t(e).offset(),{left:i.left,top:i.top}},e.prototype.observe=function(e,i,o){return t(e).bind(i,o)},e.prototype.stopObserving=function(e,i,o){return t(e).unbind(i,o)},e.prototype.ajax=function(e){var i,o;if(e.url==null)throw Error("No url provided");return t.ajax({url:e.url,type:(i=(o=e.method)!=null?o.toUpperCase():void 0)!=null?i:"GET"}).done(function(t){return typeof e.onSuccess=="function"?e.onSuccess(t):void 0}).fail(function(t){return typeof e.onError=="function"?e.onError("Server responded with status "+t.status):void 0}).always(function(){return typeof e.onComplete=="function"?e.onComplete():void 0})},e.prototype.clone=function(e){return t.extend({},e)},e.prototype.extend=function(){var e,i;return i=arguments[0],e=arguments.length>=2?__slice.call(arguments,1):[],t.extend.apply(t,[i].concat(__slice.call(e)))},e}(),Opentip.addAdapter(new e)})(jQuery)
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhcm9uLm1pbi5qcyIsImpxdWVyeS5mYW5jeWJveC5wYWNrLmpzIiwib3BlbnRpcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcFZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdnBCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbnBhZ2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIhZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgZnVuY3Rpb24gYyhiLCBjLCBkKSB7XHJcbiAgICAgICAgYi5fZXZlbnRIYW5kbGVycyA9IGIuX2V2ZW50SGFuZGxlcnMgfHwgW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBiLnNjcm9sbGVyLCBoYW5kbGVyOiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIuc2Nyb2xsKGEpXHJcbiAgICAgICAgICAgICAgICB9LCB0eXBlOiBcInNjcm9sbFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGIuc2Nyb2xsZXIsIGhhbmRsZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBiLnVwZGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9LCB0eXBlOiBcImtleXVwXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudDogYi5iYXIsIGhhbmRsZXI6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5wcmV2ZW50RGVmYXVsdCgpLCBiLnNlbGVjdGlvbigpLCBiLmRyYWcubm93ID0gMVxyXG4gICAgICAgICAgICAgICAgfSwgdHlwZTogXCJ0b3VjaHN0YXJ0IG1vdXNlZG93blwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LCBoYW5kbGVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5zZWxlY3Rpb24oMSksIGIuZHJhZy5ub3cgPSAwXHJcbiAgICAgICAgICAgICAgICB9LCB0eXBlOiBcIm1vdXNldXAgYmx1ciB0b3VjaGVuZFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LCBoYW5kbGVyOiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIDIgIT0gYS5idXR0b24gJiYgYi5fcG9zMChhKVxyXG4gICAgICAgICAgICAgICAgfSwgdHlwZTogXCJ0b3VjaHN0YXJ0IG1vdXNlZG93blwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LCBoYW5kbGVyOiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIuZHJhZy5ub3cgJiYgYi5kcmFnKGEpXHJcbiAgICAgICAgICAgICAgICB9LCB0eXBlOiBcIm1vdXNlbW92ZSB0b3VjaG1vdmVcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBhLCBoYW5kbGVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYi51cGRhdGUoKVxyXG4gICAgICAgICAgICAgICAgfSwgdHlwZTogXCJyZXNpemVcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBiLnJvb3QsIGhhbmRsZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBiLnVwZGF0ZSgpXHJcbiAgICAgICAgICAgICAgICB9LCB0eXBlOiBcInNpemVDaGFuZ2VcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSwgbChiLl9ldmVudEhhbmRsZXJzLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICBhLmVsZW1lbnQgJiYgYyhhLmVsZW1lbnQsIGEudHlwZSwgYS5oYW5kbGVyLCBkKVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZChhLCBiLCBjKSB7XHJcbiAgICAgICAgdmFyIGQgPSBcImRhdGEtYmFyb24tXCIgKyBiO1xyXG4gICAgICAgIGlmIChcIm9uXCIgPT0gYykgYS5zZXRBdHRyaWJ1dGUoZCwgXCJpbml0ZWRcIik7IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoXCJvZmZcIiAhPSBjKSByZXR1cm4gYS5nZXRBdHRyaWJ1dGUoZCk7XHJcbiAgICAgICAgICAgIGEucmVtb3ZlQXR0cmlidXRlKGQpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGUoYSkge1xyXG4gICAgICAgIGlmIChkKGEucm9vdCwgYS5kaXJlY3Rpb24pKSB0aHJvdyBuZXcgRXJyb3IoXCJTZWNvbmQgYmFyb24gaW5pdGlhbGl6YXRpb25cIik7XHJcbiAgICAgICAgdmFyIGIgPSBuZXcgbi5wcm90b3R5cGUuY29uc3RydWN0b3IoYSk7XHJcbiAgICAgICAgcmV0dXJuIGMoYiwgYS5ldmVudCwgXCJvblwiKSwgZChiLnJvb3QsIGEuZGlyZWN0aW9uLCBcIm9uXCIpLCBiLnVwZGF0ZSh7IGluaXRNb2RlOiAhMCB9KSwgYlxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGYoYSkge1xyXG4gICAgICAgIHZhciBiID0ge307XHJcbiAgICAgICAgYSA9IGEgfHwge307XHJcbiAgICAgICAgZm9yICh2YXIgYyBpbiBhKSBhLmhhc093blByb3BlcnR5KGMpICYmIChiW2NdID0gYVtjXSk7XHJcbiAgICAgICAgcmV0dXJuIGJcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnKGEpIHtcclxuICAgICAgICB2YXIgYiA9IGYoYSk7XHJcbiAgICAgICAgYi5kaXJlY3Rpb24gPSBiLmRpcmVjdGlvbiB8fCBcInZcIjtcclxuICAgICAgICB2YXIgYyA9IGEuZXZlbnQgfHwgZnVuY3Rpb24gKGEsIGMsIGQsIGUpIHtcclxuICAgICAgICAgICAgYi4kKGEpW2UgfHwgXCJvblwiXShjLCBkKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIGIuZXZlbnQgPSBmdW5jdGlvbiAoYSwgYiwgZCwgZSkge1xyXG4gICAgICAgICAgICBsKGEsIGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICBjKGEsIGIsIGQsIGUpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgYlxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGgoYSkge1xyXG4gICAgICAgIGlmICh0aGlzLmV2ZW50cyAmJiB0aGlzLmV2ZW50c1thXSkgZm9yICh2YXIgYiA9IDA7IGIgPCB0aGlzLmV2ZW50c1thXS5sZW5ndGg7IGIrKykge1xyXG4gICAgICAgICAgICB2YXIgYyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzW2FdW2JdLmFwcGx5KHRoaXMsIGMpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChhKSB7XHJcbiAgICAgICAgdmFyIGkgPSBtLCBqID0gW1wibGVmdFwiLCBcInRvcFwiLCBcInJpZ2h0XCIsIFwiYm90dG9tXCIsIFwid2lkdGhcIiwgXCJoZWlnaHRcIl0sIGsgPSB7IHY6IHsgeDogXCJZXCIsIHBvczogalsxXSwgb3Bwb3M6IGpbM10sIGNyb3NzUG9zOiBqWzBdLCBjcm9zc09wUG9zOiBqWzJdLCBzaXplOiBqWzVdLCBjcm9zc1NpemU6IGpbNF0sIGNsaWVudDogXCJjbGllbnRIZWlnaHRcIiwgY3Jvc3NDbGllbnQ6IFwiY2xpZW50V2lkdGhcIiwgY3Jvc3NTY3JvbGw6IFwic2Nyb2xsV2lkdGhcIiwgb2Zmc2V0OiBcIm9mZnNldEhlaWdodFwiLCBjcm9zc09mZnNldDogXCJvZmZzZXRXaWR0aFwiLCBvZmZzZXRQb3M6IFwib2Zmc2V0VG9wXCIsIHNjcm9sbDogXCJzY3JvbGxUb3BcIiwgc2Nyb2xsU2l6ZTogXCJzY3JvbGxIZWlnaHRcIiB9LCBoOiB7IHg6IFwiWFwiLCBwb3M6IGpbMF0sIG9wcG9zOiBqWzJdLCBjcm9zc1BvczogalsxXSwgY3Jvc3NPcFBvczogalszXSwgc2l6ZTogals0XSwgY3Jvc3NTaXplOiBqWzVdLCBjbGllbnQ6IFwiY2xpZW50V2lkdGhcIiwgY3Jvc3NDbGllbnQ6IFwiY2xpZW50SGVpZ2h0XCIsIGNyb3NzU2Nyb2xsOiBcInNjcm9sbEhlaWdodFwiLCBvZmZzZXQ6IFwib2Zmc2V0V2lkdGhcIiwgY3Jvc3NPZmZzZXQ6IFwib2Zmc2V0SGVpZ2h0XCIsIG9mZnNldFBvczogXCJvZmZzZXRMZWZ0XCIsIHNjcm9sbDogXCJzY3JvbGxMZWZ0XCIsIHNjcm9sbFNpemU6IFwic2Nyb2xsV2lkdGhcIiB9IH0sIGwgPSBmdW5jdGlvbiAoYywgZCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IDA7XHJcbiAgICAgICAgICAgIGZvciAoKGMubGVuZ3RoID09PSBiIHx8IGMgPT09IGEpICYmIChjID0gW2NdKSA7IGNbZV07KSBkLmNhbGwodGhpcywgY1tlXSwgZSksIGUrK1xyXG4gICAgICAgIH0sIG0gPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICB2YXIgYywgZCwgZTtcclxuICAgICAgICAgICAgcmV0dXJuIGIgPSBiIHx8IHt9LCBlID0gYi4kIHx8IGEualF1ZXJ5LCBjID0gdGhpcyBpbnN0YW5jZW9mIGUsIGMgPyBiLnJvb3QgPSBkID0gdGhpcyA6IGQgPSBlKGIucm9vdCB8fCBiLnNjcm9sbGVyKSwgbmV3IG0uZm4uY29uc3RydWN0b3IoZCwgYiwgZSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIG0uZm4gPSB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yOiBmdW5jdGlvbiAoYSwgYiwgYykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBnKGIpO1xyXG4gICAgICAgICAgICAgICAgZC4kID0gYywgbC5jYWxsKHRoaXMsIGEsIGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBmKGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGQucm9vdCAmJiBkLnNjcm9sbGVyID8gKGMuc2Nyb2xsZXIgPSBkLiQoZC5zY3JvbGxlciwgYSksIGMuc2Nyb2xsZXIubGVuZ3RoIHx8IChjLnNjcm9sbGVyID0gYSkpIDogYy5zY3JvbGxlciA9IGEsIGMucm9vdCA9IGEsIHRoaXNbYl0gPSBlKGMpLCB0aGlzLmxlbmd0aCA9IGIgKyAxXHJcbiAgICAgICAgICAgICAgICB9KSwgdGhpcy5wYXJhbXMgPSBkXHJcbiAgICAgICAgICAgIH0sIGRpc3Bvc2U6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gdGhpcy5wYXJhbXM7XHJcbiAgICAgICAgICAgICAgICBsKHRoaXMsIGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5kaXNwb3NlKGEpXHJcbiAgICAgICAgICAgICAgICB9KSwgdGhpcy5wYXJhbXMgPSBudWxsXHJcbiAgICAgICAgICAgIH0sIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IHRoaXNbYV07KSB0aGlzW2FdLnVwZGF0ZS5hcHBseSh0aGlzW2FdLCBhcmd1bWVudHMpLCBhKytcclxuICAgICAgICAgICAgfSwgYmFyb246IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYS5yb290ID0gW10sIGEuc2Nyb2xsZXIgPSB0aGlzLnBhcmFtcy5zY3JvbGxlciwgbC5jYWxsKHRoaXMsIHRoaXMsIGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5yb290LnB1c2goYi5yb290KVxyXG4gICAgICAgICAgICAgICAgfSksIGEuZGlyZWN0aW9uID0gXCJ2XCIgPT0gdGhpcy5wYXJhbXMuZGlyZWN0aW9uID8gXCJoXCIgOiBcInZcIiwgYS5fY2hhaW4gPSAhMCwgbShhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgbiA9IHt9O1xyXG4gICAgICAgIG4ucHJvdG90eXBlID0ge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcjogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGMoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsKGEsIGIpWzBdXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLmJhck1pblNpemUgfHwgMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgYSA+IDAgJiYgYiA+IGEgJiYgKGEgPSBiKSwgdGhpcy5iYXIgJiYgbCh0aGlzLmJhcikuY3NzKHRoaXMub3JpZ2luLnNpemUsIHBhcnNlSW50KGEsIDEwKSArIFwicHhcIilcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBlKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJhciAmJiBsKHRoaXMuYmFyKS5jc3ModGhpcy5vcmlnaW4ucG9zLCArYSArIFwicHhcIilcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBmKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvW3RoaXMub3JpZ2luLmNsaWVudF0gLSB0aGlzLmJhclRvcExpbWl0IC0gdGhpcy5iYXJbdGhpcy5vcmlnaW4ub2Zmc2V0XVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGcoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhICogZi5jYWxsKHRoaXMpICsgdGhpcy5iYXJUb3BMaW1pdFxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGkoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoYSAtIHRoaXMuYmFyVG9wTGltaXQpIC8gZi5jYWxsKHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaigpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gITFcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbCwgbSwgbiwgbywgcCwgcSwgciwgcywgdCwgdSwgdjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1ID0gdCA9IChuZXcgRGF0ZSkuZ2V0VGltZSgpLCBsID0gdGhpcy4kID0gYS4kLCB0aGlzLmV2ZW50ID0gYS5ldmVudCwgdGhpcy5ldmVudHMgPSB7fSwgdGhpcy5yb290ID0gYS5yb290LCB0aGlzLnNjcm9sbGVyID0gYyhhLnNjcm9sbGVyKSwgdGhpcy5iYXIgPSBjKGEuYmFyLCB0aGlzLnJvb3QpLCBvID0gdGhpcy50cmFjayA9IGMoYS50cmFjaywgdGhpcy5yb290KSwgIXRoaXMudHJhY2sgJiYgdGhpcy5iYXIgJiYgKG8gPSB0aGlzLmJhci5wYXJlbnROb2RlKSwgdGhpcy5jbGlwcGVyID0gdGhpcy5zY3JvbGxlci5wYXJlbnROb2RlLCB0aGlzLmRpcmVjdGlvbiA9IGEuZGlyZWN0aW9uLCB0aGlzLm9yaWdpbiA9IGtbdGhpcy5kaXJlY3Rpb25dLCB0aGlzLmJhck9uQ2xzID0gYS5iYXJPbkNscywgdGhpcy5zY3JvbGxpbmdDbHMgPSBhLnNjcm9sbGluZ0NscywgdGhpcy5iYXJUb3BMaW1pdCA9IDAsIHMgPSAxZTMgKiBhLnBhdXNlIHx8IDAsIHRoaXMuY3Vyc29yID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYVtcImNsaWVudFwiICsgdGhpcy5vcmlnaW4ueF0gfHwgKCgoYS5vcmlnaW5hbEV2ZW50IHx8IGEpLnRvdWNoZXMgfHwge30pWzBdIHx8IHt9KVtcInBhZ2VcIiArIHRoaXMub3JpZ2luLnhdXHJcbiAgICAgICAgICAgICAgICB9LCB0aGlzLnBvcyA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBcInBhZ2VcIiArIHRoaXMub3JpZ2luLnggKyBcIk9mZnNldFwiLCBkID0gdGhpcy5zY3JvbGxlcltjXSA/IGMgOiB0aGlzLm9yaWdpbi5zY3JvbGw7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgIT09IGIgJiYgKHRoaXMuc2Nyb2xsZXJbZF0gPSBhKSwgdGhpcy5zY3JvbGxlcltkXVxyXG4gICAgICAgICAgICAgICAgfSwgdGhpcy5ycG9zID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYiwgYyA9IHRoaXMuc2Nyb2xsZXJbdGhpcy5vcmlnaW4uc2Nyb2xsU2l6ZV0gLSB0aGlzLnNjcm9sbGVyW3RoaXMub3JpZ2luLmNsaWVudF07XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIgPSBhID8gdGhpcy5wb3MoYSAqIGMpIDogdGhpcy5wb3MoKSwgYiAvIChjIHx8IDEpXHJcbiAgICAgICAgICAgICAgICB9LCB0aGlzLmJhck9uID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJhck9uQ2xzICYmIChhIHx8IHRoaXMuc2Nyb2xsZXJbdGhpcy5vcmlnaW4uY2xpZW50XSA+PSB0aGlzLnNjcm9sbGVyW3RoaXMub3JpZ2luLnNjcm9sbFNpemVdID8gbCh0aGlzLnJvb3QpLnJlbW92ZUNsYXNzKHRoaXMuYmFyT25DbHMpIDogbCh0aGlzLnJvb3QpLmFkZENsYXNzKHRoaXMuYmFyT25DbHMpKVxyXG4gICAgICAgICAgICAgICAgfSwgdGhpcy5fcG9zMCA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHRoaXMuY3Vyc29yKGEpIC0gbVxyXG4gICAgICAgICAgICAgICAgfSwgdGhpcy5kcmFnID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyW3RoaXMub3JpZ2luLnNjcm9sbF0gPSBpLmNhbGwodGhpcywgdGhpcy5jdXJzb3IoYSkgLSBuKSAqICh0aGlzLnNjcm9sbGVyW3RoaXMub3JpZ2luLnNjcm9sbFNpemVdIC0gdGhpcy5zY3JvbGxlclt0aGlzLm9yaWdpbi5jbGllbnRdKVxyXG4gICAgICAgICAgICAgICAgfSwgdGhpcy5zZWxlY3Rpb24gPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXZlbnQoZG9jdW1lbnQsIFwic2VsZWN0cG9zIHNlbGVjdHN0YXJ0XCIsIGosIGEgPyBcIm9mZlwiIDogXCJvblwiKVxyXG4gICAgICAgICAgICAgICAgfSwgdGhpcy5yZXNpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIsIGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMuYmFyT24oKSwgZCA9IGMuc2Nyb2xsZXJbYy5vcmlnaW4uY3Jvc3NDbGllbnRdLCBiID0gYy5zY3JvbGxlcltjLm9yaWdpbi5jcm9zc09mZnNldF0gLSBkLCBhLmZyZWV6ZSAmJiAhYy5jbGlwcGVyLnN0eWxlW2Mub3JpZ2luLmNyb3NzU2l6ZV0gJiYgbChjLmNsaXBwZXIpLmNzcyhjLm9yaWdpbi5jcm9zc1NpemUsIGMuY2xpcHBlcltjLm9yaWdpbi5jcm9zc0NsaWVudF0gLSBiICsgXCJweFwiKSwgbChjLnNjcm9sbGVyKS5jc3MoYy5vcmlnaW4uY3Jvc3NTaXplLCBjLmNsaXBwZXJbYy5vcmlnaW4uY3Jvc3NDbGllbnRdICsgYiArIFwicHhcIiksIEFycmF5LnByb3RvdHlwZS51bnNoaWZ0LmNhbGwoYXJndW1lbnRzLCBcInJlc2l6ZVwiKSwgaC5hcHBseShjLCBhcmd1bWVudHMpLCB1ID0gKG5ldyBEYXRlKS5nZXRUaW1lKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gdGhpcywgZCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgKG5ldyBEYXRlKS5nZXRUaW1lKCkgLSB1IDwgcyAmJiAoY2xlYXJUaW1lb3V0KHApLCBkID0gcyksIGQgPyBwID0gc2V0VGltZW91dChiLCBkKSA6IGIoKVxyXG4gICAgICAgICAgICAgICAgfSwgdGhpcy51cGRhdGVQb3NpdGlvbnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEsIGIgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuYmFyICYmIChhID0gKG9bYi5vcmlnaW4uY2xpZW50XSAtIGIuYmFyVG9wTGltaXQpICogYi5zY3JvbGxlcltiLm9yaWdpbi5jbGllbnRdIC8gYi5zY3JvbGxlcltiLm9yaWdpbi5zY3JvbGxTaXplXSwgcGFyc2VJbnQodiwgMTApICE9IHBhcnNlSW50KGEsIDEwKSAmJiAoZC5jYWxsKGIsIGEpLCB2ID0gYSksIG0gPSBnLmNhbGwoYiwgYi5ycG9zKCkpLCBlLmNhbGwoYiwgbSkpLCBBcnJheS5wcm90b3R5cGUudW5zaGlmdC5jYWxsKGFyZ3VtZW50cywgXCJzY3JvbGxcIiksIGguYXBwbHkoYiwgYXJndW1lbnRzKSwgdCA9IChuZXcgRGF0ZSkuZ2V0VGltZSgpXHJcbiAgICAgICAgICAgICAgICB9LCB0aGlzLnNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IDAsIGMgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgIChuZXcgRGF0ZSkuZ2V0VGltZSgpIC0gdCA8IHMgJiYgKGNsZWFyVGltZW91dChxKSwgYSA9IHMpLCAobmV3IERhdGUpLmdldFRpbWUoKSAtIHQgPCBzICYmIChjbGVhclRpbWVvdXQocSksIGEgPSBzKSwgYSA/IHEgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYy51cGRhdGVQb3NpdGlvbnMoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGEpIDogYy51cGRhdGVQb3NpdGlvbnMoKSwgYy5zY3JvbGxpbmdDbHMgJiYgKHIgfHwgdGhpcy4kKHRoaXMuc2Nyb2xsZXIpLmFkZENsYXNzKHRoaXMuc2Nyb2xsaW5nQ2xzKSwgY2xlYXJUaW1lb3V0KHIpLCByID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMuJChjLnNjcm9sbGVyKS5yZW1vdmVDbGFzcyhjLnNjcm9sbGluZ0NscyksIHIgPSBiXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMzAwKSlcclxuICAgICAgICAgICAgICAgIH0sIHRoaXNcclxuICAgICAgICAgICAgfSwgdXBkYXRlOiBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGguY2FsbCh0aGlzLCBcInVwZFwiLCBhKSwgdGhpcy5yZXNpemUoMSksIHRoaXMudXBkYXRlUG9zaXRpb25zKCksIHRoaXNcclxuICAgICAgICAgICAgfSwgZGlzcG9zZTogZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIGModGhpcywgdGhpcy5ldmVudCwgXCJvZmZcIiksIGQodGhpcy5yb290LCBhLmRpcmVjdGlvbiwgXCJvZmZcIiksICQodGhpcy5zY3JvbGxlcikuY3NzKHRoaXMub3JpZ2luLmNyb3NzU2l6ZSwgXCJcIiksIHRoaXMuYmFyT24oITApLCBoLmNhbGwodGhpcywgXCJkaXNwb3NlXCIpXHJcbiAgICAgICAgICAgIH0sIG9uOiBmdW5jdGlvbiAoYSwgYiwgYykge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IGEuc3BsaXQoXCIgXCIpLCBlID0gMDsgZSA8IGQubGVuZ3RoOyBlKyspIFwiaW5pdFwiID09IGRbZV0gPyBiLmNhbGwodGhpcywgYykgOiAodGhpcy5ldmVudHNbZFtlXV0gPSB0aGlzLmV2ZW50c1tkW2VdXSB8fCBbXSwgdGhpcy5ldmVudHNbZFtlXV0ucHVzaChmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGIuY2FsbCh0aGlzLCBhIHx8IGMpXHJcbiAgICAgICAgICAgICAgICB9KSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIG0uZm4uY29uc3RydWN0b3IucHJvdG90eXBlID0gbS5mbiwgbi5wcm90b3R5cGUuY29uc3RydWN0b3IucHJvdG90eXBlID0gbi5wcm90b3R5cGUsIG0ubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGEuYmFyb24gPSBpLCBtXHJcbiAgICAgICAgfSwgbS52ZXJzaW9uID0gXCIwLjcuN1wiLCAkICYmICQuZm4gJiYgKCQuZm4uYmFyb24gPSBtKSwgYS5iYXJvbiA9IG0sIGEubW9kdWxlICYmIG1vZHVsZS5leHBvcnRzICYmIChtb2R1bGUuZXhwb3J0cyA9IG0ubm9Db25mbGljdCgpKVxyXG4gICAgfVxyXG59KHdpbmRvdyksIGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICB2YXIgYyA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gYyhhLCBjLCBkKSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gMSA9PSBkID8gXCJwb3NcIiA6IFwib3Bwb3NcIjtcclxuICAgICAgICAgICAgZyA8IChoLm1pblZpZXcgfHwgMCkgJiYgKGMgPSBiKSwgdGhpcy4kKGZbYV0pLmNzcyh0aGlzLm9yaWdpbi5wb3MsIFwiXCIpLmNzcyh0aGlzLm9yaWdpbi5vcHBvcywgXCJcIikucmVtb3ZlQ2xhc3MoaC5vdXRzaWRlKSwgYyAhPT0gYiAmJiAoYyArPSBcInB4XCIsIHRoaXMuJChmW2FdKS5jc3ModGhpcy5vcmlnaW5bZV0sIGMpLmFkZENsYXNzKGgub3V0c2lkZSkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkKGEpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGkgPSBkb2N1bWVudC5jcmVhdGVFdmVudChcIldoZWVsRXZlbnRcIiksIGkuaW5pdFdlYktpdFdoZWVsRXZlbnQoYS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGFYLCBhLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YVkpLCBtLmRpc3BhdGNoRXZlbnQoaSksIGEucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgICAgICB9IGNhdGNoIChhKSB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGUoYSkge1xyXG4gICAgICAgICAgICB2YXIgYjtcclxuICAgICAgICAgICAgZm9yICh2YXIgYyBpbiBhKSBoW2NdID0gYVtjXTtcclxuICAgICAgICAgICAgaWYgKGYgPSB0aGlzLiQoaC5lbGVtZW50cywgdGhpcy5zY3JvbGxlcikpIHtcclxuICAgICAgICAgICAgICAgIGcgPSB0aGlzLnNjcm9sbGVyW3RoaXMub3JpZ2luLmNsaWVudF07XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IGYubGVuZ3RoOyBlKyspIGIgPSB7fSwgYlt0aGlzLm9yaWdpbi5zaXplXSA9IGZbZV1bdGhpcy5vcmlnaW4ub2Zmc2V0XSwgZltlXS5wYXJlbnROb2RlICE9PSB0aGlzLnNjcm9sbGVyICYmIHRoaXMuJChmW2VdLnBhcmVudE5vZGUpLmNzcyhiKSwgYiA9IHt9LCBiW3RoaXMub3JpZ2luLmNyb3NzU2l6ZV0gPSBmW2VdLnBhcmVudE5vZGVbdGhpcy5vcmlnaW4uY3Jvc3NDbGllbnRdLCB0aGlzLiQoZltlXSkuY3NzKGIpLCBnIC09IGZbZV1bdGhpcy5vcmlnaW4ub2Zmc2V0XSwgbFtlXSA9IGZbZV0ucGFyZW50Tm9kZVt0aGlzLm9yaWdpbi5vZmZzZXRQb3NdLCBqW2VdID0galtlIC0gMV0gfHwgMCwga1tlXSA9IGtbZSAtIDFdIHx8IE1hdGgubWluKGxbZV0sIDApLCBmW2UgLSAxXSAmJiAoaltlXSArPSBmW2UgLSAxXVt0aGlzLm9yaWdpbi5vZmZzZXRdLCBrW2VdICs9IGZbZSAtIDFdW3RoaXMub3JpZ2luLm9mZnNldF0pLCAoMCAhPSBlIHx8IDAgIT0gbFtlXSkgJiYgKHRoaXMuZXZlbnQoZltlXSwgXCJtb3VzZXdoZWVsXCIsIGQsIFwib2ZmXCIpLCB0aGlzLmV2ZW50KGZbZV0sIFwibW91c2V3aGVlbFwiLCBkKSk7XHJcbiAgICAgICAgICAgICAgICBoLmxpbWl0ZXIgJiYgZlswXSAmJiAodGhpcy50cmFjayAmJiB0aGlzLnRyYWNrICE9IHRoaXMuc2Nyb2xsZXIgPyAoYiA9IHt9LCBiW3RoaXMub3JpZ2luLnBvc10gPSBmWzBdLnBhcmVudE5vZGVbdGhpcy5vcmlnaW4ub2Zmc2V0XSwgdGhpcy4kKHRoaXMudHJhY2spLmNzcyhiKSkgOiB0aGlzLmJhclRvcExpbWl0ID0gZlswXS5wYXJlbnROb2RlW3RoaXMub3JpZ2luLm9mZnNldF0sIHRoaXMuc2Nyb2xsKCkpLCBoLmxpbWl0ZXIgPT09ICExICYmICh0aGlzLmJhclRvcExpbWl0ID0gMClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgaSA9IHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGYsIGhhbmRsZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhLCBiID0gbyh0aGlzKVswXS5wYXJlbnROb2RlLCBjID0gYi5vZmZzZXRUb3AsIGQgPSAwOyBkIDwgZi5sZW5ndGg7IGQrKykgZltkXSA9PT0gdGhpcyAmJiAoYSA9IGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gYyAtIGpbYV07XHJcbiAgICAgICAgICAgICAgICAgICAgaC5zY3JvbGwgPyBoLnNjcm9sbCh7IHgxOiBwLnNjcm9sbGVyLnNjcm9sbFRvcCwgeDI6IGUgfSkgOiBwLnNjcm9sbGVyLnNjcm9sbFRvcCA9IGVcclxuICAgICAgICAgICAgICAgIH0sIHR5cGU6IFwiY2xpY2tcIlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBoLmNsaWNrYWJsZSAmJiAodGhpcy5fZXZlbnRIYW5kbGVycy5wdXNoKGkpLCBuKGkuZWxlbWVudCwgaS50eXBlLCBpLmhhbmRsZXIsIFwib25cIikpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZiwgZywgaCA9IHsgb3V0c2lkZTogXCJcIiwgaW5zaWRlOiBcIlwiLCBiZWZvcmU6IFwiXCIsIGFmdGVyOiBcIlwiLCBwYXN0OiBcIlwiLCBmdXR1cmU6IFwiXCIsIHJhZGl1czogMCwgbWluVmlldzogMCB9LCBqID0gW10sIGsgPSBbXSwgbCA9IFtdLCBtID0gdGhpcy5zY3JvbGxlciwgbiA9IHRoaXMuZXZlbnQsIG8gPSB0aGlzLiQsIHAgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMub24oXCJpbml0XCIsIGUsIGEpO1xyXG4gICAgICAgIHZhciBxID0gW10sIHIgPSBbXTtcclxuICAgICAgICB0aGlzLm9uKFwiaW5pdCBzY3JvbGxcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYSwgZCwgZTtcclxuICAgICAgICAgICAgaWYgKGYpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGksIG0gPSAwOyBtIDwgZi5sZW5ndGg7IG0rKykgYSA9IDAsIGxbbV0gLSB0aGlzLnBvcygpIDwga1ttXSArIGgucmFkaXVzID8gKGEgPSAxLCBkID0galttXSkgOiBsW21dIC0gdGhpcy5wb3MoKSA+IGtbbV0gKyBnIC0gaC5yYWRpdXMgPyAoYSA9IDIsIGQgPSB0aGlzLnNjcm9sbGVyW3RoaXMub3JpZ2luLmNsaWVudF0gLSBmW21dW3RoaXMub3JpZ2luLm9mZnNldF0gLSBqW21dIC0gZykgOiAoYSA9IDMsIGQgPSBiKSwgZSA9ICExLCAobFttXSAtIHRoaXMucG9zKCkgPCBrW21dIHx8IGxbbV0gLSB0aGlzLnBvcygpID4ga1ttXSArIGcpICYmIChlID0gITApLCAoYSAhPSBxW21dIHx8IGUgIT0gclttXSkgJiYgKGMuY2FsbCh0aGlzLCBtLCBkLCBhKSwgcVttXSA9IGEsIHJbbV0gPSBlLCBpID0gITApO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkpIGZvciAobSA9IDA7IG0gPCBmLmxlbmd0aDsgbSsrKSAxID09IHFbbV0gJiYgaC5wYXN0ICYmIHRoaXMuJChmW21dKS5hZGRDbGFzcyhoLnBhc3QpLnJlbW92ZUNsYXNzKGguZnV0dXJlKSwgMiA9PSBxW21dICYmIGguZnV0dXJlICYmIHRoaXMuJChmW21dKS5hZGRDbGFzcyhoLmZ1dHVyZSkucmVtb3ZlQ2xhc3MoaC5wYXN0KSwgMyA9PSBxW21dID8gKChoLmZ1dHVyZSB8fCBoLnBhc3QpICYmIHRoaXMuJChmW21dKS5yZW1vdmVDbGFzcyhoLnBhc3QpLnJlbW92ZUNsYXNzKGguZnV0dXJlKSwgaC5pbnNpZGUgJiYgdGhpcy4kKGZbbV0pLmFkZENsYXNzKGguaW5zaWRlKSkgOiBoLmluc2lkZSAmJiB0aGlzLiQoZlttXSkucmVtb3ZlQ2xhc3MoaC5pbnNpZGUpLCBxW21dICE9IHFbbSArIDFdICYmIDEgPT0gcVttXSAmJiBoLmJlZm9yZSA/IHRoaXMuJChmW21dKS5hZGRDbGFzcyhoLmJlZm9yZSkucmVtb3ZlQ2xhc3MoaC5hZnRlcikgOiBxW21dICE9IHFbbSAtIDFdICYmIDIgPT0gcVttXSAmJiBoLmFmdGVyID8gdGhpcy4kKGZbbV0pLmFkZENsYXNzKGguYWZ0ZXIpLnJlbW92ZUNsYXNzKGguYmVmb3JlKSA6IHRoaXMuJChmW21dKS5yZW1vdmVDbGFzcyhoLmJlZm9yZSkucmVtb3ZlQ2xhc3MoaC5hZnRlciksIGguZ3JhZCAmJiAoclttXSA/IHRoaXMuJChmW21dKS5hZGRDbGFzcyhoLmdyYWQpIDogdGhpcy4kKGZbbV0pLnJlbW92ZUNsYXNzKGguZ3JhZCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSwgdGhpcy5vbihcInJlc2l6ZSB1cGRcIiwgZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgZS5jYWxsKHRoaXMsIGEgJiYgYS5maXgpXHJcbiAgICAgICAgfSlcclxuICAgIH07XHJcbiAgICBiYXJvbi5mbi5maXggPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIGZvciAodmFyIGIgPSAwOyB0aGlzW2JdOykgYy5jYWxsKHRoaXNbYl0sIGEpLCBiKys7XHJcbiAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgIH1cclxufSh3aW5kb3cpLCBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgdmFyIGIsIGMsIGQsIGUsIGYsIGcgPSB0aGlzO1xyXG4gICAgICAgIGUgPSBhLnNjcmVlbiB8fCAuOSwgYS5mb3J3YXJkICYmIChiID0gdGhpcy4kKGEuZm9yd2FyZCwgdGhpcy5jbGlwcGVyKSwgZiA9IHtcclxuICAgICAgICAgICAgZWxlbWVudDogYiwgaGFuZGxlcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGIgPSBnLnBvcygpIC0gYS5kZWx0YSB8fCAzMDtcclxuICAgICAgICAgICAgICAgIGcucG9zKGIpXHJcbiAgICAgICAgICAgIH0sIHR5cGU6IFwiY2xpY2tcIlxyXG4gICAgICAgIH0sIHRoaXMuX2V2ZW50SGFuZGxlcnMucHVzaChmKSwgdGhpcy5ldmVudChmLmVsZW1lbnQsIGYudHlwZSwgZi5oYW5kbGVyLCBcIm9uXCIpKSwgYS5iYWNrd2FyZCAmJiAoYyA9IHRoaXMuJChhLmJhY2t3YXJkLCB0aGlzLmNsaXBwZXIpLCBmID0ge1xyXG4gICAgICAgICAgICBlbGVtZW50OiBjLCBoYW5kbGVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGcucG9zKCkgKyBhLmRlbHRhIHx8IDMwO1xyXG4gICAgICAgICAgICAgICAgZy5wb3MoYilcclxuICAgICAgICAgICAgfSwgdHlwZTogXCJjbGlja1wiXHJcbiAgICAgICAgfSwgdGhpcy5fZXZlbnRIYW5kbGVycy5wdXNoKGYpLCB0aGlzLmV2ZW50KGYuZWxlbWVudCwgZi50eXBlLCBmLmhhbmRsZXIsIFwib25cIikpLCBhLnRyYWNrICYmIChkID0gYS50cmFjayA9PT0gITAgPyB0aGlzLnRyYWNrIDogdGhpcy4kKGEudHJhY2ssIHRoaXMuY2xpcHBlcilbMF0sIGQgJiYgKGYgPSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQ6IGQsIGhhbmRsZXI6IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGFbXCJvZmZzZXRcIiArIGcub3JpZ2luLnhdLCBjID0gZy5iYXJbZy5vcmlnaW4ub2Zmc2V0UG9zXSwgZCA9IDA7XHJcbiAgICAgICAgICAgICAgICBjID4gYiA/IGQgPSAtMSA6IGIgPiBjICsgZy5iYXJbZy5vcmlnaW4ub2Zmc2V0XSAmJiAoZCA9IDEpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGYgPSBnLnBvcygpICsgZCAqIGUgKiBnLnNjcm9sbGVyW2cub3JpZ2luLmNsaWVudF07XHJcbiAgICAgICAgICAgICAgICBnLnBvcyhmKVxyXG4gICAgICAgICAgICB9LCB0eXBlOiBcIm1vdXNlZG93blwiXHJcbiAgICAgICAgfSwgdGhpcy5fZXZlbnRIYW5kbGVycy5wdXNoKGYpLCB0aGlzLmV2ZW50KGYuZWxlbWVudCwgZi50eXBlLCBmLmhhbmRsZXIsIFwib25cIikpKVxyXG4gICAgfTtcclxuICAgIGJhcm9uLmZuLmNvbnRyb2xzID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICBmb3IgKHZhciBjID0gMDsgdGhpc1tjXTspIGEuY2FsbCh0aGlzW2NdLCBiKSwgYysrO1xyXG4gICAgICAgIHJldHVybiB0aGlzXHJcbiAgICB9XHJcbn0od2luZG93KSwgZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGEgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGIoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByLnNjcm9sbGVyW3Iub3JpZ2luLnNjcm9sbF0gKyByLnNjcm9sbGVyW3Iub3JpZ2luLm9mZnNldF1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByLnNjcm9sbGVyW3Iub3JpZ2luLnNjcm9sbFNpemVdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gci5zY3JvbGxlcltyLm9yaWdpbi5jbGllbnRdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSA1ZS00ICogYTtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoYiAtIGMgKiAoYSArIDU1MCkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBmKGEpIHtcclxuICAgICAgICAgICAgayA9IGEsIGEgPyAoZygpLCBoID0gc2V0SW50ZXJ2YWwoZywgMjAwKSkgOiBjbGVhckludGVydmFsKGgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnKCkge1xyXG4gICAgICAgICAgICB2YXIgZywgaCwgayA9IHt9LCB3ID0gYigpLCB4ID0gYygpLCB5ID0gMSA9PSBzO1xyXG4gICAgICAgICAgICBpZiAoaCA9IDAsIHMgPiAwICYmIChoID0gNDApLCBnID0gZSh1LCBoKSwgdyA+PSB4IC0gdSAmJiBzID4gLTEgPyB5ICYmICh1ICs9IGcpIDogdSA9IDAsIDAgPiB1ICYmICh1ID0gMCksIGtbbV0gPSB1ICsgXCJweFwiLCBkKCkgPD0gYygpKSB7XHJcbiAgICAgICAgICAgICAgICByLiQobCkuY3NzKGspO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IDA7IHogPCBwLmxlbmd0aDsgeisrKSByLiQocFt6XS5zZWxmKS5jc3MocFt6XS5wcm9wZXJ0eSwgTWF0aC5taW4odSAvIG4gKiAxMDAsIDEwMCkgKyBcIiVcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBxICYmIHUgJiYgci4kKHIucm9vdCkuYWRkQ2xhc3MocSksIDAgPT0gdSAmJiBhLm9uQ29sbGFwc2UgJiYgYS5vbkNvbGxhcHNlKCksIHMgPSAwLCBpID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBzID0gLTFcclxuICAgICAgICAgICAgfSwgdiksIG8gJiYgdSA+IG4gJiYgIWogJiYgKG8oKSwgaiA9ICEwKSwgMCA9PSB1ID8gdCsrIDogdCA9IDAsIHQgPiAxICYmIChmKCExKSwgaiA9ICExLCBxICYmIHIuJChyLnJvb3QpLnJlbW92ZUNsYXNzKHEpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGgsIGksIGosIGssIGwgPSB0aGlzLiQoYS5ibG9jayksIG0gPSBhLnNpemUgfHwgdGhpcy5vcmlnaW4uc2l6ZSwgbiA9IGEubGltaXQgfHwgODAsIG8gPSBhLm9uRXhwYW5kLCBwID0gYS5lbGVtZW50cyB8fCBbXSwgcSA9IGEuaW5Qcm9ncmVzcyB8fCBcIlwiLCByID0gdGhpcywgcyA9IDAsIHQgPSAwLCB1ID0gMCwgdiA9IGEud2FpdGluZyB8fCA1MDA7XHJcbiAgICAgICAgdGhpcy5vbihcImluaXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBmKCEwKVxyXG4gICAgICAgIH0pLCB0aGlzLm9uKFwiZGlzcG9zZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGYoITEpXHJcbiAgICAgICAgfSksIHRoaXMuZXZlbnQodGhpcy5zY3JvbGxlciwgXCJtb3VzZXdoZWVsIERPTU1vdXNlU2Nyb2xsXCIsIGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYS53aGVlbERlbHRhIDwgMCB8fCBhLm9yaWdpbmFsRXZlbnQgJiYgYS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGEgPCAwIHx8IGEuZGV0YWlsID4gMDtcclxuICAgICAgICAgICAgZCAmJiAocyA9IDEsIGNsZWFyVGltZW91dChpKSwgIWsgJiYgYigpID49IGMoKSAmJiBmKCEwKSlcclxuICAgICAgICB9KVxyXG4gICAgfTtcclxuICAgIGJhcm9uLmZuLnB1bGwgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgIGZvciAodmFyIGMgPSAwOyB0aGlzW2NdOykgYS5jYWxsKHRoaXNbY10sIGIpLCBjKys7XHJcbiAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgIH1cclxufSh3aW5kb3cpLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgdmFyIGIgPSBhLk11dGF0aW9uT2JzZXJ2ZXIgfHwgYS5XZWJLaXRNdXRhdGlvbk9ic2VydmVyIHx8IGEuTW96TXV0YXRpb25PYnNlcnZlciB8fCBudWxsLCBjID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhID0gdGhpcztcclxuICAgICAgICB0aGlzLl9vYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYS51cGRhdGUoKVxyXG4gICAgICAgIH0pLCB0aGlzLm9uKFwiaW5pdFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGEuX29ic2VydmVyLm9ic2VydmUoYS5yb290LCB7IGNoaWxkTGlzdDogITAsIHN1YnRyZWU6ICEwLCBjaGFyYWN0ZXJEYXRhOiAhMCB9KVxyXG4gICAgICAgIH0pLCB0aGlzLm9uKFwiZGlzcG9zZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGEuX29ic2VydmVyLmRpc3Njb25lY3QoKSwgZGVsZXRlIGEuX29ic2VydmVyXHJcbiAgICAgICAgfSlcclxuICAgIH07XHJcbiAgICBiYXJvbi5mbi5hdXRvVXBkYXRlID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICBpZiAoIWIpIHJldHVybiB0aGlzO1xyXG4gICAgICAgIGZvciAodmFyIGQgPSAwOyB0aGlzW2RdOykgYy5jYWxsKHRoaXNbZF0sIGEpLCBkKys7XHJcbiAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgIH1cclxufSh3aW5kb3cpO1xyXG5cclxuIiwiLyohIGZhbmN5Qm94IHYyLjEuNSBmYW5jeWFwcHMuY29tIHwgZmFuY3lhcHBzLmNvbS9mYW5jeWJveC8jbGljZW5zZSAqL1xyXG4oZnVuY3Rpb24ociwgRywgZiwgdikge1xyXG4gICAgdmFyIEogPSBmKFwiaHRtbFwiKSxcclxuICAgICAgICBuID0gZihyKSxcclxuICAgICAgICBwID0gZihHKSxcclxuICAgICAgICBiID0gZi5mYW5jeWJveCA9IGZ1bmN0aW9uKCkgeyBiLm9wZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSxcclxuICAgICAgICBJID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvbXNpZS9pKSxcclxuICAgICAgICBCID0gbnVsbCxcclxuICAgICAgICBzID0gRy5jcmVhdGVUb3VjaCAhPT0gdixcclxuICAgICAgICB0ID0gZnVuY3Rpb24oYSkgeyByZXR1cm4gYSAmJiBhLmhhc093blByb3BlcnR5ICYmIGEgaW5zdGFuY2VvZiBmOyB9LFxyXG4gICAgICAgIHEgPSBmdW5jdGlvbihhKSB7IHJldHVybiBhICYmIFwic3RyaW5nXCIgPT09IGYudHlwZShhKTsgfSxcclxuICAgICAgICBFID0gZnVuY3Rpb24oYSkgeyByZXR1cm4gcShhKSAmJiAwIDwgYS5pbmRleE9mKFwiJVwiKTsgfSxcclxuICAgICAgICBsID0gZnVuY3Rpb24oYSwgZCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IHBhcnNlSW50KGEsIDEwKSB8fCAwO1xyXG4gICAgICAgICAgICBkICYmIEUoYSkgJiYgKGUgKj0gYi5nZXRWaWV3cG9ydCgpW2RdIC8gMTAwKTtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGguY2VpbChlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHcgPSBmdW5jdGlvbihhLCBiKSB7IHJldHVybiBsKGEsIGIpICsgXCJweFwiOyB9O1xyXG4gICAgZi5leHRlbmQoYiwge1xyXG4gICAgICAgIHZlcnNpb246IFwiMi4xLjVcIixcclxuICAgICAgICBkZWZhdWx0czoge1xyXG4gICAgICAgICAgICBwYWRkaW5nOiAxNSxcclxuICAgICAgICAgICAgbWFyZ2luOiAyMCxcclxuICAgICAgICAgICAgd2lkdGg6IDgwMCxcclxuICAgICAgICAgICAgaGVpZ2h0OiA2MDAsXHJcbiAgICAgICAgICAgIG1pbldpZHRoOiAxMDAsXHJcbiAgICAgICAgICAgIG1pbkhlaWdodDogMTAwLFxyXG4gICAgICAgICAgICBtYXhXaWR0aDogOTk5OSxcclxuICAgICAgICAgICAgbWF4SGVpZ2h0OiA5OTk5LFxyXG4gICAgICAgICAgICBwaXhlbFJhdGlvOiAxLFxyXG4gICAgICAgICAgICBhdXRvU2l6ZTogITAsXHJcbiAgICAgICAgICAgIGF1dG9IZWlnaHQ6ICExLFxyXG4gICAgICAgICAgICBhdXRvV2lkdGg6ICExLFxyXG4gICAgICAgICAgICBhdXRvUmVzaXplOiAhMCxcclxuICAgICAgICAgICAgYXV0b0NlbnRlcjogIXMsXHJcbiAgICAgICAgICAgIGZpdFRvVmlldzogITAsXHJcbiAgICAgICAgICAgIGFzcGVjdFJhdGlvOiAhMSxcclxuICAgICAgICAgICAgdG9wUmF0aW86IDAuNSxcclxuICAgICAgICAgICAgbGVmdFJhdGlvOiAwLjUsXHJcbiAgICAgICAgICAgIHNjcm9sbGluZzogXCJhdXRvXCIsXHJcbiAgICAgICAgICAgIHdyYXBDU1M6IFwiXCIsXHJcbiAgICAgICAgICAgIGFycm93czogITAsXHJcbiAgICAgICAgICAgIGNsb3NlQnRuOiAhMCxcclxuICAgICAgICAgICAgY2xvc2VDbGljazogITEsXHJcbiAgICAgICAgICAgIG5leHRDbGljazogITEsXHJcbiAgICAgICAgICAgIG1vdXNlV2hlZWw6ICEwLFxyXG4gICAgICAgICAgICBhdXRvUGxheTogITEsXHJcbiAgICAgICAgICAgIHBsYXlTcGVlZDogM0UzLFxyXG4gICAgICAgICAgICBwcmVsb2FkOiAzLFxyXG4gICAgICAgICAgICBtb2RhbDogITEsXHJcbiAgICAgICAgICAgIGxvb3A6ICEwLFxyXG4gICAgICAgICAgICBhamF4OiB7IGRhdGFUeXBlOiBcImh0bWxcIiwgaGVhZGVyczogeyBcIlgtZmFuY3lCb3hcIjogITAgfSB9LFxyXG4gICAgICAgICAgICBpZnJhbWU6IHsgc2Nyb2xsaW5nOiBcImF1dG9cIiwgcHJlbG9hZDogITAgfSxcclxuICAgICAgICAgICAgc3dmOiB7IHdtb2RlOiBcInRyYW5zcGFyZW50XCIsIGFsbG93ZnVsbHNjcmVlbjogXCJ0cnVlXCIsIGFsbG93c2NyaXB0YWNjZXNzOiBcImFsd2F5c1wiIH0sXHJcbiAgICAgICAgICAgIGtleXM6IHsgbmV4dDogeyAxMzogXCJsZWZ0XCIsIDM0OiBcInVwXCIsIDM5OiBcImxlZnRcIiwgNDA6IFwidXBcIiB9LCBwcmV2OiB7IDg6IFwicmlnaHRcIiwgMzM6IFwiZG93blwiLCAzNzogXCJyaWdodFwiLCAzODogXCJkb3duXCIgfSwgY2xvc2U6IFsyN10sIHBsYXk6IFszMl0sIHRvZ2dsZTogWzcwXSB9LFxyXG4gICAgICAgICAgICBkaXJlY3Rpb246IHsgbmV4dDogXCJsZWZ0XCIsIHByZXY6IFwicmlnaHRcIiB9LFxyXG4gICAgICAgICAgICBzY3JvbGxPdXRzaWRlOiAhMCxcclxuICAgICAgICAgICAgaW5kZXg6IDAsXHJcbiAgICAgICAgICAgIHR5cGU6IG51bGwsXHJcbiAgICAgICAgICAgIGhyZWY6IG51bGwsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IG51bGwsXHJcbiAgICAgICAgICAgIHRpdGxlOiBudWxsLFxyXG4gICAgICAgICAgICB0cGw6IHtcclxuICAgICAgICAgICAgICAgIHdyYXA6ICc8ZGl2IGNsYXNzPVwiZmFuY3lib3gtd3JhcFwiIHRhYkluZGV4PVwiLTFcIj48ZGl2IGNsYXNzPVwiZmFuY3lib3gtc2tpblwiPjxkaXYgY2xhc3M9XCJmYW5jeWJveC1vdXRlclwiPjxkaXYgY2xhc3M9XCJmYW5jeWJveC1pbm5lclwiPjwvZGl2PjwvZGl2PjwvZGl2PjwvZGl2PicsXHJcbiAgICAgICAgICAgICAgICBpbWFnZTogJzxpbWcgY2xhc3M9XCJmYW5jeWJveC1pbWFnZVwiIHNyYz1cIntocmVmfVwiIGFsdD1cIlwiIC8+JyxcclxuICAgICAgICAgICAgICAgIGlmcmFtZTogJzxpZnJhbWUgaWQ9XCJmYW5jeWJveC1mcmFtZXtybmR9XCIgbmFtZT1cImZhbmN5Ym94LWZyYW1le3JuZH1cIiBjbGFzcz1cImZhbmN5Ym94LWlmcmFtZVwiIGZyYW1lYm9yZGVyPVwiMFwiIHZzcGFjZT1cIjBcIiBoc3BhY2U9XCIwXCIgd2Via2l0QWxsb3dGdWxsU2NyZWVuIG1vemFsbG93ZnVsbHNjcmVlbiBhbGxvd0Z1bGxTY3JlZW4nICtcclxuICAgICAgICAgICAgICAgIChJID8gJyBhbGxvd3RyYW5zcGFyZW5jeT1cInRydWVcIicgOiBcIlwiKSArIFwiPjwvaWZyYW1lPlwiLFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICc8cCBjbGFzcz1cImZhbmN5Ym94LWVycm9yXCI+VGhlIHJlcXVlc3RlZCBjb250ZW50IGNhbm5vdCBiZSBsb2FkZWQuPGJyLz5QbGVhc2UgdHJ5IGFnYWluIGxhdGVyLjwvcD4nLFxyXG4gICAgICAgICAgICAgICAgY2xvc2VCdG46ICc8YSB0aXRsZT1cIkNsb3NlXCIgY2xhc3M9XCJmYW5jeWJveC1pdGVtIGZhbmN5Ym94LWNsb3NlXCIgaHJlZj1cImphdmFzY3JpcHQ6O1wiPjwvYT4nLFxyXG4gICAgICAgICAgICAgICAgbmV4dDogJzxhIHRpdGxlPVwiTmV4dFwiIGNsYXNzPVwiZmFuY3lib3gtbmF2IGZhbmN5Ym94LW5leHRcIiBocmVmPVwiamF2YXNjcmlwdDo7XCI+PHNwYW4+PC9zcGFuPjwvYT4nLFxyXG4gICAgICAgICAgICAgICAgcHJldjogJzxhIHRpdGxlPVwiUHJldmlvdXNcIiBjbGFzcz1cImZhbmN5Ym94LW5hdiBmYW5jeWJveC1wcmV2XCIgaHJlZj1cImphdmFzY3JpcHQ6O1wiPjxzcGFuPjwvc3Bhbj48L2E+J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvcGVuRWZmZWN0OiBcImZhZGVcIixcclxuICAgICAgICAgICAgb3BlblNwZWVkOiAyNTAsXHJcbiAgICAgICAgICAgIG9wZW5FYXNpbmc6IFwic3dpbmdcIixcclxuICAgICAgICAgICAgb3Blbk9wYWNpdHk6ICEwLFxyXG4gICAgICAgICAgICBvcGVuTWV0aG9kOiBcInpvb21JblwiLFxyXG4gICAgICAgICAgICBjbG9zZUVmZmVjdDogXCJmYWRlXCIsXHJcbiAgICAgICAgICAgIGNsb3NlU3BlZWQ6IDI1MCxcclxuICAgICAgICAgICAgY2xvc2VFYXNpbmc6IFwic3dpbmdcIixcclxuICAgICAgICAgICAgY2xvc2VPcGFjaXR5OiAhMCxcclxuICAgICAgICAgICAgY2xvc2VNZXRob2Q6IFwiem9vbU91dFwiLFxyXG4gICAgICAgICAgICBuZXh0RWZmZWN0OiBcImVsYXN0aWNcIixcclxuICAgICAgICAgICAgbmV4dFNwZWVkOiAyNTAsXHJcbiAgICAgICAgICAgIG5leHRFYXNpbmc6IFwic3dpbmdcIixcclxuICAgICAgICAgICAgbmV4dE1ldGhvZDogXCJjaGFuZ2VJblwiLFxyXG4gICAgICAgICAgICBwcmV2RWZmZWN0OiBcImVsYXN0aWNcIixcclxuICAgICAgICAgICAgcHJldlNwZWVkOiAyNTAsXHJcbiAgICAgICAgICAgIHByZXZFYXNpbmc6IFwic3dpbmdcIixcclxuICAgICAgICAgICAgcHJldk1ldGhvZDogXCJjaGFuZ2VPdXRcIixcclxuICAgICAgICAgICAgaGVscGVyczogeyBvdmVybGF5OiAhMCwgdGl0bGU6ICEwIH0sXHJcbiAgICAgICAgICAgIG9uQ2FuY2VsOiBmLm5vb3AsXHJcbiAgICAgICAgICAgIGJlZm9yZUxvYWQ6IGYubm9vcCxcclxuICAgICAgICAgICAgYWZ0ZXJMb2FkOiBmLm5vb3AsXHJcbiAgICAgICAgICAgIGJlZm9yZVNob3c6IGYubm9vcCxcclxuICAgICAgICAgICAgYWZ0ZXJTaG93OiBmLm5vb3AsXHJcbiAgICAgICAgICAgIGJlZm9yZUNoYW5nZTogZi5ub29wLFxyXG4gICAgICAgICAgICBiZWZvcmVDbG9zZTogZi5ub29wLFxyXG4gICAgICAgICAgICBhZnRlckNsb3NlOiBmLm5vb3BcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdyb3VwOiB7fSxcclxuICAgICAgICBvcHRzOiB7fSxcclxuICAgICAgICBwcmV2aW91czogbnVsbCxcclxuICAgICAgICBjb21pbmc6IG51bGwsXHJcbiAgICAgICAgY3VycmVudDogbnVsbCxcclxuICAgICAgICBpc0FjdGl2ZTogITEsXHJcbiAgICAgICAgaXNPcGVuOiAhMSxcclxuICAgICAgICBpc09wZW5lZDogITEsXHJcbiAgICAgICAgd3JhcDogbnVsbCxcclxuICAgICAgICBza2luOiBudWxsLFxyXG4gICAgICAgIG91dGVyOiBudWxsLFxyXG4gICAgICAgIGlubmVyOiBudWxsLFxyXG4gICAgICAgIHBsYXllcjogeyB0aW1lcjogbnVsbCwgaXNBY3RpdmU6ICExIH0sXHJcbiAgICAgICAgYWpheExvYWQ6IG51bGwsXHJcbiAgICAgICAgaW1nUHJlbG9hZDogbnVsbCxcclxuICAgICAgICB0cmFuc2l0aW9uczoge30sXHJcbiAgICAgICAgaGVscGVyczoge30sXHJcbiAgICAgICAgb3BlbjogZnVuY3Rpb24oYSwgZCkge1xyXG4gICAgICAgICAgICBpZiAoYSAmJiAoZi5pc1BsYWluT2JqZWN0KGQpIHx8IChkID0ge30pLCAhMSAhPT0gYi5jbG9zZSghMCkpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGYuaXNBcnJheShhKSB8fCAoYSA9IHQoYSkgPyBmKGEpLmdldCgpIDogW2FdKSwgZi5lYWNoKGEsIGZ1bmN0aW9uKGUsIGMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgayA9IHt9LCBnLCBoLCBqLCBtLCBsO1xyXG4gICAgICAgICAgICAgICAgICAgIFwib2JqZWN0XCIgPT09IGYudHlwZShjKSAmJiAoYy5ub2RlVHlwZSAmJiAoYyA9IGYoYykpLCB0KGMpID8gKGsgPSB7IGhyZWY6IGMuZGF0YShcImZhbmN5Ym94LWhyZWZcIikgfHwgYy5hdHRyKFwiaHJlZlwiKSwgdGl0bGU6IGMuZGF0YShcImZhbmN5Ym94LXRpdGxlXCIpIHx8IGMuYXR0cihcInRpdGxlXCIpLCBpc0RvbTogITAsIGVsZW1lbnQ6IGMgfSwgZi5tZXRhZGF0YSAmJiBmLmV4dGVuZCghMCwgayxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYy5tZXRhZGF0YSgpKSkgOiBrID0gYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZyA9IGQuaHJlZiB8fCBrLmhyZWYgfHwgKHEoYykgPyBjIDogbnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaCA9IGQudGl0bGUgIT09IHYgPyBkLnRpdGxlIDogay50aXRsZSB8fCBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIG0gPSAoaiA9IGQuY29udGVudCB8fCBrLmNvbnRlbnQpID8gXCJodG1sXCIgOiBkLnR5cGUgfHwgay50eXBlO1xyXG4gICAgICAgICAgICAgICAgICAgICFtICYmIGsuaXNEb20gJiYgKG0gPSBjLmRhdGEoXCJmYW5jeWJveC10eXBlXCIpLCBtIHx8IChtID0gKG0gPSBjLnByb3AoXCJjbGFzc1wiKS5tYXRjaCgvZmFuY3lib3hcXC4oXFx3KykvKSkgPyBtWzFdIDogbnVsbCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHEoZykgJiYgKG0gfHwgKGIuaXNJbWFnZShnKSA/IG0gPSBcImltYWdlXCIgOiBiLmlzU1dGKGcpID8gbSA9IFwic3dmXCIgOiBcIiNcIiA9PT0gZy5jaGFyQXQoMCkgPyBtID0gXCJpbmxpbmVcIiA6IHEoYykgJiYgKG0gPSBcImh0bWxcIiwgaiA9IGMpKSwgXCJhamF4XCIgPT09IG0gJiYgKGwgPSBnLnNwbGl0KC9cXHMrLywgMiksIGcgPSBsLnNoaWZ0KCksIGwgPSBsLnNoaWZ0KCkpKTtcclxuICAgICAgICAgICAgICAgICAgICBqIHx8IChcImlubGluZVwiID09PSBtID8gZyA/IGogPSBmKHEoZykgPyBnLnJlcGxhY2UoLy4qKD89I1teXFxzXSskKS8sIFwiXCIpIDogZykgOiBrLmlzRG9tICYmIChqID0gYykgOiBcImh0bWxcIiA9PT0gbSA/IGogPSBnIDogIW0gJiYgKCFnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgay5pc0RvbSkgJiYgKG0gPSBcImlubGluZVwiLCBqID0gYykpO1xyXG4gICAgICAgICAgICAgICAgICAgIGYuZXh0ZW5kKGssIHsgaHJlZjogZywgdHlwZTogbSwgY29udGVudDogaiwgdGl0bGU6IGgsIHNlbGVjdG9yOiBsIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGFbZV0gPSBrO1xyXG4gICAgICAgICAgICAgICAgfSksIGIub3B0cyA9IGYuZXh0ZW5kKCEwLCB7fSwgYi5kZWZhdWx0cywgZCksIGQua2V5cyAhPT0gdiAmJiAoYi5vcHRzLmtleXMgPSBkLmtleXMgPyBmLmV4dGVuZCh7fSwgYi5kZWZhdWx0cy5rZXlzLCBkLmtleXMpIDogITEpLCBiLmdyb3VwID0gYSwgYi5fc3RhcnQoYi5vcHRzLmluZGV4KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNhbmNlbDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gYi5jb21pbmc7XHJcbiAgICAgICAgICAgIGEgJiYgITEgIT09IGIudHJpZ2dlcihcIm9uQ2FuY2VsXCIpICYmIChiLmhpZGVMb2FkaW5nKCksIGIuYWpheExvYWQgJiYgYi5hamF4TG9hZC5hYm9ydCgpLCBiLmFqYXhMb2FkID0gbnVsbCwgYi5pbWdQcmVsb2FkICYmIChiLmltZ1ByZWxvYWQub25sb2FkID0gYi5pbWdQcmVsb2FkLm9uZXJyb3IgPSBudWxsKSwgYS53cmFwICYmIGEud3JhcC5zdG9wKCEwLCAhMCkudHJpZ2dlcihcIm9uUmVzZXRcIikucmVtb3ZlKCksIGIuY29taW5nID0gbnVsbCwgYi5jdXJyZW50IHx8XHJcbiAgICAgICAgICAgIGIuX2FmdGVyWm9vbU91dChhKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjbG9zZTogZnVuY3Rpb24oYSkge1xyXG4gICAgICAgICAgICBiLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICAhMSAhPT0gYi50cmlnZ2VyKFwiYmVmb3JlQ2xvc2VcIikgJiYgKGIudW5iaW5kRXZlbnRzKCksIGIuaXNBY3RpdmUgJiYgKCFiLmlzT3BlbiB8fCAhMCA9PT0gYSA/IChmKFwiLmZhbmN5Ym94LXdyYXBcIikuc3RvcCghMCkudHJpZ2dlcihcIm9uUmVzZXRcIikucmVtb3ZlKCksIGIuX2FmdGVyWm9vbU91dCgpKSA6IChiLmlzT3BlbiA9IGIuaXNPcGVuZWQgPSAhMSwgYi5pc0Nsb3NpbmcgPSAhMCwgZihcIi5mYW5jeWJveC1pdGVtLCAuZmFuY3lib3gtbmF2XCIpLnJlbW92ZSgpLCBiLndyYXAuc3RvcCghMCwgITApLnJlbW92ZUNsYXNzKFwiZmFuY3lib3gtb3BlbmVkXCIpLCBiLnRyYW5zaXRpb25zW2IuY3VycmVudC5jbG9zZU1ldGhvZF0oKSkpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBsYXk6IGZ1bmN0aW9uKGEpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSBmdW5jdGlvbigpIHsgY2xlYXJUaW1lb3V0KGIucGxheWVyLnRpbWVyKTsgfSxcclxuICAgICAgICAgICAgICAgIGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5jdXJyZW50ICYmIGIucGxheWVyLmlzQWN0aXZlICYmIChiLnBsYXllci50aW1lciA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYi5uZXh0LCBiLmN1cnJlbnQucGxheVNwZWVkKSk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGQoKTtcclxuICAgICAgICAgICAgICAgICAgICBwLnVuYmluZChcIi5wbGF5ZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgYi5wbGF5ZXIuaXNBY3RpdmUgPSAhMTtcclxuICAgICAgICAgICAgICAgICAgICBiLnRyaWdnZXIoXCJvblBsYXlFbmRcIik7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoITAgPT09IGEgfHwgIWIucGxheWVyLmlzQWN0aXZlICYmICExICE9PSBhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYi5jdXJyZW50ICYmIChiLmN1cnJlbnQubG9vcCB8fCBiLmN1cnJlbnQuaW5kZXggPCBiLmdyb3VwLmxlbmd0aCAtIDEpKWIucGxheWVyLmlzQWN0aXZlID0gITAsIHAuYmluZCh7IFwib25DYW5jZWwucGxheWVyIGJlZm9yZUNsb3NlLnBsYXllclwiOiBjLCBcIm9uVXBkYXRlLnBsYXllclwiOiBlLCBcImJlZm9yZUxvYWQucGxheWVyXCI6IGQgfSksIGUoKSwgYi50cmlnZ2VyKFwib25QbGF5U3RhcnRcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSBjKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbihhKSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gYi5jdXJyZW50O1xyXG4gICAgICAgICAgICBkICYmIChxKGEpIHx8IChhID0gZC5kaXJlY3Rpb24ubmV4dCksIGIuanVtcHRvKGQuaW5kZXggKyAxLCBhLCBcIm5leHRcIikpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcHJldjogZnVuY3Rpb24oYSkge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGIuY3VycmVudDtcclxuICAgICAgICAgICAgZCAmJiAocShhKSB8fCAoYSA9IGQuZGlyZWN0aW9uLnByZXYpLCBiLmp1bXB0byhkLmluZGV4IC0gMSwgYSwgXCJwcmV2XCIpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGp1bXB0bzogZnVuY3Rpb24oYSwgZCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgYyA9IGIuY3VycmVudDtcclxuICAgICAgICAgICAgYyAmJiAoYSA9IGwoYSksIGIuZGlyZWN0aW9uID0gZCB8fCBjLmRpcmVjdGlvblthID49IGMuaW5kZXggPyBcIm5leHRcIiA6IFwicHJldlwiXSwgYi5yb3V0ZXIgPSBlIHx8IFwianVtcHRvXCIsIGMubG9vcCAmJiAoMCA+IGEgJiYgKGEgPSBjLmdyb3VwLmxlbmd0aCArIGEgJSBjLmdyb3VwLmxlbmd0aCksIGEgJT0gYy5ncm91cC5sZW5ndGgpLCBjLmdyb3VwW2FdICE9PSB2ICYmIChiLmNhbmNlbCgpLCBiLl9zdGFydChhKSkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVwb3NpdGlvbjogZnVuY3Rpb24oYSwgZCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IGIuY3VycmVudCwgYyA9IGUgPyBlLndyYXAgOiBudWxsLCBrO1xyXG4gICAgICAgICAgICBjICYmIChrID0gYi5fZ2V0UG9zaXRpb24oZCksIGEgJiYgXCJzY3JvbGxcIiA9PT0gYS50eXBlID8gKGRlbGV0ZSBrLnBvc2l0aW9uLCBjLnN0b3AoITAsICEwKS5hbmltYXRlKGssIDIwMCkpIDogKGMuY3NzKGspLCBlLnBvcyA9IGYuZXh0ZW5kKHt9LCBlLmRpbSwgaykpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24oYSkge1xyXG4gICAgICAgICAgICB2YXIgZCA9XHJcbiAgICAgICAgICAgICAgICAgICAgYSAmJiBhLnR5cGUsXHJcbiAgICAgICAgICAgICAgICBlID0gIWQgfHwgXCJvcmllbnRhdGlvbmNoYW5nZVwiID09PSBkO1xyXG4gICAgICAgICAgICBlICYmIChjbGVhclRpbWVvdXQoQiksIEIgPSBudWxsKTtcclxuICAgICAgICAgICAgYi5pc09wZW4gJiYgIUIgJiYgKEIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBiLmN1cnJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjICYmICFiLmlzQ2xvc2luZyAmJiAoYi53cmFwLnJlbW92ZUNsYXNzKFwiZmFuY3lib3gtdG1wXCIpLCAoZSB8fCBcImxvYWRcIiA9PT0gZCB8fCBcInJlc2l6ZVwiID09PSBkICYmIGMuYXV0b1Jlc2l6ZSkgJiYgYi5fc2V0RGltZW5zaW9uKCksIFwic2Nyb2xsXCIgPT09IGQgJiYgYy5jYW5TaHJpbmsgfHwgYi5yZXBvc2l0aW9uKGEpLCBiLnRyaWdnZXIoXCJvblVwZGF0ZVwiKSwgQiA9IG51bGwpO1xyXG4gICAgICAgICAgICB9LCBlICYmICFzID8gMCA6IDMwMCkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9nZ2xlOiBmdW5jdGlvbihhKSB7XHJcbiAgICAgICAgICAgIGIuaXNPcGVuICYmIChiLmN1cnJlbnQuZml0VG9WaWV3ID0gXCJib29sZWFuXCIgPT09IGYudHlwZShhKSA/IGEgOiAhYi5jdXJyZW50LmZpdFRvVmlldywgcyAmJiAoYi53cmFwLnJlbW92ZUF0dHIoXCJzdHlsZVwiKS5hZGRDbGFzcyhcImZhbmN5Ym94LXRtcFwiKSwgYi50cmlnZ2VyKFwib25VcGRhdGVcIikpLFxyXG4gICAgICAgICAgICAgICAgYi51cGRhdGUoKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBoaWRlTG9hZGluZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHAudW5iaW5kKFwiLmxvYWRpbmdcIik7XHJcbiAgICAgICAgICAgIGYoXCIjZmFuY3lib3gtbG9hZGluZ1wiKS5yZW1vdmUoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNob3dMb2FkaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGEsIGQ7XHJcbiAgICAgICAgICAgIGIuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgYSA9IGYoJzxkaXYgaWQ9XCJmYW5jeWJveC1sb2FkaW5nXCI+PGRpdj48L2Rpdj48L2Rpdj4nKS5jbGljayhiLmNhbmNlbCkuYXBwZW5kVG8oXCJib2R5XCIpO1xyXG4gICAgICAgICAgICBwLmJpbmQoXCJrZXlkb3duLmxvYWRpbmdcIiwgZnVuY3Rpb24oYSkgeyBpZiAoMjcgPT09IChhLndoaWNoIHx8IGEua2V5Q29kZSkpYS5wcmV2ZW50RGVmYXVsdCgpLCBiLmNhbmNlbCgpOyB9KTtcclxuICAgICAgICAgICAgYi5kZWZhdWx0cy5maXhlZCB8fCAoZCA9IGIuZ2V0Vmlld3BvcnQoKSwgYS5jc3MoeyBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLCB0b3A6IDAuNSAqIGQuaCArIGQueSwgbGVmdDogMC41ICogZC53ICsgZC54IH0pKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldFZpZXdwb3J0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBiLmN1cnJlbnQgJiYgYi5jdXJyZW50LmxvY2tlZCB8fCAhMSxcclxuICAgICAgICAgICAgICAgIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogbi5zY3JvbGxMZWZ0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgeTogbi5zY3JvbGxUb3AoKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgYSA/IChkLncgPSBhWzBdLmNsaWVudFdpZHRoLCBkLmggPSBhWzBdLmNsaWVudEhlaWdodCkgOiAoZC53ID0gcyAmJiByLmlubmVyV2lkdGggPyByLmlubmVyV2lkdGggOiBuLndpZHRoKCksIGQuaCA9IHMgJiYgci5pbm5lckhlaWdodCA/IHIuaW5uZXJIZWlnaHQgOiBuLmhlaWdodCgpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB1bmJpbmRFdmVudHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBiLndyYXAgJiYgdChiLndyYXApICYmIGIud3JhcC51bmJpbmQoXCIuZmJcIik7XHJcbiAgICAgICAgICAgIHAudW5iaW5kKFwiLmZiXCIpO1xyXG4gICAgICAgICAgICBuLnVuYmluZChcIi5mYlwiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJpbmRFdmVudHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGIuY3VycmVudCwgZDtcclxuICAgICAgICAgICAgYSAmJiAobi5iaW5kKFwib3JpZW50YXRpb25jaGFuZ2UuZmJcIiArIChzID8gXCJcIiA6IFwiIHJlc2l6ZS5mYlwiKSArIChhLmF1dG9DZW50ZXIgJiYgIWEubG9ja2VkID8gXCIgc2Nyb2xsLmZiXCIgOiBcIlwiKSwgYi51cGRhdGUpLCAoZCA9IGEua2V5cykgJiYgcC5iaW5kKFwia2V5ZG93bi5mYlwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGUud2hpY2ggfHwgZS5rZXlDb2RlLCBrID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKDI3ID09PSBjICYmIGIuY29taW5nKXJldHVybiExO1xyXG4gICAgICAgICAgICAgICAgIWUuY3RybEtleSAmJiAoIWUuYWx0S2V5ICYmICFlLnNoaWZ0S2V5ICYmICFlLm1ldGFLZXkgJiYgKCFrIHx8ICFrLnR5cGUgJiYgIWYoaykuaXMoXCJbY29udGVudGVkaXRhYmxlXVwiKSkpICYmIGYuZWFjaChkLCBmdW5jdGlvbihkLCBrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKDEgPCBhLmdyb3VwLmxlbmd0aCAmJiBrW2NdICE9PSB2KXJldHVybiBiW2RdKGtbY10pLCBlLnByZXZlbnREZWZhdWx0KCksICExO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgtMSA8IGYuaW5BcnJheShjLCBrKSlyZXR1cm4gYltkXSgpLCBlLnByZXZlbnREZWZhdWx0KCksICExO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pLCBmLmZuLm1vdXNld2hlZWwgJiYgYS5tb3VzZVdoZWVsICYmIGIud3JhcC5iaW5kKFwibW91c2V3aGVlbC5mYlwiLCBmdW5jdGlvbihkLCBjLCBrLCBnKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBoID0gZihkLnRhcmdldCB8fCBudWxsKSwgaiA9ICExOyBoLmxlbmd0aCAmJiAhaiAmJiAhaC5pcyhcIi5mYW5jeWJveC1za2luXCIpICYmICFoLmlzKFwiLmZhbmN5Ym94LXdyYXBcIik7KVxyXG4gICAgICAgICAgICAgICAgICAgIGogPSBoWzBdICYmICEoaFswXS5zdHlsZS5vdmVyZmxvdyAmJiBcImhpZGRlblwiID09PSBoWzBdLnN0eWxlLm92ZXJmbG93KSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIChoWzBdLmNsaWVudFdpZHRoICYmIGhbMF0uc2Nyb2xsV2lkdGggPiBoWzBdLmNsaWVudFdpZHRoIHx8IGhbMF0uY2xpZW50SGVpZ2h0ICYmIGhbMF0uc2Nyb2xsSGVpZ2h0ID4gaFswXS5jbGllbnRIZWlnaHQpLCBoID0gZihoKS5wYXJlbnQoKTtcclxuICAgICAgICAgICAgICAgIGlmICgwICE9PSBjICYmICFqICYmIDEgPCBiLmdyb3VwLmxlbmd0aCAmJiAhYS5jYW5TaHJpbmspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMCA8IGcgfHwgMCA8IGspYi5wcmV2KDAgPCBnID8gXCJkb3duXCIgOiBcImxlZnRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoMCA+IGcgfHwgMCA+IGspYi5uZXh0KDAgPiBnID8gXCJ1cFwiIDogXCJyaWdodFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBkLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRyaWdnZXI6IGZ1bmN0aW9uKGEsIGQpIHtcclxuICAgICAgICAgICAgdmFyIGUsIGMgPSBkIHx8IGIuY29taW5nIHx8IGIuY3VycmVudDtcclxuICAgICAgICAgICAgaWYgKGMpIHtcclxuICAgICAgICAgICAgICAgIGYuaXNGdW5jdGlvbihjW2FdKSAmJiAoZSA9IGNbYV0uYXBwbHkoYywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCExID09PSBlKXJldHVybiExO1xyXG4gICAgICAgICAgICAgICAgYy5oZWxwZXJzICYmIGYuZWFjaChjLmhlbHBlcnMsIGZ1bmN0aW9uKGQsIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSAmJiBiLmhlbHBlcnNbZF0gJiYgZi5pc0Z1bmN0aW9uKGIuaGVscGVyc1tkXVthXSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIuaGVscGVyc1tkXVthXShmLmV4dGVuZCghMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt9LCBiLmhlbHBlcnNbZF0uZGVmYXVsdHMsIGUpLCBjKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcC50cmlnZ2VyKGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBpc0ltYWdlOiBmdW5jdGlvbihhKSB7IHJldHVybiBxKGEpICYmIGEubWF0Y2goLyheZGF0YTppbWFnZVxcLy4qLCl8KFxcLihqcChlfGd8ZWcpfGdpZnxwbmd8Ym1wfHdlYnB8c3ZnKSgoXFw/fCMpLiopPyQpL2kpOyB9LFxyXG4gICAgICAgIGlzU1dGOiBmdW5jdGlvbihhKSB7IHJldHVybiBxKGEpICYmIGEubWF0Y2goL1xcLihzd2YpKChcXD98IykuKik/JC9pKTsgfSxcclxuICAgICAgICBfc3RhcnQ6IGZ1bmN0aW9uKGEpIHtcclxuICAgICAgICAgICAgdmFyIGQgPSB7fSwgZSwgYztcclxuICAgICAgICAgICAgYSA9IGwoYSk7XHJcbiAgICAgICAgICAgIGUgPSBiLmdyb3VwW2FdIHx8IG51bGw7XHJcbiAgICAgICAgICAgIGlmICghZSlyZXR1cm4hMTtcclxuICAgICAgICAgICAgZCA9IGYuZXh0ZW5kKCEwLCB7fSwgYi5vcHRzLCBlKTtcclxuICAgICAgICAgICAgZSA9IGQubWFyZ2luO1xyXG4gICAgICAgICAgICBjID0gZC5wYWRkaW5nO1xyXG4gICAgICAgICAgICBcIm51bWJlclwiID09PSBmLnR5cGUoZSkgJiYgKGQubWFyZ2luID0gW2UsIGUsIGUsIGVdKTtcclxuICAgICAgICAgICAgXCJudW1iZXJcIiA9PT0gZi50eXBlKGMpICYmIChkLnBhZGRpbmcgPSBbYywgYywgYywgY10pO1xyXG4gICAgICAgICAgICBkLm1vZGFsICYmIGYuZXh0ZW5kKCEwLCBkLCB7XHJcbiAgICAgICAgICAgICAgICBjbG9zZUJ0bjogITEsXHJcbiAgICAgICAgICAgICAgICBjbG9zZUNsaWNrOiAhMSxcclxuICAgICAgICAgICAgICAgIG5leHRDbGljazogITEsXHJcbiAgICAgICAgICAgICAgICBhcnJvd3M6ICExLFxyXG4gICAgICAgICAgICAgICAgbW91c2VXaGVlbDogITEsXHJcbiAgICAgICAgICAgICAgICBrZXlzOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgaGVscGVyczogeyBvdmVybGF5OiB7IGNsb3NlQ2xpY2s6ICExIH0gfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZC5hdXRvU2l6ZSAmJiAoZC5hdXRvV2lkdGggPSBkLmF1dG9IZWlnaHQgPSAhMCk7XHJcbiAgICAgICAgICAgIFwiYXV0b1wiID09PSBkLndpZHRoICYmIChkLmF1dG9XaWR0aCA9ICEwKTtcclxuICAgICAgICAgICAgXCJhdXRvXCIgPT09IGQuaGVpZ2h0ICYmIChkLmF1dG9IZWlnaHQgPSAhMCk7XHJcbiAgICAgICAgICAgIGQuZ3JvdXAgPSBiLmdyb3VwO1xyXG4gICAgICAgICAgICBkLmluZGV4ID0gYTtcclxuICAgICAgICAgICAgYi5jb21pbmcgPSBkO1xyXG4gICAgICAgICAgICBpZiAoITEgPT09IGIudHJpZ2dlcihcImJlZm9yZUxvYWRcIikpYi5jb21pbmcgPSBudWxsO1xyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGMgPSBkLnR5cGU7XHJcbiAgICAgICAgICAgICAgICBlID0gZC5ocmVmO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjKXJldHVybiBiLmNvbWluZyA9IG51bGwsIGIuY3VycmVudCAmJiBiLnJvdXRlciAmJiBcImp1bXB0b1wiICE9PSBiLnJvdXRlciA/IChiLmN1cnJlbnQuaW5kZXggPSBhLCBiW2Iucm91dGVyXShiLmRpcmVjdGlvbikpIDogITE7XHJcbiAgICAgICAgICAgICAgICBiLmlzQWN0aXZlID0gITA7XHJcbiAgICAgICAgICAgICAgICBpZiAoXCJpbWFnZVwiID09PSBjIHx8IFwic3dmXCIgPT09IGMpZC5hdXRvSGVpZ2h0ID0gZC5hdXRvV2lkdGggPSAhMSwgZC5zY3JvbGxpbmcgPSBcInZpc2libGVcIjtcclxuICAgICAgICAgICAgICAgIFwiaW1hZ2VcIiA9PT0gYyAmJiAoZC5hc3BlY3RSYXRpbyA9XHJcbiAgICAgICAgICAgICAgICAgICAgITApO1xyXG4gICAgICAgICAgICAgICAgXCJpZnJhbWVcIiA9PT0gYyAmJiBzICYmIChkLnNjcm9sbGluZyA9IFwic2Nyb2xsXCIpO1xyXG4gICAgICAgICAgICAgICAgZC53cmFwID0gZihkLnRwbC53cmFwKS5hZGRDbGFzcyhcImZhbmN5Ym94LVwiICsgKHMgPyBcIm1vYmlsZVwiIDogXCJkZXNrdG9wXCIpICsgXCIgZmFuY3lib3gtdHlwZS1cIiArIGMgKyBcIiBmYW5jeWJveC10bXAgXCIgKyBkLndyYXBDU1MpLmFwcGVuZFRvKGQucGFyZW50IHx8IFwiYm9keVwiKTtcclxuICAgICAgICAgICAgICAgIGYuZXh0ZW5kKGQsIHsgc2tpbjogZihcIi5mYW5jeWJveC1za2luXCIsIGQud3JhcCksIG91dGVyOiBmKFwiLmZhbmN5Ym94LW91dGVyXCIsIGQud3JhcCksIGlubmVyOiBmKFwiLmZhbmN5Ym94LWlubmVyXCIsIGQud3JhcCkgfSk7XHJcbiAgICAgICAgICAgICAgICBmLmVhY2goW1wiVG9wXCIsIFwiUmlnaHRcIiwgXCJCb3R0b21cIiwgXCJMZWZ0XCJdLCBmdW5jdGlvbihhLCBiKSB7IGQuc2tpbi5jc3MoXCJwYWRkaW5nXCIgKyBiLCB3KGQucGFkZGluZ1thXSkpOyB9KTtcclxuICAgICAgICAgICAgICAgIGIudHJpZ2dlcihcIm9uUmVhZHlcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoXCJpbmxpbmVcIiA9PT0gYyB8fCBcImh0bWxcIiA9PT0gYykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZC5jb250ZW50IHx8ICFkLmNvbnRlbnQubGVuZ3RoKXJldHVybiBiLl9lcnJvcihcImNvbnRlbnRcIik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFlKXJldHVybiBiLl9lcnJvcihcImhyZWZcIik7XHJcbiAgICAgICAgICAgICAgICBcImltYWdlXCIgPT09IGMgPyBiLl9sb2FkSW1hZ2UoKSA6IFwiYWpheFwiID09PSBjID8gYi5fbG9hZEFqYXgoKSA6IFwiaWZyYW1lXCIgPT09IGMgPyBiLl9sb2FkSWZyYW1lKCkgOiBiLl9hZnRlckxvYWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgX2Vycm9yOiBmdW5jdGlvbihhKSB7XHJcbiAgICAgICAgICAgIGYuZXh0ZW5kKGIuY29taW5nLCB7IHR5cGU6IFwiaHRtbFwiLCBhdXRvV2lkdGg6ICEwLCBhdXRvSGVpZ2h0OiAhMCwgbWluV2lkdGg6IDAsIG1pbkhlaWdodDogMCwgc2Nyb2xsaW5nOiBcIm5vXCIsIGhhc0Vycm9yOiBhLCBjb250ZW50OiBiLmNvbWluZy50cGwuZXJyb3IgfSk7XHJcbiAgICAgICAgICAgIGIuX2FmdGVyTG9hZCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgX2xvYWRJbWFnZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gYi5pbWdQcmVsb2FkID0gbmV3IEltYWdlO1xyXG4gICAgICAgICAgICBhLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbmxvYWQgPSB0aGlzLm9uZXJyb3IgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgYi5jb21pbmcud2lkdGggPSB0aGlzLndpZHRoIC8gYi5vcHRzLnBpeGVsUmF0aW87XHJcbiAgICAgICAgICAgICAgICBiLmNvbWluZy5oZWlnaHQgPSB0aGlzLmhlaWdodCAvIGIub3B0cy5waXhlbFJhdGlvO1xyXG4gICAgICAgICAgICAgICAgYi5fYWZ0ZXJMb2FkKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGEub25lcnJvciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbmxvYWQgPVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBiLl9lcnJvcihcImltYWdlXCIpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBhLnNyYyA9IGIuY29taW5nLmhyZWY7XHJcbiAgICAgICAgICAgICEwICE9PSBhLmNvbXBsZXRlICYmIGIuc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIF9sb2FkQWpheDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gYi5jb21pbmc7XHJcbiAgICAgICAgICAgIGIuc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICAgICAgYi5hamF4TG9hZCA9IGYuYWpheChmLmV4dGVuZCh7fSwgYS5hamF4LCB7IHVybDogYS5ocmVmLCBlcnJvcjogZnVuY3Rpb24oYSwgZSkgeyBiLmNvbWluZyAmJiBcImFib3J0XCIgIT09IGUgPyBiLl9lcnJvcihcImFqYXhcIiwgYSkgOiBiLmhpZGVMb2FkaW5nKCk7IH0sIHN1Y2Nlc3M6IGZ1bmN0aW9uKGQsIGUpIHsgXCJzdWNjZXNzXCIgPT09IGUgJiYgKGEuY29udGVudCA9IGQsIGIuX2FmdGVyTG9hZCgpKTsgfSB9KSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBfbG9hZElmcmFtZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gYi5jb21pbmcsIGQgPSBmKGEudHBsLmlmcmFtZS5yZXBsYWNlKC9cXHtybmRcXH0vZywgKG5ldyBEYXRlKS5nZXRUaW1lKCkpKS5hdHRyKFwic2Nyb2xsaW5nXCIsIHMgPyBcImF1dG9cIiA6IGEuaWZyYW1lLnNjcm9sbGluZykuYXR0cihcInNyY1wiLCBhLmhyZWYpO1xyXG4gICAgICAgICAgICBmKGEud3JhcCkuYmluZChcIm9uUmVzZXRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYodGhpcykuZmluZChcImlmcmFtZVwiKS5oaWRlKCkuYXR0cihcInNyY1wiLCBcIi8vYWJvdXQ6YmxhbmtcIikuZW5kKCkuZW1wdHkoKTtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGEpIHtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGEuaWZyYW1lLnByZWxvYWQgJiYgKGIuc2hvd0xvYWRpbmcoKSwgZC5vbmUoXCJsb2FkXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZih0aGlzKS5kYXRhKFwicmVhZHlcIiwgMSk7XHJcbiAgICAgICAgICAgICAgICBzIHx8IGYodGhpcykuYmluZChcImxvYWQuZmJcIiwgYi51cGRhdGUpO1xyXG4gICAgICAgICAgICAgICAgZih0aGlzKS5wYXJlbnRzKFwiLmZhbmN5Ym94LXdyYXBcIikud2lkdGgoXCIxMDAlXCIpLnJlbW92ZUNsYXNzKFwiZmFuY3lib3gtdG1wXCIpLnNob3coKTtcclxuICAgICAgICAgICAgICAgIGIuX2FmdGVyTG9hZCgpO1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGEuY29udGVudCA9IGQuYXBwZW5kVG8oYS5pbm5lcik7XHJcbiAgICAgICAgICAgIGEuaWZyYW1lLnByZWxvYWQgfHwgYi5fYWZ0ZXJMb2FkKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBfcHJlbG9hZEltYWdlczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gYi5ncm91cCxcclxuICAgICAgICAgICAgICAgIGQgPSBiLmN1cnJlbnQsXHJcbiAgICAgICAgICAgICAgICBlID0gYS5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICBjID0gZC5wcmVsb2FkID8gTWF0aC5taW4oZC5wcmVsb2FkLFxyXG4gICAgICAgICAgICAgICAgICAgIGUgLSAxKSA6IDAsXHJcbiAgICAgICAgICAgICAgICBmLFxyXG4gICAgICAgICAgICAgICAgZztcclxuICAgICAgICAgICAgZm9yIChnID0gMTsgZyA8PSBjOyBnICs9IDEpZiA9IGFbKGQuaW5kZXggKyBnKSAlIGVdLCBcImltYWdlXCIgPT09IGYudHlwZSAmJiBmLmhyZWYgJiYgKChuZXcgSW1hZ2UpLnNyYyA9IGYuaHJlZik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBfYWZ0ZXJMb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBiLmNvbWluZywgZCA9IGIuY3VycmVudCwgZSwgYywgaywgZywgaDtcclxuICAgICAgICAgICAgYi5oaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICBpZiAoYSAmJiAhMSAhPT0gYi5pc0FjdGl2ZSlcclxuICAgICAgICAgICAgICAgIGlmICghMSA9PT0gYi50cmlnZ2VyKFwiYWZ0ZXJMb2FkXCIsIGEsIGQpKWEud3JhcC5zdG9wKCEwKS50cmlnZ2VyKFwib25SZXNldFwiKS5yZW1vdmUoKSwgYi5jb21pbmcgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZCAmJiAoYi50cmlnZ2VyKFwiYmVmb3JlQ2hhbmdlXCIsIGQpLCBkLndyYXAuc3RvcCghMCkucmVtb3ZlQ2xhc3MoXCJmYW5jeWJveC1vcGVuZWRcIikuZmluZChcIi5mYW5jeWJveC1pdGVtLCAuZmFuY3lib3gtbmF2XCIpLnJlbW92ZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICBiLnVuYmluZEV2ZW50cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBhLmNvbnRlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYyA9IGEudHlwZTtcclxuICAgICAgICAgICAgICAgICAgICBrID0gYS5zY3JvbGxpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgZi5leHRlbmQoYiwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3cmFwOiBhLndyYXAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNraW46IGEuc2tpbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0ZXI6IGEub3V0ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyOiBhLmlubmVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50OiBhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91czogZFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGcgPSBhLmhyZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbmxpbmVcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFqYXhcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImh0bWxcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc2VsZWN0b3IgPyBlID0gZihcIjxkaXY+XCIpLmh0bWwoZSkuZmluZChhLnNlbGVjdG9yKSA6IHQoZSkgJiYgKGUuZGF0YShcImZhbmN5Ym94LXBsYWNlaG9sZGVyXCIpIHx8IGUuZGF0YShcImZhbmN5Ym94LXBsYWNlaG9sZGVyXCIsIGYoJzxkaXYgY2xhc3M9XCJmYW5jeWJveC1wbGFjZWhvbGRlclwiPjwvZGl2PicpLmluc2VydEFmdGVyKGUpLmhpZGUoKSksIGUgPSBlLnNob3coKS5kZXRhY2goKSwgYS53cmFwLmJpbmQoXCJvblJlc2V0XCIsIGZ1bmN0aW9uKCkgeyBmKHRoaXMpLmZpbmQoZSkubGVuZ3RoICYmIGUuaGlkZSgpLnJlcGxhY2VBbGwoZS5kYXRhKFwiZmFuY3lib3gtcGxhY2Vob2xkZXJcIikpLmRhdGEoXCJmYW5jeWJveC1wbGFjZWhvbGRlclwiLCAhMSk7IH0pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW1hZ2VcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBhLnRwbC5pbWFnZS5yZXBsYWNlKFwie2hyZWZ9XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN3ZlwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9ICc8b2JqZWN0IGlkPVwiZmFuY3lib3gtc3dmXCIgY2xhc3NpZD1cImNsc2lkOkQyN0NEQjZFLUFFNkQtMTFjZi05NkI4LTQ0NDU1MzU0MDAwMFwiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIj48cGFyYW0gbmFtZT1cIm1vdmllXCIgdmFsdWU9XCInICsgZyArICdcIj48L3BhcmFtPicsIGggPSBcIlwiLCBmLmVhY2goYS5zd2YsIGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlICs9ICc8cGFyYW0gbmFtZT1cIicgKyBhICsgJ1wiIHZhbHVlPVwiJyArIGIgKyAnXCI+PC9wYXJhbT4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggKz0gXCIgXCIgKyBhICsgJz1cIicgKyBiICsgJ1wiJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBlICs9ICc8ZW1iZWQgc3JjPVwiJyArIGcgKyAnXCIgdHlwZT1cImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCIgd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMTAwJVwiJyArIGggKyBcIj48L2VtYmVkPjwvb2JqZWN0PlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAoIXQoZSkgfHwgIWUucGFyZW50KCkuaXMoYS5pbm5lcikpICYmIGEuaW5uZXIuYXBwZW5kKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGIudHJpZ2dlcihcImJlZm9yZVNob3dcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5pbm5lci5jc3MoXCJvdmVyZmxvd1wiLCBcInllc1wiID09PSBrID8gXCJzY3JvbGxcIiA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm9cIiA9PT0gayA/IFwiaGlkZGVuXCIgOiBrKTtcclxuICAgICAgICAgICAgICAgICAgICBiLl9zZXREaW1lbnNpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBiLnJlcG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBiLmlzT3BlbiA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuY29taW5nID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBiLmJpbmRFdmVudHMoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYi5pc09wZW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5wcmV2TWV0aG9kKWIudHJhbnNpdGlvbnNbZC5wcmV2TWV0aG9kXSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBmKFwiLmZhbmN5Ym94LXdyYXBcIikubm90KGEud3JhcCkuc3RvcCghMCkudHJpZ2dlcihcIm9uUmVzZXRcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYi50cmFuc2l0aW9uc1tiLmlzT3BlbmVkID8gYS5uZXh0TWV0aG9kIDogYS5vcGVuTWV0aG9kXSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuX3ByZWxvYWRJbWFnZXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIF9zZXREaW1lbnNpb246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGIuZ2V0Vmlld3BvcnQoKSxcclxuICAgICAgICAgICAgICAgIGQgPSAwLFxyXG4gICAgICAgICAgICAgICAgZSA9ICExLFxyXG4gICAgICAgICAgICAgICAgYyA9ICExLFxyXG4gICAgICAgICAgICAgICAgZSA9IGIud3JhcCxcclxuICAgICAgICAgICAgICAgIGsgPSBiLnNraW4sXHJcbiAgICAgICAgICAgICAgICBnID0gYi5pbm5lcixcclxuICAgICAgICAgICAgICAgIGggPSBiLmN1cnJlbnQsXHJcbiAgICAgICAgICAgICAgICBjID0gaC53aWR0aCxcclxuICAgICAgICAgICAgICAgIGogPSBoLmhlaWdodCxcclxuICAgICAgICAgICAgICAgIG0gPSBoLm1pbldpZHRoLFxyXG4gICAgICAgICAgICAgICAgdSA9IGgubWluSGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgbiA9IGgubWF4V2lkdGgsXHJcbiAgICAgICAgICAgICAgICBwID0gaC5tYXhIZWlnaHQsXHJcbiAgICAgICAgICAgICAgICBzID0gaC5zY3JvbGxpbmcsXHJcbiAgICAgICAgICAgICAgICBxID0gaC5zY3JvbGxPdXRzaWRlID9cclxuICAgICAgICAgICAgICAgICAgICBoLnNjcm9sbGJhcldpZHRoIDogMCxcclxuICAgICAgICAgICAgICAgIHggPSBoLm1hcmdpbixcclxuICAgICAgICAgICAgICAgIHkgPSBsKHhbMV0gKyB4WzNdKSxcclxuICAgICAgICAgICAgICAgIHIgPSBsKHhbMF0gKyB4WzJdKSxcclxuICAgICAgICAgICAgICAgIHYsXHJcbiAgICAgICAgICAgICAgICB6LFxyXG4gICAgICAgICAgICAgICAgdCxcclxuICAgICAgICAgICAgICAgIEMsXHJcbiAgICAgICAgICAgICAgICBBLFxyXG4gICAgICAgICAgICAgICAgRixcclxuICAgICAgICAgICAgICAgIEIsXHJcbiAgICAgICAgICAgICAgICBELFxyXG4gICAgICAgICAgICAgICAgSDtcclxuICAgICAgICAgICAgZS5hZGQoaykuYWRkKGcpLndpZHRoKFwiYXV0b1wiKS5oZWlnaHQoXCJhdXRvXCIpLnJlbW92ZUNsYXNzKFwiZmFuY3lib3gtdG1wXCIpO1xyXG4gICAgICAgICAgICB4ID0gbChrLm91dGVyV2lkdGgoITApIC0gay53aWR0aCgpKTtcclxuICAgICAgICAgICAgdiA9IGwoay5vdXRlckhlaWdodCghMCkgLSBrLmhlaWdodCgpKTtcclxuICAgICAgICAgICAgeiA9IHkgKyB4O1xyXG4gICAgICAgICAgICB0ID0gciArIHY7XHJcbiAgICAgICAgICAgIEMgPSBFKGMpID8gKGEudyAtIHopICogbChjKSAvIDEwMCA6IGM7XHJcbiAgICAgICAgICAgIEEgPSBFKGopID8gKGEuaCAtIHQpICogbChqKSAvIDEwMCA6IGo7XHJcbiAgICAgICAgICAgIGlmIChcImlmcmFtZVwiID09PSBoLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChIID0gaC5jb250ZW50LCBoLmF1dG9IZWlnaHQgJiYgMSA9PT0gSC5kYXRhKFwicmVhZHlcIikpXHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgSFswXS5jb250ZW50V2luZG93LmRvY3VtZW50LmxvY2F0aW9uICYmIChnLndpZHRoKEMpLmhlaWdodCg5OTk5KSwgRiA9IEguY29udGVudHMoKS5maW5kKFwiYm9keVwiKSwgcSAmJiBGLmNzcyhcIm92ZXJmbG93LXhcIiwgXCJoaWRkZW5cIiksIEEgPSBGLm91dGVySGVpZ2h0KCEwKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRykge1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChoLmF1dG9XaWR0aCB8fFxyXG4gICAgICAgICAgICAgICAgaC5hdXRvSGVpZ2h0KWcuYWRkQ2xhc3MoXCJmYW5jeWJveC10bXBcIiksIGguYXV0b1dpZHRoIHx8IGcud2lkdGgoQyksIGguYXV0b0hlaWdodCB8fCBnLmhlaWdodChBKSwgaC5hdXRvV2lkdGggJiYgKEMgPSBnLndpZHRoKCkpLCBoLmF1dG9IZWlnaHQgJiYgKEEgPSBnLmhlaWdodCgpKSwgZy5yZW1vdmVDbGFzcyhcImZhbmN5Ym94LXRtcFwiKTtcclxuICAgICAgICAgICAgYyA9IGwoQyk7XHJcbiAgICAgICAgICAgIGogPSBsKEEpO1xyXG4gICAgICAgICAgICBEID0gQyAvIEE7XHJcbiAgICAgICAgICAgIG0gPSBsKEUobSkgPyBsKG0sIFwid1wiKSAtIHogOiBtKTtcclxuICAgICAgICAgICAgbiA9IGwoRShuKSA/IGwobiwgXCJ3XCIpIC0geiA6IG4pO1xyXG4gICAgICAgICAgICB1ID0gbChFKHUpID8gbCh1LCBcImhcIikgLSB0IDogdSk7XHJcbiAgICAgICAgICAgIHAgPSBsKEUocCkgPyBsKHAsIFwiaFwiKSAtIHQgOiBwKTtcclxuICAgICAgICAgICAgRiA9IG47XHJcbiAgICAgICAgICAgIEIgPSBwO1xyXG4gICAgICAgICAgICBoLmZpdFRvVmlldyAmJiAobiA9IE1hdGgubWluKGEudyAtIHosIG4pLCBwID0gTWF0aC5taW4oYS5oIC0gdCwgcCkpO1xyXG4gICAgICAgICAgICB6ID0gYS53IC0geTtcclxuICAgICAgICAgICAgciA9IGEuaCAtIHI7XHJcbiAgICAgICAgICAgIGguYXNwZWN0UmF0aW8gPyAoYyA+IG4gJiYgKGMgPSBuLCBqID0gbChjIC8gRCkpLCBqID4gcCAmJiAoaiA9IHAsIGMgPSBsKGogKiBEKSksIGMgPCBtICYmIChjID0gbSwgaiA9IGwoYyAvIEQpKSwgaiA8IHUgJiYgKGogPSB1LCBjID0gbChqICogRCkpKSA6IChjID0gTWF0aC5tYXgobSwgTWF0aC5taW4oYywgbikpLCBoLmF1dG9IZWlnaHQgJiZcclxuICAgICAgICAgICAgXCJpZnJhbWVcIiAhPT0gaC50eXBlICYmIChnLndpZHRoKGMpLCBqID0gZy5oZWlnaHQoKSksIGogPSBNYXRoLm1heCh1LCBNYXRoLm1pbihqLCBwKSkpO1xyXG4gICAgICAgICAgICBpZiAoaC5maXRUb1ZpZXcpXHJcbiAgICAgICAgICAgICAgICBpZiAoZy53aWR0aChjKS5oZWlnaHQoaiksIGUud2lkdGgoYyArIHgpLCBhID0gZS53aWR0aCgpLCB5ID0gZS5oZWlnaHQoKSwgaC5hc3BlY3RSYXRpbylmb3IgKDsgKGEgPiB6IHx8IHkgPiByKSAmJiAoYyA+IG0gJiYgaiA+IHUpICYmICEoMTkgPCBkKyspOylqID0gTWF0aC5tYXgodSwgTWF0aC5taW4ocCwgaiAtIDEwKSksIGMgPSBsKGogKiBEKSwgYyA8IG0gJiYgKGMgPSBtLCBqID0gbChjIC8gRCkpLCBjID4gbiAmJiAoYyA9IG4sIGogPSBsKGMgLyBEKSksIGcud2lkdGgoYykuaGVpZ2h0KGopLCBlLndpZHRoKGMgKyB4KSwgYSA9IGUud2lkdGgoKSwgeSA9IGUuaGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICBlbHNlIGMgPSBNYXRoLm1heChtLCBNYXRoLm1pbihjLCBjIC0gKGEgLSB6KSkpLCBqID0gTWF0aC5tYXgodSwgTWF0aC5taW4oaiwgaiAtICh5IC0gcikpKTtcclxuICAgICAgICAgICAgcSAmJiAoXCJhdXRvXCIgPT09IHMgJiYgaiA8IEEgJiYgYyArIHggKyBxIDwgeikgJiYgKGMgKz0gcSk7XHJcbiAgICAgICAgICAgIGcud2lkdGgoYykuaGVpZ2h0KGopO1xyXG4gICAgICAgICAgICBlLndpZHRoKGMgKyB4KTtcclxuICAgICAgICAgICAgYSA9IGUud2lkdGgoKTtcclxuICAgICAgICAgICAgeSA9IGUuaGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIGUgPSAoYSA+IHogfHwgeSA+IHIpICYmIGMgPiBtICYmIGogPiB1O1xyXG4gICAgICAgICAgICBjID0gaC5hc3BlY3RSYXRpbyA/IGMgPCBGICYmIGogPCBCICYmIGMgPCBDICYmIGogPCBBIDogKGMgPCBGIHx8IGogPCBCKSAmJiAoYyA8IEMgfHwgaiA8IEEpO1xyXG4gICAgICAgICAgICBmLmV4dGVuZChoLCB7IGRpbTogeyB3aWR0aDogdyhhKSwgaGVpZ2h0OiB3KHkpIH0sIG9yaWdXaWR0aDogQywgb3JpZ0hlaWdodDogQSwgY2FuU2hyaW5rOiBlLCBjYW5FeHBhbmQ6IGMsIHdQYWRkaW5nOiB4LCBoUGFkZGluZzogdiwgd3JhcFNwYWNlOiB5IC0gay5vdXRlckhlaWdodCghMCksIHNraW5TcGFjZTogay5oZWlnaHQoKSAtIGogfSk7XHJcbiAgICAgICAgICAgICFIICYmIChoLmF1dG9IZWlnaHQgJiYgaiA+IHUgJiYgaiA8IHAgJiYgIWMpICYmIGcuaGVpZ2h0KFwiYXV0b1wiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIF9nZXRQb3NpdGlvbjogZnVuY3Rpb24oYSkge1xyXG4gICAgICAgICAgICB2YXIgZCA9IGIuY3VycmVudCwgZSA9IGIuZ2V0Vmlld3BvcnQoKSwgYyA9IGQubWFyZ2luLCBmID0gYi53cmFwLndpZHRoKCkgKyBjWzFdICsgY1szXSwgZyA9IGIud3JhcC5oZWlnaHQoKSArIGNbMF0gKyBjWzJdLCBjID0geyBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLCB0b3A6IGNbMF0sIGxlZnQ6IGNbM10gfTtcclxuICAgICAgICAgICAgZC5hdXRvQ2VudGVyICYmIGQuZml4ZWQgJiZcclxuICAgICAgICAgICAgIWEgJiYgZyA8PSBlLmggJiYgZiA8PSBlLncgPyBjLnBvc2l0aW9uID0gXCJmaXhlZFwiIDogZC5sb2NrZWQgfHwgKGMudG9wICs9IGUueSwgYy5sZWZ0ICs9IGUueCk7XHJcbiAgICAgICAgICAgIGMudG9wID0gdyhNYXRoLm1heChjLnRvcCwgYy50b3AgKyAoZS5oIC0gZykgKiBkLnRvcFJhdGlvKSk7XHJcbiAgICAgICAgICAgIGMubGVmdCA9IHcoTWF0aC5tYXgoYy5sZWZ0LCBjLmxlZnQgKyAoZS53IC0gZikgKiBkLmxlZnRSYXRpbykpO1xyXG4gICAgICAgICAgICByZXR1cm4gYztcclxuICAgICAgICB9LFxyXG4gICAgICAgIF9hZnRlclpvb21JbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gYi5jdXJyZW50O1xyXG4gICAgICAgICAgICBhICYmIChiLmlzT3BlbiA9IGIuaXNPcGVuZWQgPSAhMCwgYi53cmFwLmNzcyhcIm92ZXJmbG93XCIsIFwidmlzaWJsZVwiKS5hZGRDbGFzcyhcImZhbmN5Ym94LW9wZW5lZFwiKSwgYi51cGRhdGUoKSwgKGEuY2xvc2VDbGljayB8fCBhLm5leHRDbGljayAmJiAxIDwgYi5ncm91cC5sZW5ndGgpICYmIGIuaW5uZXIuY3NzKFwiY3Vyc29yXCIsIFwicG9pbnRlclwiKS5iaW5kKFwiY2xpY2suZmJcIiwgZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgICAgICAgIWYoZC50YXJnZXQpLmlzKFwiYVwiKSAmJiAhZihkLnRhcmdldCkucGFyZW50KCkuaXMoXCJhXCIpICYmIChkLnByZXZlbnREZWZhdWx0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgYlthLmNsb3NlQ2xpY2sgPyBcImNsb3NlXCIgOiBcIm5leHRcIl0oKSk7XHJcbiAgICAgICAgICAgIH0pLCBhLmNsb3NlQnRuICYmIGYoYS50cGwuY2xvc2VCdG4pLmFwcGVuZFRvKGIuc2tpbikuYmluZChcImNsaWNrLmZiXCIsIGZ1bmN0aW9uKGEpIHtcclxuICAgICAgICAgICAgICAgIGEucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGIuY2xvc2UoKTtcclxuICAgICAgICAgICAgfSksIGEuYXJyb3dzICYmIDEgPCBiLmdyb3VwLmxlbmd0aCAmJiAoKGEubG9vcCB8fCAwIDwgYS5pbmRleCkgJiYgZihhLnRwbC5wcmV2KS5hcHBlbmRUbyhiLm91dGVyKS5iaW5kKFwiY2xpY2suZmJcIiwgYi5wcmV2KSwgKGEubG9vcCB8fCBhLmluZGV4IDwgYi5ncm91cC5sZW5ndGggLSAxKSAmJiBmKGEudHBsLm5leHQpLmFwcGVuZFRvKGIub3V0ZXIpLmJpbmQoXCJjbGljay5mYlwiLCBiLm5leHQpKSwgYi50cmlnZ2VyKFwiYWZ0ZXJTaG93XCIpLCAhYS5sb29wICYmIGEuaW5kZXggPT09IGEuZ3JvdXAubGVuZ3RoIC0gMSA/IGIucGxheSghMSkgOiBiLm9wdHMuYXV0b1BsYXkgJiYgIWIucGxheWVyLmlzQWN0aXZlICYmIChiLm9wdHMuYXV0b1BsYXkgPSAhMSwgYi5wbGF5KCkpKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIF9hZnRlclpvb21PdXQ6IGZ1bmN0aW9uKGEpIHtcclxuICAgICAgICAgICAgYSA9XHJcbiAgICAgICAgICAgICAgICBhIHx8IGIuY3VycmVudDtcclxuICAgICAgICAgICAgZihcIi5mYW5jeWJveC13cmFwXCIpLnRyaWdnZXIoXCJvblJlc2V0XCIpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBmLmV4dGVuZChiLCB7IGdyb3VwOiB7fSwgb3B0czoge30sIHJvdXRlcjogITEsIGN1cnJlbnQ6IG51bGwsIGlzQWN0aXZlOiAhMSwgaXNPcGVuZWQ6ICExLCBpc09wZW46ICExLCBpc0Nsb3Npbmc6ICExLCB3cmFwOiBudWxsLCBza2luOiBudWxsLCBvdXRlcjogbnVsbCwgaW5uZXI6IG51bGwgfSk7XHJcbiAgICAgICAgICAgIGIudHJpZ2dlcihcImFmdGVyQ2xvc2VcIiwgYSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBiLnRyYW5zaXRpb25zID0ge1xyXG4gICAgICAgIGdldE9yaWdQb3NpdGlvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gYi5jdXJyZW50LCBkID0gYS5lbGVtZW50LCBlID0gYS5vcmlnLCBjID0ge30sIGYgPSA1MCwgZyA9IDUwLCBoID0gYS5oUGFkZGluZywgaiA9IGEud1BhZGRpbmcsIG0gPSBiLmdldFZpZXdwb3J0KCk7XHJcbiAgICAgICAgICAgICFlICYmIChhLmlzRG9tICYmIGQuaXMoXCI6dmlzaWJsZVwiKSkgJiYgKGUgPSBkLmZpbmQoXCJpbWc6Zmlyc3RcIiksIGUubGVuZ3RoIHx8IChlID0gZCkpO1xyXG4gICAgICAgICAgICB0KGUpID8gKGMgPSBlLm9mZnNldCgpLCBlLmlzKFwiaW1nXCIpICYmIChmID0gZS5vdXRlcldpZHRoKCksIGcgPSBlLm91dGVySGVpZ2h0KCkpKSA6XHJcbiAgICAgICAgICAgICAgICAoYy50b3AgPSBtLnkgKyAobS5oIC0gZykgKiBhLnRvcFJhdGlvLCBjLmxlZnQgPSBtLnggKyAobS53IC0gZikgKiBhLmxlZnRSYXRpbyk7XHJcbiAgICAgICAgICAgIGlmIChcImZpeGVkXCIgPT09IGIud3JhcC5jc3MoXCJwb3NpdGlvblwiKSB8fCBhLmxvY2tlZCljLnRvcCAtPSBtLnksIGMubGVmdCAtPSBtLng7XHJcbiAgICAgICAgICAgIHJldHVybiBjID0geyB0b3A6IHcoYy50b3AgLSBoICogYS50b3BSYXRpbyksIGxlZnQ6IHcoYy5sZWZ0IC0gaiAqIGEubGVmdFJhdGlvKSwgd2lkdGg6IHcoZiArIGopLCBoZWlnaHQ6IHcoZyArIGgpIH07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzdGVwOiBmdW5jdGlvbihhLCBkKSB7XHJcbiAgICAgICAgICAgIHZhciBlLCBjLCBmID0gZC5wcm9wO1xyXG4gICAgICAgICAgICBjID0gYi5jdXJyZW50O1xyXG4gICAgICAgICAgICB2YXIgZyA9IGMud3JhcFNwYWNlLCBoID0gYy5za2luU3BhY2U7XHJcbiAgICAgICAgICAgIGlmIChcIndpZHRoXCIgPT09IGYgfHwgXCJoZWlnaHRcIiA9PT0gZilcclxuICAgICAgICAgICAgICAgIGUgPSBkLmVuZCA9PT0gZC5zdGFydCA/IDEgOiAoYSAtIGQuc3RhcnQpIC8gKGQuZW5kIC0gZC5zdGFydCksIGIuaXNDbG9zaW5nICYmIChlID0gMSAtIGUpLCBjID0gXCJ3aWR0aFwiID09PSBmID8gYy53UGFkZGluZyA6IGMuaFBhZGRpbmcsIGMgPSBhIC0gYywgYi5za2luW2ZdKGwoXCJ3aWR0aFwiID09PSBmID8gYyA6IGMgLSBnICogZSkpLCBiLmlubmVyW2ZdKGwoXCJ3aWR0aFwiID09PVxyXG4gICAgICAgICAgICAgICAgZiA/IGMgOiBjIC0gZyAqIGUgLSBoICogZSkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgem9vbUluOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBiLmN1cnJlbnQsIGQgPSBhLnBvcywgZSA9IGEub3BlbkVmZmVjdCwgYyA9IFwiZWxhc3RpY1wiID09PSBlLCBrID0gZi5leHRlbmQoeyBvcGFjaXR5OiAxIH0sIGQpO1xyXG4gICAgICAgICAgICBkZWxldGUgay5wb3NpdGlvbjtcclxuICAgICAgICAgICAgYyA/IChkID0gdGhpcy5nZXRPcmlnUG9zaXRpb24oKSwgYS5vcGVuT3BhY2l0eSAmJiAoZC5vcGFjaXR5ID0gMC4xKSkgOiBcImZhZGVcIiA9PT0gZSAmJiAoZC5vcGFjaXR5ID0gMC4xKTtcclxuICAgICAgICAgICAgYi53cmFwLmNzcyhkKS5hbmltYXRlKGssIHsgZHVyYXRpb246IFwibm9uZVwiID09PSBlID8gMCA6IGEub3BlblNwZWVkLCBlYXNpbmc6IGEub3BlbkVhc2luZywgc3RlcDogYyA/IHRoaXMuc3RlcCA6IG51bGwsIGNvbXBsZXRlOiBiLl9hZnRlclpvb21JbiB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHpvb21PdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGIuY3VycmVudCwgZCA9IGEuY2xvc2VFZmZlY3QsIGUgPSBcImVsYXN0aWNcIiA9PT0gZCwgYyA9IHsgb3BhY2l0eTogMC4xIH07XHJcbiAgICAgICAgICAgIGUgJiYgKGMgPSB0aGlzLmdldE9yaWdQb3NpdGlvbigpLCBhLmNsb3NlT3BhY2l0eSAmJiAoYy5vcGFjaXR5ID0gMC4xKSk7XHJcbiAgICAgICAgICAgIGIud3JhcC5hbmltYXRlKGMsXHJcbiAgICAgICAgICAgICAgICB7IGR1cmF0aW9uOiBcIm5vbmVcIiA9PT0gZCA/IDAgOiBhLmNsb3NlU3BlZWQsIGVhc2luZzogYS5jbG9zZUVhc2luZywgc3RlcDogZSA/IHRoaXMuc3RlcCA6IG51bGwsIGNvbXBsZXRlOiBiLl9hZnRlclpvb21PdXQgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjaGFuZ2VJbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gYi5jdXJyZW50LCBkID0gYS5uZXh0RWZmZWN0LCBlID0gYS5wb3MsIGMgPSB7IG9wYWNpdHk6IDEgfSwgZiA9IGIuZGlyZWN0aW9uLCBnO1xyXG4gICAgICAgICAgICBlLm9wYWNpdHkgPSAwLjE7XHJcbiAgICAgICAgICAgIFwiZWxhc3RpY1wiID09PSBkICYmIChnID0gXCJkb3duXCIgPT09IGYgfHwgXCJ1cFwiID09PSBmID8gXCJ0b3BcIiA6IFwibGVmdFwiLCBcImRvd25cIiA9PT0gZiB8fCBcInJpZ2h0XCIgPT09IGYgPyAoZVtnXSA9IHcobChlW2ddKSAtIDIwMCksIGNbZ10gPSBcIis9MjAwcHhcIikgOiAoZVtnXSA9IHcobChlW2ddKSArIDIwMCksIGNbZ10gPSBcIi09MjAwcHhcIikpO1xyXG4gICAgICAgICAgICBcIm5vbmVcIiA9PT0gZCA/IGIuX2FmdGVyWm9vbUluKCkgOiBiLndyYXAuY3NzKGUpLmFuaW1hdGUoYywgeyBkdXJhdGlvbjogYS5uZXh0U3BlZWQsIGVhc2luZzogYS5uZXh0RWFzaW5nLCBjb21wbGV0ZTogYi5fYWZ0ZXJab29tSW4gfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjaGFuZ2VPdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9XHJcbiAgICAgICAgICAgICAgICAgICAgYi5wcmV2aW91cyxcclxuICAgICAgICAgICAgICAgIGQgPSBhLnByZXZFZmZlY3QsXHJcbiAgICAgICAgICAgICAgICBlID0geyBvcGFjaXR5OiAwLjEgfSxcclxuICAgICAgICAgICAgICAgIGMgPSBiLmRpcmVjdGlvbjtcclxuICAgICAgICAgICAgXCJlbGFzdGljXCIgPT09IGQgJiYgKGVbXCJkb3duXCIgPT09IGMgfHwgXCJ1cFwiID09PSBjID8gXCJ0b3BcIiA6IFwibGVmdFwiXSA9IChcInVwXCIgPT09IGMgfHwgXCJsZWZ0XCIgPT09IGMgPyBcIi1cIiA6IFwiK1wiKSArIFwiPTIwMHB4XCIpO1xyXG4gICAgICAgICAgICBhLndyYXAuYW5pbWF0ZShlLCB7IGR1cmF0aW9uOiBcIm5vbmVcIiA9PT0gZCA/IDAgOiBhLnByZXZTcGVlZCwgZWFzaW5nOiBhLnByZXZFYXNpbmcsIGNvbXBsZXRlOiBmdW5jdGlvbigpIHsgZih0aGlzKS50cmlnZ2VyKFwib25SZXNldFwiKS5yZW1vdmUoKTsgfSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgYi5oZWxwZXJzLm92ZXJsYXkgPSB7XHJcbiAgICAgICAgZGVmYXVsdHM6IHsgY2xvc2VDbGljazogITAsIHNwZWVkT3V0OiAyMDAsIHNob3dFYXJseTogITAsIGNzczoge30sIGxvY2tlZDogIXMsIGZpeGVkOiAhMCB9LFxyXG4gICAgICAgIG92ZXJsYXk6IG51bGwsXHJcbiAgICAgICAgZml4ZWQ6ICExLFxyXG4gICAgICAgIGVsOiBmKFwiaHRtbFwiKSxcclxuICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKGEpIHtcclxuICAgICAgICAgICAgYSA9IGYuZXh0ZW5kKHt9LCB0aGlzLmRlZmF1bHRzLCBhKTtcclxuICAgICAgICAgICAgdGhpcy5vdmVybGF5ICYmIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgdGhpcy5vdmVybGF5ID1cclxuICAgICAgICAgICAgICAgIGYoJzxkaXYgY2xhc3M9XCJmYW5jeWJveC1vdmVybGF5XCI+PC9kaXY+JykuYXBwZW5kVG8oYi5jb21pbmcgPyBiLmNvbWluZy5wYXJlbnQgOiBhLnBhcmVudCk7XHJcbiAgICAgICAgICAgIHRoaXMuZml4ZWQgPSAhMTtcclxuICAgICAgICAgICAgYS5maXhlZCAmJiBiLmRlZmF1bHRzLmZpeGVkICYmICh0aGlzLm92ZXJsYXkuYWRkQ2xhc3MoXCJmYW5jeWJveC1vdmVybGF5LWZpeGVkXCIpLCB0aGlzLmZpeGVkID0gITApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb3BlbjogZnVuY3Rpb24oYSkge1xyXG4gICAgICAgICAgICB2YXIgZCA9IHRoaXM7XHJcbiAgICAgICAgICAgIGEgPSBmLmV4dGVuZCh7fSwgdGhpcy5kZWZhdWx0cywgYSk7XHJcbiAgICAgICAgICAgIHRoaXMub3ZlcmxheSA/IHRoaXMub3ZlcmxheS51bmJpbmQoXCIub3ZlcmxheVwiKS53aWR0aChcImF1dG9cIikuaGVpZ2h0KFwiYXV0b1wiKSA6IHRoaXMuY3JlYXRlKGEpO1xyXG4gICAgICAgICAgICB0aGlzLmZpeGVkIHx8IChuLmJpbmQoXCJyZXNpemUub3ZlcmxheVwiLCBmLnByb3h5KHRoaXMudXBkYXRlLCB0aGlzKSksIHRoaXMudXBkYXRlKCkpO1xyXG4gICAgICAgICAgICBhLmNsb3NlQ2xpY2sgJiYgdGhpcy5vdmVybGF5LmJpbmQoXCJjbGljay5vdmVybGF5XCIsIGZ1bmN0aW9uKGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmKGEudGFyZ2V0KS5oYXNDbGFzcyhcImZhbmN5Ym94LW92ZXJsYXlcIikpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIuaXNBY3RpdmUgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLmNsb3NlKCkgOiBkLmNsb3NlKCksICExO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5vdmVybGF5LmNzcyhhLmNzcykuc2hvdygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2xvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYSwgYjtcclxuICAgICAgICAgICAgbi51bmJpbmQoXCJyZXNpemUub3ZlcmxheVwiKTtcclxuICAgICAgICAgICAgdGhpcy5lbC5oYXNDbGFzcyhcImZhbmN5Ym94LWxvY2tcIikgJiYgKGYoXCIuZmFuY3lib3gtbWFyZ2luXCIpLnJlbW92ZUNsYXNzKFwiZmFuY3lib3gtbWFyZ2luXCIpLCBhID0gbi5zY3JvbGxUb3AoKSwgYiA9IG4uc2Nyb2xsTGVmdCgpLCB0aGlzLmVsLnJlbW92ZUNsYXNzKFwiZmFuY3lib3gtbG9ja1wiKSwgbi5zY3JvbGxUb3AoYSkuc2Nyb2xsTGVmdChiKSk7XHJcbiAgICAgICAgICAgIGYoXCIuZmFuY3lib3gtb3ZlcmxheVwiKS5yZW1vdmUoKS5oaWRlKCk7XHJcbiAgICAgICAgICAgIGYuZXh0ZW5kKHRoaXMsIHsgb3ZlcmxheTogbnVsbCwgZml4ZWQ6ICExIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBcIjEwMCVcIiwgYjtcclxuICAgICAgICAgICAgdGhpcy5vdmVybGF5LndpZHRoKGEpLmhlaWdodChcIjEwMCVcIik7XHJcbiAgICAgICAgICAgIEkgPyAoYiA9IE1hdGgubWF4KEcuZG9jdW1lbnRFbGVtZW50Lm9mZnNldFdpZHRoLCBHLmJvZHkub2Zmc2V0V2lkdGgpLFxyXG4gICAgICAgICAgICBwLndpZHRoKCkgPiBiICYmIChhID0gcC53aWR0aCgpKSkgOiBwLndpZHRoKCkgPiBuLndpZHRoKCkgJiYgKGEgPSBwLndpZHRoKCkpO1xyXG4gICAgICAgICAgICB0aGlzLm92ZXJsYXkud2lkdGgoYSkuaGVpZ2h0KHAuaGVpZ2h0KCkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25SZWFkeTogZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgZSA9IHRoaXMub3ZlcmxheTtcclxuICAgICAgICAgICAgZihcIi5mYW5jeWJveC1vdmVybGF5XCIpLnN0b3AoITAsICEwKTtcclxuICAgICAgICAgICAgZSB8fCB0aGlzLmNyZWF0ZShhKTtcclxuICAgICAgICAgICAgYS5sb2NrZWQgJiYgKHRoaXMuZml4ZWQgJiYgYi5maXhlZCkgJiYgKGUgfHwgKHRoaXMubWFyZ2luID0gcC5oZWlnaHQoKSA+IG4uaGVpZ2h0KCkgPyBmKFwiaHRtbFwiKS5jc3MoXCJtYXJnaW4tcmlnaHRcIikucmVwbGFjZShcInB4XCIsIFwiXCIpIDogITEpLCBiLmxvY2tlZCA9IHRoaXMub3ZlcmxheS5hcHBlbmQoYi53cmFwKSwgYi5maXhlZCA9ICExKTtcclxuICAgICAgICAgICAgITAgPT09IGEuc2hvd0Vhcmx5ICYmIHRoaXMuYmVmb3JlU2hvdy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYmVmb3JlU2hvdzogZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgZSwgYztcclxuICAgICAgICAgICAgYi5sb2NrZWQgJiYgKCExICE9PSB0aGlzLm1hcmdpbiAmJiAoZihcIipcIikuZmlsdGVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXCJmaXhlZFwiID09PVxyXG4gICAgICAgICAgICAgICAgICAgIGYodGhpcykuY3NzKFwicG9zaXRpb25cIikgJiYgIWYodGhpcykuaGFzQ2xhc3MoXCJmYW5jeWJveC1vdmVybGF5XCIpICYmICFmKHRoaXMpLmhhc0NsYXNzKFwiZmFuY3lib3gtd3JhcFwiKTtcclxuICAgICAgICAgICAgfSkuYWRkQ2xhc3MoXCJmYW5jeWJveC1tYXJnaW5cIiksIHRoaXMuZWwuYWRkQ2xhc3MoXCJmYW5jeWJveC1tYXJnaW5cIikpLCBlID0gbi5zY3JvbGxUb3AoKSwgYyA9IG4uc2Nyb2xsTGVmdCgpLCB0aGlzLmVsLmFkZENsYXNzKFwiZmFuY3lib3gtbG9ja1wiKSwgbi5zY3JvbGxUb3AoZSkuc2Nyb2xsTGVmdChjKSk7XHJcbiAgICAgICAgICAgIHRoaXMub3BlbihhKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uVXBkYXRlOiBmdW5jdGlvbigpIHsgdGhpcy5maXhlZCB8fCB0aGlzLnVwZGF0ZSgpOyB9LFxyXG4gICAgICAgIGFmdGVyQ2xvc2U6IGZ1bmN0aW9uKGEpIHsgdGhpcy5vdmVybGF5ICYmICFiLmNvbWluZyAmJiB0aGlzLm92ZXJsYXkuZmFkZU91dChhLnNwZWVkT3V0LCBmLnByb3h5KHRoaXMuY2xvc2UsIHRoaXMpKTsgfVxyXG4gICAgfTtcclxuICAgIGIuaGVscGVycy50aXRsZSA9IHtcclxuICAgICAgICBkZWZhdWx0czogeyB0eXBlOiBcImZsb2F0XCIsIHBvc2l0aW9uOiBcImJvdHRvbVwiIH0sXHJcbiAgICAgICAgYmVmb3JlU2hvdzogZnVuY3Rpb24oYSkge1xyXG4gICAgICAgICAgICB2YXIgZCA9XHJcbiAgICAgICAgICAgICAgICAgICAgYi5jdXJyZW50LFxyXG4gICAgICAgICAgICAgICAgZSA9IGQudGl0bGUsXHJcbiAgICAgICAgICAgICAgICBjID0gYS50eXBlO1xyXG4gICAgICAgICAgICBmLmlzRnVuY3Rpb24oZSkgJiYgKGUgPSBlLmNhbGwoZC5lbGVtZW50LCBkKSk7XHJcbiAgICAgICAgICAgIGlmIChxKGUpICYmIFwiXCIgIT09IGYudHJpbShlKSkge1xyXG4gICAgICAgICAgICAgICAgZCA9IGYoJzxkaXYgY2xhc3M9XCJmYW5jeWJveC10aXRsZSBmYW5jeWJveC10aXRsZS0nICsgYyArICctd3JhcFwiPicgKyBlICsgXCI8L2Rpdj5cIik7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW5zaWRlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBiLnNraW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJvdXRzaWRlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBiLndyYXA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJvdmVyXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBiLmlubmVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjID0gYi5za2luLCBkLmFwcGVuZFRvKFwiYm9keVwiKSwgSSAmJiBkLndpZHRoKGQud2lkdGgoKSksIGQud3JhcElubmVyKCc8c3BhbiBjbGFzcz1cImNoaWxkXCI+PC9zcGFuPicpLCBiLmN1cnJlbnQubWFyZ2luWzJdICs9IE1hdGguYWJzKGwoZC5jc3MoXCJtYXJnaW4tYm90dG9tXCIpKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBkW1widG9wXCIgPT09IGEucG9zaXRpb24gPyBcInByZXBlbmRUb1wiIDogXCJhcHBlbmRUb1wiXShjKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBmLmZuLmZhbmN5Ym94ID0gZnVuY3Rpb24oYSkge1xyXG4gICAgICAgIHZhciBkLFxyXG4gICAgICAgICAgICBlID0gZih0aGlzKSxcclxuICAgICAgICAgICAgYyA9IHRoaXMuc2VsZWN0b3IgfHwgXCJcIixcclxuICAgICAgICAgICAgayA9IGZ1bmN0aW9uKGcpIHtcclxuICAgICAgICAgICAgICAgIHZhciBoID0gZih0aGlzKS5ibHVyKCksIGogPSBkLCBrLCBsO1xyXG4gICAgICAgICAgICAgICAgIWcuY3RybEtleSAmJiAoIWcuYWx0S2V5ICYmICFnLnNoaWZ0S2V5ICYmICFnLm1ldGFLZXkpICYmICFoLmlzKFwiLmZhbmN5Ym94LXdyYXBcIikgJiYgKGsgPSBhLmdyb3VwQXR0ciB8fCBcImRhdGEtZmFuY3lib3gtZ3JvdXBcIiwgbCA9IGguYXR0cihrKSwgbCB8fCAoayA9IFwicmVsXCIsIGwgPSBoLmdldCgwKVtrXSksIGwgJiYgKFwiXCIgIT09IGwgJiYgXCJub2ZvbGxvd1wiICE9PSBsKSAmJiAoaCA9IGMubGVuZ3RoID8gZihjKSA6IGUsIGggPSBoLmZpbHRlcihcIltcIiArIGsgKyAnPVwiJyArIGwgKyAnXCJdJyksIGogPSBoLmluZGV4KHRoaXMpKSwgYS5pbmRleCA9IGosICExICE9PSBiLm9wZW4oaCwgYSkgJiYgZy5wcmV2ZW50RGVmYXVsdCgpKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICBhID0gYSB8fCB7fTtcclxuICAgICAgICBkID0gYS5pbmRleCB8fCAwO1xyXG4gICAgICAgICFjIHx8ICExID09PSBhLmxpdmUgPyBlLnVuYmluZChcImNsaWNrLmZiLXN0YXJ0XCIpLmJpbmQoXCJjbGljay5mYi1zdGFydFwiLCBrKSA6IHAudW5kZWxlZ2F0ZShjLCBcImNsaWNrLmZiLXN0YXJ0XCIpLmRlbGVnYXRlKGMgK1xyXG4gICAgICAgIFwiOm5vdCgnLmZhbmN5Ym94LWl0ZW0sIC5mYW5jeWJveC1uYXYnKVwiLCBcImNsaWNrLmZiLXN0YXJ0XCIsIGspO1xyXG4gICAgICAgIHRoaXMuZmlsdGVyKFwiW2RhdGEtZmFuY3lib3gtc3RhcnQ9MV1cIikudHJpZ2dlcihcImNsaWNrXCIpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIHAucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGEsIGQ7XHJcbiAgICAgICAgZi5zY3JvbGxiYXJXaWR0aCA9PT0gdiAmJiAoZi5zY3JvbGxiYXJXaWR0aCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGYoJzxkaXYgc3R5bGU9XCJ3aWR0aDo1MHB4O2hlaWdodDo1MHB4O292ZXJmbG93OmF1dG9cIj48ZGl2Lz48L2Rpdj4nKS5hcHBlbmRUbyhcImJvZHlcIiksIGIgPSBhLmNoaWxkcmVuKCksIGIgPSBiLmlubmVyV2lkdGgoKSAtIGIuaGVpZ2h0KDk5KS5pbm5lcldpZHRoKCk7XHJcbiAgICAgICAgICAgIGEucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBiO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChmLnN1cHBvcnQuZml4ZWRQb3NpdGlvbiA9PT0gdikge1xyXG4gICAgICAgICAgICBhID0gZi5zdXBwb3J0O1xyXG4gICAgICAgICAgICBkID0gZignPGRpdiBzdHlsZT1cInBvc2l0aW9uOmZpeGVkO3RvcDoyMHB4O1wiPjwvZGl2PicpLmFwcGVuZFRvKFwiYm9keVwiKTtcclxuICAgICAgICAgICAgdmFyIGUgPSAyMCA9PT1cclxuICAgICAgICAgICAgICAgIGRbMF0ub2Zmc2V0VG9wIHx8IDE1ID09PSBkWzBdLm9mZnNldFRvcDtcclxuICAgICAgICAgICAgZC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgYS5maXhlZFBvc2l0aW9uID0gZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZi5leHRlbmQoYi5kZWZhdWx0cywgeyBzY3JvbGxiYXJXaWR0aDogZi5zY3JvbGxiYXJXaWR0aCgpLCBmaXhlZDogZi5zdXBwb3J0LmZpeGVkUG9zaXRpb24sIHBhcmVudDogZihcImJvZHlcIikgfSk7XHJcbiAgICAgICAgYSA9IGYocikud2lkdGgoKTtcclxuICAgICAgICBKLmFkZENsYXNzKFwiZmFuY3lib3gtbG9jay10ZXN0XCIpO1xyXG4gICAgICAgIGQgPSBmKHIpLndpZHRoKCk7XHJcbiAgICAgICAgSi5yZW1vdmVDbGFzcyhcImZhbmN5Ym94LWxvY2stdGVzdFwiKTtcclxuICAgICAgICBmKFwiPHN0eWxlIHR5cGU9J3RleHQvY3NzJz4uZmFuY3lib3gtbWFyZ2lue21hcmdpbi1yaWdodDpcIiArIChkIC0gYSkgKyBcInB4O308L3N0eWxlPlwiKS5hcHBlbmRUbyhcImhlYWRcIik7XHJcbiAgICB9KTtcclxufSkod2luZG93LCBkb2N1bWVudCwgalF1ZXJ5KTsiLCIvLyBPcGVudGlwIHYyLjQuNlxyXG4vLyBDb3B5cmlnaHQgKGMpIDIwMDktMjAxMlxyXG4vLyB3d3cub3BlbnRpcC5vcmdcclxuLy8gTUlUIExpY2Vuc2VkXHJcbnZhciBPcGVudGlwLGZpcnN0QWRhcHRlcixpLG1vdXNlTW92ZWQsbW91c2VQb3NpdGlvbixtb3VzZVBvc2l0aW9uT2JzZXJ2ZXJzLHBvc2l0aW9uLHZlbmRvcnMsX2ksX2xlbixfcmVmLF9fc2xpY2U9W10uc2xpY2UsX19pbmRleE9mPVtdLmluZGV4T2Z8fGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9dGhpcy5sZW5ndGg7aT5lO2UrKylpZihlIGluIHRoaXMmJnRoaXNbZV09PT10KXJldHVybiBlO3JldHVybi0xfSxfX2hhc1Byb3A9e30uaGFzT3duUHJvcGVydHk7Zm9yKE9wZW50aXA9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsaSxvLHMpe3ZhciBuLHIsYSxoLHAsZCxsLHUsYyxnLGYsbSx2LGIsdz10aGlzO2lmKHRoaXMuaWQ9Kyt0Lmxhc3RJZCx0aGlzLmRlYnVnKFwiQ3JlYXRpbmcgT3BlbnRpcC5cIiksdC50aXBzLnB1c2godGhpcyksdGhpcy5hZGFwdGVyPXQuYWRhcHRlcixuPXRoaXMuYWRhcHRlci5kYXRhKGUsXCJvcGVudGlwc1wiKXx8W10sbi5wdXNoKHRoaXMpLHRoaXMuYWRhcHRlci5kYXRhKGUsXCJvcGVudGlwc1wiLG4pLHRoaXMudHJpZ2dlckVsZW1lbnQ9dGhpcy5hZGFwdGVyLndyYXAoZSksdGhpcy50cmlnZ2VyRWxlbWVudC5sZW5ndGg+MSl0aHJvdyBFcnJvcihcIllvdSBjYW4ndCBjYWxsIE9wZW50aXAgb24gbXVsdGlwbGUgZWxlbWVudHMuXCIpO2lmKDE+dGhpcy50cmlnZ2VyRWxlbWVudC5sZW5ndGgpdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGVsZW1lbnQuXCIpO3RoaXMubG9hZGVkPSExLHRoaXMubG9hZGluZz0hMSx0aGlzLnZpc2libGU9ITEsdGhpcy53YWl0aW5nVG9TaG93PSExLHRoaXMud2FpdGluZ1RvSGlkZT0hMSx0aGlzLmN1cnJlbnRQb3NpdGlvbj17bGVmdDowLHRvcDowfSx0aGlzLmRpbWVuc2lvbnM9e3dpZHRoOjEwMCxoZWlnaHQ6NTB9LHRoaXMuY29udGVudD1cIlwiLHRoaXMucmVkcmF3PSEwLHRoaXMuY3VycmVudE9ic2VydmVycz17c2hvd2luZzohMSx2aXNpYmxlOiExLGhpZGluZzohMSxoaWRkZW46ITF9LHM9dGhpcy5hZGFwdGVyLmNsb25lKHMpLHR5cGVvZiBpPT1cIm9iamVjdFwiPyhzPWksaT1vPXZvaWQgMCk6dHlwZW9mIG89PVwib2JqZWN0XCImJihzPW8sbz12b2lkIDApLG8hPW51bGwmJihzLnRpdGxlPW8pLGkhPW51bGwmJnRoaXMuc2V0Q29udGVudChpKSxzW1wiZXh0ZW5kc1wiXT09bnVsbCYmKHNbXCJleHRlbmRzXCJdPXMuc3R5bGUhPW51bGw/cy5zdHlsZTp0LmRlZmF1bHRTdHlsZSksaD1bc10sYj1zO3doaWxlKGJbXCJleHRlbmRzXCJdKXtpZihkPWJbXCJleHRlbmRzXCJdLGI9dC5zdHlsZXNbZF0sYj09bnVsbCl0aHJvdyBFcnJvcihcIkludmFsaWQgc3R5bGU6IFwiK2QpO2gudW5zaGlmdChiKSxiW1wiZXh0ZW5kc1wiXT09bnVsbCYmZCE9PVwic3RhbmRhcmRcIiYmKGJbXCJleHRlbmRzXCJdPVwic3RhbmRhcmRcIil9Zm9yKHM9KGY9dGhpcy5hZGFwdGVyKS5leHRlbmQuYXBwbHkoZixbe31dLmNvbmNhdChfX3NsaWNlLmNhbGwoaCkpKSxzLmhpZGVUcmlnZ2Vycz1mdW5jdGlvbigpe3ZhciB0LGUsaSxvO2ZvcihpPXMuaGlkZVRyaWdnZXJzLG89W10sdD0wLGU9aS5sZW5ndGg7ZT50O3QrKylyPWlbdF0sby5wdXNoKHIpO3JldHVybiBvfSgpLHMuaGlkZVRyaWdnZXImJnMuaGlkZVRyaWdnZXJzLmxlbmd0aD09PTAmJnMuaGlkZVRyaWdnZXJzLnB1c2gocy5oaWRlVHJpZ2dlciksbT1bXCJ0aXBKb2ludFwiLFwidGFyZ2V0Sm9pbnRcIixcInN0ZW1cIl0sbD0wLGM9bS5sZW5ndGg7Yz5sO2wrKylwPW1bbF0sc1twXSYmdHlwZW9mIHNbcF09PVwic3RyaW5nXCImJihzW3BdPW5ldyB0LkpvaW50KHNbcF0pKTtmb3IoIXMuYWpheHx8cy5hamF4IT09ITAmJnMuYWpheHx8KHMuYWpheD10aGlzLmFkYXB0ZXIudGFnTmFtZSh0aGlzLnRyaWdnZXJFbGVtZW50KT09PVwiQVwiP3RoaXMuYWRhcHRlci5hdHRyKHRoaXMudHJpZ2dlckVsZW1lbnQsXCJocmVmXCIpOiExKSxzLnNob3dPbj09PVwiY2xpY2tcIiYmdGhpcy5hZGFwdGVyLnRhZ05hbWUodGhpcy50cmlnZ2VyRWxlbWVudCk9PT1cIkFcIiYmdGhpcy5hZGFwdGVyLm9ic2VydmUodGhpcy50cmlnZ2VyRWxlbWVudCxcImNsaWNrXCIsZnVuY3Rpb24odCl7cmV0dXJuIHQucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLHQuc3RvcHBlZD0hMH0pLHMudGFyZ2V0JiYocy5maXhlZD0hMCkscy5zdGVtPT09ITAmJihzLnN0ZW09bmV3IHQuSm9pbnQocy50aXBKb2ludCkpLHMudGFyZ2V0PT09ITA/cy50YXJnZXQ9dGhpcy50cmlnZ2VyRWxlbWVudDpzLnRhcmdldCYmKHMudGFyZ2V0PXRoaXMuYWRhcHRlci53cmFwKHMudGFyZ2V0KSksdGhpcy5jdXJyZW50U3RlbT1zLnN0ZW0scy5kZWxheT09bnVsbCYmKHMuZGVsYXk9cy5zaG93T249PT1cIm1vdXNlb3ZlclwiPy4yOjApLHMudGFyZ2V0Sm9pbnQ9PW51bGwmJihzLnRhcmdldEpvaW50PW5ldyB0LkpvaW50KHMudGlwSm9pbnQpLmZsaXAoKSksdGhpcy5zaG93VHJpZ2dlcnM9W10sdGhpcy5zaG93VHJpZ2dlcnNXaGVuVmlzaWJsZT1bXSx0aGlzLmhpZGVUcmlnZ2Vycz1bXSxzLnNob3dPbiYmcy5zaG93T24hPT1cImNyZWF0aW9uXCImJnRoaXMuc2hvd1RyaWdnZXJzLnB1c2goe2VsZW1lbnQ6dGhpcy50cmlnZ2VyRWxlbWVudCxldmVudDpzLnNob3dPbn0pLHMuYWpheENhY2hlIT1udWxsJiYocy5jYWNoZT1zLmFqYXhDYWNoZSxkZWxldGUgcy5hamF4Q2FjaGUpLHRoaXMub3B0aW9ucz1zLHRoaXMuYm91bmQ9e30sdj1bXCJwcmVwYXJlVG9TaG93XCIsXCJwcmVwYXJlVG9IaWRlXCIsXCJzaG93XCIsXCJoaWRlXCIsXCJyZXBvc2l0aW9uXCJdLHU9MCxnPXYubGVuZ3RoO2c+dTt1KyspYT12W3VdLHRoaXMuYm91bmRbYV09ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHdbdF0uYXBwbHkodyxhcmd1bWVudHMpfX0oYSk7dGhpcy5hZGFwdGVyLmRvbVJlYWR5KGZ1bmN0aW9uKCl7cmV0dXJuIHcuYWN0aXZhdGUoKSx3Lm9wdGlvbnMuc2hvd09uPT09XCJjcmVhdGlvblwiP3cucHJlcGFyZVRvU2hvdygpOnZvaWQgMH0pfXJldHVybiB0LnByb3RvdHlwZS5TVElDS1NfT1VUX1RPUD0xLHQucHJvdG90eXBlLlNUSUNLU19PVVRfQk9UVE9NPTIsdC5wcm90b3R5cGUuU1RJQ0tTX09VVF9MRUZUPTEsdC5wcm90b3R5cGUuU1RJQ0tTX09VVF9SSUdIVD0yLHQucHJvdG90eXBlW1wiY2xhc3NcIl09e2NvbnRhaW5lcjpcIm9wZW50aXAtY29udGFpbmVyXCIsb3BlbnRpcDpcIm9wZW50aXBcIixoZWFkZXI6XCJvdC1oZWFkZXJcIixjb250ZW50Olwib3QtY29udGVudFwiLGxvYWRpbmdJbmRpY2F0b3I6XCJvdC1sb2FkaW5nLWluZGljYXRvclwiLGNsb3NlOlwib3QtY2xvc2VcIixnb2luZ1RvSGlkZTpcIm90LWdvaW5nLXRvLWhpZGVcIixoaWRkZW46XCJvdC1oaWRkZW5cIixoaWRpbmc6XCJvdC1oaWRpbmdcIixnb2luZ1RvU2hvdzpcIm90LWdvaW5nLXRvLXNob3dcIixzaG93aW5nOlwib3Qtc2hvd2luZ1wiLHZpc2libGU6XCJvdC12aXNpYmxlXCIsbG9hZGluZzpcIm90LWxvYWRpbmdcIixhamF4RXJyb3I6XCJvdC1hamF4LWVycm9yXCIsZml4ZWQ6XCJvdC1maXhlZFwiLHNob3dFZmZlY3RQcmVmaXg6XCJvdC1zaG93LWVmZmVjdC1cIixoaWRlRWZmZWN0UHJlZml4Olwib3QtaGlkZS1lZmZlY3QtXCIsc3R5bGVQcmVmaXg6XCJzdHlsZS1cIn0sdC5wcm90b3R5cGUuX3NldHVwPWZ1bmN0aW9uKCl7dmFyIHQsZSxpLG8scyxuLHIsYSxoLHAsZDtmb3IodGhpcy5kZWJ1ZyhcIlNldHRpbmcgdXAgdGhlIHRvb2x0aXAuXCIpLHRoaXMuX2J1aWxkQ29udGFpbmVyKCksdGhpcy5oaWRlVHJpZ2dlcnM9W10saD10aGlzLm9wdGlvbnMuaGlkZVRyaWdnZXJzLG89cz0wLHI9aC5sZW5ndGg7cj5zO289KytzKXtpZihlPWhbb10saT1udWxsLHQ9dGhpcy5vcHRpb25zLmhpZGVPbiBpbnN0YW5jZW9mIEFycmF5P3RoaXMub3B0aW9ucy5oaWRlT25bb106dGhpcy5vcHRpb25zLmhpZGVPbix0eXBlb2YgZT09XCJzdHJpbmdcIilzd2l0Y2goZSl7Y2FzZVwidHJpZ2dlclwiOnQ9dHx8XCJtb3VzZW91dFwiLGk9dGhpcy50cmlnZ2VyRWxlbWVudDticmVhaztjYXNlXCJ0aXBcIjp0PXR8fFwibW91c2VvdmVyXCIsaT10aGlzLmNvbnRhaW5lcjticmVhaztjYXNlXCJ0YXJnZXRcIjp0PXR8fFwibW91c2VvdmVyXCIsaT10aGlzLm9wdGlvbnMudGFyZ2V0O2JyZWFrO2Nhc2VcImNsb3NlQnV0dG9uXCI6YnJlYWs7ZGVmYXVsdDp0aHJvdyBFcnJvcihcIlVua25vd24gaGlkZSB0cmlnZ2VyOiBcIitlK1wiLlwiKX1lbHNlIHQ9dHx8XCJtb3VzZW92ZXJcIixpPXRoaXMuYWRhcHRlci53cmFwKGUpO2kmJnRoaXMuaGlkZVRyaWdnZXJzLnB1c2goe2VsZW1lbnQ6aSxldmVudDp0LG9yaWdpbmFsOmV9KX1mb3IocD10aGlzLmhpZGVUcmlnZ2VycyxkPVtdLG49MCxhPXAubGVuZ3RoO2E+bjtuKyspZT1wW25dLGQucHVzaCh0aGlzLnNob3dUcmlnZ2Vyc1doZW5WaXNpYmxlLnB1c2goe2VsZW1lbnQ6ZS5lbGVtZW50LGV2ZW50OlwibW91c2VvdmVyXCJ9KSk7cmV0dXJuIGR9LHQucHJvdG90eXBlLl9idWlsZENvbnRhaW5lcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRhaW5lcj10aGlzLmFkYXB0ZXIuY3JlYXRlKCc8ZGl2IGlkPVwib3BlbnRpcC0nK3RoaXMuaWQrJ1wiIGNsYXNzPVwiJyt0aGlzW1wiY2xhc3NcIl0uY29udGFpbmVyK1wiIFwiK3RoaXNbXCJjbGFzc1wiXS5oaWRkZW4rXCIgXCIrdGhpc1tcImNsYXNzXCJdLnN0eWxlUHJlZml4K3RoaXMub3B0aW9ucy5jbGFzc05hbWUrJ1wiPjwvZGl2PicpLHRoaXMuYWRhcHRlci5jc3ModGhpcy5jb250YWluZXIse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIn0pLHRoaXMub3B0aW9ucy5hamF4JiZ0aGlzLmFkYXB0ZXIuYWRkQ2xhc3ModGhpcy5jb250YWluZXIsdGhpc1tcImNsYXNzXCJdLmxvYWRpbmcpLHRoaXMub3B0aW9ucy5maXhlZCYmdGhpcy5hZGFwdGVyLmFkZENsYXNzKHRoaXMuY29udGFpbmVyLHRoaXNbXCJjbGFzc1wiXS5maXhlZCksdGhpcy5vcHRpb25zLnNob3dFZmZlY3QmJnRoaXMuYWRhcHRlci5hZGRDbGFzcyh0aGlzLmNvbnRhaW5lcixcIlwiK3RoaXNbXCJjbGFzc1wiXS5zaG93RWZmZWN0UHJlZml4K3RoaXMub3B0aW9ucy5zaG93RWZmZWN0KSx0aGlzLm9wdGlvbnMuaGlkZUVmZmVjdD90aGlzLmFkYXB0ZXIuYWRkQ2xhc3ModGhpcy5jb250YWluZXIsXCJcIit0aGlzW1wiY2xhc3NcIl0uaGlkZUVmZmVjdFByZWZpeCt0aGlzLm9wdGlvbnMuaGlkZUVmZmVjdCk6dm9pZCAwfSx0LnByb3RvdHlwZS5fYnVpbGRFbGVtZW50cz1mdW5jdGlvbigpe3ZhciB0LGU7cmV0dXJuIHRoaXMudG9vbHRpcEVsZW1lbnQ9dGhpcy5hZGFwdGVyLmNyZWF0ZSgnPGRpdiBjbGFzcz1cIicrdGhpc1tcImNsYXNzXCJdLm9wZW50aXArJ1wiPjxkaXYgY2xhc3M9XCInK3RoaXNbXCJjbGFzc1wiXS5oZWFkZXIrJ1wiPjwvZGl2PjxkaXYgY2xhc3M9XCInK3RoaXNbXCJjbGFzc1wiXS5jb250ZW50KydcIj48L2Rpdj48L2Rpdj4nKSx0aGlzLmJhY2tncm91bmRDYW52YXM9dGhpcy5hZGFwdGVyLndyYXAoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSksdGhpcy5hZGFwdGVyLmNzcyh0aGlzLmJhY2tncm91bmRDYW52YXMse3Bvc2l0aW9uOlwiYWJzb2x1dGVcIn0pLHR5cGVvZiBHX3ZtbENhbnZhc01hbmFnZXIhPVwidW5kZWZpbmVkXCImJkdfdm1sQ2FudmFzTWFuYWdlciE9PW51bGwmJkdfdm1sQ2FudmFzTWFuYWdlci5pbml0RWxlbWVudCh0aGlzLmFkYXB0ZXIudW53cmFwKHRoaXMuYmFja2dyb3VuZENhbnZhcykpLHQ9dGhpcy5hZGFwdGVyLmZpbmQodGhpcy50b29sdGlwRWxlbWVudCxcIi5cIit0aGlzW1wiY2xhc3NcIl0uaGVhZGVyKSx0aGlzLm9wdGlvbnMudGl0bGUmJihlPXRoaXMuYWRhcHRlci5jcmVhdGUoXCI8aDE+PC9oMT5cIiksdGhpcy5hZGFwdGVyLnVwZGF0ZShlLHRoaXMub3B0aW9ucy50aXRsZSx0aGlzLm9wdGlvbnMuZXNjYXBlVGl0bGUpLHRoaXMuYWRhcHRlci5hcHBlbmQodCxlKSksdGhpcy5vcHRpb25zLmFqYXgmJiF0aGlzLmxvYWRlZCYmdGhpcy5hZGFwdGVyLmFwcGVuZCh0aGlzLnRvb2x0aXBFbGVtZW50LHRoaXMuYWRhcHRlci5jcmVhdGUoJzxkaXYgY2xhc3M9XCInK3RoaXNbXCJjbGFzc1wiXS5sb2FkaW5nSW5kaWNhdG9yKydcIj48c3Bhbj7ihrs8L3NwYW4+PC9kaXY+JykpLF9faW5kZXhPZi5jYWxsKHRoaXMub3B0aW9ucy5oaWRlVHJpZ2dlcnMsXCJjbG9zZUJ1dHRvblwiKT49MCYmKHRoaXMuY2xvc2VCdXR0b25FbGVtZW50PXRoaXMuYWRhcHRlci5jcmVhdGUoJzxhIGhyZWY9XCJqYXZhc2NyaXB0OnVuZGVmaW5lZDtcIiBjbGFzcz1cIicrdGhpc1tcImNsYXNzXCJdLmNsb3NlKydcIj48c3Bhbj5DbG9zZTwvc3Bhbj48L2E+JyksdGhpcy5hZGFwdGVyLmFwcGVuZCh0LHRoaXMuY2xvc2VCdXR0b25FbGVtZW50KSksdGhpcy5hZGFwdGVyLmFwcGVuZCh0aGlzLmNvbnRhaW5lcix0aGlzLmJhY2tncm91bmRDYW52YXMpLHRoaXMuYWRhcHRlci5hcHBlbmQodGhpcy5jb250YWluZXIsdGhpcy50b29sdGlwRWxlbWVudCksdGhpcy5hZGFwdGVyLmFwcGVuZChkb2N1bWVudC5ib2R5LHRoaXMuY29udGFpbmVyKSx0aGlzLl9uZXdDb250ZW50PSEwLHRoaXMucmVkcmF3PSEwfSx0LnByb3RvdHlwZS5zZXRDb250ZW50PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNvbnRlbnQ9dCx0aGlzLl9uZXdDb250ZW50PSEwLHR5cGVvZiB0aGlzLmNvbnRlbnQ9PVwiZnVuY3Rpb25cIj8odGhpcy5fY29udGVudEZ1bmN0aW9uPXRoaXMuY29udGVudCx0aGlzLmNvbnRlbnQ9XCJcIik6dGhpcy5fY29udGVudEZ1bmN0aW9uPW51bGwsdGhpcy52aXNpYmxlP3RoaXMuX3VwZGF0ZUVsZW1lbnRDb250ZW50KCk6dm9pZCAwfSx0LnByb3RvdHlwZS5fdXBkYXRlRWxlbWVudENvbnRlbnQ9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4odGhpcy5fbmV3Q29udGVudHx8IXRoaXMub3B0aW9ucy5jYWNoZSYmdGhpcy5fY29udGVudEZ1bmN0aW9uKSYmKHQ9dGhpcy5hZGFwdGVyLmZpbmQodGhpcy5jb250YWluZXIsXCIuXCIrdGhpc1tcImNsYXNzXCJdLmNvbnRlbnQpLHQhPW51bGwmJih0aGlzLl9jb250ZW50RnVuY3Rpb24mJih0aGlzLmRlYnVnKFwiRXhlY3V0aW5nIGNvbnRlbnQgZnVuY3Rpb24uXCIpLHRoaXMuY29udGVudD10aGlzLl9jb250ZW50RnVuY3Rpb24odGhpcykpLHRoaXMuYWRhcHRlci51cGRhdGUodCx0aGlzLmNvbnRlbnQsdGhpcy5vcHRpb25zLmVzY2FwZUNvbnRlbnQpKSx0aGlzLl9uZXdDb250ZW50PSExKSx0aGlzLl9zdG9yZUFuZExvY2tEaW1lbnNpb25zKCksdGhpcy5yZXBvc2l0aW9uKCl9LHQucHJvdG90eXBlLl9zdG9yZUFuZExvY2tEaW1lbnNpb25zPWZ1bmN0aW9uKCl7dmFyIHQ7aWYodGhpcy5jb250YWluZXIpcmV0dXJuIHQ9dGhpcy5kaW1lbnNpb25zLHRoaXMuYWRhcHRlci5jc3ModGhpcy5jb250YWluZXIse3dpZHRoOlwiYXV0b1wiLGxlZnQ6XCIwcHhcIix0b3A6XCIwcHhcIn0pLHRoaXMuZGltZW5zaW9ucz10aGlzLmFkYXB0ZXIuZGltZW5zaW9ucyh0aGlzLmNvbnRhaW5lciksdGhpcy5kaW1lbnNpb25zLndpZHRoKz0xLHRoaXMuYWRhcHRlci5jc3ModGhpcy5jb250YWluZXIse3dpZHRoOlwiXCIrdGhpcy5kaW1lbnNpb25zLndpZHRoK1wicHhcIix0b3A6XCJcIit0aGlzLmN1cnJlbnRQb3NpdGlvbi50b3ArXCJweFwiLGxlZnQ6XCJcIit0aGlzLmN1cnJlbnRQb3NpdGlvbi5sZWZ0K1wicHhcIn0pLHRoaXMuX2RpbWVuc2lvbnNFcXVhbCh0aGlzLmRpbWVuc2lvbnMsdCk/dm9pZCAwOih0aGlzLnJlZHJhdz0hMCx0aGlzLl9kcmF3KCkpfSx0LnByb3RvdHlwZS5hY3RpdmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zZXR1cE9ic2VydmVycyhcImhpZGRlblwiLFwiaGlkaW5nXCIpfSx0LnByb3RvdHlwZS5kZWFjdGl2YXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVidWcoXCJEZWFjdGl2YXRpbmcgdG9vbHRpcC5cIiksdGhpcy5oaWRlKCksdGhpcy5fc2V0dXBPYnNlcnZlcnMoXCItc2hvd2luZ1wiLFwiLXZpc2libGVcIixcIi1oaWRkZW5cIixcIi1oaWRpbmdcIil9LHQucHJvdG90eXBlLl9zZXR1cE9ic2VydmVycz1mdW5jdGlvbigpe3ZhciB0LGUsaSxvLHMsbixyLGEsaCxwLGQsbCx1LGMsZyxmLG09dGhpcztmb3Iobz1hcmd1bWVudHMubGVuZ3RoPj0xP19fc2xpY2UuY2FsbChhcmd1bWVudHMsMCk6W10sbj0wLHA9by5sZW5ndGg7cD5uO24rKylpZihpPW9bbl0sZT0hMSxpLmNoYXJBdCgwKT09PVwiLVwiJiYoZT0hMCxpPWkuc3Vic3RyKDEpKSx0aGlzLmN1cnJlbnRPYnNlcnZlcnNbaV0hPT0hZSlzd2l0Y2godGhpcy5jdXJyZW50T2JzZXJ2ZXJzW2ldPSFlLHQ9ZnVuY3Rpb24oKXt2YXIgdCxpLG87cmV0dXJuIHQ9YXJndW1lbnRzLmxlbmd0aD49MT9fX3NsaWNlLmNhbGwoYXJndW1lbnRzLDApOltdLGU/KGk9bS5hZGFwdGVyKS5zdG9wT2JzZXJ2aW5nLmFwcGx5KGksdCk6KG89bS5hZGFwdGVyKS5vYnNlcnZlLmFwcGx5KG8sdCl9LGkpe2Nhc2VcInNob3dpbmdcIjpmb3IoYz10aGlzLmhpZGVUcmlnZ2VycyxyPTAsZD1jLmxlbmd0aDtkPnI7cisrKXM9Y1tyXSx0KHMuZWxlbWVudCxzLmV2ZW50LHRoaXMuYm91bmQucHJlcGFyZVRvSGlkZSk7dChkb2N1bWVudC5vbnJlc2l6ZSE9bnVsbD9kb2N1bWVudDp3aW5kb3csXCJyZXNpemVcIix0aGlzLmJvdW5kLnJlcG9zaXRpb24pLHQod2luZG93LFwic2Nyb2xsXCIsdGhpcy5ib3VuZC5yZXBvc2l0aW9uKTticmVhaztjYXNlXCJ2aXNpYmxlXCI6Zm9yKGc9dGhpcy5zaG93VHJpZ2dlcnNXaGVuVmlzaWJsZSxhPTAsbD1nLmxlbmd0aDtsPmE7YSsrKXM9Z1thXSx0KHMuZWxlbWVudCxzLmV2ZW50LHRoaXMuYm91bmQucHJlcGFyZVRvU2hvdyk7YnJlYWs7Y2FzZVwiaGlkaW5nXCI6Zm9yKGY9dGhpcy5zaG93VHJpZ2dlcnMsaD0wLHU9Zi5sZW5ndGg7dT5oO2grKylzPWZbaF0sdChzLmVsZW1lbnQscy5ldmVudCx0aGlzLmJvdW5kLnByZXBhcmVUb1Nob3cpO2JyZWFrO2Nhc2VcImhpZGRlblwiOmJyZWFrO2RlZmF1bHQ6dGhyb3cgRXJyb3IoXCJVbmtub3duIHN0YXRlOiBcIitpKX1yZXR1cm4gbnVsbH0sdC5wcm90b3R5cGUucHJlcGFyZVRvU2hvdz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hYm9ydEhpZGluZygpLHRoaXMuX2Fib3J0U2hvd2luZygpLHRoaXMudmlzaWJsZT92b2lkIDA6KHRoaXMuZGVidWcoXCJTaG93aW5nIGluIFwiK3RoaXMub3B0aW9ucy5kZWxheStcInMuXCIpLHRoaXMuY29udGFpbmVyPT1udWxsJiZ0aGlzLl9zZXR1cCgpLHRoaXMub3B0aW9ucy5ncm91cCYmdC5fYWJvcnRTaG93aW5nR3JvdXAodGhpcy5vcHRpb25zLmdyb3VwLHRoaXMpLHRoaXMucHJlcGFyaW5nVG9TaG93PSEwLHRoaXMuX3NldHVwT2JzZXJ2ZXJzKFwiLWhpZGRlblwiLFwiLWhpZGluZ1wiLFwic2hvd2luZ1wiKSx0aGlzLl9mb2xsb3dNb3VzZVBvc2l0aW9uKCksdGhpcy5vcHRpb25zLmZpeGVkJiYhdGhpcy5vcHRpb25zLnRhcmdldCYmKHRoaXMuaW5pdGlhbE1vdXNlUG9zaXRpb249bW91c2VQb3NpdGlvbiksdGhpcy5yZXBvc2l0aW9uKCksdGhpcy5fc2hvd1RpbWVvdXRJZD10aGlzLnNldFRpbWVvdXQodGhpcy5ib3VuZC5zaG93LHRoaXMub3B0aW9ucy5kZWxheXx8MCkpfSx0LnByb3RvdHlwZS5zaG93PWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm4gdGhpcy5fYWJvcnRIaWRpbmcoKSx0aGlzLnZpc2libGU/dm9pZCAwOih0aGlzLl9jbGVhclRpbWVvdXRzKCksdGhpcy5fdHJpZ2dlckVsZW1lbnRFeGlzdHMoKT8odGhpcy5kZWJ1ZyhcIlNob3dpbmcgbm93LlwiKSx0aGlzLmNvbnRhaW5lcj09bnVsbCYmdGhpcy5fc2V0dXAoKSx0aGlzLm9wdGlvbnMuZ3JvdXAmJnQuX2hpZGVHcm91cCh0aGlzLm9wdGlvbnMuZ3JvdXAsdGhpcyksdGhpcy52aXNpYmxlPSEwLHRoaXMucHJlcGFyaW5nVG9TaG93PSExLHRoaXMudG9vbHRpcEVsZW1lbnQ9PW51bGwmJnRoaXMuX2J1aWxkRWxlbWVudHMoKSx0aGlzLl91cGRhdGVFbGVtZW50Q29udGVudCgpLCF0aGlzLm9wdGlvbnMuYWpheHx8dGhpcy5sb2FkZWQmJnRoaXMub3B0aW9ucy5jYWNoZXx8dGhpcy5fbG9hZEFqYXgoKSx0aGlzLl9zZWFyY2hBbmRBY3RpdmF0ZUNsb3NlQnV0dG9ucygpLHRoaXMuX3N0YXJ0RW5zdXJlVHJpZ2dlckVsZW1lbnQoKSx0aGlzLmFkYXB0ZXIuY3NzKHRoaXMuY29udGFpbmVyLHt6SW5kZXg6dC5sYXN0WkluZGV4Kyt9KSx0aGlzLl9zZXR1cE9ic2VydmVycyhcIi1oaWRkZW5cIixcIi1oaWRpbmdcIixcIi1zaG93aW5nXCIsXCItdmlzaWJsZVwiLFwic2hvd2luZ1wiLFwidmlzaWJsZVwiKSx0aGlzLm9wdGlvbnMuZml4ZWQmJiF0aGlzLm9wdGlvbnMudGFyZ2V0JiYodGhpcy5pbml0aWFsTW91c2VQb3NpdGlvbj1tb3VzZVBvc2l0aW9uKSx0aGlzLnJlcG9zaXRpb24oKSx0aGlzLmFkYXB0ZXIucmVtb3ZlQ2xhc3ModGhpcy5jb250YWluZXIsdGhpc1tcImNsYXNzXCJdLmhpZGluZyksdGhpcy5hZGFwdGVyLnJlbW92ZUNsYXNzKHRoaXMuY29udGFpbmVyLHRoaXNbXCJjbGFzc1wiXS5oaWRkZW4pLHRoaXMuYWRhcHRlci5hZGRDbGFzcyh0aGlzLmNvbnRhaW5lcix0aGlzW1wiY2xhc3NcIl0uZ29pbmdUb1Nob3cpLHRoaXMuc2V0Q3NzM1N0eWxlKHRoaXMuY29udGFpbmVyLHt0cmFuc2l0aW9uRHVyYXRpb246XCIwc1wifSksdGhpcy5kZWZlcihmdW5jdGlvbigpe3ZhciB0O2lmKGUudmlzaWJsZSYmIWUucHJlcGFyaW5nVG9IaWRlKXJldHVybiBlLmFkYXB0ZXIucmVtb3ZlQ2xhc3MoZS5jb250YWluZXIsZVtcImNsYXNzXCJdLmdvaW5nVG9TaG93KSxlLmFkYXB0ZXIuYWRkQ2xhc3MoZS5jb250YWluZXIsZVtcImNsYXNzXCJdLnNob3dpbmcpLHQ9MCxlLm9wdGlvbnMuc2hvd0VmZmVjdCYmZS5vcHRpb25zLnNob3dFZmZlY3REdXJhdGlvbiYmKHQ9ZS5vcHRpb25zLnNob3dFZmZlY3REdXJhdGlvbiksZS5zZXRDc3MzU3R5bGUoZS5jb250YWluZXIse3RyYW5zaXRpb25EdXJhdGlvbjpcIlwiK3QrXCJzXCJ9KSxlLl92aXNpYmlsaXR5U3RhdGVUaW1lb3V0SWQ9ZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIGUuYWRhcHRlci5yZW1vdmVDbGFzcyhlLmNvbnRhaW5lcixlW1wiY2xhc3NcIl0uc2hvd2luZyksZS5hZGFwdGVyLmFkZENsYXNzKGUuY29udGFpbmVyLGVbXCJjbGFzc1wiXS52aXNpYmxlKX0sdCksZS5fYWN0aXZhdGVGaXJzdElucHV0KCl9KSx0aGlzLl9kcmF3KCkpOnRoaXMuZGVhY3RpdmF0ZSgpKX0sdC5wcm90b3R5cGUuX2Fib3J0U2hvd2luZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnByZXBhcmluZ1RvU2hvdz8odGhpcy5kZWJ1ZyhcIkFib3J0aW5nIHNob3dpbmcuXCIpLHRoaXMuX2NsZWFyVGltZW91dHMoKSx0aGlzLl9zdG9wRm9sbG93aW5nTW91c2VQb3NpdGlvbigpLHRoaXMucHJlcGFyaW5nVG9TaG93PSExLHRoaXMuX3NldHVwT2JzZXJ2ZXJzKFwiLXNob3dpbmdcIixcIi12aXNpYmxlXCIsXCJoaWRpbmdcIixcImhpZGRlblwiKSk6dm9pZCAwfSx0LnByb3RvdHlwZS5wcmVwYXJlVG9IaWRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Fib3J0U2hvd2luZygpLHRoaXMuX2Fib3J0SGlkaW5nKCksdGhpcy52aXNpYmxlPyh0aGlzLmRlYnVnKFwiSGlkaW5nIGluIFwiK3RoaXMub3B0aW9ucy5oaWRlRGVsYXkrXCJzXCIpLHRoaXMucHJlcGFyaW5nVG9IaWRlPSEwLHRoaXMuX3NldHVwT2JzZXJ2ZXJzKFwiLXNob3dpbmdcIixcInZpc2libGVcIixcIi1oaWRkZW5cIixcImhpZGluZ1wiKSx0aGlzLl9oaWRlVGltZW91dElkPXRoaXMuc2V0VGltZW91dCh0aGlzLmJvdW5kLmhpZGUsdGhpcy5vcHRpb25zLmhpZGVEZWxheSkpOnZvaWQgMH0sdC5wcm90b3R5cGUuaGlkZT1mdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMuX2Fib3J0U2hvd2luZygpLHRoaXMudmlzaWJsZSYmKHRoaXMuX2NsZWFyVGltZW91dHMoKSx0aGlzLmRlYnVnKFwiSGlkaW5nIVwiKSx0aGlzLnZpc2libGU9ITEsdGhpcy5wcmVwYXJpbmdUb0hpZGU9ITEsdGhpcy5fc3RvcEVuc3VyZVRyaWdnZXJFbGVtZW50KCksdGhpcy5fc2V0dXBPYnNlcnZlcnMoXCItc2hvd2luZ1wiLFwiLXZpc2libGVcIixcIi1oaWRpbmdcIixcIi1oaWRkZW5cIixcImhpZGluZ1wiLFwiaGlkZGVuXCIpLHRoaXMub3B0aW9ucy5maXhlZHx8dGhpcy5fc3RvcEZvbGxvd2luZ01vdXNlUG9zaXRpb24oKSx0aGlzLmNvbnRhaW5lcik/KHRoaXMuYWRhcHRlci5yZW1vdmVDbGFzcyh0aGlzLmNvbnRhaW5lcix0aGlzW1wiY2xhc3NcIl0udmlzaWJsZSksdGhpcy5hZGFwdGVyLnJlbW92ZUNsYXNzKHRoaXMuY29udGFpbmVyLHRoaXNbXCJjbGFzc1wiXS5zaG93aW5nKSx0aGlzLmFkYXB0ZXIuYWRkQ2xhc3ModGhpcy5jb250YWluZXIsdGhpc1tcImNsYXNzXCJdLmdvaW5nVG9IaWRlKSx0aGlzLnNldENzczNTdHlsZSh0aGlzLmNvbnRhaW5lcix7dHJhbnNpdGlvbkR1cmF0aW9uOlwiMHNcIn0pLHRoaXMuZGVmZXIoZnVuY3Rpb24oKXt2YXIgZTtyZXR1cm4gdC5hZGFwdGVyLnJlbW92ZUNsYXNzKHQuY29udGFpbmVyLHRbXCJjbGFzc1wiXS5nb2luZ1RvSGlkZSksdC5hZGFwdGVyLmFkZENsYXNzKHQuY29udGFpbmVyLHRbXCJjbGFzc1wiXS5oaWRpbmcpLGU9MCx0Lm9wdGlvbnMuaGlkZUVmZmVjdCYmdC5vcHRpb25zLmhpZGVFZmZlY3REdXJhdGlvbiYmKGU9dC5vcHRpb25zLmhpZGVFZmZlY3REdXJhdGlvbiksdC5zZXRDc3MzU3R5bGUodC5jb250YWluZXIse3RyYW5zaXRpb25EdXJhdGlvbjpcIlwiK2UrXCJzXCJ9KSx0Ll92aXNpYmlsaXR5U3RhdGVUaW1lb3V0SWQ9dC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIHQuYWRhcHRlci5yZW1vdmVDbGFzcyh0LmNvbnRhaW5lcix0W1wiY2xhc3NcIl0uaGlkaW5nKSx0LmFkYXB0ZXIuYWRkQ2xhc3ModC5jb250YWluZXIsdFtcImNsYXNzXCJdLmhpZGRlbiksdC5zZXRDc3MzU3R5bGUodC5jb250YWluZXIse3RyYW5zaXRpb25EdXJhdGlvbjpcIjBzXCJ9KSx0Lm9wdGlvbnMucmVtb3ZlRWxlbWVudHNPbkhpZGU/KHQuZGVidWcoXCJSZW1vdmluZyBIVE1MIGVsZW1lbnRzLlwiKSx0LmFkYXB0ZXIucmVtb3ZlKHQuY29udGFpbmVyKSxkZWxldGUgdC5jb250YWluZXIsZGVsZXRlIHQudG9vbHRpcEVsZW1lbnQpOnZvaWQgMH0sZSl9KSk6dm9pZCAwfSx0LnByb3RvdHlwZS5fYWJvcnRIaWRpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmVwYXJpbmdUb0hpZGU/KHRoaXMuZGVidWcoXCJBYm9ydGluZyBoaWRpbmcuXCIpLHRoaXMuX2NsZWFyVGltZW91dHMoKSx0aGlzLnByZXBhcmluZ1RvSGlkZT0hMSx0aGlzLl9zZXR1cE9ic2VydmVycyhcIi1oaWRpbmdcIixcInNob3dpbmdcIixcInZpc2libGVcIikpOnZvaWQgMH0sdC5wcm90b3R5cGUucmVwb3NpdGlvbj1mdW5jdGlvbigpe3ZhciB0LGUsaSxvPXRoaXM7cmV0dXJuIHQ9dGhpcy5nZXRQb3NpdGlvbigpLHQ9PW51bGx8fChlPXRoaXMub3B0aW9ucy5zdGVtLHRoaXMub3B0aW9ucy5jb250YWluSW5WaWV3cG9ydCYmKGk9dGhpcy5fZW5zdXJlVmlld3BvcnRDb250YWlubWVudCh0KSx0PWkucG9zaXRpb24sZT1pLnN0ZW0pLHRoaXMuX3Bvc2l0aW9uc0VxdWFsKHQsdGhpcy5jdXJyZW50UG9zaXRpb24pKT92b2lkIDA6KHRoaXMub3B0aW9ucy5zdGVtJiYhZS5lcWwodGhpcy5jdXJyZW50U3RlbSkmJih0aGlzLnJlZHJhdz0hMCksdGhpcy5jdXJyZW50UG9zaXRpb249dCx0aGlzLmN1cnJlbnRTdGVtPWUsdGhpcy5fZHJhdygpLHRoaXMuYWRhcHRlci5jc3ModGhpcy5jb250YWluZXIse2xlZnQ6XCJcIit0LmxlZnQrXCJweFwiLHRvcDpcIlwiK3QudG9wK1wicHhcIn0pLHRoaXMuZGVmZXIoZnVuY3Rpb24oKXt2YXIgdCxlO3JldHVybiB0PW8uYWRhcHRlci51bndyYXAoby5jb250YWluZXIpLHQuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiLGU9dC5vZmZzZXRIZWlnaHQsdC5zdHlsZS52aXNpYmlsaXR5PVwidmlzaWJsZVwifSkpfSx0LnByb3RvdHlwZS5nZXRQb3NpdGlvbj1mdW5jdGlvbih0LGUsaSl7dmFyIG8scyxuLHIsYSxoLHAsZCxsO2lmKHRoaXMuY29udGFpbmVyKXJldHVybiB0PT1udWxsJiYodD10aGlzLm9wdGlvbnMudGlwSm9pbnQpLGU9PW51bGwmJihlPXRoaXMub3B0aW9ucy50YXJnZXRKb2ludCkscj17fSx0aGlzLm9wdGlvbnMudGFyZ2V0PyhwPXRoaXMuYWRhcHRlci5vZmZzZXQodGhpcy5vcHRpb25zLnRhcmdldCksaD10aGlzLmFkYXB0ZXIuZGltZW5zaW9ucyh0aGlzLm9wdGlvbnMudGFyZ2V0KSxyPXAsZS5yaWdodD8oZD10aGlzLmFkYXB0ZXIudW53cmFwKHRoaXMub3B0aW9ucy50YXJnZXQpLGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0IT1udWxsP3IubGVmdD1kLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0KygobD13aW5kb3cucGFnZVhPZmZzZXQpIT1udWxsP2w6ZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0KTpyLmxlZnQrPWgud2lkdGgpOmUuY2VudGVyJiYoci5sZWZ0Kz1NYXRoLnJvdW5kKGgud2lkdGgvMikpLGUuYm90dG9tP3IudG9wKz1oLmhlaWdodDplLm1pZGRsZSYmKHIudG9wKz1NYXRoLnJvdW5kKGguaGVpZ2h0LzIpKSx0aGlzLm9wdGlvbnMuYm9yZGVyV2lkdGgmJih0aGlzLm9wdGlvbnMudGlwSm9pbnQubGVmdCYmKHIubGVmdCs9dGhpcy5vcHRpb25zLmJvcmRlcldpZHRoKSx0aGlzLm9wdGlvbnMudGlwSm9pbnQucmlnaHQmJihyLmxlZnQtPXRoaXMub3B0aW9ucy5ib3JkZXJXaWR0aCksdGhpcy5vcHRpb25zLnRpcEpvaW50LnRvcD9yLnRvcCs9dGhpcy5vcHRpb25zLmJvcmRlcldpZHRoOnRoaXMub3B0aW9ucy50aXBKb2ludC5ib3R0b20mJihyLnRvcC09dGhpcy5vcHRpb25zLmJvcmRlcldpZHRoKSkpOnI9dGhpcy5pbml0aWFsTW91c2VQb3NpdGlvbj97dG9wOnRoaXMuaW5pdGlhbE1vdXNlUG9zaXRpb24ueSxsZWZ0OnRoaXMuaW5pdGlhbE1vdXNlUG9zaXRpb24ueH06e3RvcDptb3VzZVBvc2l0aW9uLnksbGVmdDptb3VzZVBvc2l0aW9uLnh9LHRoaXMub3B0aW9ucy5hdXRvT2Zmc2V0JiYoYT10aGlzLm9wdGlvbnMuc3RlbT90aGlzLm9wdGlvbnMuc3RlbUxlbmd0aDowLG49YSYmdGhpcy5vcHRpb25zLmZpeGVkPzI6MTAsbz10Lm1pZGRsZSYmIXRoaXMub3B0aW9ucy5maXhlZD8xNTowLHM9dC5jZW50ZXImJiF0aGlzLm9wdGlvbnMuZml4ZWQ/MTU6MCx0LnJpZ2h0P3IubGVmdC09bitvOnQubGVmdCYmKHIubGVmdCs9bitvKSx0LmJvdHRvbT9yLnRvcC09bitzOnQudG9wJiYoci50b3ArPW4rcyksYSYmKGk9PW51bGwmJihpPXRoaXMub3B0aW9ucy5zdGVtKSxpLnJpZ2h0P3IubGVmdC09YTppLmxlZnQmJihyLmxlZnQrPWEpLGkuYm90dG9tP3IudG9wLT1hOmkudG9wJiYoci50b3ArPWEpKSksci5sZWZ0Kz10aGlzLm9wdGlvbnMub2Zmc2V0WzBdLHIudG9wKz10aGlzLm9wdGlvbnMub2Zmc2V0WzFdLHQucmlnaHQ/ci5sZWZ0LT10aGlzLmRpbWVuc2lvbnMud2lkdGg6dC5jZW50ZXImJihyLmxlZnQtPU1hdGgucm91bmQodGhpcy5kaW1lbnNpb25zLndpZHRoLzIpKSx0LmJvdHRvbT9yLnRvcC09dGhpcy5kaW1lbnNpb25zLmhlaWdodDp0Lm1pZGRsZSYmKHIudG9wLT1NYXRoLnJvdW5kKHRoaXMuZGltZW5zaW9ucy5oZWlnaHQvMikpLHJ9LHQucHJvdG90eXBlLl9lbnN1cmVWaWV3cG9ydENvbnRhaW5tZW50PWZ1bmN0aW9uKGUpe3ZhciBpLG8scyxuLHIsYSxoLHAsZCxsLHUsYztpZihoPXRoaXMub3B0aW9ucy5zdGVtLHM9e3Bvc2l0aW9uOmUsc3RlbTpofSwhdGhpcy52aXNpYmxlfHwhZSlyZXR1cm4gcztpZihwPXRoaXMuX3N0aWNrc091dChlKSwhcFswXSYmIXBbMV0pcmV0dXJuIHM7aWYobD1uZXcgdC5Kb2ludCh0aGlzLm9wdGlvbnMudGlwSm9pbnQpLHRoaXMub3B0aW9ucy50YXJnZXRKb2ludCYmKGQ9bmV3IHQuSm9pbnQodGhpcy5vcHRpb25zLnRhcmdldEpvaW50KSksYT10aGlzLmFkYXB0ZXIuc2Nyb2xsT2Zmc2V0KCksdT10aGlzLmFkYXB0ZXIudmlld3BvcnREaW1lbnNpb25zKCksYz1bZS5sZWZ0LWFbMF0sZS50b3AtYVsxXV0saT0hMSx1LndpZHRoPj10aGlzLmRpbWVuc2lvbnMud2lkdGgmJnBbMF0pc3dpdGNoKGk9ITAscFswXSl7Y2FzZSB0aGlzLlNUSUNLU19PVVRfTEVGVDpsLnNldEhvcml6b250YWwoXCJsZWZ0XCIpLHRoaXMub3B0aW9ucy50YXJnZXRKb2ludCYmZC5zZXRIb3Jpem9udGFsKFwicmlnaHRcIik7YnJlYWs7Y2FzZSB0aGlzLlNUSUNLU19PVVRfUklHSFQ6bC5zZXRIb3Jpem9udGFsKFwicmlnaHRcIiksdGhpcy5vcHRpb25zLnRhcmdldEpvaW50JiZkLnNldEhvcml6b250YWwoXCJsZWZ0XCIpfWlmKHUuaGVpZ2h0Pj10aGlzLmRpbWVuc2lvbnMuaGVpZ2h0JiZwWzFdKXN3aXRjaChpPSEwLHBbMV0pe2Nhc2UgdGhpcy5TVElDS1NfT1VUX1RPUDpsLnNldFZlcnRpY2FsKFwidG9wXCIpLHRoaXMub3B0aW9ucy50YXJnZXRKb2ludCYmZC5zZXRWZXJ0aWNhbChcImJvdHRvbVwiKTticmVhaztjYXNlIHRoaXMuU1RJQ0tTX09VVF9CT1RUT006bC5zZXRWZXJ0aWNhbChcImJvdHRvbVwiKSx0aGlzLm9wdGlvbnMudGFyZ2V0Sm9pbnQmJmQuc2V0VmVydGljYWwoXCJ0b3BcIil9cmV0dXJuIGk/KHRoaXMub3B0aW9ucy5zdGVtJiYoaD1sKSxlPXRoaXMuZ2V0UG9zaXRpb24obCxkLGgpLG89dGhpcy5fc3RpY2tzT3V0KGUpLG49ITEscj0hMSxvWzBdJiZvWzBdIT09cFswXSYmKG49ITAsbC5zZXRIb3Jpem9udGFsKHRoaXMub3B0aW9ucy50aXBKb2ludC5ob3Jpem9udGFsKSx0aGlzLm9wdGlvbnMudGFyZ2V0Sm9pbnQmJmQuc2V0SG9yaXpvbnRhbCh0aGlzLm9wdGlvbnMudGFyZ2V0Sm9pbnQuaG9yaXpvbnRhbCkpLG9bMV0mJm9bMV0hPT1wWzFdJiYocj0hMCxsLnNldFZlcnRpY2FsKHRoaXMub3B0aW9ucy50aXBKb2ludC52ZXJ0aWNhbCksdGhpcy5vcHRpb25zLnRhcmdldEpvaW50JiZkLnNldFZlcnRpY2FsKHRoaXMub3B0aW9ucy50YXJnZXRKb2ludC52ZXJ0aWNhbCkpLG4mJnI/czooKG58fHIpJiYodGhpcy5vcHRpb25zLnN0ZW0mJihoPWwpLGU9dGhpcy5nZXRQb3NpdGlvbihsLGQsaCkpLHtwb3NpdGlvbjplLHN0ZW06aH0pKTpzfSx0LnByb3RvdHlwZS5fc3RpY2tzT3V0PWZ1bmN0aW9uKHQpe3ZhciBlLGksbyxzO3JldHVybiBpPXRoaXMuYWRhcHRlci5zY3JvbGxPZmZzZXQoKSxzPXRoaXMuYWRhcHRlci52aWV3cG9ydERpbWVuc2lvbnMoKSxlPVt0LmxlZnQtaVswXSx0LnRvcC1pWzFdXSxvPVshMSwhMV0sMD5lWzBdP29bMF09dGhpcy5TVElDS1NfT1VUX0xFRlQ6ZVswXSt0aGlzLmRpbWVuc2lvbnMud2lkdGg+cy53aWR0aCYmKG9bMF09dGhpcy5TVElDS1NfT1VUX1JJR0hUKSwwPmVbMV0/b1sxXT10aGlzLlNUSUNLU19PVVRfVE9QOmVbMV0rdGhpcy5kaW1lbnNpb25zLmhlaWdodD5zLmhlaWdodCYmKG9bMV09dGhpcy5TVElDS1NfT1VUX0JPVFRPTSksb30sdC5wcm90b3R5cGUuX2RyYXc9ZnVuY3Rpb24oKXt2YXIgZSxpLG8scyxuLHIsYSxoLHAsZCxsLHUsYyxnLGYsbSx2LGIsdyxfPXRoaXM7aWYodGhpcy5iYWNrZ3JvdW5kQ2FudmFzJiZ0aGlzLnJlZHJhdyl7aWYodGhpcy5kZWJ1ZyhcIkRyYXdpbmcgYmFja2dyb3VuZC5cIiksdGhpcy5yZWRyYXc9ITEsdGhpcy5jdXJyZW50U3RlbSl7Zm9yKHY9W1widG9wXCIsXCJyaWdodFwiLFwiYm90dG9tXCIsXCJsZWZ0XCJdLGY9MCxtPXYubGVuZ3RoO20+ZjtmKyspdT12W2ZdLHRoaXMuYWRhcHRlci5yZW1vdmVDbGFzcyh0aGlzLmNvbnRhaW5lcixcInN0ZW0tXCIrdSk7dGhpcy5hZGFwdGVyLmFkZENsYXNzKHRoaXMuY29udGFpbmVyLFwic3RlbS1cIit0aGlzLmN1cnJlbnRTdGVtLmhvcml6b250YWwpLHRoaXMuYWRhcHRlci5hZGRDbGFzcyh0aGlzLmNvbnRhaW5lcixcInN0ZW0tXCIrdGhpcy5jdXJyZW50U3RlbS52ZXJ0aWNhbCl9cmV0dXJuIHI9WzAsMF0sYT1bMCwwXSxfX2luZGV4T2YuY2FsbCh0aGlzLm9wdGlvbnMuaGlkZVRyaWdnZXJzLFwiY2xvc2VCdXR0b25cIik+PTAmJihuPW5ldyB0LkpvaW50KCgoYj10aGlzLmN1cnJlbnRTdGVtKSE9bnVsbD9iK1wiXCI6dm9pZCAwKT09PVwidG9wIHJpZ2h0XCI/XCJ0b3AgbGVmdFwiOlwidG9wIHJpZ2h0XCIpLHI9W3RoaXMub3B0aW9ucy5jbG9zZUJ1dHRvblJhZGl1cyt0aGlzLm9wdGlvbnMuY2xvc2VCdXR0b25PZmZzZXRbMF0sdGhpcy5vcHRpb25zLmNsb3NlQnV0dG9uUmFkaXVzK3RoaXMub3B0aW9ucy5jbG9zZUJ1dHRvbk9mZnNldFsxXV0sYT1bdGhpcy5vcHRpb25zLmNsb3NlQnV0dG9uUmFkaXVzLXRoaXMub3B0aW9ucy5jbG9zZUJ1dHRvbk9mZnNldFswXSx0aGlzLm9wdGlvbnMuY2xvc2VCdXR0b25SYWRpdXMtdGhpcy5vcHRpb25zLmNsb3NlQnV0dG9uT2Zmc2V0WzFdXSksbz10aGlzLmFkYXB0ZXIuY2xvbmUodGhpcy5kaW1lbnNpb25zKSxzPVswLDBdLHRoaXMub3B0aW9ucy5ib3JkZXJXaWR0aCYmKG8ud2lkdGgrPXRoaXMub3B0aW9ucy5ib3JkZXJXaWR0aCoyLG8uaGVpZ2h0Kz10aGlzLm9wdGlvbnMuYm9yZGVyV2lkdGgqMixzWzBdLT10aGlzLm9wdGlvbnMuYm9yZGVyV2lkdGgsc1sxXS09dGhpcy5vcHRpb25zLmJvcmRlcldpZHRoKSx0aGlzLm9wdGlvbnMuc2hhZG93JiYoby53aWR0aCs9dGhpcy5vcHRpb25zLnNoYWRvd0JsdXIqMixvLndpZHRoKz1NYXRoLm1heCgwLHRoaXMub3B0aW9ucy5zaGFkb3dPZmZzZXRbMF0tdGhpcy5vcHRpb25zLnNoYWRvd0JsdXIqMiksby5oZWlnaHQrPXRoaXMub3B0aW9ucy5zaGFkb3dCbHVyKjIsby5oZWlnaHQrPU1hdGgubWF4KDAsdGhpcy5vcHRpb25zLnNoYWRvd09mZnNldFsxXS10aGlzLm9wdGlvbnMuc2hhZG93Qmx1cioyKSxzWzBdLT1NYXRoLm1heCgwLHRoaXMub3B0aW9ucy5zaGFkb3dCbHVyLXRoaXMub3B0aW9ucy5zaGFkb3dPZmZzZXRbMF0pLHNbMV0tPU1hdGgubWF4KDAsdGhpcy5vcHRpb25zLnNoYWRvd0JsdXItdGhpcy5vcHRpb25zLnNoYWRvd09mZnNldFsxXSkpLGk9e2xlZnQ6MCxyaWdodDowLHRvcDowLGJvdHRvbTowfSx0aGlzLmN1cnJlbnRTdGVtJiYodGhpcy5jdXJyZW50U3RlbS5sZWZ0P2kubGVmdD10aGlzLm9wdGlvbnMuc3RlbUxlbmd0aDp0aGlzLmN1cnJlbnRTdGVtLnJpZ2h0JiYoaS5yaWdodD10aGlzLm9wdGlvbnMuc3RlbUxlbmd0aCksdGhpcy5jdXJyZW50U3RlbS50b3A/aS50b3A9dGhpcy5vcHRpb25zLnN0ZW1MZW5ndGg6dGhpcy5jdXJyZW50U3RlbS5ib3R0b20mJihpLmJvdHRvbT10aGlzLm9wdGlvbnMuc3RlbUxlbmd0aCkpLG4mJihuLmxlZnQ/aS5sZWZ0PU1hdGgubWF4KGkubGVmdCxhWzBdKTpuLnJpZ2h0JiYoaS5yaWdodD1NYXRoLm1heChpLnJpZ2h0LGFbMF0pKSxuLnRvcD9pLnRvcD1NYXRoLm1heChpLnRvcCxhWzFdKTpuLmJvdHRvbSYmKGkuYm90dG9tPU1hdGgubWF4KGkuYm90dG9tLGFbMV0pKSksby53aWR0aCs9aS5sZWZ0K2kucmlnaHQsby5oZWlnaHQrPWkudG9wK2kuYm90dG9tLHNbMF0tPWkubGVmdCxzWzFdLT1pLnRvcCx0aGlzLmN1cnJlbnRTdGVtJiZ0aGlzLm9wdGlvbnMuYm9yZGVyV2lkdGgmJih3PXRoaXMuX2dldFBhdGhTdGVtTWVhc3VyZXModGhpcy5vcHRpb25zLnN0ZW1CYXNlLHRoaXMub3B0aW9ucy5zdGVtTGVuZ3RoLHRoaXMub3B0aW9ucy5ib3JkZXJXaWR0aCksZz13LnN0ZW1MZW5ndGgsYz13LnN0ZW1CYXNlKSxlPXRoaXMuYWRhcHRlci51bndyYXAodGhpcy5iYWNrZ3JvdW5kQ2FudmFzKSxlLndpZHRoPW8ud2lkdGgsZS5oZWlnaHQ9by5oZWlnaHQsdGhpcy5hZGFwdGVyLmNzcyh0aGlzLmJhY2tncm91bmRDYW52YXMse3dpZHRoOlwiXCIrZS53aWR0aCtcInB4XCIsaGVpZ2h0OlwiXCIrZS5oZWlnaHQrXCJweFwiLGxlZnQ6XCJcIitzWzBdK1wicHhcIix0b3A6XCJcIitzWzFdK1wicHhcIn0pLGg9ZS5nZXRDb250ZXh0KFwiMmRcIiksaC5zZXRUcmFuc2Zvcm0oMSwwLDAsMSwwLDApLGguY2xlYXJSZWN0KDAsMCxlLndpZHRoLGUuaGVpZ2h0KSxoLmJlZ2luUGF0aCgpLGguZmlsbFN0eWxlPXRoaXMuX2dldENvbG9yKGgsdGhpcy5kaW1lbnNpb25zLHRoaXMub3B0aW9ucy5iYWNrZ3JvdW5kLHRoaXMub3B0aW9ucy5iYWNrZ3JvdW5kR3JhZGllbnRIb3Jpem9udGFsKSxoLmxpbmVKb2luPVwibWl0ZXJcIixoLm1pdGVyTGltaXQ9NTAwLGw9dGhpcy5vcHRpb25zLmJvcmRlcldpZHRoLzIsdGhpcy5vcHRpb25zLmJvcmRlcldpZHRoPyhoLnN0cm9rZVN0eWxlPXRoaXMub3B0aW9ucy5ib3JkZXJDb2xvcixoLmxpbmVXaWR0aD10aGlzLm9wdGlvbnMuYm9yZGVyV2lkdGgpOihnPXRoaXMub3B0aW9ucy5zdGVtTGVuZ3RoLGM9dGhpcy5vcHRpb25zLnN0ZW1CYXNlKSxjPT1udWxsJiYoYz0wKSxkPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gaSYmaC5tb3ZlVG8oTWF0aC5tYXgoYyxfLm9wdGlvbnMuYm9yZGVyUmFkaXVzLHJbMF0pKzEtbCwtbCksZT8oaC5saW5lVG8odC8yLWMvMiwtbCksaC5saW5lVG8odC8yLC1nLWwpLGgubGluZVRvKHQvMitjLzIsLWwpKTp2b2lkIDB9LHA9ZnVuY3Rpb24odCxlLGkpe3ZhciBvLHMsbixhO3JldHVybiB0PyhoLmxpbmVUbygtYytsLDAtbCksaC5saW5lVG8oZytsLC1nLWwpLGgubGluZVRvKGwsYy1sKSk6ZT8oYT1fLm9wdGlvbnMuY2xvc2VCdXR0b25PZmZzZXQsbj1yWzBdLGklMiE9PTAmJihhPVthWzFdLGFbMF1dLG49clsxXSksbz1NYXRoLmFjb3MoYVsxXS9fLm9wdGlvbnMuY2xvc2VCdXR0b25SYWRpdXMpLHM9TWF0aC5hY29zKGFbMF0vXy5vcHRpb25zLmNsb3NlQnV0dG9uUmFkaXVzKSxoLmxpbmVUbygtbitsLC1sKSxoLmFyYyhsLWFbMF0sLWwrYVsxXSxfLm9wdGlvbnMuY2xvc2VCdXR0b25SYWRpdXMsLShNYXRoLlBJLzIrbykscywhMSkpOihoLmxpbmVUbygtXy5vcHRpb25zLmJvcmRlclJhZGl1cytsLC1sKSxoLnF1YWRyYXRpY0N1cnZlVG8obCwtbCxsLF8ub3B0aW9ucy5ib3JkZXJSYWRpdXMtbCkpfSxoLnRyYW5zbGF0ZSgtc1swXSwtc1sxXSksaC5zYXZlKCksZnVuY3Rpb24oKXt2YXIgZSxpLG8scyxyLGEsbCx1LGMsZyxmO2ZvcihmPVtdLGk9Yz0wLGc9dC5wb3NpdGlvbnMubGVuZ3RoLzI7Zz49MD9nPmM6Yz5nO2k9Zz49MD8rK2M6LS1jKXI9aSoyLGE9aT09PTB8fGk9PT0zPzA6Xy5kaW1lbnNpb25zLndpZHRoLGw9Mj5pPzA6Xy5kaW1lbnNpb25zLmhlaWdodCx1PU1hdGguUEkvMippLG89aSUyPT09MD9fLmRpbWVuc2lvbnMud2lkdGg6Xy5kaW1lbnNpb25zLmhlaWdodCxzPW5ldyB0LkpvaW50KHQucG9zaXRpb25zW3JdKSxlPW5ldyB0LkpvaW50KHQucG9zaXRpb25zW3IrMV0pLGguc2F2ZSgpLGgudHJhbnNsYXRlKGEsbCksaC5yb3RhdGUodSksZChvLHMuZXFsKF8uY3VycmVudFN0ZW0pLGk9PT0wKSxoLnRyYW5zbGF0ZShvLDApLHAoZS5lcWwoXy5jdXJyZW50U3RlbSksZS5lcWwobiksaSksZi5wdXNoKGgucmVzdG9yZSgpKTtyZXR1cm4gZn0oKSxoLmNsb3NlUGF0aCgpLGguc2F2ZSgpLHRoaXMub3B0aW9ucy5zaGFkb3cmJihoLnNoYWRvd0NvbG9yPXRoaXMub3B0aW9ucy5zaGFkb3dDb2xvcixoLnNoYWRvd0JsdXI9dGhpcy5vcHRpb25zLnNoYWRvd0JsdXIsaC5zaGFkb3dPZmZzZXRYPXRoaXMub3B0aW9ucy5zaGFkb3dPZmZzZXRbMF0saC5zaGFkb3dPZmZzZXRZPXRoaXMub3B0aW9ucy5zaGFkb3dPZmZzZXRbMV0pLGguZmlsbCgpLGgucmVzdG9yZSgpLHRoaXMub3B0aW9ucy5ib3JkZXJXaWR0aCYmaC5zdHJva2UoKSxoLnJlc3RvcmUoKSxuP2Z1bmN0aW9uKCl7dmFyIHQsZSxpLG8scztyZXR1cm4gaT1lPV8ub3B0aW9ucy5jbG9zZUJ1dHRvblJhZGl1cyoyLG4rXCJcIj09XCJ0b3AgcmlnaHRcIj8ocz1bXy5kaW1lbnNpb25zLndpZHRoLV8ub3B0aW9ucy5jbG9zZUJ1dHRvbk9mZnNldFswXSxfLm9wdGlvbnMuY2xvc2VCdXR0b25PZmZzZXRbMV1dLHQ9W3NbMF0rbCxzWzFdLWxdKToocz1bXy5vcHRpb25zLmNsb3NlQnV0dG9uT2Zmc2V0WzBdLF8ub3B0aW9ucy5jbG9zZUJ1dHRvbk9mZnNldFsxXV0sdD1bc1swXS1sLHNbMV0tbF0pLGgudHJhbnNsYXRlKHRbMF0sdFsxXSksbz1fLm9wdGlvbnMuY2xvc2VCdXR0b25Dcm9zc1NpemUvMixoLnNhdmUoKSxoLmJlZ2luUGF0aCgpLGguc3Ryb2tlU3R5bGU9Xy5vcHRpb25zLmNsb3NlQnV0dG9uQ3Jvc3NDb2xvcixoLmxpbmVXaWR0aD1fLm9wdGlvbnMuY2xvc2VCdXR0b25Dcm9zc0xpbmVXaWR0aCxoLmxpbmVDYXA9XCJyb3VuZFwiLGgubW92ZVRvKC1vLC1vKSxoLmxpbmVUbyhvLG8pLGguc3Ryb2tlKCksaC5iZWdpblBhdGgoKSxoLm1vdmVUbyhvLC1vKSxoLmxpbmVUbygtbyxvKSxoLnN0cm9rZSgpLGgucmVzdG9yZSgpLF8uYWRhcHRlci5jc3MoXy5jbG9zZUJ1dHRvbkVsZW1lbnQse2xlZnQ6XCJcIisoc1swXS1vLV8ub3B0aW9ucy5jbG9zZUJ1dHRvbkxpbmtPdmVyc2NhbikrXCJweFwiLHRvcDpcIlwiKyhzWzFdLW8tXy5vcHRpb25zLmNsb3NlQnV0dG9uTGlua092ZXJzY2FuKStcInB4XCIsd2lkdGg6XCJcIisoXy5vcHRpb25zLmNsb3NlQnV0dG9uQ3Jvc3NTaXplK18ub3B0aW9ucy5jbG9zZUJ1dHRvbkxpbmtPdmVyc2NhbioyKStcInB4XCIsaGVpZ2h0OlwiXCIrKF8ub3B0aW9ucy5jbG9zZUJ1dHRvbkNyb3NzU2l6ZStfLm9wdGlvbnMuY2xvc2VCdXR0b25MaW5rT3ZlcnNjYW4qMikrXCJweFwifSl9KCk6dm9pZCAwfX0sdC5wcm90b3R5cGUuX2dldFBhdGhTdGVtTWVhc3VyZXM9ZnVuY3Rpb24odCxlLGkpe3ZhciBvLHMsbixyLGEsaCxwO2lmKHI9aS8yLG49TWF0aC5hdGFuKHQvMi9lKSxvPW4qMixhPXIvTWF0aC5zaW4obykscz0yKmEqTWF0aC5jb3MobikscD1yK2UtcywwPnApdGhyb3cgRXJyb3IoXCJTb3JyeSBidXQgeW91ciBzdGVtTGVuZ3RoIC8gc3RlbUJhc2UgcmF0aW8gaXMgc3RyYW5nZS5cIik7cmV0dXJuIGg9TWF0aC50YW4obikqcCoyLHtzdGVtTGVuZ3RoOnAsc3RlbUJhc2U6aH19LHQucHJvdG90eXBlLl9nZXRDb2xvcj1mdW5jdGlvbih0LGUsaSxvKXt2YXIgcyxuLHIsYSxoO2lmKG89PW51bGwmJihvPSExKSx0eXBlb2YgaT09XCJzdHJpbmdcIilyZXR1cm4gaTtmb3Iobj1vP3QuY3JlYXRlTGluZWFyR3JhZGllbnQoMCwwLGUud2lkdGgsMCk6dC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLDAsMCxlLmhlaWdodCkscj1hPTAsaD1pLmxlbmd0aDtoPmE7cj0rK2Epcz1pW3JdLG4uYWRkQ29sb3JTdG9wKHNbMF0sc1sxXSk7cmV0dXJuIG59LHQucHJvdG90eXBlLl9zZWFyY2hBbmRBY3RpdmF0ZUNsb3NlQnV0dG9ucz1mdW5jdGlvbigpe3ZhciB0LGUsaSxvO2ZvcihvPXRoaXMuYWRhcHRlci5maW5kQWxsKHRoaXMuY29udGFpbmVyLFwiLlwiK3RoaXNbXCJjbGFzc1wiXS5jbG9zZSksZT0wLGk9by5sZW5ndGg7aT5lO2UrKyl0PW9bZV0sdGhpcy5oaWRlVHJpZ2dlcnMucHVzaCh7ZWxlbWVudDp0aGlzLmFkYXB0ZXIud3JhcCh0KSxldmVudDpcImNsaWNrXCJ9KTtyZXR1cm4gdGhpcy5jdXJyZW50T2JzZXJ2ZXJzLnNob3dpbmcmJnRoaXMuX3NldHVwT2JzZXJ2ZXJzKFwiLXNob3dpbmdcIixcInNob3dpbmdcIiksdGhpcy5jdXJyZW50T2JzZXJ2ZXJzLnZpc2libGU/dGhpcy5fc2V0dXBPYnNlcnZlcnMoXCItdmlzaWJsZVwiLFwidmlzaWJsZVwiKTp2b2lkIDB9LHQucHJvdG90eXBlLl9hY3RpdmF0ZUZpcnN0SW5wdXQ9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdD10aGlzLmFkYXB0ZXIudW53cmFwKHRoaXMuYWRhcHRlci5maW5kKHRoaXMuY29udGFpbmVyLFwiaW5wdXQsIHRleHRhcmVhXCIpKSx0IT1udWxsP3R5cGVvZiB0LmZvY3VzPT1cImZ1bmN0aW9uXCI/dC5mb2N1cygpOnZvaWQgMDp2b2lkIDB9LHQucHJvdG90eXBlLl9mb2xsb3dNb3VzZVBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9ucy5maXhlZD92b2lkIDA6dC5fb2JzZXJ2ZU1vdXNlUG9zaXRpb24odGhpcy5ib3VuZC5yZXBvc2l0aW9uKX0sdC5wcm90b3R5cGUuX3N0b3BGb2xsb3dpbmdNb3VzZVBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9ucy5maXhlZD92b2lkIDA6dC5fc3RvcE9ic2VydmluZ01vdXNlUG9zaXRpb24odGhpcy5ib3VuZC5yZXBvc2l0aW9uKX0sdC5wcm90b3R5cGUuX2NsZWFyU2hvd1RpbWVvdXQ9ZnVuY3Rpb24oKXtyZXR1cm4gY2xlYXJUaW1lb3V0KHRoaXMuX3Nob3dUaW1lb3V0SWQpfSx0LnByb3RvdHlwZS5fY2xlYXJIaWRlVGltZW91dD1mdW5jdGlvbigpe3JldHVybiBjbGVhclRpbWVvdXQodGhpcy5faGlkZVRpbWVvdXRJZCl9LHQucHJvdG90eXBlLl9jbGVhclRpbWVvdXRzPWZ1bmN0aW9uKCl7cmV0dXJuIGNsZWFyVGltZW91dCh0aGlzLl92aXNpYmlsaXR5U3RhdGVUaW1lb3V0SWQpLHRoaXMuX2NsZWFyU2hvd1RpbWVvdXQoKSx0aGlzLl9jbGVhckhpZGVUaW1lb3V0KCl9LHQucHJvdG90eXBlLl90cmlnZ2VyRWxlbWVudEV4aXN0cz1mdW5jdGlvbigpe3ZhciB0O3Q9dGhpcy5hZGFwdGVyLnVud3JhcCh0aGlzLnRyaWdnZXJFbGVtZW50KTt3aGlsZSh0LnBhcmVudE5vZGUpe2lmKHQucGFyZW50Tm9kZS50YWdOYW1lPT09XCJCT0RZXCIpcmV0dXJuITA7dD10LnBhcmVudE5vZGV9cmV0dXJuITF9LHQucHJvdG90eXBlLl9sb2FkQWpheD1mdW5jdGlvbigpe3ZhciB0PXRoaXM7aWYoIXRoaXMubG9hZGluZylyZXR1cm4gdGhpcy5sb2FkZWQ9ITEsdGhpcy5sb2FkaW5nPSEwLHRoaXMuYWRhcHRlci5hZGRDbGFzcyh0aGlzLmNvbnRhaW5lcix0aGlzW1wiY2xhc3NcIl0ubG9hZGluZyksdGhpcy5zZXRDb250ZW50KFwiXCIpLHRoaXMuZGVidWcoXCJMb2FkaW5nIGNvbnRlbnQgZnJvbSBcIit0aGlzLm9wdGlvbnMuYWpheCksdGhpcy5hZGFwdGVyLmFqYXgoe3VybDp0aGlzLm9wdGlvbnMuYWpheCxtZXRob2Q6dGhpcy5vcHRpb25zLmFqYXhNZXRob2Qsb25TdWNjZXNzOmZ1bmN0aW9uKGUpe3JldHVybiB0LmRlYnVnKFwiTG9hZGluZyBzdWNjZXNzZnVsLlwiKSx0LmFkYXB0ZXIucmVtb3ZlQ2xhc3ModC5jb250YWluZXIsdFtcImNsYXNzXCJdLmxvYWRpbmcpLHQuc2V0Q29udGVudChlKX0sb25FcnJvcjpmdW5jdGlvbihlKXt2YXIgaTtyZXR1cm4gaT10Lm9wdGlvbnMuYWpheEVycm9yTWVzc2FnZSx0LmRlYnVnKGksZSksdC5zZXRDb250ZW50KGkpLHQuYWRhcHRlci5hZGRDbGFzcyh0LmNvbnRhaW5lcix0W1wiY2xhc3NcIl0uYWpheEVycm9yKX0sb25Db21wbGV0ZTpmdW5jdGlvbigpe3JldHVybiB0LmFkYXB0ZXIucmVtb3ZlQ2xhc3ModC5jb250YWluZXIsdFtcImNsYXNzXCJdLmxvYWRpbmcpLHQubG9hZGluZz0hMSx0LmxvYWRlZD0hMCx0Ll9zZWFyY2hBbmRBY3RpdmF0ZUNsb3NlQnV0dG9ucygpLHQuX2FjdGl2YXRlRmlyc3RJbnB1dCgpLHQucmVwb3NpdGlvbigpfX0pfSx0LnByb3RvdHlwZS5fZW5zdXJlVHJpZ2dlckVsZW1lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdHJpZ2dlckVsZW1lbnRFeGlzdHMoKT92b2lkIDA6KHRoaXMuZGVhY3RpdmF0ZSgpLHRoaXMuX3N0b3BFbnN1cmVUcmlnZ2VyRWxlbWVudCgpKX0sdC5wcm90b3R5cGUuX2Vuc3VyZVRyaWdnZXJFbGVtZW50SW50ZXJ2YWw9MWUzLHQucHJvdG90eXBlLl9zdGFydEVuc3VyZVRyaWdnZXJFbGVtZW50PWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5fZW5zdXJlVHJpZ2dlckVsZW1lbnRUaW1lb3V0SWQ9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtyZXR1cm4gdC5fZW5zdXJlVHJpZ2dlckVsZW1lbnQoKX0sdGhpcy5fZW5zdXJlVHJpZ2dlckVsZW1lbnRJbnRlcnZhbCl9LHQucHJvdG90eXBlLl9zdG9wRW5zdXJlVHJpZ2dlckVsZW1lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gY2xlYXJJbnRlcnZhbCh0aGlzLl9lbnN1cmVUcmlnZ2VyRWxlbWVudFRpbWVvdXRJZCl9LHR9KCksdmVuZG9ycz1bXCJraHRtbFwiLFwibXNcIixcIm9cIixcIm1velwiLFwid2Via2l0XCJdLE9wZW50aXAucHJvdG90eXBlLnNldENzczNTdHlsZT1mdW5jdGlvbih0LGUpe3ZhciBpLG8scyxuLHI7dD10aGlzLmFkYXB0ZXIudW53cmFwKHQpLHI9W107Zm9yKGkgaW4gZSlfX2hhc1Byb3AuY2FsbChlLGkpJiYobz1lW2ldLHQuc3R5bGVbaV0hPW51bGw/ci5wdXNoKHQuc3R5bGVbaV09byk6ci5wdXNoKGZ1bmN0aW9uKCl7dmFyIGUscixhO2ZvcihhPVtdLGU9MCxyPXZlbmRvcnMubGVuZ3RoO3I+ZTtlKyspcz12ZW5kb3JzW2VdLG49XCJcIit0aGlzLnVjZmlyc3QocykrdGhpcy51Y2ZpcnN0KGkpLHQuc3R5bGVbbl0hPW51bGw/YS5wdXNoKHQuc3R5bGVbbl09byk6YS5wdXNoKHZvaWQgMCk7cmV0dXJuIGF9LmNhbGwodGhpcykpKTtyZXR1cm4gcn0sT3BlbnRpcC5wcm90b3R5cGUuZGVmZXI9ZnVuY3Rpb24odCl7cmV0dXJuIHNldFRpbWVvdXQodCwwKX0sT3BlbnRpcC5wcm90b3R5cGUuc2V0VGltZW91dD1mdW5jdGlvbih0LGUpe3JldHVybiBzZXRUaW1lb3V0KHQsZT9lKjFlMzowKX0sT3BlbnRpcC5wcm90b3R5cGUudWNmaXJzdD1mdW5jdGlvbih0KXtyZXR1cm4gdD09bnVsbD9cIlwiOnQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKX0sT3BlbnRpcC5wcm90b3R5cGUuZGFzaGVyaXplPWZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoLyhbQS1aXSkvZyxmdW5jdGlvbih0LGUpe3JldHVyblwiLVwiK2UudG9Mb3dlckNhc2UoKX0pfSxtb3VzZVBvc2l0aW9uT2JzZXJ2ZXJzPVtdLG1vdXNlUG9zaXRpb249e3g6MCx5OjB9LG1vdXNlTW92ZWQ9ZnVuY3Rpb24odCl7dmFyIGUsaSxvLHM7Zm9yKG1vdXNlUG9zaXRpb249T3BlbnRpcC5hZGFwdGVyLm1vdXNlUG9zaXRpb24odCkscz1bXSxpPTAsbz1tb3VzZVBvc2l0aW9uT2JzZXJ2ZXJzLmxlbmd0aDtvPmk7aSsrKWU9bW91c2VQb3NpdGlvbk9ic2VydmVyc1tpXSxzLnB1c2goZSgpKTtyZXR1cm4gc30sT3BlbnRpcC5mb2xsb3dNb3VzZVBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIE9wZW50aXAuYWRhcHRlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksXCJtb3VzZW1vdmVcIixtb3VzZU1vdmVkKX0sT3BlbnRpcC5fb2JzZXJ2ZU1vdXNlUG9zaXRpb249ZnVuY3Rpb24odCl7cmV0dXJuIG1vdXNlUG9zaXRpb25PYnNlcnZlcnMucHVzaCh0KX0sT3BlbnRpcC5fc3RvcE9ic2VydmluZ01vdXNlUG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIG1vdXNlUG9zaXRpb25PYnNlcnZlcnM9ZnVuY3Rpb24oKXt2YXIgaSxvLHM7Zm9yKHM9W10saT0wLG89bW91c2VQb3NpdGlvbk9ic2VydmVycy5sZW5ndGg7bz5pO2krKyllPW1vdXNlUG9zaXRpb25PYnNlcnZlcnNbaV0sZSE9PXQmJnMucHVzaChlKTtyZXR1cm4gc30oKX0sT3BlbnRpcC5Kb2ludD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dCE9bnVsbCYmKHQgaW5zdGFuY2VvZiBPcGVudGlwLkpvaW50JiYodCs9XCJcIiksdGhpcy5zZXQodCkpfXJldHVybiB0LnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dC50b0xvd2VyQ2FzZSgpLHRoaXMuc2V0SG9yaXpvbnRhbCh0KSx0aGlzLnNldFZlcnRpY2FsKHQpLHRoaXN9LHQucHJvdG90eXBlLnNldEhvcml6b250YWw9ZnVuY3Rpb24odCl7dmFyIGUsaSxvLHMsbixyLGE7Zm9yKGk9W1wibGVmdFwiLFwiY2VudGVyXCIsXCJyaWdodFwiXSxvPTAsbj1pLmxlbmd0aDtuPm87bysrKWU9aVtvXSx+dC5pbmRleE9mKGUpJiYodGhpcy5ob3Jpem9udGFsPWUudG9Mb3dlckNhc2UoKSk7Zm9yKHRoaXMuaG9yaXpvbnRhbD09bnVsbCYmKHRoaXMuaG9yaXpvbnRhbD1cImNlbnRlclwiKSxhPVtdLHM9MCxyPWkubGVuZ3RoO3I+cztzKyspZT1pW3NdLGEucHVzaCh0aGlzW2VdPXRoaXMuaG9yaXpvbnRhbD09PWU/ZTp2b2lkIDApO3JldHVybiBhfSx0LnByb3RvdHlwZS5zZXRWZXJ0aWNhbD1mdW5jdGlvbih0KXt2YXIgZSxpLG8scyxuLHIsYTtmb3IoaT1bXCJ0b3BcIixcIm1pZGRsZVwiLFwiYm90dG9tXCJdLG89MCxuPWkubGVuZ3RoO24+bztvKyspZT1pW29dLH50LmluZGV4T2YoZSkmJih0aGlzLnZlcnRpY2FsPWUudG9Mb3dlckNhc2UoKSk7Zm9yKHRoaXMudmVydGljYWw9PW51bGwmJih0aGlzLnZlcnRpY2FsPVwibWlkZGxlXCIpLGE9W10scz0wLHI9aS5sZW5ndGg7cj5zO3MrKyllPWlbc10sYS5wdXNoKHRoaXNbZV09dGhpcy52ZXJ0aWNhbD09PWU/ZTp2b2lkIDApO3JldHVybiBhfSx0LnByb3RvdHlwZS5lcWw9ZnVuY3Rpb24odCl7cmV0dXJuIHQhPW51bGwmJnRoaXMuaG9yaXpvbnRhbD09PXQuaG9yaXpvbnRhbCYmdGhpcy52ZXJ0aWNhbD09PXQudmVydGljYWx9LHQucHJvdG90eXBlLmZsaXA9ZnVuY3Rpb24oKXt2YXIgdCxlO3JldHVybiBlPU9wZW50aXAucG9zaXRpb25bdGhpcy50b1N0cmluZyghMCldLHQ9KGUrNCklOCx0aGlzLnNldChPcGVudGlwLnBvc2l0aW9uc1t0XSksdGhpc30sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24odCl7dmFyIGUsaTtyZXR1cm4gdD09bnVsbCYmKHQ9ITEpLGk9dGhpcy52ZXJ0aWNhbD09PVwibWlkZGxlXCI/XCJcIjp0aGlzLnZlcnRpY2FsLGU9dGhpcy5ob3Jpem9udGFsPT09XCJjZW50ZXJcIj9cIlwiOnRoaXMuaG9yaXpvbnRhbCxpJiZlJiYoZT10P09wZW50aXAucHJvdG90eXBlLnVjZmlyc3QoZSk6XCIgXCIrZSksXCJcIitpK2V9LHR9KCksT3BlbnRpcC5wcm90b3R5cGUuX3Bvc2l0aW9uc0VxdWFsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQhPW51bGwmJmUhPW51bGwmJnQubGVmdD09PWUubGVmdCYmdC50b3A9PT1lLnRvcH0sT3BlbnRpcC5wcm90b3R5cGUuX2RpbWVuc2lvbnNFcXVhbD1mdW5jdGlvbih0LGUpe3JldHVybiB0IT1udWxsJiZlIT1udWxsJiZ0LndpZHRoPT09ZS53aWR0aCYmdC5oZWlnaHQ9PT1lLmhlaWdodH0sT3BlbnRpcC5wcm90b3R5cGUuZGVidWc9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gdD1hcmd1bWVudHMubGVuZ3RoPj0xP19fc2xpY2UuY2FsbChhcmd1bWVudHMsMCk6W10sT3BlbnRpcC5kZWJ1ZyYmKHR5cGVvZiBjb25zb2xlIT1cInVuZGVmaW5lZFwiJiZjb25zb2xlIT09bnVsbD9jb25zb2xlLmRlYnVnOnZvaWQgMCkhPW51bGw/KHQudW5zaGlmdChcIiNcIit0aGlzLmlkK1wiIHxcIiksY29uc29sZS5kZWJ1Zy5hcHBseShjb25zb2xlLHQpKTp2b2lkIDB9LE9wZW50aXAuZmluZEVsZW1lbnRzPWZ1bmN0aW9uKCl7dmFyIHQsZSxpLG8scyxuLHIsYSxoLHA7Zm9yKHQ9T3BlbnRpcC5hZGFwdGVyLGg9dC5maW5kQWxsKGRvY3VtZW50LmJvZHksXCJbZGF0YS1vdF1cIikscD1bXSxyPTAsYT1oLmxlbmd0aDthPnI7cisrKXtpPWhbcl0sbj17fSxlPXQuZGF0YShpLFwib3RcIiksKGU9PT1cIlwifHxlPT09XCJ0cnVlXCJ8fGU9PT1cInllc1wiKSYmKGU9dC5hdHRyKGksXCJ0aXRsZVwiKSx0LmF0dHIoaSxcInRpdGxlXCIsXCJcIikpLGU9ZXx8XCJcIjtmb3IobyBpbiBPcGVudGlwLnN0eWxlcy5zdGFuZGFyZClzPXQuZGF0YShpLFwib3RcIitPcGVudGlwLnByb3RvdHlwZS51Y2ZpcnN0KG8pKSxzIT1udWxsJiYocz09PVwieWVzXCJ8fHM9PT1cInRydWVcInx8cz09PVwib25cIj9zPSEwOihzPT09XCJub1wifHxzPT09XCJmYWxzZVwifHxzPT09XCJvZmZcIikmJihzPSExKSxuW29dPXMpO3AucHVzaChuZXcgT3BlbnRpcChpLGUsbikpfXJldHVybiBwfSxPcGVudGlwLnZlcnNpb249XCIyLjQuNlwiLE9wZW50aXAuZGVidWc9ITEsT3BlbnRpcC5sYXN0SWQ9MCxPcGVudGlwLmxhc3RaSW5kZXg9MTAwLE9wZW50aXAudGlwcz1bXSxPcGVudGlwLl9hYm9ydFNob3dpbmdHcm91cD1mdW5jdGlvbih0LGUpe3ZhciBpLG8scyxuLHI7Zm9yKG49T3BlbnRpcC50aXBzLHI9W10sbz0wLHM9bi5sZW5ndGg7cz5vO28rKylpPW5bb10saSE9PWUmJmkub3B0aW9ucy5ncm91cD09PXQ/ci5wdXNoKGkuX2Fib3J0U2hvd2luZygpKTpyLnB1c2godm9pZCAwKTtyZXR1cm4gcn0sT3BlbnRpcC5faGlkZUdyb3VwPWZ1bmN0aW9uKHQsZSl7dmFyIGksbyxzLG4scjtmb3Iobj1PcGVudGlwLnRpcHMscj1bXSxvPTAscz1uLmxlbmd0aDtzPm87bysrKWk9bltvXSxpIT09ZSYmaS5vcHRpb25zLmdyb3VwPT09dD9yLnB1c2goaS5oaWRlKCkpOnIucHVzaCh2b2lkIDApO3JldHVybiByfSxPcGVudGlwLmFkYXB0ZXJzPXt9LE9wZW50aXAuYWRhcHRlcj1udWxsLGZpcnN0QWRhcHRlcj0hMCxPcGVudGlwLmFkZEFkYXB0ZXI9ZnVuY3Rpb24odCl7cmV0dXJuIE9wZW50aXAuYWRhcHRlcnNbdC5uYW1lXT10LGZpcnN0QWRhcHRlcj8oT3BlbnRpcC5hZGFwdGVyPXQsdC5kb21SZWFkeShPcGVudGlwLmZpbmRFbGVtZW50cyksdC5kb21SZWFkeShPcGVudGlwLmZvbGxvd01vdXNlUG9zaXRpb24pLGZpcnN0QWRhcHRlcj0hMSk6dm9pZCAwfSxPcGVudGlwLnBvc2l0aW9ucz1bXCJ0b3BcIixcInRvcFJpZ2h0XCIsXCJyaWdodFwiLFwiYm90dG9tUmlnaHRcIixcImJvdHRvbVwiLFwiYm90dG9tTGVmdFwiLFwibGVmdFwiLFwidG9wTGVmdFwiXSxPcGVudGlwLnBvc2l0aW9uPXt9LF9yZWY9T3BlbnRpcC5wb3NpdGlvbnMsaT1faT0wLF9sZW49X3JlZi5sZW5ndGg7X2xlbj5faTtpPSsrX2kpcG9zaXRpb249X3JlZltpXSxPcGVudGlwLnBvc2l0aW9uW3Bvc2l0aW9uXT1pO09wZW50aXAuc3R5bGVzPXtzdGFuZGFyZDp7XCJleHRlbmRzXCI6bnVsbCx0aXRsZTp2b2lkIDAsZXNjYXBlVGl0bGU6ITAsZXNjYXBlQ29udGVudDohMSxjbGFzc05hbWU6XCJzdGFuZGFyZFwiLHN0ZW06ITAsZGVsYXk6bnVsbCxoaWRlRGVsYXk6LjEsZml4ZWQ6ITEsc2hvd09uOlwibW91c2VvdmVyXCIsaGlkZVRyaWdnZXI6XCJ0cmlnZ2VyXCIsaGlkZVRyaWdnZXJzOltdLGhpZGVPbjpudWxsLHJlbW92ZUVsZW1lbnRzT25IaWRlOiExLG9mZnNldDpbMCwwXSxjb250YWluSW5WaWV3cG9ydDohMCxhdXRvT2Zmc2V0OiEwLHNob3dFZmZlY3Q6XCJhcHBlYXJcIixoaWRlRWZmZWN0OlwiZmFkZVwiLHNob3dFZmZlY3REdXJhdGlvbjouMyxoaWRlRWZmZWN0RHVyYXRpb246LjIsc3RlbUxlbmd0aDo1LHN0ZW1CYXNlOjgsdGlwSm9pbnQ6XCJ0b3AgbGVmdFwiLHRhcmdldDpudWxsLHRhcmdldEpvaW50Om51bGwsY2FjaGU6ITAsYWpheDohMSxhamF4TWV0aG9kOlwiR0VUXCIsYWpheEVycm9yTWVzc2FnZTpcIlRoZXJlIHdhcyBhIHByb2JsZW0gZG93bmxvYWRpbmcgdGhlIGNvbnRlbnQuXCIsZ3JvdXA6bnVsbCxzdHlsZTpudWxsLGJhY2tncm91bmQ6XCIjZmZmMThmXCIsYmFja2dyb3VuZEdyYWRpZW50SG9yaXpvbnRhbDohMSxjbG9zZUJ1dHRvbk9mZnNldDpbNSw1XSxjbG9zZUJ1dHRvblJhZGl1czo3LGNsb3NlQnV0dG9uQ3Jvc3NTaXplOjQsY2xvc2VCdXR0b25Dcm9zc0NvbG9yOlwiI2QyYzM1YlwiLGNsb3NlQnV0dG9uQ3Jvc3NMaW5lV2lkdGg6MS41LGNsb3NlQnV0dG9uTGlua092ZXJzY2FuOjYsYm9yZGVyUmFkaXVzOjUsYm9yZGVyV2lkdGg6MSxib3JkZXJDb2xvcjpcIiNmMmUzN2JcIixzaGFkb3c6ITAsc2hhZG93Qmx1cjoxMCxzaGFkb3dPZmZzZXQ6WzMsM10sc2hhZG93Q29sb3I6XCJyZ2JhKDAsIDAsIDAsIDAuMSlcIn0sZ2xhc3M6e1wiZXh0ZW5kc1wiOlwic3RhbmRhcmRcIixjbGFzc05hbWU6XCJnbGFzc1wiLGJhY2tncm91bmQ6W1swLFwicmdiYSgyNTIsIDI1MiwgMjUyLCAwLjgpXCJdLFsuNSxcInJnYmEoMjU1LCAyNTUsIDI1NSwgMC44KVwiXSxbLjUsXCJyZ2JhKDI1MCwgMjUwLCAyNTAsIDAuOSlcIl0sWzEsXCJyZ2JhKDI0NSwgMjQ1LCAyNDUsIDAuOSlcIl1dLGJvcmRlckNvbG9yOlwiI2VlZVwiLGNsb3NlQnV0dG9uQ3Jvc3NDb2xvcjpcInJnYmEoMCwgMCwgMCwgMC4yKVwiLGJvcmRlclJhZGl1czoxNSxjbG9zZUJ1dHRvblJhZGl1czoxMCxjbG9zZUJ1dHRvbk9mZnNldDpbOCw4XX0sZGFyazp7XCJleHRlbmRzXCI6XCJzdGFuZGFyZFwiLGNsYXNzTmFtZTpcImRhcmtcIixib3JkZXJSYWRpdXM6MTMsYm9yZGVyQ29sb3I6XCIjNDQ0XCIsY2xvc2VCdXR0b25Dcm9zc0NvbG9yOlwicmdiYSgyNDAsIDI0MCwgMjQwLCAxKVwiLHNoYWRvd0NvbG9yOlwicmdiYSgwLCAwLCAwLCAwLjMpXCIsc2hhZG93T2Zmc2V0OlsyLDJdLGJhY2tncm91bmQ6W1swLFwicmdiYSgzMCwgMzAsIDMwLCAwLjcpXCJdLFsuNSxcInJnYmEoMzAsIDMwLCAzMCwgMC44KVwiXSxbLjUsXCJyZ2JhKDEwLCAxMCwgMTAsIDAuOClcIl0sWzEsXCJyZ2JhKDEwLCAxMCwgMTAsIDAuOSlcIl1dfSxhbGVydDp7XCJleHRlbmRzXCI6XCJzdGFuZGFyZFwiLGNsYXNzTmFtZTpcImFsZXJ0XCIsYm9yZGVyUmFkaXVzOjEsYm9yZGVyQ29sb3I6XCIjQUUwRDExXCIsY2xvc2VCdXR0b25Dcm9zc0NvbG9yOlwicmdiYSgyNTUsIDI1NSwgMjU1LCAxKVwiLHNoYWRvd0NvbG9yOlwicmdiYSgwLCAwLCAwLCAwLjMpXCIsc2hhZG93T2Zmc2V0OlsyLDJdLGJhY2tncm91bmQ6W1swLFwicmdiYSgyMDMsIDE1LCAxOSwgMC43KVwiXSxbLjUsXCJyZ2JhKDIwMywgMTUsIDE5LCAwLjgpXCJdLFsuNSxcInJnYmEoMTg5LCAxNCwgMTgsIDAuOClcIl0sWzEsXCJyZ2JhKDE3OSwgMTQsIDE3LCAwLjkpXCJdXX19LE9wZW50aXAuZGVmYXVsdFN0eWxlPVwic3RhbmRhcmRcIix0eXBlb2YgbW9kdWxlIT1cInVuZGVmaW5lZFwiJiZtb2R1bGUhPT1udWxsP21vZHVsZS5leHBvcnRzPU9wZW50aXA6d2luZG93Lk9wZW50aXA9T3BlbnRpcDt2YXIgX19zbGljZT1bXS5zbGljZTsoZnVuY3Rpb24odCl7dmFyIGU7cmV0dXJuIHQuZm4ub3BlbnRpcD1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIG5ldyBPcGVudGlwKHRoaXMsdCxlLGkpfSxlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe31yZXR1cm4gZS5wcm90b3R5cGUubmFtZT1cImpxdWVyeVwiLGUucHJvdG90eXBlLmRvbVJlYWR5PWZ1bmN0aW9uKGUpe3JldHVybiB0KGUpfSxlLnByb3RvdHlwZS5jcmVhdGU9ZnVuY3Rpb24oZSl7cmV0dXJuIHQoZSl9LGUucHJvdG90eXBlLndyYXA9ZnVuY3Rpb24oZSl7aWYoZT10KGUpLGUubGVuZ3RoPjEpdGhyb3cgRXJyb3IoXCJNdWx0aXBsZSBlbGVtZW50cyBwcm92aWRlZC5cIik7cmV0dXJuIGV9LGUucHJvdG90eXBlLnVud3JhcD1mdW5jdGlvbihlKXtyZXR1cm4gdChlKVswXVxyXG59LGUucHJvdG90eXBlLnRhZ05hbWU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudW53cmFwKHQpLnRhZ05hbWV9LGUucHJvdG90eXBlLmF0dHI9ZnVuY3Rpb24oKXt2YXIgZSxpLG87cmV0dXJuIGk9YXJndW1lbnRzWzBdLGU9YXJndW1lbnRzLmxlbmd0aD49Mj9fX3NsaWNlLmNhbGwoYXJndW1lbnRzLDEpOltdLChvPXQoaSkpLmF0dHIuYXBwbHkobyxlKX0sZS5wcm90b3R5cGUuZGF0YT1mdW5jdGlvbigpe3ZhciBlLGksbztyZXR1cm4gaT1hcmd1bWVudHNbMF0sZT1hcmd1bWVudHMubGVuZ3RoPj0yP19fc2xpY2UuY2FsbChhcmd1bWVudHMsMSk6W10sKG89dChpKSkuZGF0YS5hcHBseShvLGUpfSxlLnByb3RvdHlwZS5maW5kPWZ1bmN0aW9uKGUsaSl7cmV0dXJuIHQoZSkuZmluZChpKS5nZXQoMCl9LGUucHJvdG90eXBlLmZpbmRBbGw9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdChlKS5maW5kKGkpfSxlLnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oZSxpLG8pe3JldHVybiBlPXQoZSksbz9lLnRleHQoaSk6ZS5odG1sKGkpfSxlLnByb3RvdHlwZS5hcHBlbmQ9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdChlKS5hcHBlbmQoaSl9LGUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihlKXtyZXR1cm4gdChlKS5yZW1vdmUoKX0sZS5wcm90b3R5cGUuYWRkQ2xhc3M9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdChlKS5hZGRDbGFzcyhpKX0sZS5wcm90b3R5cGUucmVtb3ZlQ2xhc3M9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdChlKS5yZW1vdmVDbGFzcyhpKX0sZS5wcm90b3R5cGUuY3NzPWZ1bmN0aW9uKGUsaSl7cmV0dXJuIHQoZSkuY3NzKGkpfSxlLnByb3RvdHlwZS5kaW1lbnNpb25zPWZ1bmN0aW9uKGUpe3JldHVybnt3aWR0aDp0KGUpLm91dGVyV2lkdGgoKSxoZWlnaHQ6dChlKS5vdXRlckhlaWdodCgpfX0sZS5wcm90b3R5cGUuc2Nyb2xsT2Zmc2V0PWZ1bmN0aW9uKCl7cmV0dXJuW3dpbmRvdy5wYWdlWE9mZnNldHx8ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnR8fGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCx3aW5kb3cucGFnZVlPZmZzZXR8fGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3B8fGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wXX0sZS5wcm90b3R5cGUudmlld3BvcnREaW1lbnNpb25zPWZ1bmN0aW9uKCl7cmV0dXJue3dpZHRoOmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCxoZWlnaHQ6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodH19LGUucHJvdG90eXBlLm1vdXNlUG9zaXRpb249ZnVuY3Rpb24odCl7cmV0dXJuIHQ9PW51bGw/bnVsbDp7eDp0LnBhZ2VYLHk6dC5wYWdlWX19LGUucHJvdG90eXBlLm9mZnNldD1mdW5jdGlvbihlKXt2YXIgaTtyZXR1cm4gaT10KGUpLm9mZnNldCgpLHtsZWZ0OmkubGVmdCx0b3A6aS50b3B9fSxlLnByb3RvdHlwZS5vYnNlcnZlPWZ1bmN0aW9uKGUsaSxvKXtyZXR1cm4gdChlKS5iaW5kKGksbyl9LGUucHJvdG90eXBlLnN0b3BPYnNlcnZpbmc9ZnVuY3Rpb24oZSxpLG8pe3JldHVybiB0KGUpLnVuYmluZChpLG8pfSxlLnByb3RvdHlwZS5hamF4PWZ1bmN0aW9uKGUpe3ZhciBpLG87aWYoZS51cmw9PW51bGwpdGhyb3cgRXJyb3IoXCJObyB1cmwgcHJvdmlkZWRcIik7cmV0dXJuIHQuYWpheCh7dXJsOmUudXJsLHR5cGU6KGk9KG89ZS5tZXRob2QpIT1udWxsP28udG9VcHBlckNhc2UoKTp2b2lkIDApIT1udWxsP2k6XCJHRVRcIn0pLmRvbmUoZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiBlLm9uU3VjY2Vzcz09XCJmdW5jdGlvblwiP2Uub25TdWNjZXNzKHQpOnZvaWQgMH0pLmZhaWwoZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiBlLm9uRXJyb3I9PVwiZnVuY3Rpb25cIj9lLm9uRXJyb3IoXCJTZXJ2ZXIgcmVzcG9uZGVkIHdpdGggc3RhdHVzIFwiK3Quc3RhdHVzKTp2b2lkIDB9KS5hbHdheXMoZnVuY3Rpb24oKXtyZXR1cm4gdHlwZW9mIGUub25Db21wbGV0ZT09XCJmdW5jdGlvblwiP2Uub25Db21wbGV0ZSgpOnZvaWQgMH0pfSxlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbihlKXtyZXR1cm4gdC5leHRlbmQoe30sZSl9LGUucHJvdG90eXBlLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBlLGk7cmV0dXJuIGk9YXJndW1lbnRzWzBdLGU9YXJndW1lbnRzLmxlbmd0aD49Mj9fX3NsaWNlLmNhbGwoYXJndW1lbnRzLDEpOltdLHQuZXh0ZW5kLmFwcGx5KHQsW2ldLmNvbmNhdChfX3NsaWNlLmNhbGwoZSkpKX0sZX0oKSxPcGVudGlwLmFkZEFkYXB0ZXIobmV3IGUpfSkoalF1ZXJ5KSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
